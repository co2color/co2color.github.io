import{d as lw,r as iw,o as ow,c as sw,a as Wm,b as uw,p as cw,e as dw}from"./index-DwFRwe9f.js";var ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hw(zn){return zn&&zn.__esModule&&Object.prototype.hasOwnProperty.call(zn,"default")?zn.default:zn}function zd(zn){throw new Error('Could not dynamically require "'+zn+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var By={exports:{}};(function(zn,Ii){(function(Fe){zn.exports=Fe()})(function(){return function(){function Fe(Ct,K,we){function H(J,X){if(!K[J]){if(!Ct[J]){var Y=typeof zd=="function"&&zd;if(!X&&Y)return Y(J,!0);if(L)return L(J,!0);var ge=new Error("Cannot find module '"+J+"'");throw ge.code="MODULE_NOT_FOUND",ge}var fe=K[J]={exports:{}};Ct[J][0].call(fe.exports,function(Se){var ke=Ct[J][1][Se];return H(ke||Se)},fe,fe.exports,Fe,Ct,K,we)}return K[J].exports}for(var L=typeof zd=="function"&&zd,G=0;G<we.length;G++)H(we[G]);return H}return Fe}()({1:[function(Fe,Ct,K){K.byteLength=ge,K.toByteArray=Se,K.fromByteArray=O;for(var we=[],H=[],L=typeof Uint8Array<"u"?Uint8Array:Array,G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J=0,X=G.length;J<X;++J)we[J]=G[J],H[G.charCodeAt(J)]=J;H[45]=62,H[95]=63;function Y(Z){var he=Z.length;if(he%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var $e=Z.indexOf("=");$e===-1&&($e=he);var te=$e===he?0:4-$e%4;return[$e,te]}function ge(Z){var he=Y(Z),$e=he[0],te=he[1];return($e+te)*3/4-te}function fe(Z,he,$e){return(he+$e)*3/4-$e}function Se(Z){var he,$e=Y(Z),te=$e[0],xe=$e[1],Oe=new L(fe(Z,te,xe)),Je=0,ot=xe>0?te-4:te,qe;for(qe=0;qe<ot;qe+=4)he=H[Z.charCodeAt(qe)]<<18|H[Z.charCodeAt(qe+1)]<<12|H[Z.charCodeAt(qe+2)]<<6|H[Z.charCodeAt(qe+3)],Oe[Je++]=he>>16&255,Oe[Je++]=he>>8&255,Oe[Je++]=he&255;return xe===2&&(he=H[Z.charCodeAt(qe)]<<2|H[Z.charCodeAt(qe+1)]>>4,Oe[Je++]=he&255),xe===1&&(he=H[Z.charCodeAt(qe)]<<10|H[Z.charCodeAt(qe+1)]<<4|H[Z.charCodeAt(qe+2)]>>2,Oe[Je++]=he>>8&255,Oe[Je++]=he&255),Oe}function ke(Z){return we[Z>>18&63]+we[Z>>12&63]+we[Z>>6&63]+we[Z&63]}function ie(Z,he,$e){for(var te,xe=[],Oe=he;Oe<$e;Oe+=3)te=(Z[Oe]<<16&16711680)+(Z[Oe+1]<<8&65280)+(Z[Oe+2]&255),xe.push(ke(te));return xe.join("")}function O(Z){for(var he,$e=Z.length,te=$e%3,xe=[],Oe=16383,Je=0,ot=$e-te;Je<ot;Je+=Oe)xe.push(ie(Z,Je,Je+Oe>ot?ot:Je+Oe));return te===1?(he=Z[$e-1],xe.push(we[he>>2]+we[he<<4&63]+"==")):te===2&&(he=(Z[$e-2]<<8)+Z[$e-1],xe.push(we[he>>10]+we[he>>4&63]+we[he<<2&63]+"=")),xe.join("")}},{}],2:[function(Fe,Ct,K){},{}],3:[function(Fe,Ct,K){(function(Y){var H=Fe("base64-js"),L=Fe("ieee754");K.Buffer=Y,K.SlowBuffer=te,K.INSPECT_MAX_BYTES=50;var G=2147483647;K.kMaxLength=G,Y.TYPED_ARRAY_SUPPORT=J(),!Y.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function J(){try{var Me=new Uint8Array(1);return Me.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Me.foo()===42}catch{return!1}}Object.defineProperty(Y.prototype,"parent",{enumerable:!0,get:function(){if(Y.isBuffer(this))return this.buffer}}),Object.defineProperty(Y.prototype,"offset",{enumerable:!0,get:function(){if(Y.isBuffer(this))return this.byteOffset}});function X(Me){if(Me>G)throw new RangeError('The value "'+Me+'" is invalid for option "size"');var oe=new Uint8Array(Me);return oe.__proto__=Y.prototype,oe}function Y(Me,oe,se){if(typeof Me=="number"){if(typeof oe=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ke(Me)}return ge(Me,oe,se)}typeof Symbol<"u"&&Symbol.species!=null&&Y[Symbol.species]===Y&&Object.defineProperty(Y,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Y.poolSize=8192;function ge(Me,oe,se){if(typeof Me=="string")return ie(Me,oe);if(ArrayBuffer.isView(Me))return O(Me);if(Me==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Me);if($r(Me,ArrayBuffer)||Me&&$r(Me.buffer,ArrayBuffer))return Z(Me,oe,se);if(typeof Me=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Le=Me.valueOf&&Me.valueOf();if(Le!=null&&Le!==Me)return Y.from(Le,oe,se);var ut=he(Me);if(ut)return ut;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Me[Symbol.toPrimitive]=="function")return Y.from(Me[Symbol.toPrimitive]("string"),oe,se);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Me)}Y.from=function(Me,oe,se){return ge(Me,oe,se)},Y.prototype.__proto__=Uint8Array.prototype,Y.__proto__=Uint8Array;function fe(Me){if(typeof Me!="number")throw new TypeError('"size" argument must be of type number');if(Me<0)throw new RangeError('The value "'+Me+'" is invalid for option "size"')}function Se(Me,oe,se){return fe(Me),Me<=0?X(Me):oe!==void 0?typeof se=="string"?X(Me).fill(oe,se):X(Me).fill(oe):X(Me)}Y.alloc=function(Me,oe,se){return Se(Me,oe,se)};function ke(Me){return fe(Me),X(Me<0?0:$e(Me)|0)}Y.allocUnsafe=function(Me){return ke(Me)},Y.allocUnsafeSlow=function(Me){return ke(Me)};function ie(Me,oe){if((typeof oe!="string"||oe==="")&&(oe="utf8"),!Y.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);var se=xe(Me,oe)|0,Le=X(se),ut=Le.write(Me,oe);return ut!==se&&(Le=Le.slice(0,ut)),Le}function O(Me){for(var oe=Me.length<0?0:$e(Me.length)|0,se=X(oe),Le=0;Le<oe;Le+=1)se[Le]=Me[Le]&255;return se}function Z(Me,oe,se){if(oe<0||Me.byteLength<oe)throw new RangeError('"offset" is outside of buffer bounds');if(Me.byteLength<oe+(se||0))throw new RangeError('"length" is outside of buffer bounds');var Le;return oe===void 0&&se===void 0?Le=new Uint8Array(Me):se===void 0?Le=new Uint8Array(Me,oe):Le=new Uint8Array(Me,oe,se),Le.__proto__=Y.prototype,Le}function he(Me){if(Y.isBuffer(Me)){var oe=$e(Me.length)|0,se=X(oe);return se.length===0||Me.copy(se,0,0,oe),se}if(Me.length!==void 0)return typeof Me.length!="number"||Qr(Me.length)?X(0):O(Me);if(Me.type==="Buffer"&&Array.isArray(Me.data))return O(Me.data)}function $e(Me){if(Me>=G)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+G.toString(16)+" bytes");return Me|0}function te(Me){return+Me!=Me&&(Me=0),Y.alloc(+Me)}Y.isBuffer=function(oe){return oe!=null&&oe._isBuffer===!0&&oe!==Y.prototype},Y.compare=function(oe,se){if($r(oe,Uint8Array)&&(oe=Y.from(oe,oe.offset,oe.byteLength)),$r(se,Uint8Array)&&(se=Y.from(se,se.offset,se.byteLength)),!Y.isBuffer(oe)||!Y.isBuffer(se))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(oe===se)return 0;for(var Le=oe.length,ut=se.length,sr=0,Zt=Math.min(Le,ut);sr<Zt;++sr)if(oe[sr]!==se[sr]){Le=oe[sr],ut=se[sr];break}return Le<ut?-1:ut<Le?1:0},Y.isEncoding=function(oe){switch(String(oe).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Y.concat=function(oe,se){if(!Array.isArray(oe))throw new TypeError('"list" argument must be an Array of Buffers');if(oe.length===0)return Y.alloc(0);var Le;if(se===void 0)for(se=0,Le=0;Le<oe.length;++Le)se+=oe[Le].length;var ut=Y.allocUnsafe(se),sr=0;for(Le=0;Le<oe.length;++Le){var Zt=oe[Le];if($r(Zt,Uint8Array)&&(Zt=Y.from(Zt)),!Y.isBuffer(Zt))throw new TypeError('"list" argument must be an Array of Buffers');Zt.copy(ut,sr),sr+=Zt.length}return ut};function xe(Me,oe){if(Y.isBuffer(Me))return Me.length;if(ArrayBuffer.isView(Me)||$r(Me,ArrayBuffer))return Me.byteLength;if(typeof Me!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Me);var se=Me.length,Le=arguments.length>2&&arguments[2]===!0;if(!Le&&se===0)return 0;for(var ut=!1;;)switch(oe){case"ascii":case"latin1":case"binary":return se;case"utf8":case"utf-8":return ua(Me).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se*2;case"hex":return se>>>1;case"base64":return zt(Me).length;default:if(ut)return Le?-1:ua(Me).length;oe=(""+oe).toLowerCase(),ut=!0}}Y.byteLength=xe;function Oe(Me,oe,se){var Le=!1;if((oe===void 0||oe<0)&&(oe=0),oe>this.length||((se===void 0||se>this.length)&&(se=this.length),se<=0)||(se>>>=0,oe>>>=0,se<=oe))return"";for(Me||(Me="utf8");;)switch(Me){case"hex":return Sr(this,oe,se);case"utf8":case"utf-8":return kt(this,oe,se);case"ascii":return gr(this,oe,se);case"latin1":case"binary":return Yt(this,oe,se);case"base64":return xt(this,oe,se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return zr(this,oe,se);default:if(Le)throw new TypeError("Unknown encoding: "+Me);Me=(Me+"").toLowerCase(),Le=!0}}Y.prototype._isBuffer=!0;function Je(Me,oe,se){var Le=Me[oe];Me[oe]=Me[se],Me[se]=Le}Y.prototype.swap16=function(){var oe=this.length;if(oe%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var se=0;se<oe;se+=2)Je(this,se,se+1);return this},Y.prototype.swap32=function(){var oe=this.length;if(oe%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var se=0;se<oe;se+=4)Je(this,se,se+3),Je(this,se+1,se+2);return this},Y.prototype.swap64=function(){var oe=this.length;if(oe%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var se=0;se<oe;se+=8)Je(this,se,se+7),Je(this,se+1,se+6),Je(this,se+2,se+5),Je(this,se+3,se+4);return this},Y.prototype.toString=function(){var oe=this.length;return oe===0?"":arguments.length===0?kt(this,0,oe):Oe.apply(this,arguments)},Y.prototype.toLocaleString=Y.prototype.toString,Y.prototype.equals=function(oe){if(!Y.isBuffer(oe))throw new TypeError("Argument must be a Buffer");return this===oe?!0:Y.compare(this,oe)===0},Y.prototype.inspect=function(){var oe="",se=K.INSPECT_MAX_BYTES;return oe=this.toString("hex",0,se).replace(/(.{2})/g,"$1 ").trim(),this.length>se&&(oe+=" ... "),"<Buffer "+oe+">"},Y.prototype.compare=function(oe,se,Le,ut,sr){if($r(oe,Uint8Array)&&(oe=Y.from(oe,oe.offset,oe.byteLength)),!Y.isBuffer(oe))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof oe);if(se===void 0&&(se=0),Le===void 0&&(Le=oe?oe.length:0),ut===void 0&&(ut=0),sr===void 0&&(sr=this.length),se<0||Le>oe.length||ut<0||sr>this.length)throw new RangeError("out of range index");if(ut>=sr&&se>=Le)return 0;if(ut>=sr)return-1;if(se>=Le)return 1;if(se>>>=0,Le>>>=0,ut>>>=0,sr>>>=0,this===oe)return 0;for(var Zt=sr-ut,sa=Le-se,da=Math.min(Zt,sa),Ur=this.slice(ut,sr),Sa=oe.slice(se,Le),ha=0;ha<da;++ha)if(Ur[ha]!==Sa[ha]){Zt=Ur[ha],sa=Sa[ha];break}return Zt<sa?-1:sa<Zt?1:0};function ot(Me,oe,se,Le,ut){if(Me.length===0)return-1;if(typeof se=="string"?(Le=se,se=0):se>2147483647?se=2147483647:se<-2147483648&&(se=-2147483648),se=+se,Qr(se)&&(se=ut?0:Me.length-1),se<0&&(se=Me.length+se),se>=Me.length){if(ut)return-1;se=Me.length-1}else if(se<0)if(ut)se=0;else return-1;if(typeof oe=="string"&&(oe=Y.from(oe,Le)),Y.isBuffer(oe))return oe.length===0?-1:qe(Me,oe,se,Le,ut);if(typeof oe=="number")return oe=oe&255,typeof Uint8Array.prototype.indexOf=="function"?ut?Uint8Array.prototype.indexOf.call(Me,oe,se):Uint8Array.prototype.lastIndexOf.call(Me,oe,se):qe(Me,[oe],se,Le,ut);throw new TypeError("val must be string, number or Buffer")}function qe(Me,oe,se,Le,ut){var sr=1,Zt=Me.length,sa=oe.length;if(Le!==void 0&&(Le=String(Le).toLowerCase(),Le==="ucs2"||Le==="ucs-2"||Le==="utf16le"||Le==="utf-16le")){if(Me.length<2||oe.length<2)return-1;sr=2,Zt/=2,sa/=2,se/=2}function da(Ta,Va){return sr===1?Ta[Va]:Ta.readUInt16BE(Va*sr)}var Ur;if(ut){var Sa=-1;for(Ur=se;Ur<Zt;Ur++)if(da(Me,Ur)===da(oe,Sa===-1?0:Ur-Sa)){if(Sa===-1&&(Sa=Ur),Ur-Sa+1===sa)return Sa*sr}else Sa!==-1&&(Ur-=Ur-Sa),Sa=-1}else for(se+sa>Zt&&(se=Zt-sa),Ur=se;Ur>=0;Ur--){for(var ha=!0,An=0;An<sa;An++)if(da(Me,Ur+An)!==da(oe,An)){ha=!1;break}if(ha)return Ur}return-1}Y.prototype.includes=function(oe,se,Le){return this.indexOf(oe,se,Le)!==-1},Y.prototype.indexOf=function(oe,se,Le){return ot(this,oe,se,Le,!0)},Y.prototype.lastIndexOf=function(oe,se,Le){return ot(this,oe,se,Le,!1)};function Et(Me,oe,se,Le){se=Number(se)||0;var ut=Me.length-se;Le?(Le=Number(Le),Le>ut&&(Le=ut)):Le=ut;var sr=oe.length;Le>sr/2&&(Le=sr/2);for(var Zt=0;Zt<Le;++Zt){var sa=parseInt(oe.substr(Zt*2,2),16);if(Qr(sa))return Zt;Me[se+Zt]=sa}return Zt}function Ye(Me,oe,se,Le){return Vt(ua(oe,Me.length-se),Me,se,Le)}function Be(Me,oe,se,Le){return Vt(Ge(oe),Me,se,Le)}function Qe(Me,oe,se,Le){return Be(Me,oe,se,Le)}function rt(Me,oe,se,Le){return Vt(zt(oe),Me,se,Le)}function lt(Me,oe,se,Le){return Vt(Ke(oe,Me.length-se),Me,se,Le)}Y.prototype.write=function(oe,se,Le,ut){if(se===void 0)ut="utf8",Le=this.length,se=0;else if(Le===void 0&&typeof se=="string")ut=se,Le=this.length,se=0;else if(isFinite(se))se=se>>>0,isFinite(Le)?(Le=Le>>>0,ut===void 0&&(ut="utf8")):(ut=Le,Le=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var sr=this.length-se;if((Le===void 0||Le>sr)&&(Le=sr),oe.length>0&&(Le<0||se<0)||se>this.length)throw new RangeError("Attempt to write outside buffer bounds");ut||(ut="utf8");for(var Zt=!1;;)switch(ut){case"hex":return Et(this,oe,se,Le);case"utf8":case"utf-8":return Ye(this,oe,se,Le);case"ascii":return Be(this,oe,se,Le);case"latin1":case"binary":return Qe(this,oe,se,Le);case"base64":return rt(this,oe,se,Le);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lt(this,oe,se,Le);default:if(Zt)throw new TypeError("Unknown encoding: "+ut);ut=(""+ut).toLowerCase(),Zt=!0}},Y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function xt(Me,oe,se){return oe===0&&se===Me.length?H.fromByteArray(Me):H.fromByteArray(Me.slice(oe,se))}function kt(Me,oe,se){se=Math.min(Me.length,se);for(var Le=[],ut=oe;ut<se;){var sr=Me[ut],Zt=null,sa=sr>239?4:sr>223?3:sr>191?2:1;if(ut+sa<=se){var da,Ur,Sa,ha;switch(sa){case 1:sr<128&&(Zt=sr);break;case 2:da=Me[ut+1],(da&192)===128&&(ha=(sr&31)<<6|da&63,ha>127&&(Zt=ha));break;case 3:da=Me[ut+1],Ur=Me[ut+2],(da&192)===128&&(Ur&192)===128&&(ha=(sr&15)<<12|(da&63)<<6|Ur&63,ha>2047&&(ha<55296||ha>57343)&&(Zt=ha));break;case 4:da=Me[ut+1],Ur=Me[ut+2],Sa=Me[ut+3],(da&192)===128&&(Ur&192)===128&&(Sa&192)===128&&(ha=(sr&15)<<18|(da&63)<<12|(Ur&63)<<6|Sa&63,ha>65535&&ha<1114112&&(Zt=ha))}}Zt===null?(Zt=65533,sa=1):Zt>65535&&(Zt-=65536,Le.push(Zt>>>10&1023|55296),Zt=56320|Zt&1023),Le.push(Zt),ut+=sa}return Ft(Le)}var qt=4096;function Ft(Me){var oe=Me.length;if(oe<=qt)return String.fromCharCode.apply(String,Me);for(var se="",Le=0;Le<oe;)se+=String.fromCharCode.apply(String,Me.slice(Le,Le+=qt));return se}function gr(Me,oe,se){var Le="";se=Math.min(Me.length,se);for(var ut=oe;ut<se;++ut)Le+=String.fromCharCode(Me[ut]&127);return Le}function Yt(Me,oe,se){var Le="";se=Math.min(Me.length,se);for(var ut=oe;ut<se;++ut)Le+=String.fromCharCode(Me[ut]);return Le}function Sr(Me,oe,se){var Le=Me.length;(!oe||oe<0)&&(oe=0),(!se||se<0||se>Le)&&(se=Le);for(var ut="",sr=oe;sr<se;++sr)ut+=ca(Me[sr]);return ut}function zr(Me,oe,se){for(var Le=Me.slice(oe,se),ut="",sr=0;sr<Le.length;sr+=2)ut+=String.fromCharCode(Le[sr]+Le[sr+1]*256);return ut}Y.prototype.slice=function(oe,se){var Le=this.length;oe=~~oe,se=se===void 0?Le:~~se,oe<0?(oe+=Le,oe<0&&(oe=0)):oe>Le&&(oe=Le),se<0?(se+=Le,se<0&&(se=0)):se>Le&&(se=Le),se<oe&&(se=oe);var ut=this.subarray(oe,se);return ut.__proto__=Y.prototype,ut};function ht(Me,oe,se){if(Me%1!==0||Me<0)throw new RangeError("offset is not uint");if(Me+oe>se)throw new RangeError("Trying to access beyond buffer length")}Y.prototype.readUIntLE=function(oe,se,Le){oe=oe>>>0,se=se>>>0,Le||ht(oe,se,this.length);for(var ut=this[oe],sr=1,Zt=0;++Zt<se&&(sr*=256);)ut+=this[oe+Zt]*sr;return ut},Y.prototype.readUIntBE=function(oe,se,Le){oe=oe>>>0,se=se>>>0,Le||ht(oe,se,this.length);for(var ut=this[oe+--se],sr=1;se>0&&(sr*=256);)ut+=this[oe+--se]*sr;return ut},Y.prototype.readUInt8=function(oe,se){return oe=oe>>>0,se||ht(oe,1,this.length),this[oe]},Y.prototype.readUInt16LE=function(oe,se){return oe=oe>>>0,se||ht(oe,2,this.length),this[oe]|this[oe+1]<<8},Y.prototype.readUInt16BE=function(oe,se){return oe=oe>>>0,se||ht(oe,2,this.length),this[oe]<<8|this[oe+1]},Y.prototype.readUInt32LE=function(oe,se){return oe=oe>>>0,se||ht(oe,4,this.length),(this[oe]|this[oe+1]<<8|this[oe+2]<<16)+this[oe+3]*16777216},Y.prototype.readUInt32BE=function(oe,se){return oe=oe>>>0,se||ht(oe,4,this.length),this[oe]*16777216+(this[oe+1]<<16|this[oe+2]<<8|this[oe+3])},Y.prototype.readIntLE=function(oe,se,Le){oe=oe>>>0,se=se>>>0,Le||ht(oe,se,this.length);for(var ut=this[oe],sr=1,Zt=0;++Zt<se&&(sr*=256);)ut+=this[oe+Zt]*sr;return sr*=128,ut>=sr&&(ut-=Math.pow(2,8*se)),ut},Y.prototype.readIntBE=function(oe,se,Le){oe=oe>>>0,se=se>>>0,Le||ht(oe,se,this.length);for(var ut=se,sr=1,Zt=this[oe+--ut];ut>0&&(sr*=256);)Zt+=this[oe+--ut]*sr;return sr*=128,Zt>=sr&&(Zt-=Math.pow(2,8*se)),Zt},Y.prototype.readInt8=function(oe,se){return oe=oe>>>0,se||ht(oe,1,this.length),this[oe]&128?(255-this[oe]+1)*-1:this[oe]},Y.prototype.readInt16LE=function(oe,se){oe=oe>>>0,se||ht(oe,2,this.length);var Le=this[oe]|this[oe+1]<<8;return Le&32768?Le|4294901760:Le},Y.prototype.readInt16BE=function(oe,se){oe=oe>>>0,se||ht(oe,2,this.length);var Le=this[oe+1]|this[oe]<<8;return Le&32768?Le|4294901760:Le},Y.prototype.readInt32LE=function(oe,se){return oe=oe>>>0,se||ht(oe,4,this.length),this[oe]|this[oe+1]<<8|this[oe+2]<<16|this[oe+3]<<24},Y.prototype.readInt32BE=function(oe,se){return oe=oe>>>0,se||ht(oe,4,this.length),this[oe]<<24|this[oe+1]<<16|this[oe+2]<<8|this[oe+3]},Y.prototype.readFloatLE=function(oe,se){return oe=oe>>>0,se||ht(oe,4,this.length),L.read(this,oe,!0,23,4)},Y.prototype.readFloatBE=function(oe,se){return oe=oe>>>0,se||ht(oe,4,this.length),L.read(this,oe,!1,23,4)},Y.prototype.readDoubleLE=function(oe,se){return oe=oe>>>0,se||ht(oe,8,this.length),L.read(this,oe,!0,52,8)},Y.prototype.readDoubleBE=function(oe,se){return oe=oe>>>0,se||ht(oe,8,this.length),L.read(this,oe,!1,52,8)};function ft(Me,oe,se,Le,ut,sr){if(!Y.isBuffer(Me))throw new TypeError('"buffer" argument must be a Buffer instance');if(oe>ut||oe<sr)throw new RangeError('"value" argument is out of bounds');if(se+Le>Me.length)throw new RangeError("Index out of range")}Y.prototype.writeUIntLE=function(oe,se,Le,ut){if(oe=+oe,se=se>>>0,Le=Le>>>0,!ut){var sr=Math.pow(2,8*Le)-1;ft(this,oe,se,Le,sr,0)}var Zt=1,sa=0;for(this[se]=oe&255;++sa<Le&&(Zt*=256);)this[se+sa]=oe/Zt&255;return se+Le},Y.prototype.writeUIntBE=function(oe,se,Le,ut){if(oe=+oe,se=se>>>0,Le=Le>>>0,!ut){var sr=Math.pow(2,8*Le)-1;ft(this,oe,se,Le,sr,0)}var Zt=Le-1,sa=1;for(this[se+Zt]=oe&255;--Zt>=0&&(sa*=256);)this[se+Zt]=oe/sa&255;return se+Le},Y.prototype.writeUInt8=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,1,255,0),this[se]=oe&255,se+1},Y.prototype.writeUInt16LE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,2,65535,0),this[se]=oe&255,this[se+1]=oe>>>8,se+2},Y.prototype.writeUInt16BE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,2,65535,0),this[se]=oe>>>8,this[se+1]=oe&255,se+2},Y.prototype.writeUInt32LE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,4,4294967295,0),this[se+3]=oe>>>24,this[se+2]=oe>>>16,this[se+1]=oe>>>8,this[se]=oe&255,se+4},Y.prototype.writeUInt32BE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,4,4294967295,0),this[se]=oe>>>24,this[se+1]=oe>>>16,this[se+2]=oe>>>8,this[se+3]=oe&255,se+4},Y.prototype.writeIntLE=function(oe,se,Le,ut){if(oe=+oe,se=se>>>0,!ut){var sr=Math.pow(2,8*Le-1);ft(this,oe,se,Le,sr-1,-sr)}var Zt=0,sa=1,da=0;for(this[se]=oe&255;++Zt<Le&&(sa*=256);)oe<0&&da===0&&this[se+Zt-1]!==0&&(da=1),this[se+Zt]=(oe/sa>>0)-da&255;return se+Le},Y.prototype.writeIntBE=function(oe,se,Le,ut){if(oe=+oe,se=se>>>0,!ut){var sr=Math.pow(2,8*Le-1);ft(this,oe,se,Le,sr-1,-sr)}var Zt=Le-1,sa=1,da=0;for(this[se+Zt]=oe&255;--Zt>=0&&(sa*=256);)oe<0&&da===0&&this[se+Zt+1]!==0&&(da=1),this[se+Zt]=(oe/sa>>0)-da&255;return se+Le},Y.prototype.writeInt8=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,1,127,-128),oe<0&&(oe=255+oe+1),this[se]=oe&255,se+1},Y.prototype.writeInt16LE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,2,32767,-32768),this[se]=oe&255,this[se+1]=oe>>>8,se+2},Y.prototype.writeInt16BE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,2,32767,-32768),this[se]=oe>>>8,this[se+1]=oe&255,se+2},Y.prototype.writeInt32LE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,4,2147483647,-2147483648),this[se]=oe&255,this[se+1]=oe>>>8,this[se+2]=oe>>>16,this[se+3]=oe>>>24,se+4},Y.prototype.writeInt32BE=function(oe,se,Le){return oe=+oe,se=se>>>0,Le||ft(this,oe,se,4,2147483647,-2147483648),oe<0&&(oe=4294967295+oe+1),this[se]=oe>>>24,this[se+1]=oe>>>16,this[se+2]=oe>>>8,this[se+3]=oe&255,se+4};function Ht(Me,oe,se,Le,ut,sr){if(se+Le>Me.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("Index out of range")}function hr(Me,oe,se,Le,ut){return oe=+oe,se=se>>>0,ut||Ht(Me,oe,se,4),L.write(Me,oe,se,Le,23,4),se+4}Y.prototype.writeFloatLE=function(oe,se,Le){return hr(this,oe,se,!0,Le)},Y.prototype.writeFloatBE=function(oe,se,Le){return hr(this,oe,se,!1,Le)};function Br(Me,oe,se,Le,ut){return oe=+oe,se=se>>>0,ut||Ht(Me,oe,se,8),L.write(Me,oe,se,Le,52,8),se+8}Y.prototype.writeDoubleLE=function(oe,se,Le){return Br(this,oe,se,!0,Le)},Y.prototype.writeDoubleBE=function(oe,se,Le){return Br(this,oe,se,!1,Le)},Y.prototype.copy=function(oe,se,Le,ut){if(!Y.isBuffer(oe))throw new TypeError("argument should be a Buffer");if(Le||(Le=0),!ut&&ut!==0&&(ut=this.length),se>=oe.length&&(se=oe.length),se||(se=0),ut>0&&ut<Le&&(ut=Le),ut===Le||oe.length===0||this.length===0)return 0;if(se<0)throw new RangeError("targetStart out of bounds");if(Le<0||Le>=this.length)throw new RangeError("Index out of range");if(ut<0)throw new RangeError("sourceEnd out of bounds");ut>this.length&&(ut=this.length),oe.length-se<ut-Le&&(ut=oe.length-se+Le);var sr=ut-Le;if(this===oe&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(se,Le,ut);else if(this===oe&&Le<se&&se<ut)for(var Zt=sr-1;Zt>=0;--Zt)oe[Zt+se]=this[Zt+Le];else Uint8Array.prototype.set.call(oe,this.subarray(Le,ut),se);return sr},Y.prototype.fill=function(oe,se,Le,ut){if(typeof oe=="string"){if(typeof se=="string"?(ut=se,se=0,Le=this.length):typeof Le=="string"&&(ut=Le,Le=this.length),ut!==void 0&&typeof ut!="string")throw new TypeError("encoding must be a string");if(typeof ut=="string"&&!Y.isEncoding(ut))throw new TypeError("Unknown encoding: "+ut);if(oe.length===1){var sr=oe.charCodeAt(0);(ut==="utf8"&&sr<128||ut==="latin1")&&(oe=sr)}}else typeof oe=="number"&&(oe=oe&255);if(se<0||this.length<se||this.length<Le)throw new RangeError("Out of range index");if(Le<=se)return this;se=se>>>0,Le=Le===void 0?this.length:Le>>>0,oe||(oe=0);var Zt;if(typeof oe=="number")for(Zt=se;Zt<Le;++Zt)this[Zt]=oe;else{var sa=Y.isBuffer(oe)?oe:Y.from(oe,ut),da=sa.length;if(da===0)throw new TypeError('The value "'+oe+'" is invalid for argument "value"');for(Zt=0;Zt<Le-se;++Zt)this[Zt+se]=sa[Zt%da]}return this};var Vr=/[^+/0-9A-Za-z-_]/g;function ma(Me){if(Me=Me.split("=")[0],Me=Me.trim().replace(Vr,""),Me.length<2)return"";for(;Me.length%4!==0;)Me=Me+"=";return Me}function ca(Me){return Me<16?"0"+Me.toString(16):Me.toString(16)}function ua(Me,oe){oe=oe||1/0;for(var se,Le=Me.length,ut=null,sr=[],Zt=0;Zt<Le;++Zt){if(se=Me.charCodeAt(Zt),se>55295&&se<57344){if(!ut){if(se>56319){(oe-=3)>-1&&sr.push(239,191,189);continue}else if(Zt+1===Le){(oe-=3)>-1&&sr.push(239,191,189);continue}ut=se;continue}if(se<56320){(oe-=3)>-1&&sr.push(239,191,189),ut=se;continue}se=(ut-55296<<10|se-56320)+65536}else ut&&(oe-=3)>-1&&sr.push(239,191,189);if(ut=null,se<128){if((oe-=1)<0)break;sr.push(se)}else if(se<2048){if((oe-=2)<0)break;sr.push(se>>6|192,se&63|128)}else if(se<65536){if((oe-=3)<0)break;sr.push(se>>12|224,se>>6&63|128,se&63|128)}else if(se<1114112){if((oe-=4)<0)break;sr.push(se>>18|240,se>>12&63|128,se>>6&63|128,se&63|128)}else throw new Error("Invalid code point")}return sr}function Ge(Me){for(var oe=[],se=0;se<Me.length;++se)oe.push(Me.charCodeAt(se)&255);return oe}function Ke(Me,oe){for(var se,Le,ut,sr=[],Zt=0;Zt<Me.length&&!((oe-=2)<0);++Zt)se=Me.charCodeAt(Zt),Le=se>>8,ut=se%256,sr.push(ut),sr.push(Le);return sr}function zt(Me){return H.toByteArray(ma(Me))}function Vt(Me,oe,se,Le){for(var ut=0;ut<Le&&!(ut+se>=oe.length||ut>=Me.length);++ut)oe[ut+se]=Me[ut];return ut}function $r(Me,oe){return Me instanceof oe||Me!=null&&Me.constructor!=null&&Me.constructor.name!=null&&Me.constructor.name===oe.name}function Qr(Me){return Me!==Me}}).call(this,Fe("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:6}],4:[function(Fe,Ct,K){(function(we){function H(te){return Array.isArray?Array.isArray(te):$e(te)==="[object Array]"}K.isArray=H;function L(te){return typeof te=="boolean"}K.isBoolean=L;function G(te){return te===null}K.isNull=G;function J(te){return te==null}K.isNullOrUndefined=J;function X(te){return typeof te=="number"}K.isNumber=X;function Y(te){return typeof te=="string"}K.isString=Y;function ge(te){return typeof te=="symbol"}K.isSymbol=ge;function fe(te){return te===void 0}K.isUndefined=fe;function Se(te){return $e(te)==="[object RegExp]"}K.isRegExp=Se;function ke(te){return typeof te=="object"&&te!==null}K.isObject=ke;function ie(te){return $e(te)==="[object Date]"}K.isDate=ie;function O(te){return $e(te)==="[object Error]"||te instanceof Error}K.isError=O;function Z(te){return typeof te=="function"}K.isFunction=Z;function he(te){return te===null||typeof te=="boolean"||typeof te=="number"||typeof te=="string"||typeof te=="symbol"||typeof te>"u"}K.isPrimitive=he,K.isBuffer=we.isBuffer;function $e(te){return Object.prototype.toString.call(te)}}).call(this,{isBuffer:Fe("../../is-buffer/index.js")})},{"../../is-buffer/index.js":9}],5:[function(Fe,Ct,K){var we=Object.create||qe,H=Object.keys||Et,L=Function.prototype.bind||Ye;function G(){(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events"))&&(this._events=we(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}Ct.exports=G,G.EventEmitter=G,G.prototype._events=void 0,G.prototype._maxListeners=void 0;var J=10,X;try{var Y={};Object.defineProperty&&Object.defineProperty(Y,"x",{value:0}),X=Y.x===0}catch{X=!1}X?Object.defineProperty(G,"defaultMaxListeners",{enumerable:!0,get:function(){return J},set:function(Be){if(typeof Be!="number"||Be<0||Be!==Be)throw new TypeError('"defaultMaxListeners" must be a positive number');J=Be}}):G.defaultMaxListeners=J,G.prototype.setMaxListeners=function(Qe){if(typeof Qe!="number"||Qe<0||isNaN(Qe))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=Qe,this};function ge(Be){return Be._maxListeners===void 0?G.defaultMaxListeners:Be._maxListeners}G.prototype.getMaxListeners=function(){return ge(this)};function fe(Be,Qe,rt){if(Qe)Be.call(rt);else for(var lt=Be.length,xt=Je(Be,lt),kt=0;kt<lt;++kt)xt[kt].call(rt)}function Se(Be,Qe,rt,lt){if(Qe)Be.call(rt,lt);else for(var xt=Be.length,kt=Je(Be,xt),qt=0;qt<xt;++qt)kt[qt].call(rt,lt)}function ke(Be,Qe,rt,lt,xt){if(Qe)Be.call(rt,lt,xt);else for(var kt=Be.length,qt=Je(Be,kt),Ft=0;Ft<kt;++Ft)qt[Ft].call(rt,lt,xt)}function ie(Be,Qe,rt,lt,xt,kt){if(Qe)Be.call(rt,lt,xt,kt);else for(var qt=Be.length,Ft=Je(Be,qt),gr=0;gr<qt;++gr)Ft[gr].call(rt,lt,xt,kt)}function O(Be,Qe,rt,lt){if(Qe)Be.apply(rt,lt);else for(var xt=Be.length,kt=Je(Be,xt),qt=0;qt<xt;++qt)kt[qt].apply(rt,lt)}G.prototype.emit=function(Qe){var rt,lt,xt,kt,qt,Ft,gr=Qe==="error";if(Ft=this._events,Ft)gr=gr&&Ft.error==null;else if(!gr)return!1;if(gr){if(arguments.length>1&&(rt=arguments[1]),rt instanceof Error)throw rt;var Yt=new Error('Unhandled "error" event. ('+rt+")");throw Yt.context=rt,Yt}if(lt=Ft[Qe],!lt)return!1;var Sr=typeof lt=="function";switch(xt=arguments.length,xt){case 1:fe(lt,Sr,this);break;case 2:Se(lt,Sr,this,arguments[1]);break;case 3:ke(lt,Sr,this,arguments[1],arguments[2]);break;case 4:ie(lt,Sr,this,arguments[1],arguments[2],arguments[3]);break;default:for(kt=new Array(xt-1),qt=1;qt<xt;qt++)kt[qt-1]=arguments[qt];O(lt,Sr,this,kt)}return!0};function Z(Be,Qe,rt,lt){var xt,kt,qt;if(typeof rt!="function")throw new TypeError('"listener" argument must be a function');if(kt=Be._events,kt?(kt.newListener&&(Be.emit("newListener",Qe,rt.listener?rt.listener:rt),kt=Be._events),qt=kt[Qe]):(kt=Be._events=we(null),Be._eventsCount=0),!qt)qt=kt[Qe]=rt,++Be._eventsCount;else if(typeof qt=="function"?qt=kt[Qe]=lt?[rt,qt]:[qt,rt]:lt?qt.unshift(rt):qt.push(rt),!qt.warned&&(xt=ge(Be),xt&&xt>0&&qt.length>xt)){qt.warned=!0;var Ft=new Error("Possible EventEmitter memory leak detected. "+qt.length+' "'+String(Qe)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');Ft.name="MaxListenersExceededWarning",Ft.emitter=Be,Ft.type=Qe,Ft.count=qt.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",Ft.name,Ft.message)}return Be}G.prototype.addListener=function(Qe,rt){return Z(this,Qe,rt,!1)},G.prototype.on=G.prototype.addListener,G.prototype.prependListener=function(Qe,rt){return Z(this,Qe,rt,!0)};function he(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var Be=new Array(arguments.length),Qe=0;Qe<Be.length;++Qe)Be[Qe]=arguments[Qe];this.listener.apply(this.target,Be)}}function $e(Be,Qe,rt){var lt={fired:!1,wrapFn:void 0,target:Be,type:Qe,listener:rt},xt=L.call(he,lt);return xt.listener=rt,lt.wrapFn=xt,xt}G.prototype.once=function(Qe,rt){if(typeof rt!="function")throw new TypeError('"listener" argument must be a function');return this.on(Qe,$e(this,Qe,rt)),this},G.prototype.prependOnceListener=function(Qe,rt){if(typeof rt!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(Qe,$e(this,Qe,rt)),this},G.prototype.removeListener=function(Qe,rt){var lt,xt,kt,qt,Ft;if(typeof rt!="function")throw new TypeError('"listener" argument must be a function');if(xt=this._events,!xt)return this;if(lt=xt[Qe],!lt)return this;if(lt===rt||lt.listener===rt)--this._eventsCount===0?this._events=we(null):(delete xt[Qe],xt.removeListener&&this.emit("removeListener",Qe,lt.listener||rt));else if(typeof lt!="function"){for(kt=-1,qt=lt.length-1;qt>=0;qt--)if(lt[qt]===rt||lt[qt].listener===rt){Ft=lt[qt].listener,kt=qt;break}if(kt<0)return this;kt===0?lt.shift():Oe(lt,kt),lt.length===1&&(xt[Qe]=lt[0]),xt.removeListener&&this.emit("removeListener",Qe,Ft||rt)}return this},G.prototype.removeAllListeners=function(Qe){var rt,lt,xt;if(lt=this._events,!lt)return this;if(!lt.removeListener)return arguments.length===0?(this._events=we(null),this._eventsCount=0):lt[Qe]&&(--this._eventsCount===0?this._events=we(null):delete lt[Qe]),this;if(arguments.length===0){var kt=H(lt),qt;for(xt=0;xt<kt.length;++xt)qt=kt[xt],qt!=="removeListener"&&this.removeAllListeners(qt);return this.removeAllListeners("removeListener"),this._events=we(null),this._eventsCount=0,this}if(rt=lt[Qe],typeof rt=="function")this.removeListener(Qe,rt);else if(rt)for(xt=rt.length-1;xt>=0;xt--)this.removeListener(Qe,rt[xt]);return this};function te(Be,Qe,rt){var lt=Be._events;if(!lt)return[];var xt=lt[Qe];return xt?typeof xt=="function"?rt?[xt.listener||xt]:[xt]:rt?ot(xt):Je(xt,xt.length):[]}G.prototype.listeners=function(Qe){return te(this,Qe,!0)},G.prototype.rawListeners=function(Qe){return te(this,Qe,!1)},G.listenerCount=function(Be,Qe){return typeof Be.listenerCount=="function"?Be.listenerCount(Qe):xe.call(Be,Qe)},G.prototype.listenerCount=xe;function xe(Be){var Qe=this._events;if(Qe){var rt=Qe[Be];if(typeof rt=="function")return 1;if(rt)return rt.length}return 0}G.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Oe(Be,Qe){for(var rt=Qe,lt=rt+1,xt=Be.length;lt<xt;rt+=1,lt+=1)Be[rt]=Be[lt];Be.pop()}function Je(Be,Qe){for(var rt=new Array(Qe),lt=0;lt<Qe;++lt)rt[lt]=Be[lt];return rt}function ot(Be){for(var Qe=new Array(Be.length),rt=0;rt<Qe.length;++rt)Qe[rt]=Be[rt].listener||Be[rt];return Qe}function qe(Be){var Qe=function(){};return Qe.prototype=Be,new Qe}function Et(Be){for(var Qe in Be)Object.prototype.hasOwnProperty.call(Be,Qe);return Qe}function Ye(Be){var Qe=this;return function(){return Qe.apply(Be,arguments)}}},{}],6:[function(Fe,Ct,K){K.read=function(we,H,L,G,J){var X,Y,ge=J*8-G-1,fe=(1<<ge)-1,Se=fe>>1,ke=-7,ie=L?J-1:0,O=L?-1:1,Z=we[H+ie];for(ie+=O,X=Z&(1<<-ke)-1,Z>>=-ke,ke+=ge;ke>0;X=X*256+we[H+ie],ie+=O,ke-=8);for(Y=X&(1<<-ke)-1,X>>=-ke,ke+=G;ke>0;Y=Y*256+we[H+ie],ie+=O,ke-=8);if(X===0)X=1-Se;else{if(X===fe)return Y?NaN:(Z?-1:1)*(1/0);Y=Y+Math.pow(2,G),X=X-Se}return(Z?-1:1)*Y*Math.pow(2,X-G)},K.write=function(we,H,L,G,J,X){var Y,ge,fe,Se=X*8-J-1,ke=(1<<Se)-1,ie=ke>>1,O=J===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=G?0:X-1,he=G?1:-1,$e=H<0||H===0&&1/H<0?1:0;for(H=Math.abs(H),isNaN(H)||H===1/0?(ge=isNaN(H)?1:0,Y=ke):(Y=Math.floor(Math.log(H)/Math.LN2),H*(fe=Math.pow(2,-Y))<1&&(Y--,fe*=2),Y+ie>=1?H+=O/fe:H+=O*Math.pow(2,1-ie),H*fe>=2&&(Y++,fe/=2),Y+ie>=ke?(ge=0,Y=ke):Y+ie>=1?(ge=(H*fe-1)*Math.pow(2,J),Y=Y+ie):(ge=H*Math.pow(2,ie-1)*Math.pow(2,J),Y=0));J>=8;we[L+Z]=ge&255,Z+=he,ge/=256,J-=8);for(Y=Y<<J|ge,Se+=J;Se>0;we[L+Z]=Y&255,Z+=he,Y/=256,Se-=8);we[L+Z-he]|=$e*128}},{}],7:[function(Fe,Ct,K){(function(we){var H=we.MutationObserver||we.WebKitMutationObserver,L;if(H){var G=0,J=new H(Se),X=we.document.createTextNode("");J.observe(X,{characterData:!0}),L=function(){X.data=G=++G%2}}else if(!we.setImmediate&&typeof we.MessageChannel<"u"){var Y=new we.MessageChannel;Y.port1.onmessage=Se,L=function(){Y.port2.postMessage(0)}}else"document"in we&&"onreadystatechange"in we.document.createElement("script")?L=function(){var ie=we.document.createElement("script");ie.onreadystatechange=function(){Se(),ie.onreadystatechange=null,ie.parentNode.removeChild(ie),ie=null},we.document.documentElement.appendChild(ie)}:L=function(){setTimeout(Se,0)};var ge,fe=[];function Se(){ge=!0;for(var ie,O,Z=fe.length;Z;){for(O=fe,fe=[],ie=-1;++ie<Z;)O[ie]();Z=fe.length}ge=!1}Ct.exports=ke;function ke(ie){fe.push(ie)===1&&!ge&&L()}}).call(this,typeof ws<"u"?ws:typeof self<"u"?self:typeof window<"u"?window:{})},{}],8:[function(Fe,Ct,K){typeof Object.create=="function"?Ct.exports=function(H,L){L&&(H.super_=L,H.prototype=Object.create(L.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}))}:Ct.exports=function(H,L){if(L){H.super_=L;var G=function(){};G.prototype=L.prototype,H.prototype=new G,H.prototype.constructor=H}}},{}],9:[function(Fe,Ct,K){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */Ct.exports=function(L){return L!=null&&(we(L)||H(L)||!!L._isBuffer)};function we(L){return!!L.constructor&&typeof L.constructor.isBuffer=="function"&&L.constructor.isBuffer(L)}function H(L){return typeof L.readFloatLE=="function"&&typeof L.slice=="function"&&we(L.slice(0,0))}},{}],10:[function(Fe,Ct,K){var we={}.toString;Ct.exports=Array.isArray||function(H){return we.call(H)=="[object Array]"}},{}],11:[function(Fe,Ct,K){var we=Fe("./utils"),H=Fe("./support"),L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";K.encode=function(G){for(var J=[],X,Y,ge,fe,Se,ke,ie,O=0,Z=G.length,he=Z,$e=we.getTypeOf(G)!=="string";O<G.length;)he=Z-O,$e?(X=G[O++],Y=O<Z?G[O++]:0,ge=O<Z?G[O++]:0):(X=G.charCodeAt(O++),Y=O<Z?G.charCodeAt(O++):0,ge=O<Z?G.charCodeAt(O++):0),fe=X>>2,Se=(X&3)<<4|Y>>4,ke=he>1?(Y&15)<<2|ge>>6:64,ie=he>2?ge&63:64,J.push(L.charAt(fe)+L.charAt(Se)+L.charAt(ke)+L.charAt(ie));return J.join("")},K.decode=function(G){var J,X,Y,ge,fe,Se,ke,ie=0,O=0,Z="data:";if(G.substr(0,Z.length)===Z)throw new Error("Invalid base64 input, it looks like a data url.");G=G.replace(/[^A-Za-z0-9\+\/\=]/g,"");var he=G.length*3/4;if(G.charAt(G.length-1)===L.charAt(64)&&he--,G.charAt(G.length-2)===L.charAt(64)&&he--,he%1!==0)throw new Error("Invalid base64 input, bad content length.");var $e;for(H.uint8array?$e=new Uint8Array(he|0):$e=new Array(he|0);ie<G.length;)ge=L.indexOf(G.charAt(ie++)),fe=L.indexOf(G.charAt(ie++)),Se=L.indexOf(G.charAt(ie++)),ke=L.indexOf(G.charAt(ie++)),J=ge<<2|fe>>4,X=(fe&15)<<4|Se>>2,Y=(Se&3)<<6|ke,$e[O++]=J,Se!==64&&($e[O++]=X),ke!==64&&($e[O++]=Y);return $e}},{"./support":40,"./utils":42}],12:[function(Fe,Ct,K){var we=Fe("./external"),H=Fe("./stream/DataWorker"),G=Fe("./stream/DataLengthProbe"),L=Fe("./stream/Crc32Probe"),G=Fe("./stream/DataLengthProbe");function J(X,Y,ge,fe,Se){this.compressedSize=X,this.uncompressedSize=Y,this.crc32=ge,this.compression=fe,this.compressedContent=Se}J.prototype={getContentWorker:function(){var X=new H(we.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new G("data_length")),Y=this;return X.on("end",function(){if(this.streamInfo.data_length!==Y.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),X},getCompressedWorker:function(){return new H(we.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},J.createWorkerFrom=function(X,Y,ge){return X.pipe(new L).pipe(new G("uncompressedSize")).pipe(Y.compressWorker(ge)).pipe(new G("compressedSize")).withStreamInfo("compression",Y)},Ct.exports=J},{"./external":16,"./stream/Crc32Probe":35,"./stream/DataLengthProbe":36,"./stream/DataWorker":37}],13:[function(Fe,Ct,K){var we=Fe("./stream/GenericWorker");K.STORE={magic:"\0\0",compressWorker:function(H){return new we("STORE compression")},uncompressWorker:function(){return new we("STORE decompression")}},K.DEFLATE=Fe("./flate")},{"./flate":17,"./stream/GenericWorker":38}],14:[function(Fe,Ct,K){var we=Fe("./utils");function H(){for(var X,Y=[],ge=0;ge<256;ge++){X=ge;for(var fe=0;fe<8;fe++)X=X&1?3988292384^X>>>1:X>>>1;Y[ge]=X}return Y}var L=H();function G(X,Y,ge,fe){var Se=L,ke=fe+ge;X=X^-1;for(var ie=fe;ie<ke;ie++)X=X>>>8^Se[(X^Y[ie])&255];return X^-1}function J(X,Y,ge,fe){var Se=L,ke=fe+ge;X=X^-1;for(var ie=fe;ie<ke;ie++)X=X>>>8^Se[(X^Y.charCodeAt(ie))&255];return X^-1}Ct.exports=function(Y,ge){if(typeof Y>"u"||!Y.length)return 0;var fe=we.getTypeOf(Y)!=="string";return fe?G(ge|0,Y,Y.length,0):J(ge|0,Y,Y.length,0)}},{"./utils":42}],15:[function(Fe,Ct,K){K.base64=!1,K.binary=!1,K.dir=!1,K.createFolders=!0,K.date=null,K.compression=null,K.compressionOptions=null,K.comment=null,K.unixPermissions=null,K.dosPermissions=null},{}],16:[function(Fe,Ct,K){var we=null;typeof Promise<"u"?we=Promise:we=Fe("lie"),Ct.exports={Promise:we}},{lie:46}],17:[function(Fe,Ct,K){var we=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",H=Fe("pako"),L=Fe("./utils"),G=Fe("./stream/GenericWorker"),J=we?"uint8array":"array";K.magic="\b\0";function X(Y,ge){G.call(this,"FlateWorker/"+Y),this._pako=null,this._pakoAction=Y,this._pakoOptions=ge,this.meta={}}L.inherits(X,G),X.prototype.processChunk=function(Y){this.meta=Y.meta,this._pako===null&&this._createPako(),this._pako.push(L.transformTo(J,Y.data),!1)},X.prototype.flush=function(){G.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},X.prototype.cleanUp=function(){G.prototype.cleanUp.call(this),this._pako=null},X.prototype._createPako=function(){this._pako=new H[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var Y=this;this._pako.onData=function(ge){Y.push({data:ge,meta:Y.meta})}},K.compressWorker=function(Y){return new X("Deflate",Y)},K.uncompressWorker=function(){return new X("Inflate",{})}},{"./stream/GenericWorker":38,"./utils":42,pako:47}],18:[function(Fe,Ct,K){var we=Fe("../utils"),H=Fe("../stream/GenericWorker"),L=Fe("../utf8"),G=Fe("../crc32"),J=Fe("../signature"),X=function(O,Z){var he="",$e;for($e=0;$e<Z;$e++)he+=String.fromCharCode(O&255),O=O>>>8;return he},Y=function(O,Z){var he=O;return O||(he=Z?16893:33204),(he&65535)<<16},ge=function(O,Z){return(O||0)&63},fe=function(O,Z,he,$e,te,xe){var Oe=O.file,Je=O.compression,ot=xe!==L.utf8encode,qe=we.transformTo("string",xe(Oe.name)),Et=we.transformTo("string",L.utf8encode(Oe.name)),Ye=Oe.comment,Be=we.transformTo("string",xe(Ye)),Qe=we.transformTo("string",L.utf8encode(Ye)),rt=Et.length!==Oe.name.length,lt=Qe.length!==Ye.length,xt,kt,qt="",Ft="",gr="",Yt=Oe.dir,Sr=Oe.date,zr={crc32:0,compressedSize:0,uncompressedSize:0};(!Z||he)&&(zr.crc32=O.crc32,zr.compressedSize=O.compressedSize,zr.uncompressedSize=O.uncompressedSize);var ht=0;Z&&(ht|=8),!ot&&(rt||lt)&&(ht|=2048);var ft=0,Ht=0;Yt&&(ft|=16),te==="UNIX"?(Ht=798,ft|=Y(Oe.unixPermissions,Yt)):(Ht=20,ft|=ge(Oe.dosPermissions)),xt=Sr.getUTCHours(),xt=xt<<6,xt=xt|Sr.getUTCMinutes(),xt=xt<<5,xt=xt|Sr.getUTCSeconds()/2,kt=Sr.getUTCFullYear()-1980,kt=kt<<4,kt=kt|Sr.getUTCMonth()+1,kt=kt<<5,kt=kt|Sr.getUTCDate(),rt&&(Ft=X(1,1)+X(G(qe),4)+Et,qt+="up"+X(Ft.length,2)+Ft),lt&&(gr=X(1,1)+X(G(Be),4)+Qe,qt+="uc"+X(gr.length,2)+gr);var hr="";hr+=`
\0`,hr+=X(ht,2),hr+=Je.magic,hr+=X(xt,2),hr+=X(kt,2),hr+=X(zr.crc32,4),hr+=X(zr.compressedSize,4),hr+=X(zr.uncompressedSize,4),hr+=X(qe.length,2),hr+=X(qt.length,2);var Br=J.LOCAL_FILE_HEADER+hr+qe+qt,Vr=J.CENTRAL_FILE_HEADER+X(Ht,2)+hr+X(Be.length,2)+"\0\0\0\0"+X(ft,4)+X($e,4)+qe+qt+Be;return{fileRecord:Br,dirRecord:Vr}},Se=function(O,Z,he,$e,te){var xe="",Oe=we.transformTo("string",te($e));return xe=J.CENTRAL_DIRECTORY_END+"\0\0\0\0"+X(O,2)+X(O,2)+X(Z,4)+X(he,4)+X(Oe.length,2)+Oe,xe},ke=function(O){var Z="";return Z=J.DATA_DESCRIPTOR+X(O.crc32,4)+X(O.compressedSize,4)+X(O.uncompressedSize,4),Z};function ie(O,Z,he,$e){H.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Z,this.zipPlatform=he,this.encodeFileName=$e,this.streamFiles=O,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}we.inherits(ie,H),ie.prototype.push=function(O){var Z=O.meta.percent||0,he=this.entriesCount,$e=this._sources.length;this.accumulate?this.contentBuffer.push(O):(this.bytesWritten+=O.data.length,H.prototype.push.call(this,{data:O.data,meta:{currentFile:this.currentFile,percent:he?(Z+100*(he-$e-1))/he:100}}))},ie.prototype.openedSource=function(O){this.currentSourceOffset=this.bytesWritten,this.currentFile=O.file.name;var Z=this.streamFiles&&!O.file.dir;if(Z){var he=fe(O,Z,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:he.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ie.prototype.closedSource=function(O){this.accumulate=!1;var Z=this.streamFiles&&!O.file.dir,he=fe(O,Z,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(he.dirRecord),Z)this.push({data:ke(O),meta:{percent:100}});else for(this.push({data:he.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ie.prototype.flush=function(){for(var O=this.bytesWritten,Z=0;Z<this.dirRecords.length;Z++)this.push({data:this.dirRecords[Z],meta:{percent:100}});var he=this.bytesWritten-O,$e=Se(this.dirRecords.length,he,O,this.zipComment,this.encodeFileName);this.push({data:$e,meta:{percent:100}})},ie.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ie.prototype.registerPrevious=function(O){this._sources.push(O);var Z=this;return O.on("data",function(he){Z.processChunk(he)}),O.on("end",function(){Z.closedSource(Z.previous.streamInfo),Z._sources.length?Z.prepareNextSource():Z.end()}),O.on("error",function(he){Z.error(he)}),this},ie.prototype.resume=function(){if(!H.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ie.prototype.error=function(O){var Z=this._sources;if(!H.prototype.error.call(this,O))return!1;for(var he=0;he<Z.length;he++)try{Z[he].error(O)}catch{}return!0},ie.prototype.lock=function(){H.prototype.lock.call(this);for(var O=this._sources,Z=0;Z<O.length;Z++)O[Z].lock()},Ct.exports=ie},{"../crc32":14,"../signature":33,"../stream/GenericWorker":38,"../utf8":41,"../utils":42}],19:[function(Fe,Ct,K){var we=Fe("../compressions"),H=Fe("./ZipFileWorker"),L=function(G,J){var X=G||J,Y=we[X];if(!Y)throw new Error(X+" is not a valid compression method !");return Y};K.generateWorker=function(G,J,X){var Y=new H(J.streamFiles,X,J.platform,J.encodeFileName),ge=0;try{G.forEach(function(fe,Se){ge++;var ke=L(Se.options.compression,J.compression),ie=Se.options.compressionOptions||J.compressionOptions||{},O=Se.dir,Z=Se.date;Se._compressWorker(ke,ie).withStreamInfo("file",{name:fe,dir:O,date:Z,comment:Se.comment||"",unixPermissions:Se.unixPermissions,dosPermissions:Se.dosPermissions}).pipe(Y)}),Y.entriesCount=ge}catch(fe){Y.error(fe)}return Y}},{"../compressions":13,"./ZipFileWorker":18}],20:[function(Fe,Ct,K){function we(){if(!(this instanceof we))return new we;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var H=new we;for(var L in this)typeof this[L]!="function"&&(H[L]=this[L]);return H}}we.prototype=Fe("./object"),we.prototype.loadAsync=Fe("./load"),we.support=Fe("./support"),we.defaults=Fe("./defaults"),we.version="3.5.0",we.loadAsync=function(H,L){return new we().loadAsync(H,L)},we.external=Fe("./external"),Ct.exports=we},{"./defaults":15,"./external":16,"./load":21,"./object":25,"./support":40}],21:[function(Fe,Ct,K){var L=Fe("./utils"),we=Fe("./external"),H=Fe("./utf8"),L=Fe("./utils"),G=Fe("./zipEntries"),J=Fe("./stream/Crc32Probe"),X=Fe("./nodejsUtils");function Y(ge){return new we.Promise(function(fe,Se){var ke=ge.decompressed.getContentWorker().pipe(new J);ke.on("error",function(ie){Se(ie)}).on("end",function(){ke.streamInfo.crc32!==ge.decompressed.crc32?Se(new Error("Corrupted zip : CRC32 mismatch")):fe()}).resume()})}Ct.exports=function(ge,fe){var Se=this;return fe=L.extend(fe||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:H.utf8decode}),X.isNode&&X.isStream(ge)?we.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):L.prepareContent("the loaded zip file",ge,!0,fe.optimizedBinaryString,fe.base64).then(function(ke){var ie=new G(fe);return ie.load(ke),ie}).then(function(ie){var O=[we.Promise.resolve(ie)],Z=ie.files;if(fe.checkCRC32)for(var he=0;he<Z.length;he++)O.push(Y(Z[he]));return we.Promise.all(O)}).then(function(ie){for(var O=ie.shift(),Z=O.files,he=0;he<Z.length;he++){var $e=Z[he];Se.file($e.fileNameStr,$e.decompressed,{binary:!0,optimizedBinaryString:!0,date:$e.date,dir:$e.dir,comment:$e.fileCommentStr.length?$e.fileCommentStr:null,unixPermissions:$e.unixPermissions,dosPermissions:$e.dosPermissions,createFolders:fe.createFolders})}return O.zipComment.length&&(Se.comment=O.zipComment),Se})}},{"./external":16,"./nodejsUtils":22,"./stream/Crc32Probe":35,"./utf8":41,"./utils":42,"./zipEntries":43}],22:[function(Fe,Ct,K){(function(we){Ct.exports={isNode:typeof we<"u",newBufferFrom:function(H,L){if(we.from&&we.from!==Uint8Array.from)return we.from(H,L);if(typeof H=="number")throw new Error('The "data" argument must not be a number');return new we(H,L)},allocBuffer:function(H){if(we.alloc)return we.alloc(H);var L=new we(H);return L.fill(0),L},isBuffer:function(H){return we.isBuffer(H)},isStream:function(H){return H&&typeof H.on=="function"&&typeof H.pause=="function"&&typeof H.resume=="function"}}}).call(this,Fe("buffer").Buffer)},{buffer:3}],23:[function(Fe,Ct,K){var we=Fe("../utils"),H=Fe("../stream/GenericWorker");function L(G,J){H.call(this,"Nodejs stream input adapter for "+G),this._upstreamEnded=!1,this._bindStream(J)}we.inherits(L,H),L.prototype._bindStream=function(G){var J=this;this._stream=G,G.pause(),G.on("data",function(X){J.push({data:X,meta:{percent:0}})}).on("error",function(X){J.isPaused?this.generatedError=X:J.error(X)}).on("end",function(){J.isPaused?J._upstreamEnded=!0:J.end()})},L.prototype.pause=function(){return H.prototype.pause.call(this)?(this._stream.pause(),!0):!1},L.prototype.resume=function(){return H.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},Ct.exports=L},{"../stream/GenericWorker":38,"../utils":42}],24:[function(Fe,Ct,K){var we=Fe("readable-stream").Readable,H=Fe("../utils");H.inherits(L,we);function L(G,J,X){we.call(this,J),this._helper=G;var Y=this;G.on("data",function(ge,fe){Y.push(ge)||Y._helper.pause(),X&&X(fe)}).on("error",function(ge){Y.emit("error",ge)}).on("end",function(){Y.push(null)})}L.prototype._read=function(){this._helper.resume()},Ct.exports=L},{"../utils":42,"readable-stream":26}],25:[function(Fe,Ct,K){var we=Fe("./utf8"),H=Fe("./utils"),L=Fe("./stream/GenericWorker"),G=Fe("./stream/StreamHelper"),J=Fe("./defaults"),X=Fe("./compressedObject"),Y=Fe("./zipObject"),ge=Fe("./generate"),fe=Fe("./nodejsUtils"),Se=Fe("./nodejs/NodejsStreamInputAdapter"),ke=function(te,xe,Oe){var Je=H.getTypeOf(xe),ot,qe=H.extend(Oe||{},J);qe.date=qe.date||new Date,qe.compression!==null&&(qe.compression=qe.compression.toUpperCase()),typeof qe.unixPermissions=="string"&&(qe.unixPermissions=parseInt(qe.unixPermissions,8)),qe.unixPermissions&&qe.unixPermissions&16384&&(qe.dir=!0),qe.dosPermissions&&qe.dosPermissions&16&&(qe.dir=!0),qe.dir&&(te=O(te)),qe.createFolders&&(ot=ie(te))&&Z.call(this,ot,!0);var Et=Je==="string"&&qe.binary===!1&&qe.base64===!1;(!Oe||typeof Oe.binary>"u")&&(qe.binary=!Et);var Ye=xe instanceof X&&xe.uncompressedSize===0;(Ye||qe.dir||!xe||xe.length===0)&&(qe.base64=!1,qe.binary=!0,xe="",qe.compression="STORE",Je="string");var Be=null;xe instanceof X||xe instanceof L?Be=xe:fe.isNode&&fe.isStream(xe)?Be=new Se(te,xe):Be=H.prepareContent(te,xe,qe.binary,qe.optimizedBinaryString,qe.base64);var Qe=new Y(te,Be,qe);this.files[te]=Qe},ie=function(te){te.slice(-1)==="/"&&(te=te.substring(0,te.length-1));var xe=te.lastIndexOf("/");return xe>0?te.substring(0,xe):""},O=function(te){return te.slice(-1)!=="/"&&(te+="/"),te},Z=function(te,xe){return xe=typeof xe<"u"?xe:J.createFolders,te=O(te),this.files[te]||ke.call(this,te,null,{dir:!0,createFolders:xe}),this.files[te]};function he(te){return Object.prototype.toString.call(te)==="[object RegExp]"}var $e={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(te){var xe,Oe,Je;for(xe in this.files)this.files.hasOwnProperty(xe)&&(Je=this.files[xe],Oe=xe.slice(this.root.length,xe.length),Oe&&xe.slice(0,this.root.length)===this.root&&te(Oe,Je))},filter:function(te){var xe=[];return this.forEach(function(Oe,Je){te(Oe,Je)&&xe.push(Je)}),xe},file:function(te,xe,Oe){if(arguments.length===1)if(he(te)){var Je=te;return this.filter(function(qe,Et){return!Et.dir&&Je.test(qe)})}else{var ot=this.files[this.root+te];return ot&&!ot.dir?ot:null}else te=this.root+te,ke.call(this,te,xe,Oe);return this},folder:function(te){if(!te)return this;if(he(te))return this.filter(function(ot,qe){return qe.dir&&te.test(ot)});var xe=this.root+te,Oe=Z.call(this,xe),Je=this.clone();return Je.root=Oe.name,Je},remove:function(te){te=this.root+te;var xe=this.files[te];if(xe||(te.slice(-1)!=="/"&&(te+="/"),xe=this.files[te]),xe&&!xe.dir)delete this.files[te];else for(var Oe=this.filter(function(ot,qe){return qe.name.slice(0,te.length)===te}),Je=0;Je<Oe.length;Je++)delete this.files[Oe[Je].name];return this},generate:function(te){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(te){var xe,Oe={};try{if(Oe=H.extend(te||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:we.utf8encode}),Oe.type=Oe.type.toLowerCase(),Oe.compression=Oe.compression.toUpperCase(),Oe.type==="binarystring"&&(Oe.type="string"),!Oe.type)throw new Error("No output type specified.");H.checkSupport(Oe.type),(Oe.platform==="darwin"||Oe.platform==="freebsd"||Oe.platform==="linux"||Oe.platform==="sunos")&&(Oe.platform="UNIX"),Oe.platform==="win32"&&(Oe.platform="DOS");var Je=Oe.comment||this.comment||"";xe=ge.generateWorker(this,Oe,Je)}catch(ot){xe=new L("error"),xe.error(ot)}return new G(xe,Oe.type||"string",Oe.mimeType)},generateAsync:function(te,xe){return this.generateInternalStream(te).accumulate(xe)},generateNodeStream:function(te,xe){return te=te||{},te.type||(te.type="nodebuffer"),this.generateInternalStream(te).toNodejsStream(xe)}};Ct.exports=$e},{"./compressedObject":12,"./defaults":15,"./generate":19,"./nodejs/NodejsStreamInputAdapter":23,"./nodejsUtils":22,"./stream/GenericWorker":38,"./stream/StreamHelper":39,"./utf8":41,"./utils":42,"./zipObject":45}],26:[function(Fe,Ct,K){Ct.exports=Fe("stream")},{stream:80}],27:[function(Fe,Ct,K){var we=Fe("./DataReader"),H=Fe("../utils");function L(G){we.call(this,G);for(var J=0;J<this.data.length;J++)G[J]=G[J]&255}H.inherits(L,we),L.prototype.byteAt=function(G){return this.data[this.zero+G]},L.prototype.lastIndexOfSignature=function(G){for(var J=G.charCodeAt(0),X=G.charCodeAt(1),Y=G.charCodeAt(2),ge=G.charCodeAt(3),fe=this.length-4;fe>=0;--fe)if(this.data[fe]===J&&this.data[fe+1]===X&&this.data[fe+2]===Y&&this.data[fe+3]===ge)return fe-this.zero;return-1},L.prototype.readAndCheckSignature=function(G){var J=G.charCodeAt(0),X=G.charCodeAt(1),Y=G.charCodeAt(2),ge=G.charCodeAt(3),fe=this.readData(4);return J===fe[0]&&X===fe[1]&&Y===fe[2]&&ge===fe[3]},L.prototype.readData=function(G){if(this.checkOffset(G),G===0)return[];var J=this.data.slice(this.zero+this.index,this.zero+this.index+G);return this.index+=G,J},Ct.exports=L},{"../utils":42,"./DataReader":28}],28:[function(Fe,Ct,K){var we=Fe("../utils");function H(L){this.data=L,this.length=L.length,this.index=0,this.zero=0}H.prototype={checkOffset:function(L){this.checkIndex(this.index+L)},checkIndex:function(L){if(this.length<this.zero+L||L<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+L+"). Corrupted zip ?")},setIndex:function(L){this.checkIndex(L),this.index=L},skip:function(L){this.setIndex(this.index+L)},byteAt:function(L){},readInt:function(L){var G=0,J;for(this.checkOffset(L),J=this.index+L-1;J>=this.index;J--)G=(G<<8)+this.byteAt(J);return this.index+=L,G},readString:function(L){return we.transformTo("string",this.readData(L))},readData:function(L){},lastIndexOfSignature:function(L){},readAndCheckSignature:function(L){},readDate:function(){var L=this.readInt(4);return new Date(Date.UTC((L>>25&127)+1980,(L>>21&15)-1,L>>16&31,L>>11&31,L>>5&63,(L&31)<<1))}},Ct.exports=H},{"../utils":42}],29:[function(Fe,Ct,K){var we=Fe("./Uint8ArrayReader"),H=Fe("../utils");function L(G){we.call(this,G)}H.inherits(L,we),L.prototype.readData=function(G){this.checkOffset(G);var J=this.data.slice(this.zero+this.index,this.zero+this.index+G);return this.index+=G,J},Ct.exports=L},{"../utils":42,"./Uint8ArrayReader":31}],30:[function(Fe,Ct,K){var we=Fe("./DataReader"),H=Fe("../utils");function L(G){we.call(this,G)}H.inherits(L,we),L.prototype.byteAt=function(G){return this.data.charCodeAt(this.zero+G)},L.prototype.lastIndexOfSignature=function(G){return this.data.lastIndexOf(G)-this.zero},L.prototype.readAndCheckSignature=function(G){var J=this.readData(4);return G===J},L.prototype.readData=function(G){this.checkOffset(G);var J=this.data.slice(this.zero+this.index,this.zero+this.index+G);return this.index+=G,J},Ct.exports=L},{"../utils":42,"./DataReader":28}],31:[function(Fe,Ct,K){var we=Fe("./ArrayReader"),H=Fe("../utils");function L(G){we.call(this,G)}H.inherits(L,we),L.prototype.readData=function(G){if(this.checkOffset(G),G===0)return new Uint8Array(0);var J=this.data.subarray(this.zero+this.index,this.zero+this.index+G);return this.index+=G,J},Ct.exports=L},{"../utils":42,"./ArrayReader":27}],32:[function(Fe,Ct,K){var we=Fe("../utils"),H=Fe("../support"),L=Fe("./ArrayReader"),G=Fe("./StringReader"),J=Fe("./NodeBufferReader"),X=Fe("./Uint8ArrayReader");Ct.exports=function(Y){var ge=we.getTypeOf(Y);return we.checkSupport(ge),ge==="string"&&!H.uint8array?new G(Y):ge==="nodebuffer"?new J(Y):H.uint8array?new X(we.transformTo("uint8array",Y)):new L(we.transformTo("array",Y))}},{"../support":40,"../utils":42,"./ArrayReader":27,"./NodeBufferReader":29,"./StringReader":30,"./Uint8ArrayReader":31}],33:[function(Fe,Ct,K){K.LOCAL_FILE_HEADER="PK",K.CENTRAL_FILE_HEADER="PK",K.CENTRAL_DIRECTORY_END="PK",K.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",K.ZIP64_CENTRAL_DIRECTORY_END="PK",K.DATA_DESCRIPTOR="PK\x07\b"},{}],34:[function(Fe,Ct,K){var we=Fe("./GenericWorker"),H=Fe("../utils");function L(G){we.call(this,"ConvertWorker to "+G),this.destType=G}H.inherits(L,we),L.prototype.processChunk=function(G){this.push({data:H.transformTo(this.destType,G.data),meta:G.meta})},Ct.exports=L},{"../utils":42,"./GenericWorker":38}],35:[function(Fe,Ct,K){var we=Fe("./GenericWorker"),H=Fe("../crc32"),L=Fe("../utils");function G(){we.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}L.inherits(G,we),G.prototype.processChunk=function(J){this.streamInfo.crc32=H(J.data,this.streamInfo.crc32||0),this.push(J)},Ct.exports=G},{"../crc32":14,"../utils":42,"./GenericWorker":38}],36:[function(Fe,Ct,K){var we=Fe("../utils"),H=Fe("./GenericWorker");function L(G){H.call(this,"DataLengthProbe for "+G),this.propName=G,this.withStreamInfo(G,0)}we.inherits(L,H),L.prototype.processChunk=function(G){if(G){var J=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=J+G.data.length}H.prototype.processChunk.call(this,G)},Ct.exports=L},{"../utils":42,"./GenericWorker":38}],37:[function(Fe,Ct,K){var we=Fe("../utils"),H=Fe("./GenericWorker"),L=16*1024;function G(J){H.call(this,"DataWorker");var X=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,J.then(function(Y){X.dataIsReady=!0,X.data=Y,X.max=Y&&Y.length||0,X.type=we.getTypeOf(Y),X.isPaused||X._tickAndRepeat()},function(Y){X.error(Y)})}we.inherits(G,H),G.prototype.cleanUp=function(){H.prototype.cleanUp.call(this),this.data=null},G.prototype.resume=function(){return H.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,we.delay(this._tickAndRepeat,[],this)),!0):!1},G.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(we.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},G.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var J=L,X=null,Y=Math.min(this.max,this.index+J);if(this.index>=this.max)return this.end();switch(this.type){case"string":X=this.data.substring(this.index,Y);break;case"uint8array":X=this.data.subarray(this.index,Y);break;case"array":case"nodebuffer":X=this.data.slice(this.index,Y);break}return this.index=Y,this.push({data:X,meta:{percent:this.max?this.index/this.max*100:0}})},Ct.exports=G},{"../utils":42,"./GenericWorker":38}],38:[function(Fe,Ct,K){function we(H){this.name=H||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}we.prototype={push:function(H){this.emit("data",H)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(H){this.emit("error",H)}return!0},error:function(H){return this.isFinished?!1:(this.isPaused?this.generatedError=H:(this.isFinished=!0,this.emit("error",H),this.previous&&this.previous.error(H),this.cleanUp()),!0)},on:function(H,L){return this._listeners[H].push(L),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(H,L){if(this._listeners[H])for(var G=0;G<this._listeners[H].length;G++)this._listeners[H][G].call(this,L)},pipe:function(H){return H.registerPrevious(this)},registerPrevious:function(H){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=H.streamInfo,this.mergeStreamInfo(),this.previous=H;var L=this;return H.on("data",function(G){L.processChunk(G)}),H.on("end",function(){L.end()}),H.on("error",function(G){L.error(G)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var H=!1;return this.generatedError&&(this.error(this.generatedError),H=!0),this.previous&&this.previous.resume(),!H},flush:function(){},processChunk:function(H){this.push(H)},withStreamInfo:function(H,L){return this.extraStreamInfo[H]=L,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var H in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(H)&&(this.streamInfo[H]=this.extraStreamInfo[H])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var H="Worker "+this.name;return this.previous?this.previous+" -> "+H:H}},Ct.exports=we},{}],39:[function(Fe,Ct,K){(function(we){var H=Fe("../utils"),L=Fe("./ConvertWorker"),G=Fe("./GenericWorker"),J=Fe("../base64"),X=Fe("../support"),Y=Fe("../external"),ge=null;if(X.nodestream)try{ge=Fe("../nodejs/NodejsStreamOutputAdapter")}catch{}function fe(O,Z,he){switch(O){case"blob":return H.newBlob(H.transformTo("arraybuffer",Z),he);case"base64":return J.encode(Z);default:return H.transformTo(O,Z)}}function Se(O,Z){var he,$e=0,te=null,xe=0;for(he=0;he<Z.length;he++)xe+=Z[he].length;switch(O){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(te=new Uint8Array(xe),he=0;he<Z.length;he++)te.set(Z[he],$e),$e+=Z[he].length;return te;case"nodebuffer":return we.concat(Z);default:throw new Error("concat : unsupported type '"+O+"'")}}function ke(O,Z){return new Y.Promise(function(he,$e){var te=[],xe=O._internalType,Oe=O._outputType,Je=O._mimeType;O.on("data",function(ot,qe){te.push(ot),Z&&Z(qe)}).on("error",function(ot){te=[],$e(ot)}).on("end",function(){try{var ot=fe(Oe,Se(xe,te),Je);he(ot)}catch(qe){$e(qe)}te=[]}).resume()})}function ie(O,Z,he){var $e=Z;switch(Z){case"blob":case"arraybuffer":$e="uint8array";break;case"base64":$e="string";break}try{this._internalType=$e,this._outputType=Z,this._mimeType=he,H.checkSupport($e),this._worker=O.pipe(new L($e)),O.lock()}catch(te){this._worker=new G("error"),this._worker.error(te)}}ie.prototype={accumulate:function(O){return ke(this,O)},on:function(O,Z){var he=this;return O==="data"?this._worker.on(O,function($e){Z.call(he,$e.data,$e.meta)}):this._worker.on(O,function(){H.delay(Z,arguments,he)}),this},resume:function(){return H.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(O){if(H.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new ge(this,{objectMode:this._outputType!=="nodebuffer"},O)}},Ct.exports=ie}).call(this,Fe("buffer").Buffer)},{"../base64":11,"../external":16,"../nodejs/NodejsStreamOutputAdapter":24,"../support":40,"../utils":42,"./ConvertWorker":34,"./GenericWorker":38,buffer:3}],40:[function(Fe,Ct,K){(function(we){if(K.base64=!0,K.array=!0,K.string=!0,K.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",K.nodebuffer=typeof we<"u",K.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")K.blob=!1;else{var H=new ArrayBuffer(0);try{K.blob=new Blob([H],{type:"application/zip"}).size===0}catch{try{var L=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,G=new L;G.append(H),K.blob=G.getBlob("application/zip").size===0}catch{K.blob=!1}}}try{K.nodestream=!!Fe("readable-stream").Readable}catch{K.nodestream=!1}}).call(this,Fe("buffer").Buffer)},{buffer:3,"readable-stream":26}],41:[function(Fe,Ct,K){for(var we=Fe("./utils"),H=Fe("./support"),L=Fe("./nodejsUtils"),G=Fe("./stream/GenericWorker"),J=new Array(256),X=0;X<256;X++)J[X]=X>=252?6:X>=248?5:X>=240?4:X>=224?3:X>=192?2:1;J[254]=J[254]=1;var Y=function(ie){var O,Z,he,$e,te,xe=ie.length,Oe=0;for($e=0;$e<xe;$e++)Z=ie.charCodeAt($e),(Z&64512)===55296&&$e+1<xe&&(he=ie.charCodeAt($e+1),(he&64512)===56320&&(Z=65536+(Z-55296<<10)+(he-56320),$e++)),Oe+=Z<128?1:Z<2048?2:Z<65536?3:4;for(H.uint8array?O=new Uint8Array(Oe):O=new Array(Oe),te=0,$e=0;te<Oe;$e++)Z=ie.charCodeAt($e),(Z&64512)===55296&&$e+1<xe&&(he=ie.charCodeAt($e+1),(he&64512)===56320&&(Z=65536+(Z-55296<<10)+(he-56320),$e++)),Z<128?O[te++]=Z:Z<2048?(O[te++]=192|Z>>>6,O[te++]=128|Z&63):Z<65536?(O[te++]=224|Z>>>12,O[te++]=128|Z>>>6&63,O[te++]=128|Z&63):(O[te++]=240|Z>>>18,O[te++]=128|Z>>>12&63,O[te++]=128|Z>>>6&63,O[te++]=128|Z&63);return O},ge=function(ie,O){var Z;for(O=O||ie.length,O>ie.length&&(O=ie.length),Z=O-1;Z>=0&&(ie[Z]&192)===128;)Z--;return Z<0||Z===0?O:Z+J[ie[Z]]>O?Z:O},fe=function(ie){var O,Z,he,$e,te=ie.length,xe=new Array(te*2);for(Z=0,O=0;O<te;){if(he=ie[O++],he<128){xe[Z++]=he;continue}if($e=J[he],$e>4){xe[Z++]=65533,O+=$e-1;continue}for(he&=$e===2?31:$e===3?15:7;$e>1&&O<te;)he=he<<6|ie[O++]&63,$e--;if($e>1){xe[Z++]=65533;continue}he<65536?xe[Z++]=he:(he-=65536,xe[Z++]=55296|he>>10&1023,xe[Z++]=56320|he&1023)}return xe.length!==Z&&(xe.subarray?xe=xe.subarray(0,Z):xe.length=Z),we.applyFromCharCode(xe)};K.utf8encode=function(O){return H.nodebuffer?L.newBufferFrom(O,"utf-8"):Y(O)},K.utf8decode=function(O){return H.nodebuffer?we.transformTo("nodebuffer",O).toString("utf-8"):(O=we.transformTo(H.uint8array?"uint8array":"array",O),fe(O))};function Se(){G.call(this,"utf-8 decode"),this.leftOver=null}we.inherits(Se,G),Se.prototype.processChunk=function(ie){var O=we.transformTo(H.uint8array?"uint8array":"array",ie.data);if(this.leftOver&&this.leftOver.length){if(H.uint8array){var Z=O;O=new Uint8Array(Z.length+this.leftOver.length),O.set(this.leftOver,0),O.set(Z,this.leftOver.length)}else O=this.leftOver.concat(O);this.leftOver=null}var he=ge(O),$e=O;he!==O.length&&(H.uint8array?($e=O.subarray(0,he),this.leftOver=O.subarray(he,O.length)):($e=O.slice(0,he),this.leftOver=O.slice(he,O.length))),this.push({data:K.utf8decode($e),meta:ie.meta})},Se.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:K.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},K.Utf8DecodeWorker=Se;function ke(){G.call(this,"utf-8 encode")}we.inherits(ke,G),ke.prototype.processChunk=function(ie){this.push({data:K.utf8encode(ie.data),meta:ie.meta})},K.Utf8EncodeWorker=ke},{"./nodejsUtils":22,"./stream/GenericWorker":38,"./support":40,"./utils":42}],42:[function(Fe,Ct,K){var we=Fe("./support"),H=Fe("./base64"),L=Fe("./nodejsUtils"),G=Fe("set-immediate-shim"),J=Fe("./external");function X(O){var Z=null;return we.uint8array?Z=new Uint8Array(O.length):Z=new Array(O.length),ge(O,Z)}K.newBlob=function(O,Z){K.checkSupport("blob");try{return new Blob([O],{type:Z})}catch{try{var he=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,$e=new he;return $e.append(O),$e.getBlob(Z)}catch{throw new Error("Bug : can't construct the Blob.")}}};function Y(O){return O}function ge(O,Z){for(var he=0;he<O.length;++he)Z[he]=O.charCodeAt(he)&255;return Z}var fe={stringifyByChunk:function(O,Z,he){var $e=[],te=0,xe=O.length;if(xe<=he)return String.fromCharCode.apply(null,O);for(;te<xe;)Z==="array"||Z==="nodebuffer"?$e.push(String.fromCharCode.apply(null,O.slice(te,Math.min(te+he,xe)))):$e.push(String.fromCharCode.apply(null,O.subarray(te,Math.min(te+he,xe)))),te+=he;return $e.join("")},stringifyByChar:function(O){for(var Z="",he=0;he<O.length;he++)Z+=String.fromCharCode(O[he]);return Z},applyCanBeUsed:{uint8array:function(){try{return we.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return we.nodebuffer&&String.fromCharCode.apply(null,L.allocBuffer(1)).length===1}catch{return!1}}()}};function Se(O){var Z=65536,he=K.getTypeOf(O),$e=!0;if(he==="uint8array"?$e=fe.applyCanBeUsed.uint8array:he==="nodebuffer"&&($e=fe.applyCanBeUsed.nodebuffer),$e)for(;Z>1;)try{return fe.stringifyByChunk(O,he,Z)}catch{Z=Math.floor(Z/2)}return fe.stringifyByChar(O)}K.applyFromCharCode=Se;function ke(O,Z){for(var he=0;he<O.length;he++)Z[he]=O[he];return Z}var ie={};ie.string={string:Y,array:function(O){return ge(O,new Array(O.length))},arraybuffer:function(O){return ie.string.uint8array(O).buffer},uint8array:function(O){return ge(O,new Uint8Array(O.length))},nodebuffer:function(O){return ge(O,L.allocBuffer(O.length))}},ie.array={string:Se,array:Y,arraybuffer:function(O){return new Uint8Array(O).buffer},uint8array:function(O){return new Uint8Array(O)},nodebuffer:function(O){return L.newBufferFrom(O)}},ie.arraybuffer={string:function(O){return Se(new Uint8Array(O))},array:function(O){return ke(new Uint8Array(O),new Array(O.byteLength))},arraybuffer:Y,uint8array:function(O){return new Uint8Array(O)},nodebuffer:function(O){return L.newBufferFrom(new Uint8Array(O))}},ie.uint8array={string:Se,array:function(O){return ke(O,new Array(O.length))},arraybuffer:function(O){return O.buffer},uint8array:Y,nodebuffer:function(O){return L.newBufferFrom(O)}},ie.nodebuffer={string:Se,array:function(O){return ke(O,new Array(O.length))},arraybuffer:function(O){return ie.nodebuffer.uint8array(O).buffer},uint8array:function(O){return ke(O,new Uint8Array(O.length))},nodebuffer:Y},K.transformTo=function(O,Z){if(Z||(Z=""),!O)return Z;K.checkSupport(O);var he=K.getTypeOf(Z),$e=ie[he][O](Z);return $e},K.getTypeOf=function(O){if(typeof O=="string")return"string";if(Object.prototype.toString.call(O)==="[object Array]")return"array";if(we.nodebuffer&&L.isBuffer(O))return"nodebuffer";if(we.uint8array&&O instanceof Uint8Array)return"uint8array";if(we.arraybuffer&&O instanceof ArrayBuffer)return"arraybuffer"},K.checkSupport=function(O){var Z=we[O.toLowerCase()];if(!Z)throw new Error(O+" is not supported by this platform")},K.MAX_VALUE_16BITS=65535,K.MAX_VALUE_32BITS=-1,K.pretty=function(O){var Z="",he,$e;for($e=0;$e<(O||"").length;$e++)he=O.charCodeAt($e),Z+="\\x"+(he<16?"0":"")+he.toString(16).toUpperCase();return Z},K.delay=function(O,Z,he){G(function(){O.apply(he||null,Z||[])})},K.inherits=function(O,Z){var he=function(){};he.prototype=Z.prototype,O.prototype=new he},K.extend=function(){var O={},Z,he;for(Z=0;Z<arguments.length;Z++)for(he in arguments[Z])arguments[Z].hasOwnProperty(he)&&typeof O[he]>"u"&&(O[he]=arguments[Z][he]);return O},K.prepareContent=function(O,Z,he,$e,te){var xe=J.Promise.resolve(Z).then(function(Oe){var Je=we.blob&&(Oe instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Oe))!==-1);return Je&&typeof FileReader<"u"?new J.Promise(function(ot,qe){var Et=new FileReader;Et.onload=function(Ye){ot(Ye.target.result)},Et.onerror=function(Ye){qe(Ye.target.error)},Et.readAsArrayBuffer(Oe)}):Oe});return xe.then(function(Oe){var Je=K.getTypeOf(Oe);return Je?(Je==="arraybuffer"?Oe=K.transformTo("uint8array",Oe):Je==="string"&&(te?Oe=H.decode(Oe):he&&$e!==!0&&(Oe=X(Oe))),Oe):J.Promise.reject(new Error("Can't read the data of '"+O+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":11,"./external":16,"./nodejsUtils":22,"./support":40,"set-immediate-shim":79}],43:[function(Fe,Ct,K){var we=Fe("./reader/readerFor"),H=Fe("./utils"),L=Fe("./signature"),G=Fe("./zipEntry");Fe("./utf8");var J=Fe("./support");function X(Y){this.files=[],this.loadOptions=Y}X.prototype={checkSignature:function(Y){if(!this.reader.readAndCheckSignature(Y)){this.reader.index-=4;var ge=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+H.pretty(ge)+", expected "+H.pretty(Y)+")")}},isSignature:function(Y,ge){var fe=this.reader.index;this.reader.setIndex(Y);var Se=this.reader.readString(4),ke=Se===ge;return this.reader.setIndex(fe),ke},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var Y=this.reader.readData(this.zipCommentLength),ge=J.uint8array?"uint8array":"array",fe=H.transformTo(ge,Y);this.zipComment=this.loadOptions.decodeFileName(fe)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var Y=this.zip64EndOfCentralSize-44,ge=0,fe,Se,ke;ge<Y;)fe=this.reader.readInt(2),Se=this.reader.readInt(4),ke=this.reader.readData(Se),this.zip64ExtensibleData[fe]={id:fe,length:Se,value:ke}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var Y,ge;for(Y=0;Y<this.files.length;Y++)ge=this.files[Y],this.reader.setIndex(ge.localHeaderOffset),this.checkSignature(L.LOCAL_FILE_HEADER),ge.readLocalPart(this.reader),ge.handleUTF8(),ge.processAttributes()},readCentralDir:function(){var Y;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(L.CENTRAL_FILE_HEADER);)Y=new G({zip64:this.zip64},this.loadOptions),Y.readCentralPart(this.reader),this.files.push(Y);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var Y=this.reader.lastIndexOfSignature(L.CENTRAL_DIRECTORY_END);if(Y<0){var ge=!this.isSignature(0,L.LOCAL_FILE_HEADER);throw ge?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(Y);var fe=Y;if(this.checkSignature(L.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===H.MAX_VALUE_16BITS||this.diskWithCentralDirStart===H.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===H.MAX_VALUE_16BITS||this.centralDirRecords===H.MAX_VALUE_16BITS||this.centralDirSize===H.MAX_VALUE_32BITS||this.centralDirOffset===H.MAX_VALUE_32BITS){if(this.zip64=!0,Y=this.reader.lastIndexOfSignature(L.ZIP64_CENTRAL_DIRECTORY_LOCATOR),Y<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(Y),this.checkSignature(L.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,L.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(L.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(L.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var Se=this.centralDirOffset+this.centralDirSize;this.zip64&&(Se+=20,Se+=12+this.zip64EndOfCentralSize);var ke=fe-Se;if(ke>0)this.isSignature(fe,L.CENTRAL_FILE_HEADER)||(this.reader.zero=ke);else if(ke<0)throw new Error("Corrupted zip: missing "+Math.abs(ke)+" bytes.")},prepareReader:function(Y){this.reader=we(Y)},load:function(Y){this.prepareReader(Y),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Ct.exports=X},{"./reader/readerFor":32,"./signature":33,"./support":40,"./utf8":41,"./utils":42,"./zipEntry":44}],44:[function(Fe,Ct,K){var we=Fe("./reader/readerFor"),H=Fe("./utils"),L=Fe("./compressedObject"),G=Fe("./crc32"),J=Fe("./utf8"),X=Fe("./compressions"),Y=Fe("./support"),ge=0,fe=3,Se=function(ie){for(var O in X)if(X.hasOwnProperty(O)&&X[O].magic===ie)return X[O];return null};function ke(ie,O){this.options=ie,this.loadOptions=O}ke.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(ie){var O,Z;if(ie.skip(22),this.fileNameLength=ie.readInt(2),Z=ie.readInt(2),this.fileName=ie.readData(this.fileNameLength),ie.skip(Z),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(O=Se(this.compressionMethod),O===null)throw new Error("Corrupted zip : compression "+H.pretty(this.compressionMethod)+" unknown (inner file : "+H.transformTo("string",this.fileName)+")");this.decompressed=new L(this.compressedSize,this.uncompressedSize,this.crc32,O,ie.readData(this.compressedSize))},readCentralPart:function(ie){this.versionMadeBy=ie.readInt(2),ie.skip(2),this.bitFlag=ie.readInt(2),this.compressionMethod=ie.readString(2),this.date=ie.readDate(),this.crc32=ie.readInt(4),this.compressedSize=ie.readInt(4),this.uncompressedSize=ie.readInt(4);var O=ie.readInt(2);if(this.extraFieldsLength=ie.readInt(2),this.fileCommentLength=ie.readInt(2),this.diskNumberStart=ie.readInt(2),this.internalFileAttributes=ie.readInt(2),this.externalFileAttributes=ie.readInt(4),this.localHeaderOffset=ie.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");ie.skip(O),this.readExtraFields(ie),this.parseZIP64ExtraField(ie),this.fileComment=ie.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var ie=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),ie===ge&&(this.dosPermissions=this.externalFileAttributes&63),ie===fe&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(ie){if(this.extraFields[1]){var O=we(this.extraFields[1].value);this.uncompressedSize===H.MAX_VALUE_32BITS&&(this.uncompressedSize=O.readInt(8)),this.compressedSize===H.MAX_VALUE_32BITS&&(this.compressedSize=O.readInt(8)),this.localHeaderOffset===H.MAX_VALUE_32BITS&&(this.localHeaderOffset=O.readInt(8)),this.diskNumberStart===H.MAX_VALUE_32BITS&&(this.diskNumberStart=O.readInt(4))}},readExtraFields:function(ie){var O=ie.index+this.extraFieldsLength,Z,he,$e;for(this.extraFields||(this.extraFields={});ie.index+4<O;)Z=ie.readInt(2),he=ie.readInt(2),$e=ie.readData(he),this.extraFields[Z]={id:Z,length:he,value:$e};ie.setIndex(O)},handleUTF8:function(){var ie=Y.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=J.utf8decode(this.fileName),this.fileCommentStr=J.utf8decode(this.fileComment);else{var O=this.findExtraFieldUnicodePath();if(O!==null)this.fileNameStr=O;else{var Z=H.transformTo(ie,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(Z)}var he=this.findExtraFieldUnicodeComment();if(he!==null)this.fileCommentStr=he;else{var $e=H.transformTo(ie,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName($e)}}},findExtraFieldUnicodePath:function(){var ie=this.extraFields[28789];if(ie){var O=we(ie.value);return O.readInt(1)!==1||G(this.fileName)!==O.readInt(4)?null:J.utf8decode(O.readData(ie.length-5))}return null},findExtraFieldUnicodeComment:function(){var ie=this.extraFields[25461];if(ie){var O=we(ie.value);return O.readInt(1)!==1||G(this.fileComment)!==O.readInt(4)?null:J.utf8decode(O.readData(ie.length-5))}return null}},Ct.exports=ke},{"./compressedObject":12,"./compressions":13,"./crc32":14,"./reader/readerFor":32,"./support":40,"./utf8":41,"./utils":42}],45:[function(Fe,Ct,K){var we=Fe("./stream/StreamHelper"),H=Fe("./stream/DataWorker"),L=Fe("./utf8"),G=Fe("./compressedObject"),J=Fe("./stream/GenericWorker"),X=function(Se,ke,ie){this.name=Se,this.dir=ie.dir,this.date=ie.date,this.comment=ie.comment,this.unixPermissions=ie.unixPermissions,this.dosPermissions=ie.dosPermissions,this._data=ke,this._dataBinary=ie.binary,this.options={compression:ie.compression,compressionOptions:ie.compressionOptions}};X.prototype={internalStream:function(Se){var ke=null,ie="string";try{if(!Se)throw new Error("No output type specified.");ie=Se.toLowerCase();var O=ie==="string"||ie==="text";(ie==="binarystring"||ie==="text")&&(ie="string"),ke=this._decompressWorker();var Z=!this._dataBinary;Z&&!O&&(ke=ke.pipe(new L.Utf8EncodeWorker)),!Z&&O&&(ke=ke.pipe(new L.Utf8DecodeWorker))}catch(he){ke=new J("error"),ke.error(he)}return new we(ke,ie,"")},async:function(Se,ke){return this.internalStream(Se).accumulate(ke)},nodeStream:function(Se,ke){return this.internalStream(Se||"nodebuffer").toNodejsStream(ke)},_compressWorker:function(Se,ke){if(this._data instanceof G&&this._data.compression.magic===Se.magic)return this._data.getCompressedWorker();var ie=this._decompressWorker();return this._dataBinary||(ie=ie.pipe(new L.Utf8EncodeWorker)),G.createWorkerFrom(ie,Se,ke)},_decompressWorker:function(){return this._data instanceof G?this._data.getContentWorker():this._data instanceof J?this._data:new H(this._data)}};for(var Y=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],ge=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},fe=0;fe<Y.length;fe++)X.prototype[Y[fe]]=ge;Ct.exports=X},{"./compressedObject":12,"./stream/DataWorker":37,"./stream/GenericWorker":38,"./stream/StreamHelper":39,"./utf8":41}],46:[function(Fe,Ct,K){var we=Fe("immediate");function H(){}var L={},G=["REJECTED"],J=["FULFILLED"],X=["PENDING"];Ct.exports=Y;function Y(te){if(typeof te!="function")throw new TypeError("resolver must be a function");this.state=X,this.queue=[],this.outcome=void 0,te!==H&&ke(this,te)}Y.prototype.finally=function(te){if(typeof te!="function")return this;var xe=this.constructor;return this.then(Oe,Je);function Oe(ot){function qe(){return ot}return xe.resolve(te()).then(qe)}function Je(ot){function qe(){throw ot}return xe.resolve(te()).then(qe)}},Y.prototype.catch=function(te){return this.then(null,te)},Y.prototype.then=function(te,xe){if(typeof te!="function"&&this.state===J||typeof xe!="function"&&this.state===G)return this;var Oe=new this.constructor(H);if(this.state!==X){var Je=this.state===J?te:xe;fe(Oe,Je,this.outcome)}else this.queue.push(new ge(Oe,te,xe));return Oe};function ge(te,xe,Oe){this.promise=te,typeof xe=="function"&&(this.onFulfilled=xe,this.callFulfilled=this.otherCallFulfilled),typeof Oe=="function"&&(this.onRejected=Oe,this.callRejected=this.otherCallRejected)}ge.prototype.callFulfilled=function(te){L.resolve(this.promise,te)},ge.prototype.otherCallFulfilled=function(te){fe(this.promise,this.onFulfilled,te)},ge.prototype.callRejected=function(te){L.reject(this.promise,te)},ge.prototype.otherCallRejected=function(te){fe(this.promise,this.onRejected,te)};function fe(te,xe,Oe){we(function(){var Je;try{Je=xe(Oe)}catch(ot){return L.reject(te,ot)}Je===te?L.reject(te,new TypeError("Cannot resolve promise with itself")):L.resolve(te,Je)})}L.resolve=function(te,xe){var Oe=ie(Se,xe);if(Oe.status==="error")return L.reject(te,Oe.value);var Je=Oe.value;if(Je)ke(te,Je);else{te.state=J,te.outcome=xe;for(var ot=-1,qe=te.queue.length;++ot<qe;)te.queue[ot].callFulfilled(xe)}return te},L.reject=function(te,xe){te.state=G,te.outcome=xe;for(var Oe=-1,Je=te.queue.length;++Oe<Je;)te.queue[Oe].callRejected(xe);return te};function Se(te){var xe=te&&te.then;if(te&&(typeof te=="object"||typeof te=="function")&&typeof xe=="function")return function(){xe.apply(te,arguments)}}function ke(te,xe){var Oe=!1;function Je(Ye){Oe||(Oe=!0,L.reject(te,Ye))}function ot(Ye){Oe||(Oe=!0,L.resolve(te,Ye))}function qe(){xe(ot,Je)}var Et=ie(qe);Et.status==="error"&&Je(Et.value)}function ie(te,xe){var Oe={};try{Oe.value=te(xe),Oe.status="success"}catch(Je){Oe.status="error",Oe.value=Je}return Oe}Y.resolve=O;function O(te){return te instanceof this?te:L.resolve(new this(H),te)}Y.reject=Z;function Z(te){var xe=new this(H);return L.reject(xe,te)}Y.all=he;function he(te){var xe=this;if(Object.prototype.toString.call(te)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Oe=te.length,Je=!1;if(!Oe)return this.resolve([]);for(var ot=new Array(Oe),qe=0,Et=-1,Ye=new this(H);++Et<Oe;)Be(te[Et],Et);return Ye;function Be(Qe,rt){xe.resolve(Qe).then(lt,function(xt){Je||(Je=!0,L.reject(Ye,xt))});function lt(xt){ot[rt]=xt,++qe===Oe&&!Je&&(Je=!0,L.resolve(Ye,ot))}}}Y.race=$e;function $e(te){var xe=this;if(Object.prototype.toString.call(te)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Oe=te.length,Je=!1;if(!Oe)return this.resolve([]);for(var ot=-1,qe=new this(H);++ot<Oe;)Et(te[ot]);return qe;function Et(Ye){xe.resolve(Ye).then(function(Be){Je||(Je=!0,L.resolve(qe,Be))},function(Be){Je||(Je=!0,L.reject(qe,Be))})}}},{immediate:7}],47:[function(Fe,Ct,K){var we=Fe("./lib/utils/common").assign,H=Fe("./lib/deflate"),L=Fe("./lib/inflate"),G=Fe("./lib/zlib/constants"),J={};we(J,H,L,G),Ct.exports=J},{"./lib/deflate":48,"./lib/inflate":49,"./lib/utils/common":50,"./lib/zlib/constants":53}],48:[function(Fe,Ct,K){var we=Fe("./zlib/deflate"),H=Fe("./utils/common"),L=Fe("./utils/strings"),G=Fe("./zlib/messages"),J=Fe("./zlib/zstream"),X=Object.prototype.toString,Y=0,ge=4,fe=0,Se=1,ke=2,ie=-1,O=0,Z=8;function he(Oe){if(!(this instanceof he))return new he(Oe);this.options=H.assign({level:ie,method:Z,chunkSize:16384,windowBits:15,memLevel:8,strategy:O,to:""},Oe||{});var Je=this.options;Je.raw&&Je.windowBits>0?Je.windowBits=-Je.windowBits:Je.gzip&&Je.windowBits>0&&Je.windowBits<16&&(Je.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new J,this.strm.avail_out=0;var ot=we.deflateInit2(this.strm,Je.level,Je.method,Je.windowBits,Je.memLevel,Je.strategy);if(ot!==fe)throw new Error(G[ot]);if(Je.header&&we.deflateSetHeader(this.strm,Je.header),Je.dictionary){var qe;if(typeof Je.dictionary=="string"?qe=L.string2buf(Je.dictionary):X.call(Je.dictionary)==="[object ArrayBuffer]"?qe=new Uint8Array(Je.dictionary):qe=Je.dictionary,ot=we.deflateSetDictionary(this.strm,qe),ot!==fe)throw new Error(G[ot]);this._dict_set=!0}}he.prototype.push=function(Oe,Je){var ot=this.strm,qe=this.options.chunkSize,Et,Ye;if(this.ended)return!1;Ye=Je===~~Je?Je:Je===!0?ge:Y,typeof Oe=="string"?ot.input=L.string2buf(Oe):X.call(Oe)==="[object ArrayBuffer]"?ot.input=new Uint8Array(Oe):ot.input=Oe,ot.next_in=0,ot.avail_in=ot.input.length;do{if(ot.avail_out===0&&(ot.output=new H.Buf8(qe),ot.next_out=0,ot.avail_out=qe),Et=we.deflate(ot,Ye),Et!==Se&&Et!==fe)return this.onEnd(Et),this.ended=!0,!1;(ot.avail_out===0||ot.avail_in===0&&(Ye===ge||Ye===ke))&&(this.options.to==="string"?this.onData(L.buf2binstring(H.shrinkBuf(ot.output,ot.next_out))):this.onData(H.shrinkBuf(ot.output,ot.next_out)))}while((ot.avail_in>0||ot.avail_out===0)&&Et!==Se);return Ye===ge?(Et=we.deflateEnd(this.strm),this.onEnd(Et),this.ended=!0,Et===fe):(Ye===ke&&(this.onEnd(fe),ot.avail_out=0),!0)},he.prototype.onData=function(Oe){this.chunks.push(Oe)},he.prototype.onEnd=function(Oe){Oe===fe&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=H.flattenChunks(this.chunks)),this.chunks=[],this.err=Oe,this.msg=this.strm.msg};function $e(Oe,Je){var ot=new he(Je);if(ot.push(Oe,!0),ot.err)throw ot.msg||G[ot.err];return ot.result}function te(Oe,Je){return Je=Je||{},Je.raw=!0,$e(Oe,Je)}function xe(Oe,Je){return Je=Je||{},Je.gzip=!0,$e(Oe,Je)}K.Deflate=he,K.deflate=$e,K.deflateRaw=te,K.gzip=xe},{"./utils/common":50,"./utils/strings":51,"./zlib/deflate":55,"./zlib/messages":60,"./zlib/zstream":62}],49:[function(Fe,Ct,K){var we=Fe("./zlib/inflate"),H=Fe("./utils/common"),L=Fe("./utils/strings"),G=Fe("./zlib/constants"),J=Fe("./zlib/messages"),X=Fe("./zlib/zstream"),Y=Fe("./zlib/gzheader"),ge=Object.prototype.toString;function fe(ie){if(!(this instanceof fe))return new fe(ie);this.options=H.assign({chunkSize:16384,windowBits:0,to:""},ie||{});var O=this.options;O.raw&&O.windowBits>=0&&O.windowBits<16&&(O.windowBits=-O.windowBits,O.windowBits===0&&(O.windowBits=-15)),O.windowBits>=0&&O.windowBits<16&&!(ie&&ie.windowBits)&&(O.windowBits+=32),O.windowBits>15&&O.windowBits<48&&(O.windowBits&15||(O.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new X,this.strm.avail_out=0;var Z=we.inflateInit2(this.strm,O.windowBits);if(Z!==G.Z_OK)throw new Error(J[Z]);if(this.header=new Y,we.inflateGetHeader(this.strm,this.header),O.dictionary&&(typeof O.dictionary=="string"?O.dictionary=L.string2buf(O.dictionary):ge.call(O.dictionary)==="[object ArrayBuffer]"&&(O.dictionary=new Uint8Array(O.dictionary)),O.raw&&(Z=we.inflateSetDictionary(this.strm,O.dictionary),Z!==G.Z_OK)))throw new Error(J[Z])}fe.prototype.push=function(ie,O){var Z=this.strm,he=this.options.chunkSize,$e=this.options.dictionary,te,xe,Oe,Je,ot,qe=!1;if(this.ended)return!1;xe=O===~~O?O:O===!0?G.Z_FINISH:G.Z_NO_FLUSH,typeof ie=="string"?Z.input=L.binstring2buf(ie):ge.call(ie)==="[object ArrayBuffer]"?Z.input=new Uint8Array(ie):Z.input=ie,Z.next_in=0,Z.avail_in=Z.input.length;do{if(Z.avail_out===0&&(Z.output=new H.Buf8(he),Z.next_out=0,Z.avail_out=he),te=we.inflate(Z,G.Z_NO_FLUSH),te===G.Z_NEED_DICT&&$e&&(te=we.inflateSetDictionary(this.strm,$e)),te===G.Z_BUF_ERROR&&qe===!0&&(te=G.Z_OK,qe=!1),te!==G.Z_STREAM_END&&te!==G.Z_OK)return this.onEnd(te),this.ended=!0,!1;Z.next_out&&(Z.avail_out===0||te===G.Z_STREAM_END||Z.avail_in===0&&(xe===G.Z_FINISH||xe===G.Z_SYNC_FLUSH))&&(this.options.to==="string"?(Oe=L.utf8border(Z.output,Z.next_out),Je=Z.next_out-Oe,ot=L.buf2string(Z.output,Oe),Z.next_out=Je,Z.avail_out=he-Je,Je&&H.arraySet(Z.output,Z.output,Oe,Je,0),this.onData(ot)):this.onData(H.shrinkBuf(Z.output,Z.next_out))),Z.avail_in===0&&Z.avail_out===0&&(qe=!0)}while((Z.avail_in>0||Z.avail_out===0)&&te!==G.Z_STREAM_END);return te===G.Z_STREAM_END&&(xe=G.Z_FINISH),xe===G.Z_FINISH?(te=we.inflateEnd(this.strm),this.onEnd(te),this.ended=!0,te===G.Z_OK):(xe===G.Z_SYNC_FLUSH&&(this.onEnd(G.Z_OK),Z.avail_out=0),!0)},fe.prototype.onData=function(ie){this.chunks.push(ie)},fe.prototype.onEnd=function(ie){ie===G.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=H.flattenChunks(this.chunks)),this.chunks=[],this.err=ie,this.msg=this.strm.msg};function Se(ie,O){var Z=new fe(O);if(Z.push(ie,!0),Z.err)throw Z.msg||J[Z.err];return Z.result}function ke(ie,O){return O=O||{},O.raw=!0,Se(ie,O)}K.Inflate=fe,K.inflate=Se,K.inflateRaw=ke,K.ungzip=Se},{"./utils/common":50,"./utils/strings":51,"./zlib/constants":53,"./zlib/gzheader":56,"./zlib/inflate":58,"./zlib/messages":60,"./zlib/zstream":62}],50:[function(Fe,Ct,K){var we=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function H(J,X){return Object.prototype.hasOwnProperty.call(J,X)}K.assign=function(J){for(var X=Array.prototype.slice.call(arguments,1);X.length;){var Y=X.shift();if(Y){if(typeof Y!="object")throw new TypeError(Y+"must be non-object");for(var ge in Y)H(Y,ge)&&(J[ge]=Y[ge])}}return J},K.shrinkBuf=function(J,X){return J.length===X?J:J.subarray?J.subarray(0,X):(J.length=X,J)};var L={arraySet:function(J,X,Y,ge,fe){if(X.subarray&&J.subarray){J.set(X.subarray(Y,Y+ge),fe);return}for(var Se=0;Se<ge;Se++)J[fe+Se]=X[Y+Se]},flattenChunks:function(J){var X,Y,ge,fe,Se,ke;for(ge=0,X=0,Y=J.length;X<Y;X++)ge+=J[X].length;for(ke=new Uint8Array(ge),fe=0,X=0,Y=J.length;X<Y;X++)Se=J[X],ke.set(Se,fe),fe+=Se.length;return ke}},G={arraySet:function(J,X,Y,ge,fe){for(var Se=0;Se<ge;Se++)J[fe+Se]=X[Y+Se]},flattenChunks:function(J){return[].concat.apply([],J)}};K.setTyped=function(J){J?(K.Buf8=Uint8Array,K.Buf16=Uint16Array,K.Buf32=Int32Array,K.assign(K,L)):(K.Buf8=Array,K.Buf16=Array,K.Buf32=Array,K.assign(K,G))},K.setTyped(we)},{}],51:[function(Fe,Ct,K){var we=Fe("./common"),H=!0,L=!0;try{String.fromCharCode.apply(null,[0])}catch{H=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{L=!1}for(var G=new we.Buf8(256),J=0;J<256;J++)G[J]=J>=252?6:J>=248?5:J>=240?4:J>=224?3:J>=192?2:1;G[254]=G[254]=1,K.string2buf=function(Y){var ge,fe,Se,ke,ie,O=Y.length,Z=0;for(ke=0;ke<O;ke++)fe=Y.charCodeAt(ke),(fe&64512)===55296&&ke+1<O&&(Se=Y.charCodeAt(ke+1),(Se&64512)===56320&&(fe=65536+(fe-55296<<10)+(Se-56320),ke++)),Z+=fe<128?1:fe<2048?2:fe<65536?3:4;for(ge=new we.Buf8(Z),ie=0,ke=0;ie<Z;ke++)fe=Y.charCodeAt(ke),(fe&64512)===55296&&ke+1<O&&(Se=Y.charCodeAt(ke+1),(Se&64512)===56320&&(fe=65536+(fe-55296<<10)+(Se-56320),ke++)),fe<128?ge[ie++]=fe:fe<2048?(ge[ie++]=192|fe>>>6,ge[ie++]=128|fe&63):fe<65536?(ge[ie++]=224|fe>>>12,ge[ie++]=128|fe>>>6&63,ge[ie++]=128|fe&63):(ge[ie++]=240|fe>>>18,ge[ie++]=128|fe>>>12&63,ge[ie++]=128|fe>>>6&63,ge[ie++]=128|fe&63);return ge};function X(Y,ge){if(ge<65534&&(Y.subarray&&L||!Y.subarray&&H))return String.fromCharCode.apply(null,we.shrinkBuf(Y,ge));for(var fe="",Se=0;Se<ge;Se++)fe+=String.fromCharCode(Y[Se]);return fe}K.buf2binstring=function(Y){return X(Y,Y.length)},K.binstring2buf=function(Y){for(var ge=new we.Buf8(Y.length),fe=0,Se=ge.length;fe<Se;fe++)ge[fe]=Y.charCodeAt(fe);return ge},K.buf2string=function(Y,ge){var fe,Se,ke,ie,O=ge||Y.length,Z=new Array(O*2);for(Se=0,fe=0;fe<O;){if(ke=Y[fe++],ke<128){Z[Se++]=ke;continue}if(ie=G[ke],ie>4){Z[Se++]=65533,fe+=ie-1;continue}for(ke&=ie===2?31:ie===3?15:7;ie>1&&fe<O;)ke=ke<<6|Y[fe++]&63,ie--;if(ie>1){Z[Se++]=65533;continue}ke<65536?Z[Se++]=ke:(ke-=65536,Z[Se++]=55296|ke>>10&1023,Z[Se++]=56320|ke&1023)}return X(Z,Se)},K.utf8border=function(Y,ge){var fe;for(ge=ge||Y.length,ge>Y.length&&(ge=Y.length),fe=ge-1;fe>=0&&(Y[fe]&192)===128;)fe--;return fe<0||fe===0?ge:fe+G[Y[fe]]>ge?fe:ge}},{"./common":50}],52:[function(Fe,Ct,K){function we(H,L,G,J){for(var X=H&65535|0,Y=H>>>16&65535|0,ge=0;G!==0;){ge=G>2e3?2e3:G,G-=ge;do X=X+L[J++]|0,Y=Y+X|0;while(--ge);X%=65521,Y%=65521}return X|Y<<16|0}Ct.exports=we},{}],53:[function(Fe,Ct,K){Ct.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],54:[function(Fe,Ct,K){function we(){for(var G,J=[],X=0;X<256;X++){G=X;for(var Y=0;Y<8;Y++)G=G&1?3988292384^G>>>1:G>>>1;J[X]=G}return J}var H=we();function L(G,J,X,Y){var ge=H,fe=Y+X;G^=-1;for(var Se=Y;Se<fe;Se++)G=G>>>8^ge[(G^J[Se])&255];return G^-1}Ct.exports=L},{}],55:[function(Fe,Ct,K){var we=Fe("../utils/common"),H=Fe("./trees"),L=Fe("./adler32"),G=Fe("./crc32"),J=Fe("./messages"),X=0,Y=1,ge=3,fe=4,Se=5,ke=0,ie=1,O=-2,Z=-3,he=-5,$e=-1,te=1,xe=2,Oe=3,Je=4,ot=0,qe=2,Et=8,Ye=9,Be=15,Qe=8,rt=29,lt=256,xt=lt+1+rt,kt=30,qt=19,Ft=2*xt+1,gr=15,Yt=3,Sr=258,zr=Sr+Yt+1,ht=32,ft=42,Ht=69,hr=73,Br=91,Vr=103,ma=113,ca=666,ua=1,Ge=2,Ke=3,zt=4,Vt=3;function $r(W,Pt){return W.msg=J[Pt],Pt}function Qr(W){return(W<<1)-(W>4?9:0)}function Me(W){for(var Pt=W.length;--Pt>=0;)W[Pt]=0}function oe(W){var Pt=W.state,Bt=Pt.pending;Bt>W.avail_out&&(Bt=W.avail_out),Bt!==0&&(we.arraySet(W.output,Pt.pending_buf,Pt.pending_out,Bt,W.next_out),W.next_out+=Bt,Pt.pending_out+=Bt,W.total_out+=Bt,W.avail_out-=Bt,Pt.pending-=Bt,Pt.pending===0&&(Pt.pending_out=0))}function se(W,Pt){H._tr_flush_block(W,W.block_start>=0?W.block_start:-1,W.strstart-W.block_start,Pt),W.block_start=W.strstart,oe(W.strm)}function Le(W,Pt){W.pending_buf[W.pending++]=Pt}function ut(W,Pt){W.pending_buf[W.pending++]=Pt>>>8&255,W.pending_buf[W.pending++]=Pt&255}function sr(W,Pt,Bt,Ce){var it=W.avail_in;return it>Ce&&(it=Ce),it===0?0:(W.avail_in-=it,we.arraySet(Pt,W.input,W.next_in,it,Bt),W.state.wrap===1?W.adler=L(W.adler,Pt,it,Bt):W.state.wrap===2&&(W.adler=G(W.adler,Pt,it,Bt)),W.next_in+=it,W.total_in+=it,it)}function Zt(W,Pt){var Bt=W.max_chain_length,Ce=W.strstart,it,Mt,ra=W.prev_length,Nr=W.nice_match,Er=W.strstart>W.w_size-zr?W.strstart-(W.w_size-zr):0,Ua=W.window,Gl=W.w_mask,$n=W.prev,Oa=W.strstart+Sr,Nn=Ua[Ce+ra-1],Bn=Ua[Ce+ra];W.prev_length>=W.good_match&&(Bt>>=2),Nr>W.lookahead&&(Nr=W.lookahead);do if(it=Pt,!(Ua[it+ra]!==Bn||Ua[it+ra-1]!==Nn||Ua[it]!==Ua[Ce]||Ua[++it]!==Ua[Ce+1])){Ce+=2,it++;do;while(Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ua[++Ce]===Ua[++it]&&Ce<Oa);if(Mt=Sr-(Oa-Ce),Ce=Oa-Sr,Mt>ra){if(W.match_start=Pt,ra=Mt,Mt>=Nr)break;Nn=Ua[Ce+ra-1],Bn=Ua[Ce+ra]}}while((Pt=$n[Pt&Gl])>Er&&--Bt!==0);return ra<=W.lookahead?ra:W.lookahead}function sa(W){var Pt=W.w_size,Bt,Ce,it,Mt,ra;do{if(Mt=W.window_size-W.lookahead-W.strstart,W.strstart>=Pt+(Pt-zr)){we.arraySet(W.window,W.window,Pt,Pt,0),W.match_start-=Pt,W.strstart-=Pt,W.block_start-=Pt,Ce=W.hash_size,Bt=Ce;do it=W.head[--Bt],W.head[Bt]=it>=Pt?it-Pt:0;while(--Ce);Ce=Pt,Bt=Ce;do it=W.prev[--Bt],W.prev[Bt]=it>=Pt?it-Pt:0;while(--Ce);Mt+=Pt}if(W.strm.avail_in===0)break;if(Ce=sr(W.strm,W.window,W.strstart+W.lookahead,Mt),W.lookahead+=Ce,W.lookahead+W.insert>=Yt)for(ra=W.strstart-W.insert,W.ins_h=W.window[ra],W.ins_h=(W.ins_h<<W.hash_shift^W.window[ra+1])&W.hash_mask;W.insert&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[ra+Yt-1])&W.hash_mask,W.prev[ra&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=ra,ra++,W.insert--,!(W.lookahead+W.insert<Yt)););}while(W.lookahead<zr&&W.strm.avail_in!==0)}function da(W,Pt){var Bt=65535;for(Bt>W.pending_buf_size-5&&(Bt=W.pending_buf_size-5);;){if(W.lookahead<=1){if(sa(W),W.lookahead===0&&Pt===X)return ua;if(W.lookahead===0)break}W.strstart+=W.lookahead,W.lookahead=0;var Ce=W.block_start+Bt;if((W.strstart===0||W.strstart>=Ce)&&(W.lookahead=W.strstart-Ce,W.strstart=Ce,se(W,!1),W.strm.avail_out===0)||W.strstart-W.block_start>=W.w_size-zr&&(se(W,!1),W.strm.avail_out===0))return ua}return W.insert=0,Pt===fe?(se(W,!0),W.strm.avail_out===0?Ke:zt):(W.strstart>W.block_start&&(se(W,!1),W.strm.avail_out===0),ua)}function Ur(W,Pt){for(var Bt,Ce;;){if(W.lookahead<zr){if(sa(W),W.lookahead<zr&&Pt===X)return ua;if(W.lookahead===0)break}if(Bt=0,W.lookahead>=Yt&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+Yt-1])&W.hash_mask,Bt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),Bt!==0&&W.strstart-Bt<=W.w_size-zr&&(W.match_length=Zt(W,Bt)),W.match_length>=Yt)if(Ce=H._tr_tally(W,W.strstart-W.match_start,W.match_length-Yt),W.lookahead-=W.match_length,W.match_length<=W.max_lazy_match&&W.lookahead>=Yt){W.match_length--;do W.strstart++,W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+Yt-1])&W.hash_mask,Bt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart;while(--W.match_length!==0);W.strstart++}else W.strstart+=W.match_length,W.match_length=0,W.ins_h=W.window[W.strstart],W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+1])&W.hash_mask;else Ce=H._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++;if(Ce&&(se(W,!1),W.strm.avail_out===0))return ua}return W.insert=W.strstart<Yt-1?W.strstart:Yt-1,Pt===fe?(se(W,!0),W.strm.avail_out===0?Ke:zt):W.last_lit&&(se(W,!1),W.strm.avail_out===0)?ua:Ge}function Sa(W,Pt){for(var Bt,Ce,it;;){if(W.lookahead<zr){if(sa(W),W.lookahead<zr&&Pt===X)return ua;if(W.lookahead===0)break}if(Bt=0,W.lookahead>=Yt&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+Yt-1])&W.hash_mask,Bt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),W.prev_length=W.match_length,W.prev_match=W.match_start,W.match_length=Yt-1,Bt!==0&&W.prev_length<W.max_lazy_match&&W.strstart-Bt<=W.w_size-zr&&(W.match_length=Zt(W,Bt),W.match_length<=5&&(W.strategy===te||W.match_length===Yt&&W.strstart-W.match_start>4096)&&(W.match_length=Yt-1)),W.prev_length>=Yt&&W.match_length<=W.prev_length){it=W.strstart+W.lookahead-Yt,Ce=H._tr_tally(W,W.strstart-1-W.prev_match,W.prev_length-Yt),W.lookahead-=W.prev_length-1,W.prev_length-=2;do++W.strstart<=it&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+Yt-1])&W.hash_mask,Bt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart);while(--W.prev_length!==0);if(W.match_available=0,W.match_length=Yt-1,W.strstart++,Ce&&(se(W,!1),W.strm.avail_out===0))return ua}else if(W.match_available){if(Ce=H._tr_tally(W,0,W.window[W.strstart-1]),Ce&&se(W,!1),W.strstart++,W.lookahead--,W.strm.avail_out===0)return ua}else W.match_available=1,W.strstart++,W.lookahead--}return W.match_available&&(Ce=H._tr_tally(W,0,W.window[W.strstart-1]),W.match_available=0),W.insert=W.strstart<Yt-1?W.strstart:Yt-1,Pt===fe?(se(W,!0),W.strm.avail_out===0?Ke:zt):W.last_lit&&(se(W,!1),W.strm.avail_out===0)?ua:Ge}function ha(W,Pt){for(var Bt,Ce,it,Mt,ra=W.window;;){if(W.lookahead<=Sr){if(sa(W),W.lookahead<=Sr&&Pt===X)return ua;if(W.lookahead===0)break}if(W.match_length=0,W.lookahead>=Yt&&W.strstart>0&&(it=W.strstart-1,Ce=ra[it],Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it])){Mt=W.strstart+Sr;do;while(Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it]&&Ce===ra[++it]&&it<Mt);W.match_length=Sr-(Mt-it),W.match_length>W.lookahead&&(W.match_length=W.lookahead)}if(W.match_length>=Yt?(Bt=H._tr_tally(W,1,W.match_length-Yt),W.lookahead-=W.match_length,W.strstart+=W.match_length,W.match_length=0):(Bt=H._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++),Bt&&(se(W,!1),W.strm.avail_out===0))return ua}return W.insert=0,Pt===fe?(se(W,!0),W.strm.avail_out===0?Ke:zt):W.last_lit&&(se(W,!1),W.strm.avail_out===0)?ua:Ge}function An(W,Pt){for(var Bt;;){if(W.lookahead===0&&(sa(W),W.lookahead===0)){if(Pt===X)return ua;break}if(W.match_length=0,Bt=H._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++,Bt&&(se(W,!1),W.strm.avail_out===0))return ua}return W.insert=0,Pt===fe?(se(W,!0),W.strm.avail_out===0?Ke:zt):W.last_lit&&(se(W,!1),W.strm.avail_out===0)?ua:Ge}function Ta(W,Pt,Bt,Ce,it){this.good_length=W,this.max_lazy=Pt,this.nice_length=Bt,this.max_chain=Ce,this.func=it}var Va;Va=[new Ta(0,0,0,0,da),new Ta(4,4,8,4,Ur),new Ta(4,5,16,8,Ur),new Ta(4,6,32,32,Ur),new Ta(4,4,16,16,Sa),new Ta(8,16,32,32,Sa),new Ta(8,16,128,128,Sa),new Ta(8,32,128,256,Sa),new Ta(32,128,258,1024,Sa),new Ta(32,258,258,4096,Sa)];function In(W){W.window_size=2*W.w_size,Me(W.head),W.max_lazy_match=Va[W.level].max_lazy,W.good_match=Va[W.level].good_length,W.nice_match=Va[W.level].nice_length,W.max_chain_length=Va[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=Yt-1,W.match_available=0,W.ins_h=0}function Pe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Et,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new we.Buf16(Ft*2),this.dyn_dtree=new we.Buf16((2*kt+1)*2),this.bl_tree=new we.Buf16((2*qt+1)*2),Me(this.dyn_ltree),Me(this.dyn_dtree),Me(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new we.Buf16(gr+1),this.heap=new we.Buf16(2*xt+1),Me(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new we.Buf16(2*xt+1),Me(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function cr(W){var Pt;return!W||!W.state?$r(W,O):(W.total_in=W.total_out=0,W.data_type=qe,Pt=W.state,Pt.pending=0,Pt.pending_out=0,Pt.wrap<0&&(Pt.wrap=-Pt.wrap),Pt.status=Pt.wrap?ft:ma,W.adler=Pt.wrap===2?0:1,Pt.last_flush=X,H._tr_init(Pt),ke)}function wr(W){var Pt=cr(W);return Pt===ke&&In(W.state),Pt}function Gr(W,Pt){return!W||!W.state||W.state.wrap!==2?O:(W.state.gzhead=Pt,ke)}function yt(W,Pt,Bt,Ce,it,Mt){if(!W)return O;var ra=1;if(Pt===$e&&(Pt=6),Ce<0?(ra=0,Ce=-Ce):Ce>15&&(ra=2,Ce-=16),it<1||it>Ye||Bt!==Et||Ce<8||Ce>15||Pt<0||Pt>9||Mt<0||Mt>Je)return $r(W,O);Ce===8&&(Ce=9);var Nr=new Pe;return W.state=Nr,Nr.strm=W,Nr.wrap=ra,Nr.gzhead=null,Nr.w_bits=Ce,Nr.w_size=1<<Nr.w_bits,Nr.w_mask=Nr.w_size-1,Nr.hash_bits=it+7,Nr.hash_size=1<<Nr.hash_bits,Nr.hash_mask=Nr.hash_size-1,Nr.hash_shift=~~((Nr.hash_bits+Yt-1)/Yt),Nr.window=new we.Buf8(Nr.w_size*2),Nr.head=new we.Buf16(Nr.hash_size),Nr.prev=new we.Buf16(Nr.w_size),Nr.lit_bufsize=1<<it+6,Nr.pending_buf_size=Nr.lit_bufsize*4,Nr.pending_buf=new we.Buf8(Nr.pending_buf_size),Nr.d_buf=1*Nr.lit_bufsize,Nr.l_buf=3*Nr.lit_bufsize,Nr.level=Pt,Nr.strategy=Mt,Nr.method=Bt,wr(W)}function Gt(W,Pt){return yt(W,Pt,Et,Be,Qe,ot)}function Ie(W,Pt){var Bt,Ce,it,Mt;if(!W||!W.state||Pt>Se||Pt<0)return W?$r(W,O):O;if(Ce=W.state,!W.output||!W.input&&W.avail_in!==0||Ce.status===ca&&Pt!==fe)return $r(W,W.avail_out===0?he:O);if(Ce.strm=W,Bt=Ce.last_flush,Ce.last_flush=Pt,Ce.status===ft)if(Ce.wrap===2)W.adler=0,Le(Ce,31),Le(Ce,139),Le(Ce,8),Ce.gzhead?(Le(Ce,(Ce.gzhead.text?1:0)+(Ce.gzhead.hcrc?2:0)+(Ce.gzhead.extra?4:0)+(Ce.gzhead.name?8:0)+(Ce.gzhead.comment?16:0)),Le(Ce,Ce.gzhead.time&255),Le(Ce,Ce.gzhead.time>>8&255),Le(Ce,Ce.gzhead.time>>16&255),Le(Ce,Ce.gzhead.time>>24&255),Le(Ce,Ce.level===9?2:Ce.strategy>=xe||Ce.level<2?4:0),Le(Ce,Ce.gzhead.os&255),Ce.gzhead.extra&&Ce.gzhead.extra.length&&(Le(Ce,Ce.gzhead.extra.length&255),Le(Ce,Ce.gzhead.extra.length>>8&255)),Ce.gzhead.hcrc&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending,0)),Ce.gzindex=0,Ce.status=Ht):(Le(Ce,0),Le(Ce,0),Le(Ce,0),Le(Ce,0),Le(Ce,0),Le(Ce,Ce.level===9?2:Ce.strategy>=xe||Ce.level<2?4:0),Le(Ce,Vt),Ce.status=ma);else{var ra=Et+(Ce.w_bits-8<<4)<<8,Nr=-1;Ce.strategy>=xe||Ce.level<2?Nr=0:Ce.level<6?Nr=1:Ce.level===6?Nr=2:Nr=3,ra|=Nr<<6,Ce.strstart!==0&&(ra|=ht),ra+=31-ra%31,Ce.status=ma,ut(Ce,ra),Ce.strstart!==0&&(ut(Ce,W.adler>>>16),ut(Ce,W.adler&65535)),W.adler=1}if(Ce.status===Ht)if(Ce.gzhead.extra){for(it=Ce.pending;Ce.gzindex<(Ce.gzhead.extra.length&65535)&&!(Ce.pending===Ce.pending_buf_size&&(Ce.gzhead.hcrc&&Ce.pending>it&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending-it,it)),oe(W),it=Ce.pending,Ce.pending===Ce.pending_buf_size));)Le(Ce,Ce.gzhead.extra[Ce.gzindex]&255),Ce.gzindex++;Ce.gzhead.hcrc&&Ce.pending>it&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending-it,it)),Ce.gzindex===Ce.gzhead.extra.length&&(Ce.gzindex=0,Ce.status=hr)}else Ce.status=hr;if(Ce.status===hr)if(Ce.gzhead.name){it=Ce.pending;do{if(Ce.pending===Ce.pending_buf_size&&(Ce.gzhead.hcrc&&Ce.pending>it&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending-it,it)),oe(W),it=Ce.pending,Ce.pending===Ce.pending_buf_size)){Mt=1;break}Ce.gzindex<Ce.gzhead.name.length?Mt=Ce.gzhead.name.charCodeAt(Ce.gzindex++)&255:Mt=0,Le(Ce,Mt)}while(Mt!==0);Ce.gzhead.hcrc&&Ce.pending>it&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending-it,it)),Mt===0&&(Ce.gzindex=0,Ce.status=Br)}else Ce.status=Br;if(Ce.status===Br)if(Ce.gzhead.comment){it=Ce.pending;do{if(Ce.pending===Ce.pending_buf_size&&(Ce.gzhead.hcrc&&Ce.pending>it&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending-it,it)),oe(W),it=Ce.pending,Ce.pending===Ce.pending_buf_size)){Mt=1;break}Ce.gzindex<Ce.gzhead.comment.length?Mt=Ce.gzhead.comment.charCodeAt(Ce.gzindex++)&255:Mt=0,Le(Ce,Mt)}while(Mt!==0);Ce.gzhead.hcrc&&Ce.pending>it&&(W.adler=G(W.adler,Ce.pending_buf,Ce.pending-it,it)),Mt===0&&(Ce.status=Vr)}else Ce.status=Vr;if(Ce.status===Vr&&(Ce.gzhead.hcrc?(Ce.pending+2>Ce.pending_buf_size&&oe(W),Ce.pending+2<=Ce.pending_buf_size&&(Le(Ce,W.adler&255),Le(Ce,W.adler>>8&255),W.adler=0,Ce.status=ma)):Ce.status=ma),Ce.pending!==0){if(oe(W),W.avail_out===0)return Ce.last_flush=-1,ke}else if(W.avail_in===0&&Qr(Pt)<=Qr(Bt)&&Pt!==fe)return $r(W,he);if(Ce.status===ca&&W.avail_in!==0)return $r(W,he);if(W.avail_in!==0||Ce.lookahead!==0||Pt!==X&&Ce.status!==ca){var Er=Ce.strategy===xe?An(Ce,Pt):Ce.strategy===Oe?ha(Ce,Pt):Va[Ce.level].func(Ce,Pt);if((Er===Ke||Er===zt)&&(Ce.status=ca),Er===ua||Er===Ke)return W.avail_out===0&&(Ce.last_flush=-1),ke;if(Er===Ge&&(Pt===Y?H._tr_align(Ce):Pt!==Se&&(H._tr_stored_block(Ce,0,0,!1),Pt===ge&&(Me(Ce.head),Ce.lookahead===0&&(Ce.strstart=0,Ce.block_start=0,Ce.insert=0))),oe(W),W.avail_out===0))return Ce.last_flush=-1,ke}return Pt!==fe?ke:Ce.wrap<=0?ie:(Ce.wrap===2?(Le(Ce,W.adler&255),Le(Ce,W.adler>>8&255),Le(Ce,W.adler>>16&255),Le(Ce,W.adler>>24&255),Le(Ce,W.total_in&255),Le(Ce,W.total_in>>8&255),Le(Ce,W.total_in>>16&255),Le(Ce,W.total_in>>24&255)):(ut(Ce,W.adler>>>16),ut(Ce,W.adler&65535)),oe(W),Ce.wrap>0&&(Ce.wrap=-Ce.wrap),Ce.pending!==0?ke:ie)}function pr(W){var Pt;return!W||!W.state?O:(Pt=W.state.status,Pt!==ft&&Pt!==Ht&&Pt!==hr&&Pt!==Br&&Pt!==Vr&&Pt!==ma&&Pt!==ca?$r(W,O):(W.state=null,Pt===ma?$r(W,Z):ke))}function xa(W,Pt){var Bt=Pt.length,Ce,it,Mt,ra,Nr,Er,Ua,Gl;if(!W||!W.state||(Ce=W.state,ra=Ce.wrap,ra===2||ra===1&&Ce.status!==ft||Ce.lookahead))return O;for(ra===1&&(W.adler=L(W.adler,Pt,Bt,0)),Ce.wrap=0,Bt>=Ce.w_size&&(ra===0&&(Me(Ce.head),Ce.strstart=0,Ce.block_start=0,Ce.insert=0),Gl=new we.Buf8(Ce.w_size),we.arraySet(Gl,Pt,Bt-Ce.w_size,Ce.w_size,0),Pt=Gl,Bt=Ce.w_size),Nr=W.avail_in,Er=W.next_in,Ua=W.input,W.avail_in=Bt,W.next_in=0,W.input=Pt,sa(Ce);Ce.lookahead>=Yt;){it=Ce.strstart,Mt=Ce.lookahead-(Yt-1);do Ce.ins_h=(Ce.ins_h<<Ce.hash_shift^Ce.window[it+Yt-1])&Ce.hash_mask,Ce.prev[it&Ce.w_mask]=Ce.head[Ce.ins_h],Ce.head[Ce.ins_h]=it,it++;while(--Mt);Ce.strstart=it,Ce.lookahead=Yt-1,sa(Ce)}return Ce.strstart+=Ce.lookahead,Ce.block_start=Ce.strstart,Ce.insert=Ce.lookahead,Ce.lookahead=0,Ce.match_length=Ce.prev_length=Yt-1,Ce.match_available=0,W.next_in=Er,W.input=Ua,W.avail_in=Nr,Ce.wrap=ra,ke}K.deflateInit=Gt,K.deflateInit2=yt,K.deflateReset=wr,K.deflateResetKeep=cr,K.deflateSetHeader=Gr,K.deflate=Ie,K.deflateEnd=pr,K.deflateSetDictionary=xa,K.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":50,"./adler32":52,"./crc32":54,"./messages":60,"./trees":61}],56:[function(Fe,Ct,K){function we(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}Ct.exports=we},{}],57:[function(Fe,Ct,K){var we=30,H=12;Ct.exports=function(G,J){var X,Y,ge,fe,Se,ke,ie,O,Z,he,$e,te,xe,Oe,Je,ot,qe,Et,Ye,Be,Qe,rt,lt,xt,kt;X=G.state,Y=G.next_in,xt=G.input,ge=Y+(G.avail_in-5),fe=G.next_out,kt=G.output,Se=fe-(J-G.avail_out),ke=fe+(G.avail_out-257),ie=X.dmax,O=X.wsize,Z=X.whave,he=X.wnext,$e=X.window,te=X.hold,xe=X.bits,Oe=X.lencode,Je=X.distcode,ot=(1<<X.lenbits)-1,qe=(1<<X.distbits)-1;e:do{xe<15&&(te+=xt[Y++]<<xe,xe+=8,te+=xt[Y++]<<xe,xe+=8),Et=Oe[te&ot];t:for(;;){if(Ye=Et>>>24,te>>>=Ye,xe-=Ye,Ye=Et>>>16&255,Ye===0)kt[fe++]=Et&65535;else if(Ye&16){Be=Et&65535,Ye&=15,Ye&&(xe<Ye&&(te+=xt[Y++]<<xe,xe+=8),Be+=te&(1<<Ye)-1,te>>>=Ye,xe-=Ye),xe<15&&(te+=xt[Y++]<<xe,xe+=8,te+=xt[Y++]<<xe,xe+=8),Et=Je[te&qe];r:for(;;){if(Ye=Et>>>24,te>>>=Ye,xe-=Ye,Ye=Et>>>16&255,Ye&16){if(Qe=Et&65535,Ye&=15,xe<Ye&&(te+=xt[Y++]<<xe,xe+=8,xe<Ye&&(te+=xt[Y++]<<xe,xe+=8)),Qe+=te&(1<<Ye)-1,Qe>ie){G.msg="invalid distance too far back",X.mode=we;break e}if(te>>>=Ye,xe-=Ye,Ye=fe-Se,Qe>Ye){if(Ye=Qe-Ye,Ye>Z&&X.sane){G.msg="invalid distance too far back",X.mode=we;break e}if(rt=0,lt=$e,he===0){if(rt+=O-Ye,Ye<Be){Be-=Ye;do kt[fe++]=$e[rt++];while(--Ye);rt=fe-Qe,lt=kt}}else if(he<Ye){if(rt+=O+he-Ye,Ye-=he,Ye<Be){Be-=Ye;do kt[fe++]=$e[rt++];while(--Ye);if(rt=0,he<Be){Ye=he,Be-=Ye;do kt[fe++]=$e[rt++];while(--Ye);rt=fe-Qe,lt=kt}}}else if(rt+=he-Ye,Ye<Be){Be-=Ye;do kt[fe++]=$e[rt++];while(--Ye);rt=fe-Qe,lt=kt}for(;Be>2;)kt[fe++]=lt[rt++],kt[fe++]=lt[rt++],kt[fe++]=lt[rt++],Be-=3;Be&&(kt[fe++]=lt[rt++],Be>1&&(kt[fe++]=lt[rt++]))}else{rt=fe-Qe;do kt[fe++]=kt[rt++],kt[fe++]=kt[rt++],kt[fe++]=kt[rt++],Be-=3;while(Be>2);Be&&(kt[fe++]=kt[rt++],Be>1&&(kt[fe++]=kt[rt++]))}}else if(Ye&64){G.msg="invalid distance code",X.mode=we;break e}else{Et=Je[(Et&65535)+(te&(1<<Ye)-1)];continue r}break}}else if(Ye&64)if(Ye&32){X.mode=H;break e}else{G.msg="invalid literal/length code",X.mode=we;break e}else{Et=Oe[(Et&65535)+(te&(1<<Ye)-1)];continue t}break}}while(Y<ge&&fe<ke);Be=xe>>3,Y-=Be,xe-=Be<<3,te&=(1<<xe)-1,G.next_in=Y,G.next_out=fe,G.avail_in=Y<ge?5+(ge-Y):5-(Y-ge),G.avail_out=fe<ke?257+(ke-fe):257-(fe-ke),X.hold=te,X.bits=xe}},{}],58:[function(Fe,Ct,K){var we=Fe("../utils/common"),H=Fe("./adler32"),L=Fe("./crc32"),G=Fe("./inffast"),J=Fe("./inftrees"),X=0,Y=1,ge=2,fe=4,Se=5,ke=6,ie=0,O=1,Z=2,he=-2,$e=-3,te=-4,xe=-5,Oe=8,Je=1,ot=2,qe=3,Et=4,Ye=5,Be=6,Qe=7,rt=8,lt=9,xt=10,kt=11,qt=12,Ft=13,gr=14,Yt=15,Sr=16,zr=17,ht=18,ft=19,Ht=20,hr=21,Br=22,Vr=23,ma=24,ca=25,ua=26,Ge=27,Ke=28,zt=29,Vt=30,$r=31,Qr=32,Me=852,oe=592,se=15,Le=se;function ut(yt){return(yt>>>24&255)+(yt>>>8&65280)+((yt&65280)<<8)+((yt&255)<<24)}function sr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new we.Buf16(320),this.work=new we.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Zt(yt){var Gt;return!yt||!yt.state?he:(Gt=yt.state,yt.total_in=yt.total_out=Gt.total=0,yt.msg="",Gt.wrap&&(yt.adler=Gt.wrap&1),Gt.mode=Je,Gt.last=0,Gt.havedict=0,Gt.dmax=32768,Gt.head=null,Gt.hold=0,Gt.bits=0,Gt.lencode=Gt.lendyn=new we.Buf32(Me),Gt.distcode=Gt.distdyn=new we.Buf32(oe),Gt.sane=1,Gt.back=-1,ie)}function sa(yt){var Gt;return!yt||!yt.state?he:(Gt=yt.state,Gt.wsize=0,Gt.whave=0,Gt.wnext=0,Zt(yt))}function da(yt,Gt){var Ie,pr;return!yt||!yt.state||(pr=yt.state,Gt<0?(Ie=0,Gt=-Gt):(Ie=(Gt>>4)+1,Gt<48&&(Gt&=15)),Gt&&(Gt<8||Gt>15))?he:(pr.window!==null&&pr.wbits!==Gt&&(pr.window=null),pr.wrap=Ie,pr.wbits=Gt,sa(yt))}function Ur(yt,Gt){var Ie,pr;return yt?(pr=new sr,yt.state=pr,pr.window=null,Ie=da(yt,Gt),Ie!==ie&&(yt.state=null),Ie):he}function Sa(yt){return Ur(yt,Le)}var ha=!0,An,Ta;function Va(yt){if(ha){var Gt;for(An=new we.Buf32(512),Ta=new we.Buf32(32),Gt=0;Gt<144;)yt.lens[Gt++]=8;for(;Gt<256;)yt.lens[Gt++]=9;for(;Gt<280;)yt.lens[Gt++]=7;for(;Gt<288;)yt.lens[Gt++]=8;for(J(Y,yt.lens,0,288,An,0,yt.work,{bits:9}),Gt=0;Gt<32;)yt.lens[Gt++]=5;J(ge,yt.lens,0,32,Ta,0,yt.work,{bits:5}),ha=!1}yt.lencode=An,yt.lenbits=9,yt.distcode=Ta,yt.distbits=5}function In(yt,Gt,Ie,pr){var xa,W=yt.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new we.Buf8(W.wsize)),pr>=W.wsize?(we.arraySet(W.window,Gt,Ie-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(xa=W.wsize-W.wnext,xa>pr&&(xa=pr),we.arraySet(W.window,Gt,Ie-pr,xa,W.wnext),pr-=xa,pr?(we.arraySet(W.window,Gt,Ie-pr,pr,0),W.wnext=pr,W.whave=W.wsize):(W.wnext+=xa,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=xa))),0}function Pe(yt,Gt){var Ie,pr,xa,W,Pt,Bt,Ce,it,Mt,ra,Nr,Er,Ua,Gl,$n=0,Oa,Nn,Bn,Qa,ti,Il,yn,el,Yn=new we.Buf8(4),Rl,El,Gi=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!yt||!yt.state||!yt.output||!yt.input&&yt.avail_in!==0)return he;Ie=yt.state,Ie.mode===qt&&(Ie.mode=Ft),Pt=yt.next_out,xa=yt.output,Ce=yt.avail_out,W=yt.next_in,pr=yt.input,Bt=yt.avail_in,it=Ie.hold,Mt=Ie.bits,ra=Bt,Nr=Ce,el=ie;e:for(;;)switch(Ie.mode){case Je:if(Ie.wrap===0){Ie.mode=Ft;break}for(;Mt<16;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(Ie.wrap&2&&it===35615){Ie.check=0,Yn[0]=it&255,Yn[1]=it>>>8&255,Ie.check=L(Ie.check,Yn,2,0),it=0,Mt=0,Ie.mode=ot;break}if(Ie.flags=0,Ie.head&&(Ie.head.done=!1),!(Ie.wrap&1)||(((it&255)<<8)+(it>>8))%31){yt.msg="incorrect header check",Ie.mode=Vt;break}if((it&15)!==Oe){yt.msg="unknown compression method",Ie.mode=Vt;break}if(it>>>=4,Mt-=4,yn=(it&15)+8,Ie.wbits===0)Ie.wbits=yn;else if(yn>Ie.wbits){yt.msg="invalid window size",Ie.mode=Vt;break}Ie.dmax=1<<yn,yt.adler=Ie.check=1,Ie.mode=it&512?xt:qt,it=0,Mt=0;break;case ot:for(;Mt<16;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(Ie.flags=it,(Ie.flags&255)!==Oe){yt.msg="unknown compression method",Ie.mode=Vt;break}if(Ie.flags&57344){yt.msg="unknown header flags set",Ie.mode=Vt;break}Ie.head&&(Ie.head.text=it>>8&1),Ie.flags&512&&(Yn[0]=it&255,Yn[1]=it>>>8&255,Ie.check=L(Ie.check,Yn,2,0)),it=0,Mt=0,Ie.mode=qe;case qe:for(;Mt<32;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}Ie.head&&(Ie.head.time=it),Ie.flags&512&&(Yn[0]=it&255,Yn[1]=it>>>8&255,Yn[2]=it>>>16&255,Yn[3]=it>>>24&255,Ie.check=L(Ie.check,Yn,4,0)),it=0,Mt=0,Ie.mode=Et;case Et:for(;Mt<16;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}Ie.head&&(Ie.head.xflags=it&255,Ie.head.os=it>>8),Ie.flags&512&&(Yn[0]=it&255,Yn[1]=it>>>8&255,Ie.check=L(Ie.check,Yn,2,0)),it=0,Mt=0,Ie.mode=Ye;case Ye:if(Ie.flags&1024){for(;Mt<16;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}Ie.length=it,Ie.head&&(Ie.head.extra_len=it),Ie.flags&512&&(Yn[0]=it&255,Yn[1]=it>>>8&255,Ie.check=L(Ie.check,Yn,2,0)),it=0,Mt=0}else Ie.head&&(Ie.head.extra=null);Ie.mode=Be;case Be:if(Ie.flags&1024&&(Er=Ie.length,Er>Bt&&(Er=Bt),Er&&(Ie.head&&(yn=Ie.head.extra_len-Ie.length,Ie.head.extra||(Ie.head.extra=new Array(Ie.head.extra_len)),we.arraySet(Ie.head.extra,pr,W,Er,yn)),Ie.flags&512&&(Ie.check=L(Ie.check,pr,Er,W)),Bt-=Er,W+=Er,Ie.length-=Er),Ie.length))break e;Ie.length=0,Ie.mode=Qe;case Qe:if(Ie.flags&2048){if(Bt===0)break e;Er=0;do yn=pr[W+Er++],Ie.head&&yn&&Ie.length<65536&&(Ie.head.name+=String.fromCharCode(yn));while(yn&&Er<Bt);if(Ie.flags&512&&(Ie.check=L(Ie.check,pr,Er,W)),Bt-=Er,W+=Er,yn)break e}else Ie.head&&(Ie.head.name=null);Ie.length=0,Ie.mode=rt;case rt:if(Ie.flags&4096){if(Bt===0)break e;Er=0;do yn=pr[W+Er++],Ie.head&&yn&&Ie.length<65536&&(Ie.head.comment+=String.fromCharCode(yn));while(yn&&Er<Bt);if(Ie.flags&512&&(Ie.check=L(Ie.check,pr,Er,W)),Bt-=Er,W+=Er,yn)break e}else Ie.head&&(Ie.head.comment=null);Ie.mode=lt;case lt:if(Ie.flags&512){for(;Mt<16;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(it!==(Ie.check&65535)){yt.msg="header crc mismatch",Ie.mode=Vt;break}it=0,Mt=0}Ie.head&&(Ie.head.hcrc=Ie.flags>>9&1,Ie.head.done=!0),yt.adler=Ie.check=0,Ie.mode=qt;break;case xt:for(;Mt<32;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}yt.adler=Ie.check=ut(it),it=0,Mt=0,Ie.mode=kt;case kt:if(Ie.havedict===0)return yt.next_out=Pt,yt.avail_out=Ce,yt.next_in=W,yt.avail_in=Bt,Ie.hold=it,Ie.bits=Mt,Z;yt.adler=Ie.check=1,Ie.mode=qt;case qt:if(Gt===Se||Gt===ke)break e;case Ft:if(Ie.last){it>>>=Mt&7,Mt-=Mt&7,Ie.mode=Ge;break}for(;Mt<3;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}switch(Ie.last=it&1,it>>>=1,Mt-=1,it&3){case 0:Ie.mode=gr;break;case 1:if(Va(Ie),Ie.mode=Ht,Gt===ke){it>>>=2,Mt-=2;break e}break;case 2:Ie.mode=zr;break;case 3:yt.msg="invalid block type",Ie.mode=Vt}it>>>=2,Mt-=2;break;case gr:for(it>>>=Mt&7,Mt-=Mt&7;Mt<32;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if((it&65535)!==(it>>>16^65535)){yt.msg="invalid stored block lengths",Ie.mode=Vt;break}if(Ie.length=it&65535,it=0,Mt=0,Ie.mode=Yt,Gt===ke)break e;case Yt:Ie.mode=Sr;case Sr:if(Er=Ie.length,Er){if(Er>Bt&&(Er=Bt),Er>Ce&&(Er=Ce),Er===0)break e;we.arraySet(xa,pr,W,Er,Pt),Bt-=Er,W+=Er,Ce-=Er,Pt+=Er,Ie.length-=Er;break}Ie.mode=qt;break;case zr:for(;Mt<14;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(Ie.nlen=(it&31)+257,it>>>=5,Mt-=5,Ie.ndist=(it&31)+1,it>>>=5,Mt-=5,Ie.ncode=(it&15)+4,it>>>=4,Mt-=4,Ie.nlen>286||Ie.ndist>30){yt.msg="too many length or distance symbols",Ie.mode=Vt;break}Ie.have=0,Ie.mode=ht;case ht:for(;Ie.have<Ie.ncode;){for(;Mt<3;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}Ie.lens[Gi[Ie.have++]]=it&7,it>>>=3,Mt-=3}for(;Ie.have<19;)Ie.lens[Gi[Ie.have++]]=0;if(Ie.lencode=Ie.lendyn,Ie.lenbits=7,Rl={bits:Ie.lenbits},el=J(X,Ie.lens,0,19,Ie.lencode,0,Ie.work,Rl),Ie.lenbits=Rl.bits,el){yt.msg="invalid code lengths set",Ie.mode=Vt;break}Ie.have=0,Ie.mode=ft;case ft:for(;Ie.have<Ie.nlen+Ie.ndist;){for(;$n=Ie.lencode[it&(1<<Ie.lenbits)-1],Oa=$n>>>24,Nn=$n>>>16&255,Bn=$n&65535,!(Oa<=Mt);){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(Bn<16)it>>>=Oa,Mt-=Oa,Ie.lens[Ie.have++]=Bn;else{if(Bn===16){for(El=Oa+2;Mt<El;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(it>>>=Oa,Mt-=Oa,Ie.have===0){yt.msg="invalid bit length repeat",Ie.mode=Vt;break}yn=Ie.lens[Ie.have-1],Er=3+(it&3),it>>>=2,Mt-=2}else if(Bn===17){for(El=Oa+3;Mt<El;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}it>>>=Oa,Mt-=Oa,yn=0,Er=3+(it&7),it>>>=3,Mt-=3}else{for(El=Oa+7;Mt<El;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}it>>>=Oa,Mt-=Oa,yn=0,Er=11+(it&127),it>>>=7,Mt-=7}if(Ie.have+Er>Ie.nlen+Ie.ndist){yt.msg="invalid bit length repeat",Ie.mode=Vt;break}for(;Er--;)Ie.lens[Ie.have++]=yn}}if(Ie.mode===Vt)break;if(Ie.lens[256]===0){yt.msg="invalid code -- missing end-of-block",Ie.mode=Vt;break}if(Ie.lenbits=9,Rl={bits:Ie.lenbits},el=J(Y,Ie.lens,0,Ie.nlen,Ie.lencode,0,Ie.work,Rl),Ie.lenbits=Rl.bits,el){yt.msg="invalid literal/lengths set",Ie.mode=Vt;break}if(Ie.distbits=6,Ie.distcode=Ie.distdyn,Rl={bits:Ie.distbits},el=J(ge,Ie.lens,Ie.nlen,Ie.ndist,Ie.distcode,0,Ie.work,Rl),Ie.distbits=Rl.bits,el){yt.msg="invalid distances set",Ie.mode=Vt;break}if(Ie.mode=Ht,Gt===ke)break e;case Ht:Ie.mode=hr;case hr:if(Bt>=6&&Ce>=258){yt.next_out=Pt,yt.avail_out=Ce,yt.next_in=W,yt.avail_in=Bt,Ie.hold=it,Ie.bits=Mt,G(yt,Nr),Pt=yt.next_out,xa=yt.output,Ce=yt.avail_out,W=yt.next_in,pr=yt.input,Bt=yt.avail_in,it=Ie.hold,Mt=Ie.bits,Ie.mode===qt&&(Ie.back=-1);break}for(Ie.back=0;$n=Ie.lencode[it&(1<<Ie.lenbits)-1],Oa=$n>>>24,Nn=$n>>>16&255,Bn=$n&65535,!(Oa<=Mt);){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(Nn&&!(Nn&240)){for(Qa=Oa,ti=Nn,Il=Bn;$n=Ie.lencode[Il+((it&(1<<Qa+ti)-1)>>Qa)],Oa=$n>>>24,Nn=$n>>>16&255,Bn=$n&65535,!(Qa+Oa<=Mt);){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}it>>>=Qa,Mt-=Qa,Ie.back+=Qa}if(it>>>=Oa,Mt-=Oa,Ie.back+=Oa,Ie.length=Bn,Nn===0){Ie.mode=ua;break}if(Nn&32){Ie.back=-1,Ie.mode=qt;break}if(Nn&64){yt.msg="invalid literal/length code",Ie.mode=Vt;break}Ie.extra=Nn&15,Ie.mode=Br;case Br:if(Ie.extra){for(El=Ie.extra;Mt<El;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}Ie.length+=it&(1<<Ie.extra)-1,it>>>=Ie.extra,Mt-=Ie.extra,Ie.back+=Ie.extra}Ie.was=Ie.length,Ie.mode=Vr;case Vr:for(;$n=Ie.distcode[it&(1<<Ie.distbits)-1],Oa=$n>>>24,Nn=$n>>>16&255,Bn=$n&65535,!(Oa<=Mt);){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(!(Nn&240)){for(Qa=Oa,ti=Nn,Il=Bn;$n=Ie.distcode[Il+((it&(1<<Qa+ti)-1)>>Qa)],Oa=$n>>>24,Nn=$n>>>16&255,Bn=$n&65535,!(Qa+Oa<=Mt);){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}it>>>=Qa,Mt-=Qa,Ie.back+=Qa}if(it>>>=Oa,Mt-=Oa,Ie.back+=Oa,Nn&64){yt.msg="invalid distance code",Ie.mode=Vt;break}Ie.offset=Bn,Ie.extra=Nn&15,Ie.mode=ma;case ma:if(Ie.extra){for(El=Ie.extra;Mt<El;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}Ie.offset+=it&(1<<Ie.extra)-1,it>>>=Ie.extra,Mt-=Ie.extra,Ie.back+=Ie.extra}if(Ie.offset>Ie.dmax){yt.msg="invalid distance too far back",Ie.mode=Vt;break}Ie.mode=ca;case ca:if(Ce===0)break e;if(Er=Nr-Ce,Ie.offset>Er){if(Er=Ie.offset-Er,Er>Ie.whave&&Ie.sane){yt.msg="invalid distance too far back",Ie.mode=Vt;break}Er>Ie.wnext?(Er-=Ie.wnext,Ua=Ie.wsize-Er):Ua=Ie.wnext-Er,Er>Ie.length&&(Er=Ie.length),Gl=Ie.window}else Gl=xa,Ua=Pt-Ie.offset,Er=Ie.length;Er>Ce&&(Er=Ce),Ce-=Er,Ie.length-=Er;do xa[Pt++]=Gl[Ua++];while(--Er);Ie.length===0&&(Ie.mode=hr);break;case ua:if(Ce===0)break e;xa[Pt++]=Ie.length,Ce--,Ie.mode=hr;break;case Ge:if(Ie.wrap){for(;Mt<32;){if(Bt===0)break e;Bt--,it|=pr[W++]<<Mt,Mt+=8}if(Nr-=Ce,yt.total_out+=Nr,Ie.total+=Nr,Nr&&(yt.adler=Ie.check=Ie.flags?L(Ie.check,xa,Nr,Pt-Nr):H(Ie.check,xa,Nr,Pt-Nr)),Nr=Ce,(Ie.flags?it:ut(it))!==Ie.check){yt.msg="incorrect data check",Ie.mode=Vt;break}it=0,Mt=0}Ie.mode=Ke;case Ke:if(Ie.wrap&&Ie.flags){for(;Mt<32;){if(Bt===0)break e;Bt--,it+=pr[W++]<<Mt,Mt+=8}if(it!==(Ie.total&4294967295)){yt.msg="incorrect length check",Ie.mode=Vt;break}it=0,Mt=0}Ie.mode=zt;case zt:el=O;break e;case Vt:el=$e;break e;case $r:return te;case Qr:default:return he}return yt.next_out=Pt,yt.avail_out=Ce,yt.next_in=W,yt.avail_in=Bt,Ie.hold=it,Ie.bits=Mt,(Ie.wsize||Nr!==yt.avail_out&&Ie.mode<Vt&&(Ie.mode<Ge||Gt!==fe))&&In(yt,yt.output,yt.next_out,Nr-yt.avail_out),ra-=yt.avail_in,Nr-=yt.avail_out,yt.total_in+=ra,yt.total_out+=Nr,Ie.total+=Nr,Ie.wrap&&Nr&&(yt.adler=Ie.check=Ie.flags?L(Ie.check,xa,Nr,yt.next_out-Nr):H(Ie.check,xa,Nr,yt.next_out-Nr)),yt.data_type=Ie.bits+(Ie.last?64:0)+(Ie.mode===qt?128:0)+(Ie.mode===Ht||Ie.mode===Yt?256:0),(ra===0&&Nr===0||Gt===fe)&&el===ie&&(el=xe),el}function cr(yt){if(!yt||!yt.state)return he;var Gt=yt.state;return Gt.window&&(Gt.window=null),yt.state=null,ie}function wr(yt,Gt){var Ie;return!yt||!yt.state||(Ie=yt.state,!(Ie.wrap&2))?he:(Ie.head=Gt,Gt.done=!1,ie)}function Gr(yt,Gt){var Ie=Gt.length,pr,xa,W;return!yt||!yt.state||(pr=yt.state,pr.wrap!==0&&pr.mode!==kt)?he:pr.mode===kt&&(xa=1,xa=H(xa,Gt,Ie,0),xa!==pr.check)?$e:(W=In(yt,Gt,Ie,Ie),W?(pr.mode=$r,te):(pr.havedict=1,ie))}K.inflateReset=sa,K.inflateReset2=da,K.inflateResetKeep=Zt,K.inflateInit=Sa,K.inflateInit2=Ur,K.inflate=Pe,K.inflateEnd=cr,K.inflateGetHeader=wr,K.inflateSetDictionary=Gr,K.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":50,"./adler32":52,"./crc32":54,"./inffast":57,"./inftrees":59}],59:[function(Fe,Ct,K){var we=Fe("../utils/common"),H=15,L=852,G=592,J=0,X=1,Y=2,ge=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],fe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ke=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Ct.exports=function(O,Z,he,$e,te,xe,Oe,Je){var ot=Je.bits,qe=0,Et=0,Ye=0,Be=0,Qe=0,rt=0,lt=0,xt=0,kt=0,qt=0,Ft,gr,Yt,Sr,zr,ht=null,ft=0,Ht,hr=new we.Buf16(H+1),Br=new we.Buf16(H+1),Vr=null,ma=0,ca,ua,Ge;for(qe=0;qe<=H;qe++)hr[qe]=0;for(Et=0;Et<$e;Et++)hr[Z[he+Et]]++;for(Qe=ot,Be=H;Be>=1&&hr[Be]===0;Be--);if(Qe>Be&&(Qe=Be),Be===0)return te[xe++]=1<<24|64<<16|0,te[xe++]=1<<24|64<<16|0,Je.bits=1,0;for(Ye=1;Ye<Be&&hr[Ye]===0;Ye++);for(Qe<Ye&&(Qe=Ye),xt=1,qe=1;qe<=H;qe++)if(xt<<=1,xt-=hr[qe],xt<0)return-1;if(xt>0&&(O===J||Be!==1))return-1;for(Br[1]=0,qe=1;qe<H;qe++)Br[qe+1]=Br[qe]+hr[qe];for(Et=0;Et<$e;Et++)Z[he+Et]!==0&&(Oe[Br[Z[he+Et]]++]=Et);if(O===J?(ht=Vr=Oe,Ht=19):O===X?(ht=ge,ft-=257,Vr=fe,ma-=257,Ht=256):(ht=Se,Vr=ke,Ht=-1),qt=0,Et=0,qe=Ye,zr=xe,rt=Qe,lt=0,Yt=-1,kt=1<<Qe,Sr=kt-1,O===X&&kt>L||O===Y&&kt>G)return 1;for(;;){ca=qe-lt,Oe[Et]<Ht?(ua=0,Ge=Oe[Et]):Oe[Et]>Ht?(ua=Vr[ma+Oe[Et]],Ge=ht[ft+Oe[Et]]):(ua=96,Ge=0),Ft=1<<qe-lt,gr=1<<rt,Ye=gr;do gr-=Ft,te[zr+(qt>>lt)+gr]=ca<<24|ua<<16|Ge|0;while(gr!==0);for(Ft=1<<qe-1;qt&Ft;)Ft>>=1;if(Ft!==0?(qt&=Ft-1,qt+=Ft):qt=0,Et++,--hr[qe]===0){if(qe===Be)break;qe=Z[he+Oe[Et]]}if(qe>Qe&&(qt&Sr)!==Yt){for(lt===0&&(lt=Qe),zr+=Ye,rt=qe-lt,xt=1<<rt;rt+lt<Be&&(xt-=hr[rt+lt],!(xt<=0));)rt++,xt<<=1;if(kt+=1<<rt,O===X&&kt>L||O===Y&&kt>G)return 1;Yt=qt&Sr,te[Yt]=Qe<<24|rt<<16|zr-xe|0}}return qt!==0&&(te[zr+qt]=qe-lt<<24|64<<16|0),Je.bits=Qe,0}},{"../utils/common":50}],60:[function(Fe,Ct,K){Ct.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(Fe,Ct,K){var we=Fe("../utils/common"),H=4,L=0,G=1,J=2;function X(Pe){for(var cr=Pe.length;--cr>=0;)Pe[cr]=0}var Y=0,ge=1,fe=2,Se=3,ke=258,ie=29,O=256,Z=O+1+ie,he=30,$e=19,te=2*Z+1,xe=15,Oe=16,Je=7,ot=256,qe=16,Et=17,Ye=18,Be=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Qe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],rt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],lt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xt=512,kt=new Array((Z+2)*2);X(kt);var qt=new Array(he*2);X(qt);var Ft=new Array(xt);X(Ft);var gr=new Array(ke-Se+1);X(gr);var Yt=new Array(ie);X(Yt);var Sr=new Array(he);X(Sr);function zr(Pe,cr,wr,Gr,yt){this.static_tree=Pe,this.extra_bits=cr,this.extra_base=wr,this.elems=Gr,this.max_length=yt,this.has_stree=Pe&&Pe.length}var ht,ft,Ht;function hr(Pe,cr){this.dyn_tree=Pe,this.max_code=0,this.stat_desc=cr}function Br(Pe){return Pe<256?Ft[Pe]:Ft[256+(Pe>>>7)]}function Vr(Pe,cr){Pe.pending_buf[Pe.pending++]=cr&255,Pe.pending_buf[Pe.pending++]=cr>>>8&255}function ma(Pe,cr,wr){Pe.bi_valid>Oe-wr?(Pe.bi_buf|=cr<<Pe.bi_valid&65535,Vr(Pe,Pe.bi_buf),Pe.bi_buf=cr>>Oe-Pe.bi_valid,Pe.bi_valid+=wr-Oe):(Pe.bi_buf|=cr<<Pe.bi_valid&65535,Pe.bi_valid+=wr)}function ca(Pe,cr,wr){ma(Pe,wr[cr*2],wr[cr*2+1])}function ua(Pe,cr){var wr=0;do wr|=Pe&1,Pe>>>=1,wr<<=1;while(--cr>0);return wr>>>1}function Ge(Pe){Pe.bi_valid===16?(Vr(Pe,Pe.bi_buf),Pe.bi_buf=0,Pe.bi_valid=0):Pe.bi_valid>=8&&(Pe.pending_buf[Pe.pending++]=Pe.bi_buf&255,Pe.bi_buf>>=8,Pe.bi_valid-=8)}function Ke(Pe,cr){var wr=cr.dyn_tree,Gr=cr.max_code,yt=cr.stat_desc.static_tree,Gt=cr.stat_desc.has_stree,Ie=cr.stat_desc.extra_bits,pr=cr.stat_desc.extra_base,xa=cr.stat_desc.max_length,W,Pt,Bt,Ce,it,Mt,ra=0;for(Ce=0;Ce<=xe;Ce++)Pe.bl_count[Ce]=0;for(wr[Pe.heap[Pe.heap_max]*2+1]=0,W=Pe.heap_max+1;W<te;W++)Pt=Pe.heap[W],Ce=wr[wr[Pt*2+1]*2+1]+1,Ce>xa&&(Ce=xa,ra++),wr[Pt*2+1]=Ce,!(Pt>Gr)&&(Pe.bl_count[Ce]++,it=0,Pt>=pr&&(it=Ie[Pt-pr]),Mt=wr[Pt*2],Pe.opt_len+=Mt*(Ce+it),Gt&&(Pe.static_len+=Mt*(yt[Pt*2+1]+it)));if(ra!==0){do{for(Ce=xa-1;Pe.bl_count[Ce]===0;)Ce--;Pe.bl_count[Ce]--,Pe.bl_count[Ce+1]+=2,Pe.bl_count[xa]--,ra-=2}while(ra>0);for(Ce=xa;Ce!==0;Ce--)for(Pt=Pe.bl_count[Ce];Pt!==0;)Bt=Pe.heap[--W],!(Bt>Gr)&&(wr[Bt*2+1]!==Ce&&(Pe.opt_len+=(Ce-wr[Bt*2+1])*wr[Bt*2],wr[Bt*2+1]=Ce),Pt--)}}function zt(Pe,cr,wr){var Gr=new Array(xe+1),yt=0,Gt,Ie;for(Gt=1;Gt<=xe;Gt++)Gr[Gt]=yt=yt+wr[Gt-1]<<1;for(Ie=0;Ie<=cr;Ie++){var pr=Pe[Ie*2+1];pr!==0&&(Pe[Ie*2]=ua(Gr[pr]++,pr))}}function Vt(){var Pe,cr,wr,Gr,yt,Gt=new Array(xe+1);for(wr=0,Gr=0;Gr<ie-1;Gr++)for(Yt[Gr]=wr,Pe=0;Pe<1<<Be[Gr];Pe++)gr[wr++]=Gr;for(gr[wr-1]=Gr,yt=0,Gr=0;Gr<16;Gr++)for(Sr[Gr]=yt,Pe=0;Pe<1<<Qe[Gr];Pe++)Ft[yt++]=Gr;for(yt>>=7;Gr<he;Gr++)for(Sr[Gr]=yt<<7,Pe=0;Pe<1<<Qe[Gr]-7;Pe++)Ft[256+yt++]=Gr;for(cr=0;cr<=xe;cr++)Gt[cr]=0;for(Pe=0;Pe<=143;)kt[Pe*2+1]=8,Pe++,Gt[8]++;for(;Pe<=255;)kt[Pe*2+1]=9,Pe++,Gt[9]++;for(;Pe<=279;)kt[Pe*2+1]=7,Pe++,Gt[7]++;for(;Pe<=287;)kt[Pe*2+1]=8,Pe++,Gt[8]++;for(zt(kt,Z+1,Gt),Pe=0;Pe<he;Pe++)qt[Pe*2+1]=5,qt[Pe*2]=ua(Pe,5);ht=new zr(kt,Be,O+1,Z,xe),ft=new zr(qt,Qe,0,he,xe),Ht=new zr(new Array(0),rt,0,$e,Je)}function $r(Pe){var cr;for(cr=0;cr<Z;cr++)Pe.dyn_ltree[cr*2]=0;for(cr=0;cr<he;cr++)Pe.dyn_dtree[cr*2]=0;for(cr=0;cr<$e;cr++)Pe.bl_tree[cr*2]=0;Pe.dyn_ltree[ot*2]=1,Pe.opt_len=Pe.static_len=0,Pe.last_lit=Pe.matches=0}function Qr(Pe){Pe.bi_valid>8?Vr(Pe,Pe.bi_buf):Pe.bi_valid>0&&(Pe.pending_buf[Pe.pending++]=Pe.bi_buf),Pe.bi_buf=0,Pe.bi_valid=0}function Me(Pe,cr,wr,Gr){Qr(Pe),Gr&&(Vr(Pe,wr),Vr(Pe,~wr)),we.arraySet(Pe.pending_buf,Pe.window,cr,wr,Pe.pending),Pe.pending+=wr}function oe(Pe,cr,wr,Gr){var yt=cr*2,Gt=wr*2;return Pe[yt]<Pe[Gt]||Pe[yt]===Pe[Gt]&&Gr[cr]<=Gr[wr]}function se(Pe,cr,wr){for(var Gr=Pe.heap[wr],yt=wr<<1;yt<=Pe.heap_len&&(yt<Pe.heap_len&&oe(cr,Pe.heap[yt+1],Pe.heap[yt],Pe.depth)&&yt++,!oe(cr,Gr,Pe.heap[yt],Pe.depth));)Pe.heap[wr]=Pe.heap[yt],wr=yt,yt<<=1;Pe.heap[wr]=Gr}function Le(Pe,cr,wr){var Gr,yt,Gt=0,Ie,pr;if(Pe.last_lit!==0)do Gr=Pe.pending_buf[Pe.d_buf+Gt*2]<<8|Pe.pending_buf[Pe.d_buf+Gt*2+1],yt=Pe.pending_buf[Pe.l_buf+Gt],Gt++,Gr===0?ca(Pe,yt,cr):(Ie=gr[yt],ca(Pe,Ie+O+1,cr),pr=Be[Ie],pr!==0&&(yt-=Yt[Ie],ma(Pe,yt,pr)),Gr--,Ie=Br(Gr),ca(Pe,Ie,wr),pr=Qe[Ie],pr!==0&&(Gr-=Sr[Ie],ma(Pe,Gr,pr)));while(Gt<Pe.last_lit);ca(Pe,ot,cr)}function ut(Pe,cr){var wr=cr.dyn_tree,Gr=cr.stat_desc.static_tree,yt=cr.stat_desc.has_stree,Gt=cr.stat_desc.elems,Ie,pr,xa=-1,W;for(Pe.heap_len=0,Pe.heap_max=te,Ie=0;Ie<Gt;Ie++)wr[Ie*2]!==0?(Pe.heap[++Pe.heap_len]=xa=Ie,Pe.depth[Ie]=0):wr[Ie*2+1]=0;for(;Pe.heap_len<2;)W=Pe.heap[++Pe.heap_len]=xa<2?++xa:0,wr[W*2]=1,Pe.depth[W]=0,Pe.opt_len--,yt&&(Pe.static_len-=Gr[W*2+1]);for(cr.max_code=xa,Ie=Pe.heap_len>>1;Ie>=1;Ie--)se(Pe,wr,Ie);W=Gt;do Ie=Pe.heap[1],Pe.heap[1]=Pe.heap[Pe.heap_len--],se(Pe,wr,1),pr=Pe.heap[1],Pe.heap[--Pe.heap_max]=Ie,Pe.heap[--Pe.heap_max]=pr,wr[W*2]=wr[Ie*2]+wr[pr*2],Pe.depth[W]=(Pe.depth[Ie]>=Pe.depth[pr]?Pe.depth[Ie]:Pe.depth[pr])+1,wr[Ie*2+1]=wr[pr*2+1]=W,Pe.heap[1]=W++,se(Pe,wr,1);while(Pe.heap_len>=2);Pe.heap[--Pe.heap_max]=Pe.heap[1],Ke(Pe,cr),zt(wr,xa,Pe.bl_count)}function sr(Pe,cr,wr){var Gr,yt=-1,Gt,Ie=cr[0*2+1],pr=0,xa=7,W=4;for(Ie===0&&(xa=138,W=3),cr[(wr+1)*2+1]=65535,Gr=0;Gr<=wr;Gr++)Gt=Ie,Ie=cr[(Gr+1)*2+1],!(++pr<xa&&Gt===Ie)&&(pr<W?Pe.bl_tree[Gt*2]+=pr:Gt!==0?(Gt!==yt&&Pe.bl_tree[Gt*2]++,Pe.bl_tree[qe*2]++):pr<=10?Pe.bl_tree[Et*2]++:Pe.bl_tree[Ye*2]++,pr=0,yt=Gt,Ie===0?(xa=138,W=3):Gt===Ie?(xa=6,W=3):(xa=7,W=4))}function Zt(Pe,cr,wr){var Gr,yt=-1,Gt,Ie=cr[0*2+1],pr=0,xa=7,W=4;for(Ie===0&&(xa=138,W=3),Gr=0;Gr<=wr;Gr++)if(Gt=Ie,Ie=cr[(Gr+1)*2+1],!(++pr<xa&&Gt===Ie)){if(pr<W)do ca(Pe,Gt,Pe.bl_tree);while(--pr!==0);else Gt!==0?(Gt!==yt&&(ca(Pe,Gt,Pe.bl_tree),pr--),ca(Pe,qe,Pe.bl_tree),ma(Pe,pr-3,2)):pr<=10?(ca(Pe,Et,Pe.bl_tree),ma(Pe,pr-3,3)):(ca(Pe,Ye,Pe.bl_tree),ma(Pe,pr-11,7));pr=0,yt=Gt,Ie===0?(xa=138,W=3):Gt===Ie?(xa=6,W=3):(xa=7,W=4)}}function sa(Pe){var cr;for(sr(Pe,Pe.dyn_ltree,Pe.l_desc.max_code),sr(Pe,Pe.dyn_dtree,Pe.d_desc.max_code),ut(Pe,Pe.bl_desc),cr=$e-1;cr>=3&&Pe.bl_tree[lt[cr]*2+1]===0;cr--);return Pe.opt_len+=3*(cr+1)+5+5+4,cr}function da(Pe,cr,wr,Gr){var yt;for(ma(Pe,cr-257,5),ma(Pe,wr-1,5),ma(Pe,Gr-4,4),yt=0;yt<Gr;yt++)ma(Pe,Pe.bl_tree[lt[yt]*2+1],3);Zt(Pe,Pe.dyn_ltree,cr-1),Zt(Pe,Pe.dyn_dtree,wr-1)}function Ur(Pe){var cr=4093624447,wr;for(wr=0;wr<=31;wr++,cr>>>=1)if(cr&1&&Pe.dyn_ltree[wr*2]!==0)return L;if(Pe.dyn_ltree[9*2]!==0||Pe.dyn_ltree[10*2]!==0||Pe.dyn_ltree[13*2]!==0)return G;for(wr=32;wr<O;wr++)if(Pe.dyn_ltree[wr*2]!==0)return G;return L}var Sa=!1;function ha(Pe){Sa||(Vt(),Sa=!0),Pe.l_desc=new hr(Pe.dyn_ltree,ht),Pe.d_desc=new hr(Pe.dyn_dtree,ft),Pe.bl_desc=new hr(Pe.bl_tree,Ht),Pe.bi_buf=0,Pe.bi_valid=0,$r(Pe)}function An(Pe,cr,wr,Gr){ma(Pe,(Y<<1)+(Gr?1:0),3),Me(Pe,cr,wr,!0)}function Ta(Pe){ma(Pe,ge<<1,3),ca(Pe,ot,kt),Ge(Pe)}function Va(Pe,cr,wr,Gr){var yt,Gt,Ie=0;Pe.level>0?(Pe.strm.data_type===J&&(Pe.strm.data_type=Ur(Pe)),ut(Pe,Pe.l_desc),ut(Pe,Pe.d_desc),Ie=sa(Pe),yt=Pe.opt_len+3+7>>>3,Gt=Pe.static_len+3+7>>>3,Gt<=yt&&(yt=Gt)):yt=Gt=wr+5,wr+4<=yt&&cr!==-1?An(Pe,cr,wr,Gr):Pe.strategy===H||Gt===yt?(ma(Pe,(ge<<1)+(Gr?1:0),3),Le(Pe,kt,qt)):(ma(Pe,(fe<<1)+(Gr?1:0),3),da(Pe,Pe.l_desc.max_code+1,Pe.d_desc.max_code+1,Ie+1),Le(Pe,Pe.dyn_ltree,Pe.dyn_dtree)),$r(Pe),Gr&&Qr(Pe)}function In(Pe,cr,wr){return Pe.pending_buf[Pe.d_buf+Pe.last_lit*2]=cr>>>8&255,Pe.pending_buf[Pe.d_buf+Pe.last_lit*2+1]=cr&255,Pe.pending_buf[Pe.l_buf+Pe.last_lit]=wr&255,Pe.last_lit++,cr===0?Pe.dyn_ltree[wr*2]++:(Pe.matches++,cr--,Pe.dyn_ltree[(gr[wr]+O+1)*2]++,Pe.dyn_dtree[Br(cr)*2]++),Pe.last_lit===Pe.lit_bufsize-1}K._tr_init=ha,K._tr_stored_block=An,K._tr_flush_block=Va,K._tr_tally=In,K._tr_align=Ta},{"../utils/common":50}],62:[function(Fe,Ct,K){function we(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}Ct.exports=we},{}],63:[function(Fe,Ct,K){(function(we){typeof we>"u"||!we.version||we.version.indexOf("v0.")===0||we.version.indexOf("v1.")===0&&we.version.indexOf("v1.8.")!==0?Ct.exports={nextTick:H}:Ct.exports=we;function H(L,G,J,X){if(typeof L!="function")throw new TypeError('"callback" argument must be a function');var Y=arguments.length,ge,fe;switch(Y){case 0:case 1:return we.nextTick(L);case 2:return we.nextTick(function(){L.call(null,G)});case 3:return we.nextTick(function(){L.call(null,G,J)});case 4:return we.nextTick(function(){L.call(null,G,J,X)});default:for(ge=new Array(Y-1),fe=0;fe<ge.length;)ge[fe++]=arguments[fe];return we.nextTick(function(){L.apply(null,ge)})}}}).call(this,Fe("_process"))},{_process:64}],64:[function(Fe,Ct,K){var we=Ct.exports={},H,L;function G(){throw new Error("setTimeout has not been defined")}function J(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?H=setTimeout:H=G}catch{H=G}try{typeof clearTimeout=="function"?L=clearTimeout:L=J}catch{L=J}})();function X($e){if(H===setTimeout)return setTimeout($e,0);if((H===G||!H)&&setTimeout)return H=setTimeout,setTimeout($e,0);try{return H($e,0)}catch{try{return H.call(null,$e,0)}catch{return H.call(this,$e,0)}}}function Y($e){if(L===clearTimeout)return clearTimeout($e);if((L===J||!L)&&clearTimeout)return L=clearTimeout,clearTimeout($e);try{return L($e)}catch{try{return L.call(null,$e)}catch{return L.call(this,$e)}}}var ge=[],fe=!1,Se,ke=-1;function ie(){!fe||!Se||(fe=!1,Se.length?ge=Se.concat(ge):ke=-1,ge.length&&O())}function O(){if(!fe){var $e=X(ie);fe=!0;for(var te=ge.length;te;){for(Se=ge,ge=[];++ke<te;)Se&&Se[ke].run();ke=-1,te=ge.length}Se=null,fe=!1,Y($e)}}we.nextTick=function($e){var te=new Array(arguments.length-1);if(arguments.length>1)for(var xe=1;xe<arguments.length;xe++)te[xe-1]=arguments[xe];ge.push(new Z($e,te)),ge.length===1&&!fe&&X(O)};function Z($e,te){this.fun=$e,this.array=te}Z.prototype.run=function(){this.fun.apply(null,this.array)},we.title="browser",we.browser=!0,we.env={},we.argv=[],we.version="",we.versions={};function he(){}we.on=he,we.addListener=he,we.once=he,we.off=he,we.removeListener=he,we.removeAllListeners=he,we.emit=he,we.prependListener=he,we.prependOnceListener=he,we.listeners=function($e){return[]},we.binding=function($e){throw new Error("process.binding is not supported")},we.cwd=function(){return"/"},we.chdir=function($e){throw new Error("process.chdir is not supported")},we.umask=function(){return 0}},{}],65:[function(Fe,Ct,K){Ct.exports=Fe("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":66}],66:[function(Fe,Ct,K){var we=Fe("process-nextick-args"),H=Object.keys||function(ie){var O=[];for(var Z in ie)O.push(Z);return O};Ct.exports=fe;var L=Object.create(Fe("core-util-is"));L.inherits=Fe("inherits");var G=Fe("./_stream_readable"),J=Fe("./_stream_writable");L.inherits(fe,G);for(var X=H(J.prototype),Y=0;Y<X.length;Y++){var ge=X[Y];fe.prototype[ge]||(fe.prototype[ge]=J.prototype[ge])}function fe(ie){if(!(this instanceof fe))return new fe(ie);G.call(this,ie),J.call(this,ie),ie&&ie.readable===!1&&(this.readable=!1),ie&&ie.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,ie&&ie.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",Se)}Object.defineProperty(fe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Se(){this.allowHalfOpen||this._writableState.ended||we.nextTick(ke,this)}function ke(ie){ie.end()}Object.defineProperty(fe.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(ie){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=ie,this._writableState.destroyed=ie)}}),fe.prototype._destroy=function(ie,O){this.push(null),this.end(),we.nextTick(O,ie)}},{"./_stream_readable":68,"./_stream_writable":70,"core-util-is":4,inherits:8,"process-nextick-args":63}],67:[function(Fe,Ct,K){Ct.exports=L;var we=Fe("./_stream_transform"),H=Object.create(Fe("core-util-is"));H.inherits=Fe("inherits"),H.inherits(L,we);function L(G){if(!(this instanceof L))return new L(G);we.call(this,G)}L.prototype._transform=function(G,J,X){X(null,G)}},{"./_stream_transform":69,"core-util-is":4,inherits:8}],68:[function(Fe,Ct,K){(function(we,H){var L=Fe("process-nextick-args");Ct.exports=ot;var G=Fe("isarray"),J;ot.ReadableState=Je,Fe("events").EventEmitter;var X=function(Ge,Ke){return Ge.listeners(Ke).length},Y=Fe("./internal/streams/stream"),ge=Fe("safe-buffer").Buffer,fe=H.Uint8Array||function(){};function Se(Ge){return ge.from(Ge)}function ke(Ge){return ge.isBuffer(Ge)||Ge instanceof fe}var ie=Object.create(Fe("core-util-is"));ie.inherits=Fe("inherits");var O=Fe("util"),Z=void 0;O&&O.debuglog?Z=O.debuglog("stream"):Z=function(){};var he=Fe("./internal/streams/BufferList"),$e=Fe("./internal/streams/destroy"),te;ie.inherits(ot,Y);var xe=["error","close","destroy","pause","resume"];function Oe(Ge,Ke,zt){if(typeof Ge.prependListener=="function")return Ge.prependListener(Ke,zt);!Ge._events||!Ge._events[Ke]?Ge.on(Ke,zt):G(Ge._events[Ke])?Ge._events[Ke].unshift(zt):Ge._events[Ke]=[zt,Ge._events[Ke]]}function Je(Ge,Ke){J=J||Fe("./_stream_duplex"),Ge=Ge||{};var zt=Ke instanceof J;this.objectMode=!!Ge.objectMode,zt&&(this.objectMode=this.objectMode||!!Ge.readableObjectMode);var Vt=Ge.highWaterMark,$r=Ge.readableHighWaterMark,Qr=this.objectMode?16:16*1024;Vt||Vt===0?this.highWaterMark=Vt:zt&&($r||$r===0)?this.highWaterMark=$r:this.highWaterMark=Qr,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new he,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=Ge.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Ge.encoding&&(te||(te=Fe("string_decoder/").StringDecoder),this.decoder=new te(Ge.encoding),this.encoding=Ge.encoding)}function ot(Ge){if(J=J||Fe("./_stream_duplex"),!(this instanceof ot))return new ot(Ge);this._readableState=new Je(Ge,this),this.readable=!0,Ge&&(typeof Ge.read=="function"&&(this._read=Ge.read),typeof Ge.destroy=="function"&&(this._destroy=Ge.destroy)),Y.call(this)}Object.defineProperty(ot.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Ge){this._readableState&&(this._readableState.destroyed=Ge)}}),ot.prototype.destroy=$e.destroy,ot.prototype._undestroy=$e.undestroy,ot.prototype._destroy=function(Ge,Ke){this.push(null),Ke(Ge)},ot.prototype.push=function(Ge,Ke){var zt=this._readableState,Vt;return zt.objectMode?Vt=!0:typeof Ge=="string"&&(Ke=Ke||zt.defaultEncoding,Ke!==zt.encoding&&(Ge=ge.from(Ge,Ke),Ke=""),Vt=!0),qe(this,Ge,Ke,!1,Vt)},ot.prototype.unshift=function(Ge){return qe(this,Ge,null,!0,!1)};function qe(Ge,Ke,zt,Vt,$r){var Qr=Ge._readableState;if(Ke===null)Qr.reading=!1,xt(Ge,Qr);else{var Me;$r||(Me=Ye(Qr,Ke)),Me?Ge.emit("error",Me):Qr.objectMode||Ke&&Ke.length>0?(typeof Ke!="string"&&!Qr.objectMode&&Object.getPrototypeOf(Ke)!==ge.prototype&&(Ke=Se(Ke)),Vt?Qr.endEmitted?Ge.emit("error",new Error("stream.unshift() after end event")):Et(Ge,Qr,Ke,!0):Qr.ended?Ge.emit("error",new Error("stream.push() after EOF")):(Qr.reading=!1,Qr.decoder&&!zt?(Ke=Qr.decoder.write(Ke),Qr.objectMode||Ke.length!==0?Et(Ge,Qr,Ke,!1):Ft(Ge,Qr)):Et(Ge,Qr,Ke,!1))):Vt||(Qr.reading=!1)}return Be(Qr)}function Et(Ge,Ke,zt,Vt){Ke.flowing&&Ke.length===0&&!Ke.sync?(Ge.emit("data",zt),Ge.read(0)):(Ke.length+=Ke.objectMode?1:zt.length,Vt?Ke.buffer.unshift(zt):Ke.buffer.push(zt),Ke.needReadable&&kt(Ge)),Ft(Ge,Ke)}function Ye(Ge,Ke){var zt;return!ke(Ke)&&typeof Ke!="string"&&Ke!==void 0&&!Ge.objectMode&&(zt=new TypeError("Invalid non-string/buffer chunk")),zt}function Be(Ge){return!Ge.ended&&(Ge.needReadable||Ge.length<Ge.highWaterMark||Ge.length===0)}ot.prototype.isPaused=function(){return this._readableState.flowing===!1},ot.prototype.setEncoding=function(Ge){return te||(te=Fe("string_decoder/").StringDecoder),this._readableState.decoder=new te(Ge),this._readableState.encoding=Ge,this};var Qe=8388608;function rt(Ge){return Ge>=Qe?Ge=Qe:(Ge--,Ge|=Ge>>>1,Ge|=Ge>>>2,Ge|=Ge>>>4,Ge|=Ge>>>8,Ge|=Ge>>>16,Ge++),Ge}function lt(Ge,Ke){return Ge<=0||Ke.length===0&&Ke.ended?0:Ke.objectMode?1:Ge!==Ge?Ke.flowing&&Ke.length?Ke.buffer.head.data.length:Ke.length:(Ge>Ke.highWaterMark&&(Ke.highWaterMark=rt(Ge)),Ge<=Ke.length?Ge:Ke.ended?Ke.length:(Ke.needReadable=!0,0))}ot.prototype.read=function(Ge){Z("read",Ge),Ge=parseInt(Ge,10);var Ke=this._readableState,zt=Ge;if(Ge!==0&&(Ke.emittedReadable=!1),Ge===0&&Ke.needReadable&&(Ke.length>=Ke.highWaterMark||Ke.ended))return Z("read: emitReadable",Ke.length,Ke.ended),Ke.length===0&&Ke.ended?ma(this):kt(this),null;if(Ge=lt(Ge,Ke),Ge===0&&Ke.ended)return Ke.length===0&&ma(this),null;var Vt=Ke.needReadable;Z("need readable",Vt),(Ke.length===0||Ke.length-Ge<Ke.highWaterMark)&&(Vt=!0,Z("length less than watermark",Vt)),Ke.ended||Ke.reading?(Vt=!1,Z("reading or ended",Vt)):Vt&&(Z("do read"),Ke.reading=!0,Ke.sync=!0,Ke.length===0&&(Ke.needReadable=!0),this._read(Ke.highWaterMark),Ke.sync=!1,Ke.reading||(Ge=lt(zt,Ke)));var $r;return Ge>0?$r=Ht(Ge,Ke):$r=null,$r===null?(Ke.needReadable=!0,Ge=0):Ke.length-=Ge,Ke.length===0&&(Ke.ended||(Ke.needReadable=!0),zt!==Ge&&Ke.ended&&ma(this)),$r!==null&&this.emit("data",$r),$r};function xt(Ge,Ke){if(!Ke.ended){if(Ke.decoder){var zt=Ke.decoder.end();zt&&zt.length&&(Ke.buffer.push(zt),Ke.length+=Ke.objectMode?1:zt.length)}Ke.ended=!0,kt(Ge)}}function kt(Ge){var Ke=Ge._readableState;Ke.needReadable=!1,Ke.emittedReadable||(Z("emitReadable",Ke.flowing),Ke.emittedReadable=!0,Ke.sync?L.nextTick(qt,Ge):qt(Ge))}function qt(Ge){Z("emit readable"),Ge.emit("readable"),ft(Ge)}function Ft(Ge,Ke){Ke.readingMore||(Ke.readingMore=!0,L.nextTick(gr,Ge,Ke))}function gr(Ge,Ke){for(var zt=Ke.length;!Ke.reading&&!Ke.flowing&&!Ke.ended&&Ke.length<Ke.highWaterMark&&(Z("maybeReadMore read 0"),Ge.read(0),zt!==Ke.length);)zt=Ke.length;Ke.readingMore=!1}ot.prototype._read=function(Ge){this.emit("error",new Error("_read() is not implemented"))},ot.prototype.pipe=function(Ge,Ke){var zt=this,Vt=this._readableState;switch(Vt.pipesCount){case 0:Vt.pipes=Ge;break;case 1:Vt.pipes=[Vt.pipes,Ge];break;default:Vt.pipes.push(Ge);break}Vt.pipesCount+=1,Z("pipe count=%d opts=%j",Vt.pipesCount,Ke);var $r=(!Ke||Ke.end!==!1)&&Ge!==we.stdout&&Ge!==we.stderr,Qr=$r?oe:Sa;Vt.endEmitted?L.nextTick(Qr):zt.once("end",Qr),Ge.on("unpipe",Me);function Me(ha,An){Z("onunpipe"),ha===zt&&An&&An.hasUnpiped===!1&&(An.hasUnpiped=!0,ut())}function oe(){Z("onend"),Ge.end()}var se=Yt(zt);Ge.on("drain",se);var Le=!1;function ut(){Z("cleanup"),Ge.removeListener("close",da),Ge.removeListener("finish",Ur),Ge.removeListener("drain",se),Ge.removeListener("error",sa),Ge.removeListener("unpipe",Me),zt.removeListener("end",oe),zt.removeListener("end",Sa),zt.removeListener("data",Zt),Le=!0,Vt.awaitDrain&&(!Ge._writableState||Ge._writableState.needDrain)&&se()}var sr=!1;zt.on("data",Zt);function Zt(ha){Z("ondata"),sr=!1;var An=Ge.write(ha);An===!1&&!sr&&((Vt.pipesCount===1&&Vt.pipes===Ge||Vt.pipesCount>1&&ua(Vt.pipes,Ge)!==-1)&&!Le&&(Z("false write response, pause",zt._readableState.awaitDrain),zt._readableState.awaitDrain++,sr=!0),zt.pause())}function sa(ha){Z("onerror",ha),Sa(),Ge.removeListener("error",sa),X(Ge,"error")===0&&Ge.emit("error",ha)}Oe(Ge,"error",sa);function da(){Ge.removeListener("finish",Ur),Sa()}Ge.once("close",da);function Ur(){Z("onfinish"),Ge.removeListener("close",da),Sa()}Ge.once("finish",Ur);function Sa(){Z("unpipe"),zt.unpipe(Ge)}return Ge.emit("pipe",zt),Vt.flowing||(Z("pipe resume"),zt.resume()),Ge};function Yt(Ge){return function(){var Ke=Ge._readableState;Z("pipeOnDrain",Ke.awaitDrain),Ke.awaitDrain&&Ke.awaitDrain--,Ke.awaitDrain===0&&X(Ge,"data")&&(Ke.flowing=!0,ft(Ge))}}ot.prototype.unpipe=function(Ge){var Ke=this._readableState,zt={hasUnpiped:!1};if(Ke.pipesCount===0)return this;if(Ke.pipesCount===1)return Ge&&Ge!==Ke.pipes?this:(Ge||(Ge=Ke.pipes),Ke.pipes=null,Ke.pipesCount=0,Ke.flowing=!1,Ge&&Ge.emit("unpipe",this,zt),this);if(!Ge){var Vt=Ke.pipes,$r=Ke.pipesCount;Ke.pipes=null,Ke.pipesCount=0,Ke.flowing=!1;for(var Qr=0;Qr<$r;Qr++)Vt[Qr].emit("unpipe",this,zt);return this}var Me=ua(Ke.pipes,Ge);return Me===-1?this:(Ke.pipes.splice(Me,1),Ke.pipesCount-=1,Ke.pipesCount===1&&(Ke.pipes=Ke.pipes[0]),Ge.emit("unpipe",this,zt),this)},ot.prototype.on=function(Ge,Ke){var zt=Y.prototype.on.call(this,Ge,Ke);if(Ge==="data")this._readableState.flowing!==!1&&this.resume();else if(Ge==="readable"){var Vt=this._readableState;!Vt.endEmitted&&!Vt.readableListening&&(Vt.readableListening=Vt.needReadable=!0,Vt.emittedReadable=!1,Vt.reading?Vt.length&&kt(this):L.nextTick(Sr,this))}return zt},ot.prototype.addListener=ot.prototype.on;function Sr(Ge){Z("readable nexttick read 0"),Ge.read(0)}ot.prototype.resume=function(){var Ge=this._readableState;return Ge.flowing||(Z("resume"),Ge.flowing=!0,zr(this,Ge)),this};function zr(Ge,Ke){Ke.resumeScheduled||(Ke.resumeScheduled=!0,L.nextTick(ht,Ge,Ke))}function ht(Ge,Ke){Ke.reading||(Z("resume read 0"),Ge.read(0)),Ke.resumeScheduled=!1,Ke.awaitDrain=0,Ge.emit("resume"),ft(Ge),Ke.flowing&&!Ke.reading&&Ge.read(0)}ot.prototype.pause=function(){return Z("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Z("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function ft(Ge){var Ke=Ge._readableState;for(Z("flow",Ke.flowing);Ke.flowing&&Ge.read()!==null;);}ot.prototype.wrap=function(Ge){var Ke=this,zt=this._readableState,Vt=!1;Ge.on("end",function(){if(Z("wrapped end"),zt.decoder&&!zt.ended){var Me=zt.decoder.end();Me&&Me.length&&Ke.push(Me)}Ke.push(null)}),Ge.on("data",function(Me){if(Z("wrapped data"),zt.decoder&&(Me=zt.decoder.write(Me)),!(zt.objectMode&&Me==null)&&!(!zt.objectMode&&(!Me||!Me.length))){var oe=Ke.push(Me);oe||(Vt=!0,Ge.pause())}});for(var $r in Ge)this[$r]===void 0&&typeof Ge[$r]=="function"&&(this[$r]=function(Me){return function(){return Ge[Me].apply(Ge,arguments)}}($r));for(var Qr=0;Qr<xe.length;Qr++)Ge.on(xe[Qr],this.emit.bind(this,xe[Qr]));return this._read=function(Me){Z("wrapped _read",Me),Vt&&(Vt=!1,Ge.resume())},this},Object.defineProperty(ot.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),ot._fromList=Ht;function Ht(Ge,Ke){if(Ke.length===0)return null;var zt;return Ke.objectMode?zt=Ke.buffer.shift():!Ge||Ge>=Ke.length?(Ke.decoder?zt=Ke.buffer.join(""):Ke.buffer.length===1?zt=Ke.buffer.head.data:zt=Ke.buffer.concat(Ke.length),Ke.buffer.clear()):zt=hr(Ge,Ke.buffer,Ke.decoder),zt}function hr(Ge,Ke,zt){var Vt;return Ge<Ke.head.data.length?(Vt=Ke.head.data.slice(0,Ge),Ke.head.data=Ke.head.data.slice(Ge)):Ge===Ke.head.data.length?Vt=Ke.shift():Vt=zt?Br(Ge,Ke):Vr(Ge,Ke),Vt}function Br(Ge,Ke){var zt=Ke.head,Vt=1,$r=zt.data;for(Ge-=$r.length;zt=zt.next;){var Qr=zt.data,Me=Ge>Qr.length?Qr.length:Ge;if(Me===Qr.length?$r+=Qr:$r+=Qr.slice(0,Ge),Ge-=Me,Ge===0){Me===Qr.length?(++Vt,zt.next?Ke.head=zt.next:Ke.head=Ke.tail=null):(Ke.head=zt,zt.data=Qr.slice(Me));break}++Vt}return Ke.length-=Vt,$r}function Vr(Ge,Ke){var zt=ge.allocUnsafe(Ge),Vt=Ke.head,$r=1;for(Vt.data.copy(zt),Ge-=Vt.data.length;Vt=Vt.next;){var Qr=Vt.data,Me=Ge>Qr.length?Qr.length:Ge;if(Qr.copy(zt,zt.length-Ge,0,Me),Ge-=Me,Ge===0){Me===Qr.length?(++$r,Vt.next?Ke.head=Vt.next:Ke.head=Ke.tail=null):(Ke.head=Vt,Vt.data=Qr.slice(Me));break}++$r}return Ke.length-=$r,zt}function ma(Ge){var Ke=Ge._readableState;if(Ke.length>0)throw new Error('"endReadable()" called on non-empty stream');Ke.endEmitted||(Ke.ended=!0,L.nextTick(ca,Ke,Ge))}function ca(Ge,Ke){!Ge.endEmitted&&Ge.length===0&&(Ge.endEmitted=!0,Ke.readable=!1,Ke.emit("end"))}function ua(Ge,Ke){for(var zt=0,Vt=Ge.length;zt<Vt;zt++)if(Ge[zt]===Ke)return zt;return-1}}).call(this,Fe("_process"),typeof ws<"u"?ws:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":66,"./internal/streams/BufferList":71,"./internal/streams/destroy":72,"./internal/streams/stream":73,_process:64,"core-util-is":4,events:5,inherits:8,isarray:10,"process-nextick-args":63,"safe-buffer":78,"string_decoder/":81,util:2}],69:[function(Fe,Ct,K){Ct.exports=G;var we=Fe("./_stream_duplex"),H=Object.create(Fe("core-util-is"));H.inherits=Fe("inherits"),H.inherits(G,we);function L(Y,ge){var fe=this._transformState;fe.transforming=!1;var Se=fe.writecb;if(!Se)return this.emit("error",new Error("write callback called multiple times"));fe.writechunk=null,fe.writecb=null,ge!=null&&this.push(ge),Se(Y);var ke=this._readableState;ke.reading=!1,(ke.needReadable||ke.length<ke.highWaterMark)&&this._read(ke.highWaterMark)}function G(Y){if(!(this instanceof G))return new G(Y);we.call(this,Y),this._transformState={afterTransform:L.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,Y&&(typeof Y.transform=="function"&&(this._transform=Y.transform),typeof Y.flush=="function"&&(this._flush=Y.flush)),this.on("prefinish",J)}function J(){var Y=this;typeof this._flush=="function"?this._flush(function(ge,fe){X(Y,ge,fe)}):X(this,null,null)}G.prototype.push=function(Y,ge){return this._transformState.needTransform=!1,we.prototype.push.call(this,Y,ge)},G.prototype._transform=function(Y,ge,fe){throw new Error("_transform() is not implemented")},G.prototype._write=function(Y,ge,fe){var Se=this._transformState;if(Se.writecb=fe,Se.writechunk=Y,Se.writeencoding=ge,!Se.transforming){var ke=this._readableState;(Se.needTransform||ke.needReadable||ke.length<ke.highWaterMark)&&this._read(ke.highWaterMark)}},G.prototype._read=function(Y){var ge=this._transformState;ge.writechunk!==null&&ge.writecb&&!ge.transforming?(ge.transforming=!0,this._transform(ge.writechunk,ge.writeencoding,ge.afterTransform)):ge.needTransform=!0},G.prototype._destroy=function(Y,ge){var fe=this;we.prototype._destroy.call(this,Y,function(Se){ge(Se),fe.emit("close")})};function X(Y,ge,fe){if(ge)return Y.emit("error",ge);if(fe!=null&&Y.push(fe),Y._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(Y._transformState.transforming)throw new Error("Calling transform done when still transforming");return Y.push(null)}},{"./_stream_duplex":66,"core-util-is":4,inherits:8}],70:[function(Fe,Ct,K){(function(we,H,L){var G=Fe("process-nextick-args");Ct.exports=Oe;function J(ht){var ft=this;this.next=null,this.entry=null,this.finish=function(){zr(ft,ht)}}var X=!we.browser&&["v0.10","v0.9."].indexOf(we.version.slice(0,5))>-1?L:G.nextTick,Y;Oe.WritableState=te;var ge=Object.create(Fe("core-util-is"));ge.inherits=Fe("inherits");var fe={deprecate:Fe("util-deprecate")},Se=Fe("./internal/streams/stream"),ke=Fe("safe-buffer").Buffer,ie=H.Uint8Array||function(){};function O(ht){return ke.from(ht)}function Z(ht){return ke.isBuffer(ht)||ht instanceof ie}var he=Fe("./internal/streams/destroy");ge.inherits(Oe,Se);function $e(){}function te(ht,ft){Y=Y||Fe("./_stream_duplex"),ht=ht||{};var Ht=ft instanceof Y;this.objectMode=!!ht.objectMode,Ht&&(this.objectMode=this.objectMode||!!ht.writableObjectMode);var hr=ht.highWaterMark,Br=ht.writableHighWaterMark,Vr=this.objectMode?16:16*1024;hr||hr===0?this.highWaterMark=hr:Ht&&(Br||Br===0)?this.highWaterMark=Br:this.highWaterMark=Vr,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ma=ht.decodeStrings===!1;this.decodeStrings=!ma,this.defaultEncoding=ht.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ca){rt(ft,ca)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new J(this)}te.prototype.getBuffer=function(){for(var ft=this.bufferedRequest,Ht=[];ft;)Ht.push(ft),ft=ft.next;return Ht},function(){try{Object.defineProperty(te.prototype,"buffer",{get:fe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var xe;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(xe=Function.prototype[Symbol.hasInstance],Object.defineProperty(Oe,Symbol.hasInstance,{value:function(ht){return xe.call(this,ht)?!0:this!==Oe?!1:ht&&ht._writableState instanceof te}})):xe=function(ht){return ht instanceof this};function Oe(ht){if(Y=Y||Fe("./_stream_duplex"),!xe.call(Oe,this)&&!(this instanceof Y))return new Oe(ht);this._writableState=new te(ht,this),this.writable=!0,ht&&(typeof ht.write=="function"&&(this._write=ht.write),typeof ht.writev=="function"&&(this._writev=ht.writev),typeof ht.destroy=="function"&&(this._destroy=ht.destroy),typeof ht.final=="function"&&(this._final=ht.final)),Se.call(this)}Oe.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Je(ht,ft){var Ht=new Error("write after end");ht.emit("error",Ht),G.nextTick(ft,Ht)}function ot(ht,ft,Ht,hr){var Br=!0,Vr=!1;return Ht===null?Vr=new TypeError("May not write null values to stream"):typeof Ht!="string"&&Ht!==void 0&&!ft.objectMode&&(Vr=new TypeError("Invalid non-string/buffer chunk")),Vr&&(ht.emit("error",Vr),G.nextTick(hr,Vr),Br=!1),Br}Oe.prototype.write=function(ht,ft,Ht){var hr=this._writableState,Br=!1,Vr=!hr.objectMode&&Z(ht);return Vr&&!ke.isBuffer(ht)&&(ht=O(ht)),typeof ft=="function"&&(Ht=ft,ft=null),Vr?ft="buffer":ft||(ft=hr.defaultEncoding),typeof Ht!="function"&&(Ht=$e),hr.ended?Je(this,Ht):(Vr||ot(this,hr,ht,Ht))&&(hr.pendingcb++,Br=Et(this,hr,Vr,ht,ft,Ht)),Br},Oe.prototype.cork=function(){var ht=this._writableState;ht.corked++},Oe.prototype.uncork=function(){var ht=this._writableState;ht.corked&&(ht.corked--,!ht.writing&&!ht.corked&&!ht.finished&&!ht.bufferProcessing&&ht.bufferedRequest&&kt(this,ht))},Oe.prototype.setDefaultEncoding=function(ft){if(typeof ft=="string"&&(ft=ft.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ft+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+ft);return this._writableState.defaultEncoding=ft,this};function qe(ht,ft,Ht){return!ht.objectMode&&ht.decodeStrings!==!1&&typeof ft=="string"&&(ft=ke.from(ft,Ht)),ft}Object.defineProperty(Oe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Et(ht,ft,Ht,hr,Br,Vr){if(!Ht){var ma=qe(ft,hr,Br);hr!==ma&&(Ht=!0,Br="buffer",hr=ma)}var ca=ft.objectMode?1:hr.length;ft.length+=ca;var ua=ft.length<ft.highWaterMark;if(ua||(ft.needDrain=!0),ft.writing||ft.corked){var Ge=ft.lastBufferedRequest;ft.lastBufferedRequest={chunk:hr,encoding:Br,isBuf:Ht,callback:Vr,next:null},Ge?Ge.next=ft.lastBufferedRequest:ft.bufferedRequest=ft.lastBufferedRequest,ft.bufferedRequestCount+=1}else Ye(ht,ft,!1,ca,hr,Br,Vr);return ua}function Ye(ht,ft,Ht,hr,Br,Vr,ma){ft.writelen=hr,ft.writecb=ma,ft.writing=!0,ft.sync=!0,Ht?ht._writev(Br,ft.onwrite):ht._write(Br,Vr,ft.onwrite),ft.sync=!1}function Be(ht,ft,Ht,hr,Br){--ft.pendingcb,Ht?(G.nextTick(Br,hr),G.nextTick(Yt,ht,ft),ht._writableState.errorEmitted=!0,ht.emit("error",hr)):(Br(hr),ht._writableState.errorEmitted=!0,ht.emit("error",hr),Yt(ht,ft))}function Qe(ht){ht.writing=!1,ht.writecb=null,ht.length-=ht.writelen,ht.writelen=0}function rt(ht,ft){var Ht=ht._writableState,hr=Ht.sync,Br=Ht.writecb;if(Qe(Ht),ft)Be(ht,Ht,hr,ft,Br);else{var Vr=qt(Ht);!Vr&&!Ht.corked&&!Ht.bufferProcessing&&Ht.bufferedRequest&&kt(ht,Ht),hr?X(lt,ht,Ht,Vr,Br):lt(ht,Ht,Vr,Br)}}function lt(ht,ft,Ht,hr){Ht||xt(ht,ft),ft.pendingcb--,hr(),Yt(ht,ft)}function xt(ht,ft){ft.length===0&&ft.needDrain&&(ft.needDrain=!1,ht.emit("drain"))}function kt(ht,ft){ft.bufferProcessing=!0;var Ht=ft.bufferedRequest;if(ht._writev&&Ht&&Ht.next){var hr=ft.bufferedRequestCount,Br=new Array(hr),Vr=ft.corkedRequestsFree;Vr.entry=Ht;for(var ma=0,ca=!0;Ht;)Br[ma]=Ht,Ht.isBuf||(ca=!1),Ht=Ht.next,ma+=1;Br.allBuffers=ca,Ye(ht,ft,!0,ft.length,Br,"",Vr.finish),ft.pendingcb++,ft.lastBufferedRequest=null,Vr.next?(ft.corkedRequestsFree=Vr.next,Vr.next=null):ft.corkedRequestsFree=new J(ft),ft.bufferedRequestCount=0}else{for(;Ht;){var ua=Ht.chunk,Ge=Ht.encoding,Ke=Ht.callback,zt=ft.objectMode?1:ua.length;if(Ye(ht,ft,!1,zt,ua,Ge,Ke),Ht=Ht.next,ft.bufferedRequestCount--,ft.writing)break}Ht===null&&(ft.lastBufferedRequest=null)}ft.bufferedRequest=Ht,ft.bufferProcessing=!1}Oe.prototype._write=function(ht,ft,Ht){Ht(new Error("_write() is not implemented"))},Oe.prototype._writev=null,Oe.prototype.end=function(ht,ft,Ht){var hr=this._writableState;typeof ht=="function"?(Ht=ht,ht=null,ft=null):typeof ft=="function"&&(Ht=ft,ft=null),ht!=null&&this.write(ht,ft),hr.corked&&(hr.corked=1,this.uncork()),!hr.ending&&!hr.finished&&Sr(this,hr,Ht)};function qt(ht){return ht.ending&&ht.length===0&&ht.bufferedRequest===null&&!ht.finished&&!ht.writing}function Ft(ht,ft){ht._final(function(Ht){ft.pendingcb--,Ht&&ht.emit("error",Ht),ft.prefinished=!0,ht.emit("prefinish"),Yt(ht,ft)})}function gr(ht,ft){!ft.prefinished&&!ft.finalCalled&&(typeof ht._final=="function"?(ft.pendingcb++,ft.finalCalled=!0,G.nextTick(Ft,ht,ft)):(ft.prefinished=!0,ht.emit("prefinish")))}function Yt(ht,ft){var Ht=qt(ft);return Ht&&(gr(ht,ft),ft.pendingcb===0&&(ft.finished=!0,ht.emit("finish"))),Ht}function Sr(ht,ft,Ht){ft.ending=!0,Yt(ht,ft),Ht&&(ft.finished?G.nextTick(Ht):ht.once("finish",Ht)),ft.ended=!0,ht.writable=!1}function zr(ht,ft,Ht){var hr=ht.entry;for(ht.entry=null;hr;){var Br=hr.callback;ft.pendingcb--,Br(Ht),hr=hr.next}ft.corkedRequestsFree?ft.corkedRequestsFree.next=ht:ft.corkedRequestsFree=ht}Object.defineProperty(Oe.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(ht){this._writableState&&(this._writableState.destroyed=ht)}}),Oe.prototype.destroy=he.destroy,Oe.prototype._undestroy=he.undestroy,Oe.prototype._destroy=function(ht,ft){this.end(),ft(ht)}}).call(this,Fe("_process"),typeof ws<"u"?ws:typeof self<"u"?self:typeof window<"u"?window:{},Fe("timers").setImmediate)},{"./_stream_duplex":66,"./internal/streams/destroy":72,"./internal/streams/stream":73,_process:64,"core-util-is":4,inherits:8,"process-nextick-args":63,"safe-buffer":78,timers:82,"util-deprecate":83}],71:[function(Fe,Ct,K){function we(J,X){if(!(J instanceof X))throw new TypeError("Cannot call a class as a function")}var H=Fe("safe-buffer").Buffer,L=Fe("util");function G(J,X,Y){J.copy(X,Y)}Ct.exports=function(){function J(){we(this,J),this.head=null,this.tail=null,this.length=0}return J.prototype.push=function(Y){var ge={data:Y,next:null};this.length>0?this.tail.next=ge:this.head=ge,this.tail=ge,++this.length},J.prototype.unshift=function(Y){var ge={data:Y,next:this.head};this.length===0&&(this.tail=ge),this.head=ge,++this.length},J.prototype.shift=function(){if(this.length!==0){var Y=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,Y}},J.prototype.clear=function(){this.head=this.tail=null,this.length=0},J.prototype.join=function(Y){if(this.length===0)return"";for(var ge=this.head,fe=""+ge.data;ge=ge.next;)fe+=Y+ge.data;return fe},J.prototype.concat=function(Y){if(this.length===0)return H.alloc(0);if(this.length===1)return this.head.data;for(var ge=H.allocUnsafe(Y>>>0),fe=this.head,Se=0;fe;)G(fe.data,ge,Se),Se+=fe.data.length,fe=fe.next;return ge},J}(),L&&L.inspect&&L.inspect.custom&&(Ct.exports.prototype[L.inspect.custom]=function(){var J=L.inspect({length:this.length});return this.constructor.name+" "+J})},{"safe-buffer":78,util:2}],72:[function(Fe,Ct,K){var we=Fe("process-nextick-args");function H(J,X){var Y=this,ge=this._readableState&&this._readableState.destroyed,fe=this._writableState&&this._writableState.destroyed;return ge||fe?(X?X(J):J&&(!this._writableState||!this._writableState.errorEmitted)&&we.nextTick(G,this,J),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(J||null,function(Se){!X&&Se?(we.nextTick(G,Y,Se),Y._writableState&&(Y._writableState.errorEmitted=!0)):X&&X(Se)}),this)}function L(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function G(J,X){J.emit("error",X)}Ct.exports={destroy:H,undestroy:L}},{"process-nextick-args":63}],73:[function(Fe,Ct,K){Ct.exports=Fe("events").EventEmitter},{events:5}],74:[function(Fe,Ct,K){Ct.exports=Fe("./readable").PassThrough},{"./readable":75}],75:[function(Fe,Ct,K){K=Ct.exports=Fe("./lib/_stream_readable.js"),K.Stream=K,K.Readable=K,K.Writable=Fe("./lib/_stream_writable.js"),K.Duplex=Fe("./lib/_stream_duplex.js"),K.Transform=Fe("./lib/_stream_transform.js"),K.PassThrough=Fe("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":66,"./lib/_stream_passthrough.js":67,"./lib/_stream_readable.js":68,"./lib/_stream_transform.js":69,"./lib/_stream_writable.js":70}],76:[function(Fe,Ct,K){Ct.exports=Fe("./readable").Transform},{"./readable":75}],77:[function(Fe,Ct,K){Ct.exports=Fe("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":70}],78:[function(Fe,Ct,K){var we=Fe("buffer"),H=we.Buffer;function L(J,X){for(var Y in J)X[Y]=J[Y]}H.from&&H.alloc&&H.allocUnsafe&&H.allocUnsafeSlow?Ct.exports=we:(L(we,K),K.Buffer=G);function G(J,X,Y){return H(J,X,Y)}L(H,G),G.from=function(J,X,Y){if(typeof J=="number")throw new TypeError("Argument must not be a number");return H(J,X,Y)},G.alloc=function(J,X,Y){if(typeof J!="number")throw new TypeError("Argument must be a number");var ge=H(J);return X!==void 0?typeof Y=="string"?ge.fill(X,Y):ge.fill(X):ge.fill(0),ge},G.allocUnsafe=function(J){if(typeof J!="number")throw new TypeError("Argument must be a number");return H(J)},G.allocUnsafeSlow=function(J){if(typeof J!="number")throw new TypeError("Argument must be a number");return we.SlowBuffer(J)}},{buffer:3}],79:[function(Fe,Ct,K){(function(we){Ct.exports=typeof we=="function"?we:function(){var L=[].slice.apply(arguments);L.splice(1,0,0),setTimeout.apply(null,L)}}).call(this,Fe("timers").setImmediate)},{timers:82}],80:[function(Fe,Ct,K){Ct.exports=L;var we=Fe("events").EventEmitter,H=Fe("inherits");H(L,we),L.Readable=Fe("readable-stream/readable.js"),L.Writable=Fe("readable-stream/writable.js"),L.Duplex=Fe("readable-stream/duplex.js"),L.Transform=Fe("readable-stream/transform.js"),L.PassThrough=Fe("readable-stream/passthrough.js"),L.Stream=L;function L(){we.call(this)}L.prototype.pipe=function(G,J){var X=this;function Y(Z){G.writable&&G.write(Z)===!1&&X.pause&&X.pause()}X.on("data",Y);function ge(){X.readable&&X.resume&&X.resume()}G.on("drain",ge),!G._isStdio&&(!J||J.end!==!1)&&(X.on("end",Se),X.on("close",ke));var fe=!1;function Se(){fe||(fe=!0,G.end())}function ke(){fe||(fe=!0,typeof G.destroy=="function"&&G.destroy())}function ie(Z){if(O(),we.listenerCount(this,"error")===0)throw Z}X.on("error",ie),G.on("error",ie);function O(){X.removeListener("data",Y),G.removeListener("drain",ge),X.removeListener("end",Se),X.removeListener("close",ke),X.removeListener("error",ie),G.removeListener("error",ie),X.removeListener("end",O),X.removeListener("close",O),G.removeListener("close",O)}return X.on("end",O),X.on("close",O),G.on("close",O),G.emit("pipe",X),G}},{events:5,inherits:8,"readable-stream/duplex.js":65,"readable-stream/passthrough.js":74,"readable-stream/readable.js":75,"readable-stream/transform.js":76,"readable-stream/writable.js":77}],81:[function(Fe,Ct,K){var we=Fe("safe-buffer").Buffer,H=we.isEncoding||function(xe){switch(xe=""+xe,xe&&xe.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function L(xe){if(!xe)return"utf8";for(var Oe;;)switch(xe){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return xe;default:if(Oe)return;xe=(""+xe).toLowerCase(),Oe=!0}}function G(xe){var Oe=L(xe);if(typeof Oe!="string"&&(we.isEncoding===H||!H(xe)))throw new Error("Unknown encoding: "+xe);return Oe||xe}K.StringDecoder=J;function J(xe){this.encoding=G(xe);var Oe;switch(this.encoding){case"utf16le":this.text=ie,this.end=O,Oe=4;break;case"utf8":this.fillLast=fe,Oe=4;break;case"base64":this.text=Z,this.end=he,Oe=3;break;default:this.write=$e,this.end=te;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=we.allocUnsafe(Oe)}J.prototype.write=function(xe){if(xe.length===0)return"";var Oe,Je;if(this.lastNeed){if(Oe=this.fillLast(xe),Oe===void 0)return"";Je=this.lastNeed,this.lastNeed=0}else Je=0;return Je<xe.length?Oe?Oe+this.text(xe,Je):this.text(xe,Je):Oe||""},J.prototype.end=ke,J.prototype.text=Se,J.prototype.fillLast=function(xe){if(this.lastNeed<=xe.length)return xe.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);xe.copy(this.lastChar,this.lastTotal-this.lastNeed,0,xe.length),this.lastNeed-=xe.length};function X(xe){return xe<=127?0:xe>>5===6?2:xe>>4===14?3:xe>>3===30?4:xe>>6===2?-1:-2}function Y(xe,Oe,Je){var ot=Oe.length-1;if(ot<Je)return 0;var qe=X(Oe[ot]);return qe>=0?(qe>0&&(xe.lastNeed=qe-1),qe):--ot<Je||qe===-2?0:(qe=X(Oe[ot]),qe>=0?(qe>0&&(xe.lastNeed=qe-2),qe):--ot<Je||qe===-2?0:(qe=X(Oe[ot]),qe>=0?(qe>0&&(qe===2?qe=0:xe.lastNeed=qe-3),qe):0))}function ge(xe,Oe,Je){if((Oe[0]&192)!==128)return xe.lastNeed=0,"";if(xe.lastNeed>1&&Oe.length>1){if((Oe[1]&192)!==128)return xe.lastNeed=1,"";if(xe.lastNeed>2&&Oe.length>2&&(Oe[2]&192)!==128)return xe.lastNeed=2,""}}function fe(xe){var Oe=this.lastTotal-this.lastNeed,Je=ge(this,xe);if(Je!==void 0)return Je;if(this.lastNeed<=xe.length)return xe.copy(this.lastChar,Oe,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);xe.copy(this.lastChar,Oe,0,xe.length),this.lastNeed-=xe.length}function Se(xe,Oe){var Je=Y(this,xe,Oe);if(!this.lastNeed)return xe.toString("utf8",Oe);this.lastTotal=Je;var ot=xe.length-(Je-this.lastNeed);return xe.copy(this.lastChar,0,ot),xe.toString("utf8",Oe,ot)}function ke(xe){var Oe=xe&&xe.length?this.write(xe):"";return this.lastNeed?Oe+"":Oe}function ie(xe,Oe){if((xe.length-Oe)%2===0){var Je=xe.toString("utf16le",Oe);if(Je){var ot=Je.charCodeAt(Je.length-1);if(ot>=55296&&ot<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=xe[xe.length-2],this.lastChar[1]=xe[xe.length-1],Je.slice(0,-1)}return Je}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=xe[xe.length-1],xe.toString("utf16le",Oe,xe.length-1)}function O(xe){var Oe=xe&&xe.length?this.write(xe):"";if(this.lastNeed){var Je=this.lastTotal-this.lastNeed;return Oe+this.lastChar.toString("utf16le",0,Je)}return Oe}function Z(xe,Oe){var Je=(xe.length-Oe)%3;return Je===0?xe.toString("base64",Oe):(this.lastNeed=3-Je,this.lastTotal=3,Je===1?this.lastChar[0]=xe[xe.length-1]:(this.lastChar[0]=xe[xe.length-2],this.lastChar[1]=xe[xe.length-1]),xe.toString("base64",Oe,xe.length-Je))}function he(xe){var Oe=xe&&xe.length?this.write(xe):"";return this.lastNeed?Oe+this.lastChar.toString("base64",0,3-this.lastNeed):Oe}function $e(xe){return xe.toString(this.encoding)}function te(xe){return xe&&xe.length?this.write(xe):""}},{"safe-buffer":78}],82:[function(Fe,Ct,K){(function(we,H){var L=Fe("process/browser.js").nextTick,G=Function.prototype.apply,J=Array.prototype.slice,X={},Y=0;K.setTimeout=function(){return new ge(G.call(setTimeout,window,arguments),clearTimeout)},K.setInterval=function(){return new ge(G.call(setInterval,window,arguments),clearInterval)},K.clearTimeout=K.clearInterval=function(fe){fe.close()};function ge(fe,Se){this._id=fe,this._clearFn=Se}ge.prototype.unref=ge.prototype.ref=function(){},ge.prototype.close=function(){this._clearFn.call(window,this._id)},K.enroll=function(fe,Se){clearTimeout(fe._idleTimeoutId),fe._idleTimeout=Se},K.unenroll=function(fe){clearTimeout(fe._idleTimeoutId),fe._idleTimeout=-1},K._unrefActive=K.active=function(fe){clearTimeout(fe._idleTimeoutId);var Se=fe._idleTimeout;Se>=0&&(fe._idleTimeoutId=setTimeout(function(){fe._onTimeout&&fe._onTimeout()},Se))},K.setImmediate=typeof we=="function"?we:function(fe){var Se=Y++,ke=arguments.length<2?!1:J.call(arguments,1);return X[Se]=!0,L(function(){X[Se]&&(ke?fe.apply(null,ke):fe.call(null),K.clearImmediate(Se))}),Se},K.clearImmediate=typeof H=="function"?H:function(fe){delete X[fe]}}).call(this,Fe("timers").setImmediate,Fe("timers").clearImmediate)},{"process/browser.js":64,timers:82}],83:[function(Fe,Ct,K){(function(we){Ct.exports=H;function H(G,J){if(L("noDeprecation"))return G;var X=!1;function Y(){if(!X){if(L("throwDeprecation"))throw new Error(J);L("traceDeprecation")?console.trace(J):console.warn(J),X=!0}return G.apply(this,arguments)}return Y}function L(G){try{if(!we.localStorage)return!1}catch{return!1}var J=we.localStorage[G];return J==null?!1:String(J).toLowerCase()==="true"}}).call(this,typeof ws<"u"?ws:typeof self<"u"?self:typeof window<"u"?window:{})},{}],84:[function(Fe,Ct,K){var we=function(J){return J&&J.__esModule?J:{default:J}};Object.defineProperty(K,"__esModule",{value:!0}),K.HandleZip=void 0;var H=we(Fe("jszip")),L=Fe("./common/method"),G=function(){function J(X){this.uploadFile=X}return J.prototype.unzipFile=function(X,Y){H.default.loadAsync(this.uploadFile).then(function(ge){var fe={},Se=Object.keys(ge.files).length,ke=0;ge.forEach(function(ie,O){var Z=O.name,he=Z.split("."),$e=he[he.length-1].toLowerCase(),te="string";$e in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?te="base64":$e=="emf"&&(te="arraybuffer"),O.async(te).then(function(xe){te=="base64"&&(xe="data:image/"+$e+";base64,"+xe),fe[O.name]=xe,Se==ke+1&&X(fe),ke++})})},function(ge){Y(ge)})},J.prototype.unzipFileByUrl=function(X,Y,ge){new H.default,L.getBinaryContent(X,function(fe,Se){if(fe)throw fe;H.default.loadAsync(Se).then(function(ke){var ie={},O=Object.keys(ke.files).length,Z=0;ke.forEach(function(he,$e){var te=$e.name,xe=te.split("."),Oe=xe[xe.length-1].toLowerCase(),Je="string";Oe in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?Je="base64":Oe=="emf"&&(Je="arraybuffer"),$e.async(Je).then(function(ot){Je=="base64"&&(ot="data:image/"+Oe+";base64,"+ot),ie[$e.name]=ot,O==Z+1&&Y(ie),Z++})})},function(ke){ge(ke)})})},J.prototype.newZipFile=function(){var X=new H.default;this.workBook=X},J.prototype.addToZipFile=function(X,Y){if(this.workBook==null){var ge=new H.default;this.workBook=ge}this.workBook.file(X,Y)},J}();K.HandleZip=G},{"./common/method":93,jszip:20}],85:[function(Fe,Ct,K){Object.defineProperty(K,"__esModule",{value:!0}),K.LuckyImageBase=K.LuckysheetCalcChain=K.LuckySheetConfigMerge=K.LuckySheetborderInfoCellValueStyle=K.LuckySheetborderInfoCellValue=K.LuckySheetborderInfoCellForImp=K.LuckyConfig=K.LuckyInlineString=K.LuckySheetCellFormat=K.LuckySheetCelldataValue=K.LuckySheetCelldataBase=K.LuckyFileInfo=K.LuckySheetBase=K.LuckyFileBase=void 0;var we=function(){function he(){}return he}();K.LuckyFileBase=we;var H=function(){function he(){}return he}();K.LuckySheetBase=H;var L=function(){function he(){}return he}();K.LuckyFileInfo=L;var G=function(){function he(){}return he}();K.LuckySheetCelldataBase=G;var J=function(){function he(){}return he}();K.LuckySheetCelldataValue=J;var X=function(){function he(){}return he}();K.LuckySheetCellFormat=X;var Y=function(){function he(){}return he}();K.LuckyInlineString=Y;var ge=function(){function he(){}return he}();K.LuckyConfig=ge;var fe=function(){function he(){}return he}();K.LuckySheetborderInfoCellForImp=fe;var Se=function(){function he(){}return he}();K.LuckySheetborderInfoCellValue=Se;var ke=function(){function he(){}return he}();K.LuckySheetborderInfoCellValueStyle=ke;var ie=function(){function he(){}return he}();K.LuckySheetConfigMerge=ie;var O=function(){function he(){}return he}();K.LuckysheetCalcChain=O;var Z=function(){function he(){}return he}();K.LuckyImageBase=Z},{}],86:[function(Fe,Ct,K){var we=function(){var Y=function(fe,Se){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ke,ie){ke.__proto__=ie}||function(ke,ie){for(var O in ie)ie.hasOwnProperty(O)&&(ke[O]=ie[O])},Y(fe,Se)};return function(ge,fe){Y(ge,fe);function Se(){this.constructor=ge}ge.prototype=fe===null?Object.create(fe):(Se.prototype=fe.prototype,new Se)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.LuckySheetCelldata=void 0;var H=Fe("./ReadXml"),L=Fe("../common/method"),G=Fe("../common/constant"),J=Fe("./LuckyBase"),X=function(Y){we(ge,Y);function ge(fe,Se,ke,ie,O,Z){var he=Y.call(this)||this;he.cell=fe,he.sheetFile=O,he.styles=Se,he.sharedStrings=ke,he.readXml=Z,he.mergeCells=ie;var $e=fe.attributeList,te=$e.r,xe=$e.s,Oe=$e.t,Je=L.getcellrange(te);return he.r=Je.row[0],he.c=Je.column[0],he.v=he.generateValue(xe,Oe),he}return ge.prototype.generateValue=function(fe,Se){var ke=this,ie=this.cell.getInnerElements("v"),O=this.cell.getInnerElements("f");ie==null&&(ie=this.cell.getInnerElements("t"));var Z=this.styles.cellXfs,he=this.styles.cellStyleXfs;this.styles.cellStyles;var $e=this.styles.fonts,te=this.styles.fills,xe=this.styles.borders,Oe=this.styles.numfmts,Je=this.styles.clrScheme,ot=this.sharedStrings,qe=new J.LuckySheetCelldataValue;if(O!=null){var Et=O[0],Ye=Et.attributeList,Be=Ye.t,Qe=Ye.ref,rt=Ye.si,lt=O[0].value;Be=="shared"&&(this._fomulaRef=Qe,this._formulaType=Be,this._formulaSi=rt),(Qe!=null||lt!=null&&lt.length>0)&&(lt=L.escapeCharacter(lt),qe.f="="+lt)}var xt=null,kt;if(fe!=null){var qt=parseInt(fe),Ft=Z[qt],gr=Ft.attributeList.xfId,Yt=void 0,Sr=void 0,zr=void 0,ht=void 0,ft=void 0,Ht=void 0,hr=void 0,Br=void 0;if(gr!=null){var Vr=he[parseInt(gr)],Ye=Vr.attributeList,ma=Ye.applyNumberFormat,ca=Ye.applyFont,ua=Ye.applyFill,Ge=Ye.applyBorder,Ke=Ye.applyAlignment;if(Ye.applyProtection,kt=Ye.quotePrefix,ma!="0"&&Ye.numFmtId!=null&&(Yt=Ye.numFmtId),ca!="0"&&Ye.fontId!=null&&(Sr=Ye.fontId),ua!="0"&&Ye.fillId!=null&&(zr=Ye.fillId),Ge!="0"&&Ye.borderId!=null&&(ht=Ye.borderId),Ke!=null&&Ke!="0"){var zt=Vr.getInnerElements("alignment");if(zt!=null){var Vt=zt[0].attributeList;Vt.horizontal!=null&&(ft=Vt.horizontal),Vt.vertical!=null&&(Ht=Vt.vertical),Vt.wrapText!=null&&(hr=Vt.wrapText),Vt.textRotation!=null&&(Br=Vt.textRotation),Vt.shrinkToFit!=null&&Vt.shrinkToFit,Vt.indent!=null&&Vt.indent}}}var $r=Ft.attributeList.applyNumberFormat,Qr=Ft.attributeList.applyFont,Me=Ft.attributeList.applyFill,oe=Ft.attributeList.applyBorder,se=Ft.attributeList.applyAlignment;if(Ft.attributeList.applyProtection!=null&&Ft.attributeList.applyProtection,Ft.attributeList.quotePrefix!=null&&(kt=Ft.attributeList.quotePrefix),$r!="0"&&Ft.attributeList.numFmtId!=null&&(Yt=Ft.attributeList.numFmtId),Qr!="0"&&(Sr=Ft.attributeList.fontId),Me!="0"&&(zr=Ft.attributeList.fillId),oe!="0"&&(ht=Ft.attributeList.borderId),se!="0"){var zt=Ft.getInnerElements("alignment");if(zt!=null&&zt.length>0){var Ye=zt[0].attributeList;Ye.horizontal!=null&&(ft=Ye.horizontal),Ye.vertical!=null&&(Ht=Ye.vertical),Ye.wrapText!=null&&(hr=Ye.wrapText),Ye.textRotation!=null&&(Br=Ye.textRotation),Ye.shrinkToFit!=null&&Ye.shrinkToFit,Ye.indent!=null&&Ye.indent}}if(Yt!=null){var Le=Oe[parseInt(Yt)],ut=new J.LuckySheetCellFormat;ut.fa=L.escapeCharacter(Le),ut.t=Se,qe.ct=ut}if(zr!=null){var sr=parseInt(zr),Zt=te[sr],sa=this.getBackgroundByFill(Zt,Je);sa!=null&&(qe.bg=sa)}if(Sr!=null){var da=parseInt(Sr),Ur=$e[da];if(Ur!=null){var Sa=Ur.getInnerElements("sz"),ha=Ur.getInnerElements("color"),An=Ur.getInnerElements("name"),Ta=Ur.getInnerElements("family");Ur.getInnerElements("charset");var Va=Ur.getInnerElements("b"),In=Ur.getInnerElements("i"),Pe=Ur.getInnerElements("strike"),cr=Ur.getInnerElements("u");if(Sa!=null&&Sa.length>0){var wr=Sa[0].attributeList.val;wr!=null&&(qe.fs=parseInt(wr))}if(ha!=null&&ha.length>0){var Gr=ha[0],yt=H.getColor(Gr,this.styles,"t");yt!=null&&(qe.fc=yt)}if(Ta!=null&&Ta.length>0){var Gt=Ta[0].attributeList.val;Gt!=null&&(xt=G.fontFamilys[Gt])}if(An!=null&&An.length>0){var Gt=An[0].attributeList.val;Gt!=null&&(qe.ff=Gt)}if(Va!=null&&Va.length>0){var Ie=Va[0].attributeList.val;Ie=="0"?qe.bl=0:qe.bl=1}if(In!=null&&In.length>0){var pr=In[0].attributeList.val;pr=="0"?qe.it=0:qe.it=1}if(Pe!=null&&Pe.length>0){var xa=Pe[0].attributeList.val;xa=="0"?qe.cl=0:qe.cl=1}if(cr!=null&&cr.length>0){var W=cr[0].attributeList.val;W=="single"?qe.un=1:W=="double"?qe.un=2:W=="singleAccounting"?qe.un=3:W=="doubleAccounting"?qe.un=4:qe.un=0}}}if(ft!=null&&(ft=="center"||ft=="centerContinuous"?qe.ht=0:ft=="left"?qe.ht=1:ft=="right"?qe.ht=2:ft=="distributed"?qe.ht=0:ft=="fill"||ft=="general"?qe.ht=1:ft=="justify"?qe.ht=0:qe.ht=1),Ht!=null&&(Ht=="bottom"?qe.vt=2:Ht=="center"||Ht=="distributed"||Ht=="justify"?qe.vt=0:(Ht=="top",qe.vt=1)),hr!=null&&hr=="1"?qe.tb=2:qe.tb=1,Br!=null&&(Br=="255"?qe.tr=3:(qe.tr=0,qe.rt=parseInt(Br))),ht!=null){var Pt=parseInt(ht),Bt=xe[Pt],Ce=new J.LuckySheetborderInfoCellForImp;Ce.rangeType="cell";var it=new J.LuckySheetborderInfoCellValue;it.row_index=this.r,it.col_index=this.c;var Mt=Bt.getInnerElements("left"),ra=Bt.getInnerElements("right"),Nr=Bt.getInnerElements("top"),Er=Bt.getInnerElements("bottom"),Ua=Bt.getInnerElements("diagonal"),Gl=Bt.getInnerElements("start"),$n=Bt.getInnerElements("end"),Oa=this.getBorderInfo(Mt),Nn=this.getBorderInfo(ra),Bn=this.getBorderInfo(Nr),Qa=this.getBorderInfo(Er);this.getBorderInfo(Ua);var ti=this.getBorderInfo(Gl),Il=this.getBorderInfo($n),yn=!1;ti!=null&&ti.color!=null&&(it.l=ti,yn=!0),Il!=null&&Il.color!=null&&(it.r=Il,yn=!0),Oa!=null&&Oa.color!=null&&(it.l=Oa,yn=!0),Nn!=null&&Nn.color!=null&&(it.r=Nn,yn=!0),Bn!=null&&Bn.color!=null&&(it.t=Bn,yn=!0),Qa!=null&&Qa.color!=null&&(it.b=Qa,yn=!0),yn&&(Ce.value=it,this._borderObject=Ce)}}else qe.tb=1;if(ie!=null){var el=ie[0].value;if(/&#\d+;/.test(el)&&(el=this.htmlDecode(el)),Se==G.ST_CellType.SharedString){var Yn=parseInt(ie[0].value),Rl=ot[Yn],El=Rl.getInnerElements("r");if(El==null){var Gi=Rl.getInnerElements("t");if(Gi!=null){var gl="";if(Gi.forEach(function(Bd){gl+=Bd.value}),gl=L.escapeCharacter(gl),xt=="Roman"&&gl.length>0){var Uo=gl.split(""),ho=null,_s="",Hu=null,Js="Times New Roman";qe.ff!=null&&(Js=qe.ff);var ut=qe.ct;ut==null&&(ut=new J.LuckySheetCellFormat),ut.s==null&&(ut.s=[]);for(var Ho=0;Ho<Uo.length;Ho++){var mo=Uo[Ho],fo=null,jo=Js;if(L.isChinese(mo)?(fo="c",jo=""):L.isJapanese(mo)?(fo="j",jo="Yu Gothic"):L.isKoera(mo)?(fo="k",jo="Malgun Gothic"):fo="e",fo!=ho&&ho!=null||Ho==Uo.length-1){var qn=new J.LuckyInlineString;if(qn.ff=Hu,qe.fc!=null&&(qn.fc=qe.fc),qe.fs!=null&&(qn.fs=qe.fs),qe.cl!=null&&(qn.cl=qe.cl),qe.un!=null&&(qn.un=qe.un),qe.bl!=null&&(qn.bl=qe.bl),qe.it!=null&&(qn.it=qe.it),Ho==Uo.length-1)if(fo==ho)qn.ff=jo,qn.v=_s+mo;else{qn.ff=Hu,qn.v=_s,ut.s.push(qn);var vl=new J.LuckyInlineString;vl.ff=jo,vl.v=mo,qe.fc!=null&&(vl.fc=qe.fc),qe.fs!=null&&(vl.fs=qe.fs),qe.cl!=null&&(vl.cl=qe.cl),qe.un!=null&&(vl.un=qe.un),qe.bl!=null&&(vl.bl=qe.bl),qe.it!=null&&(vl.it=qe.it),ut.s.push(vl);break}else qn.v=_s;ut.s.push(qn),_s=mo}else _s+=mo;ho=fo,Hu=jo}ut.t="inlineStr",qe.ct=ut}else if(gl=this.replaceSpecialWrap(gl),gl.indexOf(`\r
`)>-1||gl.indexOf(`
`)>-1){var qn=new J.LuckyInlineString;qn.v=gl;var ut=qe.ct;ut==null&&(ut=new J.LuckySheetCellFormat),qe.ff!=null&&(qn.ff=qe.ff),qe.fc!=null&&(qn.fc=qe.fc),qe.fs!=null&&(qn.fs=qe.fs),qe.cl!=null&&(qn.cl=qe.cl),qe.un!=null&&(qn.un=qe.un),qe.bl!=null&&(qn.bl=qe.bl),qe.it!=null&&(qn.it=qe.it),ut.t="inlineStr",ut.s=[qn],qe.ct=ut}else qe.v=gl,kt="1"}}else{var Cs=[];El.forEach(function(ju){var Go=ju.getInnerElements("t"),Ri=ju.getInnerElements("rPr"),rn=new J.LuckyInlineString;if(Go!=null&&Go.length>0){var po=Go[0].value;po=ke.replaceSpecialWrap(po),po=L.escapeCharacter(po),rn.v=po}if(Ri!=null&&Ri.length>0){var $l=Ri[0],Gu=H.getlineStringAttr($l,"sz"),Wu=H.getlineStringAttr($l,"rFont");H.getlineStringAttr($l,"family"),H.getlineStringAttr($l,"charset"),H.getlineStringAttr($l,"scheme");var go=H.getlineStringAttr($l,"b"),Wc=H.getlineStringAttr($l,"i"),Yu=H.getlineStringAttr($l,"u"),Yc=H.getlineStringAttr($l,"strike"),Ts=H.getlineStringAttr($l,"vertAlign"),vo=void 0,Xu=$l.getInnerElements("color");Xu!=null&&Xu.length>0&&(vo=H.getColor(Xu[0],ke.styles,"t"));var bn=void 0;Wu!=null&&(bn=Wu),bn!=null?rn.ff=bn:qe.ff!=null&&(rn.ff=qe.ff),vo!=null?rn.fc=vo:qe.fc!=null&&(rn.fc=qe.fc),Gu!=null?rn.fs=parseInt(Gu):qe.fs!=null&&(rn.fs=qe.fs),Yc!=null?rn.cl=parseInt(Yc):qe.cl!=null&&(rn.cl=qe.cl),Yu!=null?rn.un=parseInt(Yu):qe.un!=null&&(rn.un=qe.un),go!=null?rn.bl=parseInt(go):qe.bl!=null&&(rn.bl=qe.bl),Wc!=null?rn.it=parseInt(Wc):qe.it!=null&&(rn.it=qe.it),Ts!=null&&(rn.va=parseInt(Ts))}else rn.ff==null&&qe.ff!=null&&(rn.ff=qe.ff),rn.fc==null&&qe.fc!=null&&(rn.fc=qe.fc),rn.fs==null&&qe.fs!=null&&(rn.fs=qe.fs),rn.cl==null&&qe.cl!=null&&(rn.cl=qe.cl),rn.un==null&&qe.un!=null&&(rn.un=qe.un),rn.bl==null&&qe.bl!=null&&(rn.bl=qe.bl),rn.it==null&&qe.it!=null&&(rn.it=qe.it);Cs.push(rn)});var ut=qe.ct;ut==null&&(ut=new J.LuckySheetCellFormat),ut.t="inlineStr",ut.s=Cs,qe.ct=ut}}else el=L.escapeCharacter(el),qe.v=el}return kt!=null&&(qe.qp=parseInt(kt)),qe},ge.prototype.replaceSpecialWrap=function(fe){return fe=fe.replace(/_x000D_/g,"").replace(/&#13;&#10;/g,`\r
`).replace(/&#13;/g,"\r").replace(/&#10;/g,`
`),fe},ge.prototype.getBackgroundByFill=function(fe,Se){var ke=fe.getInnerElements("patternFill");if(ke!=null){var ie=ke[0],O=ie.getInnerElements("fgColor"),Z=ie.getInnerElements("bgColor"),he=void 0,$e=void 0;if(O!=null){var te=O[0];he=H.getColor(te,this.styles)}if(Z!=null){var xe=Z[0];$e=H.getColor(xe,this.styles)}if(he!=null)return he;if($e!=null)return $e}else{var Oe=fe.getInnerElements("gradientFill");if(Oe!=null)return null}},ge.prototype.getBorderInfo=function(fe){if(fe==null)return null;var Se=fe[0],ke=Se.attributeList;this.styles.clrScheme;var ie=ke.style;if(ie==null||ie=="none")return null;var O=Se.getInnerElements("color"),Z="#000000";if(O!=null){var he=O[0];Z=H.getColor(he,this.styles,"b"),Z==null&&(Z="#000000")}var $e=new J.LuckySheetborderInfoCellValueStyle;return $e.style=G.borderTypes[ie],$e.color=Z,$e},ge.prototype.htmlDecode=function(fe){return fe.replace(/&#(x)?([^&]{1,5});?/g,function(Se,ke,ie){return String.fromCharCode(parseInt(ie,ke?16:10))})},ge}(J.LuckySheetCelldataBase);K.LuckySheetCelldata=X},{"../common/constant":91,"../common/method":93,"./LuckyBase":85,"./ReadXml":90}],87:[function(Fe,Ct,K){var we=function(){var fe=function(ke,ie){return fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,Z){O.__proto__=Z}||function(O,Z){for(var he in Z)Z.hasOwnProperty(he)&&(O[he]=Z[he])},fe(ke,ie)};return function(Se,ke){fe(Se,ke);function ie(){this.constructor=Se}Se.prototype=ke===null?Object.create(ke):(ie.prototype=ke.prototype,new ie)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.LuckyFile=void 0;var H=Fe("./LuckySheet"),L=Fe("../common/constant"),G=Fe("./ReadXml"),J=Fe("../common/method"),X=Fe("./LuckyBase"),Y=Fe("./LuckyImage"),ge=function(fe){we(Se,fe);function Se(ke,ie){var O=fe.call(this)||this;O.columnWidthSet=[],O.rowHeightSet=[],O.files=ke,O.fileName=ie,O.readXml=new G.ReadXml(ke),O.getSheetNameList(),O.sharedStrings=O.readXml.getElementsByTagName("sst/si",L.sharedStringsFile),O.calcChain=O.readXml.getElementsByTagName("calcChain/c",L.calcChainFile),O.styles={},O.styles.cellXfs=O.readXml.getElementsByTagName("cellXfs/xf",L.stylesFile),O.styles.cellStyleXfs=O.readXml.getElementsByTagName("cellStyleXfs/xf",L.stylesFile),O.styles.cellStyles=O.readXml.getElementsByTagName("cellStyles/cellStyle",L.stylesFile),O.styles.fonts=O.readXml.getElementsByTagName("fonts/font",L.stylesFile),O.styles.fills=O.readXml.getElementsByTagName("fills/fill",L.stylesFile),O.styles.borders=O.readXml.getElementsByTagName("borders/border",L.stylesFile),O.styles.clrScheme=O.readXml.getElementsByTagName("a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink",L.theme1File),O.styles.indexedColors=O.readXml.getElementsByTagName("colors/indexedColors/rgbColor",L.stylesFile),O.styles.mruColors=O.readXml.getElementsByTagName("colors/mruColors/color",L.stylesFile),O.imageList=new Y.ImageList(ke);for(var Z=O.readXml.getElementsByTagName("numFmt/numFmt",L.stylesFile),he=JSON.parse(JSON.stringify(L.numFmtDefault)),$e=0;$e<Z.length;$e++){var te=Z[$e].attributeList,xe=J.getXmlAttibute(te,"numFmtId","49"),Oe=J.getXmlAttibute(te,"formatCode","@");xe in L.numFmtDefault||(he[xe]=Oe)}return O.styles.numfmts=he,O}return Se.prototype.getSheetNameList=function(){var ke=this.readXml.getElementsByTagName("Relationships/Relationship",L.workbookRels);if(ke!=null){for(var ie=new RegExp("worksheets/[^/]*?.xml"),O={},Z=0;Z<ke.length;Z++){var he=ke[Z],$e=he.attributeList,te=$e.Id,xe=$e.Target;ie.test(xe)&&(xe.startsWith("/xl")?O[te]=xe.substr(1):O[te]="xl/"+xe)}this.sheetNameList=O}},Se.prototype.getSheetFileBysheetId=function(ke){return this.sheetNameList[ke]},Se.prototype.getWorkBookInfo=function(){var ke=this.readXml.getElementsByTagName("Company",L.appFile),ie=this.readXml.getElementsByTagName("AppVersion",L.appFile),O=this.readXml.getElementsByTagName("dc:creator",L.coreFile),Z=this.readXml.getElementsByTagName("cp:lastModifiedBy",L.coreFile),he=this.readXml.getElementsByTagName("dcterms:created",L.coreFile),$e=this.readXml.getElementsByTagName("dcterms:modified",L.coreFile);this.info=new X.LuckyFileInfo,this.info.name=this.fileName,this.info.creator=O.length>0?O[0].value:"",this.info.lastmodifiedby=Z.length>0?Z[0].value:"",this.info.createdTime=he.length>0?he[0].value:"",this.info.modifiedTime=$e.length>0?$e[0].value:"",this.info.company=ke.length>0?ke[0].value:"",this.info.appversion=ie.length>0?ie[0].value:""},Se.prototype.getSheetsFull=function(ke){ke===void 0&&(ke=!0);var ie=this.readXml.getElementsByTagName("sheets/sheet",L.workBookFile),O={};for(var Z in ie){var he=ie[Z];O[he.attributeList.name]=he.attributeList.sheetId}this.sheets=[];var $e=0;for(var Z in ie){var he=ie[Z],te=he.attributeList.name,xe=he.attributeList.sheetId,Oe=he.attributeList["r:id"],Je=this.getSheetFileBysheetId(Oe),ot=this.readXml.getElementsByTagName("worksheet/drawing",Je),qe=void 0,Et=void 0;if(ot!=null&&ot.length>0){var Ye=ot[0].attributeList,Be=J.getXmlAttibute(Ye,"r:id",null);Be!=null&&(qe=this.getDrawingFile(Be,Je),Et=this.getDrawingRelsFile(qe))}if(Je!=null){var Qe=new H.LuckySheet(te,xe,$e,ke,{sheetFile:Je,readXml:this.readXml,sheetList:O,styles:this.styles,sharedStrings:this.sharedStrings,calcChain:this.calcChain,imageList:this.imageList,drawingFile:qe,drawingRelsFile:Et});this.columnWidthSet=[],this.rowHeightSet=[],this.imagePositionCaculation(Qe),this.sheets.push(Qe),$e++}}},Se.prototype.extendArray=function(ke,ie,O,Z,he){if(!(ke<ie.length)){var $e=ie.length,te=ke,xe=0;$e>0&&(xe=ie[$e-1]);for(var Oe=$e;Oe<=te;Oe++){var Je=O,ot=Oe.toString();ot in Z?Je=0:ot in he&&(Je=he[ot]),xe+=Math.round(Je+1),ie.push(xe)}}},Se.prototype.imagePositionCaculation=function(ke){var ie=ke.images,O=ke.defaultColWidth,Z=ke.defaultRowHeight,he={};ke.config.colhidden&&(he=ke.config.colhidden);var $e={};ke.config.columnlen&&($e=ke.config.columnlen);var te={};ke.config.rowhidden&&(te=ke.config.rowhidden);var xe={};ke.config.rowlen&&(xe=ke.config.rowlen);for(var Oe in ie){var Je=ie[Oe],ot=Je.fromCol,qe=Je.fromColOff,Et=Je.fromRow,Ye=Je.fromRowOff,Be=Je.toCol,Qe=Je.toColOff,rt=Je.toRow,lt=Je.toRowOff,xt=0,kt=0,qt=0,Ft=0;ot>=this.columnWidthSet.length&&this.extendArray(ot,this.columnWidthSet,O,he,$e),ot==0?xt=0:xt=this.columnWidthSet[ot-1],xt=xt+qe,Et>=this.rowHeightSet.length&&this.extendArray(Et,this.rowHeightSet,Z,te,xe),Et==0?kt=0:kt=this.rowHeightSet[Et-1],kt=kt+Ye,Be>=this.columnWidthSet.length&&this.extendArray(Be,this.columnWidthSet,O,he,$e),Be==0?qt=0:qt=this.columnWidthSet[Be-1],qt=qt+Qe-xt,rt>=this.rowHeightSet.length&&this.extendArray(rt,this.rowHeightSet,Z,te,xe),rt==0?Ft=0:Ft=this.rowHeightSet[rt-1],Ft=Ft+lt-kt,console.log(O,he,$e),console.log(ot,this.columnWidthSet[ot],qe),console.log(Be,this.columnWidthSet[Be],Qe,JSON.stringify(this.columnWidthSet)),Je.originWidth=qt,Je.originHeight=Ft,Je.crop.height=Ft,Je.crop.width=qt,Je.default.height=Ft,Je.default.left=xt,Je.default.top=kt,Je.default.width=qt}console.log(this.columnWidthSet,this.rowHeightSet)},Se.prototype.getDrawingFile=function(ke,ie){var O="xl/worksheets/_rels/",Z=ie.split("/"),he=Z[Z.length-1],$e=O+he+".rels",te=this.readXml.getElementsByTagName("Relationships/Relationship",$e);if(te.length>0)for(var xe=0;xe<te.length;xe++){var Oe=te[xe],Je=Oe.attributeList,ot=J.getXmlAttibute(Je,"Id",null);if(ot==ke){var qe=J.getXmlAttibute(Je,"Target",null);if(qe!=null)return qe.replace(/\.\.\//g,"")}}return null},Se.prototype.getDrawingRelsFile=function(ke){var ie="xl/drawings/_rels/",O=ke.split("/"),Z=O[O.length-1],he=ie+Z+".rels";return he},Se.prototype.getSheetsWithoutCell=function(){this.getSheetsFull(!1)},Se.prototype.Parse=function(){return this.getWorkBookInfo(),this.getSheetsFull(),this.toJsonString(this)},Se.prototype.toJsonString=function(ke){var ie=new X.LuckyFileBase;return ie.info=ke.info,ie.sheets=[],ke.sheets.forEach(function(O){var Z=new X.LuckySheetBase;O.name!=null&&(Z.name=O.name),O.color!=null&&(Z.color=O.color),O.config!=null&&(Z.config=O.config),O.index!=null&&(Z.index=O.index),O.status!=null&&(Z.status=O.status),O.order!=null&&(Z.order=O.order),O.row!=null&&(Z.row=O.row),O.column!=null&&(Z.column=O.column),O.luckysheet_select_save!=null&&(Z.luckysheet_select_save=O.luckysheet_select_save),O.scrollLeft!=null&&(Z.scrollLeft=O.scrollLeft),O.scrollTop!=null&&(Z.scrollTop=O.scrollTop),O.zoomRatio!=null&&(Z.zoomRatio=O.zoomRatio),O.showGridLines!=null&&(Z.showGridLines=O.showGridLines),O.defaultColWidth!=null&&(Z.defaultColWidth=O.defaultColWidth),O.defaultRowHeight!=null&&(Z.defaultRowHeight=O.defaultRowHeight),O.celldata!=null&&(Z.celldata=[],O.celldata.forEach(function(he){var $e=new X.LuckySheetCelldataBase;$e.r=he.r,$e.c=he.c,$e.v=he.v,Z.celldata.push($e)})),O.chart!=null&&(Z.chart=O.chart),O.isPivotTable!=null&&(Z.isPivotTable=O.isPivotTable),O.pivotTable!=null&&(Z.pivotTable=O.pivotTable),O.luckysheet_conditionformat_save!=null&&(Z.luckysheet_conditionformat_save=O.luckysheet_conditionformat_save),O.freezen!=null&&(Z.freezen=O.freezen),O.calcChain!=null&&(Z.calcChain=O.calcChain),O.images!=null&&(Z.images=O.images),ie.sheets.push(Z)}),JSON.stringify(ie)},Se}(X.LuckyFileBase);K.LuckyFile=ge},{"../common/constant":91,"../common/method":93,"./LuckyBase":85,"./LuckyImage":88,"./LuckySheet":89,"./ReadXml":90}],88:[function(Fe,Ct,K){var we=function(){var X=function(ge,fe){return X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Se,ke){Se.__proto__=ke}||function(Se,ke){for(var ie in ke)ke.hasOwnProperty(ie)&&(Se[ie]=ke[ie])},X(ge,fe)};return function(Y,ge){X(Y,ge);function fe(){this.constructor=Y}Y.prototype=ge===null?Object.create(ge):(fe.prototype=ge.prototype,new fe)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.ImageList=void 0;var H=Fe("./LuckyBase"),L=Fe("../common/emf"),G=function(){function X(Y){if(Y!=null){this.images={};for(var ge in Y)if(ge.indexOf("xl/media/")>-1){var fe=ge.split("."),Se=fe[fe.length-1].toLowerCase();if(Se in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1,emf:1})if(Se=="emf"){var ke=0,ie=1,O=new L.ToContext2D(ke,ie),Z,he,$e;L.FromEMF.K=[],Z=L.FromEMF.C,he=L.FromEMF.K,$e=4;for(var te in Z)he[Z[te]]=te.slice($e);L.FromEMF.Parse(Y[ge],O),this.images[ge]=O.canvas.toDataURL("image/png")}else this.images[ge]=Y[ge]}}}return X.prototype.getImageByName=function(Y){if(Y in this.images){var ge=this.images[Y];return new J(Y,ge)}return null},X}();K.ImageList=G;var J=function(X){we(Y,X);function Y(ge,fe){var Se=X.call(this)||this;return Se.src=fe,Se}return Y.prototype.setDefault=function(){},Y}(H.LuckyImageBase)},{"../common/emf":92,"./LuckyBase":85}],89:[function(Fe,Ct,K){var we=function(){var Y=function(fe,Se){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ke,ie){ke.__proto__=ie}||function(ke,ie){for(var O in ie)ie.hasOwnProperty(O)&&(ke[O]=ie[O])},Y(fe,Se)};return function(ge,fe){Y(ge,fe);function Se(){this.constructor=ge}ge.prototype=fe===null?Object.create(fe):(Se.prototype=fe.prototype,new Se)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.LuckySheet=void 0;var H=Fe("./LuckyCell"),L=Fe("../common/method"),G=Fe("./ReadXml"),J=Fe("./LuckyBase"),X=function(Y){we(ge,Y);function ge(fe,Se,ke,ie,O){ie===void 0&&(ie=!1);var Z=Y.call(this)||this;Z.isInitialCell=ie,Z.readXml=O.readXml,Z.sheetFile=O.sheetFile,Z.styles=O.styles,Z.sharedStrings=O.sharedStrings,Z.calcChainEles=O.calcChain,Z.sheetList=O.sheetList,Z.imageList=O.imageList,Z.name=fe,Z.index=Se,Z.order=ke.toString(),Z.config=new J.LuckyConfig,Z.celldata=[],Z.mergeCells=Z.readXml.getElementsByTagName("mergeCells/mergeCell",Z.sheetFile),Z.styles.clrScheme;var he=Z.readXml.getElementsByTagName("sheetViews/sheetView",Z.sheetFile),$e="1",te="0",xe="100",Oe="A1";if(he.length>0){var Je=he[0].attributeList;$e=L.getXmlAttibute(Je,"showGridLines","1"),te=L.getXmlAttibute(Je,"tabSelected","0"),xe=L.getXmlAttibute(Je,"zoomScale","100");var ot=he[0].getInnerElements("selection");if(ot!=null&&ot.length>0){Oe=L.getXmlAttibute(ot[0].attributeList,"activeCell","A1");var qe=L.getcellrange(Oe,Z.sheetList,Se);Z.luckysheet_select_save=[],Z.luckysheet_select_save.push(qe)}}Z.showGridLines=$e,Z.status=te,Z.zoomRatio=parseInt(xe)/100;var Et=Z.readXml.getElementsByTagName("sheetPr/tabColor",Z.sheetFile);if(Et!=null&&Et.length>0){var Ye=Et[0],Je=Ye.attributeList,Be=G.getColor(Ye,Z.styles,"b");Z.color=Be}var Qe=Z.readXml.getElementsByTagName("sheetFormatPr",Z.sheetFile),rt,lt;if(Qe.length>0){var Je=Qe[0].attributeList;rt=L.getXmlAttibute(Je,"defaultColWidth","9.21"),lt=L.getXmlAttibute(Je,"defaultRowHeight","19")}Z.defaultColWidth=L.getColumnWidthPixel(parseFloat(rt)),Z.defaultRowHeight=L.getRowHeightPixel(parseFloat(lt)),Z.generateConfigColumnLenAndHidden();var xt=Z.generateConfigRowLenAndHiddenAddCell();if(Z.formulaRefList!=null)for(var kt in Z.formulaRefList){var qt=Z.formulaRefList[kt],Ft=qt.mainRef,gr=Ft.cellValue,Yt=Ft.fv,Sr=gr.r,zr=gr.c;for(var ht in qt)if(ht!="mainRef"){var ft=qt[ht],Ht=ft.cellValue;if(Ht!=null){var hr=Ht.r,Br=Ht.c,Vr=Yt,ma=hr-Sr,ca=Br-zr;ma>0?Vr="="+L.fromulaRef.functionCopy(Vr,"down",ma):ma<0&&(Vr="="+L.fromulaRef.functionCopy(Vr,"up",Math.abs(ma))),ca>0?Vr="="+L.fromulaRef.functionCopy(Vr,"right",ca):ca<0&&(Vr="="+L.fromulaRef.functionCopy(Vr,"left",Math.abs(ca))),Ht.v.f=Vr}}}Z.calcChain==null&&(Z.calcChain=[]);for(var ua={},Br=0;Br<Z.calcChainEles.length;Br++){var Ge=Z.calcChainEles[Br],Je=Ge.attributeList;if(Je.i==Se){var hr=Je.r,Ke=Je.i;Je.l,Je.s,Je.a,Je.t;var qe=L.getcellrange(hr),zt=new J.LuckysheetCalcChain;zt.r=qe.row[0],zt.c=qe.column[0],zt.index=Z.index,Z.calcChain.push(zt),ua["r"+hr+"c"+Br]=null}}for(var kt in xt.formulaList)if(!(kt in ua)){var Vt=xt.formulaList[kt],zt=new J.LuckysheetCalcChain;zt.r=Vt.r,zt.c=Vt.c,zt.index=Z.index,Z.calcChain.push(zt)}if(Z.mergeCells!=null)for(var Ke=0;Ke<Z.mergeCells.length;Ke++){var $r=Z.mergeCells[Ke],Je=$r.attributeList,Qr=Je.ref;if(Qr!=null){var qe=L.getcellrange(Qr,Z.sheetList,Se),Me=new J.LuckySheetConfigMerge;Me.r=qe.row[0],Me.c=qe.column[0],Me.rs=qe.row[1]-qe.row[0]+1,Me.cs=qe.column[1]-qe.column[0]+1,Z.config.merge==null&&(Z.config.merge={}),Z.config.merge[qe.row[0]+"_"+qe.column[0]]=Me}}var oe=O.drawingFile,se=O.drawingRelsFile;if(oe!=null&&se!=null){var Le=Z.readXml.getElementsByTagName("xdr:twoCellAnchor",oe);if(Le!=null&&Le.length>0)for(var Ke=0;Ke<Le.length;Ke++){var ut=Le[Ke],sr=L.getXmlAttibute(ut.attributeList,"editAs","twoCell"),Zt=ut.getInnerElements("xdr:from"),sa=ut.getInnerElements("xdr:to"),da=ut.getInnerElements("a:blip");if(Zt!=null&&da!=null&&Zt.length>0&&da.length>0){var Ur=Zt[0],Sa=sa[0],ha=da[0],An=L.getXmlAttibute(ha.attributeList,"r:embed",null),Ta=Z.getBase64ByRid(An,se),Va=0,In=0,Pe=0,cr=0;Ta.fromCol=Z.getXdrValue(Ur.getInnerElements("xdr:col")),Ta.fromColOff=L.getPxByEMUs(Z.getXdrValue(Ur.getInnerElements("xdr:colOff"))),Ta.fromRow=Z.getXdrValue(Ur.getInnerElements("xdr:row")),Ta.fromRowOff=L.getPxByEMUs(Z.getXdrValue(Ur.getInnerElements("xdr:rowOff"))),Ta.toCol=Z.getXdrValue(Sa.getInnerElements("xdr:col")),Ta.toColOff=L.getPxByEMUs(Z.getXdrValue(Sa.getInnerElements("xdr:colOff"))),Ta.toRow=Z.getXdrValue(Sa.getInnerElements("xdr:row")),Ta.toRowOff=L.getPxByEMUs(Z.getXdrValue(Sa.getInnerElements("xdr:rowOff"))),Ta.originWidth=Pe,Ta.originHeight=cr,sr=="absolute"?Ta.type="3":sr=="oneCell"?Ta.type="2":Ta.type="1",Ta.isFixedPos=!1,Ta.fixedLeft=0,Ta.fixedTop=0;var wr={color:"#000",radius:0,style:"solid",width:0};Ta.border=wr;var Gr={height:cr,offsetLeft:0,offsetTop:0,width:Pe};Ta.crop=Gr;var yt={height:cr,left:Va,top:In,width:Pe};Ta.default=yt,Z.images==null&&(Z.images={}),Z.images[L.generateRandomIndex("image")]=Ta}}}return Z}return ge.prototype.getXdrValue=function(fe){return fe==null||fe.length==0?null:parseInt(fe[0].value)},ge.prototype.getBase64ByRid=function(fe,Se){var ke=this.readXml.getElementsByTagName("Relationships/Relationship",Se);if(ke!=null&&ke.length>0)for(var ie=0;ie<ke.length;ie++){var O=ke[ie],Z=O.attributeList,he=L.getXmlAttibute(Z,"Id",null),$e=L.getXmlAttibute(Z,"Target",null);if(he==fe){$e=$e.replace(/\.\.\//g,""),$e="xl/"+$e;var te=this.imageList.getImageByName($e);return te}}return null},ge.prototype.generateConfigColumnLenAndHidden=function(){for(var fe=this.readXml.getElementsByTagName("cols/col",this.sheetFile),Se=0;Se<fe.length;Se++){var ke=fe[Se],ie=ke.attributeList,O=L.getXmlAttibute(ie,"min",null),Z=L.getXmlAttibute(ie,"max",null),he=L.getXmlAttibute(ie,"width",null),$e=L.getXmlAttibute(ie,"hidden",null),te=L.getXmlAttibute(ie,"customWidth",null);if(!(O==null||Z==null))for(var xe=parseInt(O)-1,Oe=parseInt(Z)-1,Je=parseFloat(he),ot=xe;ot<=Oe;ot++)he!=null&&(this.config.columnlen==null&&(this.config.columnlen={}),this.config.columnlen[ot]=L.getColumnWidthPixel(Je)),$e=="1"&&(this.config.colhidden==null&&(this.config.colhidden={}),this.config.colhidden[ot]=0,this.config.columnlen&&delete this.config.columnlen[ot]),te!=null&&(this.config.customWidth==null&&(this.config.customWidth={}),this.config.customWidth[ot]=1)}},ge.prototype.generateConfigRowLenAndHiddenAddCell=function(){var fe=this.readXml.getElementsByTagName("sheetData/row",this.sheetFile),Se={},ke={};Se.formulaList=ke;for(var ie=0;ie<fe.length;ie++){var O=fe[ie],Z=O.attributeList,he=L.getXmlAttibute(Z,"r",null),$e=L.getXmlAttibute(Z,"ht",null),te=L.getXmlAttibute(Z,"hidden",null),xe=L.getXmlAttibute(Z,"customHeight",null);if(he!=null){var Oe=parseInt(he)-1;if($e!=null){var Je=parseFloat($e);this.config.rowlen==null&&(this.config.rowlen={}),this.config.rowlen[Oe]=L.getRowHeightPixel(Je)}if(te=="1"&&(this.config.rowhidden==null&&(this.config.rowhidden={}),this.config.rowhidden[Oe]=0,this.config.rowlen&&delete this.config.rowlen[Oe]),xe!=null&&(this.config.customHeight==null&&(this.config.customHeight={}),this.config.customHeight[Oe]=1),this.isInitialCell){var ot=O.getInnerElements("c");for(var qe in ot){var Et=ot[qe],Ye=new H.LuckySheetCelldata(Et,this.styles,this.sharedStrings,this.mergeCells,this.sheetFile,this.readXml);if(Ye._borderObject!=null&&(this.config.borderInfo==null&&(this.config.borderInfo=[]),this.config.borderInfo.push(Ye._borderObject),delete Ye._borderObject),Ye._formulaType=="shared"){this.formulaRefList==null&&(this.formulaRefList={}),this.formulaRefList[Ye._formulaSi]==null&&(this.formulaRefList[Ye._formulaSi]={});var Be=void 0;Ye.v!=null&&(Be=Ye.v.f);var Qe={t:Ye._formulaType,ref:Ye._fomulaRef,si:Ye._formulaSi,fv:Be,cellValue:Ye};Ye._fomulaRef!=null?this.formulaRefList[Ye._formulaSi].mainRef=Qe:this.formulaRefList[Ye._formulaSi][Ye.r+"_"+Ye.c]=Qe}if(Ye.v!=null&&Ye.v.f!=null){var rt={r:Ye.r,c:Ye.c};Se.formulaList["r"+Ye.r+"c"+Ye.c]=rt}this.celldata.push(Ye)}}}}return Se},ge}(J.LuckySheetBase);K.LuckySheet=X},{"../common/method":93,"./LuckyBase":85,"./LuckyCell":86,"./ReadXml":90}],90:[function(Fe,Ct,K){var we=function(){var Se=function(ie,O){return Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Z,he){Z.__proto__=he}||function(Z,he){for(var $e in he)he.hasOwnProperty($e)&&(Z[$e]=he[$e])},Se(ie,O)};return function(ke,ie){Se(ke,ie);function O(){this.constructor=ke}ke.prototype=ie===null?Object.create(ie):(O.prototype=ie.prototype,new O)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.getlineStringAttr=K.getColor=K.Element=K.ReadXml=void 0;var H=Fe("../common/constant"),L=Fe("../common/method"),G=function(){function Se(){}return Se.prototype.getElementsByOneTag=function(ke,ie){var O;if(ke.indexOf("|")>-1){for(var Z=ke.split("|"),he="",$e=0;$e<Z.length;$e++){var te=Z[$e];he+="|<"+te+" [^>]+?[^/]>[\\s\\S]*?</"+te+">|<"+te+" [^>]+?/>|<"+te+">[\\s\\S]*?</"+te+">|<"+te+"/>"}he=he.substr(1,he.length),O=new RegExp(he,"g")}else O=new RegExp("<"+ke+" [^>]+?[^/]>[\\s\\S]*?</"+ke+">|<"+ke+" [^>]+?/>|<"+ke+">[\\s\\S]*?</"+ke+">|<"+ke+"/>","g");var xe=ie.match(O);return xe??[]},Se}(),J=function(Se){we(ke,Se);function ke(ie){var O=Se.call(this)||this;return O.originFile=ie,O}return ke.prototype.getElementsByTagName=function(ie,O){var Z=this.getFileByName(O),he=ie.split("/"),$e;for(var te in he){var xe=he[te];if($e==null)$e=this.getElementsByOneTag(xe,Z);else if($e instanceof Array){var Oe=[];for(var Je in $e){var ot=$e[Je];Oe=Oe.concat(this.getElementsByOneTag(xe,ot))}$e=Oe}else $e=this.getElementsByOneTag(xe,$e)}for(var qe=[],Et=0;Et<$e.length;Et++){var Ye=new X($e[Et]);qe.push(Ye)}return qe},ke.prototype.getFileByName=function(ie){for(var O in this.originFile)if(O.indexOf(ie)>-1)return this.originFile[O];return""},ke}(G);K.ReadXml=J;var X=function(Se){we(ke,Se);function ke(ie){var O=Se.call(this)||this;O.elementString=ie,O.setValue();var Z=new RegExp('[a-zA-Z0-9_:]*?=".*?"',"g"),he=O.container.match(Z);if(O.attributeList={},he!=null)for(var $e in he){var te=he[$e];if(te.length!=0){var xe=te.substr(0,te.indexOf("=")),Oe=te.substr(te.indexOf("=")+1);xe==null||Oe==null||xe.length==0||Oe.length==0||(O.attributeList[xe]=Oe.substr(1,Oe.length-2))}}return O}return ke.prototype.get=function(ie){return this.attributeList[ie]},ke.prototype.getInnerElements=function(ie){for(var O=this.getElementsByOneTag(ie,this.elementString),Z=[],he=0;he<O.length;he++){var $e=new ke(O[he]);Z.push($e)}return Z.length==0?null:Z},ke.prototype.setValue=function(){var ie=this.elementString;if(ie.substr(ie.length-2,2)=="/>")this.value="",this.container=ie;else{var O=this.getFirstTag(),Z=new RegExp("(<"+O+" [^>]+?[^/]>)([\\s\\S]*?)</"+O+">|(<"+O+">)([\\s\\S]*?)</"+O+">","g"),he=Z.exec(ie);he!=null&&(he[1]!=null?(this.container=he[1],this.value=he[2]):(this.container=he[3],this.value=he[4]))}},ke.prototype.getFirstTag=function(){var ie=this.elementString,O=ie.substr(0,ie.indexOf(" "));return(O==""||O.indexOf(">")>-1)&&(O=ie.substr(0,ie.indexOf(">"))),O=O.substr(1,O.length),O},ke}(G);K.Element=X;function Y(Se,ke){var ie={};if(Se==null||Se.length==0)return ke;for(var O in ke){var Z=ke[O],he=parseInt(O),$e=Se[he];if($e==null)ie[O]=Z;else{var te=$e.attributeList.rgb;ie[O]=te}}return ie}function ge(Se,ke,ie){var O=Se.attributeList,Z=ke.clrScheme,he=ke.indexedColors;ke.mruColors;var $e=Y(he,H.indexedColors),te=O.indexed,xe=O.rgb,Oe=O.theme,Je=O.tint,ot;if(te!=null){var qe=parseInt(te);ot=$e[qe],ot!=null&&(ot=ot.substring(ot.length-6,ot.length),ot="#"+ot)}else if(xe!=null)xe=xe.substring(xe.length-6,xe.length),ot="#"+xe;else if(Oe!=null){var Et=parseInt(Oe);Et==0?Et=1:Et==1?Et=0:Et==2?Et=3:Et==3&&(Et=2);var Ye=Z[Et];if(Ye!=null){var Be=Ye.getInnerElements("a:sysClr|a:srgbClr");if(Be!=null){var Qe=Be[0],rt=Qe.attributeList;Qe.container.indexOf("sysClr")>-1?rt.lastClr!=null?ot="#"+rt.lastClr:rt.val!=null&&(ot="#"+rt.val):Qe.container.indexOf("srgbClr")>-1&&(ot="#"+rt.val)}}}if(Je!=null){var lt=parseFloat(Je);ot!=null&&(ot=L.LightenDarkenColor(ot,lt))}return ot}K.getColor=ge;function fe(Se,ke){var ie=Se.getInnerElements(ke),O;if(ie!=null&&ie.length>0)if(ke=="b"||ke=="i"||ke=="strike")O="1";else if(ke=="u"){var Z=ie[0].attributeList.val;Z=="double"?O="2":Z=="singleAccounting"?O="3":Z=="doubleAccounting"?O="4":O="1"}else if(ke=="vertAlign"){var Z=ie[0].attributeList.val;Z=="subscript"?O="1":Z=="superscript"&&(O="2")}else O=ie[0].attributeList.val;return O}K.getlineStringAttr=fe},{"../common/constant":91,"../common/method":93}],91:[function(Fe,Ct,K){Object.defineProperty(K,"__esModule",{value:!0}),K.fontFamilys=K.borderTypes=K.OEM_CHARSET=K.indexedColors=K.numFmtDefault=K.BuiltInCellStyles=K.ST_CellType=K.workbookRels=K.theme1File=K.worksheetFilePath=K.sharedStringsFile=K.stylesFile=K.calcChainFile=K.workBookFile=K.contentTypesFile=K.appFile=K.coreFile=K.columeHeader_word_index=K.columeHeader_word=void 0,K.columeHeader_word=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],K.columeHeader_word_index={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},K.coreFile="docProps/core.xml",K.appFile="docProps/app.xml",K.contentTypesFile="[Content_Types].xml",K.workBookFile="xl/workbook.xml",K.calcChainFile="xl/calcChain.xml",K.stylesFile="xl/styles.xml",K.sharedStringsFile="xl/sharedStrings.xml",K.worksheetFilePath="xl/worksheets/",K.theme1File="xl/theme/theme1.xml",K.workbookRels="xl/_rels/workbook.xml.rels",K.ST_CellType={Boolean:"b",Date:"d",Error:"e",InlineString:"inlineStr",Number:"n",SharedString:"s",String:"str"},K.BuiltInCellStyles={0:"Normal"},K.numFmtDefault={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"},K.indexedColors={0:"00000000",1:"00FFFFFF",2:"00FF0000",3:"0000FF00",4:"000000FF",5:"00FFFF00",6:"00FF00FF",7:"0000FFFF",8:"00000000",9:"00FFFFFF",10:"00FF0000",11:"0000FF00",12:"000000FF",13:"00FFFF00",14:"00FF00FF",15:"0000FFFF",16:"00800000",17:"00008000",18:"00000080",19:"00808000",20:"00800080",21:"00008080",22:"00C0C0C0",23:"00808080",24:"009999FF",25:"00993366",26:"00FFFFCC",27:"00CCFFFF",28:"00660066",29:"00FF8080",30:"000066CC",31:"00CCCCFF",32:"00000080",33:"00FF00FF",34:"00FFFF00",35:"0000FFFF",36:"00800080",37:"00800000",38:"00008080",39:"000000FF",40:"0000CCFF",41:"00CCFFFF",42:"00CCFFCC",43:"00FFFF99",44:"0099CCFF",45:"00FF99CC",46:"00CC99FF",47:"00FFCC99",48:"003366FF",49:"0033CCCC",50:"0099CC00",51:"00FFCC00",52:"00FF9900",53:"00FF6600",54:"00666699",55:"00969696",56:"00003366",57:"00339966",58:"00003300",59:"00333300",60:"00993300",61:"00993366",62:"00333399",63:"00333333",64:null,65:null},K.OEM_CHARSET={0:"ANSI_CHARSET",1:"DEFAULT_CHARSET",2:"SYMBOL_CHARSET",77:"MAC_CHARSET",128:"SHIFTJIS_CHARSET",129:"HANGUL_CHARSET",130:"JOHAB_CHARSET",134:"GB2312_CHARSET",136:"CHINESEBIG5_CHARSET",161:"GREEK_CHARSET",162:"TURKISH_CHARSET",163:"VIETNAMESE_CHARSET",177:"HEBREW_CHARSET",178:"ARABIC_CHARSET",186:"BALTIC_CHARSET",204:"RUSSIAN_CHARSET",222:"THAI_CHARSET",238:"EASTEUROPE_CHARSET",255:"OEM_CHARSET"},K.borderTypes={none:0,thin:1,hair:2,dotted:3,dashed:4,dashDot:5,dashDotDot:6,double:7,medium:8,mediumDashed:9,mediumDashDot:10,mediumDashDotDot:11,slantDashDot:12,thick:13},K.fontFamilys={0:"defualt",1:"Roman",2:"Swiss",3:"Modern",4:"Script",5:"Decorative"}},{}],92:[function(Fe,Ct,K){Object.defineProperty(K,"__esModule",{value:!0}),K.ToContext2D=K.FromEMF=K.UDOC=void 0,K.UDOC={},K.UDOC.G={concat:function(L,G){for(var J=0;J<G.cmds.length;J++)L.cmds.push(G.cmds[J]);for(var J=0;J<G.crds.length;J++)L.crds.push(G.crds[J])},getBB:function(L){for(var G=1e99,J=1e99,X=-G,Y=-J,ge=0;ge<L.length;ge+=2){var fe=L[ge],Se=L[ge+1];fe<G?G=fe:fe>X&&(X=fe),Se<J?J=Se:Se>Y&&(Y=Se)}return[G,J,X,Y]},rectToPath:function(L){return{cmds:["M","L","L","L","Z"],crds:[L[0],L[1],L[2],L[1],L[2],L[3],L[0],L[3]]}},insideBox:function(L,G){return G[0]<=L[0]&&G[1]<=L[1]&&L[2]<=G[2]&&L[3]<=G[3]},isBox:function(L,G){var J=function(Z,he){for(var $e=0;$e<8;$e+=2){for(var te=!0,xe=0;xe<8;xe++)if(Math.abs(he[xe]-Z[xe+$e&7])>=2){te=!1;break}if(te)return!0}return!1};if(L.cmds.length>10)return!1;var X=L.cmds.join(""),Y=L.crds,ge=!1;if(X=="MLLLZ"&&Y.length==8||X=="MLLLLZ"&&Y.length==10){Y.length==10&&(Y=Y.slice(0,8));var fe=G[0],Se=G[1],ke=G[2],ie=G[3];ge||(ge=J(Y,[fe,Se,ke,Se,ke,ie,fe,ie])),ge||(ge=J(Y,[fe,ie,ke,ie,ke,Se,fe,Se]))}return ge},boxArea:function(L){var G=L[2]-L[0],J=L[3]-L[1];return G*J},newPath:function(L){L.pth={cmds:[],crds:[]}},moveTo:function(L,G,J){var X=K.UDOC.M.multPoint(L.ctm,[G,J]);L.pth.cmds.push("M"),L.pth.crds.push(X[0],X[1]),L.cpos=X},lineTo:function(L,G,J){var X=K.UDOC.M.multPoint(L.ctm,[G,J]);L.cpos[0]==X[0]&&L.cpos[1]==X[1]||(L.pth.cmds.push("L"),L.pth.crds.push(X[0],X[1]),L.cpos=X)},curveTo:function(L,G,J,X,Y,ge,fe){var Se;Se=K.UDOC.M.multPoint(L.ctm,[G,J]),G=Se[0],J=Se[1],Se=K.UDOC.M.multPoint(L.ctm,[X,Y]),X=Se[0],Y=Se[1],Se=K.UDOC.M.multPoint(L.ctm,[ge,fe]),ge=Se[0],fe=Se[1],L.cpos=Se,L.pth.cmds.push("C"),L.pth.crds.push(G,J,X,Y,ge,fe)},closePath:function(L){L.pth.cmds.push("Z")},arc:function(L,G,Qe,X,Y,ge,fe){if(fe)for(;ge>Y;)ge-=2*Math.PI;else for(;ge<Y;)ge+=2*Math.PI;var Se=(ge-Y)/4,ke=Math.cos(Se/2),ie=-Math.sin(Se/2),O=(4-ke)/3,Z=ie==0?ie:(1-ke)*(3-ke)/(3*ie),he=O,$e=-Z,te=ke,xe=-ie,Oe=[O,Z],Je=[he,$e],ot=[te,xe],qe={cmds:[L.pth.cmds.length==0?"M":"L","C","C","C","C"],crds:[ke,ie,O,Z,he,$e,te,xe]},Et=[1,0,0,1,0,0];K.UDOC.M.rotate(Et,-Se);for(var Ye=0;Ye<3;Ye++)Oe=K.UDOC.M.multPoint(Et,Oe),Je=K.UDOC.M.multPoint(Et,Je),ot=K.UDOC.M.multPoint(Et,ot),qe.crds.push(Oe[0],Oe[1],Je[0],Je[1],ot[0],ot[1]);var Be=[X,0,0,X,G,Qe];K.UDOC.M.rotate(Et,-Y+Se/2),K.UDOC.M.concat(Et,Be),K.UDOC.M.multArray(Et,qe.crds),K.UDOC.M.multArray(L.ctm,qe.crds),K.UDOC.G.concat(L.pth,qe);var Qe=qe.crds.pop();G=qe.crds.pop(),L.cpos=[G,Qe]},toPoly:function(L){if(L.cmds[0]!="M"||L.cmds[L.cmds.length-1]!="Z")return null;for(var G=1;G<L.cmds.length-1;G++)if(L.cmds[G]!="L")return null;var J=[],X=L.crds.length;L.crds[0]==L.crds[X-2]&&L.crds[1]==L.crds[X-1]&&(X-=2);for(var G=0;G<X;G+=2)J.push([L.crds[G],L.crds[G+1]]);return K.UDOC.G.polyArea(L.crds)<0&&J.reverse(),J},fromPoly:function(L){for(var G={cmds:[],crds:[]},J=0;J<L.length;J++)G.crds.push(L[J][0],L[J][1]),G.cmds.push(J==0?"M":"L");return G.cmds.push("Z"),G},polyArea:function(L){if(L.length<6)return 0;for(var G=L.length-2,J=(L[0]-L[G])*(L[G+1]+L[1]),X=0;X<G;X+=2)J+=(L[X+2]-L[X])*(L[X+1]+L[X+3]);return-J*.5},polyClip:function(L,G){var J,X,Y,ge,fe=function($e){return(X[0]-J[0])*($e[1]-J[1])>(X[1]-J[1])*($e[0]-J[0])},Se=function(){var $e=[J[0]-X[0],J[1]-X[1]],te=[Y[0]-ge[0],Y[1]-ge[1]],xe=J[0]*X[1]-J[1]*X[0],Oe=Y[0]*ge[1]-Y[1]*ge[0],Je=1/($e[0]*te[1]-$e[1]*te[0]);return[(xe*te[0]-Oe*$e[0])*Je,(xe*te[1]-Oe*$e[1])*Je]},ke=L;J=G[G.length-1];for(var ie in G){var X=G[ie],O=ke;ke=[],Y=O[O.length-1];for(var Z in O){var ge=O[Z];fe(ge)?(fe(Y)||ke.push(Se()),ke.push(ge)):fe(Y)&&ke.push(Se()),Y=ge}J=X}return ke}},K.UDOC.M={getScale:function(L){return Math.sqrt(Math.abs(L[0]*L[3]-L[1]*L[2]))},translate:function(L,G,J){K.UDOC.M.concat(L,[1,0,0,1,G,J])},rotate:function(L,G){K.UDOC.M.concat(L,[Math.cos(G),-Math.sin(G),Math.sin(G),Math.cos(G),0,0])},scale:function(L,G,J){K.UDOC.M.concat(L,[G,0,0,J,0,0])},concat:function(L,G){var J=L[0],X=L[1],Y=L[2],ge=L[3],fe=L[4],Se=L[5];L[0]=J*G[0]+X*G[2],L[1]=J*G[1]+X*G[3],L[2]=Y*G[0]+ge*G[2],L[3]=Y*G[1]+ge*G[3],L[4]=fe*G[0]+Se*G[2]+G[4],L[5]=fe*G[1]+Se*G[3]+G[5]},invert:function(L){var G=L[0],J=L[1],X=L[2],Y=L[3],ge=L[4],fe=L[5],Se=G*Y-J*X;L[0]=Y/Se,L[1]=-J/Se,L[2]=-X/Se,L[3]=G/Se,L[4]=(X*fe-Y*ge)/Se,L[5]=(J*ge-G*fe)/Se},multPoint:function(L,G){var J=G[0],X=G[1];return[J*L[0]+X*L[2]+L[4],J*L[1]+X*L[3]+L[5]]},multArray:function(L,G){for(var J=0;J<G.length;J+=2){var X=G[J],Y=G[J+1];G[J]=X*L[0]+Y*L[2]+L[4],G[J+1]=X*L[1]+Y*L[3]+L[5]}}},K.UDOC.C={srgbGamma:function(L){return L<.0031308?12.92*L:1.055*Math.pow(L,1/2.4)-.055},cmykToRgb:function(L){var G=L[0],J=L[1],X=L[2],Y=L[3],ge=255+G*(-4.387332384609988*G+54.48615194189176*J+18.82290502165302*X+212.25662451639585*Y+-285.2331026137004)+J*(1.7149763477362134*J-5.6096736904047315*X+-17.873870861415444*Y-5.497006427196366)+X*(-2.5217340131683033*X-21.248923337353073*Y+17.5119270841813)+Y*(-21.86122147463605*Y-189.48180835922747),fe=255+G*(8.841041422036149*G+60.118027045597366*J+6.871425592049007*X+31.159100130055922*Y+-79.2970844816548)+J*(-15.310361306967817*J+17.575251261109482*X+131.35250912493976*Y-190.9453302588951)+X*(4.444339102852739*X+9.8632861493405*Y-24.86741582555878)+Y*(-20.737325471181034*Y-187.80453709719578),Se=255+G*(.8842522430003296*G+8.078677503112928*J+30.89978309703729*X-.23883238689178934*Y+-14.183576799673286)+J*(10.49593273432072*J+63.02378494754052*X+50.606957656360734*Y-112.23884253719248)+X*(.03296041114873217*X+115.60384449646641*Y+-193.58209356861505)+Y*(-22.33816807309886*Y-180.12613974708367);return[Math.max(0,Math.min(1,ge/255)),Math.max(0,Math.min(1,fe/255)),Math.max(0,Math.min(1,Se/255))]},labToRgb:function(L){for(var G=903.3,J=.008856,X=L[0],Y=L[1],ge=L[2],fe=(X+16)/116,Se=fe*fe*fe,ke=fe-ge/200,ie=ke*ke*ke,O=Y/500+fe,Z=O*O*O,he=ie>J?ie:(116*ke-16)/G,$e=Se>J?Se:(116*fe-16)/G,te=Z>J?Z:(116*O-16)/G,xe=te*96.72,Oe=$e*100,Je=he*81.427,ot=[xe/100,Oe/100,Je/100],qe=[3.1338561,-1.6168667,-.4906146,-.9787684,1.9161415,.033454,.0719453,-.2289914,1.4052427],Et=[qe[0]*ot[0]+qe[1]*ot[1]+qe[2]*ot[2],qe[3]*ot[0]+qe[4]*ot[1]+qe[5]*ot[2],qe[6]*ot[0]+qe[7]*ot[1]+qe[8]*ot[2]],Ye=0;Ye<3;Ye++)Et[Ye]=Math.max(0,Math.min(1,K.UDOC.C.srgbGamma(Et[Ye])));return Et}},K.UDOC.getState=function(H){return{font:K.UDOC.getFont(),dd:{flat:1},space:"/DeviceGray",ca:1,colr:[0,0,0],sspace:"/DeviceGray",CA:1,COLR:[0,0,0],bmode:"/Normal",SA:!1,OPM:0,AIS:!1,OP:!1,op:!1,SMask:"/None",lwidth:1,lcap:0,ljoin:0,mlimit:10,SM:.1,doff:0,dash:[],ctm:[1,0,0,1,0,0],cpos:[0,0],pth:{cmds:[],crds:[]},cpth:H?K.UDOC.G.rectToPath(H):null}},K.UDOC.getFont=function(){return{Tc:0,Tw:0,Th:100,Tl:0,Tf:"Helvetica-Bold",Tfs:1,Tmode:0,Trise:0,Tk:0,Tal:0,Tun:0,Tm:[1,0,0,1,0,0],Tlm:[1,0,0,1,0,0],Trm:[1,0,0,1,0,0]}},K.FromEMF=function(){},K.FromEMF.Parse=function(H,L){H=new Uint8Array(H);for(var G=0,J={fill:!1,strk:!1,bb:[0,0,1,1],wbb:[0,0,1,1],fnt:{nam:"Arial",hgh:25,und:!1,orn:0},tclr:[0,0,0],talg:0},X,Y=[],ge=[],fe=K.FromEMF.B.readShort,Se=K.FromEMF.B.readUshort,ke=K.FromEMF.B.readInt,ie=K.FromEMF.B.readUint,O=K.FromEMF.B.readFloat;;){var Z=ie(H,G);G+=4;var he=K.FromEMF.K[Z],$e=ie(H,G);G+=4;var te=G,xe=null,Oe=0;if(he=="EOF")break;if(he=="HEADER")J.bb=K.FromEMF._readBox(H,te),te+=16,L.StartPage(J.bb[0],J.bb[1],J.bb[2],J.bb[3]),X=K.UDOC.getState(J.bb);else if(he=="SAVEDC")ge.push(JSON.stringify(X),JSON.stringify(J));else if(he=="RESTOREDC"){var Je=ke(H,te);for(te+=4;Je<-1;)ge.pop(),ge.pop();J=JSON.parse(ge.pop()),X=JSON.parse(ge.pop())}else if(he=="SELECTCLIPPATH")X.cpth=JSON.parse(JSON.stringify(X.pth));else if(["SETMAPMODE","SETPOLYFILLMODE","SETBKMODE","SETICMMODE","SETROP2","EXTSELECTCLIPRGN"].indexOf(he)==-1){if(he=="SETMITERLIMIT")X.mlimit=ie(H,te);else if(he=="SETTEXTCOLOR")J.tclr=[H[te]/255,H[te+1]/255,H[te+2]/255];else if(he=="SETTEXTALIGN")J.talg=ie(H,te);else if(he=="SETVIEWPORTEXTEX"||he=="SETVIEWPORTORGEX"){J.vbb==null&&(J.vbb=[]);var ot=he=="SETVIEWPORTORGEX"?0:2;J.vbb[ot]=ke(H,te),te+=4,J.vbb[ot+1]=ke(H,te),te+=4,he=="SETVIEWPORTEXTEX"&&K.FromEMF._updateCtm(J,X)}else if(he=="SETWINDOWEXTEX"||he=="SETWINDOWORGEX"){var ot=he=="SETWINDOWORGEX"?0:2;J.wbb[ot]=ke(H,te),te+=4,J.wbb[ot+1]=ke(H,te),te+=4,he=="SETWINDOWEXTEX"&&K.FromEMF._updateCtm(J,X)}else if(he=="COMMENT")ie(H,te),te+=4;else if(he=="SELECTOBJECT"){var qe=ie(H,te);if(te+=4,qe==2147483648)J.fill=!0,X.colr=[1,1,1];else if(qe==2147483653)J.fill=!1;else if(qe==2147483655)J.strk=!0,J.lwidth=1,X.COLR=[0,0,0];else if(qe==2147483656)J.strk=!1;else if(qe!=2147483661){if(qe!=2147483662){var Et=Y[qe];if(Et.t=="b"){if(J.fill=Et.stl!=1,Et.stl!=0){if(Et.stl!=1)throw Et.stl+" e"}X.colr=Et.clr}else if(Et.t=="p")J.strk=Et.stl!=5,X.lwidth=Et.wid,X.COLR=Et.clr;else if(Et.t=="f")J.fnt=Et,X.font.Tf=Et.nam,X.font.Tfs=Math.abs(Et.hgh),X.font.Tun=Et.und;else throw"e"}}}else if(he=="DELETEOBJECT"){var qe=ie(H,te);if(te+=4,Y[qe]!=null)Y[qe]=null;else throw"e"}else if(he=="CREATEBRUSHINDIRECT")Oe=ie(H,te),te+=4,xe={t:"b"},xe.stl=ie(H,te),te+=4,xe.clr=[H[te]/255,H[te+1]/255,H[te+2]/255],te+=4,xe.htc=ie(H,te),te+=4;else if(he=="CREATEPEN"||he=="EXTCREATEPEN")Oe=ie(H,te),te+=4,xe={t:"p"},he=="EXTCREATEPEN"?(te+=16,xe.stl=ie(H,te),te+=4,xe.wid=ie(H,te),te+=4,te+=4):(xe.stl=ie(H,te),te+=4,xe.wid=ie(H,te),te+=4,te+=4),xe.clr=[H[te]/255,H[te+1]/255,H[te+2]/255],te+=4;else if(he=="EXTCREATEFONTINDIRECTW"){Oe=ie(H,te),te+=4,xe={t:"f",nam:""},xe.hgh=ke(H,te),te+=4,te+=4*2,xe.orn=ke(H,te)/10,te+=4;var Ye=ie(H,te);for(te+=4,xe.und=H[te+1],xe.stk=H[te+2],te+=4*2;Se(H,te)!=0;)xe.nam+=String.fromCharCode(Se(H,te)),te+=2;Ye>500&&(xe.nam+="-Bold")}else if(he=="EXTTEXTOUTW"){te+=16;var Be=ie(H,te);te+=4,O(H,te),te+=4,O(H,te),te+=4;var Qe=ke(H,te);te+=4;var rt=ke(H,te);te+=4,X.font.Tm=[1,0,0,-1,0,0],K.UDOC.M.rotate(X.font.Tm,J.fnt.orn*Math.PI/180),K.UDOC.M.translate(X.font.Tm,Qe,rt);var lt=J.talg;if((lt&6)==6)X.font.Tal=2;else if(!(lt&7))X.font.Tal=0;else throw lt+" e";if((lt&24)!=24)if(!(lt&24))K.UDOC.M.translate(X.font.Tm,0,X.font.Tfs);else throw"e";var xt=ie(H,te);te+=4;var kt=ie(H,te);te+=4,ie(H,te),te+=4,te+=16,ie(H,te),te+=4,kt+=G-8;for(var qt="",Ft=0;Ft<xt;Ft++){var gr=Se(H,kt+Ft*2);qt+=String.fromCharCode(gr)}var Yt=X.colr;X.colr=J.tclr,L.PutText(X,qt,qt.length*X.font.Tfs*.5),X.colr=Yt}else if(he=="BEGINPATH")K.UDOC.G.newPath(X);else if(he!="ENDPATH")if(he=="CLOSEFIGURE")K.UDOC.G.closePath(X);else if(he=="MOVETOEX")K.UDOC.G.moveTo(X,ke(H,te),ke(H,te+4));else if(he=="LINETO"){if(X.pth.cmds.length==0){var Sr=X.ctm.slice(0);K.UDOC.M.invert(Sr);var zr=K.UDOC.M.multPoint(Sr,X.cpos);K.UDOC.G.moveTo(X,zr[0],zr[1])}K.UDOC.G.lineTo(X,ke(H,te),ke(H,te+4))}else if(he=="POLYGON"||he=="POLYGON16"||he=="POLYLINE"||he=="POLYLINE16"||he=="POLYLINETO"||he=="POLYLINETO16"){te+=16;var ht=he.startsWith("POLYGON"),ft=he.indexOf("TO")!=-1,Ht=ie(H,te);te+=4,ft||K.UDOC.G.newPath(X),te=K.FromEMF._drawPoly(H,te,Ht,X,he.endsWith("16")?2:4,ht,ft),ft||K.FromEMF._draw(L,X,J,ht)}else if(he=="POLYPOLYGON16"){te+=16;var ht=he.startsWith("POLYPOLYGON"),ft=he.indexOf("TO")!=-1,hr=ie(H,te);te+=4,te+=4;var Br=te;te+=hr*4,ft||K.UDOC.G.newPath(X);for(var Ft=0;Ft<hr;Ft++){var Vr=Se(H,Br+Ft*4);te=K.FromEMF._drawPoly(H,te,Vr,X,he.endsWith("16")?2:4,ht,ft)}ft||K.FromEMF._draw(L,X,J,ht)}else if(he=="POLYBEZIER"||he=="POLYBEZIER16"||he=="POLYBEZIERTO"||he=="POLYBEZIERTO16"){te+=16;var ma=he.endsWith("16"),ca=ma?fe:ke,ua=ma?2:4,Ht=ie(H,te);for(te+=4,he.indexOf("TO")==-1&&(K.UDOC.G.moveTo(X,ca(H,te),ca(H,te+ua)),te+=2*ua,Ht--);Ht>0;)K.UDOC.G.curveTo(X,ca(H,te),ca(H,te+ua),ca(H,te+2*ua),ca(H,te+3*ua),ca(H,te+4*ua),ca(H,te+5*ua)),te+=6*ua,Ht-=3}else if(he=="RECTANGLE"||he=="ELLIPSE"){K.UDOC.G.newPath(X);var Ge=K.FromEMF._readBox(H,te);if(he=="RECTANGLE")K.UDOC.G.moveTo(X,Ge[0],Ge[1]),K.UDOC.G.lineTo(X,Ge[2],Ge[1]),K.UDOC.G.lineTo(X,Ge[2],Ge[3]),K.UDOC.G.lineTo(X,Ge[0],Ge[3]);else{var Ke=(Ge[0]+Ge[2])/2,zt=(Ge[1]+Ge[3])/2;K.UDOC.G.arc(X,Ke,zt,(Ge[2]-Ge[0])/2,0,2*Math.PI,!1)}K.UDOC.G.closePath(X),K.FromEMF._draw(L,X,J,!0)}else if(he=="FILLPATH")L.Fill(X,!1);else if(he=="STROKEPATH")L.Stroke(X);else if(he=="STROKEANDFILLPATH")L.Fill(X,!1),L.Stroke(X);else if(he=="SETWORLDTRANSFORM"||he=="MODIFYWORLDTRANSFORM"){for(var Vt=[],Ft=0;Ft<6;Ft++)Vt.push(O(H,te+Ft*4));if(te+=24,he=="SETWORLDTRANSFORM")X.ctm=Vt;else{var Be=ie(H,te);if(te+=4,Be==2){var $r=X.ctm;X.ctm=Vt,K.UDOC.M.concat(X.ctm,$r)}else throw"e"}}else if(he=="SETSTRETCHBLTMODE")ie(H,te),te+=4;else if(he=="STRETCHDIBITS"){var Ge=K.FromEMF._readBox(H,te);te+=16;var Qr=ke(H,te);te+=4;var Me=ke(H,te);te+=4,ke(H,te),te+=4,ke(H,te),te+=4;var oe=ke(H,te);te+=4;var se=ke(H,te);te+=4;var Le=ie(H,te)+G-8;te+=4,ie(H,te),te+=4;var ut=ie(H,te)+G-8;te+=4,ie(H,te),te+=4;var sr=ie(H,te);if(te+=4,sr!=0)throw"e";ie(H,te),te+=4;var Zt=ke(H,te);te+=4;var sa=ke(H,te);te+=4,ie(H,Le),Le+=4;var da=ie(H,Le);Le+=4;var Ur=ie(H,Le);if(Le+=4,da!=oe||Ur!=se)throw"e";var Sa=Se(H,Le);Le+=2;var ha=Se(H,Le);if(Le+=2,ha!=8&&ha!=24&&ha!=32)throw ha+" e";var An=ie(H,Le);if(Le+=4,An!=0)throw An+" e";ie(H,Le),Le+=4,ie(H,Le),Le+=4,ie(H,Le),Le+=4,ie(H,Le),Le+=4,ie(H,Le),Le+=4;var Ta=Math.floor((da*Sa*ha+31&-32)/8),Va=new Uint8Array(da*Ur*4);if(ha==8)for(var zt=0;zt<Ur;zt++)for(var Ke=0;Ke<da;Ke++){var In=zt*da+Ke<<2,qe=H[ut+(Ur-1-zt)*Ta+Ke]<<2;Va[In]=H[Le+qe+2],Va[In+1]=H[Le+qe+1],Va[In+2]=H[Le+qe+0],Va[In+3]=255}if(ha==24)for(var zt=0;zt<Ur;zt++)for(var Ke=0;Ke<da;Ke++){var In=zt*da+Ke<<2,Pe=ut+(Ur-1-zt)*Ta+Ke*3;Va[In]=H[Pe+2],Va[In+1]=H[Pe+1],Va[In+2]=H[Pe+0],Va[In+3]=255}if(ha==32)for(var zt=0;zt<Ur;zt++)for(var Ke=0;Ke<da;Ke++){var In=zt*da+Ke<<2,Pe=ut+(Ur-1-zt)*Ta+Ke*4;Va[In]=H[Pe+2],Va[In+1]=H[Pe+1],Va[In+2]=H[Pe+0],Va[In+3]=H[Pe+3]}var cr=X.ctm.slice(0);X.ctm=[1,0,0,1,0,0],K.UDOC.M.scale(X.ctm,Zt,-sa),K.UDOC.M.translate(X.ctm,Qr,Me+sa),K.UDOC.M.concat(X.ctm,cr),L.PutImage(X,Va,da,Ur),X.ctm=cr}else console.log(he,$e)}xe!=null&&(Y[Oe]=xe),G+=$e-8}L.ShowPage(),L.Done()},K.FromEMF._readBox=function(H,L){for(var G=[],J=0;J<4;J++)G[J]=K.FromEMF.B.readInt(H,L+J*4);return G},K.FromEMF._updateCtm=function(H,L){var G=[1,0,0,1,0,0],J=H.wbb;H.bb;var X=H.vbb&&H.vbb.length==4?H.vbb:H.bb;K.UDOC.M.translate(G,-J[0],-J[1]),K.UDOC.M.scale(G,1/J[2],1/J[3]),K.UDOC.M.scale(G,X[2],X[3]),L.ctm=G},K.FromEMF._draw=function(H,L,G,J){G.fill&&J&&H.Fill(L,!1),G.strk&&L.lwidth!=0&&H.Stroke(L)},K.FromEMF._drawPoly=function(H,L,G,J,X,Y,ge){for(var fe=X==2?K.FromEMF.B.readShort:K.FromEMF.B.readInt,Se=0;Se<G;Se++){var ke=fe(H,L);L+=X;var ie=fe(H,L);L+=X,Se==0&&!ge?K.UDOC.G.moveTo(J,ke,ie):K.UDOC.G.lineTo(J,ke,ie)}return Y&&K.UDOC.G.closePath(J),L},K.FromEMF.B={uint8:new Uint8Array(4),readShort:function(L,G){var J=K.FromEMF.B.uint8;return J[0]=L[G],J[1]=L[G+1],K.FromEMF.B.int16[0]},readUshort:function(L,G){var J=K.FromEMF.B.uint8;return J[0]=L[G],J[1]=L[G+1],K.FromEMF.B.uint16[0]},readInt:function(L,G){var J=K.FromEMF.B.uint8;return J[0]=L[G],J[1]=L[G+1],J[2]=L[G+2],J[3]=L[G+3],K.FromEMF.B.int32[0]},readUint:function(L,G){var J=K.FromEMF.B.uint8;return J[0]=L[G],J[1]=L[G+1],J[2]=L[G+2],J[3]=L[G+3],K.FromEMF.B.uint32[0]},readFloat:function(L,G){var J=K.FromEMF.B.uint8;return J[0]=L[G],J[1]=L[G+1],J[2]=L[G+2],J[3]=L[G+3],K.FromEMF.B.flot32[0]},readASCII:function(L,G,J){for(var X="",Y=0;Y<J;Y++)X+=String.fromCharCode(L[G+Y]);return X}},K.FromEMF.B.int16=new Int16Array(K.FromEMF.B.uint8.buffer),K.FromEMF.B.uint16=new Uint16Array(K.FromEMF.B.uint8.buffer),K.FromEMF.B.int32=new Int32Array(K.FromEMF.B.uint8.buffer),K.FromEMF.B.uint32=new Uint32Array(K.FromEMF.B.uint8.buffer),K.FromEMF.B.flot32=new Float32Array(K.FromEMF.B.uint8.buffer),K.FromEMF.C={EMR_HEADER:1,EMR_POLYBEZIER:2,EMR_POLYGON:3,EMR_POLYLINE:4,EMR_POLYBEZIERTO:5,EMR_POLYLINETO:6,EMR_POLYPOLYLINE:7,EMR_POLYPOLYGON:8,EMR_SETWINDOWEXTEX:9,EMR_SETWINDOWORGEX:10,EMR_SETVIEWPORTEXTEX:11,EMR_SETVIEWPORTORGEX:12,EMR_SETBRUSHORGEX:13,EMR_EOF:14,EMR_SETPIXELV:15,EMR_SETMAPPERFLAGS:16,EMR_SETMAPMODE:17,EMR_SETBKMODE:18,EMR_SETPOLYFILLMODE:19,EMR_SETROP2:20,EMR_SETSTRETCHBLTMODE:21,EMR_SETTEXTALIGN:22,EMR_SETCOLORADJUSTMENT:23,EMR_SETTEXTCOLOR:24,EMR_SETBKCOLOR:25,EMR_OFFSETCLIPRGN:26,EMR_MOVETOEX:27,EMR_SETMETARGN:28,EMR_EXCLUDECLIPRECT:29,EMR_INTERSECTCLIPRECT:30,EMR_SCALEVIEWPORTEXTEX:31,EMR_SCALEWINDOWEXTEX:32,EMR_SAVEDC:33,EMR_RESTOREDC:34,EMR_SETWORLDTRANSFORM:35,EMR_MODIFYWORLDTRANSFORM:36,EMR_SELECTOBJECT:37,EMR_CREATEPEN:38,EMR_CREATEBRUSHINDIRECT:39,EMR_DELETEOBJECT:40,EMR_ANGLEARC:41,EMR_ELLIPSE:42,EMR_RECTANGLE:43,EMR_ROUNDRECT:44,EMR_ARC:45,EMR_CHORD:46,EMR_PIE:47,EMR_SELECTPALETTE:48,EMR_CREATEPALETTE:49,EMR_SETPALETTEENTRIES:50,EMR_RESIZEPALETTE:51,EMR_REALIZEPALETTE:52,EMR_EXTFLOODFILL:53,EMR_LINETO:54,EMR_ARCTO:55,EMR_POLYDRAW:56,EMR_SETARCDIRECTION:57,EMR_SETMITERLIMIT:58,EMR_BEGINPATH:59,EMR_ENDPATH:60,EMR_CLOSEFIGURE:61,EMR_FILLPATH:62,EMR_STROKEANDFILLPATH:63,EMR_STROKEPATH:64,EMR_FLATTENPATH:65,EMR_WIDENPATH:66,EMR_SELECTCLIPPATH:67,EMR_ABORTPATH:68,EMR_COMMENT:70,EMR_FILLRGN:71,EMR_FRAMERGN:72,EMR_INVERTRGN:73,EMR_PAINTRGN:74,EMR_EXTSELECTCLIPRGN:75,EMR_BITBLT:76,EMR_STRETCHBLT:77,EMR_MASKBLT:78,EMR_PLGBLT:79,EMR_SETDIBITSTODEVICE:80,EMR_STRETCHDIBITS:81,EMR_EXTCREATEFONTINDIRECTW:82,EMR_EXTTEXTOUTA:83,EMR_EXTTEXTOUTW:84,EMR_POLYBEZIER16:85,EMR_POLYGON16:86,EMR_POLYLINE16:87,EMR_POLYBEZIERTO16:88,EMR_POLYLINETO16:89,EMR_POLYPOLYLINE16:90,EMR_POLYPOLYGON16:91,EMR_POLYDRAW16:92,EMR_CREATEMONOBRUSH:93,EMR_CREATEDIBPATTERNBRUSHPT:94,EMR_EXTCREATEPEN:95,EMR_POLYTEXTOUTA:96,EMR_POLYTEXTOUTW:97,EMR_SETICMMODE:98,EMR_CREATECOLORSPACE:99,EMR_SETCOLORSPACE:100,EMR_DELETECOLORSPACE:101,EMR_GLSRECORD:102,EMR_GLSBOUNDEDRECORD:103,EMR_PIXELFORMAT:104,EMR_DRAWESCAPE:105,EMR_EXTESCAPE:106,EMR_SMALLTEXTOUT:108,EMR_FORCEUFIMAPPING:109,EMR_NAMEDESCAPE:110,EMR_COLORCORRECTPALETTE:111,EMR_SETICMPROFILEA:112,EMR_SETICMPROFILEW:113,EMR_ALPHABLEND:114,EMR_SETLAYOUT:115,EMR_TRANSPARENTBLT:116,EMR_GRADIENTFILL:118,EMR_SETLINKEDUFIS:119,EMR_SETTEXTJUSTIFICATION:120,EMR_COLORMATCHTOTARGETW:121,EMR_CREATECOLORSPACEW:122},K.FromEMF.K=[],K.ToContext2D=function(H,L){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.bb=null,this.currPage=0,this.needPage=H,this.scale=L},K.ToContext2D.prototype.StartPage=function(H,L,G,J){if(this.currPage==this.needPage){this.bb=[H,L,G,J];var X=this.scale,Y=window.devicePixelRatio,ge=this.canvas,fe=this.ctx;ge.width=Math.round(G*X),ge.height=Math.round(J*X),fe.translate(0,J*X),fe.scale(X,-X),ge.setAttribute("style","border:1px solid; width:"+ge.width/Y+"px; height:"+ge.height/Y+"px")}},K.ToContext2D.prototype.Fill=function(H,L){if(this.currPage==this.needPage){var G=this.ctx;G.beginPath(),this._setStyle(H,G),this._draw(H.pth,G),G.fill()}},K.ToContext2D.prototype.Stroke=function(H){if(this.currPage==this.needPage){var L=this.ctx;L.beginPath(),this._setStyle(H,L),this._draw(H.pth,L),L.stroke()}},K.ToContext2D.prototype.PutText=function(H,L,G){if(this.currPage==this.needPage){this._scale(H.ctm);var J=this.ctx;this._setStyle(H,J),J.save();var X=[1,0,0,-1,0,0];this._concat(X,H.font.Tm),this._concat(X,H.ctm),J.transform(X[0],X[1],X[2],X[3],X[4],X[5]),J.fillText(L,0,0),J.restore()}},K.ToContext2D.prototype.PutImage=function(H,L,G,J,X){if(this.currPage==this.needPage){var Y=this.ctx;if(L.length==G*J*4){if(L=L.slice(0),X&&X.length==G*J*4)for(var ge=0;ge<L.length;ge+=4)L[ge+3]=X[ge+1];var fe=document.createElement("canvas"),Se=fe.getContext("2d");fe.width=G,fe.height=J;for(var ke=Se.createImageData(G,J),ge=0;ge<L.length;ge++)ke.data[ge]=L[ge];Se.putImageData(ke,0,0),Y.save();var ie=[1,0,0,1,0,0];this._concat(ie,[1/G,0,0,-1/J,0,1]),this._concat(ie,H.ctm),Y.transform(ie[0],ie[1],ie[2],ie[3],ie[4],ie[5]),Y.drawImage(fe,0,0),Y.restore()}}},K.ToContext2D.prototype.ShowPage=function(){this.currPage++},K.ToContext2D.prototype.Done=function(){};function we(H){return""+parseFloat(H.toFixed(2))}K.ToContext2D.prototype._setStyle=function(H,L){var G=this._scale(H.ctm);L.fillStyle=this._getFill(H.colr,H.ca,L),L.strokeStyle=this._getFill(H.COLR,H.CA,L),L.lineCap=["butt","round","square"][H.lcap],L.lineJoin=["miter","round","bevel"][H.ljoin],L.lineWidth=H.lwidth*G;for(var J=H.dash.slice(0),X=0;X<J.length;X++)J[X]=we(J[X]*G);L.setLineDash(J),L.miterLimit=H.mlimit*G;var Y=H.font.Tf,ge=Y.toLowerCase(),fe=ge.indexOf("bold")!=-1?"bold ":"",Se=ge.indexOf("italic")!=-1||ge.indexOf("oblique")!=-1?"italic ":"";L.font=fe+Se+H.font.Tfs+'px "'+Y+'"'},K.ToContext2D.prototype._getFill=function(H,L,G){if(H.typ==null)return this._colr(H,L);var J=H,X=J.crds,Y=J.mat,ge=this._scale(Y),fe;if(J.typ=="lin"){var Se=this._multPoint(Y,X.slice(0,2)),ke=this._multPoint(Y,X.slice(2));fe=G.createLinearGradient(Se[0],Se[1],ke[0],ke[1])}else if(J.typ=="rad"){var Se=this._multPoint(Y,X.slice(0,2)),ke=this._multPoint(Y,X.slice(3));fe=G.createRadialGradient(Se[0],Se[1],X[2]*ge,ke[0],ke[1],X[5]*ge)}for(var ie=0;ie<J.grad.length;ie++)fe.addColorStop(J.grad[ie][0],this._colr(J.grad[ie][1],L));return fe},K.ToContext2D.prototype._colr=function(H,L){return"rgba("+Math.round(H[0]*255)+","+Math.round(H[1]*255)+","+Math.round(H[2]*255)+","+L+")"},K.ToContext2D.prototype._scale=function(H){return Math.sqrt(Math.abs(H[0]*H[3]-H[1]*H[2]))},K.ToContext2D.prototype._concat=function(H,L){var G=H[0],J=H[1],X=H[2],Y=H[3],ge=H[4],fe=H[5];H[0]=G*L[0]+J*L[2],H[1]=G*L[1]+J*L[3],H[2]=X*L[0]+Y*L[2],H[3]=X*L[1]+Y*L[3],H[4]=ge*L[0]+fe*L[2]+L[4],H[5]=ge*L[1]+fe*L[3]+L[5]},K.ToContext2D.prototype._multPoint=function(H,L){var G=L[0],J=L[1];return[G*H[0]+J*H[2]+H[4],G*H[1]+J*H[3]+H[5]]},K.ToContext2D.prototype._draw=function(H,L){for(var G=0,J=H.crds,X=0;X<H.cmds.length;X++){var Y=H.cmds[X];Y=="M"?(L.moveTo(J[G],J[G+1]),G+=2):Y=="L"?(L.lineTo(J[G],J[G+1]),G+=2):Y=="C"?(L.bezierCurveTo(J[G],J[G+1],J[G+2],J[G+3],J[G+4],J[G+5]),G+=6):Y=="Q"?(L.quadraticCurveTo(J[G],J[G+1],J[G+2],J[G+3]),G+=4):Y=="Z"&&L.closePath()}}},{}],93:[function(Fe,Ct,K){Object.defineProperty(K,"__esModule",{value:!0}),K.getBinaryContent=K.isContainMultiType=K.isKoera=K.isJapanese=K.isChinese=K.fromulaRef=K.escapeCharacter=K.generateRandomIndex=K.LightenDarkenColor=K.getRowHeightPixel=K.getColumnWidthPixel=K.getXmlAttibute=K.getPxByEMUs=K.getptToPxRatioByDPI=K.getcellrange=K.getRangetxt=void 0;var we=Fe("./constant");function H(Ye,Be){var Qe=Ye.row[0],rt=Ye.row[1],lt=Ye.column[0],xt=Ye.column[1];return Qe==null&&rt==null?Be+J(lt)+":"+J(xt):lt==null&&xt==null?Be+(Qe+1)+":"+(rt+1):lt==xt&&Qe==rt?Be+J(lt)+(Qe+1):Be+J(lt)+(Qe+1)+":"+J(xt)+(rt+1)}K.getRangetxt=H;function L(Ye,Be,Qe){Be===void 0&&(Be={}),Qe===void 0&&(Qe="1");var rt=Ye.split("!"),lt="",xt="",kt=-1;if(rt.length>1){lt=rt[0],xt=rt[1];var qt=Be[lt];qt==null?kt=parseInt(Qe):kt=parseInt(qt)}else kt=parseInt(Qe),xt=rt[0];if(xt.indexOf(":")==-1){var Ft=parseInt(xt.replace(/[^0-9]/g,""))-1,gr=G(xt.replace(/[^A-Za-z]/g,""));return!isNaN(Ft)&&!isNaN(gr)?{row:[Ft,Ft],column:[gr,gr],sheetIndex:kt}:null}else{var Yt=xt.split(":"),Ft=[],gr=[];return Ft[0]=parseInt(Yt[0].replace(/[^0-9]/g,""))-1,Ft[1]=parseInt(Yt[1].replace(/[^0-9]/g,""))-1,Ft[0]>Ft[1]||(gr[0]=G(Yt[0].replace(/[^A-Za-z]/g,"")),gr[1]=G(Yt[1].replace(/[^A-Za-z]/g,"")),gr[0]>gr[1])?null:{row:Ft,column:gr,sheetIndex:kt}}}K.getcellrange=L;function G(Ye){Ye=Ye.toUpperCase();var Be=Ye.length;if(Be==0)return NaN;for(var Qe=Ye.split(""),rt=we.columeHeader_word.length,lt=0,xt=Be-1;xt>=0;xt--)xt==Be-1?lt+=we.columeHeader_word_index[Qe[xt]]:lt+=Math.pow(rt,Be-xt-1)*(we.columeHeader_word_index[Qe[xt]]+1);return lt}function J(Ye){var Be=we.columeHeader_word.length;if(Ye<Be)return we.columeHeader_word[Ye];for(var Qe=0,rt="",lt=1,xt=0;Ye>=Be/(Be-1)*(Math.pow(Be,lt++)-1);)xt=lt;var kt=Ye-Be/(Be-1)*(Math.pow(Be,xt-1)-1);Qe=kt+1;for(var qt=xt;qt>0;qt--){var Ft=Qe;if(qt==1)return Ft=Ft%Be,Ft==0&&(Ft=26),rt+we.columeHeader_word[Ft-1];Ft=Math.ceil(Ft/Math.pow(Be,qt-1)),rt+=we.columeHeader_word[Ft-1],qt>1&&(Qe=Qe-(Ft-1)*Be)}}function X(){return 72/96}K.getptToPxRatioByDPI=X;function Y(Ye){if(Ye==null)return 0;var Be=Ye/914400,Qe=Be*72,rt=Qe/X();return rt}K.getPxByEMUs=Y;function ge(Ye,Be,Qe){var rt=Ye[Be];return rt=rt??Qe,rt}K.getXmlAttibute=ge;function fe(Ye){var Be=Math.round((Ye-.83)*8+5);return Be}K.getColumnWidthPixel=fe;function Se(Ye){var Be=Math.round(Ye/X());return Be}K.getRowHeightPixel=Se;function ke(Ye,Be){var Qe=Ye.substring(Ye.length-6,Ye.length),rt=O("#"+Qe),lt=he(rt[0],rt[1],rt[2]);if(Be>0)lt[2]=lt[2]*(1-Be)+Be;else if(Be<0)lt[2]=lt[2]*(1+Be);else return"#"+Qe;var xt=Z(lt[0],lt[1],lt[2]);return ie("RGB("+xt.join(",")+")")}K.LightenDarkenColor=ke;function ie(Ye){var Be=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(Ye)){for(var Qe=Ye.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),rt="#",lt=0;lt<Qe.length;lt++){var xt=Number(Qe[lt]).toString(16);xt.length<2&&(xt="0"+xt),rt+=xt}return rt.length!==7&&(rt=Ye),rt}else if(Be.test(Ye)){var kt=Ye.replace(/#/,"").split("");if(kt.length===6)return Ye;if(kt.length===3){for(var qt="#",lt=0;lt<kt.length;lt+=1)qt+=kt[lt]+kt[lt];return qt}}return Ye}function O(Ye){var Be=Ye.toLowerCase(),Qe=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(Be&&Qe.test(Be)){if(Be.length===4){for(var rt="#",lt=1;lt<4;lt+=1)rt+=Be.slice(lt,lt+1).concat(Be.slice(lt,lt+1));Be=rt}for(var xt=[],lt=1;lt<7;lt+=2)xt.push(parseInt("0x"+Be.slice(lt,lt+2)));return xt}return null}function Z(Ye,Be,Qe){var rt,lt,xt;if(Be==0)rt=lt=xt=Qe;else{var kt=function(Yt,Sr,zr){return zr<0&&(zr+=1),zr>1&&(zr-=1),zr<.16666666666666666?Yt+(Sr-Yt)*6*zr:zr<.5?Sr:zr<.6666666666666666?Yt+(Sr-Yt)*(.6666666666666666-zr)*6:Yt},qt=Qe<.5?Qe*(1+Be):Qe+Be-Qe*Be,Ft=2*Qe-qt;rt=kt(Ft,qt,Ye+1/3),lt=kt(Ft,qt,Ye),xt=kt(Ft,qt,Ye-1/3)}return[Math.round(rt*255),Math.round(lt*255),Math.round(xt*255)]}function he(Ye,Be,Qe){Ye/=255,Be/=255,Qe/=255;var rt=Math.max(Ye,Be,Qe),lt=Math.min(Ye,Be,Qe),xt,kt,qt=(rt+lt)/2;if(rt==lt)xt=kt=0;else{var Ft=rt-lt;switch(kt=qt>.5?Ft/(2-rt-lt):Ft/(rt+lt),rt){case Ye:xt=(Be-Qe)/Ft+(Be<Qe?6:0);break;case Be:xt=(Qe-Ye)/Ft+2;break;case Qe:xt=(Ye-Be)/Ft+4;break}xt/=6}return[xt,kt,qt]}function $e(Ye){Ye==null&&(Ye="Sheet");for(var Be=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),Qe="",rt=0;rt<5;rt++)Qe+=Be[Math.round(Math.random()*(Be.length-1))];var lt=new Date().getTime();return Ye+"_"+Qe+"_"+lt}K.generateRandomIndex=$e;function te(Ye){return Ye==null||Ye.length==0?Ye:Ye.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&apos;/g,"'").replace(/&iexcl;/g,"").replace(/&cent;/g,"").replace(/&pound;/g,"").replace(/&curren;/g,"").replace(/&yen;/g,"").replace(/&brvbar;/g,"").replace(/&sect;/g,"").replace(/&uml;/g,"").replace(/&copy;/g,"").replace(/&ordf;/g,"").replace(/&laquo;/g,"").replace(/&not;/g,"").replace(/&shy;/g,"").replace(/&reg;/g,"").replace(/&macr;/g,"").replace(/&deg;/g,"").replace(/&plusmn;/g,"").replace(/&sup2;/g,"").replace(/&sup3;/g,"").replace(/&acute;/g,"").replace(/&micro;/g,"").replace(/&para;/g,"").replace(/&middot;/g,"").replace(/&cedil;/g,"").replace(/&sup1;/g,"").replace(/&ordm;/g,"").replace(/&raquo;/g,"").replace(/&frac14;/g,"").replace(/&frac12;/g,"").replace(/&frac34;/g,"").replace(/&iquest;/g,"").replace(/&times;/g,"").replace(/&divide;/g,"").replace(/&Agrave;/g,"").replace(/&Aacute;/g,"").replace(/&Acirc;/g,"").replace(/&Atilde;/g,"").replace(/&Auml;/g,"").replace(/&Aring;/g,"").replace(/&AElig;/g,"").replace(/&Ccedil;/g,"").replace(/&Egrave;/g,"").replace(/&Eacute;/g,"").replace(/&Ecirc;/g,"").replace(/&Euml;/g,"").replace(/&Igrave;/g,"").replace(/&Iacute;/g,"").replace(/&Icirc;/g,"").replace(/&Iuml;/g,"").replace(/&ETH;/g,"").replace(/&Ntilde;/g,"").replace(/&Ograve;/g,"").replace(/&Oacute;/g,"").replace(/&Ocirc;/g,"").replace(/&Otilde;/g,"").replace(/&Ouml;/g,"").replace(/&Oslash;/g,"").replace(/&Ugrave;/g,"").replace(/&Uacute;/g,"").replace(/&Ucirc;/g,"").replace(/&Uuml;/g,"").replace(/&Yacute;/g,"").replace(/&THORN;/g,"").replace(/&szlig;/g,"").replace(/&agrave;/g,"").replace(/&aacute;/g,"").replace(/&acirc;/g,"").replace(/&atilde;/g,"").replace(/&auml;/g,"").replace(/&aring;/g,"").replace(/&aelig;/g,"").replace(/&ccedil;/g,"").replace(/&egrave;/g,"").replace(/&eacute;/g,"").replace(/&ecirc;/g,"").replace(/&euml;/g,"").replace(/&igrave;/g,"").replace(/&iacute;/g,"").replace(/&icirc;/g,"").replace(/&iuml;/g,"").replace(/&eth;/g,"").replace(/&ntilde;/g,"").replace(/&ograve;/g,"").replace(/&oacute;/g,"").replace(/&ocirc;/g,"").replace(/&otilde;/g,"").replace(/&ouml;/g,"").replace(/&oslash;/g,"").replace(/&ugrave;/g,"").replace(/&uacute;/g,"").replace(/&ucirc;/g,"").replace(/&uuml;/g,"").replace(/&yacute;/g,"").replace(/&thorn;/g,"").replace(/&yuml;/g,"")}K.escapeCharacter=te;var xe=function(){function Ye(){}return Ye.trim=function(Be){return Be==null&&(Be=""),Be.replace(/(^\s*)|(\s*$)/g,"")},Ye.functionCopy=function(Be,Qe,rt){var lt=this;if(lt.operatorjson==null){for(var xt=lt.operator.split("|"),kt={},qt=0;qt<xt.length;qt++)kt[xt[qt].toString()]=1;lt.operatorjson=kt}Qe==null&&(Qe="down"),rt==null&&(rt=1),Be.substr(0,1)=="="&&(Be=Be.substr(1));for(var Ft=Be.split(""),gr=0,Yt="",Sr="",zr={bracket:0,comma:0,squote:0,dquote:0};gr<Ft.length;){var ht=Ft[gr];if(ht=="("&&zr.dquote==0)zr.bracket+=1,Yt.length>0?Sr+=Yt+"(":Sr+="(",Yt="";else if(ht==")"&&zr.dquote==0)zr.bracket-=1,Sr+=lt.functionCopy(Yt,Qe,rt)+")",Yt="";else if(ht=='"'&&zr.squote==0)zr.dquote>0?(Sr+=Yt+'"',zr.dquote-=1,Yt=""):(zr.dquote+=1,Yt+='"');else if(ht==","&&zr.dquote==0)Sr+=lt.functionCopy(Yt,Qe,rt)+",",Yt="";else if(ht=="&"&&zr.dquote==0)Yt.length>0?(Sr+=lt.functionCopy(Yt,Qe,rt)+"&",Yt=""):Sr+="&";else if(ht in lt.operatorjson&&zr.dquote==0){var ft="";gr+1<Ft.length&&(ft=Ft[gr+1]);var Ht=gr-1,hr=null;if(Ht>=0)do hr=Ft[Ht--];while(Ht>=0&&hr==" ");ht+ft in lt.operatorjson?(Yt.length>0?(Sr+=lt.functionCopy(Yt,Qe,rt)+ht+ft,Yt=""):Sr+=ht+ft,gr++):!/[^0-9]/.test(ft)&&ht=="-"&&(hr=="("||hr==null||hr==","||hr==" "||hr in lt.operatorjson)?Yt+=ht:Yt.length>0?(Sr+=lt.functionCopy(Yt,Qe,rt)+ht,Yt=""):Sr+=ht}else Yt+=ht;gr==Ft.length-1&&(lt.iscelldata(lt.trim(Yt))?Qe=="down"?Sr+=lt.downparam(lt.trim(Yt),rt):Qe=="up"?Sr+=lt.upparam(lt.trim(Yt),rt):Qe=="left"?Sr+=lt.leftparam(lt.trim(Yt),rt):Qe=="right"&&(Sr+=lt.rightparam(lt.trim(Yt),rt)):Sr+=lt.trim(Yt)),gr++}return Sr},Ye.downparam=function(Be,Qe){return this.updateparam("d",Be,Qe)},Ye.upparam=function(Be,Qe){return this.updateparam("u",Be,Qe)},Ye.leftparam=function(Be,Qe){return this.updateparam("l",Be,Qe)},Ye.rightparam=function(Be,Qe){return this.updateparam("r",Be,Qe)},Ye.updateparam=function(Be,Qe,rt){var lt=this,xt=Qe.split("!"),kt,qt="";if(xt.length>1?(kt=xt[1],qt=xt[0]+"!"):kt=xt[0],kt.indexOf(":")==-1){var Ft=parseInt(kt.replace(/[^0-9]/g,"")),gr=G(kt.replace(/[^A-Za-z]/g,"")),Yt=lt.isfreezonFuc(kt),Sr=Yt[0]?"$":"",zr=Yt[1]?"$":"";return Be=="u"&&!Yt[0]?Ft-=rt:Be=="r"&&!Yt[1]?gr+=rt:Be=="l"&&!Yt[1]?gr-=rt:Yt[0]||(Ft+=rt),Ft<0||gr<0?lt.error.r:!isNaN(Ft)&&!isNaN(gr)?qt+zr+J(gr)+Sr+Ft:isNaN(Ft)?isNaN(gr)?Qe:qt+zr+J(gr):qt+Sr+Ft}else{kt=kt.split(":");var Ft=[],gr=[];if(Ft[0]=parseInt(kt[0].replace(/[^0-9]/g,"")),Ft[1]=parseInt(kt[1].replace(/[^0-9]/g,"")),Ft[0]>Ft[1]||(gr[0]=G(kt[0].replace(/[^A-Za-z]/g,"")),gr[1]=G(kt[1].replace(/[^A-Za-z]/g,"")),gr[0]>gr[1]))return Qe;var ht=lt.isfreezonFuc(kt[0]),ft=lt.isfreezonFuc(kt[1]),Ht=ht[0]?"$":"",hr=ht[1]?"$":"",Br=ft[0]?"$":"",Vr=ft[1]?"$":"";return Be=="u"?(ht[0]||(Ft[0]-=rt),ft[0]||(Ft[1]-=rt)):Be=="r"?(ht[1]||(gr[0]+=rt),ft[1]||(gr[1]+=rt)):Be=="l"?(ht[1]||(gr[0]-=rt),ft[1]||(gr[1]-=rt)):(ht[0]||(Ft[0]+=rt),ft[0]||(Ft[1]+=rt)),Ft[0]<0||gr[0]<0?lt.error.r:isNaN(gr[0])&&isNaN(gr[1])?qt+Ht+Ft[0]+":"+Br+Ft[1]:isNaN(Ft[0])&&isNaN(Ft[1])?qt+hr+J(gr[0])+":"+Vr+J(gr[1]):qt+hr+J(gr[0])+Ht+Ft[0]+":"+Vr+J(gr[1])+Br+Ft[1]}},Ye.iscelldata=function(Be){var Qe=Be.split("!"),rt;Qe.length>1?rt=Qe[1]:rt=Qe[0];var lt=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,xt=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(rt.indexOf(":")==-1){var kt=parseInt(rt.replace(/[^0-9]/g,""))-1,qt=G(rt.replace(/[^A-Za-z]/g,""));return!isNaN(kt)&&!isNaN(qt)&&rt.toString().match(lt)?!0:(isNaN(kt)&&isNaN(qt),!1)}else{xt=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,rt=rt.split(":");var kt=[],qt=[];return kt[0]=parseInt(rt[0].replace(/[^0-9]/g,""))-1,kt[1]=parseInt(rt[1].replace(/[^0-9]/g,""))-1,kt[0]>kt[1]||(qt[0]=G(rt[0].replace(/[^A-Za-z]/g,"")),qt[1]=G(rt[1].replace(/[^A-Za-z]/g,"")),qt[0]>qt[1])?!1:!!(rt[0].toString().match(xt)&&rt[1].toString().match(xt))}},Ye.isfreezonFuc=function(Be){var Qe=Be.replace(/[^0-9]/g,""),rt=Be.replace(/[^A-Za-z]/g,""),lt=Be.substr(Be.indexOf(Qe)-1,1),xt=Be.substr(Be.indexOf(rt)-1,1),kt=[!1,!1];return lt=="$"&&(kt[0]=!0),xt=="$"&&(kt[1]=!0),kt},Ye.operator="==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",Ye.error={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},Ye.operatorjson=null,Ye}();K.fromulaRef=xe;function Oe(Ye){var Be=/[^\u4e00-\u9fa5]/,Qe=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return Qe.test(Ye)?!0:!Be.test(Ye)}K.isChinese=Oe;function Je(Ye){var Be=/[^\u0800-\u4e00]/;return!Be.test(Ye)}K.isJapanese=Je;function ot(Ye){return Ye>12592&&Ye<12687||Ye>=44032&&Ye<=55203}K.isKoera=ot;function qe(Ye){var Be=!1;escape(Ye).indexOf("%u")>-1&&(Be=!0);var Qe=!1,rt=/[0-9a-z]/gi;rt.test(Ye)&&(Qe=!0);var lt=/[\x00-\xff]+/g;return lt.test(Ye)&&(Qe=!0),!!(Be&&Qe)}K.isContainMultiType=qe;function Et(Ye,Be){var Qe,rt,lt,xt;Be||(Be={});var kt=function(){try{return new window.XMLHttpRequest}catch{}},qt=function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch{}},Ft=typeof window<"u"&&window.ActiveXObject?function(){return kt()||qt()}:kt;typeof Be=="function"?(xt=Be,Be={}):typeof Be.callback=="function"&&(xt=Be.callback),rt=function(Sr){xt(null,Sr)},lt=function(Sr){xt(Sr,null)};try{var gr=Ft();gr.open("GET",Ye,!0),"responseType"in gr&&(gr.responseType="arraybuffer"),gr.overrideMimeType&&gr.overrideMimeType("text/plain; charset=x-user-defined"),gr.onreadystatechange=function(Yt){if(gr.readyState===4)if(gr.status===200||gr.status===0)try{rt(function(Sr){return Sr.response||Sr.responseText}(gr))}catch(Sr){lt(new Error(Sr))}else lt(new Error("Ajax error for "+Ye+" : "+this.status+" "+this.statusText))},Be.progress&&(gr.onprogress=function(Yt){Be.progress({path:Ye,originalEvent:Yt,percent:Yt.loaded/Yt.total*100,loaded:Yt.loaded,total:Yt.total})}),gr.send()}catch(Yt){lt(new Error(Yt),null)}return Qe}K.getBinaryContent=Et},{"./constant":91}],94:[function(Fe,Ct,K){Object.defineProperty(K,"__esModule",{value:!0}),K.LuckyExcel=void 0;var we=Fe("./ToLuckySheet/LuckyFile"),H=Fe("./HandleZip"),L=function(){function G(){}return G.transformExcelToLucky=function(J,X){var Y=new H.HandleZip(J);Y.unzipFile(function(ge){var fe=new we.LuckyFile(ge,J.name),Se=fe.Parse(),ke=JSON.parse(Se);X!=null&&X(ke,Se)},function(ge){console.error(ge)})},G.transformExcelToLuckyByUrl=function(J,X,Y){var ge=new H.HandleZip;ge.unzipFileByUrl(J,function(fe){var Se=new we.LuckyFile(fe,X),ke=Se.Parse(),ie=JSON.parse(ke);Y!=null&&Y(ie,ke)},function(fe){console.error(fe)})},G.transformLuckyToExcel=function(J,X){},G}();K.LuckyExcel=L},{"./HandleZip":84,"./ToLuckySheet/LuckyFile":87}],95:[function(Fe,Ct,K){var we=Fe("./main");Ct.exports=we.LuckyExcel},{"./main":94}]},{},[95])(95)})})(By);var mw=By.exports;const fw=hw(mw);(function(zn,Ii){typeof exports=="object"&&typeof module<"u"?module.exports=Ii():typeof define=="function"&&define.amd?define(Ii):(zn=typeof globalThis<"u"?globalThis:zn||self).luckysheet=Ii()})(void 0,function(){var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ii(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Fe(e,n,t){return e(t={path:n,exports:{},require:function(a,l){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(l==null&&t.path)}},t.exports),t.exports}var Ct=function(e){return e&&e.Math==Math&&e},K=Ct(typeof globalThis=="object"&&globalThis)||Ct(typeof window=="object"&&window)||Ct(typeof self=="object"&&self)||Ct(typeof zn=="object"&&zn)||Function("return this")(),we=function(e){try{return!!e()}catch{return!0}},H=!we(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),L={}.propertyIsEnumerable,G=Object.getOwnPropertyDescriptor,J={f:G&&!L.call({1:2},1)?function(e){var n=G(this,e);return!!n&&n.enumerable}:L},X=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}},Y={}.toString,ge=function(e){return Y.call(e).slice(8,-1)},fe="".split,Se=we(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return ge(e)=="String"?fe.call(e,""):Object(e)}:Object,ke=function(e){if(e==null)throw TypeError("Can't call method on "+e);return e},ie=function(e){return Se(ke(e))},O=function(e){return typeof e=="object"?e!==null:typeof e=="function"},Z=function(e,n){if(!O(e))return e;var t,a;if(n&&typeof(t=e.toString)=="function"&&!O(a=t.call(e))||typeof(t=e.valueOf)=="function"&&!O(a=t.call(e))||!n&&typeof(t=e.toString)=="function"&&!O(a=t.call(e)))return a;throw TypeError("Can't convert object to primitive value")},he={}.hasOwnProperty,$e=function(e,n){return he.call(e,n)},te=K.document,xe=O(te)&&O(te.createElement),Oe=function(e){return xe?te.createElement(e):{}},Je=!H&&!we(function(){return Object.defineProperty(Oe("div"),"a",{get:function(){return 7}}).a!=7}),ot=Object.getOwnPropertyDescriptor,qe={f:H?ot:function(e,n){if(e=ie(e),n=Z(n,!0),Je)try{return ot(e,n)}catch{}if($e(e,n))return X(!J.f.call(e,n),e[n])}},Et=function(e){if(!O(e))throw TypeError(String(e)+" is not an object");return e},Ye=Object.defineProperty,Be={f:H?Ye:function(e,n,t){if(Et(e),n=Z(n,!0),Et(t),Je)try{return Ye(e,n,t)}catch{}if("get"in t||"set"in t)throw TypeError("Accessors not supported");return"value"in t&&(e[n]=t.value),e}},Qe=H?function(e,n,t){return Be.f(e,n,X(1,t))}:function(e,n,t){return e[n]=t,e},rt=function(e,n){try{Qe(K,e,n)}catch{K[e]=n}return n},lt=K["__core-js_shared__"]||rt("__core-js_shared__",{}),xt=Function.toString;typeof lt.inspectSource!="function"&&(lt.inspectSource=function(e){return xt.call(e)});var kt,qt,Ft,gr=lt.inspectSource,Yt=K.WeakMap,Sr=typeof Yt=="function"&&/native code/.test(gr(Yt)),zr=Fe(function(e){(e.exports=function(n,t){return lt[n]||(lt[n]=t!==void 0?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})}),ht=0,ft=Math.random(),Ht=function(e){return"Symbol("+String(e===void 0?"":e)+")_"+(++ht+ft).toString(36)},hr=zr("keys"),Br=function(e){return hr[e]||(hr[e]=Ht(e))},Vr={},ma=K.WeakMap;if(Sr){var ca=new ma,ua=ca.get,Ge=ca.has,Ke=ca.set;kt=function(e,n){return Ke.call(ca,e,n),n},qt=function(e){return ua.call(ca,e)||{}},Ft=function(e){return Ge.call(ca,e)}}else{var zt=Br("state");Vr[zt]=!0,kt=function(e,n){return Qe(e,zt,n),n},qt=function(e){return $e(e,zt)?e[zt]:{}},Ft=function(e){return $e(e,zt)}}var Vt={set:kt,get:qt,has:Ft,enforce:function(e){return Ft(e)?qt(e):kt(e,{})},getterFor:function(e){return function(n){var t;if(!O(n)||(t=qt(n)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return t}}},$r=Fe(function(e){var n=Vt.get,t=Vt.enforce,a=String(String).split("String");(e.exports=function(l,o,d,s){var h=!!s&&!!s.unsafe,f=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;typeof d=="function"&&(typeof o!="string"||$e(d,"name")||Qe(d,"name",o),t(d).source=a.join(typeof o=="string"?o:"")),l!==K?(h?!p&&l[o]&&(f=!0):delete l[o],f?l[o]=d:Qe(l,o,d)):f?l[o]=d:rt(o,d)})(Function.prototype,"toString",function(){return typeof this=="function"&&n(this).source||gr(this)})}),Qr=K,Me=function(e){return typeof e=="function"?e:void 0},oe=function(e,n){return arguments.length<2?Me(Qr[e])||Me(K[e]):Qr[e]&&Qr[e][n]||K[e]&&K[e][n]},se=Math.ceil,Le=Math.floor,ut=function(e){return isNaN(e=+e)?0:(e>0?Le:se)(e)},sr=Math.min,Zt=function(e){return e>0?sr(ut(e),9007199254740991):0},sa=Math.max,da=Math.min,Ur=function(e,n){var t=ut(e);return t<0?sa(t+n,0):da(t,n)},Sa=function(e){return function(n,t,a){var l,o=ie(n),d=Zt(o.length),s=Ur(a,d);if(e&&t!=t){for(;d>s;)if((l=o[s++])!=l)return!0}else for(;d>s;s++)if((e||s in o)&&o[s]===t)return e||s||0;return!e&&-1}},ha={includes:Sa(!0),indexOf:Sa(!1)},An=ha.indexOf,Ta=function(e,n){var t,a=ie(e),l=0,o=[];for(t in a)!$e(Vr,t)&&$e(a,t)&&o.push(t);for(;n.length>l;)$e(a,t=n[l++])&&(~An(o,t)||o.push(t));return o},Va=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],In=Va.concat("length","prototype"),Pe={f:Object.getOwnPropertyNames||function(e){return Ta(e,In)}},cr={f:Object.getOwnPropertySymbols},wr=oe("Reflect","ownKeys")||function(e){var n=Pe.f(Et(e)),t=cr.f;return t?n.concat(t(e)):n},Gr=function(e,n){for(var t=wr(n),a=Be.f,l=qe.f,o=0;o<t.length;o++){var d=t[o];$e(e,d)||a(e,d,l(n,d))}},yt=/#|\.prototype\./,Gt=function(e,n){var t=pr[Ie(e)];return t==W||t!=xa&&(typeof n=="function"?we(n):!!n)},Ie=Gt.normalize=function(e){return String(e).replace(yt,".").toLowerCase()},pr=Gt.data={},xa=Gt.NATIVE="N",W=Gt.POLYFILL="P",Pt=Gt,Bt=qe.f,Ce=function(e,n){var t,a,l,o,d,s=e.target,h=e.global,f=e.stat;if(t=h?K:f?K[s]||rt(s,{}):(K[s]||{}).prototype)for(a in n){if(o=n[a],l=e.noTargetGet?(d=Bt(t,a))&&d.value:t[a],!Pt(h?a:s+(f?".":"#")+a,e.forced)&&l!==void 0){if(typeof o==typeof l)continue;Gr(o,l)}(e.sham||l&&l.sham)&&Qe(o,"sham",!0),$r(t,a,o,e)}},it=function(e,n){var t=[][e];return!!t&&we(function(){t.call(null,n||function(){throw 1},1)})},Mt=Object.defineProperty,ra={},Nr=function(e){throw e},Er=function(e,n){if($e(ra,e))return ra[e];n||(n={});var t=[][e],a=!!$e(n,"ACCESSORS")&&n.ACCESSORS,l=$e(n,0)?n[0]:Nr,o=$e(n,1)?n[1]:void 0;return ra[e]=!!t&&!we(function(){if(a&&!H)return!0;var d={length:-1};a?Mt(d,1,{enumerable:!0,get:Nr}):d[1]=1,t.call(d,l,o)})},Ua=ha.indexOf,Gl=[].indexOf,$n=!!Gl&&1/[1].indexOf(1,-0)<0,Oa=it("indexOf"),Nn=Er("indexOf",{ACCESSORS:!0,1:0});Ce({target:"Array",proto:!0,forced:$n||!Oa||!Nn},{indexOf:function(e){return $n?Gl.apply(this,arguments)||0:Ua(this,e,arguments.length>1?arguments[1]:void 0)}});var Bn,Qa=Object.setPrototypeOf||("__proto__"in{}?function(){var e,n=!1,t={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(t,[]),n=t instanceof Array}catch{}return function(a,l){return Et(a),function(o){if(!O(o)&&o!==null)throw TypeError("Can't set "+String(o)+" as a prototype")}(l),n?e.call(a,l):a.__proto__=l,a}}():void 0),ti=function(e,n,t){var a,l;return Qa&&typeof(a=n.constructor)=="function"&&a!==t&&O(l=a.prototype)&&l!==t.prototype&&Qa(e,l),e},Il=Object.keys||function(e){return Ta(e,Va)},yn=H?Object.defineProperties:function(e,n){Et(e);for(var t,a=Il(n),l=a.length,o=0;l>o;)Be.f(e,t=a[o++],n[t]);return e},el=oe("document","documentElement"),Yn=Br("IE_PROTO"),Rl=function(){},El=function(e){return"<script>"+e+"<\/script>"},Gi=function(){try{Bn=document.domain&&new ActiveXObject("htmlfile")}catch{}var e,n;Gi=Bn?function(a){a.write(El("")),a.close();var l=a.parentWindow.Object;return a=null,l}(Bn):((n=Oe("iframe")).style.display="none",el.appendChild(n),n.src="javascript:",(e=n.contentWindow.document).open(),e.write(El("document.F=Object")),e.close(),e.F);for(var t=Va.length;t--;)delete Gi.prototype[Va[t]];return Gi()};Vr[Yn]=!0;var gl=Object.create||function(e,n){var t;return e!==null?(Rl.prototype=Et(e),t=new Rl,Rl.prototype=null,t[Yn]=e):t=Gi(),n===void 0?t:yn(t,n)},Uo=`	
\v\f\r \u2028\u2029\uFEFF`,ho="["+Uo+"]",_s=RegExp("^"+ho+ho+"*"),Hu=RegExp(ho+ho+"*$"),Js=function(e){return function(n){var t=String(ke(n));return 1&e&&(t=t.replace(_s,"")),2&e&&(t=t.replace(Hu,"")),t}},Ho={start:Js(1),end:Js(2),trim:Js(3)},mo=Pe.f,fo=qe.f,jo=Be.f,qn=Ho.trim,vl=K.Number,Cs=vl.prototype,Bd=ge(gl(Cs))=="Number",ju=function(e){var n,t,a,l,o,d,s,h,f=Z(e,!1);if(typeof f=="string"&&f.length>2){if((n=(f=qn(f)).charCodeAt(0))===43||n===45){if((t=f.charCodeAt(2))===88||t===120)return NaN}else if(n===48){switch(f.charCodeAt(1)){case 66:case 98:a=2,l=49;break;case 79:case 111:a=8,l=55;break;default:return+f}for(d=(o=f.slice(2)).length,s=0;s<d;s++)if((h=o.charCodeAt(s))<48||h>l)return NaN;return parseInt(o,a)}}return+f};if(Pt("Number",!vl(" 0o1")||!vl("0b1")||vl("+0x1"))){for(var Go,Ri=function(e){var n=arguments.length<1?0:e,t=this;return t instanceof Ri&&(Bd?we(function(){Cs.valueOf.call(t)}):ge(t)!="Number")?ti(new vl(ju(n)),t,Ri):ju(n)},rn=H?mo(vl):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),po=0;rn.length>po;po++)$e(vl,Go=rn[po])&&!$e(Ri,Go)&&jo(Ri,Go,fo(vl,Go));Ri.prototype=Cs,Cs.constructor=Ri,$r(K,"Number",Ri)}Ce({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var $l="".repeat||function(e){var n=String(ke(this)),t="",a=ut(e);if(a<0||a==1/0)throw RangeError("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(n+=n))1&a&&(t+=n);return t},Gu=1 .toFixed,Wu=Math.floor,go=function(e,n,t){return n===0?t:n%2==1?go(e,n-1,t*e):go(e*e,n/2,t)},Wc=Gu&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128")||!we(function(){Gu.call({})});Ce({target:"Number",proto:!0,forced:Wc},{toFixed:function(e){var n,t,a,l,o=function(y){if(typeof y!="number"&&ge(y)!="Number")throw TypeError("Incorrect invocation");return+y}(this),d=ut(e),s=[0,0,0,0,0,0],h="",f="0",p=function(y,b){for(var k=-1,w=b;++k<6;)w+=y*s[k],s[k]=w%1e7,w=Wu(w/1e7)},g=function(y){for(var b=6,k=0;--b>=0;)k+=s[b],s[b]=Wu(k/y),k=k%y*1e7},v=function(){for(var y=6,b="";--y>=0;)if(b!==""||y===0||s[y]!==0){var k=String(s[y]);b=b===""?k:b+$l.call("0",7-k.length)+k}return b};if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return String(o);if(o<0&&(h="-",o=-o),o>1e-21)if(t=(n=function(y){for(var b=0,k=y;k>=4096;)b+=12,k/=4096;for(;k>=2;)b+=1,k/=2;return b}(o*go(2,69,1))-69)<0?o*go(2,-n,1):o/go(2,n,1),t*=4503599627370496,(n=52-n)>0){for(p(0,t),a=d;a>=7;)p(1e7,0),a-=7;for(p(go(10,a,1),0),a=n-1;a>=23;)g(1<<23),a-=23;g(1<<a),p(1,1),g(2),f=v()}else p(0,t),p(1<<-n,0),f=v()+$l.call("0",d);return f=d>0?h+((l=f.length)<=d?"0."+$l.call("0",d-l)+f:f.slice(0,l-d)+"."+f.slice(l-d)):h+f}});var Yu=!!Object.getOwnPropertySymbols&&!we(function(){return!String(Symbol())}),Yc=Yu&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ts=zr("wks"),vo=K.Symbol,Xu=Yc?vo:vo&&vo.withoutSetter||Ht,bn=function(e){return $e(Ts,e)||(Yu&&$e(vo,e)?Ts[e]=vo[e]:Ts[e]=Xu("Symbol."+e)),Ts[e]},Ym={};Ym[bn("toStringTag")]="z";var Vd=String(Ym)==="[object z]",Vy=bn("toStringTag"),Uy=ge(function(){return arguments}())=="Arguments",As=Vd?ge:function(e){var n,t,a;return e===void 0?"Undefined":e===null?"Null":typeof(t=function(l,o){try{return l[o]}catch{}}(n=Object(e),Vy))=="string"?t:Uy?ge(n):(a=ge(n))=="Object"&&typeof n.callee=="function"?"Arguments":a},Hy=Vd?{}.toString:function(){return"[object "+As(this)+"]"};Vd||$r(Object.prototype,"toString",Hy,{unsafe:!0});var Ud=function(){var e=Et(this),n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.sticky&&(n+="y"),n};function Xm(e,n){return RegExp(e,n)}var Hd={UNSUPPORTED_Y:we(function(){var e=Xm("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),BROKEN_CARET:we(function(){var e=Xm("^r","gy");return e.lastIndex=2,e.exec("str")!=null})},Xc=RegExp.prototype.exec,jy=String.prototype.replace,Zm=Xc,jd=function(){var e=/a/,n=/b*/g;return Xc.call(e,"a"),Xc.call(n,"a"),e.lastIndex!==0||n.lastIndex!==0}(),Km=Hd.UNSUPPORTED_Y||Hd.BROKEN_CARET,Gd=/()??/.exec("")[1]!==void 0;(jd||Gd||Km)&&(Zm=function(e){var n,t,a,l,o=this,d=Km&&o.sticky,s=Ud.call(o),h=o.source,f=0,p=e;return d&&((s=s.replace("y","")).indexOf("g")===-1&&(s+="g"),p=String(e).slice(o.lastIndex),o.lastIndex>0&&(!o.multiline||o.multiline&&e[o.lastIndex-1]!==`
`)&&(h="(?: "+h+")",p=" "+p,f++),t=new RegExp("^(?:"+h+")",s)),Gd&&(t=new RegExp("^"+h+"$(?!\\s)",s)),jd&&(n=o.lastIndex),a=Xc.call(d?t:o,p),d?a?(a.input=a.input.slice(f),a[0]=a[0].slice(f),a.index=o.lastIndex,o.lastIndex+=a[0].length):o.lastIndex=0:jd&&a&&(o.lastIndex=o.global?a.index+a[0].length:n),Gd&&a&&a.length>1&&jy.call(a[0],t,function(){for(l=1;l<arguments.length-2;l++)arguments[l]===void 0&&(a[l]=void 0)}),a});var Zu=Zm;Ce({target:"RegExp",proto:!0,forced:/./.exec!==Zu},{exec:Zu});var Jm=RegExp.prototype,Qm=Jm.toString,Gy=we(function(){return Qm.call({source:"a",flags:"b"})!="/a/b"}),Wy=Qm.name!="toString";(Gy||Wy)&&$r(RegExp.prototype,"toString",function(){var e=Et(this),n=String(e.source),t=e.flags;return"/"+n+"/"+String(t===void 0&&e instanceof RegExp&&!("flags"in Jm)?Ud.call(e):t)},{unsafe:!0});var Yy=bn("species"),Xy=!we(function(){var e=/./;return e.exec=function(){var n=[];return n.groups={a:"7"},n},"".replace(e,"$<a>")!=="7"}),ef="a".replace(/./,"$0")==="$0",tf=bn("replace"),rf=!!/./[tf]&&/./[tf]("a","$0")==="",Zy=!we(function(){var e=/(?:)/,n=e.exec;e.exec=function(){return n.apply(this,arguments)};var t="ab".split(e);return t.length!==2||t[0]!=="a"||t[1]!=="b"}),Zc=function(e,n,t,a){var l=bn(e),o=!we(function(){var g={};return g[l]=function(){return 7},""[e](g)!=7}),d=o&&!we(function(){var g=!1,v=/a/;return e==="split"&&((v={}).constructor={},v.constructor[Yy]=function(){return v},v.flags="",v[l]=/./[l]),v.exec=function(){return g=!0,null},v[l](""),!g});if(!o||!d||e==="replace"&&(!Xy||!ef||rf)||e==="split"&&!Zy){var s=/./[l],h=t(l,""[e],function(g,v,y,b,k){return v.exec===Zu?o&&!k?{done:!0,value:s.call(v,y,b)}:{done:!0,value:g.call(y,v,b)}:{done:!1}},{REPLACE_KEEPS_$0:ef,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:rf}),f=h[0],p=h[1];$r(String.prototype,e,f),$r(RegExp.prototype,l,n==2?function(g,v){return p.call(g,this,v)}:function(g){return p.call(g,this)})}a&&Qe(RegExp.prototype[l],"sham",!0)},Dl=function(e){return Object(ke(e))},af=function(e){return function(n,t){var a,l,o=String(ke(n)),d=ut(t),s=o.length;return d<0||d>=s?e?"":void 0:(a=o.charCodeAt(d))<55296||a>56319||d+1===s||(l=o.charCodeAt(d+1))<56320||l>57343?e?o.charAt(d):a:e?o.slice(d,d+2):l-56320+(a-55296<<10)+65536}},Wd={codeAt:af(!1),charAt:af(!0)},Ky=Wd.charAt,Yd=function(e,n,t){return n+(t?Ky(e,n).length:1)},Qs=function(e,n){var t=e.exec;if(typeof t=="function"){var a=t.call(e,n);if(typeof a!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return a}if(ge(e)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return Zu.call(e,n)},Jy=Math.max,Qy=Math.min,e0=Math.floor,t0=/\$([$&'`]|\d\d?|<[^>]*>)/g,r0=/\$([$&'`]|\d\d?)/g;Zc("replace",2,function(e,n,t,a){var l=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,o=a.REPLACE_KEEPS_$0,d=l?"$":"$0";return[function(h,f){var p=ke(this),g=h==null?void 0:h[e];return g!==void 0?g.call(h,p,f):n.call(String(p),h,f)},function(h,f){if(!l&&o||typeof f=="string"&&f.indexOf(d)===-1){var p=t(n,h,this,f);if(p.done)return p.value}var g=Et(h),v=String(this),y=typeof f=="function";y||(f=String(f));var b=g.global;if(b){var k=g.unicode;g.lastIndex=0}for(var w=[];;){var _=Qs(g,v);if(_===null||(w.push(_),!b))break;String(_[0])===""&&(g.lastIndex=Yd(v,Zt(g.lastIndex),k))}for(var C,A="",I=0,S=0;S<w.length;S++){_=w[S];for(var E=String(_[0]),R=Jy(Qy(ut(_.index),v.length),0),F=[],N=1;N<_.length;N++)F.push((C=_[N])===void 0?C:String(C));var z=_.groups;if(y){var P=[E].concat(F,R,v);z!==void 0&&P.push(z);var q=String(f.apply(void 0,P))}else q=s(E,v,R,F,z,f);R>=I&&(A+=v.slice(I,R)+q,I=R+E.length)}return A+v.slice(I)}];function s(h,f,p,g,v,y){var b=p+h.length,k=g.length,w=r0;return v!==void 0&&(v=Dl(v),w=t0),n.call(y,w,function(_,C){var A;switch(C.charAt(0)){case"$":return"$";case"&":return h;case"`":return f.slice(0,p);case"'":return f.slice(b);case"<":A=v[C.slice(1,-1)];break;default:var I=+C;if(I===0)return _;if(I>k){var S=e0(I/10);return S===0?_:S<=k?g[S-1]===void 0?C.charAt(1):g[S-1]+C.charAt(1):_}A=g[I-1]}return A===void 0?"":A})}});var Nt={autoFormatw:!1,accuracy:void 0,total:0,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,userInfo:!1,userMenuItem:[],myFolderUrl:null,functionButton:null,showConfigWindowResize:!0,enableAddRow:!0,enableAddBackTop:!0,enablePage:!0,pageInfo:null,editMode:!1,beforeCreateDom:null,workbookCreateBefore:null,workbookCreateAfter:null,fireMousedown:null,plugins:[],forceCalculation:!1,defaultColWidth:73,defaultRowHeight:19,defaultTextColor:"#000",defaultCellColor:"#fff"},u={container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfundo:[],jfredo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],defaultFontSize:10,currentSheetView:"viewNormal",cooperativeEdit:{usernameTimeout:{},changeCollaborationSize:[],allDataColumnlen:[],merge_range:{},checkoutData:[]},asyncLoad:["core"]},yr={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function $t(e){return e==null||e.toString().replace(/\s/g,"")==""}function M(e){return e!=null&&e.toString().replace(/\s/g,"")!==""&&typeof e!="boolean"&&!isNaN(e)}function j(e){var n=!1;for(var t in yr)if(e==yr[t]){n=!0;break}return n}function Ku(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)}function Rt(){return!!Nt.editMode}function mn(e,n,t,a,l){var o=!1;for(var d in u.config.merge){var s=e.merge[d];if(n<s.r){if(t>=s.r&&t<s.r+s.rs-1){if(a>=s.c&&a<=s.c+s.cs-1){o=!0;break}if(l>=s.c&&l<=s.c+s.cs-1){o=!0;break}if(a<s.c&&l>s.c+s.cs-1){o=!0;break}}else if(t>=s.r&&t==s.r+s.rs-1){if(a>s.c&&a<s.c+s.cs-1){o=!0;break}if(l>s.c&&l<s.c+s.cs-1){o=!0;break}if(a==s.c&&l<s.c+s.cs-1){o=!0;break}if(a>s.c&&l==s.c+s.cs-1){o=!0;break}}else if(t>s.r+s.rs-1){if(a>s.c&&a<=s.c+s.cs-1){o=!0;break}if(l>=s.c&&l<s.c+s.cs-1){o=!0;break}if(a==s.c&&l<s.c+s.cs-1){o=!0;break}if(a>s.c&&l==s.c+s.cs-1){o=!0;break}}}else if(n==s.r){if(t<s.r+s.rs-1){if(a>=s.c&&a<=s.c+s.cs-1){o=!0;break}if(l>=s.c&&l<=s.c+s.cs-1){o=!0;break}if(a<s.c&&l>s.c+s.cs-1){o=!0;break}}else if(t>=s.r+s.rs-1){if(a>s.c&&a<=s.c+s.cs-1){o=!0;break}if(l>=s.c&&l<s.c+s.cs-1){o=!0;break}if(a==s.c&&l<s.c+s.cs-1){o=!0;break}if(a>s.c&&l==s.c+s.cs-1){o=!0;break}}}else if(n<=s.r+s.rs-1){if(a>=s.c&&a<=s.c+s.cs-1){o=!0;break}if(l>=s.c&&l<=s.c+s.cs-1){o=!0;break}if(a<s.c&&l>s.c+s.cs-1){o=!0;break}}}return o}function nf(e){return Math.ceil(e.charCodeAt().toString(2).length/8)}function lf(e){var n,t={times:1,num:0};if(n=e,Math.floor(n)===n)return t.num=e,t;var a=e+"",l=a.indexOf("."),o=a.substr(l+1).length,d=Math.pow(10,o),s=parseInt(e*d+.5,10);return t.times=d,t.num=s,t}function Ju(e,n,t){var a=lf(e),l=lf(n),o=a.num,d=l.num,s=a.times,h=l.times,f=s>h?s:h;switch(t){case"add":return(s===h?o+d:s>h?o+d*(s/h):o*(h/s)+d)/f;case"subtract":return(s===h?o-d:s>h?o-d*(s/h):o*(h/s)-d)/f;case"multiply":return o*d/(s*h);case"divide":return Ju(o/d,h/s,"multiply")}}function ul(e){return(ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}function Yr(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function of(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),t.push.apply(t,a)}return t}function Dr(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?of(Object(t),!0).forEach(function(a){Yr(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):of(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function a0(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,a){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var l=[],o=!0,d=!1,s=void 0;try{for(var h,f=t[Symbol.iterator]();!(o=(h=f.next()).done)&&(l.push(h.value),!a||l.length!==a);o=!0);}catch(p){d=!0,s=p}finally{try{o||f.return==null||f.return()}finally{if(d)throw s}}return l}}(e,n)||Xd(e,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ei(e){return function(n){if(Array.isArray(n))return Zd(n)}(e)||function(n){if(typeof Symbol<"u"&&Symbol.iterator in Object(n))return Array.from(n)}(e)||Xd(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Xd(e,n){if(e){if(typeof e=="string")return Zd(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Zd(e,n):void 0}}function Zd(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function sf(e,n){var t;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(t=Xd(e))||n&&e&&typeof e.length=="number"){t&&(e=t);var a=0,l=function(){};return{s:l,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(h){throw h},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,d=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var h=t.next();return d=h.done,h},e:function(h){s=!0,o=h},f:function(){try{d||t.return==null||t.return()}finally{if(s)throw o}}}}Number.prototype.add=function(e){var n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("");return Ju(this,n,"add")},Number.prototype.subtract=function(e){var n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("");return Ju(this,n,"subtract")},Number.prototype.multiply=function(e){var n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("");return Ju(this,n,"multiply")},Number.prototype.divide=function(e){var n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("");return Ju(this,n,"divide")},Number.prototype.tofixed=function(e){var n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("");return function(t,a){if(a||(a=2),!M(t))return t;var l=t.toFixed(a),o=l.indexOf("."),d=l.substring(0,o),s=l.substring(o+1,l.length);if(s)for(var h=s.length-1;h!=0&&(s.charAt(h)=="0"||h!=s.length-1);h--)s=s.substring(0,h);return+(d+"."+s)}(this,n)};var eu,Kc,n0={container:"luckysheet",column:60,row:84,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,data:[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0},{name:"Sheet2",color:"",status:"0",order:"1",data:[],config:{},index:1},{name:"Sheet3",color:"",status:"0",order:"2",data:[],config:{},index:2}],title:"Luckysheet Demo",userInfo:!1,userMenuItem:[{url:"www.baidu.com",icon:'<i class="fa fa-folder" aria-hidden="true"></i>',name:""},{url:"www.baidu.com",icon:'<i class="fa fa-sign-out" aria-hidden="true"></i>',name:""}],myFolderUrl:"www.baidu.com",config:{},fullscreenmode:!0,devicePixelRatio:window.devicePixelRatio,allowEdit:!0,loadUrl:"",loadSheetUrl:"",gridKey:"",updateUrl:"",updateImageUrl:"",allowUpdate:!1,functionButton:"",showConfigWindowResize:!0,enableAddRow:!0,enableAddBackTop:!0,autoFormatw:!1,accuracy:void 0,pageInfo:{queryExps:"",reportId:"",fields:"",mobile:"",frezon:"",currentPage:"",totalPage:10,pageUrl:""},editMode:!1,beforeCreateDom:null,fireMousedown:null,lang:"en",plugins:[],forceCalculation:!1,rowHeaderWidth:46,columnHeaderHeight:20,defaultColWidth:73,defaultRowHeight:19,defaultFontSize:10,limitSheetNameLength:!0,defaultSheetNameMaxLength:31,sheetFormulaBar:!0,showtoolbarConfig:{},showsheetbarConfig:{},showstatisticBarConfig:{},cellRightClickConfig:{},sheetRightClickConfig:{}},Qu=Array.isArray||function(e){return ge(e)=="Array"},tu=function(e,n,t){var a=Z(n);a in e?Be.f(e,a,X(0,t)):e[a]=t},l0=bn("species"),Kd=function(e,n){var t;return Qu(e)&&(typeof(t=e.constructor)!="function"||t!==Array&&!Qu(t.prototype)?O(t)&&(t=t[l0])===null&&(t=void 0):t=void 0),new(t===void 0?Array:t)(n===0?0:n)},Jd=oe("navigator","userAgent")||"",uf=K.process,cf=uf&&uf.versions,df=cf&&cf.v8;df?Kc=(eu=df.split("."))[0]+eu[1]:Jd&&(!(eu=Jd.match(/Edge\/(\d+)/))||eu[1]>=74)&&(eu=Jd.match(/Chrome\/(\d+)/))&&(Kc=eu[1]);var hf=Kc&&+Kc,i0=bn("species"),ec=function(e){return hf>=51||!we(function(){var n=[];return(n.constructor={})[i0]=function(){return{foo:1}},n[e](Boolean).foo!==1})},mf=bn("isConcatSpreadable"),o0=hf>=51||!we(function(){var e=[];return e[mf]=!1,e.concat()[0]!==e}),s0=ec("concat"),u0=function(e){if(!O(e))return!1;var n=e[mf];return n!==void 0?!!n:Qu(e)};Ce({target:"Array",proto:!0,forced:!o0||!s0},{concat:function(e){var n,t,a,l,o,d=Dl(this),s=Kd(d,0),h=0;for(n=-1,a=arguments.length;n<a;n++)if(u0(o=n===-1?d:arguments[n])){if(h+(l=Zt(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(t=0;t<l;t++,h++)t in o&&tu(s,h,o[t])}else{if(h>=9007199254740991)throw TypeError("Maximum allowed index exceeded");tu(s,h++,o)}return s.length=h,s}});var tc=function(e){if(typeof e!="function")throw TypeError(String(e)+" is not a function");return e},ru=function(e,n,t){if(tc(e),n===void 0)return e;switch(t){case 0:return function(){return e.call(n)};case 1:return function(a){return e.call(n,a)};case 2:return function(a,l){return e.call(n,a,l)};case 3:return function(a,l,o){return e.call(n,a,l,o)}}return function(){return e.apply(n,arguments)}},c0=[].push,Ss=function(e){var n=e==1,t=e==2,a=e==3,l=e==4,o=e==6,d=e==5||o;return function(s,h,f,p){for(var g,v,y=Dl(s),b=Se(y),k=ru(h,f,3),w=Zt(b.length),_=0,C=p||Kd,A=n?C(s,w):t?C(s,0):void 0;w>_;_++)if((d||_ in b)&&(v=k(g=b[_],_,y),e)){if(n)A[_]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return _;case 2:c0.call(A,g)}else if(l)return!1}return o?-1:a||l?l:A}},zl={forEach:Ss(0),map:Ss(1),filter:Ss(2),some:Ss(3),every:Ss(4),find:Ss(5),findIndex:Ss(6)},Qd=bn("unscopables"),eh=Array.prototype;eh[Qd]==null&&Be.f(eh,Qd,{configurable:!0,value:gl(null)});var Is=function(e){eh[Qd][e]=!0},d0=zl.find,ff=!0,h0=Er("find");"find"in[]&&Array(1).find(function(){ff=!1}),Ce({target:"Array",proto:!0,forced:ff||!h0},{find:function(e){return d0(this,e,arguments.length>1?arguments[1]:void 0)}}),Is("find");var m0=zl.forEach,f0=it("forEach"),p0=Er("forEach"),rc=f0&&p0?[].forEach:function(e){return m0(this,e,arguments.length>1?arguments[1]:void 0)};Ce({target:"Array",proto:!0,forced:[].forEach!=rc},{forEach:rc});var g0=[].join,v0=Se!=Object,y0=it("join",",");Ce({target:"Array",proto:!0,forced:v0||!y0},{join:function(e){return g0.call(ie(this),e===void 0?",":e)}});var b0=ec("slice"),k0=Er("slice",{ACCESSORS:!0,0:0,1:2}),x0=bn("species"),w0=[].slice,_0=Math.max;Ce({target:"Array",proto:!0,forced:!b0||!k0},{slice:function(e,n){var t,a,l,o=ie(this),d=Zt(o.length),s=Ur(e,d),h=Ur(n===void 0?d:n,d);if(Qu(o)&&(typeof(t=o.constructor)!="function"||t!==Array&&!Qu(t.prototype)?O(t)&&(t=t[x0])===null&&(t=void 0):t=void 0,t===Array||t===void 0))return w0.call(o,s,h);for(a=new(t===void 0?Array:t)(_0(h-s,0)),l=0;s<h;s++,l++)s in o&&tu(a,l,o[s]);return a.length=l,a}});var C0=zl.some,T0=it("some"),A0=Er("some");Ce({target:"Array",proto:!0,forced:!T0||!A0},{some:function(e){return C0(this,e,arguments.length>1?arguments[1]:void 0)}});var S0=ec("splice"),I0=Er("splice",{ACCESSORS:!0,0:0,1:2}),R0=Math.max,E0=Math.min;Ce({target:"Array",proto:!0,forced:!S0||!I0},{splice:function(e,n){var t,a,l,o,d,s,h=Dl(this),f=Zt(h.length),p=Ur(e,f),g=arguments.length;if(g===0?t=a=0:g===1?(t=0,a=f-p):(t=g-2,a=E0(R0(ut(n),0),f-p)),f+t-a>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(l=Kd(h,a),o=0;o<a;o++)(d=p+o)in h&&tu(l,o,h[d]);if(l.length=a,t<a){for(o=p;o<f-a;o++)s=o+t,(d=o+a)in h?h[s]=h[d]:delete h[s];for(o=f;o>f-a+t;o--)delete h[o-1]}else if(t>a)for(o=f-a;o>p;o--)s=o+t-1,(d=o+a-1)in h?h[s]=h[d]:delete h[s];for(o=0;o<t;o++)h[o+p]=arguments[o+2];return h.length=f-a+t,l}});var $0=!we(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),pf=Br("IE_PROTO"),D0=Object.prototype,Wi=$0?Object.getPrototypeOf:function(e){return e=Dl(e),$e(e,pf)?e[pf]:typeof e.constructor=="function"&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?D0:null},F0=we(function(){var e=Be.f({},"a",{configurable:!0});return Reflect.set(Wi(e),"a",1,e)!==!1});Ce({target:"Reflect",stat:!0,forced:F0},{set:function e(n,t,a){var l,o,d=arguments.length<4?n:arguments[3],s=qe.f(Et(n),t);if(!s){if(O(o=Wi(n)))return e(o,t,a,d);s=X(0)}if($e(s,"value")){if(s.writable===!1||!O(d))return!1;if(l=qe.f(d,t)){if(l.get||l.set||l.writable===!1)return!1;l.value=a,Be.f(d,t,l)}else Be.f(d,t,X(0,a));return!0}return s.set!==void 0&&(s.set.call(d,a),!0)}}),Zc("match",1,function(e,n,t){return[function(a){var l=ke(this),o=a==null?void 0:a[e];return o!==void 0?o.call(a,l):new RegExp(a)[e](String(l))},function(a){var l=t(n,a,this);if(l.done)return l.value;var o=Et(a),d=String(this);if(!o.global)return Qs(o,d);var s=o.unicode;o.lastIndex=0;for(var h,f=[],p=0;(h=Qs(o,d))!==null;){var g=String(h[0]);f[p]=g,g===""&&(o.lastIndex=Yd(d,Zt(o.lastIndex),s)),p++}return p===0?null:f}]});var q0=bn("match"),th=function(e){var n;return O(e)&&((n=e[q0])!==void 0?!!n:ge(e)=="RegExp")},M0=bn("species"),ac=function(e,n){var t,a=Et(e).constructor;return a===void 0||(t=Et(a)[M0])==null?n:tc(t)},N0=[].push,L0=Math.min,au=!we(function(){return!RegExp(4294967295,"y")});Zc("split",2,function(e,n,t){var a;return a="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(l,o){var d=String(ke(this)),s=o===void 0?4294967295:o>>>0;if(s===0)return[];if(l===void 0)return[d];if(!th(l))return n.call(d,l,s);for(var h,f,p,g=[],v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(l.sticky?"y":""),y=0,b=new RegExp(l.source,v+"g");(h=Zu.call(b,d))&&!((f=b.lastIndex)>y&&(g.push(d.slice(y,h.index)),h.length>1&&h.index<d.length&&N0.apply(g,h.slice(1)),p=h[0].length,y=f,g.length>=s));)b.lastIndex===h.index&&b.lastIndex++;return y===d.length?!p&&b.test("")||g.push(""):g.push(d.slice(y)),g.length>s?g.slice(0,s):g}:"0".split(void 0,0).length?function(l,o){return l===void 0&&o===0?[]:n.call(this,l,o)}:n,[function(l,o){var d=ke(this),s=l==null?void 0:l[e];return s!==void 0?s.call(l,d,o):a.call(String(d),l,o)},function(l,o){var d=t(a,l,this,o,a!==n);if(d.done)return d.value;var s=Et(l),h=String(this),f=ac(s,RegExp),p=s.unicode,g=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(au?"y":"g"),v=new f(au?s:"^(?:"+s.source+")",g),y=o===void 0?4294967295:o>>>0;if(y===0)return[];if(h.length===0)return Qs(v,h)===null?[h]:[];for(var b=0,k=0,w=[];k<h.length;){v.lastIndex=au?k:0;var _,C=Qs(v,au?h:h.slice(k));if(C===null||(_=L0(Zt(v.lastIndex+(au?0:k)),h.length))===b)k=Yd(h,k,p);else{if(w.push(h.slice(b,k)),w.length===y)return w;for(var A=1;A<=C.length-1;A++)if(w.push(C[A]),w.length===y)return w;k=b=_}}return w.push(h.slice(b)),w}]},!au);var rh={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var P0 in rh){var gf=K[P0],Jc=gf&&gf.prototype;if(Jc&&Jc.forEach!==rc)try{Qe(Jc,"forEach",rc)}catch{Jc.forEach=rc}}var O0=zl.every,z0=it("every"),B0=Er("every");Ce({target:"Array",proto:!0,forced:!z0||!B0},{every:function(e){return O0(this,e,arguments.length>1?arguments[1]:void 0)}});var V0=zl.filter,U0=ec("filter"),H0=Er("filter");Ce({target:"Array",proto:!0,forced:!U0||!H0},{filter:function(e){return V0(this,e,arguments.length>1?arguments[1]:void 0)}});var ah=[],vf=ah.sort,j0=we(function(){ah.sort(void 0)}),G0=we(function(){ah.sort(null)}),W0=it("sort");Ce({target:"Array",proto:!0,forced:j0||!G0||!W0},{sort:function(e){return e===void 0?vf.call(Dl(this)):vf.call(Dl(this),tc(e))}});var nu=Object.assign,yf=Object.defineProperty,nc=!nu||we(function(){if(H&&nu({b:1},nu(yf({},"a",{enumerable:!0,get:function(){yf(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},n={},t=Symbol();return e[t]=7,"abcdefghijklmnopqrst".split("").forEach(function(a){n[a]=a}),nu({},e)[t]!=7||Il(nu({},n)).join("")!="abcdefghijklmnopqrst"})?function(e,n){for(var t=Dl(e),a=arguments.length,l=1,o=cr.f,d=J.f;a>l;)for(var s,h=Se(arguments[l++]),f=o?Il(h).concat(o(h)):Il(h),p=f.length,g=0;p>g;)s=f[g++],H&&!d.call(h,s)||(t[s]=h[s]);return t}:nu;Ce({target:"Object",stat:!0,forced:Object.assign!==nc},{assign:nc});var Y0=J.f,bf=function(e){return function(n){for(var t,a=ie(n),l=Il(a),o=l.length,d=0,s=[];o>d;)t=l[d++],H&&!Y0.call(a,t)||s.push(e?[t,a[t]]:a[t]);return s}},X0={entries:bf(!0),values:bf(!1)}.values;Ce({target:"Object",stat:!0},{values:function(e){return X0(e)}});var Z0=/"/g,kf=function(e,n,t,a){var l=String(ke(e)),o="<"+n;return t!==""&&(o+=" "+t+'="'+String(a).replace(Z0,"&quot;")+'"'),o+">"+l+"</"+n+">"},xf=function(e){return we(function(){var n=""[e]('"');return n!==n.toLowerCase()||n.split('"').length>3})};Ce({target:"String",proto:!0,forced:xf("bold")},{bold:function(){return kf(this,"b","","")}}),Ce({target:"String",proto:!0,forced:xf("link")},{link:function(e){return kf(this,"a","href",e)}});var kn,xn,K0={en:{functionlist:[{n:"SUMIF",t:0,d:"Returns a conditional sum across a range.",a:"A conditional sum across a range.",m:[2,3],p:[{name:"range",detail:"The range which is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"sum_range",detail:"The range to be summed, if different from `range`.",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"Returns the tangent of an angle provided in radians.",a:"Tangent of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the tangent of, in radians.",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"Returns the hyperbolic tangent of any real number.",a:"Hyperbolic tangent of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic tangent of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",a:"Rounds number up to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"Returns the inverse tangent of a value, in radians.",a:"Inverse tangent of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse tangent.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"Returns the inverse hyperbolic sine of a number.",a:"Inverse hyperbolic sine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"Returns the absolute value of a number.",a:"Absolute value of a number.",m:[1,1],p:[{name:"value",detail:"The number of which to return the absolute value.",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"Returns the inverse cosine of a value, in radians.",a:"Inverse cosine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse cosine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"Returns the inverse hyperbolic cosine of a number.",a:"Inverse hyperbolic cosine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic cosine. Must be greater than or equal to `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"Returns the factorial of the sum of values divided by the product of the values' factorials.",a:"Multinomial distribution function.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"Returns the inverse hyperbolic tangent of a number.",a:"Inverse hyperbolic tangent of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic tangent. Must be between -1 and 1, exclusive.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"Returns the angle between the x-axis and a line segment from the origin (0,0) to specified coordinate pair (`x`,`y`), in radians.",a:"Arctangent of a value.",m:[2,2],p:[{name:"x",detail:"The x coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"The y coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"Returns the number of empty values in a list of values and ranges.",a:"Number of empty values.",m:[1,1],p:[{name:"value1",detail:"The first value or range in which to count the number of blanks.",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"Returns the hyperbolic cosine of any real number.",a:"Hyperbolic cosine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic cosine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"Rounds a number down to the nearest integer that is less than or equal to it.",a:"Rounds number down to nearest integer.",m:[1,1],p:[{name:"value",detail:"The value to round down to the nearest integer.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"Checks whether the provided value is even.",a:"Whether the provided value is even.",m:[1,1],p:[{name:"value",detail:"The value to be verified as even.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"Checks whether the provided value is odd.",a:"Whether the provided value is odd.",m:[1,1],p:[{name:"value",detail:"The value to be verified as odd.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"Returns the least common multiple of one or more integers.",a:"Least common multiple of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the least common multiple.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the least common multiple.",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"Returns the logarithm of a number, base e (Euler's number).",a:"The logarithm of a number, base e (euler's number).",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base e.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"Returns the logarithm of a number with respect to a base.",a:"The logarithm of a number with respect to a base.",m:[1,2],p:[{name:"value",detail:"The value for which to calculate the logarithm.",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"base",detail:"The base to use for calculation of the logarithm.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"Returns the logarithm of a number, base 10.",a:"The logarithm of a number, base 10.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base 10.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:"Returns the result of the modulo operator, the remainder after a division operation.",a:"Modulo (remainder) operator.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided to find the remainder.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"Rounds one number to the nearest integer multiple of another.",a:"Rounds a number to the nearest integer multiple.",m:[2,2],p:[{name:"value",detail:"The number to round to the nearest integer multiple of another.",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"Rounds a number up to the nearest odd integer.",a:"Rounds a number up to the nearest odd integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest odd number.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"Returns the sum of the squares of a series of numbers and/or cells.",a:"Sum of squares.",m:[1,255],p:[{name:"value1",detail:"The first number or range whose squares to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges whose squares to add to the square(s) of `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects.",a:"Number of combinations from a set of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"Returns the inverse sine of a value, in radians.",a:"Inverse sine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse sine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"Returns a conditional count across a range.",a:"A conditional count across a range.",m:[2,2],p:[{name:"range",detail:"The range that is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"Converts an angle value in degrees to radians.",a:"Converts an angle value in degrees to radians.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from degrees to radians.",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"Returns a random number between 0 inclusive and 1 exclusive.",a:"A random number between 0 inclusive and 1 exclusive.",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"Counts the number of unique values in a list of specified values and ranges.",a:"Counts number of unique values in a range.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider for uniqueness.",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider for uniqueness.",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"Converts an angle value in radians to degrees.",a:"Converts an angle value in radians to degrees.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from radians to degrees.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"Returns the complementary Gauss error function of a value.",a:"Complementary gauss error function of a value.",m:[1,1],p:[{name:"z",detail:"The number for which to calculate the complementary Gauss error function.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"Rounds a number up to the nearest even integer.",a:"Rounds a number up to the nearest even integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest even number.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"Returns Euler's number, e (~2.718) raised to a power.",a:"Euler's number, e (~2.718) raised to a power.",m:[1,1],p:[{name:"exponent",detail:"The exponent to raise e to.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"Returns the factorial of a number.",a:"Factorial of a number.",m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose factorial will be calculated and returned.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:'Returns the "double factorial" of a number.',a:'"double factorial" of a number.',m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose double factorial will be calculated and returned.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"Returns the value of Pi to 14 decimal places.",a:"The number pi.",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"Rounds a number down to the nearest integer multiple of specified significance `factor`.",a:"Rounds number down to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round down to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"Returns the greatest common divisor of one or more integers.",a:"Greatest common divisor of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the greatest common divisor.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the greatest common divisor.",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"Returns a uniformly random integer between two values, inclusive.",a:"Random integer between two values, inclusive.",m:[2,2],p:[{name:"low",detail:"The low end of the random range.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"high",detail:"The high end of the random range.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"Rounds a number to a certain number of decimal places according to standard rules.",a:"Rounds a number according to standard rules.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"Rounds a number to a certain number of decimal places, always rounding down to the next valid increment.",a:"Rounds down a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding down.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"Rounds a number to a certain number of decimal places, always rounding up to the next valid increment.",a:"Rounds up a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding up.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"Given parameters `x`, `n`, `m`, and `a`, returns the power series sum a",a:"Sum of a power series.",m:[4,4],p:[{name:"x",detail:"The input to the power series. Varies depending on the type of approximation, may be angle, exponent, or some other value.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The initial power to which to raise `x` in the power series.",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"The additive increment by which to increase `x`.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"The array or range containing the coefficients of the power series.",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.",a:"Sign of a provided number (+/-/0).",m:[1,1],p:[{name:"value",detail:"The value whose sign will be evaluated.",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"Returns the sine of an angle provided in radians.",a:"Sine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the sine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"Returns the hyperbolic sine of any real number.",a:"Hyperbolic sine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic sine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"Returns the positive square root of a positive number.",a:"Positive square root of a positive number.",m:[1,1],p:[{name:"value",detail:"The number for which to calculate the positive square root.",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"Returns the positive square root of the product of Pi and the given positive number.",a:"Square root of the product of pi and number.",m:[1,1],p:[{name:"value",detail:"The number which will be multiplied by Pi and have the product's square root returned",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"Returns the logarithm of a specified Gamma function, base e (Euler's number).",a:"Logarithm of gamma function.",m:[1,1],p:[{name:"value",detail:"The input to the Gamma function. The natural logarithm of Gamma(`value`) will be returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"Returns the cosine of an angle provided in radians.",a:"Cosine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the cosine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"Truncates a number to a certain number of significant digits by omitting less significant digits.",a:"Truncates a number.",m:[1,2],p:[{name:"value",detail:"The value to be truncated.",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of significant digits to the right of the decimal point to retain.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"Returns one number divided by another.",a:"One number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"Returns a number raised to a power.",a:"A number raised to a power.",m:[2,2],p:[{name:"base",detail:"The number to raise to the `exponent` power.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"exponent",detail:"The exponent to raise `base` to.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"Returns the sum of a range depending on multiple criteria.",a:"Sums a range depending on multiple criteria.",m:[3,257],p:[{name:"sum_range",detail:"The range to sum.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criteria_range1",detail:"The range to check against criterion1.",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to criteria_range1.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"Returns the count of a range depending on multiple criteria.",a:"Count values depending on multiple criteria.",m:[2,256],p:[{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"Returns the result of multiplying a series of numbers together.",a:"Result of multiplying a series of numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"More numbers or ranges to calculate for the product.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"Calculates the harmonic mean of a dataset.",a:"The harmonic mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.",a:"Hypergeometric distribution probability.",m:[5,5],p:[{name:"num_successes",detail:"The desired number of successes.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_draws",detail:"The number of permitted draws.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"successes_in_pop",detail:"The total number of successes in the population.",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The total size of the population",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If cumulative is TRUE(), HYPGEOM.DIST returns the cumulative distribution function;

if FALSE(), it returns the probability density function.`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:"Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).",a:"Y-intercept of line derived via linear regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:'Calculates the kurtosis of a dataset, which describes the shape, and in particular the "peakedness" of that dataset.',a:"Kurtosis of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:"Returns the nth largest element from a data set, where n is user-defined.",a:"Nth largest element from a data set.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The rank from largest to smallest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"Calculates the standard deviation based on a sample, setting text to the value `0`.",a:"Standard deviation of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"Calculates the standard deviation based on an entire population.",a:"Standard deviation of an entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"Calculates the geometric mean of a dataset.",a:"The geometric mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.",a:"Top rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.",a:"Average rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 exclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 inclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:"Calculates the expected y-value for a specified x based on a linear regression of a dataset.",a:"Expected y-value based of linear regression.",m:[3,3],p:[{name:"x",detail:"The value on the x-axis to forecast.",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:"Returns the inverse Fisher transformation of a specified value.",a:"Inverse fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:"Returns the Fisher transformation of a specified value.",a:"Fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"Returns the most commonly occurring value in a dataset.",a:"Most commonly occurring value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating mode.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating mode.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"Returns the value of the Weibull distribution function (or Weibull cumulative distribution function) for a specified shape and scale.",a:"Weibull distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the Weibull distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"shape",detail:"The shape parameter of the Weibull distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"scale",detail:"The scale parameter of the Weibull distribution function.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the cumulative distribution function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"Returns the number of numeric values in a dataset.",a:"The number of numeric values in dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"Returns the number of values in a dataset.",a:"The number of values in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"Calculates the average of the magnitudes of deviations of data from a dataset's mean.",a:"Average magnitude of deviations from mean.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"Returns the numerical average value in a dataset, ignoring text.",a:"Numerical average value in a dataset, ignoring text.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"Returns the numerical average value in a dataset.",a:"Numerical average value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of successes (or a maximum number of successes) in a certain number of tries given a population of a certain size containing a certain number of successes, with replacement of draws.",a:"Binomial distribution probability.",m:[4,4],p:[{name:"num_successes",detail:"The number of successes for which to calculate the probability in `num_trials` trials.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the binomial cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.",a:"Inverse cumulative binomial distribution function.",m:[3,3],p:[{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"target_prob",detail:"The desired threshold probability.",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"Calculates the width of half the confidence interval for a normal distribution.",a:"Confidence interval for a normal distribution.",m:[3,3],p:[{name:"alpha",detail:"One minus the desired confidence level. E.g. `0.1` for `0.9`, or 90%, confidence.",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the population.",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The size of the population.",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"Calculates the covariance of a dataset.",a:"The covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"Calculates the sample covariance of a dataset.",a:"The sample covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"Calculates the sum of squares of deviations based on a sample.",a:"The sum of squares of deviations based on a sample.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:"Returns the value of the exponential distribution function with a specified lambda at a specified value.",a:"Exponential distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the exponential distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:"The lambda to specify the exponential distribution function.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the exponential cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"Returns the average of a range depending on criteria.",a:"Average of values depending on criteria.",m:[2,3],p:[{name:"criteria_range",detail:"The range to check against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:"The pattern or test to apply to `criteria_range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"The range to average. If not included, `criteria_range` is used for the average instead.",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"Returns the average of a range depending on multiple criteria.",a:"Average of values depending on multiple criteria.",m:[2,255],p:[{name:"average_range",detail:"The range to average.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.",a:"Number of permutations from a number of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.",a:"Mean of a dataset excluding high/low ends.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"exclude_proportion",detail:"The proportion of the dataset to exclude, from the extremities of the set.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:"Returns the value at a given percentile of a dataset exclusive of 0 and 1.",a:"Value at a given percentile of a dataset exclusive of 0 and 1.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile, exclusive of 0 and 1, whose value within 'data' will be calculated and returned.",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:"Returns the value at a given percentile of a dataset.",a:"Value at a given percentile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile whose value within `data` will be calculated and returned.`",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"Returns the value of the inverse standard normal distribution function for a specified value.",a:"Inverse standard normal distribution function.",m:[1,1],p:[{name:"x",detail:"The input to the inverse standard normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"Returns the value of the standard normal cumulative distribution function for a specified value.",a:"Standard normal cumulative distribution function.",m:[2,2],p:[{name:"x",detail:"The input to the standard normal cumulative distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.",a:"Inverse normal distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"Returns the value of the normal distribution function (or normal cumulative distribution function) for a specified value, mean, and standard deviation.",a:"Normal distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the normal distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the normal cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.",a:"Negative binomial distribution probability.",m:[4,4],p:[{name:"num_failures",detail:"The number of failures to model.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_successes",detail:"The number of successes to model.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"Returns the minimum numeric value in a dataset.",a:"Minimum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"Returns the minimum value in a numeric dataset.",a:"Minimum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"Returns the median value in a numeric dataset.",a:"Median value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the median value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the median value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"Returns the maximum numeric value in a dataset.",a:"Maximum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"Returns the maximum value in a numeric dataset.",a:"Maximum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:"Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Inverse log-normal cumulative distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse log-normal cumulative distribution function.",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the inverse log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the inverse log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:"Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Log-normal cumulative distribution probability.",m:[4,4],p:[{name:"x",detail:"The input to the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:"Returns the one-tailed p-value of a Z-test with standard distribution.",a:"One-tailed p-value of a z-test.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"value",detail:"The test statistic to use in the Z-test.",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation to assume for the Z-test. If this is not provided, the standard deviation of the data will be used.",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.",a:"Probability values lie in a range.",m:[3,4],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"probabilities",detail:"Array or range containing probabilities corresponding to `data`.",example:"2",require:"m",repeat:"n",type:"range"},{name:"low_limit",detail:"The lower bound on the value range for which to calculate the probability.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"high_limit",detail:"The upper bound on the value range for which to calculate the probability.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:"Returns a value nearest to a specified quartile of a dataset exclusive of 0 and 4.",a:"Value nearest to a specific quartile of a dataset exclusive of 0 and 4.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:"Returns a value nearest to a specified quartile of a dataset.",a:"Value nearest to a specific quartile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile value to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"Returns the value of the Poisson distribution function (or Poisson cumulative distribution function) for a specified value and mean.",a:"Poisson distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the Poisson distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the Poisson distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the Poisson cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.",a:"Square of the correlation coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:"Calculates the left tail probability for a Student's t-distribution with a given input (x).",a:"The left-tailed Student's t-distribution",m:[3,3],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"If cumulative is TRUE, T.DIST returns the cumulative distribution function; if FALSE, it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:"Calculates the probability for two tailed Student's t-distribution with a given input (x).",a:"The two tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:"Calculates the right tail probability for a Student's t-distribution with a given input (x).",a:"The right-tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:"Calculates the negative inverse of the one-tailed TDIST function.",a:"T.INV",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:"Calculates the inverse of the two-tailed TDIST function.",a:"T.INV.2T",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-test. Returns the probability associated with Student's t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.",a:"Returns the probability associated with t-test.",m:[4,4],p:[{name:"range1",detail:"The first sample of data or group of cells to consider for the t-test.",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"range2",detail:"The second sample of data or group of cells to consider for the t-test.",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"Specifies the number of distribution tails.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"Specifies the type of t-test.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:"Calculates the left-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution (left-tailed).",m:[4,4],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Logical value that determines the form of the function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"Calculates the right-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution.",m:[3,3],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"Calculates the variance based on an entire population.",a:"Variance of entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"Calculates the variance based on a sample.",a:"Variance.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"Calculates the variance based on a sample, setting text to the value `0`.",a:"Variance of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"Calculates the variance based on an entire population, setting text to the value `0`.",a:"Variance of entire population (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:"Calculates the standard error of the predicted y-value for each x in the regression of a dataset.",a:"Standard error of predicted y-values in regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.",a:"Normalized equivalent of a random variable.",m:[3,3],p:[{name:"value",detail:"The value of the random variable to normalize.",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean of the distribution.",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the distribution.",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"Returns the nth smallest element from a data set, where n is user-defined.",a:"Nth smallest element in a data set.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"n",detail:"The rank from smallest to largest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"Calculates the slope of the line resulting from linear regression of a dataset.",a:"Slope of line from linear regression of data.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.",a:"Skewness of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean. This assumes the dataset is for the population.",a:"Skewness of a population's dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",a:"Vertical lookup.",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`.",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.",a:"Horizontal lookup",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first row in the range is searched for the key specified in `search_key`.",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The row index of the value to be returned, where the first row in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the row to be searched (the first row of the specified range) is sorted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"Looks through a sorted row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.",a:"Look up a value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for in the row or column. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"search_range|search_result_array",detail:"One method of using this function is to provide a single sorted row or column `search_range` to look through for the `search_key` with a second argument `result_range`. The other way is to combine these two arguments into one `search_result_array` where the first row or column is searched and a value is returned from the last row or column in the array. If `search_key` is not found, a non-exact match may be returned.",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"result_range",detail:"The range from which to return a result. The value returned corresponds to the location where `search_key` is found in `search_range`. This range must be only a single row or column and should not be used if using the `search_result_array` method.",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"Returns a cell reference as a string.",a:"Cell reference as a string.",m:[2,5],p:[{name:"row",detail:"The row number of the cell reference",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The column number (not name) of the cell reference. `A` is column number `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"absolute_relative_mode",detail:"An indicator of whether the reference is row/column absolute. `1` is row and column absolute (e.g. $A$1), `2` is row absolute and column relative (e.g. A$1), `3` is row relative and column absolute (e.g. $A1), and `4` is row and column relative (e.g. A1).",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"use_a1_notation",detail:"A boolean indicating whether to use `A1` style notation (TRUE) or `R1C1` style notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet",detail:"Text indicating the name of the sheet into which the address points.",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"Returns a cell reference specified by a string.",a:"A cell reference specified by a string.",m:[1,2],p:[{name:"cell_reference_as_string",detail:"A cell reference, written as a string with surrounding quotation marks.",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"is_A1_notation",detail:"Indicates if the cell reference is in A1 notation (TRUE) or R1C1 notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"Returns the row number of a specified cell.",a:"Row number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose row number will be returned.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"Returns the number of rows in a specified array or range.",a:"Number of rows in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose row count will be returned.",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:"Returns the column number of a specified cell, with `A=1`.",a:"Column number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose column number will be returned. Column `A` corresponds to `1`.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"Returns the number of columns in a specified array or range.",a:"Number of columns in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose column count will be returned.",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"Returns a range reference shifted a specified number of rows and columns from a starting cell reference.",a:"A range reference offset relative to a cell.",m:[3,5],p:[{name:"cell_reference",detail:"The starting point from which to count the offset rows and columns.",example:"A2",require:"m",repeat:"n",type:"range"},{name:"offset_rows",detail:"The number of rows to offset by.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"offset_columns",detail:"The number of columns to offset by.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"The height of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"The width of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"Returns the relative position of an item in a range that matches a specified value.",a:"Position of item in range that matches value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The one-dimensional array to be searched.",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"search_type",detail:"The search method. `1` (default) finds the largest value less than or equal to `search_key` when `range` is sorted in ascending order. `0` finds the exact value when `range` is unsorted. `-1` finds the smallest value greater than or equal to `search_key` when `range` is sorted in descending order.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"Returns the content of a cell, specified by row and column offset.",a:"Content of cell specified by row and column offset.",m:[2,3],p:[{name:"reference",detail:"The array of cells to be offset into.",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row",detail:"The number of offset rows.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The number of offset columns.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",a:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",m:[2,254],p:[{name:"value_name",detail:"The name of the value in the pivot table for which you want to get data.",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"any_pivot_table_cell",detail:"Any reference to a cell in the desired pivot table (top corner recommended).",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"original_column",detail:"The name of the column in the original data set (not the pivot table).",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"pivot_item",detail:"The name of the row or column shown in the pivot table corresponding to *original_column* that you want to retrieve.",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"Returns an element from a list of choices based on index.",a:"An element from a list of choices based on index.",m:[2,255],p:[{name:"index",detail:"Which choice (of the up to 30 provided) to return.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"choice1",detail:"A potential value to return. Required. May be a reference to a cell or an individual value.",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"choice2",detail:"Additional values among which to choose.",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"Creates a hyperlink inside a cell.",a:"Creates a hyperlink inside a cell.",p:[{name:"url",detail:"The full URL of the link location enclosed in quotation marks, or a reference to a cell containing such a URL.",example:'"http://www.luckysheet.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"link_label",detail:"The text to display in the cell as the link, enclosed in quotation marks, or a reference to a cell containing such a label.",example:'"luckysheet"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"Converts a provided hour, minute, and second into a time.",a:"Converts hour/minute/second into a time.",m:[3,3],p:[{name:"hour",detail:"The hour component of the time.",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"minute",detail:"The minute component of the time.",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"second",detail:"The second component of the time.",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"Returns the fraction of a 24-hour day the time represents.",a:"Converts a time string into its serial number representation.",m:[1,1],p:[{name:"time_string",detail:"The string that holds the time representation.",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"Returns a date on the last day of a month that falls a specified number of months before or after another date.",a:"Last day of a month before or after a date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to consider.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"Returns a date a specified number of months before or after another date.",a:"Date a number of months before/after another date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to calculate.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"Returns the second component of a specific time, in numeric format.",a:"Second component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the second component",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"Returns the minute component of a specific time, in numeric format.",a:"Minute component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the minute component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"Returns the hour component of a specific time, in numeric format.",a:"Hour component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the hour component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"Returns the current date and time as a date value.",a:"Current date and time as a date value.",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"Returns the number of net working days between two provided days.",a:"Net working days between two provided days.",m:[2,3],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the date serial numbers to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"Returns the number of net working days between two provided days excluding specified weekend days and holidays.",a:"Net working days between two dates (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider as holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:"Returns a number representing the ISO week of the year where the provided date falls.",a:"ISO week number of the year.",m:[1,1],p:[{name:"date",detail:"The date for which to determine the ISO week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"Returns a number representing the week of the year where the provided date falls.",a:"Week number of the year.",m:[1,2],p:[{name:"date",detail:"The date for which to determine the week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number representing the day that a week starts on. Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"Returns a number representing the day of the week of the date provided.",a:"Day of the week of the date provided (as number).",m:[1,2],p:[{name:"date",detail:"The date for which to determine the day of the week. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number indicating which numbering system to use to represent weekdays. By default, counts starting with Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"Returns the day of the month that a specific date falls on, in numeric format.",a:"Day of the month that a specific date falls on.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the day.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"Returns the number of days between two dates.",a:"Number of days between two dates.",m:[2,2],p:[{name:"end_date",detail:"The end of the date range.",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"The start of the date range.",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"Returns the difference between two days based on the 360 day year used in some financial interest calculations.",a:"Days between two dates on a 360-day year.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"An indicator of what day count method to use.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"Converts a provided year, month, and day into a date.",a:"Converts year/month/day into a date.",m:[3,3],p:[{name:"year",detail:"The year component of the date.",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The month component of the date.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"The day component of the date.",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"Converts a provided date string in a known format to a date value.",a:"Converts a date string to a date value.",m:[1,1],p:[{name:"date_string",detail:"The string representing the date.",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"Calculates the number of days, months, or years between two dates.",a:"Date Difference.",m:[3,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"unit",detail:'A string abbreviation for unit of time. For example, "M" for month. Accepted values are "Y","M","D","MD","YM","YD".',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"Calculates the date after a number of working days from a specified start date.",a:"Number of working days from start date.",m:[2,3],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:"Calculates the date after a specified number of workdays excluding specified weekend days and holidays.",a:"Date after a number of workdays (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"Returns the year specified by a given date.",a:"Year specified by a given date.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the year.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:"Returns the number of years, including fractional years, between two dates using a specified day count convention.",a:"Exact number of years between two dates.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"Returns the current date as a date value.",a:"Current date as a date value.",m:[0,0],p:[]},{n:"MONTH",t:6,d:"Returns the month of the year a specific date falls in, in numeric format.",a:"Month of the year a specific date falls in.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the month.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",a:"Annual effective interest rate.",m:[2,2],p:[{name:"nominal_rate",detail:"The nominal interest rate per year.",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"Formats a number into the currency specific to your spreadsheet locale.",a:"Formats a number as currency specific to your spreadsheet locale.",m:[1,2],p:[{name:"number",detail:"The value to be formatted.",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"Converts a price quotation given as a decimal fraction into a decimal value.",a:"Converts a decimal fraction to decimal value.",m:[2,2],p:[{name:"fractional_price",detail:"The price quotation given using fractional decimal conventions.",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"Converts a price quotation given as a decimal value into a decimal fraction.",a:"Converts a decimal value to decimal fraction.",m:[2,2],p:[{name:"decimal_price",detail:"The price quotation given as a decimal value.",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the desired fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"Calculates the depreciation of an asset for a specified period using the arithmetic declining balance method.",a:"Depreciation via declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The number of months in the first year of depreciation.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"Calculates the depreciation of an asset for a specified period using the double-declining balance method.",a:"Depreciation via double-declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The factor by which depreciation decreases.",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"Calculates the interest rate of an annuity investment based on constant-amount periodic payments and the assumption of a constant interest rate.",a:"Interest rate of an annuity investment.",m:[3,6],p:[{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_per_period",detail:"The amount per period to be paid.",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"rate_guess",detail:"An estimate for what the interest rate will be.",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"Calculates the cumulative principal paid over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative principal paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"Calculates the number of coupons, or interest payments, between the settlement date and the maturity date of the investment.",a:"Number of coupons between settlement and maturity.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"Calculates the depreciation of an asset for a specified period using the sum of years digits method.",a:"Depreciation via sum of years digits method.",m:[4,4],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"Calculates the equivalent annualized rate of return of a US Treasury Bill based on discount rate.",a:"Equivalent rate of return for a Treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"Calculates the yield of a US Treasury Bill based on price.",a:"The yield of a us treasury bill based on price.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"Calculates the price of a US Treasury Bill based on discount rate.",a:"Price of US treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"Calculates the present value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Present value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"Calculates the accrued interest of a security that has periodic payments.",a:"Accrued interest of security with periodic payments.",m:[6,8],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_payment",detail:"The first date interest will be paid.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:`[Optional-defaults to TRUE()] - A logical value that specifies the method used to calculate the total accrued interest when the settlement date is later than the first interest accrual date. 

If the value is TRUE, the total accrued interest from the issue date to the settlement date is returned. 

If the value is FALSE, return the accrued interest from the first interest accrual date to the settlement date.`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"Calculates the accrued interest of a security that pays interest at maturity.",a:"Accrued interest of security paying at maturity.",m:[4,5],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity date of the security.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"Calculates the number of days from the first coupon, or interest payment, until settlement.",a:"Number of days from first coupon to settlement.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"Calculates the number of days in the coupon, or interest payment, period that contains the specified settlement date.",a:"Days in coupon period containing settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"Calculates the number of days from the settlement date until the next coupon, or interest payment.",a:"Days from settlement until next coupon.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"Calculates next coupon, or interest payment, date after the settlement date.",a:"Next coupon date after the settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"Calculates last coupon, or interest payment, date before the settlement date.",a:"Last coupon date before settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"Calculates the future value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Future value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"Calculates the future value of some principal based on a specified series of potentially varying interest rates.",a:"Future value of principal from series of rates.",m:[2,2],p:[{name:"principal",detail:"The amount of initial capital or value to compound against.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"rate_schedule",detail:"A series of interest rates to compound against the `principal`.",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"Calculates the annual yield of a security paying periodic interest, such as a US Treasury Bond, based on price.",a:"Annual yield of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"Calculates the annual yield of a discount (non-interest-bearing) security, based on price.",a:"Annual yield of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"Calculates the annual nominal interest rate given the effective rate and number of compounding periods per year.",a:"Annual nominal interest rate.",m:[2,2],p:[{name:"effective_rate",detail:"The effective interest rate per year.",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"Calculates the internal rate of return of an investment based on a specified series of potentially irregularly spaced cash flows.",a:"Internal rate of return given non-periodic cashflows.",m:[2,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"An array or range with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"Calculates the modified internal rate of return on an investment based on a series of periodic cash flows and the difference between the interest rate paid on financing versus the return received on reinvested income.",a:"Modified internal rate of return.",m:[3,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"financing_rate",detail:"The interest rate paid on funds invested.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvestment_return_rate",detail:"The return (as a percentage) earned on reinvestment of income received from the investment.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:"Calculates the internal rate of return on an investment based on a series of periodic cash flows.",a:"Internal rate of return given periodic cashflows.",m:[1,2],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"Calculates the net present value of an investment based on a series of periodic cash flows and a discount rate.",a:"The net present value of an investment based on a series of periodic cash flows and a discount rate.",m:[2,255],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow1",detail:"The first future cash flow.",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"cashflow2",detail:"Additional future cash flows.",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"Calculates the net present value of an investment based on a specified series of potentially irregularly spaced cash flows and a discount rate.",a:"Net present value given non-periodic cashflows.",m:[3,3],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow_amounts",detail:"A range of cells containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"A range of cells with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"Calculates the cumulative interest over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative interest paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"Calculates the periodic payment for an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Periodic payment for an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"Calculates the payment on interest for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on interest for an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"Calculates the payment on the principal of an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on the principal of an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"Calculates the effective interest rate generated when an investment is purchased at one price and sold at another with no interest or dividends generated by the investment itself.",a:"Calculates effective interest rate.",m:[4,5],p:[{name:"buy_date",detail:"The date of purchase of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"sell_date",detail:"The date of sale of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"buy_price",detail:"The price at which the investment was purchased.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"sell_price",detail:"The price at which the investment was sold.",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"Calculates the price of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Price of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"Calculates the price of a discount (non-interest-bearing) security, based on expected yield.",a:"Price of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the security at time of purchase.",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"Calculates the price of a security paying interest at maturity, based on expected yield.",a:"Price of security paying interest at maturity.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"Calculates the amount received at maturity for an investment in fixed-income securities purchased on a given date.",a:"Amount received at maturity for a security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"The amount invested (irrespective of face value of each security).",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"The discount rate of the security invested in.",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"Calculates the discount rate of a security based on price.",a:"The discount rate of a security based on price.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"Calculates the number of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Number of payment periods for an investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount of each payment made.",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"Calculates the depreciation of an asset for one period using the straight-line method.",a:"Depreciation of asset using the straight-line method.",m:[3,3],p:[{name:"cost",detail:"The initial cost of the asset.",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"Calculates the number of compounding periods required for an investment of a specified present value appreciating at a given rate to reach a target value.",a:"Number of periods for an investment to reach a value.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"Calculates the modified Macaulay duration of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Modified Macaulay duration.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"Converts a signed binary number to decimal format.",a:"Converts a signed binary number to decimal format.",m:[1,1],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"Converts a signed binary number to signed hexadecimal format.",a:"Converts a binary number to hexadecimal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed hexademical, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"Converts a signed binary number to signed octal format.",a:"Converts a binary number to octal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed octal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"Converts a decimal number to signed binary format.",a:"Converts a decimal number to signed binary format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed binary, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"Converts a decimal number to signed hexadecimal format.",a:"Converts a decimal number to hexadecimal.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed hexadecimal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"Converts a decimal number to signed octal format.",a:"Converts a decimal number to signed octal format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed octal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"Converts a signed hexadecimal number to signed binary format.",a:"Converts a hexadecimal number to binary.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed binary, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"Converts a signed hexadecimal number to decimal format.",a:"Converts a hexadecimal number to decimal.",m:[1,1],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to decimal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"Converts a signed hexadecimal number to signed octal format.",a:"Converts a hexadecimal number to octal.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed octal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"Converts a signed octal number to signed binary format.",a:"Converts an octal number to binary.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed binary, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"Converts a signed octal number to decimal format.",a:"Converts a signed octal number to decimal format.",m:[1,1],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to decimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"Converts a signed octal number to signed hexadecimal format.",a:"Converts an octal number to hexadecimal.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed hexadecimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:"Creates a complex number given real and imaginary coefficients.",a:"Creates a complex number.",m:[2,3],p:[{name:"real_part",detail:"The real coefficient.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"imaginary_part",detail:"The imaginary coefficient.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:"The suffix for the imaginary coefficient, can only be 'i' or 'j'. If omitted, 'i' will be used.",example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"Returns the real coefficient of a complex number.",a:"The real coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:"Returns the imaginary coefficient of a complex number.",a:"The imaginary coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:"Returns the complex conjugate of a number.",a:"The complex conjugate of a number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the conjugate for.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:"Returns absolute value (or modulus) of a complex number.",a:"The absolute value of a complex number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the absolute value of.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"Compare two numeric values, returning 1 if they're equal.",a:"Compare two numeric values.",m:[1,2],p:[{name:"number1",detail:"The first number to compare.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"The second number to compare.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:"Returns the sum of a series of complex numbers.",a:"Sum of a series of complex numbers.",m:[1,255],p:[{name:"value1",detail:"The first complex number or range to add together.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional complex numbers or ranges to add to `value1`.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:"Returns the difference between two complex numbers.",a:"The difference between two complex numbers.",m:[2,2],p:[{name:"first_number",detail:"The complex number to subtract second_number from.",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"second_number",detail:"The complex number to subtract from first_number.",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:"Returns the result of multiplying a series of complex numbers together.",a:"Result of multiplying a series of complex numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"factor2",detail:"Additional complex numbers or ranges to calculate for the product.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:"Returns one complex number divided by another.",a:"One complex number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The complex number to be divided.",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"divisor",detail:"The complex number to divide by.",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:"Returns the opposite of a logical value - `NOT(TRUE)` returns `FALSE`; `NOT(FALSE)` returns `TRUE`.",a:"Returns opposite of provided logical value.",m:[1,1],p:[{name:"logical_expression",detail:"An expression or reference to a cell holding an expression that represents some logical value.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:"Returns the logical value `TRUE`.",a:"Logical value `true`.",m:[0,0],p:[]},{n:"FALSE",t:10,d:"Returns the logical value `FALSE`.",a:"Logical value `false`.",m:[0,0],p:[]},{n:"AND",t:10,d:"Returns true if all of the provided arguments are logically true, and false if any of the provided arguments are logically false.",a:"Logical `and` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that represent logical values.",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"Returns the first argument if it is not an error value, otherwise returns the second argument if present, or a blank if the second argument is absent.",a:"Value if it is not an error, otherwise 2nd argument.",m:[2,2],p:[{name:"value",detail:"The value to return if `value` itself is not an error.",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:"The value the function returns if `value` is an error.",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"Returns one value if a logical expression is `TRUE` and another if it is `FALSE`.",a:"Returns value depending on logical expression.",m:[2,3],p:[{name:"logical_expression",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"The value the function returns if `logical_expression` is `TRUE`.",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"The value the function returns if `logical_expression` is `FALSE`.",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"Returns true if any of the provided arguments are logically true, and false if all of the provided arguments are logically false.",a:"Logical `or` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that evaluate to logical values.",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",a:"Not equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for inequality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"Returns `TRUE` if two specified values are equal and `FALSE` otherwise. Equivalent to the `==` operator.",a:"Equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for equality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"Returns `TRUE` if the first argument is strictly greater than the second, and `FALSE` otherwise. Equivalent to the `>` operator.",a:"Strictly greater than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:"Returns `TRUE` if the first argument is greater than or equal to the second, and `FALSE` otherwise. Equivalent to the `>=` operator.",a:"Greater than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:"Returns `TRUE` if the first argument is strictly less than the second, and `FALSE` otherwise. Equivalent to the `<` operator.",a:"Less than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:"Returns `TRUE` if the first argument is less than or equal to the second, and `FALSE` otherwise. Equivalent to the `<=` operator.",a:"Less than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:"Returns the sum of two numbers. Equivalent to the `+` operator.",a:"Sum of two numbers",m:[2,2],p:[{name:"value1",detail:"The first addend.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The second addend.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"Returns the difference of two numbers. Equivalent to the `-` operator.",a:"Difference of two numbers",m:[2,2],p:[{name:"value1",detail:"The minuend, or number to be subtracted from.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The subtrahend, or number to subtract from `value1`.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"Returns the product of two numbers. Equivalent to the `*` operator.",a:"Product of two numbers",m:[2,2],p:[{name:"factor1",detail:"The first multiplicand.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"The second multiplicand.",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"Returns one number divided by another. Equivalent to the `/` operator.",a:"One number divided by another",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"Returns the concatenation of two values. Equivalent to the `&` operator.",a:"Concatenation of two values",m:[2,2],p:[{name:"value1",detail:"The value to which `value2` will be appended.",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to append to `value1`.",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"Returns a value interpreted as a percentage; that is, `UNARY_PERCENT(100)` equals `1`.",a:"Value interpreted as a percentage.",m:[1,1],p:[{name:"percentage",detail:"The value to interpret as a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"Appends strings to one another.",a:"Appends strings to one another.",m:[1,255],p:[{name:"string1",detail:"The initial string.",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"More strings to append in sequence.",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"Returns the numeric Unicode map value of the first character in the string provided.",a:"Numeric unicode map value of character.",m:[1,1],p:[{name:"string",detail:"The string whose first character's Unicode map value will be returned.",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"Convert a number into a character according to the current Unicode table.",a:"Gets character associated with number.",m:[1,1],p:[{name:"table_number",detail:"The number of the character to look up from the current Unicode table in decimal format.",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"Computes the value of a Roman numeral.",a:"Computes the value of a roman numeral.",m:[1,1],p:[{name:"roman_numeral",detail:"The Roman numeral to format, whose value must be between 1 and 3999, inclusive.",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"Formats a number in Roman numerals.",a:"Formats a number in Roman numerals.",m:[1,1],p:[{name:"number",detail:"The number to format, between 1 and 3999, inclusive.",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"Extracts matching substrings according to a regular expression.",a:"Extracts matching substrings with regular expression.",m:[2,2],p:[{name:"text",detail:"The input text.",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The first part of `text` that matches this expression will be returned.",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"Whether a piece of text matches a regular expression.",a:"Whether a piece of text matches regular expression.",m:[2,2],p:[{name:"text",detail:"The text to be tested against the regular expression.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression to test the text against.",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"Replaces part of a text string with a different text string using regular expressions.",a:"Replaces text with regular expressions.",m:[3,3],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression.  All matching instances in `text` will be replaced.",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"Returns string arguments as text, or the empty string if the value is not text.",a:"String arguments as text.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"Formats a number with a fixed number of decimal places.",a:"Formats number with fixed number of decimal places.",m:[1,3],p:[{name:"number",detail:"The number to format.",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display in the result.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"suppress_separator",detail:"Whether or not to suppress the thousands separator used in some locales (e.g. `1,000` becomes `1000`). Separators will be present if this value is 0 or omitted, and absent otherwise.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"Returns the position at which a string is first found within text where the capitalization of letters matters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, case-sensitive.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"Returns the position at which a string is first found within text counting each double-character as 2.",a:"Position at which a string is first found within text (binary).",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"new"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:'"new year"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.",a:"Concatenates elements of arrays with delimiter.",m:[2,255],p:[{name:"delimiter",detail:"The character or string to place between each concatenated value.",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array1",detail:"The value or values to be appended using `delimiter`.",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array2",detail:"More values to be appended using `delimiter`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"Returns a substring from the beginning of a specified string.",a:"Substring from beginning of specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the left portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the left side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"Returns a substring from the end of a specified string.",a:"A substring from the end of a specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the right portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the right side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"Returns a segment of a string.",a:"A segment of a string.",m:[3,3],p:[{name:"string",detail:"The string to extract a segment from.",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The index from the left of `string` from which to begin extracting. The first character in `string` has the index 1.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"extract_length",detail:"The length of the segment to extract.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"Returns the length of a string.",a:"Length of a string.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"Returns the length of a string in bytes.",a:"Length of a string in bytes.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"Converts a specified string to lowercase.",a:"Converts a specified string to lowercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to lowercase.",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"Converts a specified string to uppercase.",a:"Converts a specified string to uppercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to uppercase.",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"Tests whether two strings are identical.",a:"Tests whether two strings are identical.",m:[2,2],p:[{name:"string1",detail:"The first string to compare",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"The second string to compare",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"Replaces part of a text string with a different text string.",a:"Replaces part of a text string with different text.",m:[4,4],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"position",detail:"The position where the replacement will begin (starting from 1).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"length",detail:"The number of characters in the text to be replaced.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"Returns specified text repeated a number of times.",a:"Specified text repeated a number of times.",m:[2,2],p:[{name:"text_to_repeat",detail:"The character or string to repeat.",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_of_repetitions",detail:"The number of times `text_to_repeat` should appear in the value returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"Returns the position at which a string is first found within text and ignores capitalization of letters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, ignoring case.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"Replaces existing text with new text in a string.",a:"Replaces existing text with new text in a string.",m:[3,4],p:[{name:"text_to_search",detail:"The text within which to search and replace.",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"search_for",detail:"The string to search for within `text_to_search`.",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"replace_with",detail:"The string that will replace `search_for`.",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"occurrence_number",detail:"The instance of `search_for` within `text_to_search` to replace with `replace_with`. By default, all occurrences of `search_for` are replaced; however, if `occurrence_number` is specified, only the indicated instance of `search_for` is replaced.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"Returns the text with the non-printable ASCII characters removed.",a:"Removes non-printable characters from a piece of text.",m:[1,1],p:[{name:"text",detail:"The text whose non-printable characters are to be removed.",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"Converts a number into text according to a specified format.",a:"Formats a number into text.",m:[2,2],p:[{name:"number",detail:"The number, date, or time to format.",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format",detail:"The pattern by which to format the number, enclosed in quotation marks.",example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"Removes leading, trailing, and repeated spaces in text.",a:"Removes space characters.",m:[1,1],p:[{name:"text",detail:"The text or reference to a cell containing text to be trimmed.",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"Converts a string in any of the date, time or number formats that Google Sheets understands into a number.",a:"Converts a date/time/number string into a number.",m:[1,1],p:[{name:"text",detail:"The string containing the value to be converted.",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"Capitalizes each word in a specified string.",a:"Capitalizes each word in a specified string.",m:[1,1],p:[{name:"text_to_capitalize",detail:"The text which will be returned with the first letter of each word in uppercase and all other letters in lowercase.",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"Converts a numeric value to a different unit of measure.",a:"Unit conversion for numbers.",m:[3,3],p:[{name:"value",detail:"The numeric value in `start_unit` to convert to `end_unit`.",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"start_unit",detail:"The starting unit, the unit currently assigned to `value`.",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"end_unit",detail:"The unit of measure into which to convert the argument, `value`.",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"Calculates the sum of the differences of the squares of values in two arrays.",a:"Sum of the differences of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be reduced by the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be subtracted from the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"Calculates the sum of the sums of the squares of values in two arrays.",a:"Sum of the sums of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"Calculates the sum of the squares of differences of values in two arrays.",a:"Sum of the squares of differences.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values that will be reduced by corresponding entries in `array_y`, squared, and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values that will be subtracted from corresponding entries in `array_x`, the result squared, and all such results added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"Transposes the rows and columns of an array or range of cells.",a:"Transposes the rows and columns of an array.",m:[1,1],p:[{name:"array_or_range",detail:"The array or range whose rows and columns will be swapped.",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"Given partial data about a linear trend, fits an ideal linear trend using the least squares method and/or predicts further values.",a:"Fits points to linear trend derived via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general linear form of `y = m*x+b` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"Calculates the frequency distribution of a one-column array into specified classes.",a:"The frequency distribution of array.",m:[2,2],p:[{name:"data",detail:"The array or range containing the values to be counted.",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"classes",detail:"The array or range containing the set of classes.",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"Given partial data about an exponential growth trend, fits an ideal exponential growth trend and/or predicts further values.",a:"Fits points to exponential growth trend.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"Given partial data about a linear trend, calculates various parameters about the ideal linear trend using the least-squares method.",a:"Best-fit linear trend via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"calculate_b",detail:"Given a linear form of `y = m*x+b`, calculates the y-intercept (`b`) if `TRUE`. Otherwise, forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the linear coefficients and the y-intercept (default).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"Given partial data about an exponential growth curve, calculates various parameters about the best fit ideal exponential growth curve.",a:"Best-fit exponential growth curve.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the calculated coefficient and exponents.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"Returns the matrix determinant of a square matrix specified as an array or range.",a:"Matrix determinant of a square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose determinant will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"Returns the multiplicative inverse of a square matrix specified as an array or range.",a:"Multiplicative inverse of square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose multiplicative inverse will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"Calculates the matrix product of two matrices specified as arrays or ranges.",a:"The matrix product of two matrices.",m:[2,2],p:[{name:"matrix1",detail:"The first matrix in the matrix multiplication operation, represented as an array or range.",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"matrix2",detail:"The second matrix in the matrix multiplication operation, represented as an array or range.",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"Calculates the sum of the products of corresponding entries in two equal-sized arrays or ranges.",a:"Sum of products of elements in two arrays.",m:[1,255],p:[{name:"array1",detail:"The first array or range whose entries will be multiplied with corresponding entries in the second such array or range.",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"The second array or range whose entries will be multiplied with corresponding entries in the first such array or range.",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"Checks whether a value is a formula.",a:"Whether a value is a formula.",m:[1,1],p:[{name:"cell",detail:"The cell to be verified as containing a formula.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"Returns the requested information about the specified cell.",a:"Gets information about a cell.",m:[2,2],p:[{name:"info_type",detail:"The type of information requested (see article for available types)",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"The reference to the cell.",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:'Returns the "value not available" error, `#N/A`.',a:"The `#N/A` error.",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"Returns a number corresponding to the error value in a different cell.",a:"Error value of cell (as number).",m:[1,1],p:[{name:"reference",detail:"The cell to find the error number for although you can also provide the error value directly.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"Checks whether the referenced cell is empty.",a:"Whether the referenced cell is empty.",m:[1,1],p:[{name:"value",detail:"Reference to the cell that will be checked for emptiness.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"Checks whether a value is an error other than `#N/A`.",a:"Whether a value is an error other than `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type other than `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"Checks whether a value is an error.",a:"Whether a value is an error.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"Checks whether a value is `TRUE` or `FALSE`.",a:"Whether a value is `true` or `false`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a logical `TRUE` or `FALSE`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"Checks whether a value is the error `#N/A`.",a:"Whether a value is the error `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be compared with the error value `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"Checks whether a value is non-textual.",a:"Whether a value is non-textual.",m:[1,1],p:[{name:"value",detail:"The value to be checked.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"Checks whether a value is a number.",a:"Whether a value is a number.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"Checks whether a value is a valid cell reference.",a:"Whether a value is a valid cell reference.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a cell reference.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"Checks whether a value is text.",a:"Whether a value is text.",m:[1,1],p:[{name:"value",detail:"The value to be verified as text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"Returns a number associated with the type of data passed into the function.",a:"Get the type of a value.",m:[1,1],p:[{name:"value",detail:"The value whose type is to be determined.",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"Returns the argument provided as a number. Text is converted to 0 and errors are returned as-is.",a:"Argument provided as a number.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"Converts a provided number to a date.",a:"Converts a provided number to a date.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a date.",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"Converts a provided date/time, percentage, currency or other formatted numeric value to a pure number without formatting.",a:"Converts any numeric value to a pure number.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a pure number.",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"Converts a provided numeric value to a text value.",a:"Converts a provided numeric value to a text value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to text.",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"Converts a provided number to a dollar value.",a:"Converts a provided number to a dollar value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a dollar value.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"Converts a provided number to a percentage.",a:"Converts a provided number to a percentage.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"Returns a single value from a database table-like array or range using a SQL-like query.",a:"Single value from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"Returns the maximum value selected from a database table-like array or range using a SQL-like query.",a:"Maximum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"Returns the minimum value selected from a database table-like array or range using a SQL-like query.",a:"Minimum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"Returns the average of a set of values selected from a database table-like array or range using a SQL-like query.",a:"Average of a set of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"Counts numeric values selected from a database table-like array or range using a SQL-like query.",a:"Counts values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"Counts values, including text, selected from a database table-like array or range using a SQL-like query.",a:"Counts values and text from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"Returns the product of values selected from a database table-like array or range using a SQL-like query.",a:"Product of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"Returns the standard deviation of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of population sample from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"Returns the standard deviation of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of entire population from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"Returns the sum of values selected from a database table-like array or range using a SQL-like query.",a:"Sum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"Returns the variance of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Variance of population sample from table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"Returns the variance of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Variance of a population from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"Calculate the age based on the Chinese ID number. Support 15 or 18",a:"Get age based on ID number.",m:[1,2],p:[{name:"ID number",example:"A1",detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Deadline",example:'"2017-10-01"',detail:"The deadline or range of age calculation. The default is the current day.",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"Calculate gender based on Chinese ID number. Support 15 or 18",a:"Get gender based on ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"Calculate the birthday based on the Chinese ID number. Support 15 or 18",a:"Get the birthday based on the ID number.",m:[1,2],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Birthday format",example:"0",detail:"Date type, default:0:[1900/01/01], 1:[1900-01-01], 2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"Calculate the province of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the province of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"Calculate the city of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the city of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"Calculate the constellation based on the Chinese ID number. Support 15 or 18",a:"Get the constellation based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"Calculate the zodiac (rat, ox, tiger, rabbit...) based on the Chinese ID number. Support 15 or 18",a:"Get the zodiac according to the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"Verify that the format of the ID card is correct. Support 15 or 18",a:"Verify the correctness of the ID card format.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"Text segmentation. Split a series of words into a series of individual words",a:"Chinese text segmentation.",m:[1,2],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Word segmentation mode",example:"0",detail:"The default is 0[precision mode], 1[full mode], 2[search engine mode].",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"Use tf-idf algorithm for keyword extraction. Identify keywords from a series of text",a:"tf-idf keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"Use TextRank algorithm to extract keywords. Identify keywords from a series of text",a:"TextRank keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"According to the stock code and date, return the corresponding stock closing price of A shares.",a:"Returns the closing price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"According to the stock code and date, return the opening price of stock.",a:"Return the opening price of a shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"According to the stock code and date, return the highest price of stock.",a:"Return the highest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"According to the stock code and date, return the lowest price of stock.",a:"Returns the lowest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"According to the stock code and date, return the corresponding stock trading volume of A shares.",a:"Returns the corresponding stock trading volume of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"According to the stock code and date, return the corresponding stock turnover of A shares.",a:"Returns the corresponding stock turnover of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"Returns whether a value is a date.",a:"Whether a value is a date.",m:[1,1],p:[{name:"value",example:'"1990-01-01"',detail:"The value to be verified as a date.",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"Generate sparklines embedded in the cell to describe the continuous trend of data",a:"Generate sparklines line chart",m:[1,8],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"},{name:"Maximum mark",example:"#fc5c5c",detail:"Identifies the maximum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Minimum mark",example:"#fc5c5c",detail:"Identify the minimum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Mark size",example:"1.5",detail:"The maximum and minimum mark size settings, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"Generate sparklines embedded in the cell area chart, generally used to describe the continuous cumulative value trend of the data",a:"Generate sparklines area chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Fill color",example:"#CCF3F4",detail:"Form an area chart, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"Generate sparklines embedded in the vertical histogram of cells, generally used to describe the size of discrete data",a:"Generate sparklines vertical histogram",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"Generate sparklines, a cumulative vertical histogram embedded in a cell, generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative vertical histogram",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the size of discrete data",a:"Generate sparklines horizontal bar graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"Generate sparklines, a cumulative horizontal bar graph embedded in a cell, which is generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative horizontal bar graph",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the trend of discrete data",a:"Generate sparklines discrete graph",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Segmentation threshold",example:"1",detail:"Discrete graph column color distinction, for example: if the value is 0, blue is greater than 0, red is less than 0, and the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"Above threshold color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Below threshold color",example:"#fc5c5c",detail:"The color setting of the bar below the threshold, the same as the color above the threshold, default #fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"Generate sparklines, a three-state graph embedded in the cell, which is generally used to describe the trend of three situations, such as winning, losing, or drawing.",a:"Generate sparklines three-state graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Zero value bar color",example:"#999",detail:"Zero value bar color setting, representing 0 value color, the same color configuration of the bar, default #999",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"Generate sparklines pie chart embedded in the cell, generally used to describe the proportion of data",a:"Generate sparklines pie chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Rotation angle",example:"0",detail:"The rotation angle of the pie chart, the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"border",example:"0",detail:"Pie chart border size, default is none 0",require:"o",repeat:"n",type:"rangeall"},{name:"Border color",example:"#000",detail:"The border color of the pie chart, the default is #000",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color of the slice can be set in the palette, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"Generate sparklines embedded in the cell box plot, generally used to describe the statistical distribution of the data set",a:"Generate sparklines box plot",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Outlier ratio",example:"1.5",detail:"The threshold range of outliers, if it is 0 or false, it will not be displayed, the default is 1.5 times",require:"o",repeat:"n",type:"rangeall"},{name:"Target value",example:"10",detail:"The target value setting on the box plot, the default is false and does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Point size",example:"1.5",detail:"The radius of the target point and outlier is set, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the task achievement rate",a:"Generating sparklines bullets",m:[2,3],p:[{name:"Target",example:"10",detail:"The numerical value can be calculated effectively for the achieved target value, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"achieved",example:"8",detail:"Only when the value is completed can the value be calculated effectively, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Contrast",example:"12",detail:"Comparative values, such as excess, minimum, and bottom line for awards, can be effectively calculated, such as A1, 100, etc. You can set up to 9 comparison values",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"Support multiple types of pictures in the same cell, each parameter represents a sparklines diagram",a:"Combine sparklines graphs into one cell",m:[1,1],p:[{name:"config",example:"PIESPLINES(A1:A20)",detail:"Sparklines chart settings, such as A1:A20, a completed pie chart, line chart settings, etc.",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"Sorts the rows of a given array or range by the values in one or more columns.",a:"Sorts rows of range by specified column.",m:[1,4],p:[{name:"range",detail:"The data to be sorted.",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_column",detail:"The index of the column in `range` or a range outside of `range` containing the values by which to sort.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"is_ascending",detail:"`TRUE` or `FALSE` indicating whether to sort `sort_column` in ascending order. `FALSE` sorts in descending order.",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_column2",detail:"Additional columns.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.",a:"Filters a range based off provided conditions.",m:[2,3],p:[{name:"range",detail:"The data to be filtered.",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"condition1",detail:"A column or row containing true or false values corresponding to the first column or row of `range`, or an array formula evaluating to true or false.",example:"1",require:"m",repeat:"n",type:"range"},{name:"condition2",detail:"Additional rows or columns containing boolean values `TRUE` or `FALSE` indicating whether the corresponding row or column in `range` should pass through `FILTER`. Can also contain array formula expressions which evaluate to such rows or columns. All conditions must be of the same type (row or column). Mixing row conditions and column conditions is not permitted.",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range.",a:"Unique rows in the provided source range.",m:[1,3],p:[{name:"range",detail:"The data to filter by unique entries.",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[Option] - Logical value, indicating how to compare; by row = FALSE() or omitted; by column = TRUE().",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[Option] - Logical value, only one occurrence in the unique value is returned = TRUE(); including all unique values = FALSE() or omitted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"Returns a grid of random numbers between 0 inclusive and 1 exclusive. The grid size will match the provided rows and columns arguments. If neither rows nor columns are provided, then the grid will be size 1 x 1.",a:"Returns a grid of random numbers.",m:[0,2],p:[{name:"rows",detail:"The number of rows to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"Returns a grid of sequential numbers starting at a specified start value and  increasing by a specified step size. By default, the sequence starts at and  increases by 1.",a:"Returns a grid of sequential numbers.",m:[1,4],p:[{name:"rows",detail:"The number of rows in the function's resulting grid.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns in the function's resulting grid. If omitted, the result grid will have 1 column.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"The number, at which to start the sequence. If omitted, the sequence will start at 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"The amount each value in the sequence will differ by. If omitted, each value will differ by 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"Evaluate a formula or expression expressed in words and return the result",a:"Evaluate according to literal formula or expression.",m:[1,1],p:[{name:"expression",example:'"A1+5*2^2"',detail:"Formula or expression",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:"Text color",chooseColor:"choose color",resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:"Fill color",border:"Border",borderStyle:"Border style",mergeCell:"Merge cells",chooseMergeType:"Choose merge type",horizontalAlign:"Horizontal align",verticalAlign:"Vertical align",alignment:"Alignment",textWrap:"Text wrap",textWrapMode:"Text wrap mode",textRotate:"Text rotate",textRotateMode:"Text rotate mode",freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",postil:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataVerification:"Data verification",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print"},alternatingColors:{applyRange:"Apply to range",selectRange:"Select a data range",header:"Header",footer:"Footer",errorInfo:"Cannot perform this operation on multiple selection areas, please select a single area and try again",textTitle:"Format style",custom:"CUSTOM",close:"close",selectionTextColor:"Click to select text color",selectionCellColor:"Click to select cell color",removeColor:"Remove alternating colors",colorShow:"color",currentColor:"Current",tipSelectRange:"Please select the range of alternating colors",errorNoRange:"No range is selected",errorExistColors:"Alternating colors already exist and cannot be edited"},button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert"},paint:{start:"Paint format start",end:"ESC",tipSelectRange:"Please select the range to be copied",tipNotMulti:"Cannot perform this operation on multiple selection ranges"},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading",copy:"Copy",return:"Exit",rename:"Rename",tips:"WorkBook rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}${totalPage} pagecurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}${totalPage} pageAll data displayed"},currencyDetail:{RMB:"RMB",USdollar:"US dollar",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"},defaultFmt:[{text:"Automatic",value:"General",example:""},{text:"Plain text",value:"@",example:""},{text:"",value:"split",example:""},{text:"Number",value:"##0.00",example:"1000.12"},{text:"Percent",value:"#0.00%",example:"12.21%"},{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"Accounting",value:"(0.00)",example:"(1200.09)"},{text:"Currency",value:"0.00",example:"1200.09"},{text:"",value:"split",example:""},{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"Time 24H",value:"hh:mm",example:"15:00"},{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"Date time 24 H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"Custom formats",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],fontFamily:{MicrosoftYaHei:"YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana"],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3},border:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{mergeAll:"Merge all",mergeV:"Vertically",mergeH:"Horizontally",mergeCancel:"Unmerge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},align:{left:"left",center:"center",right:"right",top:"Top",middle:"Middle",bottom:"Bottom"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},rotation:{none:"None",angleup:"Tilt Up",angledown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},freezen:{default:"Freeze",freezenRow:"First Row",freezenColumn:"First Column",freezenRC:"Both",freezenRowRange:"Freezen row range",freezenColumnRange:"Freezen column range",freezenRCRange:"Freezen both range",freezenCancel:"Cancel",noSeletionError:"No Range to be selected"},sort:{asc:"Ascending ",desc:"Descending ",custom:"Custom sort",hasTitle:"Data has a header row",sortBy:"Sort by",addOthers:"Add another sort column",close:"close",confirm:"sort",columnOperation:"Column",secondaryTitle:"then by",sortTitle:"Sort range",sortRangeTitle:"Sort range from",sortRangeTitleTo:"to",noRangeError:"Cannot perform this operation on multiple selection areas, please select a single range and try again",mergeError:"There are merged cells in the selection, this operation cannot be performed!"},filter:{filter:"create filter",sortByAsc:"Sort A-Z",sortByDesc:"Sort Z-A",filterByColor:"Filter by color",filterByCondition:"Filter by condition",filterByValues:"Filter by values",filiterInputNone:"None",filiterInputTip:"Enter filter value",filiterRangeStartTip:"Value for formula",filiterRangeEndTip:"Value for formula",filterValueByAllBtn:"Check all",filterValueByClearBtn:"Clear",filterValueByInverseBtn:"Inverse",filterValueByTip:"filter By Values",filterConform:"Confirm",filterCancel:"Cancel",clearFilter:"Clear filter",conditionNone:"None",conditionCellIsNull:"Is empty",conditionCellNotNull:"Is not empty",conditionCellTextContain:"Text contains",conditionCellTextNotContain:"Text does not contain",conditionCellTextStart:"Text starts with",conditionCellTextEnd:"Text ends with",conditionCellTextEqual:"Text is exactly",conditionCellDateEqual:"Date is",conditionCellDateBefore:"Date is before",conditionCellDateAfter:"Date is after",conditionCellGreater:"Greater than",conditionCellGreaterEqual:"Greater than or equal to",conditionCellLess:"Less than",conditionCellLessEqual:"Less than or equal to",conditionCellEqual:"Is equal to",conditionCellNotEqual:"Is not equal to",conditionCellBetween:"Is between",conditionCellNotBetween:"Is not between",filiterMoreDataTip:"Big amount of data! please wait",filiterMonthText:"Month",filiterYearText:"Year",filiterByColorTip:"Filter by cell color",filiterByTextColorTip:"Filter by font color",filterContainerOneColorTip:"This column contains only one color",filterDateFormatTip:"Date format",valueBlank:"(Null)",mergeError:"There are merged cells in the filter selection, this operation cannot be performed!"},rightclick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},comment:{insert:"Insert",edit:"Edit",delete:"Delete",showOne:"Show/Hide",showAll:"Show/Hide All"},screenshot:{screenshotTipNoSelection:"Please select the scope of the screenshot",screenshotTipTitle:"Warning",screenshotTipHasMerge:"This operation cannot be performed on merged cells",screenshotTipHasMulti:"This operation cannot be performed on multiple selection regions",screenshotTipSuccess:"Successful",screenshotImageName:"Screenshot",downLoadClose:"Close",downLoadCopy:"Copy to clipboard",downLoadBtn:"Download",browserNotTip:"not supported by IE browser!",rightclickTip:'Please right-click "copy" on the picture',successTip:'Successfully (if pasting fails, please right-click on the image to "copy image")'},splitText:{splitDelimiters:"Delimiters",splitOther:"Other",splitContinueSymbol:"Consecutive separators are treated as a single",splitDataPreview:"Preview",splitTextTitle:"Split text",splitConfirmToExe:"There is already data here, do you want to replace it?",tipNoMulti:"Cannot perform this operation on multiple selection areas, please select a single area and try again",tipNoMultiColumn:"Only one column of data can be converted at a time. The selected area can have multiple rows but not multiple columns. Please try again after selecting a single column range"},imageText:{imageSetting:"Image setting",close:"Close",conventional:"Conventional",moveCell1:"Move and resize cells",moveCell2:"Move and do not resize the cell",moveCell3:"Do not move and resize the cell",fixedPos:"Fixed position",border:"Border",width:"Width",radius:"Radius",style:"Style",solid:"Solid",dashed:"Dashed",dotted:"Dotted",double:"Double",color:"Color"},punctuation:{tab:"Tab",semicolon:"semicolon",comma:"comma",space:"space"},findAndReplace:{find:"Find",replace:"Replace",goto:"Go to",location:"Location",formula:"Formula",date:"Date",number:"Number",string:"String",error:"Error",condition:"Condition",rowSpan:"Row span",columnSpan:"Column span",locationExample:"Location",lessTwoRowTip:"Please select at least two rows",lessTwoColumnTip:"Please select at least two columns",findTextbox:"Find Content",replaceTextbox:"Replace Content",regexTextbox:"Regular Expression",wholeTextbox:"Whole word",distinguishTextbox:"Case sensitive",allReplaceBtn:"Replace All",replaceBtn:"Replace",allFindBtn:"Find All",findBtn:"Find next",noFindTip:"The content was not found",modeTip:"This operation is not available in this mode",searchTargetSheet:"Sheet",searchTargetCell:"Cell",searchTargetValue:"Value",searchInputTip:"Please enter the search content",noReplceTip:"There is nothing to replace",noMatchTip:"No match found",successTip:"${xlength} items found",locationConstant:"Constant",locationFormula:"Formula",locationDate:"Date",locationDigital:"Number",locationString:"String",locationBool:"Logical",locationError:"Error",locationNull:"Null",locationCondition:"Conditional format",locationRowSpan:"Row span",locationColumnSpan:"Column span",locationTiplessTwoRow:"Please select at least two rows",locationTiplessTwoColumn:"Please select at least two columns",locationTipNotFindCell:"Cell not found"},sheetconfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNamecannotIsEmptyError:"Sheet name cannot be empty"},conditionformat:{conditionformat_greaterThan:"Conditionformat-GreaterThan",conditionformat_greaterThan_title:"Format cells greater than",conditionformat_lessThan:"Conditionformat-LessThan",conditionformat_lessThan_title:"Format cells smaller than",conditionformat_betweenness:"Conditionformat-Betweenness",conditionformat_betweenness_title:"Format cells with values between",conditionformat_equal:"Conditionformat-Equal",conditionformat_equal_title:"Format cells equal to",conditionformat_textContains:"Conditionformat-TextContains",conditionformat_textContains_title:"Format cells containing the following text",conditionformat_occurrenceDate:"Conditionformat-OccurrenceDate",conditionformat_occurrenceDate_title:"Format cells containing the following dates",conditionformat_duplicateValue:"Conditionformat-DuplicateValue",conditionformat_duplicateValue_title:"Format cells containing the following types of values",conditionformat_top10:"Conditionformat-Top10",conditionformat_top10_percent:"Conditionformat-Top10%",conditionformat_top10_title:"Format the cells with the highest value",conditionformat_last10:"Conditionformat-Last10",conditionformat_last10_percent:"Conditionformat-Last10%",conditionformat_last10_title:"Format the cells with the smallest value",conditionformat_AboveAverage:"Conditionformat-AboveAverage",conditionformat_AboveAverage_title:"Format cells above average",conditionformat_SubAverage:"Conditionformat-SubAverage",conditionformat_SubAverage_title:"Format cells below average",rule:"Rule",newRule:"New rule",editRule:"Edit rule",deleteRule:"Delete rule",deleteCellRule:"Delete cell rule",deleteSheetRule:"Delete sheet rule",manageRules:"Management rules",showRules:"Show its formatting rules",highlightCellRules:"Highlight cell rules",itemSelectionRules:"Item selection rules",conditionformatManageRules:"Conditional Formatting Rule Manager",format:"Format",setFormat:"Set format",setAs:"Set as",setAsByArea:"For the selected area, set to",applyRange:"Apply range",selectRange:"Select application range",selectRange_percent:"Percentage of selected range",selectRange_average:"Average value of selected range",selectRange_value:"Value in the selected range",pleaseSelectRange:"Please select application range",selectDataRange:"Select data range",selectCell:"select cell",pleaseSelectCell:"Please select cell",pleaseSelectADate:"Please select a date",pleaseEnterInteger:"Please enter an integer between 1 and 1000",onlySingleCell:"Only a single cell can be referenced",conditionValueCanOnly:"The condition value can only be a number or a single cell",ruleTypeItem1:"Format all cells based on their respective values",ruleTypeItem2:"Only format cells that contain",ruleTypeItem2_title:"Only for cells that meet the following conditions",ruleTypeItem3:"Format only the top or bottom numbers",ruleTypeItem3_title:"Is the value in the following ranking",ruleTypeItem4:"Format only values above or below the average",ruleTypeItem4_title:"Is a value that satisfies the following conditions",ruleTypeItem5:"Format only unique or repeated values",ruleTypeItem6:"Use formulas to determine which cells to format",formula:"Formula",textColor:"Text color",cellColor:"Cell color",confirm:"Confirm",confirmColor:"Confirm color",cancel:"Cancel",close:"Close",clearColorSelect:"Clear color select",sheet:"Sheet",currentSheet:"Current Sheet",dataBar:"data bar",dataBarColor:"data bar color",gradientDataBar_1:"Blue-white gradient data bar",gradientDataBar_2:"Green-white gradient data bar",gradientDataBar_3:"Red-white gradient data bar",gradientDataBar_4:"Orange-white gradient stripes",gradientDataBar_5:"Light blue-white gradient stripes",gradientDataBar_6:"Purple-white gradient data bar",solidColorDataBar_1:"Blue data bar",solidColorDataBar_2:"Green data bar",solidColorDataBar_3:"Red data bar",solidColorDataBar_4:"Orange data bar",solidColorDataBar_5:"Light blue data bar",solidColorDataBar_6:"Purple data bar",colorGradation:"color gradation",colorGradation_1:"Green-yellow-red color gradation",colorGradation_2:"Red-yellow-green color gradation",colorGradation_3:"Green-white-red color gradation",colorGradation_4:"Red-white-green color gradation",colorGradation_5:"Blue-white-red color gradation",colorGradation_6:"Red-white-blue color gradation",colorGradation_7:"White-red color gradation",colorGradation_8:"Red-white color gradation",colorGradation_9:"Green-white color gradation",colorGradation_10:"White-green color gradation",colorGradation_11:"Green-yellow color gradation",colorGradation_12:"Yellow-green color gradation",icons:"icons",pleaseSelectIcon:"Please click to select a group of icons:",cellValue:"Cell value",specificText:"Specific text",occurrence:"Date",greaterThan:"Greater than",lessThan:"Less than",between:"Between",equal:"Equal",in:"In",between2:"",contain:"Contain",textContains:"Text contains",duplicateValue:"Duplicate value",uniqueValue:"Unique value",top:"Top",top10:"Top 10",top10_percent:"Top 10%",last:"Last",last10:"Last 10",last10_percent:"Last 10%",oneself:"",above:"Above",aboveAverage:"Above average",below:"Below",belowAverage:"Below average",all:"All",yesterday:"YTD",today:"Today",tomorrow:"Tomorrow",lastWeek:"Last week",thisWeek:"This week",lastMonth:"Last month",thisMonth:"This month",lastYear:"Last year",thisYear:"This year",last7days:"Last 7 days",last30days:"Last 30 days",next7days:"Next 7 days",next30days:"Next 30 days",next60days:"Next 60 days",chooseRuleType:"Choose rule type",editRuleDescription:"Edit rule description",newFormatRule:"New format rule",editFormatRule:"Edit format rule",formatStyle:"Style",fillType:"Fill",color:"Color",twocolor:"Two-color",tricolor:"Tricolor",multicolor:"Multi color",grayColor:"Gray color",gradient:"Gradient",solid:"Solid",maxValue:"Max value",medianValue:"Median value",minValue:"Min value",direction:"Direction",threeWayArrow:"Three-way arrow",fourWayArrow:"Four-way arrow",fiveWayArrow:"Five-way arrow",threeTriangles:"Three triangles",shape:"Shape",threeColorTrafficLight:"Three-color traffic light",fourColorTrafficLight:"Four-color traffic light",threeSigns:"Three signs",greenRedBlackGradient:"Green-red-black gradient",rimless:"Rimless",bordered:"Bordered",mark:"Mark",threeSymbols:"Three symbols",tricolorFlag:"Tricolor flag",circled:"Circled",noCircle:"No circle",grade:"Grade",grade4:"4 Grade",grade5:"5 Grade",threeStars:"3 Stars",fiveQuadrantDiagram:"Five-quadrant diagram",fiveBoxes:"5 Boxes"},insertLink:{linkText:"Text",linkType:"Link type",external:"External link",internal:"Internal link",linkAddress:"Link address",linkSheet:"Worksheet",linkCell:"Cell reference",linkTooltip:"Tooltip",placeholder1:"Please enter the web link address",placeholder2:"Please enter the cell to be quoted, example A1",placeholder3:"Please enter the prompt content",tooltipInfo1:"Please enter a valid link",tooltipInfo2:"Please enter the correct cell reference"},dataVerification:{cellRange:"Cell range",selectCellRange:"Click to select a cell range",selectCellRange2:"Please select a range of cells",verificationCondition:"Verification condition",dropdown:"drop-down list",checkbox:"Checkbox",number:"Number",number_integer:"Number-integer",number_decimal:"Number-decimal",text_content:"Text-content",text_length:"Text-length",date:"Date",validity:"Effectiveness",placeholder1:"Please enter the options, separated by commas, such as 1,2,3,4,5",placeholder2:"Please enter content",placeholder3:"Numeric value, such as 10",placeholder4:"Please enter the specified text",placeholder5:"Please enter the prompt displayed when the cell is selected",selected:"Selected",notSelected:"Not selected",between:"Between",notBetween:"Not between",equal:"Equal",notEqualTo:"Not equal to",moreThanThe:"More than the",lessThan:"Less than",greaterOrEqualTo:"Greater or equal to",lessThanOrEqualTo:"Less than or equal to",include:"Include",exclude:"Exclude",earlierThan:"Earlier than",noEarlierThan:"No earlier than",laterThan:"Later than",noLaterThan:"No later than",identificationNumber:"Identification number",phoneNumber:"Phone number",remote:"Automatic remote acquisition option",prohibitInput:"Prohibit input when input data is invalid",hintShow:"Show prompt when the cell is selected",deleteVerification:"Delete verification",tooltipInfo1:"The drop-down list option cannot be empty",tooltipInfo2:"Checkbox content cannot be empty",tooltipInfo3:"The value entered is not a numeric type",tooltipInfo4:"The value 2 cannot be less than the value 1",tooltipInfo5:"The text content cannot be empty",tooltipInfo6:"The value entered is not a date type",tooltipInfo7:"Date 2 cannot be less than date 1"},formula:{sum:"Sum",average:"Average",count:"Count",max:"Max",min:"Min",ifGenerate:"If formula generator",find:"Learn more",tipNotBelongToIf:"This cell function does not belong to the if formula!",tipSelectCell:"Please select the cell to insert the function",ifGenCompareValueTitle:"Comparison value",ifGenSelectCellTitle:"Click to select cell",ifGenRangeTitle:"Range",ifGenRangeTo:"to",ifGenRangeEvaluate:"Range evaluate",ifGenSelectRangeTitle:"Click to select range",ifGenCutWay:"Partition way",ifGenCutSame:"Same Partition value",ifGenCutNpiece:"Partition by N",ifGenCutCustom:"Custom",ifGenCutConfirm:"Confirm",ifGenTipSelectCell:"Select cells",ifGenTipSelectCellPlace:"Please select cells",ifGenTipSelectRange:"Select range",ifGenTipSelectRangePlace:"Please select range",ifGenTipNotNullValue:"The comparison value cannot be empty!",ifGenTipLableTitile:"Label",ifGenTipRangeNotforNull:"The range cannot be empty!",ifGenTipCutValueNotforNull:"The partition value cannot be empty!",ifGenTipNotGenCondition:"No conditions are available for generation!"},formulaMore:{valueTitle:"Value",tipSelectDataRange:"Select data range",tipDataRangeTile:"Data range",findFunctionTitle:"Search function",tipInputFunctionName:"Function name or brief description of function",Array:"Array",Database:"Database",Date:"Date",Engineering:"Engineering",Filter:"Filter",Financial:"Financial",luckysheet:"Luckysheet",other:"Other",Logical:"Logical",Lookup:"Lookup",Math:"Math",Operator:"Operator",Parser:"Parser",Statistical:"Statistical",Text:"Text",dataMining:"Data Mining",selectFunctionTitle:"Select a function",calculationResult:"Result",tipSuccessText:"Success",tipParamErrorText:"Parameter type error",helpClose:"Close",helpCollapse:"Collapse",helpExample:"Example",helpAbstract:"Abstract",execfunctionError:"Error in the formula",execfunctionSelfError:"The formula cannot refer to its own cell",execfunctionSelfErrorResult:"The formula cannot refer to its own cell, which will lead to inaccurate calculation results",allowRepeatText:"Repeat",allowOptionText:"Option",selectCategory:"Or select a category"},drag:{noMerge:"Cannot perform this operation on merged cells",affectPivot:"This change cannot be made to the selected cell because it will affect the pivot table!",noMulti:"Cannot perform this operation on multiple selection areas, please select a single area",noPaste:"Unable to paste this content here, please select a cell in the paste area and try to paste again",noPartMerge:"Cannot perform this operation on partially merged cells",inputCorrect:"Please enter the correct value",notLessOne:"The number of rows and columns cannot be less than 1",offsetColumnLessZero:"The offset column cannot be negative!",pasteMustKeybordAlert:": Ctrl + C , Ctrl + V , Ctrl + X ",pasteMustKeybordAlertHTMLTitle:"",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;"},pivotTable:{title:"Pivot Table",closePannel:"Close",editRange:"Range",tipPivotFieldSelected:"Select the fields",tipClearSelectedField:"Clear all fields",btnClearSelectedField:"Clear",btnFilter:"Filter",titleRow:"Row",titleColumn:"Column",titleValue:"Value",tipShowColumn:"Statistics fields are displayed as columns",tipShowRow:"Statistics fields are displayed as rows",titleSelectionDataRange:"Select range",titleDataRange:"Data range",valueSum:"SUM",valueStatisticsSUM:"Sum",valueStatisticsCOUNT:"Count",valueStatisticsCOUNTA:"Count A",valueStatisticsCOUNTUNIQUE:"Count Unique",valueStatisticsAVERAGE:"Average",valueStatisticsMAX:"Max",valueStatisticsMIN:"Min",valueStatisticsMEDIAN:"Median",valueStatisticsPRODUCT:"Product",valueStatisticsSTDEV:"Stdev",valueStatisticsSTDEVP:"Stdevp",valueStatisticslet:"Var",valueStatisticsVARP:"VarP",errorNotAllowEdit:"This operation is prohibited in non-editing mode!",errorNotAllowMulti:"Cannot perform this operation on multiple selection areas, please select a single range and try again",errorSelectRange:"Please select the range of the new pivot table",errorIsDamage:"The source data of this pivot table is corrupted!",errorNotAllowPivotData:"Cannot select pivot table as source data!",errorSelectionRange:"Selection failed, wrong input range!",errorIncreaseRange:"Please expand the selected range!",titleAddColumn:"Add column to pivot table",titleMoveColumn:"Move the column to the white box below",titleClearColumnFilter:"Clear the filter for this column",titleFilterColumn:"Filter",titleSort:"Sort",titleNoSort:"No sort",titleSortAsc:"ASC",titleSortDesc:"DESC",titleSortBy:"Sort by",titleShowSum:"Show total",titleStasticTrue:"Yes",titleStasticFalse:"No"},dropCell:{copyCell:"Copy",sequence:"Sequence",onlyFormat:"Only format",noFormat:"Not format",day:"Day",workDay:"Work Day",month:"Month",year:"Year",chineseNumber:"Chinese numbers"},imageCtrl:{borderTile:"Image border color",borderCur:"Color"},protection:{protectiontTitle:"Protection",enterPassword:"Enter a password (optional)",enterHintTitle:"Prompt when editing is prohibited (optional)",enterHint:"The cell or chart you are trying to change is in a protected worksheet. If you want to change it, please unprotect the worksheet. You may need to enter a password",swichProtectionTip:"Protect the sheet and contents of locked cells",authorityTitle:"Allow users of this sheet to:",selectLockedCells:"Select locked cells",selectunLockedCells:"Select unlocked cells",formatCells:"Format cells",formatColumns:"Format columns",formatRows:"Format rows",insertColumns:"Insert columns",insertRows:"Insert rows",insertHyperlinks:"Insert hyperlinks",deleteColumns:"Delete columns",deleteRows:"Delete rows",sort:"Sort",filter:"Filter",usePivotTablereports:"Use Pivot Table reports",editObjects:"Edit objects",editScenarios:"Edit scenarios",allowRangeTitle:"Allow users of range to:",allowRangeAdd:"New...",allowRangeAddTitle:"Title",allowRangeAddSqrf:"Reference",selectCellRange:"Click to select a cell range",selectCellRangeHolder:"Cell range",allowRangeAddTitlePassword:"Password",allowRangeAddTitleHint:"Prompt",allowRangeAddTitleHintTitle:"Prompt when a password is set (optional)",allowRangeAddtitleDefault:"Input range name",rangeItemDblclick:"Double click to edit",rangeItemHasPassword:"Has password",rangeItemErrorTitleNull:"Title is null",rangeItemErrorRangeNull:"Reference is null",rangeItemErrorRange:"Reference is error",validationTitle:"Password validation",validationTips:"Need to enter a password to unlock the protection of the worksheet",validationInputHint:"Enter a password",checkPasswordNullalert:"Password is required!",checkPasswordWrongalert:"Incorrect password, please try again!",checkPasswordSucceedalert:"Unlock Succeed!",defaultRangeHintText:"The cell is being password protected.",defaultSheetHintText:"The cell or chart is in a protected worksheet. To make changes, please unprotect the worksheet. You may need to enter a password"},cellFormat:{cellFormatTitle:"Format cells",protection:"Protection",locked:"Locked",hidden:"Hidden",protectionTips:"To lock cells or hide formulas, protect the worksheet. On the toolbar, Click Protect Sheet Button",tipsPart:"Partial checked",tipsAll:"All checked",selectionIsNullAlert:"Selection is required!",sheetDataIsNullAlert:"error, Data is none!"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Pagebreakpreview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},edit:{typing:"typing"},websocket:{success:"WebSocket connection success",refresh:"An error occurred in the WebSocket connection, please refresh the page!",wait:"An error occurred in the WebSocket connection, please be patient!",close:"WebSocket connection closed",contact:"Server communication error occurred, please refresh the page and try again, if not, please contact the administrator!",support:"The current browser does not support WebSocket"}},zh:{functionlist:[{n:"SUMIF",t:0,d:"",a:"",m:[2,3],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:`

?*(~)~?~*

=><`,example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"",a:"",m:[1,1],p:[{name:"value",detail:"",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"1",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11-11",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:" x  (0,0)  (`x`,`y`) ",a:" x  (0,0)  (`x`,`y`) ",m:[2,2],p:[{name:"x",detail:"xx",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"xy",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

ISEVENTRUEFALSE`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

ISODDTRUEFALSE`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:" e",a:" e",m:[1,1],p:[{name:"",detail:` e 

`,example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"",a:"",m:[1,2],p:[{name:"",detail:"",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"10",a:"10",m:[1,1],p:[{name:"",detail:`10

`,example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:", ",a:"",m:[2,2],p:[{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

`,example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - 1",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"",a:"",m:[2,2],p:[{name:"n",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"",a:"",m:[2,256],p:[{name:"",detail:`

1AVERAGE

2COUNT

3COUNTA

4MAX

5MIN

6PRODUCT

7STDEV

8STDEVP

9SUM

10VAR

11VARP

210112102COUNT110VAR`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"2",detail:"[] - ",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:`

?*(~)~?~*

=>>=<<=`,example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"0101",a:"0101",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"",a:"",m:[1,1],p:[{name:"z",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

`,example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:" e (~2.718) ",a:" e (~2.718) ",m:[1,1],p:[{name:"",detail:"e",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"14 PI ",a:"14 PI ",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

0`,example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:" 0",a:" 0",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:" xnm  a a1xn + a2x(n+m) + ... + aix(n+(i-1)m) i  a ",a:" xnm  a",m:[4,4],p:[{name:"x",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"x",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"x",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"-110",a:"",m:[1,1],p:[{name:"",detail:"",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

SQRT  #NUM! `,example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:" PI ",a:" PI ",m:[1,1],p:[{name:"",detail:` PI 

SQRTPI  #NUM! `,example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:" e",a:" e",m:[1,1],p:[{name:"",detail:` () 

`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"",a:"",m:[1,2],p:[{name:"",detail:"",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`[ - 0] - 



TRUNC0`,example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

0`,example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:`

`,example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"",a:"",m:[3,257],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2, 2...",detail:"[  ] - ",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"",a:"",m:[2,256],p:[{name:"1",detail:"1",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2, 2...",detail:"[  ] - ",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2 ... 30",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"  HYPGEOM.DIST ",a:"",m:[5,5],p:[{name:"Sample_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_sample",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"Population_s",detail:"",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_pop",detail:"",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

 cumulative  TRUE() HYPGEOM.DIST 

 FALSE()`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:" Y  (x=0)  y ",a:" Y  (x=0)  y ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:" n n ",a:" n ",m:[2,2],p:[{name:"",detail:"",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:`

n4LARGE4`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2,",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"",a:"",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[ -  (FALSE()) ] - data",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"",a:"",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[ -  (FALSE()) ] - data",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"01",a:"01",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[ -  3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"01",a:"01",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[ -  3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:" x  y ",a:"",m:[3,3],p:[{name:"x",detail:"x",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"y",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"x",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"x",detail:"WEIBULL ",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:`Weibull 

alpha  0`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"beta",detail:`Weibull 

beta  0`,example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"TRUE() FALSE() ",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"",a:"",m:[3,3],p:[{name:"alpha",detail:`

 100*(1 - alpha)% alpha  0.05 95%`,example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"size",detail:"",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:" r",a:" r",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:" Lambda ",a:" Lambda ",m:[3,3],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:" lambda ",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"",a:"",m:[2,3],p:[{name:"criteria_range",detail:" criterion ",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:` criteria_range 

""  1  "="  "=1"

">1"

">=1"

"<1"

"<=1"

"<>1""<>"`,example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"[] -  criteria_range ",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"",a:"",m:[2,255],p:[{name:"average_range",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:" criterion1 ",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:" criteria_range1 ",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2, criterion2, ...",detail:"[] - ",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"",a:"",m:[2,2],p:[{name:"number",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_chosen",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"",detail:`

01`,example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:" K K  0  1  0  1",a:" K K  0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1  0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:" K K  0  1  0  1",a:" K K  0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1  0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"(Pearson) r",a:"(Pearson) r",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"  0 1",a:"  0 1",m:[1,1],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:" 0 1",a:" 0 1",m:[2,2],p:[{name:"z",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

 TRUE()

 FALSE()`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"x",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

 TRUE()

 FALSE()`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_f",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_s",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

 TRUE()

 FALSE()`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:" x ",a:" x ",m:[3,3],p:[{name:"probability",detail:" 0  1  0  1",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:" x ",a:" x ",m:[4,4],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

 TRUE()

 FALSE()`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:" z  P ",a:" z  P ",m:[2,3],p:[{name:"array",detail:" x ",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"sigma",detail:"[] -  ",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"",a:"",m:[3,4],p:[{name:"x_range",detail:" x ",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:" x_range ",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"upper_limit",detail:`[ - ] - 

PROB`,example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:`

125%

250%

375%`,example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:`

00%

125%

250%

375%

4100%`,example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"",a:"",m:[3,3],p:[{name:"x",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

 TRUE() x x

 FALSE() x `,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"(Pearson) r ",a:"(Pearson) r ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:" t ",a:" t ",m:[3,3],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:`

 cumulative  TRUE() HYPGEOM.DIST 

 FALSE()`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:` t 

 0  1`,example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:`



 1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:` t 

 0 1`,example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:`



 1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-",a:"t-",m:[4,4],p:[{name:"array1",detail:" t ",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:" t ",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:`

 1

 2`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:` t 

 1

 2

3`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:" x F  Fisher-Snedecor  Snedecor F ",a:" x",m:[4,4],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:` FALSE

 TRUE()F.DIST 

 FALSE()F.DIST `,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"xF Fisher-SnedecorSnedecor F",a:"x",m:[3,3],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"0",a:"",m:[1,255],p:[{name:"value1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:" x  y ",a:" x  y ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"",a:"",m:[3,3],p:[{name:"x",detail:"",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:" k ",a:" k ",m:[2,2],p:[{name:"array",detail:" k ",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"",a:"",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"   ",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"",a:"",m:[3,4],p:[{name:"",detail:' 42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"VLOOKUP ",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:` 1

 1  #VALUE! `,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`[ TRUE() ] -  FALSE()

 FALSE FALSE #N/A

 TRUE  #N/A`,example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"",a:"",m:[3,4],p:[{name:"",detail:'42"Cats"I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:`1

1#VALUE!`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`[ - TRUE()] - 

TRUE#N/A

TRUE

FALSE#N/A`,example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"",a:"",m:[2,3],p:[{name:"",detail:'42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:" | ",detail:" LOOKUP ",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"[  ] - ",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"",a:"",m:[2,5],p:[{name:"row_num",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"A1",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"abs_num",detail:`[ - 1] - 

1 $A$1

2 A$1

3 $A1

4 A1`,example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"A1",detail:"[ - TRUE()] - A1(TRUE)R1C1(FALSE)",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet_text",detail:"[ - ] - ",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"",a:"",m:[1,2],p:[{name:"ref_text",detail:"",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"A1",detail:"[ - TRUE()] - A1(TRUE)R1C1(FALSE)",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"",a:"",m:[0,1],p:[{name:"reference",detail:`[ - ] - 

`,example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:" `A=1` ",a:" `A=1` ",m:[0,1],p:[{name:"reference",detail:`[ - ] - A1

`,example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"",a:"",m:[3,5],p:[{name:"reference",detail:"",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:`

`,example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:`

`,example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"",a:"",m:[2,3],p:[{name:"lookup_value",detail:" lookup_array ",example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"lookup_array",detail:`

1MATCH#N/A!`,example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:`[ - 1] - 

1MATCH

0

-1MATCH`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"",a:"",m:[2,3],p:[{name:"array",detail:"",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:"",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"",a:"",m:[2,254],p:[{name:"data_field",detail:`

`,example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"pivot_table",detail:"",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"field1",detail:"[] - ",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"item1",detail:"[] -  1 ",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"",a:"",m:[2,255],p:[{name:"index_num",detail:`

#VALUE!`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"[] - ",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"",a:"",p:[{name:"",detail:`

http://https://mailto:aim:ftp://gopher://telnet://news://

http://`,example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:`[ - ] - 



("")`,example:'"Google"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:`0 32767 

 23  24`,example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`0 32767 

 59 `,example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`0 32767 

 59 `,example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"24",a:"24",m:[1,1],p:[{name:"time_text",detail:"",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"/",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"  0 59 ",a:"  0 59 ",m:[1,1],p:[{name:"",detail:"//",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"//",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"//",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"",a:"",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"",a:"",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:`[] - 

NDATEDATEVALUETO_DATE`,example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"",a:"",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:`[ - 1] - 
0110000011
1 =/2 =/7 =/11 =12 =17 =`,example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:`[  ] - 
NDATEDATEVALUETO_DATE`,example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:" ISO ",a:" ISO ",m:[1,1],p:[{name:"date",detail:"-",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"",a:"",m:[1,2],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[ -  1 ] - 1=2=",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"",a:"",m:[1,2],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:`[ -  1] -  (= 1) 

 1 1 7

 2 1 7

 3 0 6`,example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"",a:"",m:[1,1],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"",a:"",m:[2,2],p:[{name:"end_date",detail:"",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"360",a:"360",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:`[ - FALSE()] - 

FALSE -  (NASD) 303030

TRUE - 3130`,example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"",a:"",m:[3,3],p:[{name:"year",detail:`

 0 1899  1900 

 1900  9999 

 0  10000  #NUM!`,example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:`

 month  12 month 

 month  1month  1 `,example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:`

 day  day 

 day  1 day  1 `,example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"",a:"",m:[1,1],p:[{name:"date_text",detail:"",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:"DATEDATE",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"DATEDATE",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:` "M" "Y""M""D""MD""YM"  "YD"

"Y"

"M"

"D"

"MD"

"YM"

"YD"`,example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"",a:"",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:`start_date 



`,example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:`[] - 

NDATEDATEVALUETO_DATE`,example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:" ",a:" ",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:`start_date 





`,example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:`[ - 1] - 
0110000011
1 =/2 =/7 =/11 =12 =17 =`,example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:`[  ] - 
NDATEDATEVALUETO_DATE`,example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:" Year  1900 - 9999 ",a:" Year  1900 - 9999 ",m:[1,1],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:" start_date  end_date ",a:" start_date  end_date ",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"",a:"",m:[0,0],p:[]},{n:"MONTH",t:6,d:"  1 12",a:"  1 12",m:[1,1],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"",a:"",m:[2,2],p:[{name:"nominal_rate",detail:"",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"",a:"",m:[1,2],p:[{name:"number",detail:"",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:`[ -  2] - 

`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"",a:"",m:[2,2],p:[{name:"fractional_dollar",detail:"",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"",a:"",m:[2,2],p:[{name:"decimal_dollar",detail:"",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"",a:"",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"[ - 12] - ",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"",a:"",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"[ - 2] - ",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"",a:"",m:[3,6],p:[{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0 

1 `,example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"guess",detail:"[ - 0.1] - ",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"",a:"",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:`

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:`

`,example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`

0 

1 `,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"",a:"",m:[4,4],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[] - ",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0 

1 `,example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"",a:"",m:[6,8],p:[{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_interest",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:`[ - TRUE()] - 

 TRUE

 FALSE`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"",a:"",m:[4,5],p:[{name:"issue",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"[ -  0 ] - ",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ -  0 ] - 

0 

1 `,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"",a:"",m:[2,2],p:[{name:"principal",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"schedule",detail:`

UNARY_PERCENT0.09UNARY_PERCENT(9)9`,example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"",a:"",m:[6,7],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"",a:"",m:[2,2],p:[{name:"effect_rate",detail:"",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"",a:"",m:[2,3],p:[{name:"values",detail:`

`,example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ - 0.1] - ",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"",a:"",m:[3,3],p:[{name:"values",detail:`

`,example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvest_rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:" ",a:" ",m:[1,2],p:[{name:"values",detail:`

`,example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ -  0.1] - ",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"",a:"",m:[2,255],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"value2, ...",detail:"[] - ",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"",a:"",m:[3,3],p:[{name:"rate",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"values",detail:" dates ",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"",a:"",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:`

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:`

`,example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`

0 

1 `,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ -  0] - ",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ -  0] - 

0 

1 `,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"",a:"",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:" 1  nper ",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ -  0] - ",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ -  0] - 

0 

1 `,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"",a:"",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:" 1  nper ",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ -  0] - ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ -  0] - 

0 

1 `,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:" 100 ",a:" 100 ",m:[6,7],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:" 100 ",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:" 100 ",a:" 100 ",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:" 100 ",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:" 100 ",a:" 100 ",m:[5,6],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:" 100 ",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:" 100 ",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0 

1 `,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"",a:"",m:[3,3],p:[{name:"cost",detail:"",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:" 100 ",a:" 100 ",m:[5,6],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:" 100  Macauley ",a:" 100  Macauley ",m:[5,6],p:[{name:"settlement",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:" ",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

frequency = 1

frequency = 2

frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0(NASD) 30/360 - 30360

1/ - 

2/360 - 360

3/365 - 365

430/360 - 030360`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:`10



01111111111000000000

BIN2DEC(100)BIN2DEC("100")4`,example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`10



01111111111000000000

BIN2HEX(11111)BIN2HEX("11111") 1F`,example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

0BIN2HEX("11111",8)0000001F

11000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`10



01111111111000000000

BIN2OCT(11111)BIN2OCT("11111")37`,example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

0BIN2OCT("11111")00000037

11000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`

511-512

DEC2BIN(199)DEC2BIN("199")11000111`,example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:`[  ] - 

0

`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`

549755813887-549755814888

DEC2HEX(100)DEC2HEX("100")64`,example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:`[  ] - 

0

`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`

536870911-53687092

DEC2OCT(199)DEC2OCT("199")307`,example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:`[  ] - 

0

`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`40



1FFFFFFFFFE00

HEX2BIN(199)HEX2BIN("199")110011001`,example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

0

18000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:`40



7fffffffff8000000000

HEX2DEC(199)HEX2DEC("199")409`,example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`40



1FFFFFFFFFE0000000

HEX2OCT(199)HEX2OCT("199")631`,example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

0

18000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`30



7777777777000

OCT2BIN(177)OCT2BIN("177")1111111`,example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

0

14000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:`30

ba

37777777774000000000

OCT2DEC(177)OCT2DEC("177")127`,example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`30

ba

37777777774000000000

OCT2HEX(177)OCT2HEX("177")7F`,example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

0

14000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,3],p:[{name:"real_num",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"i_num",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:'[ -  "i"] - ',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"  number1=number2 1 0",a:"  number1=number2 1 0",m:[1,2],p:[{name:"number1",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"[ -  0] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] - 1 ",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:" inumber2",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:" inumber1 ",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] - ",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:"",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:" - NOT(TRUE()) FALSENOT(FALSE()) TRUE",a:" - NOT(TRUE()) FALSENOT(FALSE()) TRUE",m:[1,1],p:[{name:"logical",detail:" TRUE  FALSE ",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:" TRUE",a:" TRUE",m:[0,0],p:[]},{n:"FALSE",t:10,d:" FALSE",a:" FALSE",m:[0,0],p:[]},{n:"AND",t:10,d:" TRUE  TRUE FALSE FALSE",a:" TRUE  TRUE FALSE FALSE",m:[1,255],p:[{name:"logical1",detail:" TRUE  FALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical2,...",detail:"[] -  TRUE  FALSE 255 ",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"",a:"",m:[2,2],p:[{name:"value",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:" #N/A#VALUE!#REF!#DIV/0!#NUM!#NAME?  #NULL!",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:" TRUE  FALSE ",a:" TRUE  FALSE ",m:[2,3],p:[{name:"logical_test",detail:"TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"TRUE",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"[ - ] - FALSE",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:" TRUE  TRUE FALSE FALSE",a:" TRUE  TRUE FALSE FALSE",m:[1,255],p:[{name:"logical1",detail:" TRUE  FALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - TRUEFALSE",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"TRUEFALSE<>",a:"TRUEFALSE<>",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"TRUEFALSE=",a:"TRUEFALSE=",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:" TRUE FALSE>",a:" TRUE FALSE>",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:" TRUE FALSE>=",a:" TRUE FALSE>=",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:" TRUE FALSE<",a:" TRUE FALSE<",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:" TRUE FALSE<=",a:" TRUE FALSE<=",m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:" `+` ",a:" `+` ",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"-",a:"-",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"*",a:"*",m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:" `/` ",a:" `/` ",m:[2,2],p:[{name:"value1",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:`

0`,example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:" `&` ",a:" `&` ",m:[2,2],p:[{name:"value1",detail:"value2 ",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"UNARY_PERCENT(100)1",a:"UNARY_PERCENT(100)1",m:[1,1],p:[{name:"number",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"",a:"",m:[1,255],p:[{name:"text1",detail:"",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"text2 ...",detail:"[] - ",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:" Unicode ",a:" Unicode ",m:[1,1],p:[{name:"text",detail:"Unicode",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:" Unicode ",a:" Unicode ",m:[1,1],p:[{name:"number",detail:" 1  255 ",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"",a:"",m:[1,1],p:[{name:"number",detail:"13999",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:" text ",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

T

T

T

T`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"",a:"",m:[1,3],p:[{name:"number",detail:"",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:`[ - 2] - 

`,example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"no_commas",detail:"[ - FALSE()] -  TRUE() FIXED ",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[ - 1] - ",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[ -  1] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"",a:"",m:[2,255],p:[{name:"separator",detail:`

JOIN(,{1,2,3})`,example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"array1",detail:"",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"array2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[ - 1] -  LEFT ",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[ - 1] -  RIGHT ",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"1",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:` MID 

MID`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"(DBCS)",a:"(DBCS)",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text1",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"",a:"",m:[4,4],p:[{name:"old_text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:" 1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_times",detail:`

100100REPT100`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[  - 1 ] - ",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:" new_text  old_text",a:" new_text  old_text",m:[3,4],p:[{name:"text",detail:"",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"old_text",detail:"",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"new_text",detail:" old_text ",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"instance_num",detail:"[  ] -  new_text  old_text   instance_num old_text   old_text  new_text",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:" ASCII ",a:" ASCII ",m:[1,1],p:[{name:"text",detail:"",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"",a:"",m:[2,2],p:[{name:"value",detail:"",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format_text",detail:`

0TEXT(12.3,"000.00")012.30TEXT(12.305,"00.00")12.31

#0TEXT(12.3,"###.##")12.3`,example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"",a:"",m:[3,3],p:[{name:"number",detail:" from_unit ",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"from_unit",detail:"",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"to_unit",detail:"",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:` y = mx + b  y 

 known_y  known_x 

 known_y known_x  known_y  known_x  known_y `,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,...}, known_y ] -  y = mx + b  x 

 known_y known_x  known_y  known_x  known_y `,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ -  known_x ] -   TREND  y  x ",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE()] -  b  0

TRUE()  b 

FALSE()  b  0m  y = mx`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"",a:"",m:[2,2],p:[{name:"data_array",detail:"",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"bins_array",detail:` data_array 

FREQUENCY`,example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:` y = b*m^x  y 

_y_x

_y_x_y_x_y`,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,...}, known_y ] -  y = b*m^x  x 

_y_x_y_x_y`,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ -  known_x ] -  GROWTH  y  x ",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE()] - b  1

TRUE()  b 

FALSE()  b  1m  y = m^x`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:` y = mx + b  y 

 known_y  known_x 

 known_y known_x  known_y  known_x  known_y `,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,...}, known_y ] -  y = mx + b  x 

 known_y known_x  known_y  known_x  known_y `,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE()] -  b  0

TRUE()  b 

FALSE()  b  0m  y = mx`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:`[ - FALSE()] - 

TRUEyLINEST



011



FF

F



`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:` y = mx + b  y 

 known_y  known_x 

 known_y known_x  known_y  known_x  known_y `,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,...}, known_y ] -  y = mx + b  x 

 known_y known_x  known_y  known_x  known_y `,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE()] -  b  0

TRUE()  b 

FALSE()  b  0m  y = mx`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:`[ - FALSE()] - 

TRUE b LOGEST 



 0  1 1 



F  F 

 -  F 



`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:" array1  array2 ",a:" array1  array2 ",m:[2,2],p:[{name:"array1",detail:`

array1  array2 `,example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:`

array2  array1 `,example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"",a:"",m:[1,255],p:[{name:"array1",detail:"",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"[] - ",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"",a:"",m:[1,1],p:[{name:"cell",detail:`

 cell  ISFORMULA  TRUE cell  TRUE FALSE`,example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"",a:"",m:[2,2],p:[{name:"info_type",detail:"",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:" #N/A",a:" #N/A",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"error_val",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

 TRUE FALSE`,example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:" #N/A ",a:" #N/A ",m:[1,1],p:[{name:"value",detail:`#N/A

#N/A#DIV/0!#NAME?#NULL!#NUM!#VALUE!#REF!ISERRTRUE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

#DIV/0!#N/A#NAME?#NULL!#NUM!#VALUE!#REF!ISERRORTRUE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:" TRUE  FALSE",a:" TRUE  FALSE",m:[1,1],p:[{name:"value",detail:`TRUEFALSE

*TRUEFALSETRUEFALSEISLOGICALTRUE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:" #N/A",a:" #N/A",m:[1,1],p:[{name:"value",detail:`#N/A

*#N/A#N/AISNATRUEFALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

*ISNONTEXTFALSETRUE

ISNONTEXTTRUE

ISNONTEXTFALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

*ISNUMBERTRUEFALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

*ISREFTRUEFALSE`,example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

ISTEXTTRUEFALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

  1;

  2;

  4;

  16;

  64;`,example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`





TRUE1

FALSE0



0`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

TO_DATE30

30
TO_DATE`,example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"/",a:"/",m:[1,1],p:[{name:"value",detail:`

TO_PURE_NUMBER

TO_PERCENT`,example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

TO_TEXT

TO_TEXT`,example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

 TO_DOLLARS `,example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

TO_PERCENT1 = 100%

TO_PERCENT`,example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:" SQL ",a:" SQL ",m:[3,3],p:[{name:"database",detail:"",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:` database 

field  database  1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:" database ",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:"A1",detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:'"2017-10-01"',detail:"",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:",0:[1900/01/01], 1:[1900-01-01], 2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"...1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"",a:"",m:[1,2],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"tf-idf",a:"tf-idf",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"TextRank",a:"TextRank",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[], 1[], 2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"",a:"",m:[1,1],p:[{name:"",example:'"1990-01-01"',detail:"1990/01/01, 199011",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"sparklines",a:"",m:[1,8],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#CCF3F4",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"0000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#999",detail:"0#999",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"1#0002:-2:#000-20-5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:"A1:A20 {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"0false1.5",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"10",detail:"false",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"sparklines",a:"",m:[2,3],p:[{name:"",example:"10",detail:"A1 100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"8",detail:"A1 100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"12",detail:"A1 1009",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:",sparklines",a:"sparklines",m:[1,1],p:[{name:"",example:"PIESPLINES(A1:A20)",detail:"sparklinesA1:A20 ",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"",a:"",m:[1,4],p:[{name:"array",detail:"",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_index",detail:"[] - row1/col1",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_order",detail:"[] - 1-1",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] - FALSE()TRUE()",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"/",a:"/",m:[2,3],p:[{name:"array",detail:"",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[] - (filter)",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"",a:"",m:[1,3],p:[{name:"array",detail:"",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] -  = FALSE()  = TRUE()",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[] -  = TRUE() = FALSE() ",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:" 0  1 ",a:" 0  1 ",m:[0,2],p:[{name:"rows",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"",a:"",m:[1,4],p:[{name:"rows",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"",a:"",m:[1,1],p:[{name:"",example:'"A1+5*2^2"',detail:"",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:" (Ctrl+B)",italic:" (Ctrl+I)",strikethrough:" (Alt+Shift+5)",underline:"",textColor:"",chooseColor:"",resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:"",border:"",borderStyle:"",mergeCell:"",chooseMergeType:"",horizontalAlign:"",verticalAlign:"",alignment:"",textWrap:"",textWrapMode:"",textRotate:"",textRotateMode:"",freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalFormat:"",postil:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataVerification:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:""},alternatingColors:{applyRange:"",selectRange:"",header:"",footer:"",errorInfo:"",textTitle:"",custom:"",close:"",selectionTextColor:"",selectionCellColor:"",removeColor:"",colorShow:"",currentColor:"",tipSelectRange:"",errorNoRange:"",errorExistColors:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:""},paint:{start:"",end:"ESC",tipSelectRange:"",tipNotMulti:""},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total}${totalPage}${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total}${totalPage}"},currencyDetail:{RMB:"",USdollar:"",EUR:"",GBP:"",HK:"",JPY:"",AlbanianLek:"",AlgerianDinar:"",Afghani:"",ArgentinePeso:"",UnitedArabEmiratesDirham:"",ArubanFlorin:"",OmaniRial:"",Azerbaijanimanat:"",EgyptianPound:"",EthiopianBirr:"",AngolaKwanza:"",AustralianDollar:"",Patacas:"",BarbadosDollar:"",PapuaNewGuineaKina:"",BahamianDollar:"",PakistanRupee:"",ParaguayanGuarani:"",BahrainiDinar:"",PanamanianBalboa:"",Brazilianreal:"",Belarusianruble:"",BermudianDollar:"",BulgarianLev:"",IcelandKrona:"",BosniaHerzegovinaConvertibleMark:"",PolishZloty:"",Boliviano:"",BelizeDollar:"",BotswanaPula:"",NotDannuzhamu:"",BurundiFranc:"",NorthKoreanWon:"",DanishKrone:"",EastCaribbeanDollar:"",DominicaPeso:"",RussianRuble:"",EritreanNakfa:"",CFAfranc:"",PhilippinePeso:"",FijiDollar:"",CapeVerdeEscudo:"",FalklandIslandsPound:"",GambianDalasi:"",Congolesefranc:"",ColombianPeso:"",CostaRicanColon:"",CubanPeso:"",Cubanconvertiblepeso:"",GuyanaDollar:"",KazakhstanTenge:"",Haitiangourde:"",won:"",NetherlandsAntillesGuilder:"",Honduraslempiras:"",DjiboutiFranc:"",KyrgyzstanSom:"",GuineaFranc:"",CanadianDollar:"",GhanaianCedi:"",Cambodianriel:"",CzechKoruna:"",ZimbabweDollar:"",QatariRiyal:"",CaymanIslandsDollar:"",Comorianfranc:"",KuwaitiDinar:"",CroatianKuna:"",KenyanShilling:"",LesothoLoti:"",LaoKip:"",LebanesePound:"",Lithuanianlitas:"",LibyanDinar:"",LiberianDollar:"",RwandaFranc:"",RomanianLeu:"",MalagasyAriary:"",MaldivianRufiyaa:"",MalawiKwacha:"",MalaysianRinggit:"",MacedoniawearingDinar:"",MauritiusRupee:"",MauritanianOuguiya:"",MongolianTugrik:"",BangladeshiTaka:"",PeruvianNuevoSol:"",MyanmarKyat:"",MoldovanLeu:"",MoroccanDirham:"",MozambiqueMetical:"",MexicanPeso:"",NamibianDollar:"",SouthAfricanRand:"",SouthSudanesePound:"",NicaraguaCordoba:"",NepaleseRupee:"",NigerianNaira:"",NorwegianKrone:"",GeorgianLari:"",RMBOffshore:"",SwedishKrona:"",SwissFranc:"",SerbianDinar:"",SierraLeone:"",SeychellesRupee:"",SaudiRiyal:"",SaoTomeDobra:"",SaintHelenapound:"",SriLankaRupee:"",SwazilandLilangeni:"",SudanesePound:"",Surinamesedollar:"",SolomonIslandsDollar:"",SomaliShilling:"",TajikistanSomoni:"",PacificFranc:"",ThaiBaht:"",TanzanianShilling:"",TonganPaanga:"",TrinidadandTobagoDollar:"",TunisianDinar:"",TurkishLira:"",VanuatuVatu:"",GuatemalanQuetzal:"",CommissionBolivar:"",BruneiDollar:"",UgandanShilling:"",UkrainianHryvnia:"",UruguayanPeso:"",Uzbekistansom:"",WesternSamoaTala:"",SingaporeDollar:"",NT:"",NewZealandDollar:"",HungarianForint:"",SyrianPound:"",JamaicanDollar:"",ArmenianDram:"",YemeniRial:"",IraqiDinar:"",IranianRial:"",NewIsraeliShekel:"",IndianRupee:"",IndonesianRupiah:"",JordanianDinar:"",VND:"",ZambianKwacha:"",GibraltarPound:"",ChileanPeso:"",CFAFrancBEAC:""},defaultFmt:[{text:"",value:"General",example:""},{text:"",value:"@",example:""},{text:"",value:"split",example:""},{text:"",value:"##0.00",example:"1000.12"},{text:"",value:"#0.00%",example:"12.21%"},{text:"",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"",value:"(0.00)",example:"(1200.09)"},{text:"",value:"w",example:"120002500"},{text:"",value:"0.00",example:"1200.09"},{text:"2",value:"w0.00",example:"22500.55"},{text:"",value:"split",example:""},{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"24H",value:"hh:mm",example:"15:00"},{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"193085",value:'yyyy""M""d""'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"85",value:'M""d""'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"01:30",value:"/ hh:mm"},{name:"1:30",value:"/ h:mm"},{name:"1:30:30",value:"/ h:mm:ss"},{name:"08-05 01:30",value:"MM-dd / hh:mm"}],fontFamily:{MicrosoftYaHei:"Microsoft YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3,:4,"microsoft yahei":4,:5,simsun:5,:6,simhei:6,:7,kaiti:7,:8,fangsong:8,:9,nsimsun:9,:10,stxinwei:10,:11,stxingkai:11,:12,stliti:12},border:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{mergeAll:"",mergeV:"",mergeH:"",mergeCancel:"",overlappingError:"",partiallyError:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},textWrap:{overflow:"",wrap:"",clip:""},rotation:{none:"",angleup:"",angledown:"",vertical:"",rotationUp:"90",rotationDown:"90"},freezen:{default:"",freezenRow:"",freezenColumn:"",freezenRC:"",freezenRowRange:"",freezenColumnRange:"",freezenRCRange:"",freezenCancel:"",noSeletionError:""},sort:{asc:"",desc:"",custom:"",hasTitle:"",sortBy:"",addOthers:"",close:"",confirm:"",columnOperation:"",secondaryTitle:"",sortTitle:"",sortRangeTitle:"",sortRangeTitleTo:"",noRangeError:"",mergeError:""},filter:(kn={filter:"",clearFilter:"",sortByAsc:"A-Z",sortByDesc:"Z-A",filterByColor:"",filterByCondition:"",filterByValues:"",filiterInputNone:"",filiterInputTip:"",filiterRangeStartTip:"",filiterRangeEndTip:"",filterValueByAllBtn:"",filterValueByClearBtn:"",filterValueByInverseBtn:"",filterValueByTip:"",filterConform:" ",filterCancel:" "},Yr(kn,"clearFilter",""),Yr(kn,"conditionNone",""),Yr(kn,"conditionCellIsNull",""),Yr(kn,"conditionCellNotNull",""),Yr(kn,"conditionCellTextContain",""),Yr(kn,"conditionCellTextNotContain",""),Yr(kn,"conditionCellTextStart",""),Yr(kn,"conditionCellTextEnd",""),Yr(kn,"conditionCellTextEqual",""),Yr(kn,"conditionCellDateEqual",""),Yr(kn,"conditionCellDateBefore",""),Yr(kn,"conditionCellDateAfter",""),Yr(kn,"conditionCellGreater",""),Yr(kn,"conditionCellGreaterEqual",""),Yr(kn,"conditionCellLess",""),Yr(kn,"conditionCellLessEqual",""),Yr(kn,"conditionCellEqual",""),Yr(kn,"conditionCellNotEqual",""),Yr(kn,"conditionCellBetween",""),Yr(kn,"conditionCellNotBetween",""),Yr(kn,"filiterMoreDataTip",""),Yr(kn,"filiterMonthText",""),Yr(kn,"filiterYearText",""),Yr(kn,"filiterByColorTip",""),Yr(kn,"filiterByTextColorTip",""),Yr(kn,"filterContainerOneColorTip",""),Yr(kn,"filterDateFormatTip",""),Yr(kn,"valueBlank","()"),Yr(kn,"mergeError",""),kn),rightclick:{copy:"",copyAs:"",paste:"",insert:"",delete:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},comment:{insert:"",edit:"",delete:"",showOne:"/",showAll:"/"},screenshot:{screenshotTipNoSelection:"",screenshotTipTitle:"",screenshotTipHasMerge:"",screenshotTipHasMulti:"",screenshotTipSuccess:"",screenshotImageName:"",downLoadClose:"",downLoadCopy:"",downLoadBtn:"",browserNotTip:"IE",rightclickTip:"''",successTip:"''"},splitText:{splitDelimiters:"",splitOther:"",splitContinueSymbol:"",splitDataPreview:"",splitTextTitle:"",splitConfirmToExe:"",tipNoMulti:"",tipNoMultiColumn:""},imageText:{imageSetting:"",close:"",conventional:"",moveCell1:"",moveCell2:"",moveCell3:"",fixedPos:"",border:"",width:"",radius:"",style:"",solid:"",dashed:"",dotted:"",double:"",color:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},findAndReplace:{find:"",replace:"",goto:"",location:"",formula:"",date:"",number:"",string:"",error:"",condition:"",rowSpan:"",columnSpan:"",locationExample:"",lessTwoRowTip:"",lessTwoColumnTip:"",findTextbox:"",replaceTextbox:"",regexTextbox:"",wholeTextbox:"",distinguishTextbox:"",allReplaceBtn:"",replaceBtn:"",allFindBtn:"",findBtn:"",noFindTip:"",modeTip:"",searchTargetSheet:"",searchTargetCell:"",searchTargetValue:"",searchInputTip:"",noReplceTip:"",noMatchTip:"",successTip:"${xlength}",locationConstant:"",locationFormula:"",locationDate:"",locationDigital:"",locationString:"",locationBool:"",locationError:"",locationNull:"",locationCondition:"",locationRowSpan:"",locationColumnSpan:"",locationTiplessTwoRow:"",locationTiplessTwoColumn:"",locationTipNotFindCell:""},sheetconfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:"",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:", sheet",chartEditNoOpt:"",sheetNameSpecCharError:`31' :\r
[ ] : \\ ? * /`,sheetNamecannotIsEmptyError:""},conditionformat:{conditionformat_greaterThan:"",conditionformat_greaterThan_title:"",conditionformat_lessThan:"",conditionformat_lessThan_title:"",conditionformat_betweenness:"",conditionformat_betweenness_title:"",conditionformat_equal:"",conditionformat_equal_title:"",conditionformat_textContains:"",conditionformat_textContains_title:"",conditionformat_occurrenceDate:"",conditionformat_occurrenceDate_title:"",conditionformat_duplicateValue:"",conditionformat_duplicateValue_title:"",conditionformat_top10:" 10 ",conditionformat_top10_percent:" 10%",conditionformat_top10_title:"",conditionformat_last10:" 10 ",conditionformat_last10_percent:" 10%",conditionformat_last10_title:"",conditionformat_AboveAverage:"",conditionformat_AboveAverage_title:"",conditionformat_SubAverage:"",conditionformat_SubAverage_title:"",rule:"",newRule:"",editRule:"",deleteRule:"",deleteCellRule:"",deleteSheetRule:"",manageRules:"",showRules:"",highlightCellRules:"",itemSelectionRules:"",conditionformatManageRules:"",format:"",setFormat:"",setAs:"",setAsByArea:"",applyRange:"",selectRange:"",selectRange_percent:"",selectRange_average:"",selectRange_value:"",pleaseSelectRange:"",selectDataRange:"",selectCell:"",pleaseSelectCell:"",pleaseSelectADate:"",pleaseEnterInteger:" 1  1000 ",onlySingleCell:"",conditionValueCanOnly:"",ruleTypeItem1:"",ruleTypeItem2:"",ruleTypeItem2_title:"",ruleTypeItem3:"",ruleTypeItem3_title:"",ruleTypeItem4:"",ruleTypeItem4_title:"",ruleTypeItem5:"",ruleTypeItem6:"",formula:"",textColor:"",cellColor:"",confirm:"",confirmColor:"",cancel:"",close:"",clearColorSelect:"",sheet:"",currentSheet:"",dataBar:"",dataBarColor:"",gradientDataBar_1:"-",gradientDataBar_2:"-",gradientDataBar_3:"-",gradientDataBar_4:"-",gradientDataBar_5:"-",gradientDataBar_6:"-",solidColorDataBar_1:"",solidColorDataBar_2:"",solidColorDataBar_3:"",solidColorDataBar_4:"",solidColorDataBar_5:"",solidColorDataBar_6:"",colorGradation:"",colorGradation_1:"--",colorGradation_2:"--",colorGradation_3:"--",colorGradation_4:"--",colorGradation_5:"--",colorGradation_6:"--",colorGradation_7:"-",colorGradation_8:"-",colorGradation_9:"-",colorGradation_10:"-",colorGradation_11:"-",colorGradation_12:"-",icons:"",pleaseSelectIcon:"",cellValue:"",specificText:"",occurrence:"",greaterThan:"",lessThan:"",between:"",equal:"",in:"",to:"",between2:"",contain:"",textContains:"",duplicateValue:"",uniqueValue:"",top:"",top10:" 10 ",top10_percent:" 10%",last:"",last10:" 10 ",last10_percent:" 10%",oneself:"",above:"",aboveAverage:"",below:"",belowAverage:"",all:"",yesterday:"",today:"",tomorrow:"",lastWeek:"",thisWeek:"",lastMonth:"",thisMonth:"",lastYear:"",thisYear:"",last7days:"7",last30days:"30",next7days:"7",next30days:"30",next60days:"60",chooseRuleType:"",editRuleDescription:"",newFormatRule:"",editFormatRule:"",formatStyle:"",fillType:"",color:"",twocolor:"",tricolor:"",multicolor:"",grayColor:"",gradient:"",solid:"",maxValue:"",medianValue:"",minValue:"",direction:"",threeWayArrow:"",fourWayArrow:"",fiveWayArrow:"",threeTriangles:"3",shape:"",threeColorTrafficLight:"",fourColorTrafficLight:"",threeSigns:"",greenRedBlackGradient:"--",rimless:"",bordered:"",mark:"",threeSymbols:"",tricolorFlag:"",circled:"",noCircle:"",grade:"",grade4:"",grade5:"",threeStars:"3",fiveQuadrantDiagram:"",fiveBoxes:"5"},insertLink:{linkText:"",linkType:"",external:"",internal:"",linkAddress:"",linkSheet:"",linkCell:"",linkTooltip:"",placeholder1:"",placeholder2:"A1",placeholder3:"",tooltipInfo1:"",tooltipInfo2:""},dataVerification:{cellRange:"",selectCellRange:"",selectCellRange2:"",verificationCondition:"",dropdown:"",checkbox:"",number:"",number_integer:"-",number_decimal:"-",text_content:"-",text_length:"-",date:"",validity:"",placeholder1:"1,2,3,4,5",placeholder2:"",placeholder3:"10",placeholder4:"",placeholder5:"",selected:"",notSelected:"",between:"",notBetween:"",equal:"",notEqualTo:"",moreThanThe:"",lessThan:"",greaterOrEqualTo:"",lessThanOrEqualTo:"",include:"",exclude:"",earlierThan:"",noEarlierThan:"",laterThan:"",noLaterThan:"",identificationNumber:"",phoneNumber:"",remote:"",prohibitInput:"",hintShow:"",deleteVerification:"",tooltipInfo1:"",tooltipInfo2:"",tooltipInfo3:"",tooltipInfo4:"21",tooltipInfo5:"",tooltipInfo6:"",tooltipInfo7:"21"},formula:{sum:"",average:"",count:"",max:"",min:"",ifGenerate:"if",find:"",tipNotBelongToIf:"if",tipSelectCell:"",ifGenCompareValueTitle:"",ifGenSelectCellTitle:"",ifGenRangeTitle:"",ifGenRangeTo:"",ifGenRangeEvaluate:"",ifGenSelectRangeTitle:"",ifGenCutWay:"",ifGenCutSame:"",ifGenCutNpiece:"N",ifGenCutCustom:"",ifGenCutConfirm:"",ifGenTipSelectCell:"",ifGenTipSelectCellPlace:"",ifGenTipSelectRange:"",ifGenTipSelectRangePlace:"",ifGenTipNotNullValue:"",ifGenTipLableTitile:"",ifGenTipRangeNotforNull:"",ifGenTipCutValueNotforNull:"",ifGenTipNotGenCondition:""},formulaMore:{valueTitle:"",tipSelectDataRange:"",tipDataRangeTile:"",findFunctionTitle:"",tipInputFunctionName:"",Array:"",Database:"",Date:"",Engineering:"",Filter:"",Financial:"",luckysheet:"Luckysheet",other:"",Logical:"",Lookup:"",Math:"",Operator:"",Parser:"",Statistical:"",Text:"",dataMining:"",selectFunctionTitle:"",calculationResult:"",tipSuccessText:"",tipParamErrorText:"",helpClose:"",helpCollapse:"",helpExample:"",helpAbstract:"",execfunctionError:'", "',execfunctionSelfError:"",execfunctionSelfErrorResult:"",allowRepeatText:"",allowOptionText:"",selectCategory:""},drag:{noMerge:"",affectPivot:"",noMulti:",",noPaste:"",noPartMerge:"",inputCorrect:"",notLessOne:"1",offsetColumnLessZero:"",pasteMustKeybordAlert:"Copy and paste in the Sheet: Ctrl + C to copy, Ctrl + V to paste, Ctrl + X to cut",pasteMustKeybordAlertHTMLTitle:"Copy and paste in the Sheet",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;to copy<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;to paste<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;to cut"},pivotTable:{title:"",closePannel:"",editRange:"",tipPivotFieldSelected:"",tipClearSelectedField:"",btnClearSelectedField:"",btnFilter:"",titleRow:"",titleColumn:"",titleValue:"",tipShowColumn:"",tipShowRow:"",titleSelectionDataRange:"",titleDataRange:"",valueSum:"",valueStatisticsSUM:"",valueStatisticsCOUNT:"",valueStatisticsCOUNTA:"",valueStatisticsCOUNTUNIQUE:"",valueStatisticsAVERAGE:"",valueStatisticsMAX:"",valueStatisticsMIN:"",valueStatisticsMEDIAN:"",valueStatisticsPRODUCT:"",valueStatisticsSTDEV:"",valueStatisticsSTDEVP:"",valueStatisticslet:"",valueStatisticsVARP:"",errorNotAllowEdit:"",errorNotAllowMulti:"",errorSelectRange:"",errorIsDamage:"",errorNotAllowPivotData:"",errorSelectionRange:", ",errorIncreaseRange:"!",titleAddColumn:"",titleMoveColumn:"",titleClearColumnFilter:"",titleFilterColumn:"",titleSort:"",titleNoSort:"",titleSortAsc:"",titleSortDesc:"",titleSortBy:"",titleShowSum:"",titleStasticTrue:"",titleStasticFalse:""},dropCell:{copyCell:"",sequence:"",onlyFormat:"",noFormat:"",day:"",workDay:"",month:"",year:"",chineseNumber:""},imageCtrl:{borderTile:"",borderCur:""},protection:{protectiontTitle:"",enterPassword:"",enterHint:"",swichProtectionTip:"",authorityTitle:":",selectLockedCells:"",selectunLockedCells:"",formatCells:"",formatColumns:"",formatRows:"",insertColumns:"",insertRows:"",insertHyperlinks:"",deleteColumns:"",deleteRows:"",sort:"",filter:"",usePivotTablereports:"",editObjects:"",editScenarios:"",allowRangeTitle:"",allowRangeAdd:"...",allowRangeAddTitle:"",allowRangeAddSqrf:"",selectCellRange:"",selectCellRangeHolder:"",allowRangeAddTitlePassword:"",allowRangeAddTitleHint:"",allowRangeAddTitleHintTitle:"()",allowRangeAddtitleDefault:"",rangeItemDblclick:"",rangeItemHasPassword:"",rangeItemErrorTitleNull:"",rangeItemErrorRangeNull:"",rangeItemErrorRange:"",validationTitle:"",validationTips:"",validationInputHint:"",checkPasswordNullalert:"",checkPasswordWrongalert:"",checkPasswordSucceedalert:"!",defaultRangeHintText:"",defaultSheetHintText:""},cellFormat:{cellFormatTitle:"",protection:"",locked:"",hidden:"",protectionTips:"()",tipsPart:"",tipsAll:"",selectionIsNullAlert:"",sheetDataIsNullAlert:""},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},edit:{typing:""},websocket:{success:"WebSocket",refresh:"WebSocket, ",wait:"WebSocket, ",close:"WebSocket",contact:"",support:"WebSocket"}},es:{functionlist:[{n:"SUMIF",t:0,d:"Returns a conditional sum across a range.",a:"A conditional sum across a range.",m:[2,3],p:[{name:"range",detail:"The range which is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"sum_range",detail:"The range to be summed, if different from `range`.",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"Returns the tangent of an angle provided in radians.",a:"Tangent of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the tangent of, in radians.",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"Returns the hyperbolic tangent of any real number.",a:"Hyperbolic tangent of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic tangent of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",a:"Rounds number up to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"Returns the inverse tangent of a value, in radians.",a:"Inverse tangent of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse tangent.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"Returns the inverse hyperbolic sine of a number.",a:"Inverse hyperbolic sine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"Returns the absolute value of a number.",a:"Absolute value of a number.",m:[1,1],p:[{name:"value",detail:"The number of which to return the absolute value.",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"Returns the inverse cosine of a value, in radians.",a:"Inverse cosine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse cosine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"Returns the inverse hyperbolic cosine of a number.",a:"Inverse hyperbolic cosine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic cosine. Must be greater than or equal to `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"Returns the factorial of the sum of values divided by the product of the values' factorials.",a:"Multinomial distribution function.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"Returns the inverse hyperbolic tangent of a number.",a:"Inverse hyperbolic tangent of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic tangent. Must be between -1 and 1, exclusive.",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"Returns the angle between the x-axis and a line segment from the origin (0,0) to specified coordinate pair (`x`,`y`), in radians.",a:"Arctangent of a value.",m:[2,2],p:[{name:"x",detail:"The x coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"The y coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"Returns the number of empty values in a list of values and ranges.",a:"Number of empty values.",m:[1,1],p:[{name:"value1",detail:"The first value or range in which to count the number of blanks.",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"Returns the hyperbolic cosine of any real number.",a:"Hyperbolic cosine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic cosine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"Rounds a number down to the nearest integer that is less than or equal to it.",a:"Rounds number down to nearest integer.",m:[1,1],p:[{name:"value",detail:"The value to round down to the nearest integer.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"Checks whether the provided value is even.",a:"Whether the provided value is even.",m:[1,1],p:[{name:"value",detail:"The value to be verified as even.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"Checks whether the provided value is odd.",a:"Whether the provided value is odd.",m:[1,1],p:[{name:"value",detail:"The value to be verified as odd.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"Returns the least common multiple of one or more integers.",a:"Least common multiple of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the least common multiple.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the least common multiple.",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"Returns the logarithm of a number, base e (Euler's number).",a:"The logarithm of a number, base e (euler's number).",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base e.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"Returns the logarithm of a number with respect to a base.",a:"The logarithm of a number with respect to a base.",m:[1,2],p:[{name:"value",detail:"The value for which to calculate the logarithm.",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"base",detail:"The base to use for calculation of the logarithm.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"Returns the logarithm of a number, base 10.",a:"The logarithm of a number, base 10.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base 10.",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:"Returns the result of the modulo operator, the remainder after a division operation.",a:"Modulo (remainder) operator.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided to find the remainder.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"Rounds one number to the nearest integer multiple of another.",a:"Rounds a number to the nearest integer multiple.",m:[2,2],p:[{name:"value",detail:"The number to round to the nearest integer multiple of another.",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"Rounds a number up to the nearest odd integer.",a:"Rounds a number up to the nearest odd integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest odd number.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"Returns the sum of the squares of a series of numbers and/or cells.",a:"Sum of squares.",m:[1,255],p:[{name:"value1",detail:"The first number or range whose squares to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges whose squares to add to the square(s) of `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects.",a:"Number of combinations from a set of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"Returns the inverse sine of a value, in radians.",a:"Inverse sine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse sine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"Returns a conditional count across a range.",a:"A conditional count across a range.",m:[2,2],p:[{name:"range",detail:"The range that is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"Converts an angle value in degrees to radians.",a:"Converts an angle value in degrees to radians.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from degrees to radians.",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"Returns a random number between 0 inclusive and 1 exclusive.",a:"A random number between 0 inclusive and 1 exclusive.",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"Counts the number of unique values in a list of specified values and ranges.",a:"Counts number of unique values in a range.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider for uniqueness.",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider for uniqueness.",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"Converts an angle value in radians to degrees.",a:"Converts an angle value in radians to degrees.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from radians to degrees.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"Returns the complementary Gauss error function of a value.",a:"Complementary gauss error function of a value.",m:[1,1],p:[{name:"z",detail:"The number for which to calculate the complementary Gauss error function.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"Rounds a number up to the nearest even integer.",a:"Rounds a number up to the nearest even integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest even number.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"Returns Euler's number, e (~2.718) raised to a power.",a:"Euler's number, e (~2.718) raised to a power.",m:[1,1],p:[{name:"exponent",detail:"The exponent to raise e to.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"Returns the factorial of a number.",a:"Factorial of a number.",m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose factorial will be calculated and returned.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:'Returns the "double factorial" of a number.',a:'"double factorial" of a number.',m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose double factorial will be calculated and returned.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"Returns the value of Pi to 14 decimal places.",a:"The number pi.",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"Rounds a number down to the nearest integer multiple of specified significance `factor`.",a:"Rounds number down to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round down to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"Returns the greatest common divisor of one or more integers.",a:"Greatest common divisor of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the greatest common divisor.",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the greatest common divisor.",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"Returns a uniformly random integer between two values, inclusive.",a:"Random integer between two values, inclusive.",m:[2,2],p:[{name:"low",detail:"The low end of the random range.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"high",detail:"The high end of the random range.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"Rounds a number to a certain number of decimal places according to standard rules.",a:"Rounds a number according to standard rules.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"Rounds a number to a certain number of decimal places, always rounding down to the next valid increment.",a:"Rounds down a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding down.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"Rounds a number to a certain number of decimal places, always rounding up to the next valid increment.",a:"Rounds up a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding up.",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"Given parameters `x`, `n`, `m`, and `a`, returns the power series sum a",a:"Sum of a power series.",m:[4,4],p:[{name:"x",detail:"The input to the power series. Varies depending on the type of approximation, may be angle, exponent, or some other value.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The initial power to which to raise `x` in the power series.",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"The additive increment by which to increase `x`.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"The array or range containing the coefficients of the power series.",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.",a:"Sign of a provided number (+/-/0).",m:[1,1],p:[{name:"value",detail:"The value whose sign will be evaluated.",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"Returns the sine of an angle provided in radians.",a:"Sine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the sine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"Returns the hyperbolic sine of any real number.",a:"Hyperbolic sine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic sine of.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"Returns the positive square root of a positive number.",a:"Positive square root of a positive number.",m:[1,1],p:[{name:"value",detail:"The number for which to calculate the positive square root.",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"Returns the positive square root of the product of Pi and the given positive number.",a:"Square root of the product of pi and number.",m:[1,1],p:[{name:"value",detail:"The number which will be multiplied by Pi and have the product's square root returned",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"Returns the logarithm of a specified Gamma function, base e (Euler's number).",a:"Logarithm of gamma function.",m:[1,1],p:[{name:"value",detail:"The input to the Gamma function. The natural logarithm of Gamma(`value`) will be returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"Returns the cosine of an angle provided in radians.",a:"Cosine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the cosine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"Truncates a number to a certain number of significant digits by omitting less significant digits.",a:"Truncates a number.",m:[1,2],p:[{name:"value",detail:"The value to be truncated.",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"The number of significant digits to the right of the decimal point to retain.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"Returns one number divided by another.",a:"One number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"Returns a number raised to a power.",a:"A number raised to a power.",m:[2,2],p:[{name:"base",detail:"The number to raise to the `exponent` power.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"exponent",detail:"The exponent to raise `base` to.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"Returns the sum of a range depending on multiple criteria.",a:"Sums a range depending on multiple criteria.",m:[3,257],p:[{name:"sum_range",detail:"The range to sum.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criteria_range1",detail:"The range to check against criterion1.",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to criteria_range1.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"Returns the count of a range depending on multiple criteria.",a:"Count values depending on multiple criteria.",m:[2,256],p:[{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"Returns the result of multiplying a series of numbers together.",a:"Result of multiplying a series of numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"More numbers or ranges to calculate for the product.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"Calculates the harmonic mean of a dataset.",a:"The harmonic mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.",a:"Hypergeometric distribution probability.",m:[5,5],p:[{name:"num_successes",detail:"The desired number of successes.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_draws",detail:"The number of permitted draws.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"successes_in_pop",detail:"The total number of successes in the population.",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The total size of the population",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If cumulative is TRUE(), HYPGEOM.DIST returns the cumulative distribution function;

if FALSE(), it returns the probability density function.`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:"Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).",a:"Y-intercept of line derived via linear regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:'Calculates the kurtosis of a dataset, which describes the shape, and in particular the "peakedness" of that dataset.',a:"Kurtosis of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:"Returns the nth largest element from a data set, where n is user-defined.",a:"Nth largest element from a data set.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"The rank from largest to smallest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"Calculates the standard deviation based on a sample, setting text to the value `0`.",a:"Standard deviation of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"Calculates the standard deviation based on an entire population.",a:"Standard deviation of an entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"Calculates the geometric mean of a dataset.",a:"The geometric mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.",a:"Top rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.",a:"Average rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 exclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 inclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:"Calculates the expected y-value for a specified x based on a linear regression of a dataset.",a:"Expected y-value based of linear regression.",m:[3,3],p:[{name:"x",detail:"The value on the x-axis to forecast.",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:"Returns the inverse Fisher transformation of a specified value.",a:"Inverse fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:"Returns the Fisher transformation of a specified value.",a:"Fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"Returns the most commonly occurring value in a dataset.",a:"Most commonly occurring value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating mode.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating mode.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"Returns the value of the Weibull distribution function (or Weibull cumulative distribution function) for a specified shape and scale.",a:"Weibull distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the Weibull distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"shape",detail:"The shape parameter of the Weibull distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"scale",detail:"The scale parameter of the Weibull distribution function.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the cumulative distribution function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"Returns the number of numeric values in a dataset.",a:"The number of numeric values in dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"Returns the number of values in a dataset.",a:"The number of values in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"Calculates the average of the magnitudes of deviations of data from a dataset's mean.",a:"Average magnitude of deviations from mean.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"Returns the numerical average value in a dataset, ignoring text.",a:"Numerical average value in a dataset, ignoring text.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"Returns the numerical average value in a dataset.",a:"Numerical average value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of successes (or a maximum number of successes) in a certain number of tries given a population of a certain size containing a certain number of successes, with replacement of draws.",a:"Binomial distribution probability.",m:[4,4],p:[{name:"num_successes",detail:"The number of successes for which to calculate the probability in `num_trials` trials.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the binomial cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.",a:"Inverse cumulative binomial distribution function.",m:[3,3],p:[{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"target_prob",detail:"The desired threshold probability.",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"Calculates the width of half the confidence interval for a normal distribution.",a:"Confidence interval for a normal distribution.",m:[3,3],p:[{name:"alpha",detail:"One minus the desired confidence level. E.g. `0.1` for `0.9`, or 90%, confidence.",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the population.",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"pop_size",detail:"The size of the population.",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"Calculates the covariance of a dataset.",a:"The covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"Calculates the sample covariance of a dataset.",a:"The sample covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"Calculates the sum of squares of deviations based on a sample.",a:"The sum of squares of deviations based on a sample.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:"Returns the value of the exponential distribution function with a specified lambda at a specified value.",a:"Exponential distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the exponential distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:"The lambda to specify the exponential distribution function.",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the exponential cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"Returns the average of a range depending on criteria.",a:"Average of values depending on criteria.",m:[2,3],p:[{name:"criteria_range",detail:"The range to check against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:"The pattern or test to apply to `criteria_range`.",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"The range to average. If not included, `criteria_range` is used for the average instead.",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"Returns the average of a range depending on multiple criteria.",a:"Average of values depending on multiple criteria.",m:[2,255],p:[{name:"average_range",detail:"The range to average.",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.",a:"Number of permutations from a number of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.",a:"Mean of a dataset excluding high/low ends.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"exclude_proportion",detail:"The proportion of the dataset to exclude, from the extremities of the set.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:"Returns the value at a given percentile of a dataset exclusive of 0 and 1.",a:"Value at a given percentile of a dataset exclusive of 0 and 1.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile, exclusive of 0 and 1, whose value within 'data' will be calculated and returned.",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:"Returns the value at a given percentile of a dataset.",a:"Value at a given percentile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"percentile",detail:"The percentile whose value within `data` will be calculated and returned.`",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"Returns the value of the inverse standard normal distribution function for a specified value.",a:"Inverse standard normal distribution function.",m:[1,1],p:[{name:"x",detail:"The input to the inverse standard normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"Returns the value of the standard normal cumulative distribution function for a specified value.",a:"Standard normal cumulative distribution function.",m:[2,2],p:[{name:"x",detail:"The input to the standard normal cumulative distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.",a:"Inverse normal distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"Returns the value of the normal distribution function (or normal cumulative distribution function) for a specified value, mean, and standard deviation.",a:"Normal distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the normal distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the normal cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.",a:"Negative binomial distribution probability.",m:[4,4],p:[{name:"num_failures",detail:"The number of failures to model.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"num_successes",detail:"The number of successes to model.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"Returns the minimum numeric value in a dataset.",a:"Minimum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"Returns the minimum value in a numeric dataset.",a:"Minimum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"Returns the median value in a numeric dataset.",a:"Median value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the median value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the median value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"Returns the maximum numeric value in a dataset.",a:"Maximum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"Returns the maximum value in a numeric dataset.",a:"Maximum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:"Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Inverse log-normal cumulative distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse log-normal cumulative distribution function.",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the inverse log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the inverse log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:"Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Log-normal cumulative distribution probability.",m:[4,4],p:[{name:"x",detail:"The input to the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`Determine the logical value of the function form. 

If TRUE(), it returns the cumulative distribution function;

If it is FALSE(), it returns the probability density function.`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:"Returns the one-tailed p-value of a Z-test with standard distribution.",a:"One-tailed p-value of a z-test.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"value",detail:"The test statistic to use in the Z-test.",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation to assume for the Z-test. If this is not provided, the standard deviation of the data will be used.",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.",a:"Probability values lie in a range.",m:[3,4],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"probabilities",detail:"Array or range containing probabilities corresponding to `data`.",example:"2",require:"m",repeat:"n",type:"range"},{name:"low_limit",detail:"The lower bound on the value range for which to calculate the probability.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"high_limit",detail:"The upper bound on the value range for which to calculate the probability.",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:"Returns a value nearest to a specified quartile of a dataset exclusive of 0 and 4.",a:"Value nearest to a specific quartile of a dataset exclusive of 0 and 4.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:"Returns a value nearest to a specified quartile of a dataset.",a:"Value nearest to a specific quartile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quartile_number",detail:"Which quartile value to return.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"Returns the value of the Poisson distribution function (or Poisson cumulative distribution function) for a specified value and mean.",a:"Poisson distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the Poisson distribution function.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean (mu) of the Poisson distribution function.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Whether to use the Poisson cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.",a:"Square of the correlation coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:"Calculates the left tail probability for a Student's t-distribution with a given input (x).",a:"The left-tailed Student's t-distribution",m:[3,3],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"If cumulative is TRUE, T.DIST returns the cumulative distribution function; if FALSE, it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:"Calculates the probability for two tailed Student's t-distribution with a given input (x).",a:"The two tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:"Calculates the right tail probability for a Student's t-distribution with a given input (x).",a:"The right-tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:"Calculates the negative inverse of the one-tailed TDIST function.",a:"T.INV",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:"Calculates the inverse of the two-tailed TDIST function.",a:"T.INV.2T",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-test. Returns the probability associated with Student's t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.",a:"Returns the probability associated with t-test.",m:[4,4],p:[{name:"range1",detail:"The first sample of data or group of cells to consider for the t-test.",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"range2",detail:"The second sample of data or group of cells to consider for the t-test.",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"Specifies the number of distribution tails.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"Specifies the type of t-test.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:"Calculates the left-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution (left-tailed).",m:[4,4],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"Logical value that determines the form of the function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"Calculates the right-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution.",m:[3,3],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"Calculates the variance based on an entire population.",a:"Variance of entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"Calculates the variance based on a sample.",a:"Variance.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"Calculates the variance based on a sample, setting text to the value `0`.",a:"Variance of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"Calculates the variance based on an entire population, setting text to the value `0`.",a:"Variance of entire population (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:"Calculates the standard error of the predicted y-value for each x in the regression of a dataset.",a:"Standard error of predicted y-values in regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.",a:"Normalized equivalent of a random variable.",m:[3,3],p:[{name:"value",detail:"The value of the random variable to normalize.",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"The mean of the distribution.",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_deviation",detail:"The standard deviation of the distribution.",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"Returns the nth smallest element from a data set, where n is user-defined.",a:"Nth smallest element in a data set.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"n",detail:"The rank from smallest to largest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"Calculates the slope of the line resulting from linear regression of a dataset.",a:"Slope of line from linear regression of data.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.",a:"Skewness of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean. This assumes the dataset is for the population.",a:"Skewness of a population's dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",a:"Vertical lookup.",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`.",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.",a:"Horizontal lookup",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The range to consider for the search. The first row in the range is searched for the key specified in `search_key`.",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"index",detail:"The row index of the value to be returned, where the first row in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"is_sorted",detail:"Indicates whether the row to be searched (the first row of the specified range) is sorted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"Looks through a sorted row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.",a:"Look up a value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for in the row or column. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"search_range|search_result_array",detail:"One method of using this function is to provide a single sorted row or column `search_range` to look through for the `search_key` with a second argument `result_range`. The other way is to combine these two arguments into one `search_result_array` where the first row or column is searched and a value is returned from the last row or column in the array. If `search_key` is not found, a non-exact match may be returned.",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"result_range",detail:"The range from which to return a result. The value returned corresponds to the location where `search_key` is found in `search_range`. This range must be only a single row or column and should not be used if using the `search_result_array` method.",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"Returns a cell reference as a string.",a:"Cell reference as a string.",m:[2,5],p:[{name:"row",detail:"The row number of the cell reference",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The column number (not name) of the cell reference. `A` is column number `1`.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"absolute_relative_mode",detail:"An indicator of whether the reference is row/column absolute. `1` is row and column absolute (e.g. $A$1), `2` is row absolute and column relative (e.g. A$1), `3` is row relative and column absolute (e.g. $A1), and `4` is row and column relative (e.g. A1).",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"use_a1_notation",detail:"A boolean indicating whether to use `A1` style notation (TRUE) or `R1C1` style notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet",detail:"Text indicating the name of the sheet into which the address points.",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"Returns a cell reference specified by a string.",a:"A cell reference specified by a string.",m:[1,2],p:[{name:"cell_reference_as_string",detail:"A cell reference, written as a string with surrounding quotation marks.",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"is_A1_notation",detail:"Indicates if the cell reference is in A1 notation (TRUE) or R1C1 notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"Returns the row number of a specified cell.",a:"Row number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose row number will be returned.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"Returns the number of rows in a specified array or range.",a:"Number of rows in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose row count will be returned.",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:"Returns the column number of a specified cell, with `A=1`.",a:"Column number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose column number will be returned. Column `A` corresponds to `1`.",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"Returns the number of columns in a specified array or range.",a:"Number of columns in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose column count will be returned.",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"Returns a range reference shifted a specified number of rows and columns from a starting cell reference.",a:"A range reference offset relative to a cell.",m:[3,5],p:[{name:"cell_reference",detail:"The starting point from which to count the offset rows and columns.",example:"A2",require:"m",repeat:"n",type:"range"},{name:"offset_rows",detail:"The number of rows to offset by.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"offset_columns",detail:"The number of columns to offset by.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"The height of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"The width of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"Returns the relative position of an item in a range that matches a specified value.",a:"Position of item in range that matches value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"range",detail:"The one-dimensional array to be searched.",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"search_type",detail:"The search method. `1` (default) finds the largest value less than or equal to `search_key` when `range` is sorted in ascending order. `0` finds the exact value when `range` is unsorted. `-1` finds the smallest value greater than or equal to `search_key` when `range` is sorted in descending order.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"Returns the content of a cell, specified by row and column offset.",a:"Content of cell specified by row and column offset.",m:[2,3],p:[{name:"reference",detail:"The array of cells to be offset into.",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row",detail:"The number of offset rows.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column",detail:"The number of offset columns.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",a:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",m:[2,254],p:[{name:"value_name",detail:"The name of the value in the pivot table for which you want to get data.",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"any_pivot_table_cell",detail:"Any reference to a cell in the desired pivot table (top corner recommended).",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"original_column",detail:"The name of the column in the original data set (not the pivot table).",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"pivot_item",detail:"The name of the row or column shown in the pivot table corresponding to *original_column* that you want to retrieve.",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"Returns an element from a list of choices based on index.",a:"An element from a list of choices based on index.",m:[2,255],p:[{name:"index",detail:"Which choice (of the up to 30 provided) to return.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"choice1",detail:"A potential value to return. Required. May be a reference to a cell or an individual value.",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"choice2",detail:"Additional values among which to choose.",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"Creates a hyperlink inside a cell.",a:"Creates a hyperlink inside a cell.",p:[{name:"url",detail:"The full URL of the link location enclosed in quotation marks, or a reference to a cell containing such a URL.",example:'"http://www.luckysheet.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"link_label",detail:"The text to display in the cell as the link, enclosed in quotation marks, or a reference to a cell containing such a label.",example:'"luckysheet"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"Converts a provided hour, minute, and second into a time.",a:"Converts hour/minute/second into a time.",m:[3,3],p:[{name:"hour",detail:"The hour component of the time.",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"minute",detail:"The minute component of the time.",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"second",detail:"The second component of the time.",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"Returns the fraction of a 24-hour day the time represents.",a:"Converts a time string into its serial number representation.",m:[1,1],p:[{name:"time_string",detail:"The string that holds the time representation.",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"Returns a date on the last day of a month that falls a specified number of months before or after another date.",a:"Last day of a month before or after a date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to consider.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"Returns a date a specified number of months before or after another date.",a:"Date a number of months before/after another date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to calculate.",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"Returns the second component of a specific time, in numeric format.",a:"Second component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the second component",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"Returns the minute component of a specific time, in numeric format.",a:"Minute component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the minute component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"Returns the hour component of a specific time, in numeric format.",a:"Hour component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the hour component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"Returns the current date and time as a date value.",a:"Current date and time as a date value.",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"Returns the number of net working days between two provided days.",a:"Net working days between two provided days.",m:[2,3],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the date serial numbers to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"Returns the number of net working days between two provided days excluding specified weekend days and holidays.",a:"Net working days between two dates (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider as holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:"Returns a number representing the ISO week of the year where the provided date falls.",a:"ISO week number of the year.",m:[1,1],p:[{name:"date",detail:"The date for which to determine the ISO week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"Returns a number representing the week of the year where the provided date falls.",a:"Week number of the year.",m:[1,2],p:[{name:"date",detail:"The date for which to determine the week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number representing the day that a week starts on. Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"Returns a number representing the day of the week of the date provided.",a:"Day of the week of the date provided (as number).",m:[1,2],p:[{name:"date",detail:"The date for which to determine the day of the week. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"type",detail:"A number indicating which numbering system to use to represent weekdays. By default, counts starting with Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"Returns the day of the month that a specific date falls on, in numeric format.",a:"Day of the month that a specific date falls on.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the day.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"Returns the number of days between two dates.",a:"Number of days between two dates.",m:[2,2],p:[{name:"end_date",detail:"The end of the date range.",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"The start of the date range.",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"Returns the difference between two days based on the 360 day year used in some financial interest calculations.",a:"Days between two dates on a 360-day year.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"An indicator of what day count method to use.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"Converts a provided year, month, and day into a date.",a:"Converts year/month/day into a date.",m:[3,3],p:[{name:"year",detail:"The year component of the date.",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The month component of the date.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"The day component of the date.",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"Converts a provided date string in a known format to a date value.",a:"Converts a date string to a date value.",m:[1,1],p:[{name:"date_string",detail:"The string representing the date.",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"Calculates the number of days, months, or years between two dates.",a:"Date Difference.",m:[3,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"unit",detail:'A string abbreviation for unit of time. For example, "M" for month. Accepted values are "Y","M","D","MD","YM","YD".',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"Calculates the date after a number of working days from a specified start date.",a:"Number of working days from start date.",m:[2,3],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:"Calculates the date after a specified number of workdays excluding specified weekend days and holidays.",a:"Date after a number of workdays (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"Returns the year specified by a given date.",a:"Year specified by a given date.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the year.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:"Returns the number of years, including fractional years, between two dates using a specified day count convention.",a:"Exact number of years between two dates.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"Returns the current date as a date value.",a:"Current date as a date value.",m:[0,0],p:[]},{n:"MONTH",t:6,d:"Returns the month of the year a specific date falls in, in numeric format.",a:"Month of the year a specific date falls in.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the month.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",a:"Annual effective interest rate.",m:[2,2],p:[{name:"nominal_rate",detail:"The nominal interest rate per year.",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"Formats a number into the currency specific to your spreadsheet locale.",a:"Formats a number as currency specific to your spreadsheet locale.",m:[1,2],p:[{name:"number",detail:"The value to be formatted.",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"Converts a price quotation given as a decimal fraction into a decimal value.",a:"Converts a decimal fraction to decimal value.",m:[2,2],p:[{name:"fractional_price",detail:"The price quotation given using fractional decimal conventions.",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"Converts a price quotation given as a decimal value into a decimal fraction.",a:"Converts a decimal value to decimal fraction.",m:[2,2],p:[{name:"decimal_price",detail:"The price quotation given as a decimal value.",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"unit",detail:"The units of the desired fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"Calculates the depreciation of an asset for a specified period using the arithmetic declining balance method.",a:"Depreciation via declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"The number of months in the first year of depreciation.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"Calculates the depreciation of an asset for a specified period using the double-declining balance method.",a:"Depreciation via double-declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"The factor by which depreciation decreases.",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"Calculates the interest rate of an annuity investment based on constant-amount periodic payments and the assumption of a constant interest rate.",a:"Interest rate of an annuity investment.",m:[3,6],p:[{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_per_period",detail:"The amount per period to be paid.",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"rate_guess",detail:"An estimate for what the interest rate will be.",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"Calculates the cumulative principal paid over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative principal paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"Calculates the number of coupons, or interest payments, between the settlement date and the maturity date of the investment.",a:"Number of coupons between settlement and maturity.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"Calculates the depreciation of an asset for a specified period using the sum of years digits method.",a:"Depreciation via sum of years digits method.",m:[4,4],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"Calculates the equivalent annualized rate of return of a US Treasury Bill based on discount rate.",a:"Equivalent rate of return for a Treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"Calculates the yield of a US Treasury Bill based on price.",a:"The yield of a us treasury bill based on price.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"Calculates the price of a US Treasury Bill based on discount rate.",a:"Price of US treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"Calculates the present value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Present value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"Calculates the accrued interest of a security that has periodic payments.",a:"Accrued interest of security with periodic payments.",m:[6,8],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_payment",detail:"The first date interest will be paid.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:`[Optional-defaults to TRUE()] - A logical value that specifies the method used to calculate the total accrued interest when the settlement date is later than the first interest accrual date. 

If the value is TRUE, the total accrued interest from the issue date to the settlement date is returned. 

If the value is FALSE, return the accrued interest from the first interest accrual date to the settlement date.`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"Calculates the accrued interest of a security that pays interest at maturity.",a:"Accrued interest of security paying at maturity.",m:[4,5],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity date of the security.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"Calculates the number of days from the first coupon, or interest payment, until settlement.",a:"Number of days from first coupon to settlement.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"Calculates the number of days in the coupon, or interest payment, period that contains the specified settlement date.",a:"Days in coupon period containing settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"Calculates the number of days from the settlement date until the next coupon, or interest payment.",a:"Days from settlement until next coupon.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"Calculates next coupon, or interest payment, date after the settlement date.",a:"Next coupon date after the settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"Calculates last coupon, or interest payment, date before the settlement date.",a:"Last coupon date before settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"Calculates the future value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Future value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"Calculates the future value of some principal based on a specified series of potentially varying interest rates.",a:"Future value of principal from series of rates.",m:[2,2],p:[{name:"principal",detail:"The amount of initial capital or value to compound against.",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"rate_schedule",detail:"A series of interest rates to compound against the `principal`.",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"Calculates the annual yield of a security paying periodic interest, such as a US Treasury Bond, based on price.",a:"Annual yield of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"Calculates the annual yield of a discount (non-interest-bearing) security, based on price.",a:"Annual yield of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"Calculates the annual nominal interest rate given the effective rate and number of compounding periods per year.",a:"Annual nominal interest rate.",m:[2,2],p:[{name:"effective_rate",detail:"The effective interest rate per year.",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"Calculates the internal rate of return of an investment based on a specified series of potentially irregularly spaced cash flows.",a:"Internal rate of return given non-periodic cashflows.",m:[2,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"An array or range with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"Calculates the modified internal rate of return on an investment based on a series of periodic cash flows and the difference between the interest rate paid on financing versus the return received on reinvested income.",a:"Modified internal rate of return.",m:[3,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"financing_rate",detail:"The interest rate paid on funds invested.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvestment_return_rate",detail:"The return (as a percentage) earned on reinvestment of income received from the investment.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:"Calculates the internal rate of return on an investment based on a series of periodic cash flows.",a:"Internal rate of return given periodic cashflows.",m:[1,2],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"Calculates the net present value of an investment based on a series of periodic cash flows and a discount rate.",a:"The net present value of an investment based on a series of periodic cash flows and a discount rate.",m:[2,255],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow1",detail:"The first future cash flow.",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"cashflow2",detail:"Additional future cash flows.",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"Calculates the net present value of an investment based on a specified series of potentially irregularly spaced cash flows and a discount rate.",a:"Net present value given non-periodic cashflows.",m:[3,3],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"cashflow_amounts",detail:"A range of cells containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"A range of cells with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"Calculates the cumulative interest over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative interest paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"Calculates the periodic payment for an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Periodic payment for an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"Calculates the payment on interest for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on interest for an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"Calculates the payment on the principal of an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on the principal of an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"Calculates the effective interest rate generated when an investment is purchased at one price and sold at another with no interest or dividends generated by the investment itself.",a:"Calculates effective interest rate.",m:[4,5],p:[{name:"buy_date",detail:"The date of purchase of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"sell_date",detail:"The date of sale of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"buy_price",detail:"The price at which the investment was purchased.",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"sell_price",detail:"The price at which the investment was sold.",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"Calculates the price of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Price of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"Calculates the price of a discount (non-interest-bearing) security, based on expected yield.",a:"Price of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"The discount rate of the security at time of purchase.",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"Calculates the price of a security paying interest at maturity, based on expected yield.",a:"Price of security paying interest at maturity.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"Calculates the amount received at maturity for an investment in fixed-income securities purchased on a given date.",a:"Amount received at maturity for a security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"The amount invested (irrespective of face value of each security).",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"The discount rate of the security invested in.",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"Calculates the discount rate of a security based on price.",a:"The discount rate of a security based on price.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"Calculates the number of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Number of payment periods for an investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"payment_amount",detail:"The amount of each payment made.",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"present_value",detail:"The current value of the annuity.",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"Calculates the depreciation of an asset for one period using the straight-line method.",a:"Depreciation of asset using the straight-line method.",m:[3,3],p:[{name:"cost",detail:"The initial cost of the asset.",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"Calculates the number of compounding periods required for an investment of a specified present value appreciating at a given rate to reach a target value.",a:"Number of periods for an investment to reach a value.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"Calculates the modified Macaulay duration of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Modified Macaulay duration.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"Converts a signed binary number to decimal format.",a:"Converts a signed binary number to decimal format.",m:[1,1],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"Converts a signed binary number to signed hexadecimal format.",a:"Converts a binary number to hexadecimal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed hexademical, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"Converts a signed binary number to signed octal format.",a:"Converts a binary number to octal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed octal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"Converts a decimal number to signed binary format.",a:"Converts a decimal number to signed binary format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed binary, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"Converts a decimal number to signed hexadecimal format.",a:"Converts a decimal number to hexadecimal.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed hexadecimal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"Converts a decimal number to signed octal format.",a:"Converts a decimal number to signed octal format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed octal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"Converts a signed hexadecimal number to signed binary format.",a:"Converts a hexadecimal number to binary.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed binary, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"Converts a signed hexadecimal number to decimal format.",a:"Converts a hexadecimal number to decimal.",m:[1,1],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to decimal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"Converts a signed hexadecimal number to signed octal format.",a:"Converts a hexadecimal number to octal.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed octal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"Converts a signed octal number to signed binary format.",a:"Converts an octal number to binary.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed binary, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"Converts a signed octal number to decimal format.",a:"Converts a signed octal number to decimal format.",m:[1,1],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to decimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"Converts a signed octal number to signed hexadecimal format.",a:"Converts an octal number to hexadecimal.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed hexadecimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:"Creates a complex number given real and imaginary coefficients.",a:"Creates a complex number.",m:[2,3],p:[{name:"real_part",detail:"The real coefficient.",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"imaginary_part",detail:"The imaginary coefficient.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:"The suffix for the imaginary coefficient, can only be 'i' or 'j'. If omitted, 'i' will be used.",example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"Returns the real coefficient of a complex number.",a:"The real coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:"Returns the imaginary coefficient of a complex number.",a:"The imaginary coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:"Returns the complex conjugate of a number.",a:"The complex conjugate of a number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the conjugate for.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:"Returns absolute value (or modulus) of a complex number.",a:"The absolute value of a complex number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the absolute value of.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"Compare two numeric values, returning 1 if they're equal.",a:"Compare two numeric values.",m:[1,2],p:[{name:"number1",detail:"The first number to compare.",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"The second number to compare.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:"Returns the sum of a series of complex numbers.",a:"Sum of a series of complex numbers.",m:[1,255],p:[{name:"value1",detail:"The first complex number or range to add together.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"Additional complex numbers or ranges to add to `value1`.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:"Returns the difference between two complex numbers.",a:"The difference between two complex numbers.",m:[2,2],p:[{name:"first_number",detail:"The complex number to subtract second_number from.",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"second_number",detail:"The complex number to subtract from first_number.",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:"Returns the result of multiplying a series of complex numbers together.",a:"Result of multiplying a series of complex numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"factor2",detail:"Additional complex numbers or ranges to calculate for the product.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:"Returns one complex number divided by another.",a:"One complex number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The complex number to be divided.",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"divisor",detail:"The complex number to divide by.",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:"Returns the opposite of a logical value - `NOT(TRUE)` returns `FALSE`; `NOT(FALSE)` returns `TRUE`.",a:"Returns opposite of provided logical value.",m:[1,1],p:[{name:"logical_expression",detail:"An expression or reference to a cell holding an expression that represents some logical value.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:"Returns the logical value `TRUE`.",a:"Logical value `true`.",m:[0,0],p:[]},{n:"FALSE",t:10,d:"Returns the logical value `FALSE`.",a:"Logical value `false`.",m:[0,0],p:[]},{n:"AND",t:10,d:"Returns true if all of the provided arguments are logically true, and false if any of the provided arguments are logically false.",a:"Logical `and` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that represent logical values.",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"Returns the first argument if it is not an error value, otherwise returns the second argument if present, or a blank if the second argument is absent.",a:"Value if it is not an error, otherwise 2nd argument.",m:[2,2],p:[{name:"value",detail:"The value to return if `value` itself is not an error.",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:"The value the function returns if `value` is an error.",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"Returns one value if a logical expression is `TRUE` and another if it is `FALSE`.",a:"Returns value depending on logical expression.",m:[2,3],p:[{name:"logical_expression",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"The value the function returns if `logical_expression` is `TRUE`.",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"The value the function returns if `logical_expression` is `FALSE`.",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"Returns true if any of the provided arguments are logically true, and false if all of the provided arguments are logically false.",a:"Logical `or` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical_expression2",detail:"More expressions that evaluate to logical values.",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",a:"Not equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for inequality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"Returns `TRUE` if two specified values are equal and `FALSE` otherwise. Equivalent to the `==` operator.",a:"Equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to test against `value1` for equality.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"Returns `TRUE` if the first argument is strictly greater than the second, and `FALSE` otherwise. Equivalent to the `>` operator.",a:"Strictly greater than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:"Returns `TRUE` if the first argument is greater than or equal to the second, and `FALSE` otherwise. Equivalent to the `>=` operator.",a:"Greater than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:"Returns `TRUE` if the first argument is strictly less than the second, and `FALSE` otherwise. Equivalent to the `<` operator.",a:"Less than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:"Returns `TRUE` if the first argument is less than or equal to the second, and `FALSE` otherwise. Equivalent to the `<=` operator.",a:"Less than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:"Returns the sum of two numbers. Equivalent to the `+` operator.",a:"Sum of two numbers",m:[2,2],p:[{name:"value1",detail:"The first addend.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The second addend.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"Returns the difference of two numbers. Equivalent to the `-` operator.",a:"Difference of two numbers",m:[2,2],p:[{name:"value1",detail:"The minuend, or number to be subtracted from.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"The subtrahend, or number to subtract from `value1`.",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"Returns the product of two numbers. Equivalent to the `*` operator.",a:"Product of two numbers",m:[2,2],p:[{name:"factor1",detail:"The first multiplicand.",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor2",detail:"The second multiplicand.",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"Returns one number divided by another. Equivalent to the `/` operator.",a:"One number divided by another",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"Returns the concatenation of two values. Equivalent to the `&` operator.",a:"Concatenation of two values",m:[2,2],p:[{name:"value1",detail:"The value to which `value2` will be appended.",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"The value to append to `value1`.",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"Returns a value interpreted as a percentage; that is, `UNARY_PERCENT(100)` equals `1`.",a:"Value interpreted as a percentage.",m:[1,1],p:[{name:"percentage",detail:"The value to interpret as a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"Appends strings to one another.",a:"Appends strings to one another.",m:[1,255],p:[{name:"string1",detail:"The initial string.",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"More strings to append in sequence.",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"Returns the numeric Unicode map value of the first character in the string provided.",a:"Numeric unicode map value of character.",m:[1,1],p:[{name:"string",detail:"The string whose first character's Unicode map value will be returned.",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"Convert a number into a character according to the current Unicode table.",a:"Gets character associated with number.",m:[1,1],p:[{name:"table_number",detail:"The number of the character to look up from the current Unicode table in decimal format.",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"Computes the value of a Roman numeral.",a:"Computes the value of a roman numeral.",m:[1,1],p:[{name:"roman_numeral",detail:"The Roman numeral to format, whose value must be between 1 and 3999, inclusive.",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"Formats a number in Roman numerals.",a:"Formats a number in Roman numerals.",m:[1,1],p:[{name:"number",detail:"The number to format, between 1 and 3999, inclusive.",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"Extracts matching substrings according to a regular expression.",a:"Extracts matching substrings with regular expression.",m:[2,2],p:[{name:"text",detail:"The input text.",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The first part of `text` that matches this expression will be returned.",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"Whether a piece of text matches a regular expression.",a:"Whether a piece of text matches regular expression.",m:[2,2],p:[{name:"text",detail:"The text to be tested against the regular expression.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression to test the text against.",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"Replaces part of a text string with a different text string using regular expressions.",a:"Replaces text with regular expressions.",m:[3,3],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"The regular expression.  All matching instances in `text` will be replaced.",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"Returns string arguments as text, or the empty string if the value is not text.",a:"String arguments as text.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"Formats a number with a fixed number of decimal places.",a:"Formats number with fixed number of decimal places.",m:[1,3],p:[{name:"number",detail:"The number to format.",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"number_of_places",detail:"The number of decimal places to display in the result.",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"suppress_separator",detail:"Whether or not to suppress the thousands separator used in some locales (e.g. `1,000` becomes `1000`). Separators will be present if this value is 0 or omitted, and absent otherwise.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"Returns the position at which a string is first found within text where the capitalization of letters matters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, case-sensitive.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"Returns the position at which a string is first found within text counting each double-character as 2.",a:"Position at which a string is first found within text (binary).",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"new"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:'"new year"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.",a:"Concatenates elements of arrays with delimiter.",m:[2,255],p:[{name:"delimiter",detail:"The character or string to place between each concatenated value.",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array1",detail:"The value or values to be appended using `delimiter`.",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"value_or_array2",detail:"More values to be appended using `delimiter`.",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"Returns a substring from the beginning of a specified string.",a:"Substring from beginning of specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the left portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the left side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"Returns a substring from the end of a specified string.",a:"A substring from the end of a specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the right portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"number_of_characters",detail:"The number of characters to return from the right side of `string`.",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"Returns a segment of a string.",a:"A segment of a string.",m:[3,3],p:[{name:"string",detail:"The string to extract a segment from.",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The index from the left of `string` from which to begin extracting. The first character in `string` has the index 1.",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"extract_length",detail:"The length of the segment to extract.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"Returns the length of a string.",a:"Length of a string.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"Returns the length of a string in bytes.",a:"Length of a string in bytes.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"Converts a specified string to lowercase.",a:"Converts a specified string to lowercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to lowercase.",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"Converts a specified string to uppercase.",a:"Converts a specified string to uppercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to uppercase.",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"Tests whether two strings are identical.",a:"Tests whether two strings are identical.",m:[2,2],p:[{name:"string1",detail:"The first string to compare",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"string2",detail:"The second string to compare",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"Replaces part of a text string with a different text string.",a:"Replaces part of a text string with different text.",m:[4,4],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"position",detail:"The position where the replacement will begin (starting from 1).",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"length",detail:"The number of characters in the text to be replaced.",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"Returns specified text repeated a number of times.",a:"Specified text repeated a number of times.",m:[2,2],p:[{name:"text_to_repeat",detail:"The character or string to repeat.",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_of_repetitions",detail:"The number of times `text_to_repeat` should appear in the value returned.",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"Returns the position at which a string is first found within text and ignores capitalization of letters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, ignoring case.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"Replaces existing text with new text in a string.",a:"Replaces existing text with new text in a string.",m:[3,4],p:[{name:"text_to_search",detail:"The text within which to search and replace.",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"search_for",detail:"The string to search for within `text_to_search`.",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"replace_with",detail:"The string that will replace `search_for`.",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"occurrence_number",detail:"The instance of `search_for` within `text_to_search` to replace with `replace_with`. By default, all occurrences of `search_for` are replaced; however, if `occurrence_number` is specified, only the indicated instance of `search_for` is replaced.",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"Returns the text with the non-printable ASCII characters removed.",a:"Removes non-printable characters from a piece of text.",m:[1,1],p:[{name:"text",detail:"The text whose non-printable characters are to be removed.",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"Converts a number into text according to a specified format.",a:"Formats a number into text.",m:[2,2],p:[{name:"number",detail:"The number, date, or time to format.",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format",detail:"The pattern by which to format the number, enclosed in quotation marks.",example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"Removes leading, trailing, and repeated spaces in text.",a:"Removes space characters.",m:[1,1],p:[{name:"text",detail:"The text or reference to a cell containing text to be trimmed.",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"Converts a string in any of the date, time or number formats that Google Sheets understands into a number.",a:"Converts a date/time/number string into a number.",m:[1,1],p:[{name:"text",detail:"The string containing the value to be converted.",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"Capitalizes each word in a specified string.",a:"Capitalizes each word in a specified string.",m:[1,1],p:[{name:"text_to_capitalize",detail:"The text which will be returned with the first letter of each word in uppercase and all other letters in lowercase.",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"Converts a numeric value to a different unit of measure.",a:"Unit conversion for numbers.",m:[3,3],p:[{name:"value",detail:"The numeric value in `start_unit` to convert to `end_unit`.",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"start_unit",detail:"The starting unit, the unit currently assigned to `value`.",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"end_unit",detail:"The unit of measure into which to convert the argument, `value`.",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"Calculates the sum of the differences of the squares of values in two arrays.",a:"Sum of the differences of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be reduced by the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be subtracted from the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"Calculates the sum of the sums of the squares of values in two arrays.",a:"Sum of the sums of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"Calculates the sum of the squares of differences of values in two arrays.",a:"Sum of the squares of differences.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values that will be reduced by corresponding entries in `array_y`, squared, and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"The array or range of values that will be subtracted from corresponding entries in `array_x`, the result squared, and all such results added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"Transposes the rows and columns of an array or range of cells.",a:"Transposes the rows and columns of an array.",m:[1,1],p:[{name:"array_or_range",detail:"The array or range whose rows and columns will be swapped.",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"Given partial data about a linear trend, fits an ideal linear trend using the least squares method and/or predicts further values.",a:"Fits points to linear trend derived via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general linear form of `y = m*x+b` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"Calculates the frequency distribution of a one-column array into specified classes.",a:"The frequency distribution of array.",m:[2,2],p:[{name:"data",detail:"The array or range containing the values to be counted.",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"classes",detail:"The array or range containing the set of classes.",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"Given partial data about an exponential growth trend, fits an ideal exponential growth trend and/or predicts further values.",a:"Fits points to exponential growth trend.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"Given partial data about a linear trend, calculates various parameters about the ideal linear trend using the least-squares method.",a:"Best-fit linear trend via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"calculate_b",detail:"Given a linear form of `y = m*x+b`, calculates the y-intercept (`b`) if `TRUE`. Otherwise, forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the linear coefficients and the y-intercept (default).",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"Given partial data about an exponential growth curve, calculates various parameters about the best fit ideal exponential growth curve.",a:"Best-fit exponential growth curve.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the calculated coefficient and exponents.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"Returns the matrix determinant of a square matrix specified as an array or range.",a:"Matrix determinant of a square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose determinant will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"Returns the multiplicative inverse of a square matrix specified as an array or range.",a:"Multiplicative inverse of square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose multiplicative inverse will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"Calculates the matrix product of two matrices specified as arrays or ranges.",a:"The matrix product of two matrices.",m:[2,2],p:[{name:"matrix1",detail:"The first matrix in the matrix multiplication operation, represented as an array or range.",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"matrix2",detail:"The second matrix in the matrix multiplication operation, represented as an array or range.",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"Calculates the sum of the products of corresponding entries in two equal-sized arrays or ranges.",a:"Sum of products of elements in two arrays.",m:[1,255],p:[{name:"array1",detail:"The first array or range whose entries will be multiplied with corresponding entries in the second such array or range.",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"The second array or range whose entries will be multiplied with corresponding entries in the first such array or range.",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"Checks whether a value is a formula.",a:"Whether a value is a formula.",m:[1,1],p:[{name:"cell",detail:"The cell to be verified as containing a formula.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"Returns the requested information about the specified cell.",a:"Gets information about a cell.",m:[2,2],p:[{name:"info_type",detail:"The type of information requested (see article for available types)",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"The reference to the cell.",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:'Returns the "value not available" error, `#N/A`.',a:"The `#N/A` error.",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"Returns a number corresponding to the error value in a different cell.",a:"Error value of cell (as number).",m:[1,1],p:[{name:"reference",detail:"The cell to find the error number for although you can also provide the error value directly.",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"Checks whether the referenced cell is empty.",a:"Whether the referenced cell is empty.",m:[1,1],p:[{name:"value",detail:"Reference to the cell that will be checked for emptiness.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"Checks whether a value is an error other than `#N/A`.",a:"Whether a value is an error other than `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type other than `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"Checks whether a value is an error.",a:"Whether a value is an error.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"Checks whether a value is `TRUE` or `FALSE`.",a:"Whether a value is `true` or `false`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a logical `TRUE` or `FALSE`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"Checks whether a value is the error `#N/A`.",a:"Whether a value is the error `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be compared with the error value `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"Checks whether a value is non-textual.",a:"Whether a value is non-textual.",m:[1,1],p:[{name:"value",detail:"The value to be checked.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"Checks whether a value is a number.",a:"Whether a value is a number.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"Checks whether a value is a valid cell reference.",a:"Whether a value is a valid cell reference.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a cell reference.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"Checks whether a value is text.",a:"Whether a value is text.",m:[1,1],p:[{name:"value",detail:"The value to be verified as text.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"Returns a number associated with the type of data passed into the function.",a:"Get the type of a value.",m:[1,1],p:[{name:"value",detail:"The value whose type is to be determined.",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"Returns the argument provided as a number. Text is converted to 0 and errors are returned as-is.",a:"Argument provided as a number.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to a number.",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"Converts a provided number to a date.",a:"Converts a provided number to a date.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a date.",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"Converts a provided date/time, percentage, currency or other formatted numeric value to a pure number without formatting.",a:"Converts any numeric value to a pure number.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a pure number.",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"Converts a provided numeric value to a text value.",a:"Converts a provided numeric value to a text value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to text.",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"Converts a provided number to a dollar value.",a:"Converts a provided number to a dollar value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a dollar value.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"Converts a provided number to a percentage.",a:"Converts a provided number to a percentage.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a percentage.",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"Returns a single value from a database table-like array or range using a SQL-like query.",a:"Single value from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"Returns the maximum value selected from a database table-like array or range using a SQL-like query.",a:"Maximum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"Returns the minimum value selected from a database table-like array or range using a SQL-like query.",a:"Minimum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"Returns the average of a set of values selected from a database table-like array or range using a SQL-like query.",a:"Average of a set of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"Counts numeric values selected from a database table-like array or range using a SQL-like query.",a:"Counts values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"Counts values, including text, selected from a database table-like array or range using a SQL-like query.",a:"Counts values and text from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"Returns the product of values selected from a database table-like array or range using a SQL-like query.",a:"Product of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"Returns the standard deviation of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of population sample from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"Returns the standard deviation of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of entire population from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"Returns the sum of values selected from a database table-like array or range using a SQL-like query.",a:"Sum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"Returns the variance of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Variance of population sample from table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"Returns the variance of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Variance of a population from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"Calculate the age based on the Chinese ID number. Support 15 or 18",a:"Get age based on ID number.",m:[1,2],p:[{name:"ID number",example:"A1",detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Deadline",example:'"2017-10-01"',detail:"The deadline or range of age calculation. The default is the current day.",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"Calculate gender based on Chinese ID number. Support 15 or 18",a:"Get gender based on ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"Calculate the birthday based on the Chinese ID number. Support 15 or 18",a:"Get the birthday based on the ID number.",m:[1,2],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"},{name:"Birthday format",example:"0",detail:"Date type, default:0:[1900/01/01], 1:[1900-01-01], 2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"Calculate the province of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the province of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"Calculate the city of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the city of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"Calculate the constellation based on the Chinese ID number. Support 15 or 18",a:"Get the constellation based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"Calculate the zodiac (rat, ox, tiger, rabbit...) based on the Chinese ID number. Support 15 or 18",a:"Get the zodiac according to the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"Verify that the format of the ID card is correct. Support 15 or 18",a:"Verify the correctness of the ID card format.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"Text segmentation. Split a series of words into a series of individual words",a:"Chinese text segmentation.",m:[1,2],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Word segmentation mode",example:"0",detail:"The default is 0[precision mode], 1[full mode], 2[search engine mode].",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"Use tf-idf algorithm for keyword extraction. Identify keywords from a series of text",a:"tf-idf keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"Use TextRank algorithm to extract keywords. Identify keywords from a series of text",a:"TextRank keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeall"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangenumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"According to the stock code and date, return the corresponding stock closing price of A shares.",a:"Returns the closing price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"According to the stock code and date, return the opening price of stock.",a:"Return the opening price of a shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"According to the stock code and date, return the highest price of stock.",a:"Return the highest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"According to the stock code and date, return the lowest price of stock.",a:"Returns the lowest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"According to the stock code and date, return the corresponding stock trading volume of A shares.",a:"Returns the corresponding stock trading volume of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"According to the stock code and date, return the corresponding stock turnover of A shares.",a:"Returns the corresponding stock turnover of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeall"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"Returns whether a value is a date.",a:"Whether a value is a date.",m:[1,1],p:[{name:"value",example:'"1990-01-01"',detail:"The value to be verified as a date.",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"Generate sparklines embedded in the cell to describe the continuous trend of data",a:"Generate sparklines line chart",m:[1,8],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"},{name:"Maximum mark",example:"#fc5c5c",detail:"Identifies the maximum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Minimum mark",example:"#fc5c5c",detail:"Identify the minimum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Mark size",example:"1.5",detail:"The maximum and minimum mark size settings, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"Generate sparklines embedded in the cell area chart, generally used to describe the continuous cumulative value trend of the data",a:"Generate sparklines area chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Fill color",example:"#CCF3F4",detail:"Form an area chart, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeall"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"Generate sparklines embedded in the vertical histogram of cells, generally used to describe the size of discrete data",a:"Generate sparklines vertical histogram",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"Generate sparklines, a cumulative vertical histogram embedded in a cell, generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative vertical histogram",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the size of discrete data",a:"Generate sparklines horizontal bar graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"Generate sparklines, a cumulative horizontal bar graph embedded in a cell, which is generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative horizontal bar graph",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the trend of discrete data",a:"Generate sparklines discrete graph",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Segmentation threshold",example:"1",detail:"Discrete graph column color distinction, for example: if the value is 0, blue is greater than 0, red is less than 0, and the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"Above threshold color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"Below threshold color",example:"#fc5c5c",detail:"The color setting of the bar below the threshold, the same as the color above the threshold, default #fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"Generate sparklines, a three-state graph embedded in the cell, which is generally used to describe the trend of three situations, such as winning, losing, or drawing.",a:"Generate sparklines three-state graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeall"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeall"},{name:"Zero value bar color",example:"#999",detail:"Zero value bar color setting, representing 0 value color, the same color configuration of the bar, default #999",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"Generate sparklines pie chart embedded in the cell, generally used to describe the proportion of data",a:"Generate sparklines pie chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Rotation angle",example:"0",detail:"The rotation angle of the pie chart, the default is 0",require:"o",repeat:"n",type:"rangeall"},{name:"border",example:"0",detail:"Pie chart border size, default is none 0",require:"o",repeat:"n",type:"rangeall"},{name:"Border color",example:"#000",detail:"The border color of the pie chart, the default is #000",require:"o",repeat:"n",type:"rangeall"},{name:"Color palette",example:"#97b552",detail:"The color of the slice can be set in the palette, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"Generate sparklines embedded in the cell box plot, generally used to describe the statistical distribution of the data set",a:"Generate sparklines box plot",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"RangeValues can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Outlier ratio",example:"1.5",detail:"The threshold range of outliers, if it is 0 or false, it will not be displayed, the default is 1.5 times",require:"o",repeat:"n",type:"rangeall"},{name:"Target value",example:"10",detail:"The target value setting on the box plot, the default is false and does not display",require:"o",repeat:"n",type:"rangeall"},{name:"Point size",example:"1.5",detail:"The radius of the target point and outlier is set, the default is 1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the task achievement rate",a:"Generating sparklines bullets",m:[2,3],p:[{name:"Target",example:"10",detail:"The numerical value can be calculated effectively for the achieved target value, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"achieved",example:"8",detail:"Only when the value is completed can the value be calculated effectively, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeall"},{name:"Contrast",example:"12",detail:"Comparative values, such as excess, minimum, and bottom line for awards, can be effectively calculated, such as A1, 100, etc. You can set up to 9 comparison values",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"Support multiple types of pictures in the same cell, each parameter represents a sparklines diagram",a:"Combine sparklines graphs into one cell",m:[1,1],p:[{name:"config",example:"PIESPLINES(A1:A20)",detail:"Sparklines chart settings, such as A1:A20, a completed pie chart, line chart settings, etc.",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"Sorts the rows of a given array or range by the values in one or more columns.",a:"Sorts rows of range by specified column.",m:[1,4],p:[{name:"range",detail:"The data to be sorted.",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_column",detail:"The index of the column in `range` or a range outside of `range` containing the values by which to sort.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"is_ascending",detail:"`TRUE` or `FALSE` indicating whether to sort `sort_column` in ascending order. `FALSE` sorts in descending order.",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_column2",detail:"Additional columns.",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.",a:"Filters a range based off provided conditions.",m:[2,3],p:[{name:"range",detail:"The data to be filtered.",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"condition1",detail:"A column or row containing true or false values corresponding to the first column or row of `range`, or an array formula evaluating to true or false.",example:"1",require:"m",repeat:"n",type:"range"},{name:"condition2",detail:"Additional rows or columns containing boolean values `TRUE` or `FALSE` indicating whether the corresponding row or column in `range` should pass through `FILTER`. Can also contain array formula expressions which evaluate to such rows or columns. All conditions must be of the same type (row or column). Mixing row conditions and column conditions is not permitted.",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range.",a:"Unique rows in the provided source range.",m:[1,3],p:[{name:"range",detail:"The data to filter by unique entries.",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[Option] - Logical value, indicating how to compare; by row = FALSE() or omitted; by column = TRUE().",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[Option] - Logical value, only one occurrence in the unique value is returned = TRUE(); including all unique values = FALSE() or omitted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"Returns a grid of random numbers between 0 inclusive and 1 exclusive. The grid size will match the provided rows and columns arguments. If neither rows nor columns are provided, then the grid will be size 1 x 1.",a:"Returns a grid of random numbers.",m:[0,2],p:[{name:"rows",detail:"The number of rows to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"Returns a grid of sequential numbers starting at a specified start value and  increasing by a specified step size. By default, the sequence starts at and  increases by 1.",a:"Returns a grid of sequential numbers.",m:[1,4],p:[{name:"rows",detail:"The number of rows in the function's resulting grid.",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"columns",detail:"The number of columns in the function's resulting grid. If omitted, the result grid will have 1 column.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"The number, at which to start the sequence. If omitted, the sequence will start at 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"The amount each value in the sequence will differ by. If omitted, each value will differ by 1.",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"Evaluate a formula or expression expressed in words and return the result",a:"Evaluate according to literal formula or expression.",m:[1,1],p:[{name:"expression",example:'"A1+5*2^2"',detail:"Formula or expression",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"Deshacer",redo:"Rehacer",paintFormat:"Clonar formato",currencyFormat:"Formato de moneda",percentageFormat:"Formato de porcentaje",numberDecrease:"Menos decimales",numberIncrease:"Ms decimales",moreFormats:"Ms formatos",font:"Fuente",fontSize:"Tamao Fuente",bold:"Negrita (Ctrl+B)",italic:"Itlica (Ctrl+I)",strikethrough:"Tachar (Alt+Shift+5)",underline:"Guion bajo",textColor:"Color texto",chooseColor:"elegir color",resetColor:"Reinicializar",customColor:"PERSONALIZADO",alternatingColors:"Colores alternos",confirmColor:"Vale",cancelColor:"Cancelar",collapse:"Recoger",fillColor:"Color de relleno",border:"Borde",borderStyle:"Estilo Borde",mergeCell:"Juntar celdas",chooseMergeType:"Elegir tipo de unin",horizontalAlign:"Alineacin Horizontal",verticalAlign:"Alineacin Vertical",alignment:"Alineacin",textWrap:"Ajuste de texto",textWrapMode:"Modo de ajuste de texto",textRotate:"Rotar texto",textRotateMode:"Modo de rotar texto",freezeTopRow:"Fijar fila superior",sortAndFilter:"Ordenar y filtrar",findAndReplace:"Buscar y reemplazar",sum:"SUMA",autoSum:"SUMA automtica",moreFunction:"Ms funciones",conditionalFormat:"Formato condicional",postil:"Comentario",pivotTable:"Tabla Dinmica",chart:"Grfica",screenshot:"Captura de pantalla",splitColumn:"Separar texto",insertImage:"Insertar imagen",dataVerification:"Verificacin de datos",protection:"Proteger la hoja",clearText:"Limpiar color",noColorSelectedText:"Ningn color seleccionado",toolMore:"Ms",toolLess:"Menos",toolClose:"Cerrar",toolMoreTip:"Ms funcionalidades",moreOptions:"Ms opciones",cellFormat:"Configuracin formato de celda",print:"Imprimir"},alternatingColors:{applyRange:"Aplicar a rango",selectRange:"Seleccionar un rango de datos",header:"Cabecera",footer:"Pie",errorInfo:"No se puede realizar esta operacin en varias reas de seleccin, selecciona una sola rea y vuelve a intentarlo",textTitle:"Estilo Formato",custom:"PERSONALIZADO",close:"cerrar",selectionTextColor:"Haz clic para seleccionar el color del texto",selectionCellColor:"Haz clic para seleccionar el color de la celda",removeColor:"Eliminar colores alternos",colorShow:"color",currentColor:"Actual",tipSelectRange:"Selecciona la gama de colores alternos",errorNoRange:"No hay ningn rango seleccionado",errorExistColors:"Los colores alternos ya existen y no se pueden editar"},button:{confirm:"Vale",cancel:"Cancelar",close:"Cerrar",update:"Actualizar",delete:"Eliminar",insert:"Insertar"},paint:{start:"Inicio clonar formato",end:"ESC",tipSelectRange:"Selecciona el rango que quieres copiar",tipNotMulti:"No se puede realizar esta operacin en un rango de seleccin mltiple"},format:{moreCurrency:"Ms formatos de moneda",moreDateTime:"Ms formatos de fecha y hora",moreNumber:"Ms formatos de nmero",titleCurrency:"Formatos de moneda",decimalPlaces:"Decimales",titleDateTime:"Formatos de fecha y hora",titleNumber:"Formatos de nmeros"},info:{detailUpdate:"Nuevo abierto",detailSave:"Cache local restaurado",row:"",column:"",loading:"Cargando",copy:"Copiar",return:"Salir",rename:"Renombrar",tips:"Renombrar Libro",noName:"Hoja sin ttulo",wait:"esperando actualizacin",add:"Aadir",addLast:"ms filas al final",backTop:"Volver arriba",pageInfo:"Total ${total}pgina ${totalPage}actual ${currentPage}",nextPage:"Siguiente",tipInputNumber:"Introduce el nmero",tipInputNumberLimit:"El rango de aumento est limitado a 1-100",tipRowHeightLimit:"La altura de la fila debe estar entre 0 ~ 545",tipColumnWidthLimit:"El ancho de la columna debe estar entre 0 ~ 2038",pageInfoFull:"Total ${total}pgina ${totalPage}Se muestran todos los datos"},currencyDetail:{RMB:"RMB",USdollar:"Dlar US",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"},defaultFmt:[{text:"Automtico",value:"General",example:""},{text:"Texto",value:"@",example:""},{text:"",value:"partir",example:""},{text:"Nmero",value:"##0.00",example:"1000.12"},{text:"Porcentaje",value:"#0.00%",example:"12.21%"},{text:"Cientfico",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"Contabilidad",value:"(0.00)",example:"(1200.09)"},{text:"Moneda",value:"0.00",example:"1200.09"},{text:"",value:"partir",example:""},{text:"Fecha",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"Hora",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"Hora 24H",value:"hh:mm",example:"15:00"},{text:"Fecha Hora",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"Fecha Hora 24 H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"partir",example:""},{text:"Formatos personalizados",value:"fmtOtherSelf",example:"ms"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],fontFamily:{MicrosoftYaHei:"YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana"],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3},border:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{mergeAll:"Unir todo",mergeV:"Verticalmente",mergeH:"Horizontalmente",mergeCancel:"Separar",overlappingError:"No se pueden fusionar reas superpuestas",partiallyError:"No se puede realizar esta operacin en celdas parcialmente unidas"},align:{left:"izquierda",center:"centro",right:"derecha",top:"Arriba",middle:"Centro",bottom:"Abajo"},textWrap:{overflow:"Desbordar",wrap:"Ajustar",clip:"Cortar"},rotation:{none:"Ninguno",angleup:"Ladear Arriba",angledown:"Ladear Abajo",vertical:"Apilar Verticalmente",rotationUp:"Rotar Arriba",rotationDown:"Rotar Abajo"},freezen:{default:"Fijar",freezenRow:"Primera Fila",freezenColumn:"Primera Columna",freezenRC:"Ambas",freezenRowRange:"Fijar rango filas",freezenColumnRange:"Fijar rango columnas",freezenRCRange:"Fijar ambos rangos",freezenCancel:"Cancelar",noSeletionError:"No hay rango para seleccionar"},sort:{asc:"Ascendente ",desc:"Descendente ",custom:"Ordenacin personalizada",hasTitle:"Los datos tienen una fila de encabezado",sortBy:"Ordenar por",addOthers:"Aadir otra columna de ordenacin",close:"cerrar",confirm:"ordenar",columnOperation:"Columna",secondaryTitle:"y despus por",sortTitle:"Ordenar rango",sortRangeTitle:"Ordenar rango de",sortRangeTitleTo:"a",noRangeError:"No se puede realizar esta operacin en mltiples reas de seleccin, selecciona un solo rango e intenta nuevamente",mergeError:"Hay celdas combinadas en la seleccin, esta operacin no se puede realizar!"},filter:{filter:"crear filtro",sortByAsc:"Ordenar A-Z",sortByDesc:"Ordenar Z-A",filterByColor:"Filtrar por color",filterByCondition:"Filtrar por condicin",filterByValues:"Filtrar por valores",filiterInputNone:"Ninguno",filiterInputTip:"Introduce valor de filtro",filiterRangeStartTip:"Valor para frmula",filiterRangeEndTip:"Valor para frmula",filterValueByAllBtn:"Seleccionar todos",filterValueByClearBtn:"Limpiar",filterValueByInverseBtn:"Invertir",filterValueByTip:"filtrar por valores",filterConform:"Confirmar",filterCancel:"Cancelar",clearFilter:"Quitar filtro",conditionNone:"Ninguno",conditionCellIsNull:"Est vaco",conditionCellNotNull:"No est vaco",conditionCellTextContain:"El texto contiene",conditionCellTextNotContain:"El texto no contiene",conditionCellTextStart:"El texto empieza con",conditionCellTextEnd:"El texto termina con",conditionCellTextEqual:"El texto es exactamente",conditionCellDateEqual:"La fecha es",conditionCellDateBefore:"La fecha es anterior",conditionCellDateAfter:"La fecha es posterior",conditionCellGreater:"Mayor que",conditionCellGreaterEqual:"Mayor o igual que",conditionCellLess:"Menor que",conditionCellLessEqual:"Menor o igual que",conditionCellEqual:"Es igual a",conditionCellNotEqual:"No es igual a",conditionCellBetween:"Est entre",conditionCellNotBetween:"No est entre",filiterMoreDataTip:"Gran cantidad de datos! por favor espera",filiterMonthText:"Mes",filiterYearText:"Ao",filiterByColorTip:"Filtrar por color de celda",filiterByTextColorTip:"Filtrar por color de fuente",filterContainerOneColorTip:"Esta columna contiene solo un color",filterDateFormatTip:"Format fecha",valueBlank:"(Nulo)",mergeError:"Hay celdas combinadas en la seleccin del filtro, esta operacin no se puede realizar!"},rightclick:{copy:"Copiar",copyAs:"Copiar como",paste:"Pegar",insert:"Insertar",delete:"Eliminar",deleteCell:"Eliminar celda",deleteSelected:"Eliminar seleccionado ",hide:"Esconder",hideSelected:"Esconder seleccionado ",showHide:"Mostrar ocultos ",to:"Hacia",left:"Izquierda",right:"Derecha",top:"Arriba",bottom:"Abajo",moveLeft:"Mover izquierda",moveUp:"Mover arriba",add:"Aadir",row:"Fila",column:"Columna",width:"Ancho",height:"Alto",number:"Nmero",confirm:"Confirmar",orderAZ:"Ordenar A-Z",orderZA:"Ordenar Z-A",clearContent:"Limpiar contenido",matrix:"Operacin de Matriz",sortSelection:"Ordenar",filterSelection:"Filtrar",chartGeneration:"Crear grfico",firstLineTitle:"ttulo primera lnea",untitled:"sin ttulo",array1:"Matriz unidimensional",array2:"Matriz bidimensional",array3:"Matrices multidimensionales",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Desplazamiento Diagonal",offset:"Desplazamiento",boolean:"Booleana",flip:"Voltear",upAndDown:"Arriba y abajo",leftAndRight:"Izquierda y derecha",clockwise:"Sentido horario",counterclockwise:"Sentido anti-horario",transpose:"Transponer",matrixCalculation:"Clculo de matrices",plus:"Suma",minus:"Resta",multiply:"Multiplicacin",divided:"Divisin",power:"Exponenciacin",root:"Raz Cuadrada",log:"Logaritmo",delete0:"Eliminar valores nulos en ambos extremos",removeDuplicate:"Eliminar valores duplicados",byRow:"Por fila",byCol:"Por columna",generateNewMatrix:"Generar nueva matriz"},comment:{insert:"Insertar",edit:"Editar",delete:"Elimiar",showOne:"Mostrar/Ocular",showAll:"Mostrar/Ocular Todo"},screenshot:{screenshotTipNoSelection:"Selecciona el alcance de la captura de pantalla",screenshotTipTitle:"Advertencia!",screenshotTipHasMerge:"Esta operacin no se puede realizar en celdas combinadas",screenshotTipHasMulti:"Esta operacin no se puede realizar en varios rangos de seleccin",screenshotTipSuccess:"Exitoso",screenshotImageName:"Captura de pantalla",downLoadClose:"Cerrar",downLoadCopy:"Copiar al portapapeles",downLoadBtn:"Descargar",browserNotTip:"no es compatible con el navegador IE.",rightclickTip:'Haz clic con el botn derecho en la imagen y selecciona "copiar"',successTip:'Con xito (si falla el pegado, haz clic con el botn derecho en la imagen para "copiar imagen")'},splitText:{splitDelimiters:"Delimitadores",splitOther:"Otros",splitContinueSymbol:"Los separadores consecutivos se tratan como uno solo",splitDataPreview:"Previsualizar",splitTextTitle:"Partir texto",splitConfirmToExe:"Ya hay datos aqu, quieres reemplazarlos?",tipNoMulti:"No se puede realizar esta operacin en varias reas de seleccin, selecciona una nica rea y vuelve a intentarlo",tipNoMultiColumn:"Solo se puede convertir una columna de datos a la vez. El rea seleccionado puede tener varias filas, pero no varias columnas. Vuelve a intentarlo despus de seleccionar un solo rango de columnas"},imageText:{imageSetting:"Configuracin de imagen",close:"Cerrar",conventional:"Convencional",moveCell1:"Mover y cambiar el tamao de las celdas",moveCell2:"Mover y no cambiar el tamao de la celda",moveCell3:"No mover ni cambiar el tamao de la celda",fixedPos:"Posicin fija",border:"Borde",width:"Ancho",radius:"Radio",style:"Estilo",solid:"Slido",dashed:"Discontinua",dotted:"Punteado",double:"Doble",color:"Color"},punctuation:{tab:"Tabulacin",semicolon:"punto y coma",comma:"coma",space:"espacio"},findAndReplace:{find:"Encontrar",replace:"Reemplazar",goto:"Ir a",location:"Ubicacin",formula:"Frmula",date:"Fecha",number:"Nmero",string:"Texto",error:"Error",condition:"Condicin",rowSpan:"Intervalo de filas",columnSpan:"Intervalo de columnas",locationExample:"Ubicacin",lessTwoRowTip:"Selecciona al menos dos filas",lessTwoColumnTip:"Selecciona al menos dos columnas",findTextbox:"Encontrar Contenido",replaceTextbox:"Reemplazar Contenido",regexTextbox:"Expresin Regular",wholeTextbox:"Palabra entera",distinguishTextbox:"Distingue maysculas y minsculas",allReplaceBtn:"Reemplazar Todo",replaceBtn:"Reemplazar",allFindBtn:"Encontrar Todo",findBtn:"Encontrar siguiente",noFindTip:"No se encontr el contenido",modeTip:"Esta operacin no est disponible en este modo",searchTargetSheet:"Hoja",searchTargetCell:"Celda",searchTargetValue:"Valor",searchInputTip:"Introduce el contenido de la bsqueda",noReplceTip:"No hay nada que reemplazar",noMatchTip:"No se encontraron coincidencias",successTip:"${xlength} elementos encontrados",locationConstant:"Constante",locationFormula:"Frmula",locationDate:"Fecha",locationDigital:"Nmero",locationString:"Texto",locationBool:"Lgicos",locationError:"Error",locationNull:"Nulo",locationCondition:"Formato condicional",locationRowSpan:"Intervalo fila",locationColumnSpan:"Intervalo columna",locationTiplessTwoRow:"Selecciona al menos dos filas",locationTiplessTwoColumn:"Selecciona al menos dos columnas",locationTipNotFindCell:"Celda no encontrada"},sheetconfig:{delete:"Eliminar",copy:"Copiar",rename:"Renombrar",changeColor:"Cambiar color",hide:"Ocultar",unhide:"Mostrar",moveLeft:"Mover izquierda",moveRight:"Mover derecja",resetColor:"Reiniciar color",cancelText:"Cancelar",chooseText:"Confirmar color",tipNameRepeat:"El nombre de la pgina de la pestaa no se puede repetir! Revsalo",noMoreSheet:"El libro de trabajo contiene al menos una hoja de trabajo visual. Para eliminar la hoja de trabajo seleccionada, inserta una nueva hoja de trabajo o muestra una hoja de trabajo oculta",confirmDelete:"Ests seguro de eliminar",redoDelete:"Se puede deshacer con Ctrl+Z",noHide:"No se puede ocultar, al menos conserva una etiqueta de hoja",chartEditNoOpt:"Esta operacin no est permitida en el modo de edicin de grficos!",sheetNameSpecCharError:`El nombre no puede contener:[ ] :  ? * / ' "`,sheetNamecannotIsEmptyError:"El nombre de la hoja no puede estar vaco"},conditionformat:{conditionformat_greaterThan:"Conditionformat-GreaterThan",conditionformat_greaterThan_title:"Dar formato a celdas mayores que",conditionformat_lessThan:"Conditionformat-LessThan",conditionformat_lessThan_title:"Dar formato a celdas ms pequeas que",conditionformat_betweenness:"Conditionformat-Betweenness",conditionformat_betweenness_title:"Dar formato a celdas con valores entre",conditionformat_equal:"Conditionformat-Equal",conditionformat_equal_title:"Dar formato a celdas iguales a",conditionformat_textContains:"Conditionformat-TextContains",conditionformat_textContains_title:"Dar formato a las celdas que contienen el siguiente texto",conditionformat_occurrenceDate:"Conditionformat-OccurrenceDate",conditionformat_occurrenceDate_title:"Dar formato a celdas que contienen las siguientes fechas",conditionformat_duplicateValue:"Conditionformat-DuplicateValue",conditionformat_duplicateValue_title:"Dar formato a celdas que contienen los siguientes tipos de valores",conditionformat_top10:"Conditionformat-Top10",conditionformat_top10_percent:"Conditionformat-Top10%",conditionformat_top10_title:"Formatea las celdas con el valor ms alto",conditionformat_last10:"Conditionformat-Last10",conditionformat_last10_percent:"Conditionformat-Last10%",conditionformat_last10_title:"Formatea las celdas con el valor ms pequeo",conditionformat_AboveAverage:"Conditionformat-AboveAverage",conditionformat_AboveAverage_title:"Dar formato a celdas por encima del promedio",conditionformat_SubAverage:"Conditionformat-SubAverage",conditionformat_SubAverage_title:"Dar formato a celdas por debajo del promedio",rule:"Regla",newRule:"Nueva regla",editRule:"Editar regla",deleteRule:"Eliminar regla",deleteCellRule:"Eliminar regla de celda",deleteSheetRule:"Eliminar regla de hoja",manageRules:"Reglas administracin",showRules:"Muestra sus reglas de formato",highlightCellRules:"Resaltar reglas de celda",itemSelectionRules:"Reglas de seleccin de elementos",conditionformatManageRules:"Administrador de reglas de formato condicional",format:"Formatear",setFormat:"Establecer formato",setAs:"Establecer como",setAsByArea:"Para el rea seleccionada, establecer",applyRange:"Aplicar rango",selectRange:"Seleccionar rango de aplicacin",selectRange_percent:"Porcentaje del rango seleccionado",selectRange_average:"Valor promedio del rango seleccionado",selectRange_value:"Valor en el rango seleccionado",pleaseSelectRange:"Selecciona el rango de aplicacin",selectDataRange:"Seleccionar rango de datos",selectCell:"seleccionar celda",pleaseSelectCell:"Selecciona una celda",pleaseSelectADate:"Selecciona una fecha",pleaseEnterInteger:"Introduzca un nmero entero entre 1 y 1000",onlySingleCell:"Solo se puede hacer referencia a una sola celda",conditionValueCanOnly:"El valor de la condicin solo puede ser un nmero o una sola celda",ruleTypeItem1:"Aplicar formato a todas las celdas segn sus valores respectivos",ruleTypeItem2:"Solo formatear celdas que contengan",ruleTypeItem2_title:"Solo para celdas que cumplan las siguientes condiciones",ruleTypeItem3:"Aplicar formato solo a los nmeros superiores o inferiores",ruleTypeItem3_title:"Es el valor en la siguiente clasificacin",ruleTypeItem4:"Aplicar formato solo a los valores superiores o inferiores al promedio",ruleTypeItem4_title:"Es un valor que cumple las siguientes condiciones",ruleTypeItem5:"Aplicar formato solo a valores nicos o repetidos",ruleTypeItem6:"Use frmulas para determinar qu celdas formatear",formula:"frmula",textColor:"Color Texto",cellColor:"Color Celda",confirm:"Confirma",confirmColor:"Confirma color",cancel:"Cancela",close:"Cierra",clearColorSelect:"Limpiar seleccin de color",sheet:"Hoja",currentSheet:"Hoja actual",dataBar:"Barra de datos",dataBarColor:"Color barra de datos",gradientDataBar_1:"Barra de datos de degradado azul-blanco",gradientDataBar_2:"Barra de datos de degradado verde-blanco",gradientDataBar_3:"Barra de datos de degradado rojo-blanco",gradientDataBar_4:"Rayas de degradado de color naranja-blanco",gradientDataBar_5:"Rayas de degradado azul claro-blancas",gradientDataBar_6:"Barra de datos de degradado prpura-blanco",solidColorDataBar_1:"Barra de datos azul",solidColorDataBar_2:"Barra de datos verde",solidColorDataBar_3:"Barra de datos roja",solidColorDataBar_4:"Barra de datos naranja",solidColorDataBar_5:"Barra de datos azul claro",solidColorDataBar_6:"Barra de datos prpura",colorGradation:"Degradado de color",colorGradation_1:"Gradacin de color verde-amarillo-rojo",colorGradation_2:"Gradacin de color rojo-amarillo-verde",colorGradation_3:"Gradacin de color verde-blanco-rojo",colorGradation_4:"Gradacin de color rojo-blanco-verde",colorGradation_5:"Gradacin de color azul-blanco-rojo",colorGradation_6:"Gradacin de color rojo-blanco-azul",colorGradation_7:"Gradacin de color blanco-rojo",colorGradation_8:"Gradacin de color rojo-blanco",colorGradation_9:"Gradacin de color verde-blanco",colorGradation_10:"Gradacin de color blanco-verde",colorGradation_11:"Gradacin de color verde-amarillo",colorGradation_12:"Gradacin de color amarillo-verde",icons:"iconos",pleaseSelectIcon:"Haz clic para seleccionar un grupo de iconos:",cellValue:"Valor de celda",specificText:"Texto especfico",occurrence:"Fecha",greaterThan:"Mayor que",lessThan:"Menor que",between:"Entre",equal:"Igual",in:"En",between2:"",contain:"Contiene",textContains:"Texto contiene",duplicateValue:"Valor duplicado",uniqueValue:"Valor Unico",top:"Mejor",top10:"10 mejores",top10_percent:"10% mejores",last:"Ultimo",last10:"Ultimos 10",last10_percent:"Ultimos 10%",oneself:"",above:"Encima",aboveAverage:"Encima media",below:"Debajo",belowAverage:"Debajo media",all:"Todos",yesterday:"Ao a fecha",today:"Hoy",tomorrow:"Maana",lastWeek:"Ultima semana",thisWeek:"Esta semana",lastMonth:"Ultimo mes",thisMonth:"Este mes",lastYear:"Ultimo ao",thisYear:"Este ao",last7days:"Ultimos 7 das",last30days:"Ultimos 30 das",next7days:"Siguientes 7 das",next30days:"Siguientes 30 das",next60days:"Siguientes 60 das",chooseRuleType:"Elige el tipo de regla",editRuleDescription:"Editar descripcin de regla",newFormatRule:"Nueva regla de formato",editFormatRule:"Editar regla de formato",formatStyle:"Estilo",fillType:"Rellenar",color:"Color",twocolor:"Dos colores",tricolor:"Tricolor",multicolor:"Multi color",grayColor:"Color gris",gradient:"Gradiente",solid:"Slido",maxValue:"Valor mximo",medianValue:"Valor mediano",minValue:"Valor mnimo",direction:"Direccin",threeWayArrow:"Flecha de tres direcciones",fourWayArrow:"Flecha de cuatro direcciones",fiveWayArrow:"Flecha de cinco direcciones",threeTriangles:"Tres tringulos",shape:"Forma",threeColorTrafficLight:"Semforo de tres colores",fourColorTrafficLight:"Semforo de cuatro colores",threeSigns:"Tres signos",greenRedBlackGradient:"Gradiente verde-rojo-negro",rimless:"Sin aros",bordered:"Bordeado",mark:"Marcar",threeSymbols:"Tres smbolos",tricolorFlag:"Bandera tricolor",circled:"Rodeado",noCircle:"Sin crculo",grade:"Grado",grade4:"4 Grado",grade5:"5 Grado",threeStars:"3 Estrellas",fiveQuadrantDiagram:"Diagrama de cinco cuadrantes",fiveBoxes:"5 Cajas"},dataVerification:{cellRange:"Rango celdas",selectCellRange:"Haz clic para seleccionar un rango de celdas",selectCellRange2:"Selecciona un rango de celdas",verificationCondition:"Condicin de verificacin",dropdown:"lista desplegable",checkbox:"Casilla de verificacin",number:"Nmero",number_integer:"Nmero entero",number_decimal:"Nmero decimal",text_content:"Contenido texto",text_length:"Longitud texto",date:"Fecha",validity:"Eficacia",placeholder1:"Introduce las opciones, separadas por comas, como 1,2,3,4,5",placeholder2:"Introduce contenido",placeholder3:"Valor numrico, como 10",placeholder4:"Introduce el texto especificado",placeholder5:"Introduce el mensaje que se muestra cuando se selecciona la celda",selected:"Seleccionado",notSelected:"No seleccionado",between:"Entre",notBetween:"No entre",equal:"Iqual",notEqualTo:"No iqual a",moreThanThe:"Ms que el",lessThan:"Menos que",greaterOrEqualTo:"Mayor o igual a",lessThanOrEqualTo:"Menor o igual a",include:"Incluir",exclude:"Excluir",earlierThan:"Antes de",noEarlierThan:"No antes de",laterThan:"Despus de",noLaterThan:"No despus de",identificationNumber:"Nmero de identificacin",phoneNumber:"Nmero de telfono",remote:"Opcin de adquisicin remota automtica",prohibitInput:"Prohibir la entrada cuando los datos de entrada no son vlidos",hintShow:"Mostrar mensaje cuando se selecciona la celda",deleteVerification:"Eliminar verificacin",tooltipInfo1:"La opcin de la lista desplegable no puede estar vaca",tooltipInfo2:"El contenido de la casilla de verificacin no puede estar vaco",tooltipInfo3:"El valor ingresado no es un tipo numrico",tooltipInfo4:"El segundo valor no puede ser menor que el primero",tooltipInfo5:"El contenido del texto no puede estar vaco",tooltipInfo6:"El valor ingresado no es una fecha",tooltipInfo7:"La segunda fecha no puede ser menor que la primera"},formula:{sum:"Suma",average:"Media",count:"Contar",max:"Mx",min:"Mn",ifGenerate:"Generador de frmula SI",find:"Aprender ms",tipNotBelongToIf:"Esta funcin de celda no pertenece a la frmula SI!",tipSelectCell:"Selecciona la celda para insertar la funcin",ifGenCompareValueTitle:"Valor de comparacin",ifGenSelectCellTitle:"Haz click para seleccionar una celda",ifGenRangeTitle:"Rango",ifGenRangeTo:"a",ifGenRangeEvaluate:"Evaluar rango",ifGenSelectRangeTitle:"Haz click para seleccionar rango",ifGenCutWay:"Forma particionado",ifGenCutSame:"Mismo valor de particionado",ifGenCutNpiece:"Particionar por N",ifGenCutCustom:"Personalizado",ifGenCutConfirm:"Confirma",ifGenTipSelectCell:"Selecciona celdas",ifGenTipSelectCellPlace:"Por favor selecciona celdas",ifGenTipSelectRange:"Selecciona rango",ifGenTipSelectRangePlace:"Por favor selecciona rango",ifGenTipNotNullValue:"El valor de comparacin no puede ser vaco!",ifGenTipLableTitile:"Etiqueta",ifGenTipRangeNotforNull:"El rango no puede quedar vaco!",ifGenTipCutValueNotforNull:"El valor de particin no puede ser vaco!",ifGenTipNotGenCondition:"No hay condiciones disponibles para la generacin!"},formulaMore:{valueTitle:"Valor",tipSelectDataRange:"Selecciona rango de datos",tipDataRangeTile:"Rango de datos",findFunctionTitle:"Funcin de bsqueda",tipInputFunctionName:"Nombre o breve descripcin de la funcin",Array:"Vector",Database:"Base de datos",Date:"Fecha",Engineering:"Ingeniera",Filter:"Filtro",Financial:"Financiero",luckysheet:"Luckysheet",other:"Otro",Logical:"Lgica",Lookup:"Bsqueda",Math:"Matemtico",Operator:"Operadores",Parser:"Compilador",Statistical:"Estadstico",Text:"Texto",dataMining:"Minera de datos",selectFunctionTitle:"Selecciona una funcin",calculationResult:"Resultado",tipSuccessText:"Exito",tipParamErrorText:"Parmetro errneo",helpClose:"Cerrar",helpCollapse:"Recoger",helpExample:"Ejemplo",helpAbstract:"Resumen",execfunctionError:"Error en la frmula",execfunctionSelfError:"La frmula no puede hacer referencia a su propia celda",execfunctionSelfErrorResult:"La frmula no puede hacer referencia a su propia celda, lo que dar lugar a resultados de clculo inexactos",allowRepeatText:"Repetir",allowOptionText:"Opcin",selectCategory:"O selecciona una categora"},drag:{noMerge:"No se puede realizar esta operacin en celdas combinadas",afectarPivot:"Este cambio no se puede realizar en la celda seleccionada porque afectar a la tabla dinmica!",noMulti:"No se puede realizar esta operacin en varias reas de seleccin, selecciona una sola rea",noPaste:"No se puede pegar este contenido aqu, selecciona una celda en el rea de pegado e intenta pegar nuevamente",noPartMerge:"No se puede realizar esta operacin en celdas parcialmente fusionadas",inputCorrect:"Introduce el valor correcto",notLessOne:"El nmero de filas y columnas no puede ser inferior a 1",offsetColumnLessZero:"La columna de desplazamiento no puede ser negativa!",pasteMustKeybordAlert:": Ctrl + C , Ctrl + V , Ctrl + X ",pasteMustKeybordAlertHTMLTitle:"",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;"},pivotTable:{title:"Tabla Dinmica",closePannel:"Cerrar",editRange:"Rango",tipPivotFieldSelected:"Selecciona los campos",tipClearSelectedField:"Limpiar todos los campos",btnClearSelectedField:"Limpiar",btnFilter:"Filtrar",titleRow:"Fila",titleColumn:"Columna",titleValue:"Valor",tipShowColumn:"Los campos de estadsticas se muestran como columnas",tipShowRow:"Los campos de estadsticas se muestran como filas",titleSelectionDataRange:"Selecciona rango",titleDataRange:"Rango de datos",valueSum:"SUMA",valueStatisticsSUM:"Suma",valueStatisticsCOUNT:"Contar",valueStatisticsCOUNTA:"Contar A",valueStatisticsCOUNTUNIQUE:"Contar Distintos",valueStatisticsAVERAGE:"Media",valueStatisticsMAX:"Mx",valueStatisticsMIN:"Mn",valueStatisticsMEDIAN:"Mediana",valueStatisticsPRODUCT:"Producto",valueStatisticsSTDEV:"Desviacin Estndar",valueStatisticsSTDEVP:"Stdevp",valueStatisticslet:"Varianza",valueStatisticsVARP:"VarP",errorNotAllowEdit:"Esta operacin est prohibida en el modo sin edicin!",errorNotAllowMulti:"No se puede realizar esta operacin en varias reas de seleccin, selecciona un solo rango y vuelve a intentarlo",errorSelectRange:"Seleccione el rango de la nueva tabla dinmica",errorIsDamage:"Los datos de origen de esta tabla dinmica estn daados!",errorNotAllowPivotData:"No se puede seleccionar la tabla dinmica como datos de origen!",errorSelectionRange:"La seleccin fall, rango de entrada incorrecto!",errorIncreaseRange:"Por favor, expande el rango seleccionado!",titleAddColumn:"Aadir columna a la tabla dinmica",titleMoveColumn:"Muever la columna a la celda en blanco de abajo",titleClearColumnFilter:"Quitar el filtro de esta columna",titleFilterColumn:"Filtro",titleSort:"Ordenar",titleNoSort:"No Ordenar",titleSortAsc:"ASC",titleSortDesc:"DESC",titleSortBy:"Ordenar por",titleShowSum:"Mostrar total",titleStasticTrue:"S",titleStasticFalse:"No"},dropCell:{copyCell:"Copiar",sequence:"Secuencia",onlyFormat:"Solo formato",noFormat:"Sin formato",day:"Da",workDay:"Da Laborable",month:"Mes",year:"Ao",chineseNumber:"Nmeros Chinos"},imageCtrl:{borderTile:"Color de borde de imagen",borderCur:"Color"},protection:{protectiontTitle:"Proteccin",enterPassword:"Introduce una contrasea (opcional)",enterHintTitle:"Preguntar cuando la edicin est prohibida (opcional)",enterHint:"La celda o el grfico que ests intentando cambiar se encuentra en una hoja de trabajo protegida. Si quieres cambiarlo, desprotege la hoja de trabajo. Es posible que tengas que ingresar una contrasea",swichProtectionTip:"Protege la hoja y el contenido de las celdas bloqueadas",authorityTitle:"Permitir a los usuarios de esta hoja:",selectLockedCells:"Selecciona celdas bloqueadas",selectunLockedCells:"Selecciona celdas desbloqueadas",formatCells:"Formatear celdas",formatColumns:"Formatear columnas",formatRows:"Formatear filas",insertColumns:"Insertar columnas",insertRows:"Insertar filas",insertHyperlinks:"Insertar enlaces",deleteColumns:"Eliminar columnas",deleteRows:"Eliminar filas",sort:"Ordenar",filter:"Filtrar",usePivotTablereports:"Usar informes de tabla dinmica",editObjects:"Editar objetos",editScenarios:"Editar escenarios",allowRangeTitle:"Permitir a los usuarios del rango:",allowRangeAdd:"Nuevo...",allowRangeAddTitle:"Ttulo",allowRangeAddSqrf:"Referencia",selectCellRange:"Haz clic para seleccionar un rango de celdas",selectCellRangeHolder:"Rango de celdas",allowRangeAddTitlePassword:"Contrasea",allowRangeAddTitleHint:"Pregunta",allowRangeAddTitleHintTitle:"Preguntar cuando hay una contrasea (opcional)",allowRangeAddtitleDefault:"Nombre del rango de entrada",rangeItemDblclick:"Haz doble clic para editar",rangeItemHasPassword:"Tiene contrasea",rangeItemErrorTitleNull:"El ttulo es nulo",rangeItemErrorRangeNull:"La referencia es nula",rangeItemErrorRange:"La reference tiene un error",validationTitle:"Validacin de contrasea",validationTips:"Hay que ingresar una contrasea para desbloquear la proteccin de la hoja de trabajo",validationInputHint:"Introduce una contrasea",checkPasswordNullalert:"Contrasea requerida!",checkPasswordWrongalert:"Contrasea incorrecta. Por favor, prueba de nuevo!",checkPasswordSucceedalert:"Desbloqueo conseguido!",defaultRangeHintText:"La celda est protegida con contrasea.",defaultSheetHintText:"La celda o el grfico estn en una hoja de trabajo protegida. Para realizar cambios, desprotege la hoja de trabajo. Es posible que tengas que ingresar una contrasea"},cellFormat:{cellFormatTitle:"Formatear celdas",protection:"Proteccin",locked:"Bloqueado",hidden:"Escondido",protectionTips:"Para bloquear celdas u ocultar frmulas, protege la hoja de trabajo. En la barra de herramientas, haz clic en el botn Proteger hoja",tipsPart:"Comprobado parcial",tipsAll:"Todo seleccionado",selectionIsNullAlert:"Se requiere una seleccin!",sheetDataIsNullAlert:"error, no hay datos!"},print:{normalBtn:"Normal",layoutBtn:"Disposicin de pgina",pageBtn:"Previsualizacin de saltos de pgina",menuItemPrint:"Imprimir (Ctrl+P)",menuItemAreas:"Imprimir reas",menuItemRows:"Imprimir ttulos de filas",menuItemColumns:"Imprimir ttulos de columnas"},edit:{typing:"mecanografa"},websocket:{success:"xito de la conexin de WebSocket",refresh:"Se produjo un error en la conexin de WebSocket, actualice la pgina!",wait:"Se produjo un error en la conexin de WebSocket, tenga paciencia!",close:"Conexin WebSocket cerrada",contact:"Ocurri un error de comunicacin con el servidor, actualice la pgina y vuelva a intentarlo; de lo contrario, comunquese con el administrador.",support:"El navegador actual no es compatible con WebSocket"}},zh_tw:{functionlist:[{n:"SUMIF",t:0,d:"",a:"",m:[2,3],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:`

,,*,~~~*

,,,,:=><`,example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:",",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:"",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"",a:"",m:[1,1],p:[{name:"value",detail:"",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:"-11,",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"1",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"-11-11",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"x0,0`x`,`y`",a:"x0,0`x`,`y`",m:[2,2],p:[{name:"x",detail:"xx",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"xy",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

,ISEVENTRUE,FALSE`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

,ISODDTRUE,FALSE`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"e",a:"e",m:[1,1],p:[{name:"",detail:`e

`,example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"",a:"",m:[1,2],p:[{name:"",detail:"",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"10",a:"10",m:[1,1],p:[{name:"",detail:`10

`,example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:",",a:"",m:[2,2],p:[{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`,

,`,example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - 1",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:",",a:"",m:[2,2],p:[{name:"n",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"/",a:"/",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:",",a:"",m:[2,256],p:[{name:"",detail:`

1AVERAGE

2COUNT

3COUNTA

4MAX

5MIN

6PRODUCT

7STDEV

8STDEVP

9SUM

10VAR

11VARP

210112,,102COUNT,110VAR`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"2",detail:"[] - ",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:"-11,",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"",detail:`

,,*,~~~*

,,,,:=>>=<<=,`,example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"0101",a:"0101",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"",a:"",m:[1,1],p:[{name:"z",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`,

,`,example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"e~2.718",a:"e~2.718",m:[1,1],p:[{name:"",detail:"e",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:'""',a:'""',m:[1,1],p:[{name:"",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"14PI",a:"14PI",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

0`,example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

,`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

,`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"0",a:"0",m:[2,2],p:[{name:"",detail:",",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

,`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"xnma,a1xn + a2xn+m++ aixn+i-1m,ia",a:"xnma",m:[4,4],p:[{name:"x",detail:",",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"x",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"x",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:",-110",a:"",m:[1,1],p:[{name:"",detail:"",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:",",a:"",m:[1,1],p:[{name:"",detail:",",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:`

,SQRT#NUM`,example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"PI",a:"PI",m:[1,1],p:[{name:"",detail:`PI

,SQRTPI#NUM`,example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"e",a:"e",m:[1,1],p:[{name:"",detail:`

`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"",a:"",m:[1,1],p:[{name:"",detail:",",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:",",a:"",m:[1,2],p:[{name:"",detail:"",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`[ - 0] - 

,""

,,TRUNC0`,example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:",",a:"",m:[2,2],p:[{name:"",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`

0`,example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"",a:"",m:[2,2],p:[{name:"",detail:`

,`,example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:"",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"",a:"",m:[3,257],p:[{name:"",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2,2",detail:"[  ] - ",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"",a:"",m:[2,256],p:[{name:"1",detail:"1",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"1",detail:"1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"2,2",detail:"[  ] - ,",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2 ... 30",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:", HYPGEOM.DIST ",a:"",m:[5,5],p:[{name:"Sample_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_sample",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"Population_s",detail:"",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_pop",detail:"",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

cumulativeTRUE,HYPGEOM.DIST

FALSE,`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:" Y x=0y",a:" Y x=0y",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:",,",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:" n ,n ",a:" n ",m:[2,2],p:[{name:"",detail:"",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:`

,n4LARGE4`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:",0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2,",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:",",a:",",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:'[-FALSE] - "data"',example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:",",a:",",m:[2,3],p:[{name:"number",detail:"",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:'[-FALSE] - "data"',example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"01,",a:"01,",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[-3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"01,",a:"01,",m:[2,3],p:[{name:"data",detail:"",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[-3] - ",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:", x  y ",a:"",m:[3,3],p:[{name:"x",detail:"x",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"y",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:" Fisher ",a:" Fisher ",m:[1,1],p:[{name:"x",detail:"Fisher",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:",",a:"",m:[4,4],p:[{name:"x",detail:"WEIBULL ",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:`Weibull 

 alpha0`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"beta",detail:`Weibull 

 beta0`,example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"TRUE,FALSE",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:",",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_s",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"trials",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"",a:"",m:[3,3],p:[{name:"alpha",detail:`

100*1 - alpha%,, alpha 0.05, 95%`,example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"size",detail:"",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:" r",a:" r",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"",a:"",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:" Lambda ",a:" Lambda ",m:[3,3],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:" lambda ",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"",a:"",m:[2,3],p:[{name:"criteria_range",detail:" criterion ",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:`criteria_range

:""  1  "="  "=1"

:">1"

:">=1"

:"<1"

:"<=1"

:"<>1""<>"`,example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"[] - ,criteria_range",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"",a:"",m:[2,255],p:[{name:"average_range",detail:"",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:" criterion1 ",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"criteria_range1",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2, criterion2, ...",detail:"[] - ",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"",a:"",m:[2,2],p:[{name:"number",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_chosen",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"",a:"",m:[2,2],p:[{name:"",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"",detail:`

01`,example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:" K ,K 01,01",a:" K ,K 01,01",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1 , 0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:" K ,K  0  1 , 0  1",a:" K ,K  0  1 , 0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0  1 , 0  1",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"Pearson r",a:"Pearson r",m:[2,2],p:[{name:"_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"0,1",a:"0,1",m:[1,1],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"0,1",a:"0,1",m:[2,2],p:[{name:"z",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

TRUE,

FALSE,`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"",a:"",m:[3,3],p:[{name:"probability",detail:"",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"x",detail:"",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

TRUE,

FALSE,`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"",a:"",m:[4,4],p:[{name:"number_f",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_s",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

TRUE,

FALSE,`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"2",detail:"[] - ",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:" x ",a:" x ",m:[3,3],p:[{name:"probability",detail:",0101",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ,",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:" x ",a:" x ",m:[4,4],p:[{name:"x",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) ",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) ,",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:`

TRUE,

FALSE,`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:" z  P ",a:" z  P ",m:[2,3],p:[{name:"array",detail:" x ",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"sigma",detail:"[] - ,",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"",a:"",m:[3,4],p:[{name:"x_range",detail:" x ",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:" x_range ",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"upper_limit",detail:`[ - ] - 

,PROB`,example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:`

125%

250%

375%`,example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:" 0  1  0  1",a:" 0  1  0  1",m:[2,2],p:[{name:"array",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:`

00%

125%

250%

375%

4100%`,example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"",a:"",m:[3,3],p:[{name:"x",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:` ,

TRUE,xx

FALSE,x`,example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"(Pearson)r",a:"(Pearson)r",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:" t ",a:" t ",m:[3,3],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:`

cumulativeTRUE,HYPGEOM.DIST

FALSE,`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"x",detail:"T-",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:` t 

 0  1`,example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:`

,

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:" t ",a:" t ",m:[2,2],p:[{name:"probability",detail:`t

 0  1`,example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:`

,

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"t-",a:"t-",m:[4,4],p:[{name:"array1",detail:"t",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"t",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:`

 1:

 2:`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`t

 1:

 2:

 3:`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:" x, F  Fisher-Snedecor Snedecor F ",a:" x",m:[4,4],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:` FALSE

 TRUE:F.DIST

FALSE:F.DIST`,example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"x,FFisher-SnedecorSnedecor F",a:" x",m:[3,3],p:[{name:"x",detail:"",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:",0",a:"",m:[1,255],p:[{name:"value1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:",0",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:" x  y ",a:" x  y ",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:",",a:",",m:[3,3],p:[{name:"x",detail:"",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"k",a:"k",m:[2,2],p:[{name:"array",detail:"k",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"",a:"",m:[2,2],p:[{name:"_y",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"_x",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"",a:"",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:":",a:":",m:[1,255],p:[{name:"1",detail:"",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"2, ...",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:",",a:"",m:[3,4],p:[{name:"",detail:', 42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"VLOOKUP ",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:`,1

1,#VALUE`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`[TRUE()] -,FALSE

FALSEFALSE,,,,#N/A

TRUE,,#N/A`,example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:",",a:"",m:[3,4],p:[{name:"",detail:',42"Cats"I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:`,1

1,#VALUE`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`[ - TRUE()] - 

TRUE,,#N/A

TRUE,,

FALSE,,,#N/A`,example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:",",a:"",m:[2,3],p:[{name:"",detail:',42"Cats"  I24',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:" | ",detail:"LOOKUP,,,",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"[  ] - ,,",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"",a:"",m:[2,5],p:[{name:"row_num",detail:",",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:",A1",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"abs_num",detail:`[ - 1] - ,

1$A$1

2,A$1

3,$A1

4A1`,example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"A1",detail:"[ - TRUE] - ,A1TRUER1C1FALSE",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet_text",detail:"[ - ] - ",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"",a:"",m:[1,2],p:[{name:"ref_text",detail:"",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"A1",detail:"[ - TRUE] - ,A1TRUER1C1FALSE",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"",a:"",m:[0,1],p:[{name:"reference",detail:`[ - ] - 

,,`,example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:" `A=1` ",a:" `A=1` ",m:[0,1],p:[{name:"reference",detail:`[ - ] - A1

,,`,example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:",",a:",",m:[3,5],p:[{name:"reference",detail:"",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:`

,,`,example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:`

,,`,example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"[] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:",",a:",",m:[2,3],p:[{name:"lookup_value",detail:" lookup_array ",example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"lookup_array",detail:`

1,MATCH#N/A`,example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:`[ - 1] - 

1,MATCH,

0,

-1MATCH,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:",",a:",",m:[2,3],p:[{name:"array",detail:"",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:",",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:",",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"",a:"",m:[2,254],p:[{name:"data_field",detail:`

,""`,example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"pivot_table",detail:"",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"field1",detail:"[] - ",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"item1",detail:"[] - 1",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"",a:"",m:[2,255],p:[{name:"index_num",detail:`

,#VALUE`,example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"[] - ",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"",a:"",p:[{name:"",detail:`,

:http://https://mailto:aim:ftp://gopher://telnet://news://,,,

,http://,`,example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"",detail:`[-] - ,

,,,

"",,`,example:'"Google"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:`0 32767 ,

 23 24,`,example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`0 32767 ,

 59 `,example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"",detail:`0 32767 ,

 59 `,example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"24",a:"24",m:[1,1],p:[{name:"time_text",detail:"",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:",",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:",/",a:"",m:[2,2],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"059",a:"059",m:[1,1],p:[{name:"",detail:"://",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"://",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"",a:"",m:[1,1],p:[{name:"",detail:"://",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"",a:"",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"",a:"",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:`[] - ,

NDATEDATEVALUETO_DATE`,example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"",a:"",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:`[-1] - 
:01,,,1 ,"0000011"
:,1 =/,2 =/,7 =/11 =,12 =,17 =`,example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:`[] - ,
NDATEDATEVALUETO_DATE`,example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:" ISO ",a:" ISO ",m:[1,1],p:[{name:"date",detail:"-",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"",a:"",m:[1,2],p:[{name:"serial_number",detail:",",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[-1 ] - ,1=,2=",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:",",a:",",m:[1,2],p:[{name:"serial_number",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:`[-1] -,= 1

1,,1,7

2,,1,7

3,,0,6`,example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"",a:"",m:[1,1],p:[{name:"serial_number",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"",a:"",m:[2,2],p:[{name:"end_date",detail:":",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:":",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"360,",a:"360,",m:[2,3],p:[{name:"start_date",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:":",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:`[ - FALSE] - 

FALSE -NASD,,,30,,30,,30

TRUE -,3130`,example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"",a:"",m:[3,3],p:[{name:"year",detail:`,

0 1899 , 1900 

 1900  9999 ,

0 10000,#NUM`,example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:`,

 month  12, month 

 month  1,month , 1 `,example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:`,

 day , day 

 day 1, day , 1 `,example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"",a:"",m:[1,1],p:[{name:"date_text",detail:"",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"",a:"",m:[3,3],p:[{name:"",detail:"DATEDATE",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:"DATEDATE",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"",detail:`"M":"Y""M""D""MD""YM""YD"

"Y":

"M":

"D":

"MD":

"YM":

"YD":`,example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:",",a:",",m:[2,3],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:`start_date



`,example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:`[] - ,

NDATEDATEVALUETO_DATE`,example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:" ",a:" ",m:[2,4],p:[{name:"start_date",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:`start_date





`,example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:`[ - 1] - 
:01,,,1,"0000011"
:,1 =/,2 =/,7 =/11 =,12 =,17 =`,example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:`[] - ,
NDATEDATEVALUETO_DATE`,example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"Year 1900 - 9999 ",a:"Year 1900 - 9999 ",m:[1,1],p:[{name:"serial_number",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:" start_date  end_date ",a:" start_date  end_date ",m:[2,3],p:[{name:"start_date",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:":",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"",a:"",m:[0,0],p:[]},{n:"MONTH",t:6,d:"112",a:"112",m:[1,1],p:[{name:"serial_number",detail:":",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"",a:"",m:[2,2],p:[{name:"nominal_rate",detail:"",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"",a:"",m:[1,2],p:[{name:"number",detail:"",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:`[ - 2] - 

,`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"",a:"",m:[2,2],p:[{name:"fractional_dollar",detail:",",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"",a:"",m:[2,2],p:[{name:"decimal_dollar",detail:"",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:",",a:",",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"[ - 12] - ",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:",",a:",",m:[4,5],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"[ - 2] - ",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"",a:"",m:[3,6],p:[{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0

1`,example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"guess",detail:"[ - 0.1] - ",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:",",a:",",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:`

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:`

`,example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`

0

1`,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"",a:"",m:[4,4],p:[{name:"cost",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:",",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"",a:"",m:[3,3],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:",",a:",",m:[3,5],p:[{name:"rate",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[] - ,",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0

1`,example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"",a:"",m:[6,8],p:[{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_interest",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4""30/360""-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:`[ - TRUE] - ,

TRUE,

FALSE,`,example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"",a:"",m:[4,5],p:[{name:"issue",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] -

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"  - ,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"",a:"",m:[3,4],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4 `,example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/"-,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:",",a:",",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"[ - 0 ] - ,",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0 ] - 

0

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"",a:"",m:[2,2],p:[{name:"principal",detail:"",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"schedule",detail:`

,,UNARY_PERCENT,0.09UNARY_PERCENT9,9`,example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"",a:"",m:[6,7],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/" - ,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/" - ,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:",",a:",",m:[2,2],p:[{name:"effect_rate",detail:"",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"",a:"",m:[2,3],p:[{name:"values",detail:`

`,example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ - 0.1] - ",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"",a:"",m:[3,3],p:[{name:"values",detail:`

`,example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvest_rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:" ",a:" ",m:[1,2],p:[{name:"values",detail:`

`,example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[ - 0.1] - ",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"",a:"",m:[2,255],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"value2, ...",detail:"[] - ",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:",",a:",",m:[3,3],p:[{name:"rate",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"values",detail:"dates",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:",",a:",",m:[6,6],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:`

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:`

`,example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`

0

1`,example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"",a:"",m:[3,5],p:[{name:"rate",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:",,",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:",",a:",",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:",1nper",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:",",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0

1`,example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"",a:"",m:[4,6],p:[{name:"rate",detail:"",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:", 1  nper ",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0

1`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360"-,30360,

1"/" - ,

2"/360" - , 360

3"/365"-,365

4"30 / 360"-0,30360,`,example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"100",a:"100",m:[6,7],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"100",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"100",a:"100",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"100",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"100",a:"100",m:[5,6],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"",a:"",m:[4,5],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"100",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"100",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:",",a:",",m:[3,5],p:[{name:"rate",detail:"",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:",",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:",",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[ - 0] - ,",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:`[ - 0] - 

0

1`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"",a:"",m:[3,3],p:[{name:"cost",detail:"",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"100",a:"100",m:[5,6],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"100Macauley",a:"100Macauley",m:[5,6],p:[{name:"settlement",detail:",",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:`

,frequency = 1

,frequency = 2

,frequency = 4`,example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:`[ - 0] - 

0"NASD30/360" - ,30360,

1"/"-,

2"/360" - , 360

3"/365" - ,365

4"30 / 360"-0,30360,`,example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:`10

,

,0111111111,1000000000

,,BIN2DEC100BIN2DEC"100",4`,example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`10

,

,0111111111,1000000000

,,BIN2HEX11111BIN2HEX"11111",1F`,example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] -

,0,,BIN2HEX"11111",80000001F

1,1000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`10

,

,0111111111,1000000000

,,BIN2OCT11111BIN2OCT"11111",37`,example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

,0,,BIN2OCT"11111"00000037

1,1000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`

,511,-512

,,DEC2BIN199DEC2BIN"199",11000111`,example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:`[  ] - 

,0,

,`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`

549755813887,-549755814888

,,DEC2HEX100DEC2HEX"100",64`,example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:`[  ] - 

,0,

,`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`

536870911,-53687092

,,DEC2OCT199DEC2OCT"199",307`,example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:`[  ] -

,0,

, `,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`40

,

1FF,FFFFFFFE00

,,HEX2BIN199HEX2BIN"199",110011001`,example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

,0,

1,8000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:`40

,

7fffffffff,8000000000

,,HEX2DEC199HEX2DEC"199",409 `,example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`40

,

1FFFFFFF,FFE0000000

,,HEX2OCT199HEX2OCT"199",631`,example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

,0,

1,8000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`30

,

777,7777777000

,,OCT2BIN177OCT2BIN"177",1111111`,example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

,0,

1,4000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"",a:"",m:[1,1],p:[{name:"number",detail:`30

ba,

3777777777,4000000000

,,OCT2DEC177OCT2DEC"177",127`,example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"",a:"",m:[1,2],p:[{name:"number",detail:`30

ba,

3777777777,4000000000

,,OCT2HEX177OCT2HEX"177",7F`,example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:`[  ] - 

,0,

1,4000000000`,example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,3],p:[{name:"real_num",detail:"",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"i_num",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:'[ - "i"] - ',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[1,1],p:[{name:"inumber",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:" number1=number2,10",a:" number1=number2,10",m:[1,2],p:[{name:"number1",detail:"",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"[ - 0] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] -1",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:" inumber2",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:" inumber1 ",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:" x+yi  x+yj  1  255 ",a:" x+yi  x+yj  1  255 ",m:[1,255],p:[{name:"inumber1",detail:"",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, ",detail:"[] -",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:" x+yi  x+yj ",a:" x+yi  x+yj ",m:[2,2],p:[{name:"inumber1",detail:"",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:'-"NOTTRUE"FALSE"NOTFALSE"TRUE',a:'-"NOTTRUE"FALSE"NOTFALSE"TRUE',m:[1,1],p:[{name:"logical",detail:"TRUEFALSE",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:" TRUE",a:" TRUE",m:[0,0],p:[]},{n:"FALSE",t:10,d:" FALSE",a:" FALSE",m:[0,0],p:[]},{n:"AND",t:10,d:"TRUE,TRUEFALSE,FALSE",a:"TRUE,TRUEFALSE,FALSE",m:[1,255],p:[{name:"logical1",detail:",TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical2,...",detail:"[] - ,TRUEFALSE,255",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:",,",a:"",m:[2,2],p:[{name:"value",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:":#N/A#VALUE#REF#DIV/0#NUM#NAME#NULL",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"TRUE,FALSE",a:"TRUE,FALSE",m:[2,3],p:[{name:"logical_test",detail:",TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"TRUE",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"[ - ] - FALSE",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"TRUE,TRUEFALSE,FALSE",a:"TRUE,TRUEFALSE,FALSE",m:[1,255],p:[{name:"logical1",detail:",TRUEFALSE",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"2",detail:"[] - ,TRUEFALSE",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:',"TRUE""FALSE""<>"',a:',"TRUE""FALSE""<>"',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:',"TRUE""FALSE""="',a:',"TRUE""FALSE""="',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"value1",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:!1,a:!1,m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:'TRUEFALSE">="',a:'TRUEFALSE">="',m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:'TRUEFALSE"<"',a:'TRUEFALSE"<"',m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:'TRUEFALSE"<="',a:'TRUEFALSE"<="',m:[2,2],p:[{name:"value1",detail:" value2 ",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:'"+"',a:'"+"',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:'"-"',a:'"-"',m:[2,2],p:[{name:"value1",detail:",",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:",value1",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:'"*"',a:'"*"',m:[2,2],p:[{name:"value1",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"`/`",a:"`/`",m:[2,2],p:[{name:"value1",detail:"",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:`

0`,example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"`&`",a:"`&`",m:[2,2],p:[{name:"value1",detail:"value2 ",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:" value1 ",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:',"UNARY_PERCENT100"1',a:',"UNARY_PERCENT100"1',m:[1,1],p:[{name:"number",detail:"",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"",a:"",m:[1,255],p:[{name:"text1",detail:"",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"[] - ",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"Unicode",a:"Unicode",m:[1,1],p:[{name:"text",detail:"Unicode",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"Unicode,",a:"Unicode,",m:[1,1],p:[{name:"number",detail:"1255",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"",a:"",m:[1,1],p:[{name:"number",detail:",13999",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"text",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,T

,T

,T

,T`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"",a:"",m:[1,3],p:[{name:"number",detail:"",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:`[-2] - 

,,`,example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"no_commas",detail:"[-FALSE] - ,TRUE,FIXED",example:"FALSE",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[-1] - ",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:'""',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[-1] - ",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"",a:"",m:[2,255],p:[{name:"separator",detail:`

,JOIN,{1,2,3}`,example:'"and-a"',require:"m",repeat:"n",type:"rangeall"},{name:"array1",detail:"",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"array2,",detail:"[] - ",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[-1] - LEFT",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"",a:"",m:[1,2],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[-1] - RIGHT",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"",a:"",m:[3,3],p:[{name:"text",detail:"",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"1",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:`MID

,MID`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"DBCS",a:"DBCS",m:[1,1],p:[{name:"text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"",a:"",m:[2,2],p:[{name:"text1",detail:"",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"",a:"",m:[4,4],p:[{name:"old_text",detail:"",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"1",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"",a:"",m:[2,2],p:[{name:"text",detail:"",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_times",detail:`

100100,REPT100`,example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"",a:"",m:[2,3],p:[{name:"find_text",detail:"",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[-1 ] - ",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"new_textold_text",a:"new_textold_text",m:[3,4],p:[{name:"text",detail:",",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"old_text",detail:"",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"new_text",detail:"old_text",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"instance_num",detail:"[] - new_textold_textinstance_num,old_text,old_textnew_text",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"ASCII",a:"ASCII",m:[1,1],p:[{name:"text",detail:"",example:'"AF"&amp;CHAR31',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"",a:"",m:[2,2],p:[{name:"value",detail:"",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format_text",detail:`,

0,TEXT12.3,000.00"012.30,,TEXT12.305,00.00"12.31

#0,,TEXT12.3,###.##"12.3`,example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:"",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"",a:"",m:[1,1],p:[{name:"text",detail:",,",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"",a:"",m:[3,3],p:[{name:"number",detail:"from_unit",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"from_unit",detail:"",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"to_unit",detail:"",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"",a:"",m:[2,2],p:[{name:"array_x",detail:"",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:`y = mx + b y

known_y,known_x,

known_y,known_x,known_y,known_x,known_y`,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[-{1,2,3,},known_y] -y = mx + b x

known_y,known_x,known_y,known_x,known_y`,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ - known_x] - TRENDyx",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE] - ,b0

TRUEb

FALSEb0,m y = mx`,example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:",",a:",",m:[2,2],p:[{name:"data_array",detail:"",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"bins_array",detail:`data_array

,,,FREQUENCY`,example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"",a:"",m:[1,4],p:[{name:"known_y",detail:`y = b*m^x y

_y,_x,

_y,_x,_y,_x,_y`,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,},known_y] - y = b*m^x x

_y,_x,_y,_x,_y`,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[ - known_x] - GROWTHyx",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE] - ,b1

TRUEb

FALSEb1,my = m^x`,example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:",,",a:",,",m:[1,4],p:[{name:"known_y",detail:`y = mx + b y

known_y,known_x,

known_y,known_x,known_y,known_x,known_y`,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,},known_y] - y = mx + bx

known_y,known_x,known_y,known_x,known_y`,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE] - ,b0

TRUEb

FALSEb0,my = mx`,example:"TRUE",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:`[ - FALSE] - ,

TRUE,y,LINEST:



01,1



FF,

,F

,

`,example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:",,",a:",,",m:[1,4],p:[{name:"known_y",detail:`y = mx + b y

known_y,known_x,

known_y,known_x,known_y,known_x,known_y`,example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:`[ - {1,2,3,},known_y] - y = mx + bx

known_y,known_x,known_y,known_x,known_y`,example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:`[ - TRUE] - ,b0

TRUEb

FALSEb0,my = mx`,example:"TRUE",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:`[ - FALSE] - ,

TRUE,b,LOGEST:



01,1



FF,

-F

,

`,example:"TRUE",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"",a:"",m:[1,1],p:[{name:"array",detail:"",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"array1,array2",a:"array1,array2",m:[2,2],p:[{name:"array1",detail:`

array1array2`,example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:`

array2array1`,example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:",,",a:",,",m:[1,255],p:[{name:"array1",detail:"",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"[] - ",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"",a:"",m:[1,1],p:[{name:"cell",detail:`

 cell , ISFORMULA TRUE cell ,,TRUE,FALSE`,example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"",a:"",m:[2,2],p:[{name:"info_type",detail:",",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:"#N/A",a:"#N/A",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"error_val",detail:",",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,TRUEFALSE`,example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"#N/A",a:"#N/A",m:[1,1],p:[{name:"value",detail:`#N/A

#N/A#DIV/0#NAME#NULL#NUM#VALUE#REF,ISERRTRUE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

#DIV/0#N/A#NAME#NULL#NUM#VALUE#REF,ISERRORTRUE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"TRUEFALSE",a:"TRUEFALSE",m:[1,1],p:[{name:"value",detail:` TRUE  FALSE 

*TRUEFALSE,TRUEFALSE,ISLOGICALTRUE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"#N/A",a:"#N/A",m:[1,1],p:[{name:"value",detail:`#N/A

*#N/A#N/A,ISNATRUE,FALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

*,ISNONTEXTFALSE,TRUE

,ISNONTEXTTRUE

,ISNONTEXTFALSE,`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

*,ISNUMBERTRUE,FALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

*,ISREFTRUE,FALSE`,example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,ISTEXTTRUE,FALSE`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

1

2

4

16

64`,example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,

,

TRUE,1

FALSE,0

,

,0`,example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,TO_DATE,30,

30,
,TO_DATE`,example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"/",a:"/",m:[1,1],p:[{name:"value",detail:`

,TO_PURE_NUMBER

,TO_PERCENT`,example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,TO_TEXT,,,,

,TO_TEXT`,example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,TO_DOLLARS`,example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"",a:"",m:[1,1],p:[{name:"value",detail:`

,TO_PERCENT1 = 100%,

,TO_PERCENT`,example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"SQL,",a:"SQL,",m:[3,3],p:[{name:"database",detail:",",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:`database

fielddatabase,,1`,example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"database",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:"A1",detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:'"2017-10-01"',detail:",",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,2],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:",0:[1900/01/01],1:[1900-01-01],2:[190011]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"1518",a:"",m:[1,1],p:[{name:"",example:'"31033519900101XXXX"',detail:"1518",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"",a:"",m:[1,2],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"tf-idf",a:"tf-idf",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"TextRank",a:"TextRank",m:[1,3],p:[{name:"",example:'""',detail:"",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"20",detail:"20",require:"o",repeat:"n",type:"rangenumber"},{name:"",example:"1",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:",",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"A",a:"A",m:[1,3],p:[{name:"",example:'"000001"',detail:"6",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"2015-01-08",detail:"",require:"o",repeat:"n",type:"rangedate"},{name:"",example:"0",detail:"0[]1[]2[]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"",a:"",m:[1,1],p:[{name:"",example:'"1990-01-01"',detail:",1990/01/01, 199011",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"sparklines",a:"",m:[1,8],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#CCF3F4",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1px",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"avg",detail:"minmaxavgmedian0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:":1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:"A1:A20{1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:":1#0002:-2:#000-20:5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"false01",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"100",detail:"falseautonull",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:":0000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#2ec7c9",detail:"A10falseregxrgbrgba#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"sparklines",a:"",m:[1,6],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1",detail:"1",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#fc5c5c",detail:"A10falseregxrgbrgba#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#999",detail:"0#999",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:":1#0002:-2:#000-20-5:#0000-5",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"sparklines",a:"",m:[1,5],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"0",detail:"0",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#000",detail:"#000",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"#97b552",detail:"A1:A10#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"sparklines",a:"",m:[1,4],p:[{name:"",example:"A1:A20",detail:",A1:A20, {1,2,3,4,5}",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"0false1.5",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"10",detail:"false",require:"o",repeat:"n",type:"rangeall"},{name:"",example:"1.5",detail:"1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"sparklines",a:"",m:[2,3],p:[{name:"",example:"10",detail:"A1100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"8",detail:"A1100",require:"m",repeat:"n",type:"rangeall"},{name:"",example:"12",detail:"A11009",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"sparklines",a:"sparklines",m:[1,1],p:[{name:"",example:"PIESPLINES(A1:A20)",detail:"sparklinesA1:A20",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"",a:"",m:[1,4],p:[{name:"array",detail:"",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_index",detail:"[] - row1/col1",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_order",detail:"[] - 1-1",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] - FALSETRUE",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"/",a:"/",m:[2,3],p:[{name:"array",detail:"",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[] - filter",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"",a:"",m:[1,3],p:[{name:"array",detail:"",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[] - = FALSE= TRUE",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[] - = TRUE= FALSE",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"01",a:"01",m:[0,2],p:[{name:"rows",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"",a:"",m:[1,4],p:[{name:"rows",detail:"",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"[] - ",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"[] -",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"EVALUATE",t:"3",d:"",a:"",m:[1,1],p:[{name:"",example:'"A1+5*2^2"',detail:"",require:"m",repeat:"n",type:"rangeall"}]}],toolbar:{undo:"",redo:"",paintFormat:"",currencyFormat:"",percentageFormat:"",numberDecrease:"",numberIncrease:"",moreFormats:"",font:"",fontSize:"",bold:"Ctrl+B",italic:"Ctrl+I",strikethrough:"Alt+Shift+5",underline:"",textColor:"",chooseColor:"",resetColor:"",customColor:"",alternatingColors:"",confirmColor:"",cancelColor:"",collapse:"",fillColor:"",border:"",borderStyle:"",mergeCell:"",chooseMergeType:"",horizontalAlign:"",verticalAlign:"",alignment:"",textWrap:"",textWrapMode:"",textRotate:"",textRotateMode:"",freezeTopRow:"",sortAndFilter:"",findAndReplace:"",sum:"",autoSum:"",moreFunction:"",conditionalFormat:"",postil:"",pivotTable:"",chart:"",screenshot:"",splitColumn:"",insertImage:"",insertLink:"",dataVerification:"",protection:"",clearText:"",noColorSelectedText:"",toolMore:"",toolLess:"",toolClose:"",toolMoreTip:"",moreOptions:"",cellFormat:"",print:""},alternatingColors:{applyRange:"",selectRange:"",header:"",footer:"",errorInfo:",,",textTitle:"",custom:"",close:"",selectionTextColor:"",selectionCellColor:"",removeColor:"",colorShow:"",currentColor:"",tipSelectRange:"",errorNoRange:"",errorExistColors:""},button:{confirm:"",cancel:"",close:"",update:"Update",delete:"Delete",insert:""},paint:{start:"",end:"ESC",tipSelectRange:"",tipNotMulti:""},format:{moreCurrency:"",moreDateTime:"",moreNumber:"",titleCurrency:"",decimalPlaces:"",titleDateTime:"",titleNumber:""},info:{detailUpdate:"",detailSave:"",row:"",column:"",loading:"",copy:"",return:"",rename:"",tips:"",noName:"",wait:"",add:"",addLast:"",backTop:"",pageInfo:"${total},${totalPage},${currentPage}",nextPage:"",tipInputNumber:"",tipInputNumberLimit:"1-100",tipRowHeightLimit:"0 ~ 545",tipColumnWidthLimit:"0 ~ 2038",pageInfoFull:"${total},${totalPage},"},currencyDetail:{RMB:"",USdollar:"",EUR:"",GBP:"",HK:"",JPY:"",AlbanianLek:"",AlgerianDinar:"",Afghani:"",ArgentinePeso:"",UnitedArabEmiratesDirham:"",ArubanFlorin:"",OmaniRial:"",Azerbaijanimanat:"",EgyptianPound:"",EthiopianBirr:"",AngolaKwanza:"",AustralianDollar:"",Patacas:"",BarbadosDollar:"",PapuaNewGuineaKina:"",BahamianDollar:"",PakistanRupee:"",ParaguayanGuarani:"",BahrainiDinar:"",PanamanianBalboa:"",Brazilianreal:"",Belarusianruble:"",BermudianDollar:"",BulgarianLev:"",IcelandKrona:"",BosniaHerzegovinaConvertibleMark:"",PolishZloty:"",Boliviano:"",BelizeDollar:"",BotswanaPula:"",NotDannuzhamu:"",BurundiFranc:"",NorthKoreanWon:"",DanishKrone:"",EastCaribbeanDollar:"",DominicaPeso:"",RussianRuble:"",EritreanNakfa:"",CFAfranc:"",PhilippinePeso:"",FijiDollar:"",CapeVerdeEscudo:"",FalklandIslandsPound:"",GambianDalasi:"",Congolesefranc:"",ColombianPeso:"",CostaRicanColon:"",CubanPeso:"",Cubanconvertiblepeso:"",GuyanaDollar:"",KazakhstanTenge:"",Haitiangourde:"",won:"",NetherlandsAntillesGuilder:"",Honduraslempiras:"",DjiboutiFranc:"",KyrgyzstanSom:"",GuineaFranc:"",CanadianDollar:"",GhanaianCedi:"",Cambodianriel:"",CzechKoruna:"",ZimbabweDollar:"",QatariRiyal:"",CaymanIslandsDollar:"",Comorianfranc:"",KuwaitiDinar:"",CroatianKuna:"",KenyanShilling:"",LesothoLoti:"",LaoKip:"",LebanesePound:"",Lithuanianlitas:"",LibyanDinar:"",LiberianDollar:"",RwandaFranc:"",RomanianLeu:"",MalagasyAriary:"",MaldivianRufiyaa:"",MalawiKwacha:"",MalaysianRinggit:"",MacedoniawearingDinar:"",MauritiusRupee:"",MauritanianOuguiya:"",MongolianTugrik:"",BangladeshiTaka:"",PeruvianNuevoSol:"",MyanmarKyat:"",MoldovanLeu:"",MoroccanDirham:"",MozambiqueMetical:"",MexicanPeso:"",NamibianDollar:"",SouthAfricanRand:"",SouthSudanesePound:"",NicaraguaCordoba:"",NepaleseRupee:"",NigerianNaira:"",NorwegianKrone:"",GeorgianLari:"",RMBOffshore:"",SwedishKrona:"",SwissFranc:"",SerbianDinar:"",SierraLeone:"",SeychellesRupee:"",SaudiRiyal:"",SaoTomeDobra:"",SaintHelenapound:"",SriLankaRupee:"",SwazilandLilangeni:"",SudanesePound:"",Surinamesedollar:"",SolomonIslandsDollar:"",SomaliShilling:"",TajikistanSomoni:"",PacificFranc:"",ThaiBaht:"",TanzanianShilling:"",TonganPaanga:"",TrinidadandTobagoDollar:"",TunisianDinar:"",TurkishLira:"",VanuatuVatu:"",GuatemalanQuetzal:"",CommissionBolivar:"",BruneiDollar:"",UgandanShilling:"",UkrainianHryvnia:"",UruguayanPeso:"",Uzbekistansom:"",WesternSamoaTala:"",SingaporeDollar:"",NT:"",NewZealandDollar:"",HungarianForint:"",SyrianPound:"",JamaicanDollar:"",ArmenianDram:"",YemeniRial:"",IraqiDinar:"",IranianRial:"",NewIsraeliShekel:"",IndianRupee:"",IndonesianRupiah:"",JordanianDinar:"",VND:"",ZambianKwacha:"",GibraltarPound:"",ChileanPeso:"",CFAFrancBEAC:""},defaultFmt:[{text:"",value:"General",example:""},{text:"",value:"@",example:""},{text:"",value:"split",example:""},{text:"",value:"##0.00",example:"1000.12"},{text:"",value:"#0.00%",example:"12.21%"},{text:"",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"",value:"(0.00)",example:"(1200.09)"},{text:"",value:"w",example:"120002500"},{text:"",value:"0.00",example:"1200.09"},{text:"2",value:"w0.00",example:"22500.55"},{text:"",value:"split",example:""},{text:"",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"24H",value:"hh:mm",example:"15:00"},{text:"",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"",value:"fmtOtherSelf",example:"more"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"193085",value:'yyyy""M""d""'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"85",value:'M""d""'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"01:30",value:"/ hh:mm"},{name:"1:30",value:"/ h:mm"},{name:"1:30:30",value:"/ h:mm:ss"},{name:"08-05 01:30",value:"MM-dd / hh:mm"}],fontFamily:{MicrosoftYaHei:"Microsoft YaHei"},fontarray:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],fontjson:{"times new roman":0,arial:1,tahoma:2,verdana:3,:4,"microsoft yahei":4,:5,simsun:5,:6,simhei:6,:7,kaiti:7,:8,fangsong:8,:9,nsimsun:9,:10,stxinwei:10,:11,stxingkai:11,:12,stliti:12},border:{borderTop:"",borderBottom:"",borderLeft:"",borderRight:"",borderNone:"",borderAll:"",borderOutside:"",borderInside:"",borderHorizontal:"",borderVertical:"",borderColor:"",borderSize:""},merge:{mergeAll:"",mergeV:"",mergeH:"",mergeCancel:"",overlappingError:"",partiallyError:""},align:{left:"",center:"",right:"",top:"",middle:"",bottom:""},textWrap:{overflow:"",wrap:"",clip:""},rotation:{none:"",angleup:"",angledown:"",vertical:"",rotationUp:"90",rotationDown:"90"},freezen:{default:"",freezenRow:"",freezenColumn:"",freezenRC:"",freezenRowRange:"",freezenColumnRange:"",freezenRCRange:"",freezenCancel:"",noSeletionError:""},sort:{asc:"",desc:"",custom:"",hasTitle:"",sortBy:"",addOthers:"",close:"",confirm:"",columnOperation:"",secondaryTitle:"",sortTitle:"",sortRangeTitle:"",sortRangeTitleTo:"",noRangeError:",,",mergeError:","},filter:(xn={filter:"",clearFilter:"",sortByAsc:"A-Z",sortByDesc:"Z-A",filterByColor:"",filterByCondition:"",filterByValues:"",filiterInputNone:"",filiterInputTip:"",filiterRangeStartTip:"",filiterRangeEndTip:"",filterValueByAllBtn:"",filterValueByClearBtn:"",filterValueByInverseBtn:"",filterValueByTip:"",filterConform:" ",filterCancel:" "},Yr(xn,"clearFilter",""),Yr(xn,"conditionNone",""),Yr(xn,"conditionCellIsNull",""),Yr(xn,"conditionCellNotNull",""),Yr(xn,"conditionCellTextContain",""),Yr(xn,"conditionCellTextNotContain",""),Yr(xn,"conditionCellTextStart",""),Yr(xn,"conditionCellTextEnd",""),Yr(xn,"conditionCellTextEqual",""),Yr(xn,"conditionCellDateEqual",""),Yr(xn,"conditionCellDateBefore",""),Yr(xn,"conditionCellDateAfter",""),Yr(xn,"conditionCellGreater",""),Yr(xn,"conditionCellGreaterEqual",""),Yr(xn,"conditionCellLess",""),Yr(xn,"conditionCellLessEqual",""),Yr(xn,"conditionCellEqual",""),Yr(xn,"conditionCellNotEqual",""),Yr(xn,"conditionCellBetween",""),Yr(xn,"conditionCellNotBetween",""),Yr(xn,"filiterMoreDataTip",""),Yr(xn,"filiterMonthText",""),Yr(xn,"filiterYearText",""),Yr(xn,"filiterByColorTip",""),Yr(xn,"filiterByTextColorTip",""),Yr(xn,"filterContainerOneColorTip",""),Yr(xn,"filterDateFormatTip",""),Yr(xn,"valueBlank","()"),Yr(xn,"mergeError",","),xn),rightclick:{copy:"",copyAs:"",paste:"",insert:"",delete:"",deleteCell:"",deleteSelected:"",hide:"",hideSelected:"",showHide:"",to:"",left:"",right:"",top:"",bottom:"",moveLeft:"",moveUp:"",add:"",row:"",column:"",width:"",height:"",number:"",confirm:"",orderAZ:"A-Z",orderZA:"Z-A",clearContent:"",matrix:"",sortSelection:"",filterSelection:"",chartGeneration:"",firstLineTitle:"",untitled:"",array1:"",array2:"",array3:"",diagonal:"",antiDiagonal:"",diagonalOffset:"",offset:"",boolean:"",flip:"",upAndDown:"",leftAndRight:"",clockwise:"",counterclockwise:"",transpose:"",matrixCalculation:"",plus:"",minus:"",multiply:"",divided:"",power:"",root:"",log:"log",delete0:"0",removeDuplicate:"",byRow:"",byCol:"",generateNewMatrix:""},comment:{insert:"",edit:"",delete:"",showOne:"/",showAll:"/"},screenshot:{screenshotTipNoSelection:"",screenshotTipTitle:"",screenshotTipHasMerge:"",screenshotTipHasMulti:"",screenshotTipSuccess:"",screenshotImageName:"",downLoadClose:"",downLoadCopy:"",downLoadBtn:"",browserNotTip:"IE",rightclickTip:"''",successTip:",''"},splitText:{splitDelimiters:"",splitOther:"",splitContinueSymbol:"",splitDataPreview:"",splitTextTitle:"",splitConfirmToExe:",",tipNoMulti:",,",tipNoMultiColumn:",,,"},imageText:{imageSetting:"",close:"",conventional:"",moveCell1:"",moveCell2:"",moveCell3:"",fixedPos:"",border:"",width:"",radius:"",style:"",solid:"",dashed:"",dotted:"",double:"",color:""},punctuation:{tab:"Tab ",semicolon:"",comma:"",space:""},findAndReplace:{find:"",replace:"",goto:"",location:"",formula:"",date:"",number:"",string:"",error:"",condition:"",rowSpan:"",columnSpan:"",locationExample:"",lessTwoRowTip:"",lessTwoColumnTip:"",findTextbox:"",replaceTextbox:"",regexTextbox:"",wholeTextbox:"",distinguishTextbox:"",allReplaceBtn:"",replaceBtn:"",allFindBtn:"",findBtn:"",noFindTip:"",modeTip:"",searchTargetSheet:"",searchTargetCell:"",searchTargetValue:"",searchInputTip:"",noReplceTip:"",noMatchTip:"",successTip:"${xlength}",locationConstant:"",locationFormula:"",locationDate:"",locationDigital:"",locationString:"",locationBool:"",locationError:"",locationNull:"",locationCondition:"",locationRowSpan:"",locationColumnSpan:"",locationTiplessTwoRow:"",locationTiplessTwoColumn:"",locationTipNotFindCell:""},sheetconfig:{delete:"",copy:"",rename:"",changeColor:"",hide:"",unhide:"",moveLeft:"",moveRight:"",resetColor:"",cancelText:"",chooseText:"",tipNameRepeat:"",noMoreSheet:",",confirmDelete:"",redoDelete:"Ctrl+Z",noHide:",sheet",chartEditNoOpt:"",sheetNameSpecCharError:`:[ ] :  ? * / ' "`,sheetNamecannotIsEmptyError:""},conditionformat:{conditionformat_greaterThan:"",conditionformat_greaterThan_title:"",conditionformat_lessThan:"",conditionformat_lessThan_title:"",conditionformat_betweenness:"",conditionformat_betweenness_title:"",conditionformat_equal:"",conditionformat_equal_title:"",conditionformat_textContains:"",conditionformat_textContains_title:"",conditionformat_occurrenceDate:"",conditionformat_occurrenceDate_title:"",conditionformat_duplicateValue:"",conditionformat_duplicateValue_title:"",conditionformat_top10:"10",conditionformat_top10_percent:"10%",conditionformat_top10_title:"",conditionformat_last10:"10",conditionformat_last10_percent:"10%",conditionformat_last10_title:"",conditionformat_AboveAverage:"",conditionformat_AboveAverage_title:"",conditionformat_SubAverage:"",conditionformat_SubAverage_title:"",rule:"",newRule:"",editRule:"",deleteRule:"",deleteCellRule:"",deleteSheetRule:"",manageRules:"",showRules:"",highlightCellRules:"",itemSelectionRules:"",conditionformatManageRules:"",format:"",setFormat:"",setAs:"",setAsByArea:",",applyRange:"",selectRange:"",selectRange_percent:"",selectRange_average:"",selectRange_value:"",pleaseSelectRange:"",selectDataRange:"",selectCell:"",pleaseSelectCell:"",pleaseSelectADate:"",pleaseEnterInteger:"11000",onlySingleCell:"",conditionValueCanOnly:"",ruleTypeItem1:"",ruleTypeItem2:"",ruleTypeItem2_title:"",ruleTypeItem3:"",ruleTypeItem3_title:"",ruleTypeItem4:"",ruleTypeItem4_title:"",ruleTypeItem5:"",ruleTypeItem6:"",formula:"",textColor:"",cellColor:"",confirm:"",confirmColor:"",cancel:"",close:"",clearColorSelect:"",sheet:"",currentSheet:"",dataBar:"",dataBarColor:"",gradientDataBar_1:"-",gradientDataBar_2:"-",gradientDataBar_3:"-",gradientDataBar_4:"-",gradientDataBar_5:"-",gradientDataBar_6:"-",solidColorDataBar_1:"",solidColorDataBar_2:"",solidColorDataBar_3:"",solidColorDataBar_4:"",solidColorDataBar_5:"",solidColorDataBar_6:"",colorGradation:"",colorGradation_1:"--",colorGradation_2:"--",colorGradation_3:"--",colorGradation_4:"--",colorGradation_5:"--",colorGradation_6:"--",colorGradation_7:"-",colorGradation_8:"-",colorGradation_9:"-",colorGradation_10:"-",colorGradation_11:"-",colorGradation_12:"-",icons:"",pleaseSelectIcon:":",cellValue:"",specificText:"",occurrence:"",greaterThan:"",lessThan:"",between:"",equal:"",in:"",to:"",between2:"",contain:"",textContains:"",duplicateValue:"",uniqueValue:"",top:"",top10:"10",top10_percent:"10%",last:"",last10:"10",last10_percent:"10%",oneself:"",above:"",aboveAverage:"",below:"",belowAverage:"",all:"",yesterday:"",today:"",tomorrow:"",lastWeek:"",thisWeek:"",lastMonth:"",thisMonth:"",lastYear:"",thisYear:"",last7days:"7",last30days:"30",next7days:"7",next30days:"30",next60days:"60",chooseRuleType:"",editRuleDescription:"",newFormatRule:"",editFormatRule:"",formatStyle:"",fillType:"",color:"",twocolor:"",tricolor:"",multicolor:"",grayColor:"",gradient:"",solid:"",maxValue:"",medianValue:"",minValue:"",direction:"",threeWayArrow:"",fourWayArrow:"",fiveWayArrow:"",threeTriangles:"3",shape:"",threeColorTrafficLight:"",fourColorTrafficLight:"",threeSigns:"",greenRedBlackGradient:"--",rimless:"",bordered:"",mark:"",threeSymbols:"",tricolorFlag:"",circled:"",noCircle:"",grade:"",grade4:"",grade5:"",threeStars:"3",fiveQuadrantDiagram:"",fiveBoxes:"5"},insertLink:{linkText:"",linkType:"",external:"",internal:"",linkAddress:"",linkSheet:"",linkCell:"",linkTooltip:"",placeholder1:"",placeholder2:",A1",placeholder3:"",tooltipInfo1:"",tooltipInfo2:""},dataVerification:{cellRange:"",selectCellRange:"",selectCellRange2:"",verificationCondition:"",dropdown:"",checkbox:"",number:"",number_integer:"-",number_decimal:"-",text_content:"-",text_length:"-",date:"",validity:"",placeholder1:",,1,2,3,4,5",placeholder2:"",placeholder3:",10",placeholder4:"",placeholder5:"",selected:"",notSelected:"",between:"",notBetween:"",equal:"",notEqualTo:"",moreThanThe:"",lessThan:"",greaterOrEqualTo:"",lessThanOrEqualTo:"",include:"",exclude:"",earlierThan:"",noEarlierThan:"",laterThan:"",noLaterThan:"",identificationNumber:"",phoneNumber:"",remote:"",prohibitInput:"",hintShow:"",deleteVerification:"",tooltipInfo1:"",tooltipInfo2:"",tooltipInfo3:"",tooltipInfo4:"21",tooltipInfo5:"",tooltipInfo6:"",tooltipInfo7:"21"},formula:{sum:"",average:"",count:"",max:"",min:"",ifGenerate:"if",find:"",tipNotBelongToIf:"if!",tipSelectCell:"",ifGenCompareValueTitle:"",ifGenSelectCellTitle:"",ifGenRangeTitle:"",ifGenRangeTo:"",ifGenRangeEvaluate:"",ifGenSelectRangeTitle:"",ifGenCutWay:"",ifGenCutSame:"",ifGenCutNpiece:"N",ifGenCutCustom:"",ifGenCutConfirm:"",ifGenTipSelectCell:"",ifGenTipSelectCellPlace:"",ifGenTipSelectRange:"",ifGenTipSelectRangePlace:"",ifGenTipNotNullValue:"!",ifGenTipLableTitile:"",ifGenTipRangeNotforNull:"!",ifGenTipCutValueNotforNull:"",ifGenTipNotGenCondition:""},formulaMore:{valueTitle:"",tipSelectDataRange:"",tipDataRangeTile:"",findFunctionTitle:"",tipInputFunctionName:"",Array:"",Database:"",Date:"",Engineering:"",Filter:"",Financial:"",luckysheet:"Luckysheet",other:"",Logical:"",Lookup:"",Math:"",Operator:"",Parser:"",Statistical:"",Text:"",dataMining:"",selectFunctionTitle:"",calculationResult:"",tipSuccessText:"",tipParamErrorText:"",helpClose:"",helpCollapse:"",helpExample:"",helpAbstract:"",execfunctionError:'", "',execfunctionSelfError:"",execfunctionSelfErrorResult:",",allowRepeatText:"",allowOptionText:"",selectCategory:""},drag:{noMerge:"",affectPivot:",",noMulti:",",noPaste:",,",noPartMerge:"",inputCorrect:"",notLessOne:"1",offsetColumnLessZero:"",pasteMustKeybordAlert:"Copy and paste in the Sheet: Ctrl + C to copy, Ctrl + V to paste, Ctrl + X to cut",pasteMustKeybordAlertHTMLTitle:"Copy and paste in the Sheet",pasteMustKeybordAlertHTML:"<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;to copy<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;to paste<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;to cut"},pivotTable:{title:"",closePannel:"",editRange:"",tipPivotFieldSelected:"",tipClearSelectedField:"",btnClearSelectedField:"",btnFilter:"",titleRow:"",titleColumn:"",titleValue:"",tipShowColumn:"",tipShowRow:"",titleSelectionDataRange:"",titleDataRange:"",valueSum:"",valueStatisticsSUM:"",valueStatisticsCOUNT:"",valueStatisticsCOUNTA:"",valueStatisticsCOUNTUNIQUE:"",valueStatisticsAVERAGE:"",valueStatisticsMAX:"",valueStatisticsMIN:"",valueStatisticsMEDIAN:"",valueStatisticsPRODUCT:"",valueStatisticsSTDEV:"",valueStatisticsSTDEVP:"",valueStatisticslet:"",valueStatisticsVARP:"",errorNotAllowEdit:"!",errorNotAllowMulti:",,",errorSelectRange:"",errorIsDamage:"",errorNotAllowPivotData:"!",errorSelectionRange:",",errorIncreaseRange:"!",titleAddColumn:"",titleMoveColumn:"",titleClearColumnFilter:"",titleFilterColumn:"",titleSort:"",titleNoSort:"",titleSortAsc:"",titleSortDesc:"",titleSortBy:"",titleShowSum:"",titleStasticTrue:"",titleStasticFalse:""},dropCell:{copyCell:"",sequence:"",onlyFormat:"",noFormat:"",day:"",workDay:"",month:"",year:"",chineseNumber:""},imageCtrl:{borderTile:"",borderCur:""},protection:{protectiontTitle:"",enterPassword:"",enterHint:",",swichProtectionTip:"",authorityTitle:":",selectLockedCells:"",selectunLockedCells:"",formatCells:"",formatColumns:"",formatRows:"",insertColumns:"",insertRows:"",insertHyperlinks:"",deleteColumns:"",deleteRows:"",sort:"",filter:"",usePivotTablereports:"",editObjects:"",editScenarios:"",allowRangeTitle:"",allowRangeAdd:"...",allowRangeAddTitle:"",allowRangeAddSqrf:"",selectCellRange:"",selectCellRangeHolder:"",allowRangeAddTitlePassword:"",allowRangeAddTitleHint:"",allowRangeAddTitleHintTitle:",",allowRangeAddtitleDefault:"",rangeItemDblclick:"",rangeItemHasPassword:"",rangeItemErrorTitleNull:"",rangeItemErrorRangeNull:"",rangeItemErrorRange:"",validationTitle:"",validationTips:"",validationInputHint:"",checkPasswordNullalert:"!",checkPasswordWrongalert:",",checkPasswordSucceedalert:",!",defaultRangeHintText:"",defaultSheetHintText:",,,"},cellFormat:{cellFormatTitle:"",protection:"",locked:"",hidden:"",protectionTips:",",tipsPart:"",tipsAll:"",selectionIsNullAlert:"",sheetDataIsNullAlert:""},print:{normalBtn:"",layoutBtn:"",pageBtn:"",menuItemPrint:"(Ctrl+P)",menuItemAreas:"",menuItemRows:"",menuItemColumns:""},edit:{typing:""},websocket:{success:"WebSocket",refresh:"WebSocket,",wait:"WebSocket,",close:"WebSocket",contact:",,",support:"WebSocket"}}};function st(){return K0[u.lang]}function J0(){var e=st(),n=e.rightclick,t=e.toolbar,a=function(){var d={copy:!0,copyAs:!0,paste:!0,insertRow:!0,insertColumn:!0,deleteRow:!0,deleteColumn:!0,deleteCell:!0,hideRow:!0,hideColumn:!0,rowHeight:!0,columnWidth:!0,clear:!0,matrix:!0,sort:!0,filter:!0,chart:!0,image:!0,link:!0,data:!0,cellFormat:!0};return JSON.stringify(Nt.cellRightClickConfig)!=="{}"&&Object.assign(d,Nt.cellRightClickConfig),Nt.cellRightClickConfig=d,d}(),l=!0;a.insertRow||a.insertColumn||a.deleteRow||a.deleteColumn||a.deleteCell||(l=!1);var o=!0;return a.clear||a.matrix||a.sort||a.filter||a.chart||a.image||a.link||a.data||a.cellFormat||(o=!1),`<div id="luckysheet-rightclick-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-btn" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-copy-btn" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" style="display:`.concat(a.copy?"block":"none",`;">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.copy,`</div>
                </div>
                <div id="luckysheetcopyfor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"  style="display:`).concat(a.copyAs?"block":"none",`;">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.copyAs,`<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                    </div>
                </div>
                <div id="luckysheet-copy-paste" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.paste?"block":"none",`;">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.paste,`</div>
                </div>
                <div id="luckysheet-cols-rows-handleincell">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:`).concat(l?"block":"none",`;"></div>
                    <div id="luckysheetColsRowsHandleAdd_row" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.insertRow?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.insert).concat(n.row,`<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetColsRowsHandleAdd_column" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.insertColumn?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.insert).concat(n.column,`<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:`).concat(a.deleteRow?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.deleteSelected).concat(n.row,`<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:`).concat(a.deleteColumn?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.deleteSelected).concat(n.column,`<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <!-- cell right click remove hide button
                    <div id="luckysheetColsRowsHandleHid" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.hide,`<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    -->
                    <div id="luckysheetCellsHandleDel" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:`).concat(a.deleteCell?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.deleteCell,`<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-add">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                    <div id="luckysheet-top-left-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.to,`
                            <span class="luckysheet-cols-rows-shift-left">`).concat(n.left,`</span>
                            `).concat(n.add,`
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align:center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                        </div>
                    </div>
                    <div id="luckysheet-bottom-right-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.to,`
                            <span class="luckysheet-cols-rows-shift-right">`).concat(n.right,`</span>
                            `).concat(n.add,`
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                        </div>
                    </div>
                    <div id="luckysheet-del-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.deleteSelected,`
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                        </div>
                    </div>
                    <div id="luckysheet-hide-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.hideSelected,`
                        <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                        </div>
                    </div>
                    <div id="luckysheet-show-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.showHide,`
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                        </div>
                    </div>
                    <div id="luckysheet-column-row-width-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                            <span class="luckysheet-cols-rows-shift-size luckysheet-mousedown-cancel">`).concat(n.width,`</span>
                            <input type="number" class="luckysheet-mousedown-cancel rcsize" min="0" max="255" placeholder="`).concat(n.number,`" value="" style="width:50px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;">
                            px
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-shift">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:`).concat(a.sort?"block":"none",`;"></div>
                    <div id="luckysheetorderbyasc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.sort?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.orderAZ,`</div>
                    </div>
                    <div id="luckysheetorderbydesc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.sort?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.orderZA,`</div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-data">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:`).concat(o?"block":"none",`;"></div>
                    <div id="luckysheet-delete-text" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.clear?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.clearContent,`</div>
                    </div>
                    <div id="luckysheetmatrix" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:`).concat(a.matrix?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            `).concat(n.matrix,`<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetorderby" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.sort?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.sortSelection,`</div>
                    </div>
                    <div id="luckysheetfilter" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.filter?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.filterSelection,`</div>
                    </div>
                    <div id="luckysheetdatavisual" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.chart?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.chartGeneration,`</div>
                    </div>
                    <div id="luckysheetInsertImage" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.image?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(t.insertImage,`</div>
                    </div>
                    <div id="luckysheetInsertLink" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.link?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(t.insertLink,`</div>
                    </div>
                    <div id="luckysheetDataVerification" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.data?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(t.dataVerification,`</div>
                    </div>
                    <div id="luckysheetCellFormatRightClickMenu" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(a.cellFormat?"block":"none",`;">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(t.cellFormat,`</div>
                    </div>
                </div>
            </div>
            <div id="luckysheetcopyfor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-json-head" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json `).concat(n.firstLineTitle,`</div>
                </div>
                <div id="luckysheet-copy-json-nohead" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json `).concat(n.untitled,`</div>
                </div>
                <div id="luckysheet-copy-array1" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.array1,`</div>
                </div>
                <div id="luckysheet-copy-array2" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.array2,`</div>
                </div>
                <div id="luckysheet-copy-arraymore-confirm" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <span class="luckysheet-mousedown-cancel">`).concat(n.array3,`</span>
                        <input type="number" id="luckysheet-copy-arraymore-row" min="1" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.row,`" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                            
                            <input type="number" id="luckysheet-copy-arraymore-col" min="1" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.column,`" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                    </div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-copy-diagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.diagonal,`</div>
                </div>
                <div id="luckysheet-copy-antidiagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.antiDiagonal,`</div>
                </div>
                <div id="luckysheet-copy-diagonaloffset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.diagonalOffset,`
                        <input type="number" id="luckysheet-copy-diagonaloffset-value" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.offset,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        `).concat(n.column,`
                    </div>
                </div>
                <div id="luckysheet-copy-boolvalue" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.boolean,`</div>
                </div>
            </div>
            
            <!-- Revision: modeled on google sheet
            
            <div id="luckysheetColsRowsHandleAdd_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.to).concat(n.top).concat(n.add,`
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">`).concat(n.row,`</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.to).concat(n.bottom).concat(n.add,`
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">`).concat(n.row,`</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.to).concat(n.left).concat(n.add,`
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.to).concat(n.right).concat(n.add,`
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">`).concat(n.column,`</span>
                    </div>
                </div>
            </div>
            
            -->

            <!-- delete row or column
            
            <div id="luckysheetColsRowsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.deleteSelected).concat(n.row,`
                    </div>
                </div>
                <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.deleteSelected).concat(n.column,`
                    </div>
                </div>
            </div>
            
            -->

            <!--
            <div id="luckysheetColsRowsHandleHid_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-hidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.hideSelected).concat(n.row,`
                    </div>
                </div>
                <div id="luckysheet-showHidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.showHide).concat(n.row,`
                    </div>
                </div>
                <div id="luckysheet-hidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.hideSelected).concat(n.column,`
                    </div>
                </div>
                <div id="luckysheet-showHidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.showHide).concat(n.column,`
                    </div>
                </div>
            </div>

            -->

            <div id="luckysheetCellsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delCellsMoveLeft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.moveLeft,`
                    </div>
                </div>
                <div id="luckysheet-delCellsMoveUp" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.moveUp,`
                    </div>
                </div>
            </div>
            <div id="luckysheetmatrix_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.flip,`
                        <button id="luckysheet-matrix-turn-up" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.upAndDown,`</button>
                        <button id="luckysheet-matrix-turn-left" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.leftAndRight,`</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.flip,`
                        <button id="luckysheet-matrix-turn-cw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.clockwise,`</button>
                        <button id="luckysheet-matrix-turn-anticw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.counterclockwise,`</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div id="luckysheet-matrix-turn-trans" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(n.transpose,`</div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-matrix-cal-confirm" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <div class="luckysheet-mousedown-cancel">`).concat(n.matrixCalculation,`</div>
                        <div class="luckysheet-mousedown-cancel">
                            <select id="luckysheet-matrix-cal-type" class="luckysheet-mousedown-cancel" style="height:20px;">
                                <option value="plus">`).concat(n.plus,`</option>
                                <option value="minus">`).concat(n.minus,`</option>
                                <option value="multiply">`).concat(n.multiply,`</option>
                                <option value="divided">`).concat(n.divided,`</option>
                                <option value="power">`).concat(n.power,`</option>
                                <option value="root">`).concat(n.root,`</option>
                                <option value="log">`).concat(n.log,`</option>
                            </select>
                            <input type="number" id="luckysheet-matrix-cal-value" class="luckysheet-mousedown-cancel" placeholder="`).concat(n.number,`" value="2" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.delete0,`
                        <button id="luckysheet-matrix-delezero-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.byRow,`</button>
                        <button id="luckysheet-matrix-delezero-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.byCol,`</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        `).concat(n.removeDuplicate,`
                        <button id="luckysheet-matrix-delerpt-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.byRow,`</button>
                        <button id="luckysheet-matrix-delerpt-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">`).concat(n.byCol,`</button>
                    </div>
                </div>
            </div>`)}var $i='<div style="${style}" id="luckysheet-sheets-item${index}" data-index="${index}" class="luckysheet-sheets-item ${active}"><span class="luckysheet-sheets-item-name" spellcheck ="false" contenteditable="false">${name}</span> <span class="luckysheet-sheets-item-menu luckysheet-mousedown-cancel"><i class="fa fa-sort-desc luckysheet-mousedown-cancel"></i></span>${colorset}</div>',Ga='<div id="${id}" style="${style}" class="luckysheet-modal-dialog ${addclass}" tabindex="0" role="dialog" aria-labelledby=":41e" dir="ltr"> <div class="luckysheet-modal-dialog-title luckysheet-modal-dialog-title-draggable"> <span class="luckysheet-modal-dialog-title-text" role="heading">${title}</span>	 <span class="luckysheet-modal-dialog-title-close" role="button" tabindex="0" aria-label="${close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="luckysheet-modal-dialog-content">${content}</div> <div class="luckysheet-modal-dialog-buttons">	 ${botton} </div></div>';function Q0(){var e=st().sheetconfig,n=function(){var l={delete:!0,copy:!0,rename:!0,color:!0,hide:!0,move:!0};return JSON.stringify(Nt.sheetRightClickConfig)!=="{}"&&Object.assign(l,Nt.sheetRightClickConfig),Nt.sheetRightClickConfig=l,l}();if(Object.values(n).every(function(l){return!l}))return $("#luckysheet-sheet-container-c").addClass("luckysheet-sheet-container-menu-hide"),"";var t=!0,a=!0;return n.delete||n.copy||n.rename||n.color||(t=!1,n.hide||(a=!1)),n.hide||(t=!1),n.move||(a=!1),`<div id="luckysheet-rightclick-sheet-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"> 
                <div id="luckysheetsheetconfigdelete" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`.concat(n.delete?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.delete,`</div>
                </div> 
                <div id="luckysheetsheetconfigcopy" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(n.copy?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.copy,`</div> 
                </div> 
                <div id="luckysheetsheetconfigrename" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(n.rename?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.rename,`</div> 
                </div> 
                <div id="luckysheetsheetconfigcolor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:`).concat(n.color?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> 
                        `).concat(e.changeColor,` <span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span> 
                    </div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:`).concat(t?"block":"none",`;"></div> 
                <div id="luckysheetsheetconfighide" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(n.hide?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.hide,`</div> 
                </div> 
                <div id="luckysheetsheetconfigshow" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(n.hide?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.unhide,`</div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:`).concat(a?"block":"none",`;"></div> 
                <div id="luckysheetsheetconfigmoveleft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(n.move?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.moveLeft,`</div> 
                </div> 
                <div id="luckysheetsheetconfigmoveright" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:`).concat(n.move?"block":"none",`;"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.moveRight,`</div> 
                </div> 
            </div> 
            <div id="luckysheetsheetconfigcolor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheetsheetconfigcolorreset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">`).concat(e.resetColor,`</div>
                </div> 
                <div class="luckysheet-mousedown-cancel"> 
                    <div class="luckysheet-mousedown-cancel"> 
                        <input type="text" id="luckysheetsheetconfigcolorur" /> 
                    </div> 
                </div> 
            </div>`)}function wf(){var e=st().filter;return'<div class="luckysheet-cols-menu luckysheet-mousedown-cancel luckysheet-filter-menu" id="luckysheet-${menuid}-menu"><div id="luckysheet-${menuid}-orderby-asc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">'.concat(e.sortByAsc,'</div></div><div id="luckysheet-${menuid}-orderby-desc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div style="width:205px;" class="luckysheet-mousedown-cancel">').concat(e.sortByDesc,'</div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-${menuid}-orderby-color" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="position: relative;">').concat(e.filterByColor,'<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;right: 0;"></span></div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-${menuid}-bycondition" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ').concat(e.filterByCondition,'</div></div> <div class="luckysheet-${menuid}-bycondition" style="display:none;"><div class="luckysheet-flat-menu-button luckysheet-mousedown-cancel" id="luckysheet-${menuid}-selected"><span class="luckysheet-mousedown-cancel" data-value="null" data-type="0">').concat(e.filiterInputNone,'</span><div class="luckysheet-mousedown-cancel"><i class="fa fa-sort" aria-hidden="true"></i></div></div><div class="luckysheet-${menuid}-selected-input"><input type="text" placeholder="').concat(e.filiterInputTip,'" class="luckysheet-mousedown-cancel" /></div><div class="luckysheet-${menuid}-selected-input luckysheet-${menuid}-selected-input2"><span></span><input type="text" placeholder="').concat(e.filiterRangeStartTip,'" class="luckysheet-mousedown-cancel" /><span></span><input type="text" placeholder="').concat(e.filiterRangeEndTip,'" class="luckysheet-mousedown-cancel" /></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-${menuid}-byvalue" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ').concat(e.filterByValues,'</div></div> <div class="luckysheet-${menuid}-byvalue"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel luckysheet-mousedown-${menuid}-byvalue-btn"><span id="luckysheet-${menuid}-byvalue-btn-all" class="luckysheet-mousedown-cancel">').concat(e.filterValueByAllBtn,'</span> - <span id="luckysheet-${menuid}-byvalue-btn-clear" class="luckysheet-mousedown-cancel">').concat(e.filterValueByClearBtn,'</span> - <span id="luckysheet-${menuid}-byvalue-btn-contra" class="luckysheet-mousedown-cancel">').concat(e.filterValueByInverseBtn,'</span> <div><i class="fa fa-${menuid} luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="padding-left:3px; padding-right:3px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><input type="text" placeholder="').concat(e.filterValueByTip,'" class="luckysheet-mousedown-cancel" id="luckysheet-${menuid}-byvalue-input" /><div class="luckysheet-${menuid}-byvalue-input-icon luckysheet-mousedown-cancel"><i class="fa fa-search luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div id="luckysheet-${menuid}-byvalue-select" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"></div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="btn btn-primary luckysheet-mousedown-cancel" id="luckysheet-${menuid}-confirm">').concat(e.filterConform,'</div> <div class="btn btn-default luckysheet-mousedown-cancel" id="luckysheet-${menuid}-cancel">').concat(e.filterCancel,'</div> <div class="btn btn-danger luckysheet-mousedown-cancel" id="luckysheet-${menuid}-initial">').concat(e.clearFilter,"</div></div></div> </div>")}function _f(){var e=st().filter;return'<div style="z-index:1004;overflow-y:auto;" class="luckysheet-filter-submenu luckysheet-cols-menu luckysheet-mousedown-cancel" id="luckysheet-${menuid}-submenu"><div data-value="null" data-type="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">'.concat(e.conditionNone,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellIsNull,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnonull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellNotNull,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellTextContain,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textnotinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellTextNotContain,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textstart"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellTextStart,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textend"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellTextEnd,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellTextEqual,'</div></div>  <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>  <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="dateequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellDateEqual,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datelessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellDateBefore,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datemorethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellDateAfter,'</div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="morethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellGreater,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="moreequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellGreaterEqual,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellLess,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellLessEqual,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="equal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellEqual,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellNotEqual,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="include"  data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellBetween,'</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noinclude" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">').concat(e.conditionCellNotBetween,"</div></div> </div>")}var Qc=function(){return'<div id="luckysheetloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="luckysheetLoaderGif"></div>  <span>'+st().info.loading+"...</span></div></div>"},Di=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],e1=8,nh=9,Yi=13,t1=20,ed=27,Wo=37,Yo=38,Xo=39,Zo=40,r1=46,Cf=91,n1=92,l1=93,i1=113,lh=115,ih="#000000",Tf="middle",Fi="#dfdfdf",lc=function(){return"normal normal normal "+u.defaultFontSize+"pt "+st().fontarray[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC",  "WenQuanYi Micro Hei", sans-serif'},td=new Image;td.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==";var o1={"border-top":" iconfont luckysheet-iconfont-shangbiankuang","border-bottom":" iconfont luckysheet-iconfont-xiabiankuang","border-left":" iconfont luckysheet-iconfont-zuobiankuang","border-right":" iconfont luckysheet-iconfont-youbiankuang","border-none":" iconfont luckysheet-iconfont-wubiankuang","border-all":" iconfont luckysheet-iconfont-quanjiabiankuang","border-outside":" iconfont luckysheet-iconfont-sizhoujiabiankuang","border-inside":" iconfont luckysheet-iconfont-neikuangxian","border-horizontal":" iconfont luckysheet-iconfont-neikuanghengxian","border-vertical":" iconfont luckysheet-iconfont-neikuangshuxian"},rd={left:" iconfont luckysheet-iconfont-wenbenzuoduiqi",center:" iconfont luckysheet-iconfont-wenbenjuzhongduiqi",right:" iconfont luckysheet-iconfont-wenbenyouduiqi",top:" iconfont luckysheet-iconfont-dingbuduiqi",middle:" iconfont luckysheet-iconfont-shuipingduiqi",bottom:" iconfont luckysheet-iconfont-dibuduiqi"},Af={overflow:" iconfont luckysheet-iconfont-yichu1",wrap:" iconfont luckysheet-iconfont-zidonghuanhang",clip:" iconfont luckysheet-iconfont-jieduan"},Sf={none:" iconfont luckysheet-iconfont-wuxuanzhuang",angleup:" iconfont luckysheet-iconfont-xiangshangqingxie",angledown:" iconfont luckysheet-iconfont-xiangxiaqingxie",vertical:" iconfont luckysheet-iconfont-shupaiwenzi","rotation-up":" iconfont luckysheet-iconfont-wenbenxiangshang","rotation-down":" iconfont luckysheet-iconfont-xiangxia90"},s1=Ho.trim;Ce({target:"String",proto:!0,forced:function(e){return we(function(){return!!Uo[e]()||""[e]()!=""||Uo[e].name!==e})}("trim")},{trim:function(){return s1(this)}});var u1=we(function(){Il(1)});Ce({target:"Object",stat:!0,forced:u1},{keys:function(e){return Il(Dl(e))}});var c1=Be.f,oh=Function.prototype,d1=oh.toString,h1=/^\s*function ([^ (]*)/;H&&!("name"in oh)&&c1(oh,"name",{configurable:!0,get:function(){try{return d1.call(this).match(h1)[1]}catch{return""}}});var If=Pe.f,m1={}.toString,Rf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f1=function(e){return Rf&&m1.call(e)=="[object Window]"?function(n){try{return If(n)}catch{return Rf.slice()}}(e):If(ie(e))},p1=we(function(){return!Object.getOwnPropertyNames(1)});Ce({target:"Object",stat:!0,forced:p1},{getOwnPropertyNames:f1});var Ef=bn("species"),sh=function(e){var n=oe(e),t=Be.f;H&&n&&!n[Ef]&&t(n,Ef,{configurable:!0,get:function(){return this}})},g1=Be.f,v1=Pe.f,y1=Vt.set,b1=bn("match"),Xi=K.RegExp,uh=Xi.prototype,ic=/a/g,ch=/a/g,dh=new Xi(ic)!==ic,hh=Hd.UNSUPPORTED_Y;if(H&&Pt("RegExp",!dh||hh||we(function(){return ch[b1]=!1,Xi(ic)!=ic||Xi(ch)==ch||Xi(ic,"i")!="/a/i"}))){for(var yo=function(e,n){var t,a=this instanceof yo,l=th(e),o=n===void 0;if(!a&&l&&e.constructor===yo&&o)return e;dh?l&&!o&&(e=e.source):e instanceof yo&&(o&&(n=Ud.call(e)),e=e.source),hh&&(t=!!n&&n.indexOf("y")>-1)&&(n=n.replace(/y/g,""));var d=ti(dh?new Xi(e,n):Xi(e,n),a?this:uh,yo);return hh&&t&&y1(d,{sticky:t}),d},k1=function(e){e in yo||g1(yo,e,{configurable:!0,get:function(){return Xi[e]},set:function(n){Xi[e]=n}})},$f=v1(Xi),Df=0;$f.length>Df;)k1($f[Df++]);uh.constructor=yo,yo.prototype=uh,$r(K,"RegExp",yo)}sh("RegExp"),Ce({target:"String",proto:!0},{repeat:$l});var Ff=Object.is||function(e,n){return e===n?e!==0||1/e==1/n:e!=e&&n!=n};function je(e){for(var n=0;n<u.luckysheetfile.length;n++)if(u.luckysheetfile[n].index==e)return n;return null}function wn(e,n,t){var a="";t==null&&(t=u.currentSheetIndex),e!=t&&(a=u.luckysheetfile[je(e)].name.replace(/'/g,"''"),/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/.test(a)?a+="!":a="'"+a+"'!");var l=n.row[0],o=n.row[1],d=n.column[0],s=n.column[1];return l==null&&o==null?a+ya(d)+":"+ya(s):d==null&&s==null?a+(l+1)+":"+(o+1):d==s&&l==o?a+ya(d)+(l+1):a+ya(d)+(l+1)+":"+ya(s)+(o+1)}function an(e){return e&&u.luckysheetfile.forEach(function(n){n.chart&&n.chart.forEach(function(t){var a=u.getChartJson(t.chart_id);t.chartOptions=a})}),u.luckysheetfile}function mh(){return u.visibledatarow}function fh(){return u.visibledatacolumn}function Rs(e){u.luckysheet_scroll_status=e}function oc(e){u.luckysheetfile=e}Zc("search",1,function(e,n,t){return[function(a){var l=ke(this),o=a==null?void 0:a[e];return o!==void 0?o.call(a,l):new RegExp(a)[e](String(l))},function(a){var l=t(n,a,this);if(l.done)return l.value;var o=Et(a),d=String(this),s=o.lastIndex;Ff(s,0)||(o.lastIndex=0);var h=Qs(o,d);return Ff(o.lastIndex,s)||(o.lastIndex=s),h===null?-1:h.index}]});var x1=ha.includes,w1=Er("indexOf",{ACCESSORS:!0,1:0});Ce({target:"Array",proto:!0,forced:!w1},{includes:function(e){return x1(this,e,arguments.length>1?arguments[1]:void 0)}}),Is("includes");var _1=zl.map,C1=ec("map"),T1=Er("map");Ce({target:"Array",proto:!0,forced:!C1||!T1},{map:function(e){return _1(this,e,arguments.length>1?arguments[1]:void 0)}});var Ko={mobilecheck:function(){var e,n=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0),document.body&&document.body.clientWidth&&document.body.clientHeight&&document.body.clientWidth<350&&document.body.clientHeight<500&&(n=!0),n},iphoneCheck:function(){return!0},isWeixin:function(){return navigator.userAgent.toLowerCase().match(/MicroMessenger/i)=="micromessenger"},isAndroid:function(){var e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1},tabletCheck:function(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())},BrowserType:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,a=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,l=e.indexOf("Edge")>-1,o=e.indexOf("Firefox")>-1,d=e.indexOf("Safari")>-1&&e.indexOf("Chrome")==-1,s=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(t){new RegExp("MSIE (\\d+\\.\\d+);").test(e);var h=parseFloat(RegExp.$1);return h==7?"IE7":h==8?"IE8":h==9?"IE9":h==10?"IE10":"0"}return o?"FF":n?"Opera":d?"Safari":s?"Chrome":l?"Edge":a?"IE11":void 0},isIE:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,a=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;return t||a?"1":"-1"},IEVersion:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,a=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,l=e.indexOf("Windows NT 6.1; Trident/7.0;")>-1&&!t;if(t){new RegExp("MSIE (\\d+\\.\\d+);").test(e);var o=parseFloat(RegExp.$1);return o==7?"IE7":o==8?"IE8":o==9?"IE9":o==10?"IE10":"0"}return l?"Edge":a?"IE11":"-1"},luckysheetrefreshfixednum:null,luckysheetrefreshfixed:function(){return this.luckysheetrefreshfixednum==null&&(this.BrowserType()=="FF"?this.luckysheetrefreshfixednum=5:this.luckysheetrefreshfixednum=0),this.luckysheetrefreshfixednum},detectOS:function(){var e=navigator.userAgent,n=navigator.platform=="Win32"||navigator.platform=="Windows",t=navigator.platform=="Mac68K"||navigator.platform=="MacPPC"||navigator.platform=="Macintosh"||navigator.platform=="MacIntel";if(t)return"Mac";if(navigator.platform=="X11"&&!n&&!t)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Win2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"WinXP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Win2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"WinVista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Win7"}return"other"}},Ia=Fe(function(e,n){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function a(d,s){return Object.prototype.hasOwnProperty.call(d,s)}n.assign=function(d){for(var s=Array.prototype.slice.call(arguments,1);s.length;){var h=s.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var f in h)a(h,f)&&(d[f]=h[f])}}return d},n.shrinkBuf=function(d,s){return d.length===s?d:d.subarray?d.subarray(0,s):(d.length=s,d)};var l={arraySet:function(d,s,h,f,p){if(s.subarray&&d.subarray)d.set(s.subarray(h,h+f),p);else for(var g=0;g<f;g++)d[p+g]=s[h+g]},flattenChunks:function(d){var s,h,f,p,g,v;for(f=0,s=0,h=d.length;s<h;s++)f+=d[s].length;for(v=new Uint8Array(f),p=0,s=0,h=d.length;s<h;s++)g=d[s],v.set(g,p),p+=g.length;return v}},o={arraySet:function(d,s,h,f,p){for(var g=0;g<f;g++)d[p+g]=s[h+g]},flattenChunks:function(d){return[].concat.apply([],d)}};n.setTyped=function(d){d?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,l)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(t)});function lu(e){for(var n=e.length;--n>=0;)e[n]=0}var ph=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ad=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A1=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],qf=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],bo=new Array(576);lu(bo);var sc=new Array(60);lu(sc);var uc=new Array(512);lu(uc);var cc=new Array(256);lu(cc);var gh=new Array(29);lu(gh);var Mf,Nf,Lf,nd=new Array(30);function vh(e,n,t,a,l){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=a,this.max_length=l,this.has_stree=e&&e.length}function yh(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function Pf(e){return e<256?uc[e]:uc[256+(e>>>7)]}function dc(e,n){e.pending_buf[e.pending++]=255&n,e.pending_buf[e.pending++]=n>>>8&255}function Wl(e,n,t){e.bi_valid>16-t?(e.bi_buf|=n<<e.bi_valid&65535,dc(e,e.bi_buf),e.bi_buf=n>>16-e.bi_valid,e.bi_valid+=t-16):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)}function Zi(e,n,t){Wl(e,t[2*n],t[2*n+1])}function Of(e,n){var t=0;do t|=1&e,e>>>=1,t<<=1;while(--n>0);return t>>>1}function zf(e,n,t){var a,l,o=new Array(16),d=0;for(a=1;a<=15;a++)o[a]=d=d+t[a-1]<<1;for(l=0;l<=n;l++){var s=e[2*l+1];s!==0&&(e[2*l]=Of(o[s]++,s))}}function Bf(e){var n;for(n=0;n<286;n++)e.dyn_ltree[2*n]=0;for(n=0;n<30;n++)e.dyn_dtree[2*n]=0;for(n=0;n<19;n++)e.bl_tree[2*n]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Vf(e){e.bi_valid>8?dc(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Uf(e,n,t,a){var l=2*n,o=2*t;return e[l]<e[o]||e[l]===e[o]&&a[n]<=a[t]}function bh(e,n,t){for(var a=e.heap[t],l=t<<1;l<=e.heap_len&&(l<e.heap_len&&Uf(n,e.heap[l+1],e.heap[l],e.depth)&&l++,!Uf(n,a,e.heap[l],e.depth));)e.heap[t]=e.heap[l],t=l,l<<=1;e.heap[t]=a}function Hf(e,n,t){var a,l,o,d,s=0;if(e.last_lit!==0)do a=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],l=e.pending_buf[e.l_buf+s],s++,a===0?Zi(e,l,n):(Zi(e,(o=cc[l])+256+1,n),(d=ph[o])!==0&&Wl(e,l-=gh[o],d),Zi(e,o=Pf(--a),t),(d=ad[o])!==0&&Wl(e,a-=nd[o],d));while(s<e.last_lit);Zi(e,256,n)}function kh(e,n){var t,a,l,o=n.dyn_tree,d=n.stat_desc.static_tree,s=n.stat_desc.has_stree,h=n.stat_desc.elems,f=-1;for(e.heap_len=0,e.heap_max=573,t=0;t<h;t++)o[2*t]!==0?(e.heap[++e.heap_len]=f=t,e.depth[t]=0):o[2*t+1]=0;for(;e.heap_len<2;)o[2*(l=e.heap[++e.heap_len]=f<2?++f:0)]=1,e.depth[l]=0,e.opt_len--,s&&(e.static_len-=d[2*l+1]);for(n.max_code=f,t=e.heap_len>>1;t>=1;t--)bh(e,o,t);l=h;do t=e.heap[1],e.heap[1]=e.heap[e.heap_len--],bh(e,o,1),a=e.heap[1],e.heap[--e.heap_max]=t,e.heap[--e.heap_max]=a,o[2*l]=o[2*t]+o[2*a],e.depth[l]=(e.depth[t]>=e.depth[a]?e.depth[t]:e.depth[a])+1,o[2*t+1]=o[2*a+1]=l,e.heap[1]=l++,bh(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(p,g){var v,y,b,k,w,_,C=g.dyn_tree,A=g.max_code,I=g.stat_desc.static_tree,S=g.stat_desc.has_stree,E=g.stat_desc.extra_bits,R=g.stat_desc.extra_base,F=g.stat_desc.max_length,N=0;for(k=0;k<=15;k++)p.bl_count[k]=0;for(C[2*p.heap[p.heap_max]+1]=0,v=p.heap_max+1;v<573;v++)(k=C[2*C[2*(y=p.heap[v])+1]+1]+1)>F&&(k=F,N++),C[2*y+1]=k,y>A||(p.bl_count[k]++,w=0,y>=R&&(w=E[y-R]),_=C[2*y],p.opt_len+=_*(k+w),S&&(p.static_len+=_*(I[2*y+1]+w)));if(N!==0){do{for(k=F-1;p.bl_count[k]===0;)k--;p.bl_count[k]--,p.bl_count[k+1]+=2,p.bl_count[F]--,N-=2}while(N>0);for(k=F;k!==0;k--)for(y=p.bl_count[k];y!==0;)(b=p.heap[--v])>A||(C[2*b+1]!==k&&(p.opt_len+=(k-C[2*b+1])*C[2*b],C[2*b+1]=k),y--)}}(e,n),zf(o,f,e.bl_count)}function jf(e,n,t){var a,l,o=-1,d=n[1],s=0,h=7,f=4;for(d===0&&(h=138,f=3),n[2*(t+1)+1]=65535,a=0;a<=t;a++)l=d,d=n[2*(a+1)+1],++s<h&&l===d||(s<f?e.bl_tree[2*l]+=s:l!==0?(l!==o&&e.bl_tree[2*l]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=l,d===0?(h=138,f=3):l===d?(h=6,f=3):(h=7,f=4))}function Gf(e,n,t){var a,l,o=-1,d=n[1],s=0,h=7,f=4;for(d===0&&(h=138,f=3),a=0;a<=t;a++)if(l=d,d=n[2*(a+1)+1],!(++s<h&&l===d)){if(s<f)do Zi(e,l,e.bl_tree);while(--s!=0);else l!==0?(l!==o&&(Zi(e,l,e.bl_tree),s--),Zi(e,16,e.bl_tree),Wl(e,s-3,2)):s<=10?(Zi(e,17,e.bl_tree),Wl(e,s-3,3)):(Zi(e,18,e.bl_tree),Wl(e,s-11,7));s=0,o=l,d===0?(h=138,f=3):l===d?(h=6,f=3):(h=7,f=4)}}lu(nd);var Wf=!1;function Yf(e,n,t,a){Wl(e,0+(a?1:0),3),function(l,o,d,s){Vf(l),s&&(dc(l,d),dc(l,~d)),Ia.arraySet(l.pending_buf,l.window,o,d,l.pending),l.pending+=d}(e,n,t,!0)}var fi={_tr_init:function(e){Wf||(function(){var n,t,a,l,o,d=new Array(16);for(a=0,l=0;l<28;l++)for(gh[l]=a,n=0;n<1<<ph[l];n++)cc[a++]=l;for(cc[a-1]=l,o=0,l=0;l<16;l++)for(nd[l]=o,n=0;n<1<<ad[l];n++)uc[o++]=l;for(o>>=7;l<30;l++)for(nd[l]=o<<7,n=0;n<1<<ad[l]-7;n++)uc[256+o++]=l;for(t=0;t<=15;t++)d[t]=0;for(n=0;n<=143;)bo[2*n+1]=8,n++,d[8]++;for(;n<=255;)bo[2*n+1]=9,n++,d[9]++;for(;n<=279;)bo[2*n+1]=7,n++,d[7]++;for(;n<=287;)bo[2*n+1]=8,n++,d[8]++;for(zf(bo,287,d),n=0;n<30;n++)sc[2*n+1]=5,sc[2*n]=Of(n,5);Mf=new vh(bo,ph,257,286,15),Nf=new vh(sc,ad,0,30,15),Lf=new vh(new Array(0),A1,0,19,7)}(),Wf=!0),e.l_desc=new yh(e.dyn_ltree,Mf),e.d_desc=new yh(e.dyn_dtree,Nf),e.bl_desc=new yh(e.bl_tree,Lf),e.bi_buf=0,e.bi_valid=0,Bf(e)},_tr_stored_block:Yf,_tr_flush_block:function(e,n,t,a){var l,o,d=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=function(s){var h,f=4093624447;for(h=0;h<=31;h++,f>>>=1)if(1&f&&s.dyn_ltree[2*h]!==0)return 0;if(s.dyn_ltree[18]!==0||s.dyn_ltree[20]!==0||s.dyn_ltree[26]!==0)return 1;for(h=32;h<256;h++)if(s.dyn_ltree[2*h]!==0)return 1;return 0}(e)),kh(e,e.l_desc),kh(e,e.d_desc),d=function(s){var h;for(jf(s,s.dyn_ltree,s.l_desc.max_code),jf(s,s.dyn_dtree,s.d_desc.max_code),kh(s,s.bl_desc),h=18;h>=3&&s.bl_tree[2*qf[h]+1]===0;h--);return s.opt_len+=3*(h+1)+5+5+4,h}(e),l=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=l&&(l=o)):l=o=t+5,t+4<=l&&n!==-1?Yf(e,n,t,a):e.strategy===4||o===l?(Wl(e,2+(a?1:0),3),Hf(e,bo,sc)):(Wl(e,4+(a?1:0),3),function(s,h,f,p){var g;for(Wl(s,h-257,5),Wl(s,f-1,5),Wl(s,p-4,4),g=0;g<p;g++)Wl(s,s.bl_tree[2*qf[g]+1],3);Gf(s,s.dyn_ltree,h-1),Gf(s,s.dyn_dtree,f-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),Hf(e,e.dyn_ltree,e.dyn_dtree)),Bf(e),a&&Vf(e)},_tr_tally:function(e,n,t){return e.pending_buf[e.d_buf+2*e.last_lit]=n>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&n,e.pending_buf[e.l_buf+e.last_lit]=255&t,e.last_lit++,n===0?e.dyn_ltree[2*t]++:(e.matches++,n--,e.dyn_ltree[2*(cc[t]+256+1)]++,e.dyn_dtree[2*Pf(n)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){Wl(e,2,3),Zi(e,256,bo),function(n){n.bi_valid===16?(dc(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)}(e)}},hc=function(e,n,t,a){for(var l=65535&e|0,o=e>>>16&65535|0,d=0;t!==0;){t-=d=t>2e3?2e3:t;do o=o+(l=l+n[a++]|0)|0;while(--d);l%=65521,o%=65521}return l|o<<16|0},S1=function(){for(var e,n=[],t=0;t<256;t++){e=t;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;n[t]=e}return n}(),iu,yl=function(e,n,t,a){var l=S1,o=a+t;e^=-1;for(var d=a;d<o;d++)e=e>>>8^l[255&(e^n[d])];return-1^e},Es={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function Jo(e,n){return e.msg=Es[n],n}function Xf(e){return(e<<1)-(e>4?9:0)}function Qo(e){for(var n=e.length;--n>=0;)e[n]=0}function es(e){var n=e.state,t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(Ia.arraySet(e.output,n.pending_buf,n.pending_out,t,e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))}function Tl(e,n){fi._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,es(e.strm)}function fn(e,n){e.pending_buf[e.pending++]=n}function mc(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=255&n}function Zf(e,n){var t,a,l=e.max_chain_length,o=e.strstart,d=e.prev_length,s=e.nice_match,h=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,f=e.window,p=e.w_mask,g=e.prev,v=e.strstart+258,y=f[o+d-1],b=f[o+d];e.prev_length>=e.good_match&&(l>>=2),s>e.lookahead&&(s=e.lookahead);do if(f[(t=n)+d]===b&&f[t+d-1]===y&&f[t]===f[o]&&f[++t]===f[o+1]){o+=2,t++;do;while(f[++o]===f[++t]&&f[++o]===f[++t]&&f[++o]===f[++t]&&f[++o]===f[++t]&&f[++o]===f[++t]&&f[++o]===f[++t]&&f[++o]===f[++t]&&f[++o]===f[++t]&&o<v);if(a=258-(v-o),o=v-258,a>d){if(e.match_start=n,d=a,a>=s)break;y=f[o+d-1],b=f[o+d]}}while((n=g[n&p])>h&&--l!=0);return d<=e.lookahead?d:e.lookahead}function $s(e){var n,t,a,l,o,d,s,h,f,p,g=e.w_size;do{if(l=e.window_size-e.lookahead-e.strstart,e.strstart>=g+(g-262)){Ia.arraySet(e.window,e.window,g,g,0),e.match_start-=g,e.strstart-=g,e.block_start-=g,n=t=e.hash_size;do a=e.head[--n],e.head[n]=a>=g?a-g:0;while(--t);n=t=g;do a=e.prev[--n],e.prev[n]=a>=g?a-g:0;while(--t);l+=g}if(e.strm.avail_in===0)break;if(d=e.strm,s=e.window,h=e.strstart+e.lookahead,f=l,p=void 0,(p=d.avail_in)>f&&(p=f),t=p===0?0:(d.avail_in-=p,Ia.arraySet(s,d.input,d.next_in,p,h),d.state.wrap===1?d.adler=hc(d.adler,s,p,h):d.state.wrap===2&&(d.adler=yl(d.adler,s,p,h)),d.next_in+=p,d.total_in+=p,p),e.lookahead+=t,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+3-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&e.strm.avail_in!==0)}function xh(e,n){for(var t,a;;){if(e.lookahead<262){if($s(e),e.lookahead<262&&n===0)return 1;if(e.lookahead===0)break}if(t=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-262&&(e.match_length=Zf(e,t)),e.match_length>=3)if(a=fi._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else a=fi._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(Tl(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,n===4?(Tl(e,!0),e.strm.avail_out===0?3:4):e.last_lit&&(Tl(e,!1),e.strm.avail_out===0)?1:2}function ou(e,n){for(var t,a,l;;){if(e.lookahead<262){if($s(e),e.lookahead<262&&n===0)return 1;if(e.lookahead===0)break}if(t=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-262&&(e.match_length=Zf(e,t),e.match_length<=5&&(e.strategy===1||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){l=e.strstart+e.lookahead-3,a=fi._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=l&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(Tl(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if((a=fi._tr_tally(e,0,e.window[e.strstart-1]))&&Tl(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=fi._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,n===4?(Tl(e,!0),e.strm.avail_out===0?3:4):e.last_lit&&(Tl(e,!1),e.strm.avail_out===0)?1:2}function Ki(e,n,t,a,l){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=a,this.func=l}function I1(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ia.Buf16(1146),this.dyn_dtree=new Ia.Buf16(122),this.bl_tree=new Ia.Buf16(78),Qo(this.dyn_ltree),Qo(this.dyn_dtree),Qo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ia.Buf16(16),this.heap=new Ia.Buf16(573),Qo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ia.Buf16(573),Qo(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Kf(e){var n;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(n=e.state).pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,e.adler=n.wrap===2?0:1,n.last_flush=0,fi._tr_init(n),0):Jo(e,-2)}function Jf(e){var n,t=Kf(e);return t===0&&((n=e.state).window_size=2*n.w_size,Qo(n.head),n.max_lazy_match=iu[n.level].max_lazy,n.good_match=iu[n.level].good_length,n.nice_match=iu[n.level].nice_length,n.max_chain_length=iu[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t}function Qf(e,n,t,a,l,o){if(!e)return-2;var d=1;if(n===-1&&(n=6),a<0?(d=0,a=-a):a>15&&(d=2,a-=16),l<1||l>9||t!==8||a<8||a>15||n<0||n>9||o<0||o>4)return Jo(e,-2);a===8&&(a=9);var s=new I1;return e.state=s,s.strm=e,s.wrap=d,s.gzhead=null,s.w_bits=a,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=l+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Ia.Buf8(2*s.w_size),s.head=new Ia.Buf16(s.hash_size),s.prev=new Ia.Buf16(s.w_size),s.lit_bufsize=1<<l+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Ia.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=n,s.strategy=o,s.method=t,Jf(e)}iu=[new Ki(0,0,0,0,function(e,n){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if($s(e),e.lookahead===0&&n===0)return 1;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+t;if((e.strstart===0||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,Tl(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-262&&(Tl(e,!1),e.strm.avail_out===0))return 1}return e.insert=0,n===4?(Tl(e,!0),e.strm.avail_out===0?3:4):(e.strstart>e.block_start&&(Tl(e,!1),e.strm.avail_out),1)}),new Ki(4,4,8,4,xh),new Ki(4,5,16,8,xh),new Ki(4,6,32,32,xh),new Ki(4,4,16,16,ou),new Ki(8,16,32,32,ou),new Ki(8,16,128,128,ou),new Ki(8,32,128,256,ou),new Ki(32,128,258,1024,ou),new Ki(32,258,258,4096,ou)];var fc={deflateInit:function(e,n){return Qf(e,n,8,15,8,0)},deflateInit2:Qf,deflateReset:Jf,deflateResetKeep:Kf,deflateSetHeader:function(e,n){return e&&e.state?e.state.wrap!==2?-2:(e.state.gzhead=n,0):-2},deflate:function(e,n){var t,a,l,o;if(!e||!e.state||n>5||n<0)return e?Jo(e,-2):-2;if(a=e.state,!e.output||!e.input&&e.avail_in!==0||a.status===666&&n!==4)return Jo(e,e.avail_out===0?-5:-2);if(a.strm=e,t=a.last_flush,a.last_flush=n,a.status===42)if(a.wrap===2)e.adler=0,fn(a,31),fn(a,139),fn(a,8),a.gzhead?(fn(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),fn(a,255&a.gzhead.time),fn(a,a.gzhead.time>>8&255),fn(a,a.gzhead.time>>16&255),fn(a,a.gzhead.time>>24&255),fn(a,a.level===9?2:a.strategy>=2||a.level<2?4:0),fn(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(fn(a,255&a.gzhead.extra.length),fn(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=yl(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(fn(a,0),fn(a,0),fn(a,0),fn(a,0),fn(a,0),fn(a,a.level===9?2:a.strategy>=2||a.level<2?4:0),fn(a,3),a.status=113);else{var d=8+(a.w_bits-8<<4)<<8;d|=(a.strategy>=2||a.level<2?0:a.level<6?1:a.level===6?2:3)<<6,a.strstart!==0&&(d|=32),d+=31-d%31,a.status=113,mc(a,d),a.strstart!==0&&(mc(a,e.adler>>>16),mc(a,65535&e.adler)),e.adler=1}if(a.status===69)if(a.gzhead.extra){for(l=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>l&&(e.adler=yl(e.adler,a.pending_buf,a.pending-l,l)),es(e),l=a.pending,a.pending!==a.pending_buf_size));)fn(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>l&&(e.adler=yl(e.adler,a.pending_buf,a.pending-l,l)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(a.status===73)if(a.gzhead.name){l=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>l&&(e.adler=yl(e.adler,a.pending_buf,a.pending-l,l)),es(e),l=a.pending,a.pending===a.pending_buf_size)){o=1;break}o=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,fn(a,o)}while(o!==0);a.gzhead.hcrc&&a.pending>l&&(e.adler=yl(e.adler,a.pending_buf,a.pending-l,l)),o===0&&(a.gzindex=0,a.status=91)}else a.status=91;if(a.status===91)if(a.gzhead.comment){l=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>l&&(e.adler=yl(e.adler,a.pending_buf,a.pending-l,l)),es(e),l=a.pending,a.pending===a.pending_buf_size)){o=1;break}o=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,fn(a,o)}while(o!==0);a.gzhead.hcrc&&a.pending>l&&(e.adler=yl(e.adler,a.pending_buf,a.pending-l,l)),o===0&&(a.status=103)}else a.status=103;if(a.status===103&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&es(e),a.pending+2<=a.pending_buf_size&&(fn(a,255&e.adler),fn(a,e.adler>>8&255),e.adler=0,a.status=113)):a.status=113),a.pending!==0){if(es(e),e.avail_out===0)return a.last_flush=-1,0}else if(e.avail_in===0&&Xf(n)<=Xf(t)&&n!==4)return Jo(e,-5);if(a.status===666&&e.avail_in!==0)return Jo(e,-5);if(e.avail_in!==0||a.lookahead!==0||n!==0&&a.status!==666){var s=a.strategy===2?function(h,f){for(var p;;){if(h.lookahead===0&&($s(h),h.lookahead===0)){if(f===0)return 1;break}if(h.match_length=0,p=fi._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++,p&&(Tl(h,!1),h.strm.avail_out===0))return 1}return h.insert=0,f===4?(Tl(h,!0),h.strm.avail_out===0?3:4):h.last_lit&&(Tl(h,!1),h.strm.avail_out===0)?1:2}(a,n):a.strategy===3?function(h,f){for(var p,g,v,y,b=h.window;;){if(h.lookahead<=258){if($s(h),h.lookahead<=258&&f===0)return 1;if(h.lookahead===0)break}if(h.match_length=0,h.lookahead>=3&&h.strstart>0&&(g=b[v=h.strstart-1])===b[++v]&&g===b[++v]&&g===b[++v]){y=h.strstart+258;do;while(g===b[++v]&&g===b[++v]&&g===b[++v]&&g===b[++v]&&g===b[++v]&&g===b[++v]&&g===b[++v]&&g===b[++v]&&v<y);h.match_length=258-(y-v),h.match_length>h.lookahead&&(h.match_length=h.lookahead)}if(h.match_length>=3?(p=fi._tr_tally(h,1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(p=fi._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++),p&&(Tl(h,!1),h.strm.avail_out===0))return 1}return h.insert=0,f===4?(Tl(h,!0),h.strm.avail_out===0?3:4):h.last_lit&&(Tl(h,!1),h.strm.avail_out===0)?1:2}(a,n):iu[a.level].func(a,n);if(s!==3&&s!==4||(a.status=666),s===1||s===3)return e.avail_out===0&&(a.last_flush=-1),0;if(s===2&&(n===1?fi._tr_align(a):n!==5&&(fi._tr_stored_block(a,0,0,!1),n===3&&(Qo(a.head),a.lookahead===0&&(a.strstart=0,a.block_start=0,a.insert=0))),es(e),e.avail_out===0))return a.last_flush=-1,0}return n!==4?0:a.wrap<=0?1:(a.wrap===2?(fn(a,255&e.adler),fn(a,e.adler>>8&255),fn(a,e.adler>>16&255),fn(a,e.adler>>24&255),fn(a,255&e.total_in),fn(a,e.total_in>>8&255),fn(a,e.total_in>>16&255),fn(a,e.total_in>>24&255)):(mc(a,e.adler>>>16),mc(a,65535&e.adler)),es(e),a.wrap>0&&(a.wrap=-a.wrap),a.pending!==0?0:1)},deflateEnd:function(e){var n;return e&&e.state?(n=e.state.status)!==42&&n!==69&&n!==73&&n!==91&&n!==103&&n!==113&&n!==666?Jo(e,-2):(e.state=null,n===113?Jo(e,-3):0):-2},deflateSetDictionary:function(e,n){var t,a,l,o,d,s,h,f,p=n.length;if(!e||!e.state||(o=(t=e.state).wrap)===2||o===1&&t.status!==42||t.lookahead)return-2;for(o===1&&(e.adler=hc(e.adler,n,p,0)),t.wrap=0,p>=t.w_size&&(o===0&&(Qo(t.head),t.strstart=0,t.block_start=0,t.insert=0),f=new Ia.Buf8(t.w_size),Ia.arraySet(f,n,p-t.w_size,t.w_size,0),n=f,p=t.w_size),d=e.avail_in,s=e.next_in,h=e.input,e.avail_in=p,e.next_in=0,e.input=n,$s(t);t.lookahead>=3;){a=t.strstart,l=t.lookahead-2;do t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+3-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++;while(--l);t.strstart=a,t.lookahead=2,$s(t)}return t.strstart+=t.lookahead,t.block_start=t.strstart,t.insert=t.lookahead,t.lookahead=0,t.match_length=t.prev_length=2,t.match_available=0,e.next_in=s,e.input=h,e.avail_in=d,t.wrap=o,0},deflateInfo:"pako deflate (from Nodeca project)"},ep=!0,tp=!0;try{String.fromCharCode.apply(null,[0])}catch{ep=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{tp=!1}for(var pc=new Ia.Buf8(256),ts=0;ts<256;ts++)pc[ts]=ts>=252?6:ts>=248?5:ts>=240?4:ts>=224?3:ts>=192?2:1;pc[254]=pc[254]=1;function rp(e,n){if(n<65534&&(e.subarray&&tp||!e.subarray&&ep))return String.fromCharCode.apply(null,Ia.shrinkBuf(e,n));for(var t="",a=0;a<n;a++)t+=String.fromCharCode(e[a]);return t}var wh=function(e){var n,t,a,l,o,d=e.length,s=0;for(l=0;l<d;l++)(64512&(t=e.charCodeAt(l)))==55296&&l+1<d&&(64512&(a=e.charCodeAt(l+1)))==56320&&(t=65536+(t-55296<<10)+(a-56320),l++),s+=t<128?1:t<2048?2:t<65536?3:4;for(n=new Ia.Buf8(s),o=0,l=0;o<s;l++)(64512&(t=e.charCodeAt(l)))==55296&&l+1<d&&(64512&(a=e.charCodeAt(l+1)))==56320&&(t=65536+(t-55296<<10)+(a-56320),l++),t<128?n[o++]=t:t<2048?(n[o++]=192|t>>>6,n[o++]=128|63&t):t<65536?(n[o++]=224|t>>>12,n[o++]=128|t>>>6&63,n[o++]=128|63&t):(n[o++]=240|t>>>18,n[o++]=128|t>>>12&63,n[o++]=128|t>>>6&63,n[o++]=128|63&t);return n},R1=function(e){return rp(e,e.length)},E1=function(e){for(var n=new Ia.Buf8(e.length),t=0,a=n.length;t<a;t++)n[t]=e.charCodeAt(t);return n},$1=function(e,n){var t,a,l,o,d=n||e.length,s=new Array(2*d);for(a=0,t=0;t<d;)if((l=e[t++])<128)s[a++]=l;else if((o=pc[l])>4)s[a++]=65533,t+=o-1;else{for(l&=o===2?31:o===3?15:7;o>1&&t<d;)l=l<<6|63&e[t++],o--;o>1?s[a++]=65533:l<65536?s[a++]=l:(l-=65536,s[a++]=55296|l>>10&1023,s[a++]=56320|1023&l)}return rp(s,a)},D1=function(e,n){var t;for((n=n||e.length)>e.length&&(n=e.length),t=n-1;t>=0&&(192&e[t])==128;)t--;return t<0||t===0?n:t+pc[e[t]]>n?t:n},ap=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},np=Object.prototype.toString;function Ds(e){if(!(this instanceof Ds))return new Ds(e);this.options=Ia.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ap,this.strm.avail_out=0;var t=fc.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==0)throw new Error(Es[t]);if(n.header&&fc.deflateSetHeader(this.strm,n.header),n.dictionary){var a;if(a=typeof n.dictionary=="string"?wh(n.dictionary):np.call(n.dictionary)==="[object ArrayBuffer]"?new Uint8Array(n.dictionary):n.dictionary,(t=fc.deflateSetDictionary(this.strm,a))!==0)throw new Error(Es[t]);this._dict_set=!0}}function _h(e,n){var t=new Ds(n);if(t.push(e,!0),t.err)throw t.msg||Es[t.err];return t.result}Ds.prototype.push=function(e,n){var t,a,l=this.strm,o=this.options.chunkSize;if(this.ended)return!1;a=n===~~n?n:n===!0?4:0,typeof e=="string"?l.input=wh(e):np.call(e)==="[object ArrayBuffer]"?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new Ia.Buf8(o),l.next_out=0,l.avail_out=o),(t=fc.deflate(l,a))!==1&&t!==0)return this.onEnd(t),this.ended=!0,!1;l.avail_out!==0&&(l.avail_in!==0||a!==4&&a!==2)||(this.options.to==="string"?this.onData(R1(Ia.shrinkBuf(l.output,l.next_out))):this.onData(Ia.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||l.avail_out===0)&&t!==1);return a===4?(t=fc.deflateEnd(this.strm),this.onEnd(t),this.ended=!0,t===0):a!==2||(this.onEnd(0),l.avail_out=0,!0)},Ds.prototype.onData=function(e){this.chunks.push(e)},Ds.prototype.onEnd=function(e){e===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ia.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var F1={Deflate:Ds,deflate:_h,deflateRaw:function(e,n){return(n=n||{}).raw=!0,_h(e,n)},gzip:function(e,n){return(n=n||{}).gzip=!0,_h(e,n)}},q1=function(e,n){var t,a,l,o,d,s,h,f,p,g,v,y,b,k,w,_,C,A,I,S,E,R,F,N,z;t=e.state,a=e.next_in,N=e.input,l=a+(e.avail_in-5),o=e.next_out,z=e.output,d=o-(n-e.avail_out),s=o+(e.avail_out-257),h=t.dmax,f=t.wsize,p=t.whave,g=t.wnext,v=t.window,y=t.hold,b=t.bits,k=t.lencode,w=t.distcode,_=(1<<t.lenbits)-1,C=(1<<t.distbits)-1;e:do{b<15&&(y+=N[a++]<<b,b+=8,y+=N[a++]<<b,b+=8),A=k[y&_];t:for(;;){if(y>>>=I=A>>>24,b-=I,(I=A>>>16&255)===0)z[o++]=65535&A;else{if(!(16&I)){if(!(64&I)){A=k[(65535&A)+(y&(1<<I)-1)];continue t}if(32&I){t.mode=12;break e}e.msg="invalid literal/length code",t.mode=30;break e}S=65535&A,(I&=15)&&(b<I&&(y+=N[a++]<<b,b+=8),S+=y&(1<<I)-1,y>>>=I,b-=I),b<15&&(y+=N[a++]<<b,b+=8,y+=N[a++]<<b,b+=8),A=w[y&C];r:for(;;){if(y>>>=I=A>>>24,b-=I,!(16&(I=A>>>16&255))){if(!(64&I)){A=w[(65535&A)+(y&(1<<I)-1)];continue r}e.msg="invalid distance code",t.mode=30;break e}if(E=65535&A,b<(I&=15)&&(y+=N[a++]<<b,(b+=8)<I&&(y+=N[a++]<<b,b+=8)),(E+=y&(1<<I)-1)>h){e.msg="invalid distance too far back",t.mode=30;break e}if(y>>>=I,b-=I,E>(I=o-d)){if((I=E-I)>p&&t.sane){e.msg="invalid distance too far back",t.mode=30;break e}if(R=0,F=v,g===0){if(R+=f-I,I<S){S-=I;do z[o++]=v[R++];while(--I);R=o-E,F=z}}else if(g<I){if(R+=f+g-I,(I-=g)<S){S-=I;do z[o++]=v[R++];while(--I);if(R=0,g<S){S-=I=g;do z[o++]=v[R++];while(--I);R=o-E,F=z}}}else if(R+=g-I,I<S){S-=I;do z[o++]=v[R++];while(--I);R=o-E,F=z}for(;S>2;)z[o++]=F[R++],z[o++]=F[R++],z[o++]=F[R++],S-=3;S&&(z[o++]=F[R++],S>1&&(z[o++]=F[R++]))}else{R=o-E;do z[o++]=z[R++],z[o++]=z[R++],z[o++]=z[R++],S-=3;while(S>2);S&&(z[o++]=z[R++],S>1&&(z[o++]=z[R++]))}break}}break}}while(a<l&&o<s);a-=S=b>>3,y&=(1<<(b-=S<<3))-1,e.next_in=a,e.next_out=o,e.avail_in=a<l?l-a+5:5-(a-l),e.avail_out=o<s?s-o+257:257-(o-s),t.hold=y,t.bits=b},M1=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N1=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],L1=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P1=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],gc=function(e,n,t,a,l,o,d,s){var h,f,p,g,v,y,b,k,w,_=s.bits,C=0,A=0,I=0,S=0,E=0,R=0,F=0,N=0,z=0,P=0,q=null,V=0,x=new Ia.Buf16(16),ee=new Ia.Buf16(16),ne=null,ae=0;for(C=0;C<=15;C++)x[C]=0;for(A=0;A<a;A++)x[n[t+A]]++;for(E=_,S=15;S>=1&&x[S]===0;S--);if(E>S&&(E=S),S===0)return l[o++]=20971520,l[o++]=20971520,s.bits=1,0;for(I=1;I<S&&x[I]===0;I++);for(E<I&&(E=I),N=1,C=1;C<=15;C++)if(N<<=1,(N-=x[C])<0)return-1;if(N>0&&(e===0||S!==1))return-1;for(ee[1]=0,C=1;C<15;C++)ee[C+1]=ee[C]+x[C];for(A=0;A<a;A++)n[t+A]!==0&&(d[ee[n[t+A]]++]=A);if(e===0?(q=ne=d,y=19):e===1?(q=M1,V-=257,ne=N1,ae-=257,y=256):(q=L1,ne=P1,y=-1),P=0,A=0,C=I,v=o,R=E,F=0,p=-1,g=(z=1<<E)-1,e===1&&z>852||e===2&&z>592)return 1;for(;;){b=C-F,d[A]<y?(k=0,w=d[A]):d[A]>y?(k=ne[ae+d[A]],w=q[V+d[A]]):(k=96,w=0),h=1<<C-F,I=f=1<<R;do l[v+(P>>F)+(f-=h)]=b<<24|k<<16|w|0;while(f!==0);for(h=1<<C-1;P&h;)h>>=1;if(h!==0?(P&=h-1,P+=h):P=0,A++,--x[C]==0){if(C===S)break;C=n[t+d[A]]}if(C>E&&(P&g)!==p){for(F===0&&(F=E),v+=I,N=1<<(R=C-F);R+F<S&&!((N-=x[R+F])<=0);)R++,N<<=1;if(z+=1<<R,e===1&&z>852||e===2&&z>592)return 1;l[p=P&g]=E<<24|R<<16|v-o|0}}return P!==0&&(l[v+P]=C-F<<24|64<<16|0),s.bits=E,0};function lp(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function O1(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ia.Buf16(320),this.work=new Ia.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ip(e){var n;return e&&e.state?(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Ia.Buf32(852),n.distcode=n.distdyn=new Ia.Buf32(592),n.sane=1,n.back=-1,0):-2}function op(e){var n;return e&&e.state?((n=e.state).wsize=0,n.whave=0,n.wnext=0,ip(e)):-2}function sp(e,n){var t,a;return e&&e.state?(a=e.state,n<0?(t=0,n=-n):(t=1+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?-2:(a.window!==null&&a.wbits!==n&&(a.window=null),a.wrap=t,a.wbits=n,op(e))):-2}function up(e,n){var t,a;return e?(a=new O1,e.state=a,a.window=null,(t=sp(e,n))!==0&&(e.state=null),t):-2}var Ch,Th,cp=!0;function z1(e){if(cp){var n;for(Ch=new Ia.Buf32(512),Th=new Ia.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(gc(1,e.lens,0,288,Ch,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;gc(2,e.lens,0,32,Th,0,e.work,{bits:5}),cp=!1}e.lencode=Ch,e.lenbits=9,e.distcode=Th,e.distbits=5}function dp(e,n,t,a){var l,o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Ia.Buf8(o.wsize)),a>=o.wsize?(Ia.arraySet(o.window,n,t-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((l=o.wsize-o.wnext)>a&&(l=a),Ia.arraySet(o.window,n,t-a,l,o.wnext),(a-=l)?(Ia.arraySet(o.window,n,t-a,a,0),o.wnext=a,o.whave=o.wsize):(o.wnext+=l,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=l))),0}var su={inflateReset:op,inflateReset2:sp,inflateResetKeep:ip,inflateInit:function(e){return up(e,15)},inflateInit2:up,inflate:function(e,n){var t,a,l,o,d,s,h,f,p,g,v,y,b,k,w,_,C,A,I,S,E,R,F,N,z=0,P=new Ia.Buf8(4),q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return-2;(t=e.state).mode===12&&(t.mode=13),d=e.next_out,l=e.output,h=e.avail_out,o=e.next_in,a=e.input,s=e.avail_in,f=t.hold,p=t.bits,g=s,v=h,R=0;e:for(;;)switch(t.mode){case 1:if(t.wrap===0){t.mode=13;break}for(;p<16;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(2&t.wrap&&f===35615){t.check=0,P[0]=255&f,P[1]=f>>>8&255,t.check=yl(t.check,P,2,0),f=0,p=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",t.mode=30;break}if((15&f)!=8){e.msg="unknown compression method",t.mode=30;break}if(p-=4,E=8+(15&(f>>>=4)),t.wbits===0)t.wbits=E;else if(E>t.wbits){e.msg="invalid window size",t.mode=30;break}t.dmax=1<<E,e.adler=t.check=1,t.mode=512&f?10:12,f=0,p=0;break;case 2:for(;p<16;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(t.flags=f,(255&t.flags)!=8){e.msg="unknown compression method",t.mode=30;break}if(57344&t.flags){e.msg="unknown header flags set",t.mode=30;break}t.head&&(t.head.text=f>>8&1),512&t.flags&&(P[0]=255&f,P[1]=f>>>8&255,t.check=yl(t.check,P,2,0)),f=0,p=0,t.mode=3;case 3:for(;p<32;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}t.head&&(t.head.time=f),512&t.flags&&(P[0]=255&f,P[1]=f>>>8&255,P[2]=f>>>16&255,P[3]=f>>>24&255,t.check=yl(t.check,P,4,0)),f=0,p=0,t.mode=4;case 4:for(;p<16;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}t.head&&(t.head.xflags=255&f,t.head.os=f>>8),512&t.flags&&(P[0]=255&f,P[1]=f>>>8&255,t.check=yl(t.check,P,2,0)),f=0,p=0,t.mode=5;case 5:if(1024&t.flags){for(;p<16;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}t.length=f,t.head&&(t.head.extra_len=f),512&t.flags&&(P[0]=255&f,P[1]=f>>>8&255,t.check=yl(t.check,P,2,0)),f=0,p=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&((y=t.length)>s&&(y=s),y&&(t.head&&(E=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),Ia.arraySet(t.head.extra,a,o,y,E)),512&t.flags&&(t.check=yl(t.check,a,y,o)),s-=y,o+=y,t.length-=y),t.length))break e;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(s===0)break e;y=0;do E=a[o+y++],t.head&&E&&t.length<65536&&(t.head.name+=String.fromCharCode(E));while(E&&y<s);if(512&t.flags&&(t.check=yl(t.check,a,y,o)),s-=y,o+=y,E)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(s===0)break e;y=0;do E=a[o+y++],t.head&&E&&t.length<65536&&(t.head.comment+=String.fromCharCode(E));while(E&&y<s);if(512&t.flags&&(t.check=yl(t.check,a,y,o)),s-=y,o+=y,E)break e}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;p<16;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(f!==(65535&t.check)){e.msg="header crc mismatch",t.mode=30;break}f=0,p=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=12;break;case 10:for(;p<32;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}e.adler=t.check=lp(f),f=0,p=0,t.mode=11;case 11:if(t.havedict===0)return e.next_out=d,e.avail_out=h,e.next_in=o,e.avail_in=s,t.hold=f,t.bits=p,2;e.adler=t.check=1,t.mode=12;case 12:if(n===5||n===6)break e;case 13:if(t.last){f>>>=7&p,p-=7&p,t.mode=27;break}for(;p<3;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}switch(t.last=1&f,p-=1,3&(f>>>=1)){case 0:t.mode=14;break;case 1:if(z1(t),t.mode=20,n===6){f>>>=2,p-=2;break e}break;case 2:t.mode=17;break;case 3:e.msg="invalid block type",t.mode=30}f>>>=2,p-=2;break;case 14:for(f>>>=7&p,p-=7&p;p<32;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",t.mode=30;break}if(t.length=65535&f,f=0,p=0,t.mode=15,n===6)break e;case 15:t.mode=16;case 16:if(y=t.length){if(y>s&&(y=s),y>h&&(y=h),y===0)break e;Ia.arraySet(l,a,o,y,d),s-=y,o+=y,h-=y,d+=y,t.length-=y;break}t.mode=12;break;case 17:for(;p<14;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(t.nlen=257+(31&f),f>>>=5,p-=5,t.ndist=1+(31&f),f>>>=5,p-=5,t.ncode=4+(15&f),f>>>=4,p-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=30;break}t.have=0,t.mode=18;case 18:for(;t.have<t.ncode;){for(;p<3;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}t.lens[q[t.have++]]=7&f,f>>>=3,p-=3}for(;t.have<19;)t.lens[q[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,F={bits:t.lenbits},R=gc(0,t.lens,0,19,t.lencode,0,t.work,F),t.lenbits=F.bits,R){e.msg="invalid code lengths set",t.mode=30;break}t.have=0,t.mode=19;case 19:for(;t.have<t.nlen+t.ndist;){for(;_=(z=t.lencode[f&(1<<t.lenbits)-1])>>>16&255,C=65535&z,!((w=z>>>24)<=p);){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(C<16)f>>>=w,p-=w,t.lens[t.have++]=C;else{if(C===16){for(N=w+2;p<N;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(f>>>=w,p-=w,t.have===0){e.msg="invalid bit length repeat",t.mode=30;break}E=t.lens[t.have-1],y=3+(3&f),f>>>=2,p-=2}else if(C===17){for(N=w+3;p<N;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}p-=w,E=0,y=3+(7&(f>>>=w)),f>>>=3,p-=3}else{for(N=w+7;p<N;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}p-=w,E=0,y=11+(127&(f>>>=w)),f>>>=7,p-=7}if(t.have+y>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=30;break}for(;y--;)t.lens[t.have++]=E}}if(t.mode===30)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=30;break}if(t.lenbits=9,F={bits:t.lenbits},R=gc(1,t.lens,0,t.nlen,t.lencode,0,t.work,F),t.lenbits=F.bits,R){e.msg="invalid literal/lengths set",t.mode=30;break}if(t.distbits=6,t.distcode=t.distdyn,F={bits:t.distbits},R=gc(2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,F),t.distbits=F.bits,R){e.msg="invalid distances set",t.mode=30;break}if(t.mode=20,n===6)break e;case 20:t.mode=21;case 21:if(s>=6&&h>=258){e.next_out=d,e.avail_out=h,e.next_in=o,e.avail_in=s,t.hold=f,t.bits=p,q1(e,v),d=e.next_out,l=e.output,h=e.avail_out,o=e.next_in,a=e.input,s=e.avail_in,f=t.hold,p=t.bits,t.mode===12&&(t.back=-1);break}for(t.back=0;_=(z=t.lencode[f&(1<<t.lenbits)-1])>>>16&255,C=65535&z,!((w=z>>>24)<=p);){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(_&&!(240&_)){for(A=w,I=_,S=C;_=(z=t.lencode[S+((f&(1<<A+I)-1)>>A)])>>>16&255,C=65535&z,!(A+(w=z>>>24)<=p);){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}f>>>=A,p-=A,t.back+=A}if(f>>>=w,p-=w,t.back+=w,t.length=C,_===0){t.mode=26;break}if(32&_){t.back=-1,t.mode=12;break}if(64&_){e.msg="invalid literal/length code",t.mode=30;break}t.extra=15&_,t.mode=22;case 22:if(t.extra){for(N=t.extra;p<N;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}t.length+=f&(1<<t.extra)-1,f>>>=t.extra,p-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=23;case 23:for(;_=(z=t.distcode[f&(1<<t.distbits)-1])>>>16&255,C=65535&z,!((w=z>>>24)<=p);){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(!(240&_)){for(A=w,I=_,S=C;_=(z=t.distcode[S+((f&(1<<A+I)-1)>>A)])>>>16&255,C=65535&z,!(A+(w=z>>>24)<=p);){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}f>>>=A,p-=A,t.back+=A}if(f>>>=w,p-=w,t.back+=w,64&_){e.msg="invalid distance code",t.mode=30;break}t.offset=C,t.extra=15&_,t.mode=24;case 24:if(t.extra){for(N=t.extra;p<N;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}t.offset+=f&(1<<t.extra)-1,f>>>=t.extra,p-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=30;break}t.mode=25;case 25:if(h===0)break e;if(y=v-h,t.offset>y){if((y=t.offset-y)>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=30;break}y>t.wnext?(y-=t.wnext,b=t.wsize-y):b=t.wnext-y,y>t.length&&(y=t.length),k=t.window}else k=l,b=d-t.offset,y=t.length;y>h&&(y=h),h-=y,t.length-=y;do l[d++]=k[b++];while(--y);t.length===0&&(t.mode=21);break;case 26:if(h===0)break e;l[d++]=t.length,h--,t.mode=21;break;case 27:if(t.wrap){for(;p<32;){if(s===0)break e;s--,f|=a[o++]<<p,p+=8}if(v-=h,e.total_out+=v,t.total+=v,v&&(e.adler=t.check=t.flags?yl(t.check,l,v,d-v):hc(t.check,l,v,d-v)),v=h,(t.flags?f:lp(f))!==t.check){e.msg="incorrect data check",t.mode=30;break}f=0,p=0}t.mode=28;case 28:if(t.wrap&&t.flags){for(;p<32;){if(s===0)break e;s--,f+=a[o++]<<p,p+=8}if(f!==(4294967295&t.total)){e.msg="incorrect length check",t.mode=30;break}f=0,p=0}t.mode=29;case 29:R=1;break e;case 30:R=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=d,e.avail_out=h,e.next_in=o,e.avail_in=s,t.hold=f,t.bits=p,(t.wsize||v!==e.avail_out&&t.mode<30&&(t.mode<27||n!==4))&&dp(e,e.output,e.next_out,v-e.avail_out),g-=e.avail_in,v-=e.avail_out,e.total_in+=g,e.total_out+=v,t.total+=v,t.wrap&&v&&(e.adler=t.check=t.flags?yl(t.check,l,v,e.next_out-v):hc(t.check,l,v,e.next_out-v)),e.data_type=t.bits+(t.last?64:0)+(t.mode===12?128:0)+(t.mode===20||t.mode===15?256:0),(g===0&&v===0||n===4)&&R===0&&(R=-5),R},inflateEnd:function(e){if(!e||!e.state)return-2;var n=e.state;return n.window&&(n.window=null),e.state=null,0},inflateGetHeader:function(e,n){var t;return e&&e.state&&2&(t=e.state).wrap?(t.head=n,n.done=!1,0):-2},inflateSetDictionary:function(e,n){var t,a=n.length;return e&&e.state?(t=e.state).wrap!==0&&t.mode!==11?-2:t.mode===11&&hc(1,n,a,0)!==t.check?-3:dp(e,n,a,a)?(t.mode=31,-4):(t.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},Xn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},B1=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},hp=Object.prototype.toString;function Fs(e){if(!(this instanceof Fs))return new Fs(e);this.options=Ia.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),!(n.windowBits>=0&&n.windowBits<16)||e&&e.windowBits||(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&!(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ap,this.strm.avail_out=0;var t=su.inflateInit2(this.strm,n.windowBits);if(t!==Xn.Z_OK)throw new Error(Es[t]);if(this.header=new B1,su.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=wh(n.dictionary):hp.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=su.inflateSetDictionary(this.strm,n.dictionary))!==Xn.Z_OK))throw new Error(Es[t])}function Ah(e,n){var t=new Fs(n);if(t.push(e,!0),t.err)throw t.msg||Es[t.err];return t.result}Fs.prototype.push=function(e,n){var t,a,l,o,d,s=this.strm,h=this.options.chunkSize,f=this.options.dictionary,p=!1;if(this.ended)return!1;a=n===~~n?n:n===!0?Xn.Z_FINISH:Xn.Z_NO_FLUSH,typeof e=="string"?s.input=E1(e):hp.call(e)==="[object ArrayBuffer]"?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new Ia.Buf8(h),s.next_out=0,s.avail_out=h),(t=su.inflate(s,Xn.Z_NO_FLUSH))===Xn.Z_NEED_DICT&&f&&(t=su.inflateSetDictionary(this.strm,f)),t===Xn.Z_BUF_ERROR&&p===!0&&(t=Xn.Z_OK,p=!1),t!==Xn.Z_STREAM_END&&t!==Xn.Z_OK)return this.onEnd(t),this.ended=!0,!1;s.next_out&&(s.avail_out!==0&&t!==Xn.Z_STREAM_END&&(s.avail_in!==0||a!==Xn.Z_FINISH&&a!==Xn.Z_SYNC_FLUSH)||(this.options.to==="string"?(l=D1(s.output,s.next_out),o=s.next_out-l,d=$1(s.output,l),s.next_out=o,s.avail_out=h-o,o&&Ia.arraySet(s.output,s.output,l,o,0),this.onData(d)):this.onData(Ia.shrinkBuf(s.output,s.next_out)))),s.avail_in===0&&s.avail_out===0&&(p=!0)}while((s.avail_in>0||s.avail_out===0)&&t!==Xn.Z_STREAM_END);return t===Xn.Z_STREAM_END&&(a=Xn.Z_FINISH),a===Xn.Z_FINISH?(t=su.inflateEnd(this.strm),this.onEnd(t),this.ended=!0,t===Xn.Z_OK):a!==Xn.Z_SYNC_FLUSH||(this.onEnd(Xn.Z_OK),s.avail_out=0,!0)},Fs.prototype.onData=function(e){this.chunks.push(e)},Fs.prototype.onEnd=function(e){e===Xn.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ia.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var V1={Inflate:Fs,inflate:Ah,inflateRaw:function(e,n){return(n=n||{}).raw=!0,Ah(e,n)},ungzip:Ah},mp={};(0,Ia.assign)(mp,F1,V1,Xn);var U1=mp;function fp(e){$("#luckysheet-cell-loading").find("span").text(e).end().show()}function ld(e,n){if(u.rowHeaderWidth=Nt.rowHeaderWidth*u.zoomRatio,u.columnHeaderHeight=Nt.columnHeaderHeight*u.zoomRatio,$("#luckysheet-rows-h").width(u.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(u.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:u.rowHeaderWidth-1.5,height:u.columnHeaderHeight-1.5}),e!=null){u.visibledatarow=[],u.rh_height=0;for(var t=0;t<e;t++){var a=u.defaultrowlen;u.config.rowlen!=null&&u.config.rowlen[t]!=null&&(a=u.config.rowlen[t]),(u.config.rowhidden==null||u.config.rowhidden[t]==null)&&(u.rh_height+=Math.round((a+1)*u.zoomRatio)),u.visibledatarow.push(u.rh_height)}Nt.enableAddRow||Nt.enableAddBackTop?u.rh_height+=80:u.rh_height+=29}if(n!=null){u.visibledatacolumn=[],u.ch_width=0;for(var l=0;l<n;l++){var o=u.defaultcollen;u.config.columnlen!=null&&u.config.columnlen[l]!=null?o=u.config.columnlen[l]:u.flowdata[0]!=null&&u.flowdata[0][l]!=null&&(o>300?o=300:o<u.defaultcollen&&(o=u.defaultcollen),o!=u.defaultcollen&&(u.config.columnlen==null&&(u.config.columnlen={}),u.config.columnlen[l]=o)),(u.config.colhidden==null||u.config.colhidden[l]==null)&&(u.ch_width+=Math.round((o+1)*u.zoomRatio)),u.visibledatacolumn.push(u.ch_width)}u.ch_width+=120}}function Sh(e){var n={};if(D(e)=="array")for(var t=0;t<e.length;t++){var a=e[t].r,l=e[t].c,o=e[t].f;if(u.flowdata[a][l]!=null&&u.flowdata[a][l].f!=null&&u.flowdata[a][l].f==o){a+"_"+l in n&&(n=H1(n,a,l));var d=e[t].data,s=d.length,h=1;if(D(d[0])=="array"&&(h=d[0].length),j1({row:[a,a+s-1],column:[l,l+h-1]},u.flowdata))for(var f=0;f<s;f++)for(var p=0;p<h;p++){var g=a+f,v=l+p;D(d[0])=="array"?n[g+"_"+v]={v:d[f][p],r:a,c:l}:n[g+"_"+v]={v:d[f],r:a,c:l}}else n[a+"_"+l]={v:"#SPILL!",r:a,c:l}}}return n}function H1(e,n,t){var a=e[n+"_"+t].r,l=e[n+"_"+t].c;for(var o in e)o==a+"_"+l?e[o].v="#SPILL!":e[o].r==a&&e[o].c==l&&delete e[o];return e}function j1(e,n){for(var t=e.row[0],a=e.row[1],l=e.column[0],o=e.column[1],d=!0,s=t;s<=a;s++)for(var h=l;h<=o;h++)if((s!=t||h!=l)&&n[s][h]!=null&&n[s][h].v!=null&&n[s][h].v.toString()!=""){d=!1;break}return d}function rs(e){var n;if(document.createRange)if(e.innerHTML!=e.innerText||e.innerHTML=="")e.focus(),(n=window.getSelection()).selectAllChildren(e),n.collapseToEnd();else{var t=e.innerText.length;(n=document.createRange()).selectNodeContents(e),n.setStart(e.childNodes[0],t),n.collapse(!0);var a=window.getSelection();a.removeAllRanges(),a.addRange(n)}else document.selection&&((n=document.body.createTextRange()).moveToElementText(e),n.collapse(!1),n.select())}function Ji(e){e.target.classList.contains("luckysheet-cols-rows-shift-left")||e.target.classList.contains("luckysheet-cols-rows-shift-right")||$(e.target).hasClass("luckysheet-mousedown-cancel")||$(e.target).filter("[class*='sp-palette']").length!=0||$(e.target).filter("[class*='sp-thumb']").length!=0||$(e.target).filter("[class*='sp-']").length!=0||($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),u.luckysheet_cols_menu_status=!1)}function id(e){return e!==document.body&&document.body.contains(e)}var G1={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1},pp={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1};function qi(e){return e&&e.ct!=null&&e.ct.t=="inlineStr"&&e.ct.s!=null&&e.ct.s.length>0}function Ih(e){return e!=null&&e.t=="inlineStr"&&e.s!=null&&e.s.length>0}function W1(e,n,t,a){var l,o,d=window.getSelection(),s=(l=d.type=="None"?u.inlineStringEditRange:d.getRangeAt(0)).commonAncestorContainer;o=s.id=="luckysheet-rich-text-editor"?$(s):$(s).closest("#luckysheet-rich-text-editor");var h=$(s).closest("#luckysheet-functionbox-cell");if(o.length==0&&h.length==0&&u.inlineStringEditRange!=null&&(o=(s=(l=u.inlineStringEditRange).commonAncestorContainer).id=="luckysheet-rich-text-editor"?$(s):$(s).closest("#luckysheet-rich-text-editor"),h=$(s).closest("#luckysheet-functionbox-cell")),l.collapsed!==!0){var f=l.endContainer,p=l.startContainer,g=l.endOffset,v=l.startOffset;if(o.length>0){if(p===f){var y,b=p.parentNode,k=!1,w=b.innerHTML;o.html().substr(0,5)!="<span"&&(k=!0);var _,C,A,I=v,S=g,E=w.length;_=w.substring(0,I),C=w.substring(I,S),A=w.substring(S,E);var R="";if(_!=""){var F=b.style.cssText;if(k){var N=$(b).closest("#luckysheet-input-box").get(0);N!=null&&(F=Eh(N.style.cssText,F))}R+="<span style='"+F+"'>"+_+"</span>"}if(C!=""){var z=Rh(b.style.cssText,n,t);if(k){var P=$(b).closest("#luckysheet-input-box").get(0);P!=null&&(z=Eh(P.style.cssText,z))}R+="<span style='"+z+"'>"+C+"</span>"}if(A!=""){var q=b.style.cssText;if(k){var V=$(b).closest("#luckysheet-input-box").get(0);V!=null&&(q=Eh(V.style.cssText,q))}R+="<span style='"+q+"'>"+A+"</span>"}p.parentNode.tagName=="SPAN"?(y=o.find("span").index(b),$(b).replaceWith(R)):(y=0,$(b).html(R));var x=0;x=I==0?y:y+1,function(wt){if(window.getSelection){var ct=document.createRange(),bt=wt.firstChild;ct.setStart(bt,0),ct.setEnd(bt,bt.length),ct.startContainer&&id(ct.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(ct))}else if(document.selection){var De=document.body.createTextRange();De.moveToElementText(wt),De.select()}}(o.find("span").get(x))}else if(p.parentNode.tagName=="SPAN"&&f.parentNode.tagName=="SPAN"){var ee,ne,ae=p.parentNode,de=f.parentNode;ee=o.find("span").index(ae),ne=o.find("span").index(de);var ve,U,B,le,Te=ae.innerHTML,ue=de.innerHTML,be=v,ye=g,ce=ue.length;ve=Te.substring(0,be),U=Te.substring(be,Te.length),B=ue.substring(0,ye),le=ue.substring(ye,ce);for(var Re,pe,me=o.find("span"),re=(me.slice(ee,ne+1),""),_e=0;_e<ee;_e++){var Ze=me.get(_e),We=Ze.innerHTML;re+="<span style='"+Ze.style.cssText+"'>"+We+"</span>"}if(ve!=""&&(re+="<span style='"+ae.style.cssText+"'>"+ve+"</span>"),U!=""&&(re+="<span style='"+Rh(ae.style.cssText,n,t)+"'>"+U+"</span>"),ee<ne)for(var Xe=ee+1;Xe<ne;Xe++){var Ue=me.get(Xe),mt=Ue.innerHTML;re+="<span style='"+Ue.style.cssText+"'>"+mt+"</span>"}B!=""&&(re+="<span style='"+Rh(de.style.cssText,n,t)+"'>"+B+"</span>"),le!=""&&(re+="<span style='"+de.style.cssText+"'>"+le+"</span>");for(var St=ne+1;St<me.length;St++){var at=me.get(St),dt=at.innerHTML;re+="<span style='"+at.style.cssText+"'>"+dt+"</span>"}o.html(re),be==0?(Re=ee,pe=ne):(Re=ee+1,pe=ne+1),function(wt,ct){if(window.getSelection){var bt=document.createRange(),De=wt.firstChild,He=ct.firstChild;bt.setStart(De,0),bt.setEnd(He,He.length),bt.startContainer&&id(bt.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(bt))}}((me=o.find("span")).get(Re),me.get(pe))}}else h.length}}function Y1(e){var n=window.getSelection();if(n.type!="None"){var t,a=n.getRangeAt(0),l=a.commonAncestorContainer;t=l.id=="luckysheet-rich-text-editor"?$(l):$(l).closest("#luckysheet-rich-text-editor");var o=$(l).closest("#luckysheet-functionbox-cell"),d=(a.endContainer,a.startContainer),s=(a.endOffset,a.startOffset);if(t.length>0){var h=d.parentNode;d.id=="luckysheet-rich-text-editor"&&((h=$(d).find("span")).length==0&&(d.innerHTML="<span></span>",h=$(d).find("span")),s=(h=h.get(h.length-1)).innerHTML.length),a.collapsed===!1&&a.deleteContents();var f,p,g,v,y=h.innerHTML,b=s;if(f=y.substring(0,b),p=y.substring(b,y.length),d.parentNode.tagName=="SPAN"){var k=t.find("span");if((g=k.index(h))==k.length-1&&p==""){var w=k[g].innerHTML;v=w.substr(w.length-1,1)==`
`?"<span style='"+h.style.cssText+"'>"+f+`
</span>`:"<span style='"+h.style.cssText+"'>"+f+`

</span>`}else v="<span style='"+h.style.cssText+"'>"+f+`
`+p+"</span>";$(h).replaceWith(v)}else{var _=od(e);if(v=p==""?"<span style='"+_+"'>"+f+`

</span>`:"<span style='"+_+"'>"+f+`
`+p+"</span>",d.id=="luckysheet-rich-text-editor"){$(h).replaceWith(v);var C=t.find("span");g=C.length-1,s=C.get(g).innerHTML.length-1}else $(h).html(v),g=0}(function(A,I){if(window.getSelection){var S=document.createRange(),E=A.firstChild;I>E.length?I=E.length:I<0&&(I=0),S.setStart(E,I),S.collapse(!0),S.startContainer&&id(S.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(S))}})(t.find("span").get(g),s+1)}else o.length}}function X1(e,n,t){if(e.ct!=null){var a=e.ct.s;if(a!=null)for(var l=0;l<a.length;l++)a[l][n]=t}}function Z1(e){for(var n,t=[],a=null,l=0;l<e.length;l++){var o=e.get(l),d=gp(o.style.cssText),s=JSON.stringify(d),h=o.innerText;h=h.replace(/\n/g,`\r
`),s==a?n.v+=h:(d.v=h,t.push(d),a=s,n=d)}return t}function gp(e){if(e==null||e.length==0)return{};var n=e.split(";"),t=st(),a=t.fontarray,l=t.fontjson,o={ff:a[0],fc:"#000000",fs:10,cl:0,un:0,bl:0,it:0};return n.forEach(function(d){var s=Fl((d=d.toLowerCase()).substr(0,d.indexOf(":"))),h=Fl(d.substr(d.indexOf(":")+1));if(s=="font-weight"&&(o.bl=h=="bold"?1:0),s=="font-style"&&(o.it=h=="italic"?1:0),s=="font-family"){var f=l[h];o.ff=f??h}s=="font-size"&&(o.fs=parseInt(h)),s=="color"&&(o.fc=h),s=="text-decoration"&&(o.cl=1),s=="border-bottom"&&(o.un=1),s=="lucky-strike"&&(o.cl=h),s=="lucky-underline"&&(o.un=h)}),o}var vp={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",cl:"text-decoration",un:"border-bottom"};function yp(e,n){var t=e.split(";");if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(var a=0;a<t.length;a++){var l=t[a],o=Fl((l=l.toLowerCase()).substr(0,l.indexOf(":"))),d=Fl(l.substr(l.indexOf(":")+1));if(o==n)return d}return""}function Rh(e,n,t){var a={};if(a[n]=t,n=="un"){var l=yp(e,"color");l==""&&(l="#000000");var o=yp(e,"font-size");o==""&&(o=11),o=parseInt(o),a._fontSize=o,a._color=l}var d=od(a,void 0,void 0,!1),s=Fl(d.substr(0,d.indexOf(":"))),h=Fl(d.substr(d.indexOf(":")+1));return h=h.substr(0,h.length-1),e=function(f,p,g){var v=f.split(";"),y="";if(p==null||p.length==0)return f;if(f.indexOf(p)>-1)for(var b=0;b<v.length;b++){var k=v[b],w=Fl((k=k.toLowerCase()).substr(0,k.indexOf(":"))),_=Fl(k.substr(k.indexOf(":")+1));w==p?y+=w+":"+g+";":w.length>0&&(y+=w+":"+_+";")}else p.length>0&&(y=f+=p+":"+g+";");return y}(e=function(f,p){var g=f.split(";"),v="",y=p;if(p==null||p.length==0)return f;if(p in vp&&(p=vp[p]),f.indexOf(p)>-1)for(var b=0;b<g.length;b++){var k=g[b],w=Fl((k=k.toLowerCase()).substr(0,k.indexOf(":"))),_=Fl(k.substr(k.indexOf(":")+1));w==p||y=="cl"&&w=="lucky-strike"||y=="un"&&w=="lucky-underline"||w.length>0&&(v+=w+":"+_+";")}else v=f;return v}(e,n),s,h)}function Eh(e,n){for(var t=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],a=e.split(";"),l=n.split(";"),o="",d={},s=0;s<a.length;s++){var h=a[s],f=!0,p=Fl((h=h.toLowerCase()).substr(0,h.indexOf(":"))),g=Fl(h.substr(h.indexOf(":")+1));if(!t||p in pp){for(var v=0;v<l.length;v++){var y=l[v],b=Fl((y=y.toLowerCase()).substr(0,y.indexOf(":"))),k=Fl(y.substr(y.indexOf(":")+1));p!=b||(o+=b+":"+k+";",f=!1)}f&&(o+=p+":"+g+";"),d[p]=1}}for(var w=0;w<l.length;w++){var _=l[w],C=Fl((_=_.toLowerCase()).substr(0,_.indexOf(":"))),A=Fl(_.substr(_.indexOf(":")+1));t&&!(C in pp)||C in d||(o+=C+":"+A+";")}return o}function nn(e,n){if(e==null&&(e=u.luckysheet_select_save[0]),e.row==null||e.row.length==0)return[];var t,a;n!=null&&n!=u.currentSheetIndex?(t=u.luckysheetfile[je(n)].data,a=u.luckysheetfile[je(n)].config):(t=vr.deepCopyFlowData(u.flowdata),a=u.config);for(var l=[],o=e.row[0];o<=e.row[1];o++)if(t[o]!=null&&(a.rowhidden==null||a.rowhidden[o]==null)){for(var d=[],s=e.column[0];s<=e.column[1];s++)d.push(t[o][s]);l.push(d)}return l}function $h(e,n){if(n==null||n.row==null||n.row.length==0)return[];var t=Sh(u.luckysheetfile[je(u.currentSheetIndex)].dynamicArray),a=[];if(e==null)return a;for(var l=n.row[0];l<=n.row[1];l++)if(e[l]!=null){for(var o=[],d=n.column[0];d<=n.column[1];d++){var s=void 0;s=l+"_"+d in t?t[l+"_"+d]:e[l][d],o.push(s)}a.push(o)}return a}function K1(e){if(e==null||e.row==null||e.row.length==0)return[];for(var n=[],t=e.row[0];t<=e.row[1];t++){var a=[];if(u.config.rowhidden==null||u.config.rowhidden[t]==null){for(var l=e.column[0];l<=e.column[1];l++){var o="";u.flowdata[t]!=null&&u.flowdata[t][l]!=null&&(o=u.flowdata[t][l]),a.push(o)}n.push(a)}}return n}function Hr(e,n,t,a){var l;if(a==null&&(a="v"),t==null&&(t=u.flowdata),e!=null&&n!=null)l=t[e][n];else if(e!=null)l=t[e];else{if(n==null)return t;l=t[0].map(function(d,s){return t.map(function(h){return h[s]})})[n]}var o=l;return D(l)=="object"&&(o=l[a],a=="f"&&o!=null?o=m.functionHTMLGenerate(o):a=="f"?o=l.v:l&&l.ct&&l.ct.t=="d"&&(o=l.m)),o==null&&(o=null),o}function cl(e,n,t,a){if(n<=0&&t<=0)return e;n<=0&&(n=0),t<=0&&(t=0);var l=0;e.length==0?(e=[],l=0):l=e[0].length;for(var o=[],d=0;d<t;d++)o.push(null);for(var s=[],h=0;h<l+t;h++)s.push(null);for(var f=0;f<e.length;f++)e[f]=[].concat(e[f].concat(o));for(var p=0;p<n;p++)e.push([].concat(s));return a&&(nt.saveParam("all",u.currentSheetIndex,e.length,{k:"row"}),nt.saveParam("all",u.currentSheetIndex,e[0].length,{k:"column"})),e}function pi(e,n,t,a){var l;return(l=a!=null?a[e][n]:function(o,d,s){if(!(o==null||d==null)){var h;if(s==null)h=u.flowdata;else{var f=ir.getSheetByIndex(s);h=f.data}if(!(!h||!h[o]||!h[o][d]))return h[o][d]}}(e,n,t))==null?null:l.f}function bp(e,n){var t=Hr(e,n,null,"m");if(t==null&&(t=Hr(e,n))==null){var a=Hr(e,n,null,"ct");Ih(a)&&(t=a.s)}return t}function od(e,n,t){var a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];if(e!=null){var l="",o=st(),d=o.fontarray;for(var s in e){var h=e[s];if(a&&(h=Qi(e,s)),s=="bl"&&h!="0"&&(l+="font-weight: bold;"),s=="it"&&h!="0"&&(l+="font-style:italic;"),s=="ff"&&(l+="font-family: "+(isNaN(parseInt(h))?h:d[parseInt(h)])+";"),s=="fs"&&h!="10"&&(l+="font-size: "+h+"pt;"),(s=="fc"&&h!="#000000"||n!=null||t!=null&&t.textColor!=null)&&(t!=null&&t.textColor!=null?l+="color: "+t.textColor+";":l+=n!=null?"color: "+n[0]+";":"color: "+h+";"),s=="cl"&&h!="0"&&(l+="text-decoration: line-through;"),s=="un"&&(h=="1"||h=="3")){var f=e._color;f==null&&(f=e.fc);var p=e._fontSize;p==null&&(p=e.fs),l+="border-bottom: "+Math.floor(p/9)+"px solid "+f+";"}}return l}}function Qi(e,n){var t=e;return n in{bl:1,it:1,ff:1,cl:1,un:1}||n=="fs"&&qi(e)?(t==null||(t=t[n])==null)&&(t="0"):n=="fc"?t==null?t="#000000":((t=t[n])==null&&(t="#000000"),t.indexOf("rgba")>-1&&(t=Tu(t))):n=="bg"?t==null||(t=t[n])==null?t=null:t.toString().indexOf("rgba")>-1&&(t=Tu(t)):n.substr(0,2)=="bs"?(t==null||(t=t[n])==null)&&(t="none"):n.substr(0,2)=="bc"?(t==null||(t=t[n])==null)&&(t="#000000"):n=="ht"?((t==null||(t=t[n])==null)&&(t="1"),["0","1","2"].indexOf(t.toString())==-1&&(t="1")):n=="vt"?((t==null||(t=t[n])==null)&&(t="0"),["0","1","2"].indexOf(t.toString())==-1&&(t="0")):n=="ct"?(t==null||(t=t[n])==null)&&(t=null):n=="fs"?(t==null||(t=t[n])==null)&&(t="10"):n=="tb"||n=="tr"?(t==null||(t=t[n])==null)&&(t="0"):n=="rt"&&(t==null||(t=t[n])==null)&&(t=null),t}function Fl(e){return e==null||e.length==0?e:e.replace(/^\s+|\s+$/gm,"")}var vr={deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){return this.deepCopyFlowDataState?(this.deepCopyFlowDataWorker!=null&&this.deepCopyFlowDataWorker.terminate(),this.deepCopyFlowDataCache):(e==null&&(e=u.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(e){var n=this;try{n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate();var t;n.deepCopyFlowDataState=!1,Ko.isIE()==1?(t=new Worker("./plugins/Worker-helper.js")).postMessage("self.onmessage=function(e){postMessage(e.data);}"):t=new Worker("data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };"),n.deepCopyFlowDataWorker=t,t.postMessage(e),t.onmessage=function(a){n.deepCopyFlowDataCache=a.data,n.deepCopyFlowDataState=!0}}catch{n.deepCopyFlowDataCache=$.extend(!0,[],e)}},controlHandler:function(e,n){var t=this.deepCopyFlowData(u.flowdata),a=n||u.luckysheet_select_save[u.luckysheet_select_save.length-1],l=a.row==null?0:a.row[0],o=a.column==null?0:a.column[0],d=e.length,s=e[0].length,h=l+d-t.length,f=o+s-t[0].length;(h>0||f>0)&&(t=cl([].concat(t),h,f,!0));for(var p=0;p<d;p++){for(var g=[].concat(t[p+l]),v=0;v<s;v++){var y="";e[p]!=null&&e[p][v]!=null&&(y=e[p][v]),g[v+o]=y}t[p+l]=g}h>0||f>0?Ni(t[0].length,t.length,t,null,u.luckysheet_select_save,"datachangeAll"):md(t,u.luckysheet_select_save)},clearRangeByindex:function(e,n,t,a,l){for(var o=je(l),d=$.extend(!0,[],u.luckysheetfile[o].data),s=e;s<=n;s++){for(var h=[].concat(d[s]),f=t;f<=a;f++)m.delFunctionGroup(s,f),m.execFunctionGroup(s,f,""),h[f]=null;d[s]=h}l==u.currentSheetIndex?n-e+1>5e3?wa(d,[{row:[e,n],column:[t,a]}]):md(d,{row:[e,n],column:[t,a]}):u.luckysheetfile[o].data=d},controlHandlerD:function(e){var n=this.deepCopyFlowData(u.flowdata),t=u.luckysheet_select_save[u.luckysheet_select_save.length-1],a=t.row[0],l=t.row[1],o=t.column[0],d=t.column[1],s=e.length,h=e[0].length,f=a+s-n.length,p=o+h-n[0].length;(f>0||p>0)&&(n=cl([].concat(n),f,p,!0));for(var g=a;g<=l;g++)for(var v=o;v<=d;v++)n[g][v]=null;for(var y=0;y<s;y++)for(var b=0;b<h;b++)n[a+y][o+b]=e[y][b];wa(n,[{row:[a,l],column:[o,d]},{row:[a,a+s-1],column:[o,o+h-1]}])}},J1=Math.min,Dh=[].lastIndexOf,kp=!!Dh&&1/[1].lastIndexOf(1,-0)<0,Q1=it("lastIndexOf"),eb=Er("indexOf",{ACCESSORS:!0,1:0}),Fh=kp||!Q1||!eb?function(e){if(kp)return Dh.apply(this,arguments)||0;var n=ie(this),t=Zt(n.length),a=t-1;for(arguments.length>1&&(a=J1(a,ut(arguments[1]))),a<0&&(a=t+a);a>=0;a--)if(a in n&&n[a]===e)return a||0;return-1}:Dh;Ce({target:"Array",proto:!0,forced:Fh!==[].lastIndexOf},{lastIndexOf:Fh});var Q=Fe(function(e,n){e.exports=function(){var t="millisecond",a="second",l="minute",o="hour",d="day",s="week",h="month",f="quarter",p="year",g="date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,y=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},k=function(N,z,P){var q=String(N);return!q||q.length>=z?N:""+Array(z+1-q.length).join(P)+N},w={s:k,z:function(N){var z=-N.utcOffset(),P=Math.abs(z),q=Math.floor(P/60),V=P%60;return(z<=0?"+":"-")+k(q,2,"0")+":"+k(V,2,"0")},m:function N(z,P){if(z.date()<P.date())return-N(P,z);var q=12*(P.year()-z.year())+(P.month()-z.month()),V=z.clone().add(q,h),x=P-V<0,ee=z.clone().add(q+(x?-1:1),h);return+(-(q+(P-V)/(x?V-ee:ee-V))||0)},a:function(N){return N<0?Math.ceil(N)||0:Math.floor(N)},p:function(N){return{M:h,y:p,w:s,d,D:g,h:o,m:l,s:a,ms:t,Q:f}[N]||String(N||"").toLowerCase().replace(/s$/,"")},u:function(N){return N===void 0}},_="en",C={};C[_]=b;var A=function(N){return N instanceof R},I=function(N,z,P){var q;if(!N)return _;if(typeof N=="string")C[N]&&(q=N),z&&(C[N]=z,q=N);else{var V=N.name;C[V]=N,q=V}return!P&&q&&(_=q),q||!P&&_},S=function(N,z){if(A(N))return N.clone();var P=typeof z=="object"?z:{};return P.date=N,P.args=arguments,new R(P)},E=w;E.l=I,E.i=A,E.w=function(N,z){return S(N,{locale:z.$L,utc:z.$u,x:z.$x,$offset:z.$offset})};var R=function(){function N(P){this.$L=I(P.locale,null,!0),this.parse(P)}var z=N.prototype;return z.parse=function(P){this.$d=function(q){var V=q.date,x=q.utc;if(V===null)return new Date(NaN);if(E.u(V))return new Date;if(V instanceof Date)return new Date(V);if(typeof V=="string"&&!/Z$/i.test(V)){var ee=V.match(v);if(ee){var ne=ee[2]-1||0,ae=(ee[7]||"0").substring(0,3);return x?new Date(Date.UTC(ee[1],ne,ee[3]||1,ee[4]||0,ee[5]||0,ee[6]||0,ae)):new Date(ee[1],ne,ee[3]||1,ee[4]||0,ee[5]||0,ee[6]||0,ae)}}return new Date(V)}(P),this.$x=P.x||{},this.init()},z.init=function(){var P=this.$d;this.$y=P.getFullYear(),this.$M=P.getMonth(),this.$D=P.getDate(),this.$W=P.getDay(),this.$H=P.getHours(),this.$m=P.getMinutes(),this.$s=P.getSeconds(),this.$ms=P.getMilliseconds()},z.$utils=function(){return E},z.isValid=function(){return this.$d.toString()!=="Invalid Date"},z.isSame=function(P,q){var V=S(P);return this.startOf(q)<=V&&V<=this.endOf(q)},z.isAfter=function(P,q){return S(P)<this.startOf(q)},z.isBefore=function(P,q){return this.endOf(q)<S(P)},z.$g=function(P,q,V){return E.u(P)?this[q]:this.set(V,P)},z.unix=function(){return Math.floor(this.valueOf()/1e3)},z.valueOf=function(){return this.$d.getTime()},z.startOf=function(P,q){var V=this,x=!!E.u(q)||q,ee=E.p(P),ne=function(ue,be){var ye=E.w(V.$u?Date.UTC(V.$y,be,ue):new Date(V.$y,be,ue),V);return x?ye:ye.endOf(d)},ae=function(ue,be){return E.w(V.toDate()[ue].apply(V.toDate("s"),(x?[0,0,0,0]:[23,59,59,999]).slice(be)),V)},de=this.$W,ve=this.$M,U=this.$D,B="set"+(this.$u?"UTC":"");switch(ee){case p:return x?ne(1,0):ne(31,11);case h:return x?ne(1,ve):ne(0,ve+1);case s:var le=this.$locale().weekStart||0,Te=(de<le?de+7:de)-le;return ne(x?U-Te:U+(6-Te),ve);case d:case g:return ae(B+"Hours",0);case o:return ae(B+"Minutes",1);case l:return ae(B+"Seconds",2);case a:return ae(B+"Milliseconds",3);default:return this.clone()}},z.endOf=function(P){return this.startOf(P,!1)},z.$set=function(P,q){var V,x=E.p(P),ee="set"+(this.$u?"UTC":""),ne=(V={},V[d]=ee+"Date",V[g]=ee+"Date",V[h]=ee+"Month",V[p]=ee+"FullYear",V[o]=ee+"Hours",V[l]=ee+"Minutes",V[a]=ee+"Seconds",V[t]=ee+"Milliseconds",V)[x],ae=x===d?this.$D+(q-this.$W):q;if(x===h||x===p){var de=this.clone().set(g,1);de.$d[ne](ae),de.init(),this.$d=de.set(g,Math.min(this.$D,de.daysInMonth())).$d}else ne&&this.$d[ne](ae);return this.init(),this},z.set=function(P,q){return this.clone().$set(P,q)},z.get=function(P){return this[E.p(P)]()},z.add=function(P,q){var V,x=this;P=Number(P);var ee=E.p(q),ne=function(ve){var U=S(x);return E.w(U.date(U.date()+Math.round(ve*P)),x)};if(ee===h)return this.set(h,this.$M+P);if(ee===p)return this.set(p,this.$y+P);if(ee===d)return ne(1);if(ee===s)return ne(7);var ae=(V={},V[l]=6e4,V[o]=36e5,V[a]=1e3,V)[ee]||1,de=this.$d.getTime()+P*ae;return E.w(de,this)},z.subtract=function(P,q){return this.add(-1*P,q)},z.format=function(P){var q=this;if(!this.isValid())return"Invalid Date";var V=P||"YYYY-MM-DDTHH:mm:ssZ",x=E.z(this),ee=this.$locale(),ne=this.$H,ae=this.$m,de=this.$M,ve=ee.weekdays,U=ee.months,B=function(be,ye,ce,Re){return be&&(be[ye]||be(q,V))||ce[ye].substr(0,Re)},le=function(be){return E.s(ne%12||12,be,"0")},Te=ee.meridiem||function(be,ye,ce){var Re=be<12?"AM":"PM";return ce?Re.toLowerCase():Re},ue={YY:String(this.$y).slice(-2),YYYY:this.$y,M:de+1,MM:E.s(de+1,2,"0"),MMM:B(ee.monthsShort,de,U,3),MMMM:B(U,de),D:this.$D,DD:E.s(this.$D,2,"0"),d:String(this.$W),dd:B(ee.weekdaysMin,this.$W,ve,2),ddd:B(ee.weekdaysShort,this.$W,ve,3),dddd:ve[this.$W],H:String(ne),HH:E.s(ne,2,"0"),h:le(1),hh:le(2),a:Te(ne,ae,!0),A:Te(ne,ae,!1),m:String(ae),mm:E.s(ae,2,"0"),s:String(this.$s),ss:E.s(this.$s,2,"0"),SSS:E.s(this.$ms,3,"0"),Z:x};return V.replace(y,function(be,ye){return ye||ue[be]||x.replace(":","")})},z.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},z.diff=function(P,q,V){var x,ee=E.p(q),ne=S(P),ae=6e4*(ne.utcOffset()-this.utcOffset()),de=this-ne,ve=E.m(this,ne);return ve=(x={},x[p]=ve/12,x[h]=ve,x[f]=ve/3,x[s]=(de-ae)/6048e5,x[d]=(de-ae)/864e5,x[o]=de/36e5,x[l]=de/6e4,x[a]=de/1e3,x)[ee]||de,V?ve:E.a(ve)},z.daysInMonth=function(){return this.endOf(h).$D},z.$locale=function(){return C[this.$L]},z.locale=function(P,q){if(!P)return this.$L;var V=this.clone(),x=I(P,q,!0);return x&&(V.$L=x),V},z.clone=function(){return E.w(this.$d,this)},z.toDate=function(){return new Date(this.valueOf())},z.toJSON=function(){return this.isValid()?this.toISOString():null},z.toISOString=function(){return this.$d.toISOString()},z.toString=function(){return this.$d.toUTCString()},N}(),F=R.prototype;return S.prototype=F,[["$ms",t],["$s",a],["$m",l],["$H",o],["$W",d],["$M",h],["$y",p],["$D",g]].forEach(function(N){F[N[1]]=function(z){return this.$g(z,N[0],N[1])}}),S.extend=function(N,z){return N(z,R,S),S},S.locale=I,S.isDayjs=A,S.unix=function(N){return S(1e3*N)},S.en=C[_],S.Ls=C,S.p={},S}()});function un(e){return!(e==null||e.toString().length<5)&&!!function(n){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(n)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(n))return!1;var t=RegExp.$1,a=RegExp.$2,l=RegExp.$3;return!(t<1900||a>12||l>31||a==2&&(new Date(t,1,29).getDate()==29&&l>29||new Date(t,1,29).getDate()!=29&&l>28))}(e)}function il(e,n){return Q(e).diff(Q(n))}function vc(e){var n={};return un(e)&&(n.date=!0),isNaN(parseFloat(e))||Ku(e)||(n.num=!0),n}function ko(e){var n="string";return un(e)?n="date":isNaN(parseFloat(e))||Ku(e)||(n="num"),n}var cn=Fe(function(e){/*! @preserve
	 * numeral.js
	 * version : 2.0.6
	 * author : Adam Draper
	 * license : MIT
	 * http://adamwdraper.github.com/Numeral-js/
	 */(function(n,t){e.exports?e.exports=t():n.numeral=t()})(zn,function(){var n,t,a,l,o,d={},s={},h={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},f={currentLocale:h.currentLocale,zeroFormat:h.zeroFormat,nullFormat:h.nullFormat,defaultFormat:h.defaultFormat,scalePercentBy100:h.scalePercentBy100};function p(g,v){this._input=g,this._value=v}return(n=function(g){var v,y,b,k;if(n.isNumeral(g))v=g.value();else if(g===0||g===void 0)v=0;else if(g===null||t.isNaN(g))v=null;else if(typeof g=="string")if(f.zeroFormat&&g===f.zeroFormat)v=0;else if(f.nullFormat&&g===f.nullFormat||!g.replace(/[^0-9]+/g,"").length)v=null;else{for(y in d)if((k=typeof d[y].regexps.unformat=="function"?d[y].regexps.unformat():d[y].regexps.unformat)&&g.match(k)){b=d[y].unformat;break}v=(b=b||n._.stringToNumber)(g)}else v=Number(g)||null;return new p(g,v)}).version="2.0.6",n.isNumeral=function(g){return g instanceof p},n._=t={numberToFormat:function(g,v,y){var b,k,w,_,C,A,I,S,E=s[n.options.currentLocale],R=!1,F=!1,N="",z="",P=!1;if(g=g||0,w=Math.abs(g),n._.includes(v,"(")?(R=!0,v=v.replace(/[\(|\)]/g,"")):(n._.includes(v,"+")||n._.includes(v,"-"))&&(A=n._.includes(v,"+")?v.indexOf("+"):g<0?v.indexOf("-"):-1,v=v.replace(/[\+|\-]/g,"")),n._.includes(v,"a")&&(k=!!(k=v.match(/a(k|m|b|t)?/))&&k[1],n._.includes(v," a")&&(N=" "),v=v.replace(new RegExp(N+"a[kmbt]?"),""),w>=1e12&&!k||k==="t"?(N+=E.abbreviations.trillion,g/=1e12):w<1e12&&w>=1e9&&!k||k==="b"?(N+=E.abbreviations.billion,g/=1e9):w<1e9&&w>=1e6&&!k||k==="m"?(N+=E.abbreviations.million,g/=1e6):(w<1e6&&w>=1e3&&!k||k==="k")&&(N+=E.abbreviations.thousand,g/=1e3)),n._.includes(v,"[.]")&&(F=!0,v=v.replace("[.]",".")),_=g.toString().split(".")[0],C=v.split(".")[1],I=v.indexOf(","),b=(v.split(".")[0].split(",")[0].match(/0/g)||[]).length,C?(n._.includes(C,"[")?(C=(C=C.replace("]","")).split("["),z=n._.toFixed(g,C[0].length+C[1].length,y,C[1].length)):z=n._.toFixed(g,C.length,y),_=z.split(".")[0],z=n._.includes(z,".")?E.delimiters.decimal+z.split(".")[1]:"",F&&Number(z.slice(1))===0&&(z="")):_=n._.toFixed(g,0,y),N&&!k&&Number(_)>=1e3&&N!==E.abbreviations.trillion)switch(_=String(Number(_)/1e3),N){case E.abbreviations.thousand:N=E.abbreviations.million;break;case E.abbreviations.million:N=E.abbreviations.billion;break;case E.abbreviations.billion:N=E.abbreviations.trillion}if(n._.includes(_,"-")&&(_=_.slice(1),P=!0),_.length<b)for(var q=b-_.length;q>0;q--)_="0"+_;return I>-1&&(_=_.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+E.delimiters.thousands)),v.indexOf(".")===0&&(_=""),S=_+z+(N||""),R?S=(R&&P?"(":"")+S+(R&&P?")":""):A>=0?S=A===0?(P?"-":"+")+S:S+(P?"-":"+"):P&&(S="-"+S),S},stringToNumber:function(g){var v,y,b,k=s[f.currentLocale],w=g,_={thousand:3,million:6,billion:9,trillion:12};if(f.zeroFormat&&g===f.zeroFormat)y=0;else if(f.nullFormat&&g===f.nullFormat||!g.replace(/[^0-9]+/g,"").length)y=null;else{for(v in y=1,k.delimiters.decimal!=="."&&(g=g.replace(/\./g,"").replace(k.delimiters.decimal,".")),_)if(b=new RegExp("[^a-zA-Z]"+k.abbreviations[v]+"(?:\\)|(\\"+k.currency.symbol+")?(?:\\))?)?$"),w.match(b)){y*=Math.pow(10,_[v]);break}y*=(g.split("-").length+Math.min(g.split("(").length-1,g.split(")").length-1))%2?1:-1,g=g.replace(/[^0-9\.]+/g,""),y*=Number(g)}return y},isNaN:function(g){return typeof g=="number"&&isNaN(g)},includes:function(g,v){return g.indexOf(v)!==-1},insert:function(g,v,y){return g.slice(0,y)+v+g.slice(y)},reduce:function(g,v){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof v!="function")throw new TypeError(v+" is not a function");var y,b=Object(g),k=b.length>>>0,w=0;if(arguments.length===3)y=arguments[2];else{for(;w<k&&!(w in b);)w++;if(w>=k)throw new TypeError("Reduce of empty array with no initial value");y=b[w++]}for(;w<k;w++)w in b&&(y=v(y,b[w],w,b));return y},multiplier:function(g){var v=g.toString().split(".");return v.length<2?1:Math.pow(10,v[1].length)},correctionFactor:function(){var g=Array.prototype.slice.call(arguments);return g.reduce(function(v,y){var b=t.multiplier(y);return v>b?v:b},1)},toFixed:function(g,v,y,b){var k,w,_,C,A=g.toString().split("."),I=v-(b||0);return k=A.length===2?Math.min(Math.max(A[1].length,I),v):I,_=Math.pow(10,k),C=(y(g+"e+"+k)/_).toFixed(k),b>v-k&&(w=new RegExp("\\.?0{1,"+(b-(v-k))+"}$"),C=C.replace(w,"")),C}},n.options=f,n.formats=d,n.locales=s,n.locale=function(g){return g&&(f.currentLocale=g.toLowerCase()),f.currentLocale},n.localeData=function(g){if(!g)return s[f.currentLocale];if(g=g.toLowerCase(),!s[g])throw new Error("Unknown locale : "+g);return s[g]},n.reset=function(){for(var g in h)f[g]=h[g]},n.zeroFormat=function(g){f.zeroFormat=typeof g=="string"?g:null},n.nullFormat=function(g){f.nullFormat=typeof g=="string"?g:null},n.defaultFormat=function(g){f.defaultFormat=typeof g=="string"?g:"0.0"},n.register=function(g,v,y){if(v=v.toLowerCase(),this[g+"s"][v])throw new TypeError(v+" "+g+" already registered.");return this[g+"s"][v]=y,y},n.validate=function(g,v){var y,b,k,w,_,C,A,I;if(typeof g!="string"&&(g+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",g)),(g=g.trim()).match(/^\d+$/))return!0;if(g==="")return!1;try{A=n.localeData(v)}catch{A=n.localeData(n.locale())}return k=A.currency.symbol,_=A.abbreviations,y=A.delimiters.decimal,b=A.delimiters.thousands==="."?"\\.":A.delimiters.thousands,((I=g.match(/^[^\d]+/))===null||(g=g.substr(1),I[0]===k))&&((I=g.match(/[^\d]+$/))===null||(g=g.slice(0,-1),I[0]===_.thousand||I[0]===_.million||I[0]===_.billion||I[0]===_.trillion))&&(C=new RegExp(b+"{2}"),!g.match(/[^\d.,]/g)&&!((w=g.split(y)).length>2)&&(w.length<2?!!w[0].match(/^\d+.*\d$/)&&!w[0].match(C):w[0].length===1?!!w[0].match(/^\d+$/)&&!w[0].match(C)&&!!w[1].match(/^\d+$/):!!w[0].match(/^\d+.*\d$/)&&!w[0].match(C)&&!!w[1].match(/^\d+$/)))},n.fn=p.prototype={clone:function(){return n(this)},format:function(g,v){var y,b,k,w=this._value,_=g||f.defaultFormat;if(v=v||Math.round,w===0&&f.zeroFormat!==null)b=f.zeroFormat;else if(w===null&&f.nullFormat!==null)b=f.nullFormat;else{for(y in d)if(_.match(d[y].regexps.format)){k=d[y].format;break}b=(k=k||n._.numberToFormat)(w,_,v)}return b},value:function(){return this._value},input:function(){return this._input},set:function(g){return this._value=Number(g),this},add:function(g){var v=t.correctionFactor.call(null,this._value,g);return this._value=t.reduce([this._value,g],function(y,b,k,w){return y+Math.round(v*b)},0)/v,this},subtract:function(g){var v=t.correctionFactor.call(null,this._value,g);return this._value=t.reduce([g],function(y,b,k,w){return y-Math.round(v*b)},Math.round(this._value*v))/v,this},multiply:function(g){return this._value=t.reduce([this._value,g],function(v,y,b,k){var w=t.correctionFactor(v,y);return Math.round(v*w)*Math.round(y*w)/Math.round(w*w)},1),this},divide:function(g){return this._value=t.reduce([this._value,g],function(v,y,b,k){var w=t.correctionFactor(v,y);return Math.round(v*w)/Math.round(y*w)}),this},difference:function(g){return Math.abs(n(this._value).subtract(g).value())}},n.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(g){var v=g%10;return~~(g%100/10)==1?"th":v===1?"st":v===2?"nd":v===3?"rd":"th"},currency:{symbol:"$"}}),n.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(g,v,y){var b,k=n._.includes(v," BPS")?" ":"";return g*=1e4,v=v.replace(/\s?BPS/,""),b=n._.numberToFormat(g,v,y),n._.includes(b,")")?((b=b.split("")).splice(-1,0,k+"BPS"),b=b.join("")):b=b+k+"BPS",b},unformat:function(g){return+(1e-4*n._.stringToNumber(g)).toFixed(15)}}),l={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},o="("+(o=(a={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(l.suffixes.filter(function(g){return a.suffixes.indexOf(g)<0})).join("|")).replace("B","B(?!PS)")+")",n.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(o)},format:function(g,v,y){var b,k,w,_=n._.includes(v,"ib")?l:a,C=n._.includes(v," b")||n._.includes(v," ib")?" ":"";for(v=v.replace(/\s?i?b/,""),b=0;b<=_.suffixes.length;b++)if(k=Math.pow(_.base,b),w=Math.pow(_.base,b+1),g===null||g===0||g>=k&&g<w){C+=_.suffixes[b],k>0&&(g/=k);break}return n._.numberToFormat(g,v,y)+C},unformat:function(g){var v,y,b=n._.stringToNumber(g);if(b){for(v=a.suffixes.length-1;v>=0;v--){if(n._.includes(g,a.suffixes[v])){y=Math.pow(a.base,v);break}if(n._.includes(g,l.suffixes[v])){y=Math.pow(l.base,v);break}}b*=y||1}return b}}),n.register("format","currency",{regexps:{format:/(\$)/},format:function(g,v,y){var b,k,w=n.locales[n.options.currentLocale],_={before:v.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:v.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(v=v.replace(/\s?\$\s?/,""),b=n._.numberToFormat(g,v,y),g>=0?(_.before=_.before.replace(/[\-\(]/,""),_.after=_.after.replace(/[\-\)]/,"")):g<0&&!n._.includes(_.before,"-")&&!n._.includes(_.before,"(")&&(_.before="-"+_.before),k=0;k<_.before.length;k++)switch(_.before[k]){case"$":b=n._.insert(b,w.currency.symbol,k);break;case" ":b=n._.insert(b," ",k+w.currency.symbol.length-1)}for(k=_.after.length-1;k>=0;k--)switch(_.after[k]){case"$":b=k===_.after.length-1?b+w.currency.symbol:n._.insert(b,w.currency.symbol,-(_.after.length-(1+k)));break;case" ":b=k===_.after.length-1?b+" ":n._.insert(b," ",-(_.after.length-(1+k)+w.currency.symbol.length-1))}return b}}),n.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(g,v,y){var b=(typeof g!="number"||n._.isNaN(g)?"0e+0":g.toExponential()).split("e");return v=v.replace(/e[\+|\-]{1}0/,""),n._.numberToFormat(Number(b[0]),v,y)+"e"+b[1]},unformat:function(g){var v=n._.includes(g,"e+")?g.split("e+"):g.split("e-"),y=Number(v[0]),b=Number(v[1]);return b=n._.includes(g,"e-")?b*=-1:b,n._.reduce([y,Math.pow(10,b)],function(k,w,_,C){var A=n._.correctionFactor(k,w);return k*A*(w*A)/(A*A)},1)}}),n.register("format","ordinal",{regexps:{format:/(o)/},format:function(g,v,y){var b=n.locales[n.options.currentLocale],k=n._.includes(v," o")?" ":"";return v=v.replace(/\s?o/,""),k+=b.ordinal(g),n._.numberToFormat(g,v,y)+k}}),n.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(g,v,y){var b,k=n._.includes(v," %")?" ":"";return n.options.scalePercentBy100&&(g*=100),v=v.replace(/\s?\%/,""),b=n._.numberToFormat(g,v,y),n._.includes(b,")")?((b=b.split("")).splice(-1,0,k+"%"),b=b.join("")):b=b+k+"%",b},unformat:function(g){var v=n._.stringToNumber(g);return n.options.scalePercentBy100?.01*v:v}}),n.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(g,v,y){var b=Math.floor(g/60/60),k=Math.floor((g-60*b*60)/60),w=Math.round(g-60*b*60-60*k);return b+":"+(k<10?"0"+k:k)+":"+(w<10?"0"+w:w)},unformat:function(g){var v=g.split(":"),y=0;return v.length===3?(y+=60*Number(v[0])*60,y+=60*Number(v[1]),y+=Number(v[2])):v.length===2&&(y+=60*Number(v[0]),y+=Number(v[1])),Number(y)}}),n})}),tl={};(function(e){function n(U){for(var B="",le=U.length-1;le>=0;)B+=U.charAt(le--);return B}function t(U,B){for(var le="";le.length<B;)le+=U;return le}function a(U,B){var le=""+U;return le.length>=B?le:t("0",B-le.length)+le}function l(U,B){var le=""+U;return le.length>=B?le:t(" ",B-le.length)+le}function o(U,B){var le=""+U;return le.length>=B?le:le+t(" ",B-le.length)}e.version="0.11.2";var d=Math.pow(2,32);function s(U,B){return U>d||U<-d?function(le,Te){var ue=""+Math.round(le);return ue.length>=Te?ue:t("0",Te-ue.length)+ue}(U,B):function(le,Te){var ue=""+le;return ue.length>=Te?ue:t("0",Te-ue.length)+ue}(Math.round(U),B)}function h(U,B){return B=B||0,U.length>=7+B&&(32|U.charCodeAt(B))==103&&(32|U.charCodeAt(B+1))==101&&(32|U.charCodeAt(B+2))==110&&(32|U.charCodeAt(B+3))==101&&(32|U.charCodeAt(B+4))==114&&(32|U.charCodeAt(B+5))==97&&(32|U.charCodeAt(B+6))==108}var f=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function g(U){U[0]="General",U[1]="0",U[2]="0.00",U[3]="#,##0",U[4]="#,##0.00",U[9]="0%",U[10]="0.00%",U[11]="0.00E+00",U[12]="# ?/?",U[13]="# ??/??",U[14]="m/d/yy",U[15]="d-mmm-yy",U[16]="d-mmm",U[17]="mmm-yy",U[18]="h:mm AM/PM",U[19]="h:mm:ss AM/PM",U[20]="h:mm",U[21]="h:mm:ss",U[22]="m/d/yy h:mm",U[37]="#,##0 ;(#,##0)",U[38]="#,##0 ;[Red](#,##0)",U[39]="#,##0.00;(#,##0.00)",U[40]="#,##0.00;[Red](#,##0.00)",U[45]="mm:ss",U[46]="[h]:mm:ss",U[47]="mmss.0",U[48]="##0.0E+0",U[49]="@",U[56]='"/ "hh""mm""ss" "',U[65535]="General"}var v={};g(v);var y=[],b=0;for(b=5;b<=8;++b)y[b]=32+b;for(b=23;b<=26;++b)y[b]=0;for(b=27;b<=31;++b)y[b]=14;for(b=50;b<=58;++b)y[b]=14;for(b=59;b<=62;++b)y[b]=b-58;for(b=67;b<=68;++b)y[b]=b-58;for(b=72;b<=75;++b)y[b]=b-58;for(b=67;b<=68;++b)y[b]=b-57;for(b=76;b<=78;++b)y[b]=b-56;for(b=79;b<=81;++b)y[b]=b-34;var k=[];function w(U,B,le){for(var Te=U<0?-1:1,ue=U*Te,be=0,ye=1,ce=0,Re=1,pe=0,me=0,re=Math.floor(ue);pe<B&&(ce=(re=Math.floor(ue))*ye+be,me=re*pe+Re,!(ue-re<5e-8));)ue=1/(ue-re),be=ye,ye=ce,Re=pe,pe=me;if(me>B&&(pe>B?(me=Re,ce=be):(me=pe,ce=ye)),!le)return[0,Te*ce,me];var _e=Math.floor(Te*ce/me);return[_e,Te*ce-_e*me,me]}function _(U,B,le){if(U>2958465||U<0)return null;var Te=0|U,ue=Math.floor(86400*(U-Te)),be=0,ye=[],ce={D:Te,T:ue,u:86400*(U-Te)-ue,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(ce.u)<1e-6&&(ce.u=0),B&&B.date1904&&(Te+=1462),ce.u>.9999&&(ce.u=0,++ue==86400&&(ce.T=ue=0,++Te,++ce.D)),Te===60)ye=le?[1317,10,29]:[1900,2,29],be=3;else if(Te===0)ye=le?[1317,8,29]:[1900,1,0],be=6;else{Te>60&&--Te;var Re=new Date(1900,0,1);Re.setDate(Re.getDate()+Te-1),ye=[Re.getFullYear(),Re.getMonth()+1,Re.getDate()],be=Re.getDay(),Te<60&&(be=(be+6)%7),le&&(be=function(pe,me){me[0]-=581;var re=pe.getDay();return pe<60&&(re=(re+6)%7),re}(Re,ye))}return ce.y=ye[0],ce.m=ye[1],ce.d=ye[2],ce.S=ue%60,ue=Math.floor(ue/60),ce.M=ue%60,ue=Math.floor(ue/60),ce.H=ue,ce.q=be,ce}k[5]=k[63]='"$"#,##0_);\\("$"#,##0\\)',k[6]=k[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',k[7]=k[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',k[8]=k[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',k[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',k[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',k[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',k[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)',e.parse_date_code=_;var C=new Date(1899,11,31,0,0,0),A=C.getTime(),I=new Date(1900,2,1,0,0,0);function S(U,B){var le=U.getTime();return B?le-=1262304e5:U>=I&&(le+=864e5),(le-(A+6e4*(U.getTimezoneOffset()-C.getTimezoneOffset())))/864e5}e._general_int=function(U){return U.toString(10)};var E=function(){var U=/(?:\.0*|(\.\d*[1-9])0+)$/;function B(ue){return ue.indexOf(".")==-1?ue:ue.replace(U,"$1")}var le=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,Te=/(E[+-])(\d)$/;return function(ue){var be,ye=Math.floor(Math.log(Math.abs(ue))*Math.LOG10E);return be=ye>=-4&&ye<=-1?ue.toPrecision(10+ye):Math.abs(ye)<=9?function(ce){var Re=ce<0?12:11,pe=B(ce.toFixed(12));return pe.length<=Re||(pe=ce.toPrecision(10)).length<=Re?pe:ce.toExponential(5)}(ue):ye===10?ue.toFixed(10).substr(0,12):function(ce){var Re=B(ce.toFixed(11));return Re.length>(ce<0?12:11)||Re==="0"||Re==="-0"?ce.toPrecision(6):Re}(ue),B(function(ce){return ce.indexOf("E")==-1?ce:ce.replace(le,"$1E").replace(Te,"$10$2")}(be.toUpperCase()))}}();function R(U,B){switch(ul(U)){case"string":return U;case"boolean":return U?"TRUE":"FALSE";case"number":return(0|U)===U?U.toString(10):E(U);case"undefined":return"";case"object":if(U==null)return"";if(U instanceof Date)return de(14,S(U,B&&B.date1904),B)}throw new Error("unsupported value in General format: "+U)}function F(U,B,le,Te){var ue,be="",ye=0,ce=0,Re=le.y,pe=0;switch(U){case 98:Re=le.y+543;case 121:switch(B.length){case 1:case 2:ue=Re%100,pe=2;break;default:ue=Re%1e4,pe=4}break;case 109:switch(B.length){case 1:case 2:ue=le.m,pe=B.length;break;case 3:return p[le.m-1][1];case 5:return p[le.m-1][0];default:return p[le.m-1][2]}break;case 100:switch(B.length){case 1:case 2:ue=le.d,pe=B.length;break;case 3:return f[le.q][0];default:return f[le.q][1]}break;case 104:switch(B.length){case 1:case 2:ue=1+(le.H+11)%12,pe=B.length;break;default:throw"bad hour format: "+B}break;case 72:switch(B.length){case 1:case 2:ue=le.H,pe=B.length;break;default:throw"bad hour format: "+B}break;case 77:switch(B.length){case 1:case 2:ue=le.M,pe=B.length;break;default:throw"bad minute format: "+B}break;case 115:if(B!="s"&&B!="ss"&&B!=".0"&&B!=".00"&&B!=".000")throw"bad second format: "+B;return le.u!==0||B!="s"&&B!="ss"?(ce=Te>=2?Te===3?1e3:100:Te===1?10:1,(ye=Math.round(ce*(le.S+le.u)))>=60*ce&&(ye=0),B==="s"?ye===0?"0":""+ye/ce:(be=a(ye,2+Te),B==="ss"?be.substr(0,2):"."+be.substr(2,B.length-1))):a(le.S,B.length);case 90:switch(B){case"[h]":case"[hh]":ue=24*le.D+le.H;break;case"[m]":case"[mm]":ue=60*(24*le.D+le.H)+le.M;break;case"[s]":case"[ss]":ue=60*(60*(24*le.D+le.H)+le.M)+Math.round(le.S+le.u);break;default:throw"bad abstime format: "+B}pe=B.length===3?1:2;break;case 101:ue=Re,pe=1}return pe>0?a(ue,pe):""}function N(U){if(U.length<=3)return U;for(var B=U.length%3,le=U.substr(0,B);B!=U.length;B+=3)le+=(le.length>0?",":"")+U.substr(B,3);return le}e._general_num=E,e._general=R;var z=function(){var U=/%/g,B=/# (\?+)( ?)\/( ?)(\d+)/,le=/^#*0*\.([0#]+)/,Te=/\).*[0#]/,ue=/\(###\) ###\\?-####/;function be(me){for(var re,_e="",Ze=0;Ze!=me.length;++Ze)switch(re=me.charCodeAt(Ze)){case 35:break;case 63:_e+=" ";break;case 48:_e+="0";break;default:_e+=String.fromCharCode(re)}return _e}function ye(me,re){var _e=Math.pow(10,re);return""+Math.round(me*_e)/_e}function ce(me,re){var _e=me-Math.floor(me),Ze=Math.pow(10,re);return re<(""+Math.round(_e*Ze)).length?0:Math.round(_e*Ze)}function Re(me,re,_e){if(me.charCodeAt(0)===40&&!re.match(Te)){var Ze=re.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _e>=0?Re("n",Ze,_e):"("+Re("n",Ze,-_e)+")"}if(re.charCodeAt(re.length-1)===44)return function(De,He,Dt){for(var et=He.length-1;He.charCodeAt(et-1)===44;)--et;return z(De,He.substr(0,et),Dt/Math.pow(10,3*(He.length-et)))}(me,re,_e);if(re.indexOf("%")!==-1)return function(De,He,Dt){var et=He.replace(U,""),ur=He.length-et.length;return z(De,et,Dt*Math.pow(10,2*ur))+t("%",ur)}(me,re,_e);if(re.indexOf("E")!==-1)return function De(He,Dt){var et,ur=He.indexOf("E")-He.indexOf(".")-1;if(He.match(/^#+0.0E\+0$/)){if(Dt==0)return"0.0E+0";if(Dt<0)return"-"+De(He,-Dt);var Xt=He.indexOf(".");Xt===-1&&(Xt=He.indexOf("E"));var jt=Math.floor(Math.log(Dt)*Math.LOG10E)%Xt;if(jt<0&&(jt+=Xt),(et=(Dt/Math.pow(10,jt)).toPrecision(ur+1+(Xt+jt)%Xt)).indexOf("e")===-1){var lr=Math.floor(Math.log(Dt)*Math.LOG10E);for(et.indexOf(".")===-1?et=et.charAt(0)+"."+et.substr(1)+"E+"+(lr-et.length+jt):et+="E+"+(lr-jt);et.substr(0,2)==="0.";)et=(et=et.charAt(0)+et.substr(2,Xt)+"."+et.substr(2+Xt)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");et=et.replace(/\+-/,"-")}et=et.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(tr,xr,rr,nr){return xr+rr+nr.substr(0,(Xt+jt)%Xt)+"."+nr.substr(jt)+"E"})}else et=Dt.toExponential(ur);return He.match(/E\+00$/)&&et.match(/e[+-]\d$/)&&(et=et.substr(0,et.length-1)+"0"+et.charAt(et.length-1)),He.match(/E\-/)&&et.match(/e\+/)&&(et=et.replace(/e\+/,"e")),et.replace("e","E")}(re,_e);if(re.charCodeAt(0)===36)return"$"+Re(me,re.substr(re.charAt(1)==" "?2:1),_e);var We,Xe,Ue,mt,St=Math.abs(_e),at=_e<0?"-":"";if(re.match(/^00+$/))return at+s(St,re.length);if(re.match(/^[#?]+$/))return(We=s(_e,0))==="0"&&(We=""),We.length>re.length?We:be(re.substr(0,re.length-We.length))+We;if(Xe=re.match(B))return function(De,He,Dt){var et=parseInt(De[4],10),ur=Math.round(He*et),Xt=Math.floor(ur/et),jt=ur-Xt*et,lr=et;return Dt+(Xt===0?"":""+Xt)+" "+(jt===0?t(" ",De[1].length+1+De[4].length):l(jt,De[1].length)+De[2]+"/"+De[3]+a(lr,De[4].length))}(Xe,St,at);if(re.match(/^#+0+$/))return at+s(St,re.length-re.indexOf("0"));if(Xe=re.match(le))return We=ye(_e,Xe[1].length).replace(/^([^\.]+)$/,"$1."+be(Xe[1])).replace(/\.$/,"."+be(Xe[1])).replace(/\.(\d*)$/,function(De,He){return"."+He+t("0",be(Xe[1]).length-He.length)}),re.indexOf("0.")!==-1?We:We.replace(/^0\./,".");if(re=re.replace(/^#+([0.])/,"$1"),Xe=re.match(/^(0*)\.(#*)$/))return at+ye(St,Xe[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Xe[1].length?"0.":".");if(Xe=re.match(/^#{1,3},##0(\.?)$/))return at+N(s(St,0));if(Xe=re.match(/^#,##0\.([#0]*0)$/))return _e<0?"-"+Re(me,re,-_e):N(""+(Math.floor(_e)+function(De,He){return He<(""+Math.round((De-Math.floor(De))*Math.pow(10,He))).length?1:0}(_e,Xe[1].length)))+"."+a(ce(_e,Xe[1].length),Xe[1].length);if(Xe=re.match(/^#,#*,#0/))return Re(me,re.replace(/^#,#*,/,""),_e);if(Xe=re.match(/^([0#]+)(\\?-([0#]+))+$/))return We=n(Re(me,re.replace(/[\\-]/g,""),_e)),Ue=0,n(n(re.replace(/\\/g,"")).replace(/[0#]/g,function(De){return Ue<We.length?We.charAt(Ue++):De==="0"?"0":""}));if(re.match(ue))return"("+(We=Re(me,"##########",_e)).substr(0,3)+") "+We.substr(3,3)+"-"+We.substr(6);var dt="";if(Xe=re.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return Ue=Math.min(Xe[4].length,7),mt=w(St,Math.pow(10,Ue)-1,!1),We=""+at,(dt=z("n",Xe[1],mt[1])).charAt(dt.length-1)==" "&&(dt=dt.substr(0,dt.length-1)+"0"),We+=dt+Xe[2]+"/"+Xe[3],(dt=o(mt[2],Ue)).length<Xe[4].length&&(dt=be(Xe[4].substr(Xe[4].length-dt.length))+dt),We+=dt;if(Xe=re.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return Ue=Math.min(Math.max(Xe[1].length,Xe[4].length),7),at+((mt=w(St,Math.pow(10,Ue)-1,!0))[0]||(mt[1]?"":"0"))+" "+(mt[1]?l(mt[1],Ue)+Xe[2]+"/"+Xe[3]+o(mt[2],Ue):t(" ",2*Ue+1+Xe[2].length+Xe[3].length));if(Xe=re.match(/^[#0?]+$/))return We=s(_e,0),re.length<=We.length?We:be(re.substr(0,re.length-We.length))+We;if(Xe=re.match(/^([#0?]+)\.([#0]+)$/)){We=""+_e.toFixed(Math.min(Xe[2].length,10)).replace(/([^0])0+$/,"$1"),Ue=We.indexOf(".");var wt=re.indexOf(".")-Ue,ct=re.length-We.length-wt;return be(re.substr(0,wt)+We+re.substr(re.length-ct))}if(Xe=re.match(/^00,000\.([#0]*0)$/))return Ue=ce(_e,Xe[1].length),_e<0?"-"+Re(me,re,-_e):N(function(De){return De<2147483647&&De>-2147483648?""+(De>=0?0|De:De-1|0):""+Math.floor(De)}(_e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(De){return"00,"+(De.length<3?a(0,3-De.length):"")+De})+"."+a(Ue,Xe[1].length);switch(re){case"###,##0.00":return Re(me,"#,##0.00",_e);case"###,###":case"##,###":case"#,###":var bt=N(s(St,0));return bt!=="0"?at+bt:"";case"###,###.00":return Re(me,"###,##0.00",_e).replace(/^0\./,".");case"#,###.00":return Re(me,"#,##0.00",_e).replace(/^0\./,".")}throw new Error("unsupported format |"+re+"|")}function pe(me,re,_e){if(me.charCodeAt(0)===40&&!re.match(Te)){var Ze=re.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _e>=0?pe("n",Ze,_e):"("+pe("n",Ze,-_e)+")"}if(re.charCodeAt(re.length-1)===44)return function(De,He,Dt){for(var et=He.length-1;He.charCodeAt(et-1)===44;)--et;return z(De,He.substr(0,et),Dt/Math.pow(10,3*(He.length-et)))}(me,re,_e);if(re.indexOf("%")!==-1)return function(De,He,Dt){var et=He.replace(U,""),ur=He.length-et.length;return z(De,et,Dt*Math.pow(10,2*ur))+t("%",ur)}(me,re,_e);if(re.indexOf("E")!==-1)return function De(He,Dt){var et,ur=He.indexOf("E")-He.indexOf(".")-1;if(He.match(/^#+0.0E\+0$/)){if(Dt==0)return"0.0E+0";if(Dt<0)return"-"+De(He,-Dt);var Xt=He.indexOf(".");Xt===-1&&(Xt=He.indexOf("E"));var jt=Math.floor(Math.log(Dt)*Math.LOG10E)%Xt;if(jt<0&&(jt+=Xt),!(et=(Dt/Math.pow(10,jt)).toPrecision(ur+1+(Xt+jt)%Xt)).match(/[Ee]/)){var lr=Math.floor(Math.log(Dt)*Math.LOG10E);et.indexOf(".")===-1?et=et.charAt(0)+"."+et.substr(1)+"E+"+(lr-et.length+jt):et+="E+"+(lr-jt),et=et.replace(/\+-/,"-")}et=et.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(tr,xr,rr,nr){return xr+rr+nr.substr(0,(Xt+jt)%Xt)+"."+nr.substr(jt)+"E"})}else et=Dt.toExponential(ur);return He.match(/E\+00$/)&&et.match(/e[+-]\d$/)&&(et=et.substr(0,et.length-1)+"0"+et.charAt(et.length-1)),He.match(/E\-/)&&et.match(/e\+/)&&(et=et.replace(/e\+/,"e")),et.replace("e","E")}(re,_e);if(re.charCodeAt(0)===36)return"$"+pe(me,re.substr(re.charAt(1)==" "?2:1),_e);var We,Xe,Ue,mt,St=Math.abs(_e),at=_e<0?"-":"";if(re.match(/^00+$/))return at+a(St,re.length);if(re.match(/^[#?]+$/))return We=""+_e,_e===0&&(We=""),We.length>re.length?We:be(re.substr(0,re.length-We.length))+We;if(Xe=re.match(B))return function(De,He,Dt){return Dt+(He===0?"":""+He)+t(" ",De[1].length+2+De[4].length)}(Xe,St,at);if(re.match(/^#+0+$/))return at+a(St,re.length-re.indexOf("0"));if(Xe=re.match(le))return We=(We=(""+_e).replace(/^([^\.]+)$/,"$1."+be(Xe[1])).replace(/\.$/,"."+be(Xe[1]))).replace(/\.(\d*)$/,function(De,He){return"."+He+t("0",be(Xe[1]).length-He.length)}),re.indexOf("0.")!==-1?We:We.replace(/^0\./,".");if(re=re.replace(/^#+([0.])/,"$1"),Xe=re.match(/^(0*)\.(#*)$/))return at+(""+St).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Xe[1].length?"0.":".");if(Xe=re.match(/^#{1,3},##0(\.?)$/))return at+N(""+St);if(Xe=re.match(/^#,##0\.([#0]*0)$/))return _e<0?"-"+pe(me,re,-_e):N(""+_e)+"."+t("0",Xe[1].length);if(Xe=re.match(/^#,#*,#0/))return pe(me,re.replace(/^#,#*,/,""),_e);if(Xe=re.match(/^([0#]+)(\\?-([0#]+))+$/))return We=n(pe(me,re.replace(/[\\-]/g,""),_e)),Ue=0,n(n(re.replace(/\\/g,"")).replace(/[0#]/g,function(De){return Ue<We.length?We.charAt(Ue++):De==="0"?"0":""}));if(re.match(ue))return"("+(We=pe(me,"##########",_e)).substr(0,3)+") "+We.substr(3,3)+"-"+We.substr(6);var dt="";if(Xe=re.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return Ue=Math.min(Xe[4].length,7),mt=w(St,Math.pow(10,Ue)-1,!1),We=""+at,(dt=z("n",Xe[1],mt[1])).charAt(dt.length-1)==" "&&(dt=dt.substr(0,dt.length-1)+"0"),We+=dt+Xe[2]+"/"+Xe[3],(dt=o(mt[2],Ue)).length<Xe[4].length&&(dt=be(Xe[4].substr(Xe[4].length-dt.length))+dt),We+=dt;if(Xe=re.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return Ue=Math.min(Math.max(Xe[1].length,Xe[4].length),7),at+((mt=w(St,Math.pow(10,Ue)-1,!0))[0]||(mt[1]?"":"0"))+" "+(mt[1]?l(mt[1],Ue)+Xe[2]+"/"+Xe[3]+o(mt[2],Ue):t(" ",2*Ue+1+Xe[2].length+Xe[3].length));if(Xe=re.match(/^[#0?]+$/))return We=""+_e,re.length<=We.length?We:be(re.substr(0,re.length-We.length))+We;if(Xe=re.match(/^([#0]+)\.([#0]+)$/)){We=""+_e.toFixed(Math.min(Xe[2].length,10)).replace(/([^0])0+$/,"$1"),Ue=We.indexOf(".");var wt=re.indexOf(".")-Ue,ct=re.length-We.length-wt;return be(re.substr(0,wt)+We+re.substr(re.length-ct))}if(Xe=re.match(/^00,000\.([#0]*0)$/))return _e<0?"-"+pe(me,re,-_e):N(""+_e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(De){return"00,"+(De.length<3?a(0,3-De.length):"")+De})+"."+a(0,Xe[1].length);switch(re){case"###,###":case"##,###":case"#,###":var bt=N(""+St);return bt!=="0"?at+bt:"";default:if(re.match(/\.[0#?]*$/))return pe(me,re.slice(0,re.lastIndexOf(".")),_e)+be(re.slice(re.lastIndexOf(".")))}throw new Error("unsupported format |"+re+"|")}return function(me,re,_e){return(0|_e)===_e?pe(me,re,_e):Re(me,re,_e)}}();function P(U){for(var B=[],le=!1,Te=0,ue=0;Te<U.length;++Te)switch(U.charCodeAt(Te)){case 34:le=!le;break;case 95:case 42:case 92:++Te;break;case 59:B[B.length]=U.substr(ue,Te-ue),ue=Te+1}if(B[B.length]=U.substr(ue),le===!0)throw new Error("Format |"+U+"| unterminated string ");return B}e._split=P;var q=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function V(U){for(var B=0,le="",Te="";B<U.length;)switch(le=U.charAt(B)){case"G":h(U,B)&&(B+=6),B++;break;case'"':for(;U.charCodeAt(++B)!==34&&B<U.length;);++B;break;case"\\":case"_":B+=2;break;case"@":++B;break;case"B":case"b":if(U.charAt(B+1)==="1"||U.charAt(B+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(U.substr(B,3).toUpperCase()==="A/P"||U.substr(B,5).toUpperCase()==="AM/PM"||U.substr(B,5).toUpperCase()==="/")return!0;++B;break;case"[":for(Te=le;U.charAt(B++)!=="]"&&B<U.length;)Te+=U.charAt(B);if(Te.match(q))return!0;break;case".":case"0":case"#":for(;B<U.length&&("0#?.,E+-%".indexOf(le=U.charAt(++B))>-1||le=="\\"&&U.charAt(B+1)=="-"&&"0#".indexOf(U.charAt(B+2))>-1););break;case"?":for(;U.charAt(++B)===le;);break;case"*":++B,U.charAt(B)!=" "&&U.charAt(B)!="*"||++B;break;case"(":case")":++B;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;B<U.length&&"0123456789".indexOf(U.charAt(++B))>-1;);break;case" ":default:++B}return!1}function x(U,B,le,Te){for(var ue,be,ye,ce=[],Re="",pe=0,me="",re="t",_e="H";pe<U.length;)switch(me=U.charAt(pe)){case"G":if(!h(U,pe))throw new Error("unrecognized character "+me+" in "+U);ce[ce.length]={t:"G",v:"General"},pe+=7;break;case'"':for(Re="";(ye=U.charCodeAt(++pe))!==34&&pe<U.length;)Re+=String.fromCharCode(ye);ce[ce.length]={t:"t",v:Re},++pe;break;case"\\":var Ze=U.charAt(++pe),We=Ze==="("||Ze===")"?Ze:"t";ce[ce.length]={t:We,v:Ze},++pe;break;case"_":ce[ce.length]={t:"t",v:" "},pe+=2;break;case"@":ce[ce.length]={t:"T",v:B},++pe;break;case"B":case"b":if(U.charAt(pe+1)==="1"||U.charAt(pe+1)==="2"){if(ue==null&&(ue=_(B,le,U.charAt(pe+1)==="2"))==null)return"";ce[ce.length]={t:"X",v:U.substr(pe,2)},re=me,pe+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":me=me.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(B<0)return"";if(ue==null&&(ue=_(B,le))==null)return"#####";for(Re=me;++pe<U.length&&U.charAt(pe).toLowerCase()===me;)Re+=me;me==="m"&&re.toLowerCase()==="h"&&(me="M"),me==="h"&&(me=_e),ce[ce.length]={t:me,v:Re},re=me;break;case"A":case"a":case"":var Xe={t:me,v:me};if(ue==null&&(ue=_(B,le)),U.substr(pe,3).toUpperCase()==="A/P"?(ue!=null&&(Xe.v=ue.H>=12?"P":"A"),Xe.t="T",_e="h",pe+=3):U.substr(pe,5).toUpperCase()==="AM/PM"?(ue!=null&&(Xe.v=ue.H>=12?"PM":"AM"),Xe.t="T",pe+=5,_e="h"):U.substr(pe,5).toUpperCase()==="/"?(ue!=null&&(Xe.v=ue.H>=12?"":""),Xe.t="T",pe+=5,_e="h"):(Xe.t="t",++pe),ue==null&&Xe.t==="T")return"";ce[ce.length]=Xe,re=me;break;case"[":for(Re=me;U.charAt(pe++)!=="]"&&pe<U.length;)Re+=U.charAt(pe);if(Re.slice(-1)!=="]")throw'unterminated "[" block: |'+Re+"|";if(Re.match(q)){if(ue==null&&(ue=_(B,le))==null)return"";ce[ce.length]={t:"Z",v:Re.toLowerCase()},re=Re.charAt(1)}else Re.indexOf("$")>-1&&(Re=(Re.match(/\$([^-\[\]]*)/)||[])[1]||"$",V(U)||(ce[ce.length]={t:"t",v:Re}));break;case".":if(ue!=null){for(Re=me;++pe<U.length&&(me=U.charAt(pe))==="0";)Re+=me;ce[ce.length]={t:"s",v:Re};break}case"0":case"#":for(Re=me;++pe<U.length&&"0#?.,E+-%".indexOf(me=U.charAt(pe))>-1;)Re+=me;ce[ce.length]={t:"n",v:Re};break;case"?":for(Re=me;U.charAt(++pe)===me;)Re+=me;ce[ce.length]={t:me,v:Re},re=me;break;case"*":++pe,U.charAt(pe)!=" "&&U.charAt(pe)!="*"||++pe;break;case"(":case")":ce[ce.length]={t:Te===1?"t":me,v:me},++pe;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(Re=me;pe<U.length&&"0123456789".indexOf(U.charAt(++pe))>-1;)Re+=U.charAt(pe);ce[ce.length]={t:"D",v:Re};break;case" ":ce[ce.length]={t:me,v:me},++pe;break;case"$":ce[ce.length]={t:"t",v:"$"},++pe;break;default:if("BsBrFtRs.krLmPQRSkRpR$S/.NTz,$-+/():!^&'~{}<>=acfijklopqrtuvwxzP$LekdinAf$dhAflRial?BirrKzMOPPGKRsGsB/R$levkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLLLtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$krGELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGXsomWSTNT$FtDramRpZMWFCFA".indexOf(me)===-1)throw new Error("unrecognized character "+me+" in "+U);ce[ce.length]={t:"t",v:me},++pe}var Ue,mt=0,St=0;for(pe=ce.length-1,re="t";pe>=0;--pe)switch(ce[pe].t){case"h":case"H":ce[pe].t=_e,re="h",mt<1&&(mt=1);break;case"s":(Ue=ce[pe].v.match(/\.0+$/))&&(St=Math.max(St,Ue[0].length-1)),mt<3&&(mt=3);case"d":case"y":case"M":case"e":re=ce[pe].t;break;case"m":re==="s"&&(ce[pe].t="M",mt<2&&(mt=2));break;case"X":break;case"Z":mt<1&&ce[pe].v.match(/[Hh]/)&&(mt=1),mt<2&&ce[pe].v.match(/[Mm]/)&&(mt=2),mt<3&&ce[pe].v.match(/[Ss]/)&&(mt=3)}switch(mt){case 0:break;case 1:ue.u>=.5&&(ue.u=0,++ue.S),ue.S>=60&&(ue.S=0,++ue.M),ue.M>=60&&(ue.M=0,++ue.H);break;case 2:ue.u>=.5&&(ue.u=0,++ue.S),ue.S>=60&&(ue.S=0,++ue.M)}var at,dt="";for(pe=0;pe<ce.length;++pe)switch(ce[pe].t){case"t":case"T":case" ":case"D":break;case"X":ce[pe].v="",ce[pe].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":ce[pe].v=F(ce[pe].t.charCodeAt(0),ce[pe].v,ue,St),ce[pe].t="t";break;case"n":case"?":for(at=pe+1;ce[at]!=null&&((me=ce[at].t)==="?"||me==="D"||(me===" "||me==="t")&&ce[at+1]!=null&&(ce[at+1].t==="?"||ce[at+1].t==="t"&&ce[at+1].v==="/")||ce[pe].t==="("&&(me===" "||me==="n"||me===")")||me==="t"&&(ce[at].v==="/"||ce[at].v===" "&&ce[at+1]!=null&&ce[at+1].t=="?"));)ce[pe].v+=ce[at].v,ce[at]={v:"",t:";"},++at;dt+=ce[pe].v,pe=at-1;break;case"G":ce[pe].t="t",ce[pe].v=R(B,le)}var wt,ct,bt="";if(dt.length>0){dt.charCodeAt(0)==40?(wt=B<0&&dt.charCodeAt(0)===45?-B:B,ct=z("n",dt,wt)):(ct=z("n",dt,wt=B<0&&Te>1?-B:B),wt<0&&ce[0]&&ce[0].t=="t"&&(ct=ct.substr(1),ce[0].v="-"+ce[0].v)),at=ct.length-1;var De=ce.length;for(pe=0;pe<ce.length;++pe)if(ce[pe]!=null&&ce[pe].t!="t"&&ce[pe].v.indexOf(".")>-1){De=pe;break}var He=ce.length;if(De===ce.length&&ct.indexOf("E")===-1){for(pe=ce.length-1;pe>=0;--pe)ce[pe]!=null&&"n?".indexOf(ce[pe].t)!==-1&&(at>=ce[pe].v.length-1?(at-=ce[pe].v.length,ce[pe].v=ct.substr(at+1,ce[pe].v.length)):at<0?ce[pe].v="":(ce[pe].v=ct.substr(0,at+1),at=-1),ce[pe].t="t",He=pe);at>=0&&He<ce.length&&(ce[He].v=ct.substr(0,at+1)+ce[He].v)}else if(De!==ce.length&&ct.indexOf("E")===-1){for(at=ct.indexOf(".")-1,pe=De;pe>=0;--pe)if(ce[pe]!=null&&"n?".indexOf(ce[pe].t)!==-1){for(be=ce[pe].v.indexOf(".")>-1&&pe===De?ce[pe].v.indexOf(".")-1:ce[pe].v.length-1,bt=ce[pe].v.substr(be+1);be>=0;--be)at>=0&&(ce[pe].v.charAt(be)==="0"||ce[pe].v.charAt(be)==="#")&&(bt=ct.charAt(at--)+bt);ce[pe].v=bt,ce[pe].t="t",He=pe}for(at>=0&&He<ce.length&&(ce[He].v=ct.substr(0,at+1)+ce[He].v),at=ct.indexOf(".")+1,pe=De;pe<ce.length;++pe)if(ce[pe]!=null&&("n?(".indexOf(ce[pe].t)!==-1||pe===De)){for(be=ce[pe].v.indexOf(".")>-1&&pe===De?ce[pe].v.indexOf(".")+1:0,bt=ce[pe].v.substr(0,be);be<ce[pe].v.length;++be)at<ct.length&&(bt+=ct.charAt(at++));ce[pe].v=bt,ce[pe].t="t",He=pe}}}for(pe=0;pe<ce.length;++pe)ce[pe]!=null&&"n?".indexOf(ce[pe].t)>-1&&(wt=Te>1&&B<0&&pe>0&&ce[pe-1].v==="-"?-B:B,ce[pe].v=z(ce[pe].t,ce[pe].v,wt),ce[pe].t="t");var Dt="";for(pe=0;pe!==ce.length;++pe)ce[pe]!=null&&(Dt+=ce[pe].v);return Dt}e.is_date=V,e._eval=x;var ee=/\[[=<>]/,ne=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ae(U,B){if(B==null)return!1;var le=parseFloat(B[2]);switch(B[1]){case"=":if(U==le)return!0;break;case">":if(U>le)return!0;break;case"<":if(U<le)return!0;break;case"<>":if(U!=le)return!0;break;case">=":if(U>=le)return!0;break;case"<=":if(U<=le)return!0}return!1}function de(U,B,le){le==null&&(le={});var Te="";switch(ul(U)){case"string":Te=U=="m/d/yy"&&le.dateNF?le.dateNF:U;break;case"number":(Te=U==14&&le.dateNF?le.dateNF:(le.table!=null?le.table:v)[U])==null&&(Te=le.table&&le.table[y[U]]||v[y[U]]),Te==null&&(Te=k[U]||"General")}if(Te.match(/^(w|W)((0?)|(0\.0+))$/)){if(isNaN(B))return B;var ue=Te.slice(1),be=!1;!isNaN(B)&&Number(B)<0&&(be=!0,B=Math.abs(B));var ye=parseInt(B).toString().length;if(ye>4){if(ye>8){var ce=parseInt(B/1e8),Re=parseInt(parseFloat(B).subtract(1e8*ce)/1e4),pe=parseFloat(B).subtract(1e8*ce+1e4*Re);ue!=""&&(pe=cn(pe).format(ue)),B=ce+""+Re+""+pe}else Re=parseInt(B/1e4),pe=parseFloat(B).subtract(1e4*Re),ue!=""&&(pe=cn(pe).format(ue)),B=Re+""+pe;if(B.indexOf("00")!=-1?B=B.replace("00",""):B.indexOf("0")!=-1?B=B.replace("0",""):B.indexOf("0")!=-1&&(B=B.replace("0","")),B.indexOf("")!=-1&&B.indexOf("")==-1){if((me=B.substring(B.indexOf("")+1)).substring(0,1)!=="."&&me!=""){switch((parseInt(me)+"").length){case 1:me="000"+me;break;case 2:me="00"+me;break;case 3:me="0"+me}B=B.substring(0,B.indexOf("")+1)+me}}else if(B.indexOf("")==-1&&B.indexOf("")!=-1){if((re=B.substring(B.indexOf("")+1)).substring(0,1)!=="."&&re!=""){switch((parseInt(re)+"").length){case 1:re="000"+re;break;case 2:re="00"+re;break;case 3:re="0"+re}B=B.substring(0,B.indexOf("")+1)+re}}else if(B.indexOf("")!=-1&&B.indexOf("")!=-1){var me=B.substring(B.indexOf("")+1,B.indexOf("")),re=B.substring(B.indexOf("")+1);switch((parseInt(me)+"").length){case 1:me="000"+me;break;case 2:me="00"+me;break;case 3:me="0"+me}if(B=B.substring(0,B.indexOf("")+1)+me+B.substring(B.indexOf("")),re.substring(0,1)!=="."&&re!=""){switch((parseInt(re)+"").length){case 1:re="000"+re;break;case 2:re="00"+re;break;case 3:re="0"+re}B=B.substring(0,B.indexOf("")+1)+re}}}else ue!=""&&(B=cn(B).format(ue));return be?"-"+B:B}if(h(Te,0))return R(B,le);B instanceof Date&&(B=S(B,le.date1904));var _e=function(Ze,We){var Xe=P(Ze),Ue=Xe.length,mt=Xe[Ue-1].indexOf("@");if(Ue<4&&mt>-1&&--Ue,Xe.length>4)throw new Error("cannot find right format for |"+Xe.join("|")+"|");if(typeof We!="number")return[4,Xe.length===4||mt>-1?Xe[Xe.length-1]:"@"];switch(Xe.length){case 1:Xe=mt>-1?["General","General","General",Xe[0]]:[Xe[0],Xe[0],Xe[0],"@"];break;case 2:Xe=mt>-1?[Xe[0],Xe[0],Xe[0],Xe[1]]:[Xe[0],Xe[1],Xe[0],"@"];break;case 3:Xe=mt>-1?[Xe[0],Xe[1],Xe[0],Xe[2]]:[Xe[0],Xe[1],Xe[2],"@"]}var St=We>0?Xe[0]:We<0?Xe[1]:Xe[2];if(Xe[0].indexOf("[")===-1&&Xe[1].indexOf("[")===-1)return[Ue,St];if(Xe[0].match(ee)!=null||Xe[1].match(ee)!=null){var at=Xe[0].match(ne),dt=Xe[1].match(ne);return ae(We,at)?[Ue,Xe[0]]:ae(We,dt)?[Ue,Xe[1]]:[Ue,Xe[at!=null&&dt!=null?2:1]]}return[Ue,St]}(Te,B);if(h(_e[1]))return R(B,le);if(B===!0)B="TRUE";else if(B===!1)B="FALSE";else if(B===""||B==null)return"";return x(_e[1],B,le,_e[0])}function ve(U,B){if(typeof B!="number"){B=+B||-1;for(var le=0;le<392;++le)if(v[le]!=null){if(v[le]==U){B=le;break}}else B<0&&(B=le);B<0&&(B=391)}return v[B]=U,B}e.load=ve,e._table=v,e.get_table=function(){return v},e.load_table=function(U){for(var B=0;B!=392;++B)U[B]!==void 0&&ve(U[B],B)},e.init_table=g,e.format=de})(tl),tl._table[22],tl._table[15],tl._table[14],tl._table[19],tl._table[18],tl._table[20],tl._table[2],tl._table[4],tl._table[10],tl._table[11],new Date(1899,11,31,0,0,0).getTime();var tb=new Date(1900,2,1,0,0,0);function xp(e,n){var t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),a=Date.UTC(1899,11,31,0,0,0);return n?t-=1262304e5:e>=tb&&(t+=864e5),(t-a)/864e5}var sd=new Date("2017-02-19T19:06:09.000Z");isNaN(sd.getFullYear())&&(sd=new Date("2/19/17"));var rb=sd.getFullYear()==2017;function _a(e){var n=null,t={},a=e;if(e==null)return null;if(e.toString().substr(0,1)==="'")n=e.toString().substr(1),t={fa:"@",t:"s"};else if(e.toString().toUpperCase()==="TRUE")n="TRUE",t={fa:"General",t:"b"},a=!0;else if(e.toString().toUpperCase()==="FALSE")n="FALSE",t={fa:"General",t:"b"},a=!1;else if(j(e))n=e.toString(),t={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))n=e.toString(),t={fa:"@",t:"s"};else if(M(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){var l=(a=cn(e).value()).toExponential();if(l.indexOf(".")>-1){var o=l.split(".")[1].split("e")[0].length;o>5&&(o=5),t={fa:"#0."+new Array(o+1).join("0")+"E+00",t:"n"}}else t={fa:"#0.E+00",t:"n"};n=tl.format(t.fa,a)}else if(e.toString().indexOf("%")>-1){var d=e.toString().indexOf("%"),s=(v=e.toString().substr(0,d)).replace(/,/g,"");if(d==e.toString().length-1&&M(s))if(v.indexOf(".")>-1)if(v.indexOf(".")==v.lastIndexOf(".")){var h=v.split(".")[0];if((y=v.split(".")[1].length)>9&&(y=9),h.indexOf(",")>-1){for(var f=!0,p=h.split(","),g=1;g<p.length;g++)if(p[g].length<3){f=!1;break}f?(t={fa:"#,##0."+new Array(y+1).join("0")+"%",t:"n"},a=cn(e).value(),n=tl.format(t.fa,a)):(n=e.toString(),t={fa:"@",t:"s"})}else t={fa:"0."+new Array(y+1).join("0")+"%",t:"n"},a=cn(e).value(),n=tl.format(t.fa,a)}else n=e.toString(),t={fa:"@",t:"s"};else if(v.indexOf(",")>-1){for(f=!0,p=v.split(","),g=1;g<p.length;g++)if(p[g].length<3){f=!1;break}f?(t={fa:"#,##0%",t:"n"},a=cn(e).value(),n=tl.format(t.fa,a)):(n=e.toString(),t={fa:"@",t:"s"})}else t={fa:"0%",t:"n"},a=cn(e).value(),n=tl.format(t.fa,a);else n=e.toString(),t={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var v,y,b=e.toString().split(".")[0];if((y=(v=e.toString().split(".")[1]).length)>9&&(y=9),b.indexOf(",")>-1){for(f=!0,p=b.split(","),g=1;g<p.length;g++)if(!M(p[g])||p[g].length<3){f=!1;break}f?(t={fa:"#,##0."+new Array(y+1).join("0"),t:"n"},a=cn(e).value(),n=tl.format(t.fa,a)):(n=e.toString(),t={fa:"@",t:"s"})}else M(b)&&M(v)?(t={fa:"0."+new Array(y+1).join("0"),t:"n"},a=cn(e).value(),n=tl.format(t.fa,a)):(n=e.toString(),t={fa:"@",t:"s"})}else n=e.toString(),t={fa:"@",t:"s"};else M(e)?(n=e.toString(),t={fa:"General",t:"n"},a=parseFloat(e)):un(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?((a=xp(function(k,w){var _=new Date(k);if(rb)return w>0?_.setTime(_.getTime()+60*_.getTimezoneOffset()*1e3):w<0&&_.setTime(_.getTime()-60*_.getTimezoneOffset()*1e3),_;if(k instanceof Date)return k;if(sd.getFullYear()==1917&&!isNaN(_.getFullYear())){var C=_.getFullYear();return k.indexOf(""+C)>-1||_.setFullYear(_.getFullYear()+100),_}var A=k.match(/\d+/g)||["2017","2","19","0","0","0"],I=new Date(+A[0],+A[1]-1,+A[2],+A[3]||0,+A[4]||0,+A[5]||0);return k.indexOf("Z")>-1&&(I=new Date(I.getTime()-60*I.getTimezoneOffset()*1e3)),I}(e.toString().replace(/-/g,"/")))).toString().indexOf(".")>-1?e.toString().length>18?t.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?t.fa="yyyy-MM-dd hh:mm":t.fa="yyyy-MM-dd":t.fa="yyyy-MM-dd",t.t="d",n=tl.format(t.fa,a)):(n=e,t.fa="General",t.t="g");return[n,t,a]}function za(e,n){return tl.format(e,n)}function uu(e,n,t){var a=Hr(e,n,t,"m");return a==null?a=Hr(e,n,t,"v"):isNaN(function(l){var o=Number(l);if(typeof l=="number")return l;if(!isNaN(o))return o;var d=1,s=l.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return d*=100,""});return isNaN(o=Number(s))?(s=s.replace(/[(](.*)[)]/,function(h,f){return d=-d,f}),isNaN(o=Number(s))?o:o/d):o/d}(a))?t[e][n].ct!=null&&t[e][n].ct.t=="d"||t[e][n].ct!=null&&t[e][n].ct.t=="b"||(a=Hr(e,n,t,"v")):typeof a=="string"&&a.indexOf("%")>-1||(a=Hr(e,n,t,"v")),a}function Ln(e,n,t,a){t==null&&(t=u.flowdata);var l,o=t[e][n];if(D(a)=="object"?(o==null?o=a:(a.f!=null&&(o.f=a.f),a.spl!=null&&(o.spl=a.spl),a.ct!=null&&(o.ct=a.ct)),l=D(a.v)=="object"?a.v.v:a.v):l=a,$t(l))return D(o)=="object"?(delete o.m,delete o.v):o=null,void(t[e][n]=o);if(($t(o)||(D(o)==="string"||D(o)==="number")&&o===a)&&(o={}),l.toString().substr(0,1)=="'")o.m=l.toString().substr(1),o.ct={fa:"@",t:"s"},o.v=l.toString().substr(1),o.qp=1;else if(o.qp==1)o.m=l.toString(),o.ct={fa:"@",t:"s"},o.v=l.toString();else if(l.toString().toUpperCase()==="TRUE")o.m="TRUE",o.ct={fa:"General",t:"b"},o.v=!0;else if(l.toString().toUpperCase()==="FALSE")o.m="FALSE",o.ct={fa:"General",t:"b"},o.v=!1;else if(j(l))o.m=l.toString(),o.ct!=null?o.ct.t="e":o.ct={fa:"General",t:"e"},o.v=l;else if(o.f!=null&&M(l)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(l))if(o.v=parseFloat(l),o.ct==null&&(o.ct={fa:"General",t:"n"}),o.v==1/0||o.v==-1/0)o.m=o.v.toString();else if(o.v.toString().indexOf("e")>-1){var d;(d=o.v.toString().split(".").length==1?0:o.v.toString().split(".")[1].split("e")[0].length)>5&&(d=5),o.m=o.v.toExponential(d).toString()}else{var s=Math.round(1e9*o.v)/1e9;if(o.ct==null){var h=_a(s);o.m=h[0].toString()}else{var f=za(o.ct.fa,s);o.m=f.toString()}}else if(o.ct!=null&&o.ct.fa=="@")o.m=l.toString(),o.v=l;else if(o.ct!=null&&o.ct.fa!=null&&o.ct.fa!="General"){M(l)&&(l=parseFloat(l));var p=za(o.ct.fa,l);p===l?(p=_a(l),o.m=p[0].toString(),o.ct=p[1],o.v=p[2]):(o.m=p.toString(),o.v=l)}else if(M(l)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(l))if(l=parseFloat(l),o.v=parseFloat(l),o.ct={fa:"General",t:"n"},o.v==1/0||o.v==-1/0)o.m=o.v.toString();else{var g=_a(o.v);o.m=g[0].toString()}else{var v=_a(l);o.m=v[0].toString(),o.ct=v[1],o.v=v[2]}if(!nt.allowUpdate&&!Nt.pointEdit&&o.ct!=null&&/^(w|W)((0?)|(0\.0+))$/.test(o.ct.fa)==0&&o.ct.t=="n"&&o.v!=null&&parseInt(o.v).toString().length>4){var y=function(b,k){var w,_="0.";if(b=="TRUE"){if(k==null)return"w";var C=parseInt(k);if(C==0)return"w0";_="w0.";for(var A=0;A<C;A++)_+="0";w=_}else{if(k==null)return"General";var I=parseInt(k);if(I==0)return"0";for(var S=0;S<I;S++)_+="0";w=_}return w.toString()}(Nt.autoFormatw.toString().toUpperCase(),Nt.accuracy);y!="General"&&(o.ct.fa=y,o.m=za(y,o.v))}t[e][n]=o}function fa(e,n){var t=e.length-1;return t=e.length<40||n<=e[20]||n>=e[t-20]?function(a,l){for(var o=0,d=0,s=-1,h=a.length-1;o<a.length&&h>=0&&h>=o;){if(d=a[h],l>=(h==0?0:a[h-1])&&l<d){s=h;break}if(d=a[o],l>=(o==0?0:a[o-1])&&l<d){s=o;break}o++,h--}return s}(e,n):function(a,l){for(var o=0,d=a.length-1;o<=d;){var s=parseInt((d+o)/2);if(l<a[s]&&(s==0||l>=a[s-1]))return s;if(l>=a[s])o=s+1;else{if(!(l<a[s]))return-1;d=s-1}}}(e,n)}function ol(e){var n;return n=u.visibledatarow[e],[e==0?0:u.visibledatarow[e-1],n,e]}function Wa(e){var n=fa(u.visibledatarow,e);return n==-1&&e>0?n=u.visibledatarow.length-1:n==-1&&e<=0&&(n=0),ol(n)}function En(e){var n;return n=u.visibledatacolumn[e],[e==0?0:u.visibledatacolumn[e-1],n,e]}function ja(e){var n=fa(u.visibledatacolumn,e);return n==-1&&e>0?n=u.visibledatacolumn.length-1:n==-1&&e<=0&&(n=0),En(n)}function pa(e,n){var t=$("#"+u.container).offset();return[e-t.left-u.rowHeaderWidth,n-t.top-u.infobarHeight-u.toolbarHeight-u.calculatebarHeight-u.columnHeaderHeight]}function Yl(e,n,t,a){var l=$.extend(!0,{},a);l.rowlen==null&&(l.rowlen={}),l.customHeight==null&&(l.customHeight={});var o=$("#luckysheetTableContent").get(0).getContext("2d");o.textBaseline="top";for(var d=n;d<=t;d++)if(l.rowhidden==null||l.rowhidden[d]==null){var s=u.defaultrowlen;if(l.customHeight[d]!=1){delete l.rowlen[d];for(var h=0;h<e[d].length;h++){var f=e[d][h];if(f!=null&&f.mc==null&&f!=null&&(f.v!=null||qi(f))){var p=qs(f,o,{r:d,c:h,cellWidth:En(h)[1]-En(h)[0]-2}),g=0;p!=null&&(g=p.textHeightAll+2),g>s&&(s=g)}}(s/=u.zoomRatio)!=u.defaultrowlen&&(l.rowlen[d]=s)}}return l}function wp(e,n){for(var t=[],a=0,l=0;l<e;l++){var o=u.defaultrowlen;n.rowlen!=null&&n.rowlen[l]!=null&&(o=n.rowlen[l]),n.rowhidden==null||n.rowhidden[l]==null?(a+=o+1,t.push(a)):(o=n.rowhidden[l],t.push(a))}return t}function eo(e,n,t){var a=u.measureTextCache[e+"_"+n.font];if(t!=null&&(a=u.measureTextCache[e+"_"+t]),a!=null)return a;t!=null&&(n.font,n.font=t);var l=n.measureText(e),o={};if(o.width=l.width,t!=null&&(n.font=t),o.actualBoundingBoxDescent=l.actualBoundingBoxDescent,o.actualBoundingBoxAscent=l.actualBoundingBoxAscent,o.actualBoundingBoxDescent==null||o.actualBoundingBoxAscent==null||isNaN(o.actualBoundingBoxDescent)||isNaN(o.actualBoundingBoxAscent)){var d="M";Ku(e)&&(d="");var s=.8*dr.getTextSize(d,n.font)[1];n.textBaseline=="top"?(o.actualBoundingBoxDescent=s,o.actualBoundingBoxAscent=0):n.textBaseline=="middle"?(o.actualBoundingBoxDescent=s/2,o.actualBoundingBoxAscent=s/2):(o.actualBoundingBoxDescent=0,o.actualBoundingBoxAscent=s)}if(n.textBaseline=="alphabetic"){var h=u.measureTextCache["gjpqy_"+n.font];t!=null&&(h=u.measureTextCache["gjpqy_"+t]);var f=u.measureTextCache["abcdABCD_"+n.font];t!=null&&(f=u.measureTextCache["abcdABCD_"+t]),h==null&&(h=n.measureText("gjpqy")),f==null&&(f=n.measureText("abcdABCD")),o.actualBoundingBoxDescent<=f.actualBoundingBoxDescent&&(o.actualBoundingBoxDescent=h.actualBoundingBoxDescent,o.actualBoundingBoxDescent==null&&(o.actualBoundingBoxDescent=0))}return o.width*=u.zoomRatio,o.actualBoundingBoxDescent*=u.zoomRatio,o.actualBoundingBoxAscent*=u.zoomRatio,u.measureTextCache[e+"_"+u.zoomRatio+"_"+n.font]=o,o}function qs(e,n,t){var a=t.cellWidth,l=t.cellHeight,o="",d="";a==null&&(o="onlyWidth",d="_");var s=u.measureTextCellInfoCache[t.r+"_"+t.c+d+o];if(s!=null)return s;var h=t.space_width,f=t.space_height;h==null&&(h=2),f==null&&(f=2);var p=Qi(e,"ht"),g=Qi(e,"vt"),v=Qi(e,"tb"),y=Qi(e,"tr"),b=Qi(e,"rt"),k=1;b==null&&(y=="0"?b=0:y=="1"?b=45:y=="4"?b=90:y=="2"?b=135:y=="5"&&(b=180),b==null&&(b=0)),(b>180||b<0)&&(b=0),(b=parseInt(b))>90&&(b=90-b,k=0),n.textAlign="start";var w,_,C={values:[]},A="0",I="0",S=11,E=!1,R=[];if(qi(e)){for(var F=e.ct.s,N=0,z=0;z<F.length;z++){for(var P=F[z],q=bd(P),V=P.fc,x=P.cl,ee=P.un,ne=P.v,ae=P.fs,de=(ne=ne.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_")).split("_x000D_"),ve=0;ve<de.length;ve++){var U=de[ve];if(U==""&&ve!=de.length-1)R.push({fontset:q,fc:V??"#000",cl:x??0,un:ee??0,wrap:!0,fs:ae??11}),N++;else{for(var B=U.split(""),le=0;le<B.length;le++){var Te=B[le];R.push({fontset:q,fc:V??"#000",cl:x??0,un:ee??0,v:Te,si:N,fs:ae??11})}ve!=de.length-1&&(R.push({fontset:q,fc:V??"#000",cl:x??0,un:ee??0,wrap:!0,fs:ae??11}),N++)}}N++}E=!0}else if(w=bd(e),n.font=w,A=Qi(e,"cl"),I=Qi(e,"un"),S=Qi(e,"fs"),e instanceof Object?(_=e.m)==null&&(_=e.v):_=e,$t(_))return null;if(y=="3"){n.textBaseline="top";var ue=0,be=0,ye=0,ce=0,Re={},pe=[];if(E)for(var me=null,re=0;re<R.length;re++){var _e=R[re],Ze=_e.v,We=_e.v;if(_e.wrap===!0&&(Ze="M",We="",me!=null&&me.wrap!==!0&&re<R.length-1))pe.push(ce),ce=0,ye+=1,me=_e;else{var Xe=eo(Ze,n,_e.fontset),Ue=Xe.width+h,mt=Xe.actualBoundingBoxAscent+Xe.actualBoundingBoxDescent+f;ce+=mt,v!="2"||_e.wrap||ce>l&&Re[ye]!=null&&(pe.push(ce-mt),ce=mt,ye+=1),re==R.length-1&&pe.push(ce),Re[ye]==null&&(Re[ye]=[]);var St={content:We,style:_e,width:Ue,height:mt,left:0,top:0,colIndex:ye,asc:Xe.actualBoundingBoxAscent,desc:Xe.actualBoundingBoxDescent,inline:!0};_e.wrap===!0&&(St.wrap=!0),Re[ye].push(St),console.log("normal",re,ye,_e,me,Re),me=_e}}else{var at=eo(_,n),dt=at.actualBoundingBoxDescent+at.actualBoundingBoxAscent,wt=[];(_=_.toString()).length>1?wt=_.split(""):wt.push(_);for(var ct=eo(wt[0],n).width,bt=0;bt<wt.length;bt++){var De=ct+h,He=dt+f;ce+=He,v=="2"&&ce>l&&Re[ye]!=null&&(pe.push(ce-He),ce=He,ye+=1),bt==wt.length-1&&pe.push(ce),Re[ye]==null&&(Re[ye]=[]),Re[ye].push({content:wt[bt],style:w,width:De,height:He,left:0,top:0,colIndex:ye,asc:at.actualBoundingBoxAscent,desc:at.actualBoundingBoxDescent})}}for(var Dt=[],et=0;et<pe.length;et++){for(var ur=pe[et],Xt=Re[et],jt=0,lr=0;lr<Xt.length;lr++){var tr=Xt[lr];jt=Math.max(jt,tr.width)}Dt.push(jt),ue+=jt,be=Math.max(be,ur)}if(C.type="verticalWrap",C.textWidthAll=ue,C.textHeightAll=be,o=="onlyWidth")return C;for(var xr=0,rr=0;rr<pe.length;rr++){for(var nr=pe[rr],Ut=Dt[rr],ar=Re[rr],Jt=0,Qt=0;Qt<ar.length;Qt++){var _t=ar[Qt],er=h+xr;p=="0"?er=a/2+xr-ue/2+h*pe.length:p=="2"&&(er=a+xr-ue+h);var Kt=l-f+Jt-nr;g=="0"?Kt=l/2+Jt-nr/2:g=="1"&&(Kt=f+Jt),Jt+=_t.height,_t.left=er,_t.top=Kt,yc(_t,A,I,{width:Ut,height:_t.height,left:er,top:Kt+_t.height-f,asc:_t.height,desc:0,fs:S}),C.values.push(_t)}xr+=Ut}}else{var mr=function(ms){return ms.measureText("").actualBoundingBoxAscent!=null}(n);if(n.textBaseline=mr?"alphabetic":"bottom",v=="2"||E){var fr=0,Wt=0,ze=0,Ae=0,Ve={};C.rotate=b,b=Math.abs(b);var gt,vt,pt,Tt,Ot=0,It=1,Lt=null,At=null;if(E)for(;It<=R.length;){var or=R.slice(Ot,It);if(or[or.length-1].wrap!==!0){for(var Cr=0,Ar=0,Rr=0;Rr<or.length;Rr++){var Zr=or[Rr];Zr.measureText==null&&(Zr.measureText=eo(Zr.v,n,Zr.fontset)),Cr+=Zr.measureText.width,Ar=Math.max(Zr.measureText.actualBoundingBoxAscent+Zr.measureText.actualBoundingBoxDescent)}var Tr=Cr*Math.cos(b*Math.PI/180)+Ar*Math.sin(b*Math.PI/180),jr=Cr*Math.sin(b*Math.PI/180)+Ar*Math.cos(b*Math.PI/180),ta=or[or.length-1];if(ta.v!=" "&&nf(ta.v)!=2||(At=It),b!=0)if(console.log(jr,f,l,or,jr+f>l),jr+f>l&&Ve[Ae]!=null&&v=="2"&&It!=R.length)if(At!=null&&At<It){for(var ia=0;ia<At-Ot;ia++){var Jr=or[ia];Ve[Ae].push({content:Jr.v,style:Jr,width:Jr.measureText.width,height:Jr.measureText.actualBoundingBoxAscent+Jr.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Jr.measureText.actualBoundingBoxAscent,desc:Jr.measureText.actualBoundingBoxDescent,inline:!0,fs:Jr.fs})}Ot=At,It=At+1,Ae+=1,At=null}else{Ot=It-1;for(var ba=0;ba<or.length-1;ba++){var Wr=or[ba];Ve[Ae].push({content:Wr.v,style:Wr,width:Wr.measureText.width,height:Wr.measureText.actualBoundingBoxAscent+Wr.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Wr.measureText.actualBoundingBoxAscent,desc:Wr.measureText.actualBoundingBoxDescent,inline:!0,fs:Wr.fs})}Ae+=1}else{if(It==R.length){Ve[Ae]==null&&(Ve[Ae]=[]);for(var Fr=0;Fr<or.length;Fr++){var oa=or[Fr];Ve[Ae].push({content:oa.v,style:oa,width:oa.measureText.width,height:oa.measureText.actualBoundingBoxAscent+oa.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:oa.measureText.actualBoundingBoxAscent,desc:oa.measureText.actualBoundingBoxDescent,inline:!0,fs:oa.fs})}break}Ve[Ae]==null&&(Ve[Ae]=[]),It++}else if(Tr+h>a&&Ve[Ae]!=null&&v=="2"&&It!=R.length)if(At!=null&&At<It){for(var Fa=0;Fa<At-Ot;Fa++){var Da=or[Fa];Ve[Ae].push({content:Da.v,style:Da,width:Da.measureText.width,height:Da.measureText.actualBoundingBoxAscent+Da.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Da.measureText.actualBoundingBoxAscent,desc:Da.measureText.actualBoundingBoxDescent,inline:!0,fs:Da.fs})}Ot=At,It=At+1,Ae+=1,At=null}else{Ot=It-1;for(var va=0;va<or.length-1;va++){var Ha=or[va];Ve[Ae].push({content:Ha.v,style:Ha,width:Ha.measureText.width,height:Ha.measureText.actualBoundingBoxAscent+Ha.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Ha.measureText.actualBoundingBoxAscent,desc:Ha.measureText.actualBoundingBoxDescent,inline:!0,fs:Ha.fs})}Ae+=1}else{if(It==R.length){Ve[Ae]==null&&(Ve[Ae]=[]);for(var qr=0;qr<or.length;qr++){var Ca=or[qr];Ve[Ae].push({content:Ca.v,style:Ca,width:Ca.measureText.width,height:Ca.measureText.actualBoundingBoxAscent+Ca.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Ca.measureText.actualBoundingBoxAscent,desc:Ca.measureText.actualBoundingBoxDescent,inline:!0,fs:Ca.fs})}break}Ve[Ae]==null&&(Ve[Ae]=[]),It++}}else{if(Ot=It,or.length>1)for(var La=0;La<or.length-1;La++){var Ea=or[La],Za={content:Ea.v,style:Ea,width:Ea.measureText.width,height:Ea.measureText.actualBoundingBoxAscent+Ea.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Ea.measureText.actualBoundingBoxAscent,desc:Ea.measureText.actualBoundingBoxDescent,inline:!0,fs:Ea.fs};Ve[Ae].push(Za)}if(or.length==1||It==R.length){var gn=or[0],Ka=eo("M",n,gn.fontset);Ve[Ae]==null&&(Ve[Ae]=[]),Ve[Ae].push({content:"",style:gn,width:Ka.width,height:Ka.actualBoundingBoxAscent+Ka.actualBoundingBoxDescent,left:0,top:0,splitIndex:Ae,asc:Ka.actualBoundingBoxAscent,desc:Ka.actualBoundingBoxDescent,inline:!0,wrap:!0,fs:gn.fs})}Ae+=1,It++}}else for(_=_.toString();It<=_.length;){var ka=_.substring(Ot,It),Pa=eo(ka,n),$a=Pa.width,on=Pa.actualBoundingBoxAscent+Pa.actualBoundingBoxDescent,Dn=$a*Math.cos(b*Math.PI/180)+on*Math.sin(b*Math.PI/180),Fn=$a*Math.sin(b*Math.PI/180)+on*Math.cos(b*Math.PI/180),_n=ka.substr(ka.length-1,1);if(_n!=" "&&nf(_n)!=2||Tt!=null&&(Lt={index:It,str:gt,width:pt,height:vt,asc:Tt.actualBoundingBoxAscent,desc:Tt.actualBoundingBoxDescent}),b!=0)if(Fn+f>l&&Ve[Ae]!=null&&It!=_.length)Lt!=null&&Lt.index<It?(Ot=Lt.index,It=Lt.index+1,Ve[Ae].push({content:Lt.str,style:w,width:Lt.width,height:Lt.height,left:0,top:0,splitIndex:Ae,asc:Lt.asc,desc:Lt.desc,fs:S}),Ae+=1,Lt=null):(Ot=It-1,Ve[Ae].push({content:gt,style:w,left:0,top:0,splitIndex:Ae,height:vt,width:pt,asc:Pa.actualBoundingBoxAscent,desc:Pa.actualBoundingBoxDescent,fs:S}),Ae+=1);else{if(It==_.length){Ve[Ae]==null&&(Ve[Ae]=[]),Ve[Ae].push({content:ka,style:w,left:0,top:0,splitIndex:Ae,height:on,width:$a,asc:Pa.actualBoundingBoxAscent,desc:Pa.actualBoundingBoxDescent,fs:S});break}Ve[Ae]==null&&(Ve[Ae]=[]),It++}else if(Dn+h>a&&Ve[Ae]!=null&&It!=_.length)Lt!=null&&Lt.index<It?(Ot=Lt.index,It=Lt.index+1,Ve[Ae].push({content:Lt.str,style:w,width:Lt.width,height:Lt.height,left:0,top:0,splitIndex:Ae,asc:Lt.asc,desc:Lt.desc,fs:S}),Ae+=1,Lt=null):(Lt=null,Ot=It-1,Ve[Ae].push({content:gt,style:w,width:pt,height:vt,left:0,top:0,splitIndex:Ae,asc:Pa.actualBoundingBoxAscent,desc:Pa.actualBoundingBoxDescent,fs:S}),Ae+=1);else{if(It==_.length){Ve[Ae]==null&&(Ve[Ae]=[]),Ve[Ae].push({content:ka,style:w,width:$a,height:on,left:0,top:0,splitIndex:Ae,asc:Pa.actualBoundingBoxAscent,desc:Pa.actualBoundingBoxDescent,fs:S});break}Ve[Ae]==null&&(Ve[Ae]=[]),It++}gt=ka,vt=on,pt=$a,Tt=Pa}for(var dl=[],Or=Object.keys(Ve).length,en=0;en<Or;en++){var hn=Ve[en];if(hn!=null){for(var tn,Sn=0,vn=0,Kn=0,ni=0,Jn=0,li=0;li<hn.length;li++){var Ma=hn[li];Sn+=Ma.width,vn=Math.max(vn,Ma.height-(mr?Ma.desc:0)),Kn=Math.max(Kn,mr?Ma.desc:0),ni=Math.max(ni,Ma.asc),Jn++}tn=vn/2,b!=0?(vn+=tn,ze=Math.max(ze,Sn),Wt+=vn):(vn+=tn,fr=Math.max(fr,Sn),Wt+=vn),dl.push({width:Sn,height:vn,desc:Kn,asc:ni,lineHeight:tn,wordCount:Jn})}}var nl=0,Pn=0,Mr=b*Math.PI/180,Qn=dl[Or-1],Ja=Qn.lineHeight,ii=(Wt=Wt-Ja+Qn.desc)/Math.sin(Mr)+ze*Math.cos(Mr),On=ze*Math.sin(Mr),Eo=0;if(b!=0?(Or==1?(fr=ze+Wt/Math.tan(Mr)*2,Eo=Wt/Math.tan(Mr)):fr=ze+Wt/Math.tan(Mr),C.textWidthAll=ii,C.textHeightAll=On):(C.textWidthAll=fr,C.textHeightAll=Wt),o=="onlyWidth")return C;if(b!=0&&k=="1"){n.textAlign="end";for(var Vi=0;Vi<Or;Vi++){var cs=Ve[Vi];if(cs!=null){var oi=dl[Vi];Pn=0;for(var ds=cs.length-1;ds>=0;ds--){var wl=cs[ds],Al=void 0,sl=void 0;if(b!=0){var Vl,_l=nl+oi.asc;Vl=nl/Math.tan(Mr)-Pn+ze,p=="0"?g=="0"?(Al=Vl+a/2-fr/2+Ja*Math.cos(Mr)/2,sl=_l+l/2-Wt/2-Ja*Math.cos(Mr)/2):g=="1"?(Al=Vl+a/2-fr/2,sl=_l-(Wt/2-On/2)):g=="2"&&(Al=Vl+a/2-fr/2+Ja*Math.cos(Mr),sl=_l+l-On/2-Wt/2-Ja*Math.cos(Mr)):p=="1"?g=="0"?(Al=Vl-On*Math.sin(Mr)/2+Ja*Math.cos(Mr)/2,sl=_l+l/2+On*Math.cos(Mr)/2-Ja*Math.cos(Mr)/2):g=="1"?(Al=Vl-On*Math.sin(Mr),sl=_l+On*Math.cos(Mr)):g=="2"&&(Al=Vl+Ja*Math.cos(Mr),sl=_l+l-Ja*Math.cos(Mr)):p=="2"&&(g=="0"?(Al=Vl+a-ii/2-(ze/2+Wt/2/Math.tan(Mr))+Ja*Math.cos(Mr)/2,sl=_l+l/2-Wt/2-Ja*Math.cos(Mr)/2):g=="1"?(Al=Vl+a-fr+Eo,sl=_l-Wt):g=="2"&&(Al=Vl+a-ii*Math.cos(Mr)+Ja*Math.cos(Mr),sl=_l+l-ii*Math.sin(Mr)-Ja*Math.cos(Mr)))}wl.left=Al,wl.top=sl,yc(wl,A,I,{width:wl.width,height:wl.height,left:Al-wl.width,top:sl,asc:oi.asc,desc:oi.desc,fs:wl.fs}),C.values.push(wl),Pn+=wl.width}nl+=oi.height}}}else for(var $o=0;$o<Or;$o++){var uo=Ve[$o];if(uo!=null){var hl=dl[$o];Pn=0;for(var xi=0;xi<uo.length;xi++){var ll=uo[xi],Wn=void 0,jn=void 0;if(b!=0){var Ul,Ll=nl+hl.asc;Ul=(Wt-nl)/Math.tan(Mr)+Pn,p=="0"?g=="0"?(Wn=Ul+a/2-fr/2-Ja*Math.cos(Mr)/2,jn=Ll+l/2-Wt/2+Ja*Math.cos(Mr)/2):g=="1"?(Wn=Ul+a/2-fr/2-Ja*Math.cos(Mr)/2,jn=Ll-(Wt/2-On/2)+Ja*Math.cos(Mr)/2):g=="2"&&(Wn=Ul+a/2-fr/2-Ja*Math.cos(Mr),jn=Ll+l-On/2-Wt/2-Ja*Math.cos(Mr)):p=="1"?g=="0"?(Wn=Ul-On*Math.sin(Mr)/2-Ja*Math.cos(Mr)/2,jn=Ll-Wt+l/2-On*Math.cos(Mr)/2-Ja*Math.cos(Mr)/2):g=="1"?(Wn=Ul,jn=Ll-Wt):g=="2"&&(Wn=Ul-On*Math.sin(Mr)-Ja*Math.cos(Mr),jn=Ll-Wt+l-On*Math.cos(Mr)-Ja*Math.cos(Mr)):p=="2"&&(g=="0"?(Wn=Ul+a-ii/2-fr/2-Ja*Math.cos(Mr)/2,jn=Ll+l/2-Wt/2-Ja*Math.cos(Mr)/2):g=="1"?(Wn=Ul+a-ii*Math.cos(Mr),jn=Ll+On*Math.cos(Mr)):g=="2"&&(Wn=Ul+a-fr-Ja*Math.cos(Mr)+Eo,jn=Ll+l-Ja*Math.cos(Mr))),yc(ll,A,I,{width:ll.width,height:ll.height,left:Wn,top:jn,asc:hl.asc,desc:hl.desc,fs:ll.fs})}else Wn=h+Pn,p=="0"?Wn=a/2+Pn-hl.width/2:p=="2"&&(Wn=a+Pn-hl.width),jn=l-f+nl+hl.asc-Wt,g=="0"?jn=l/2+nl-Wt/2+hl.asc:g=="1"&&(jn=f+nl+hl.asc),yc(ll,A,I,{width:ll.width,height:ll.height,left:Wn,top:jn,asc:hl.asc,desc:hl.desc,fs:ll.fs});ll.left=Wn,ll.top=jn,C.values.push(ll),Pn+=ll.width}nl+=hl.height}}C.type="plainWrap",b!=0&&(p=="0"?g=="0"?(C.textLeftAll=a/2,C.textTopAll=l/2):g=="1"?(C.textLeftAll=a/2,C.textTopAll=On/2):g=="2"&&(C.textLeftAll=a/2,C.textTopAll=l-On/2):p=="1"?g=="0"?(C.textLeftAll=0,C.textTopAll=l/2):g=="1"?(C.textLeftAll=0,C.textTopAll=0):g=="2"&&(C.textLeftAll=0,C.textTopAll=l):p=="2"&&(g=="0"?(C.textLeftAll=a-ii/2,C.textTopAll=l/2):g=="1"?(C.textLeftAll=a,C.textTopAll=0):g=="2"&&(C.textLeftAll=a,C.textTopAll=l)))}else{var ml=eo(_,n),si=ml.width,Hl=ml.actualBoundingBoxDescent+ml.actualBoundingBoxAscent;C.rotate=b;var Sl=(b=Math.abs(b))*Math.PI/180,hs=si*Math.cos(Sl)+Hl*Math.sin(Sl),Do=si*Math.sin(Sl)+Hl*Math.cos(Sl);if(C.textHeightAll=b!=0?Do:Do+Hl/2-ml.actualBoundingBoxDescent-f,C.textWidthAll=hs,o=="onlyWidth")return C;var Ui=hs,ui=Do,wi=h+Hl*Math.sin(Sl)*k;p=="0"?wi=a/2-Ui/2+Hl*Math.sin(Sl)*k:p=="2"&&(wi=a-h-Ui+Hl*Math.sin(Sl)*k);var Ql=l-f-ui+ml.actualBoundingBoxAscent*Math.cos(Sl)+si*Math.sin(Sl)*k;g=="0"?Ql=l/2-ui/2+ml.actualBoundingBoxAscent*Math.cos(Sl)+si*Math.sin(Sl)*k:g=="1"&&(Ql=f+ml.actualBoundingBoxAscent*Math.cos(Sl)+si*Math.sin(Sl)*k),C.type="plain";var Fo={content:_,style:w,width:Ui,height:ui,left:wi,top:Ql};yc(Fo,A,I,{width:si,height:Hl,left:wi,top:Ql,asc:ml.actualBoundingBoxAscent,desc:ml.actualBoundingBoxDescent,fs:S}),C.values.push(Fo),C.textLeftAll=wi,C.textTopAll=Ql,C.asc=ml.actualBoundingBoxAscent,C.desc=ml.actualBoundingBoxDescent}}return C}function yc(e,n,t,a){var l=a.left,o=a.top,d=a.width,s=(a.height,a.asc),h=a.desc,f=a.fs;if(e.wrap!==!0&&(e.inline==1&&e.style!=null&&(n=e.style.cl,t=e.style.un),n!="0"&&(e.cancelLine={},e.cancelLine.startX=l,e.cancelLine.startY=o-s/2+1,e.cancelLine.endX=l+d,e.cancelLine.endY=o-s/2+1,e.cancelLine.fs=f),t!="0")){if(e.underLine=[],t=="1"||t=="2"){var p={};p.startX=l,p.startY=o,p.endX=l+d,p.endY=o,p.fs=f,e.underLine.push(p)}if(t=="2"){var g={};g.startX=l,g.startY=o+h,g.endX=l+d,g.endY=o+h,g.fs=f,e.underLine.push(g)}if(t=="3"||t=="4"){var v={};v.startX=l,v.startY=o+h,v.endX=l+d,v.endY=o+h,v.fs=f,e.underLine.push(v)}if(t=="4"){var y={};y.startX=l,y.startY=o+h+2,y.endX=l+d,y.endY=o+h+2,y.fs=f,e.underLine.push(y)}}}var qh=function(e){for(var n=Dl(this),t=Zt(n.length),a=arguments.length,l=Ur(a>1?arguments[1]:void 0,t),o=a>2?arguments[2]:void 0,d=o===void 0?t:Ur(o,t);d>l;)n[l++]=e;return n};Ce({target:"Array",proto:!0},{fill:qh}),Is("fill");var cu,_p,Cp,du={},Tp=bn("iterator"),Ap=!1;[].keys&&("next"in(Cp=[].keys())?(_p=Wi(Wi(Cp)))!==Object.prototype&&(cu=_p):Ap=!0),cu==null&&(cu={}),$e(cu,Tp)||Qe(cu,Tp,function(){return this});var Mh={IteratorPrototype:cu,BUGGY_SAFARI_ITERATORS:Ap},ab=Be.f,Sp=bn("toStringTag"),Ms=function(e,n,t){e&&!$e(e=t?e:e.prototype,Sp)&&ab(e,Sp,{configurable:!0,value:n})},nb=Mh.IteratorPrototype,lb=function(){return this},Ip=function(e,n,t){var a=n+" Iterator";return e.prototype=gl(nb,{next:X(1,t)}),Ms(e,a,!1),du[a]=lb,e},Nh=Mh.IteratorPrototype,ud=Mh.BUGGY_SAFARI_ITERATORS,bc=bn("iterator"),ib=function(){return this},Lh=function(e,n,t,a,l,o,d){Ip(t,n,a);var s,h,f,p=function(_){if(_===l&&k)return k;if(!ud&&_ in y)return y[_];switch(_){case"keys":case"values":case"entries":return function(){return new t(this,_)}}return function(){return new t(this)}},g=n+" Iterator",v=!1,y=e.prototype,b=y[bc]||y["@@iterator"]||l&&y[l],k=!ud&&b||p(l),w=n=="Array"&&y.entries||b;if(w&&(s=Wi(w.call(new e)),Nh!==Object.prototype&&s.next&&(Wi(s)!==Nh&&(Qa?Qa(s,Nh):typeof s[bc]!="function"&&Qe(s,bc,ib)),Ms(s,g,!0))),l=="values"&&b&&b.name!=="values"&&(v=!0,k=function(){return b.call(this)}),y[bc]!==k&&Qe(y,bc,k),du[n]=k,l)if(h={values:p("values"),keys:o?k:p("keys"),entries:p("entries")},d)for(f in h)(ud||v||!(f in y))&&$r(y,f,h[f]);else Ce({target:n,proto:!0,forced:ud||v},h);return h},ob=Vt.set,sb=Vt.getterFor("Array Iterator"),as=Lh(Array,"Array",function(e,n){ob(this,{type:"Array Iterator",target:ie(e),index:0,kind:n})},function(){var e=sb(this),n=e.target,t=e.kind,a=e.index++;return!n||a>=n.length?(e.target=void 0,{value:void 0,done:!0}):t=="keys"?{value:a,done:!1}:t=="values"?{value:n[a],done:!1}:{value:[a,n[a]],done:!1}},"values");du.Arguments=du.Array,Is("keys"),Is("values"),Is("entries");var Ph=bn("iterator"),Rp=bn("toStringTag"),Oh=as.values;for(var zh in rh){var Ep=K[zh],xo=Ep&&Ep.prototype;if(xo){if(xo[Ph]!==Oh)try{Qe(xo,Ph,Oh)}catch{xo[Ph]=Oh}if(xo[Rp]||Qe(xo,Rp,zh),rh[zh]){for(var hu in as)if(xo[hu]!==as[hu])try{Qe(xo,hu,as[hu])}catch{xo[hu]=as[hu]}}}}function ql(){if(u.luckysheet_select_save.length!=0){for(var e=1/0,n=-1/0,t=0,a=0,l=0;l<u.luckysheet_select_save.length;l++)for(var o=K1(u.luckysheet_select_save[l]),d=0;d<o.length;d++)for(var s=0;s<o[0].length;s++)if(!$t(o[d][s])&&(a++,o[d][s].ct==null||o[d][s].ct.t!="d")){var h=o[d][s].v;M(h)&&(t+=h=parseFloat(h),h<e&&(e=h),h>n&&(n=h))}var f=st().formula,p="";p+="<span>"+f.count+":"+a+"</span>",(isFinite(n)||isFinite(e))&&(p+="<span>"+f.sum+":"+za("w",t)+"</span>",p+="<span>"+f.average+":"+za("w",Math.round(t/a*1e4)/1e4)+"</span>"),isFinite(n)&&(p+="<span>"+f.max+":"+za("w",n)+"</span>"),isFinite(e)&&(p+="<span>"+f.min+":"+za("w",e)+"</span>"),$("#luckysheet-sta-content").html(p)}}function cd(e,n,t,a,l){t==null&&(t=!0),e||(e="down"),n||(n="cell"),l==null&&(l=!1);var o=u.luckysheet_select_save[u.luckysheet_select_save.length-1],d=o.row==null?0:o.row[0],s=o.column==null?0:o.column[0],h=o.row==null?0:o.row[0],f=o.column==null?0:o.column[0],p=o.row==null?0:o.row[1],g=o.column==null?0:o.column[1];if(m.fucntionboxshow(d,s),n=="range"){var v=u.luckysheet_shiftpositon.row[0],y=u.luckysheet_shiftpositon.column[0],b=u.luckysheet_shiftpositon.row[1],k=u.luckysheet_shiftpositon.column[1];e=="down"||e=="up"?b<p?d=o.row==null?0:o.row[1]:v>h?d=o.row==null?0:o.row[0]:b==p&&v==h&&(d=e=="down"?o.row==null?0:o.row[1]:o.row==null?0:o.row[0]):e!="right"&&e!="left"||(k<g?s=o.column==null?0:o.column[1]:y>f?s=o.column==null?0:o.column[0]:k==g&&y==f&&(s=e=="right"?o.column==null?0:o.column[1]:o.column==null?0:o.column[0]))}var w=u.flowdata.length,_=u.flowdata[0].length,C=u.flowdata,A="",I=0;if(e=="up"){if(d==0)return;for(var S=[],E=null,R=0,F=null,N=f;N<=g;N++){S=[],R=0;for(var z=d-1;z>=0;z--){var P=C[z][N];if(D(P)=="object"&&$t(P.v)||$t(P)?S.push(!1):S.push(!0),S.length>1){if(S[R]==1&&S[R-1]==0){E=z;break}if(S[R]==0&&S[R-1]==1){E=z+1;break}}R++}E==null&&(E=0),(F==null||E<F)&&(F=E)}A="down",I=F-d}else if(e=="down"){if(d==w-1)return;for(var q=[],V=null,x=0,ee=null,ne=f;ne<=g;ne++){q=[],x=0;for(var ae=d+1;ae<C.length;ae++){var de=C[ae][ne];if(D(de)=="object"&&$t(de.v)||$t(de)?q.push(!1):q.push(!0),q.length>1){if(q[x]==1&&q[x-1]==0){V=ae;break}if(q[x]==0&&q[x-1]==1){V=ae-1;break}}x++}V==null&&(V=C.length-1),(ee==null||V>ee)&&(ee=V)}A="down",I=ee-d}else if(e=="left"){if(s==0)return;for(var ve=[],U=null,B=0,le=null,Te=h;Te<=p;Te++){ve=[],B=0;for(var ue=s-1;ue>=0;ue--){var be=C[Te][ue];if(D(be)=="object"&&$t(be.v)||$t(be)?ve.push(!1):ve.push(!0),ve.length>1){if(ve[B]==1&&ve[B-1]==0){U=ue;break}if(ve[B]==0&&ve[B-1]==1){U=ue+1;break}}B++}U==null&&(U=0),(le==null||U<le)&&(le=U)}A="right",I=le-s}else if(e=="right"){if(s==_-1)return;for(var ye=[],ce=null,Re=0,pe=null,me=h;me<=p;me++){ye=[],Re=0;for(var re=s+1;re<C[0].length;re++){var _e=C[me][re];if(D(_e)=="object"&&$t(_e.v)||$t(_e)?ye.push(!1):ye.push(!0),ye.length>1){if(ye[Re]==1&&ye[Re-1]==0){ce=re;break}if(ye[Re]==0&&ye[Re-1]==1){ce=re-1;break}}Re++}ce==null&&(ce=C[0].length-1),(pe==null||ce>pe)&&(pe=ce)}A="right",I=pe-s}if(n=="range"&&(e=="up"?p_endR<p&&I+d<p_endR&&(I=p_endR-d):e=="down"?v>h&&I+d>v&&(I=v-d):e=="left"?p_endC<g&&I+s<p_endC&&(I=p_endC-s):e=="right"&&y>f&&I+s>y&&(I=y-s),a!=null&&Math.abs(I)>Math.abs(a)&&(I=a)),l)return I;n=="cell"?Vn(A,I,"rangeOfSelect",t):n=="range"&&Ns(A,I,"rangeOfSelect",t)}function Vn(e,n,t,a){a==null&&(a=!0);var l,o,d,s,h,f,p,g,v=u.flowdata.length,y=u.flowdata[0].length;if(t=="rangeOfSelect"){var b,k,w=u.luckysheet_select_save[u.luckysheet_select_save.length-1];b=w.row_focus==null?w.row[0]:w.row_focus,k=w.column_focus==null?w.column[0]:w.column_focus;var _=dr.mergeborer(u.flowdata,b,k);if(_){var C=_.row[2],A=_.row[3],I=_.column[2],S=_.column[3];n>0?e=="down"?(b=A,k=I):e=="right"&&(b=C,k=S):(b=C,k=I)}var E=w.moveXY==null?b:w.moveXY.x,R=w.moveXY==null?k:w.moveXY.y;e=="down"?E=b+=n:e=="right"&&(R=k+=n),b>=v&&(E=b=v-1),b<0&&(E=b=0),k>=y&&(R=k=y-1),k<0&&(R=k=0);var F=dr.mergeborer(u.flowdata,b,k);F?(l=F.row[1],o=F.row[0],d=F.row[2],s=F.row[3],h=F.column[1],f=F.column[0],p=F.column[2],g=F.column[3]):(l=u.visibledatarow[E],o=E-1==-1?0:u.visibledatarow[E-1],d=E,s=E,h=u.visibledatacolumn[R],f=R-1==-1?0:u.visibledatacolumn[R-1],p=R,g=R),w.row=[d,s],w.column=[p,g],w.row_focus=d,w.column_focus=p,w.moveXY={x:E,y:R},Ra(),Pr.pivotclick(d,p),m.fucntionboxshow(d,p)}else if(t=="rangeOfFormula"){var N,z,P=m.func_selectedrange;N=P.row_focus==null?P.row[0]:P.row_focus,z=P.column_focus==null?P.column[0]:P.column_focus;var q=dr.mergeborer(u.flowdata,N,z);if(q){var V=q.row[2],x=q.row[3],ee=q.column[2],ne=q.column[3];n>0?e=="down"?(N=x,z=ee):e=="right"&&(N=V,z=ne):(N=V,z=ee)}var ae=P.moveXY==null?N:P.moveXY.x,de=P.moveXY==null?z:P.moveXY.y;e=="down"?ae=N+=n:e=="right"&&(de=z+=n),N>=v&&(ae=N=v-1),N<0&&(ae=N=0),z>=y&&(de=z=y-1),z<0&&(de=z=0);var ve=dr.mergeborer(u.flowdata,N,z);ve?(l=ve.row[1],o=ve.row[0],d=ve.row[2],s=ve.row[3],h=ve.column[1],f=ve.column[0],p=ve.column[2],g=ve.column[3]):(l=u.visibledatarow[ae],o=ae-1==-1?0:u.visibledatarow[ae-1],d=ae,s=ae,h=u.visibledatacolumn[de],f=de-1==-1?0:u.visibledatacolumn[de-1],p=de,g=de),m.func_selectedrange={left:f,width:h-f-1,top:o,height:l-o-1,left_move:f,width_move:h-f-1,top_move:o,height_move:l-o-1,row:[d,s],column:[p,g],row_focus:d,column_focus:p,moveXY:{x:ae,y:de}},$("#luckysheet-formula-functionrange-select").css({left:f,width:h-f-1,top:o,height:l-o-1}).show(),m.rangeSetValue({row:[d,s],column:[p,g]})}var U=$("#luckysheet-cell-main").scrollLeft(),B=$("#luckysheet-cell-main").scrollTop(),le=$("#luckysheet-cell-main").height(),Te=$("#luckysheet-cell-main").width(),ue=0,be=0;h-U-Te+20>0?(ue=h-Te+20,a&&$("#luckysheet-scrollbar-x").scrollLeft(ue)):f-U-20<0&&(ue=f-20,a&&$("#luckysheet-scrollbar-x").scrollLeft(ue)),l-B-le+20>0?(be=l-le+20,a&&$("#luckysheet-scrollbar-y").scrollTop(be)):o-B-20<0&&(be=o-20,a&&$("#luckysheet-scrollbar-y").scrollTop(be)),clearTimeout(u.countfuncTimeout),ql(),nt.saveParam("mv",u.currentSheetIndex,u.luckysheet_select_save)}function mu(e,n,t){var a,l,o,d;if(t||(t=!0),n=="rangeOfSelect"){var s=u.luckysheet_select_save[u.luckysheet_select_save.length-1],h=s.row_focus,f=s.column_focus,p=!1,g={};if(u.config.merge!=null&&h+"_"+f in u.config.merge&&(p=!0,g=u.config.merge[h+"_"+f]),e=="down"){if(h==u.flowdata.length-1)return;h=Na("down",f,p?g.r+g.rs-1:h,u.flowdata.length-1)}else if(e=="up"){if(h==0)return;h=Na("up",f,0,p?g.r:h)}else if(e=="right"){if(f==u.flowdata[0].length-1)return;f=Na("right",h,p?g.c+g.cs-1:f,u.flowdata[0].length-1)}else if(e=="left"){if(f==0)return;f=Na("left",h,0,p?g.c:f)}var v=[h,h],y=[f,f];a=u.visibledatarow[h],l=h-1==-1?0:u.visibledatarow[h-1],o=u.visibledatacolumn[f],d=f-1==-1?0:u.visibledatacolumn[f-1];var b=dr.mergeMoveMain(y,v,s,l,a-l-1,d,o-d-1);b!=null&&(y=b[0],v=b[1]),u.luckysheet_select_save=[{row:v,column:y}],Ra(),Pr.pivotclick(h,f),m.fucntionboxshow(h,f)}else if(n=="rangeOfFormula"){var k=m.func_selectedrange,w=k.row_focus,_=k.column_focus,C=!1,A={};if(u.config.merge!=null&&w+"_"+_ in u.config.merge&&(C=!0,A=u.config.merge[w+"_"+_]),e=="down"){if(w==u.flowdata.length-1)return;w=Na("down",_,C?A.r+A.rs-1:w,u.flowdata.length-1)}else if(e=="up"){if(w==0)return;w=Na("up",_,0,C?A.r:w)}else if(e=="right"){if(_==u.flowdata[0].length-1)return;_=Na("right",w,C?A.c+A.cs-1:_,u.flowdata[0].length-1)}else if(e=="left"){if(_==0)return;_=Na("left",w,0,C?A.c:_)}var I=[w,w],S=[_,_];a=u.visibledatarow[w],l=w-1==-1?0:u.visibledatarow[w-1],o=u.visibledatacolumn[_];var E=l,R=a-l-1,F=d=_-1==-1?0:u.visibledatacolumn[_-1],N=o-d-1,z=dr.mergeMoveMain(S,I,k,E,R,F,N);z!=null&&(S=z[0],I=z[1],E=z[2],R=z[3],F=z[4],N=z[5]),m.func_selectedrange={left:F,width:N,top:E,height:R,left_move:F,width_move:N,top_move:E,height_move:R,row:I,column:S,row_focus:w,column_focus:_},$("#luckysheet-formula-functionrange-select").css({left:F,width:N,top:E,height:R}).show(),m.rangeSetValue({row:I,column:S})}var P=$("#luckysheet-cell-main").scrollLeft(),q=$("#luckysheet-cell-main").scrollTop(),V=$("#luckysheet-cell-main").height(),x=$("#luckysheet-cell-main").width(),ee=0,ne=0;o-P-x+20>0?(ee=o-x+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(ee)):d-P-20<0&&(ee=d-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(ee)),a-q-V+20>0?(ne=a-V+20,t&&$("#luckysheet-scrollbar-y").scrollTop(ne)):l-q-20<0&&(ne=l-20,t&&$("#luckysheet-scrollbar-y").scrollTop(ne)),clearTimeout(u.countfuncTimeout),ql()}function Ns(e,n,t,a){var l,o,d,s;if(a==null&&(a=!0),t=="rangeOfSelect"){var h=u.luckysheet_select_save[u.luckysheet_select_save.length-1],f=h.row[0],p=h.row[1],g=h.column[0],v=h.column[1],y=h.row_focus,b=h.column_focus,k=u.flowdata.length,w=u.flowdata[0].length;if(e=="down"){if(Ml(y,g,v)){var _=Xl(y,g,v),C=_[0],A=_[1];C>f&&A==p?(n>0&&Ml(f,g,v)&&(f=Xl(f,g,v)[1]),f+=n):A<p&&C==f?(n<0&&Ml(p,g,v)&&(p=Xl(p,g,v)[0]),p+=n):n>0?p+=n:f+=n}else y>f&&y==p?(n>0&&Ml(f,g,v)&&(f=Xl(f,g,v)[1]),f+=n):y<p&&y==f?(n<0&&Ml(p,g,v)&&(p=Xl(p,g,v)[0]),p+=n):y==f&&y==p&&(n>0?p+=n:f+=n);p>=k&&(p=k-1),p<0&&(p=0),f>=k&&(f=k-1),f<0&&(f=0)}else{if(Nl(b,f,p)){var I=Zl(b,f,p),S=I[0],E=I[1];S>g&&E==v?(n>0&&Nl(g,f,p)&&(g=Zl(g,f,p)[1]),g+=n):E<v&&S==g?(n<0&&Nl(v,f,p)&&(v=Zl(v,f,p)[0]),v+=n):n>0?v+=n:g+=n}else b>g&&b==v?(n>0&&Nl(g,f,p)&&(g=Zl(g,f,p)[1]),g+=n):b<v&&b==g?(n<0&&Nl(v,f,p)&&(v=Zl(v,f,p)[0]),v+=n):b==g&&b==v&&(n>0?v+=n:g+=n);v>=w&&(v=w-1),v<0&&(v=0),g>=w&&(g=w-1),g<0&&(g=0)}var R=[f,p],F=[g,v];l=u.visibledatarow[p],o=f-1==-1?0:u.visibledatarow[f-1],d=u.visibledatacolumn[v],s=g-1==-1?0:u.visibledatacolumn[g-1];var N=dr.mergeMoveMain(F,R,h,o,l-o-1,s,d-s-1);N!=null&&(F=N[0],R=N[1]),h.row=R,h.column=F,Ra()}else if(t=="rangeOfFormula"){var z=m.func_selectedrange,P=z.row[0],q=z.row[1],V=z.column[0],x=z.column[1],ee=z.row_focus,ne=z.column_focus,ae=u.flowdata.length,de=u.flowdata[0].length;if(e=="down"){if(Ml(ee,V,x)){var ve=Xl(ee,V,x),U=ve[0],B=ve[1];U>P&&B==q?(n>0&&Ml(P,V,x)&&(P=Xl(P,V,x)[1]),P+=n):B<q&&U==P?(n<0&&Ml(q,V,x)&&(q=Xl(q,V,x)[0]),q+=n):n>0?q+=n:P+=n}else ee>P&&ee==q?(n>0&&Ml(P,V,x)&&(P=Xl(P,V,x)[1]),P+=n):ee<q&&ee==P?(n<0&&Ml(q,V,x)&&(q=Xl(q,V,x)[0]),q+=n):ee==P&&ee==q&&(n>0?q+=n:P+=n);q>=ae&&(q=ae-1),q<0&&(q=0),P>=ae&&(P=ae-1),P<0&&(P=0)}else{if(Nl(ne,P,q)){var le=Zl(ne,P,q),Te=le[0],ue=le[1];Te>V&&ue==x?(n>0&&Nl(V,P,q)&&(V=Zl(V,P,q)[1]),V+=n):ue<x&&Te==V?(n<0&&Nl(x,P,q)&&(x=Zl(x,P,q)[0]),x+=n):n>0?x+=n:V+=n}else ne>V&&ne==x?(n>0&&Nl(V,P,q)&&(V=Zl(V,P,q)[1]),V+=n):ne<x&&ne==V?(n<0&&Nl(x,P,q)&&(x=Zl(x,P,q)[0]),x+=n):ne==V&&ne==x&&(n>0?x+=n:V+=n);x>=de&&(x=de-1),x<0&&(x=0),V>=de&&(V=de-1),V<0&&(V=0)}var be=[P,q],ye=[V,x];l=u.visibledatarow[q],o=P-1==-1?0:u.visibledatarow[P-1],d=u.visibledatacolumn[x];var ce=o,Re=l-o-1,pe=s=V-1==-1?0:u.visibledatacolumn[V-1],me=d-s-1,re=dr.mergeMoveMain(ye,be,z,ce,Re,pe,me);re!=null&&(ye=re[0],be=re[1],ce=re[2],Re=re[3],pe=re[4],me=re[5]),m.func_selectedrange={left:pe,width:me,top:ce,height:Re,left_move:pe,width_move:me,top_move:ce,height_move:Re,row:be,column:ye,row_focus:ee,column_focus:ne},$("#luckysheet-formula-functionrange-select").css({left:pe,width:me,top:ce,height:Re}).show(),m.rangeSetValue({row:be,column:ye})}var _e=$("#luckysheet-cell-main").scrollLeft(),Ze=$("#luckysheet-cell-main").scrollTop(),We=$("#luckysheet-cell-main").height(),Xe=$("#luckysheet-cell-main").width(),Ue=0,mt=0;d-_e-Xe+20>0?(Ue=d-Xe+20,a&&$("#luckysheet-scrollbar-x").scrollLeft(Ue)):s-_e-20<0&&(Ue=s-20,a&&$("#luckysheet-scrollbar-x").scrollLeft(Ue)),l-Ze-We+20>0?(mt=l-We+20,a&&$("#luckysheet-scrollbar-y").scrollTop(mt)):o-Ze-20<0&&(mt=o-20,a&&$("#luckysheet-scrollbar-y").scrollTop(mt)),clearTimeout(u.countfuncTimeout),ql()}function ns(e,n,t){var a,l,o,d;if(t||(t=!0),n=="rangeOfSelect"){var s=u.luckysheet_select_save[u.luckysheet_select_save.length-1],h=s.row_focus,f=s.column_focus,p=s.row[0],g=s.row[1],v=s.column[0],y=s.column[1];if(e=="down"){if(g==u.flowdata.length-1)return;if(Ml(h,v,y)){var b=Xl(h,v,y),k=b[0],w=b[1];k>p&&w==g?p=Na("down",f,p,g):g=Na("down",f,g,u.flowdata.length-1)}else h>p&&h==g?p=Na("down",f,p,g):g=Na("down",f,g,u.flowdata.length-1)}else if(e=="up"){if(p==0)return;if(Ml(h,v,y)){var _=Xl(h,v,y),C=_[0];_[1]<g&&C==p?g=Na("up",f,p,g):p=Na("up",f,0,p)}else h<g&&h==p?g=Na("up",f,p,g):p=Na("up",f,0,p)}else if(e=="right"){if(y==u.flowdata[0].length-1)return;if(Nl(f,p,g)){var A=Zl(f,p,g),I=A[0],S=A[1];I>v&&S==y?v=Na("right",h,v,y):y=Na("right",h,y,u.flowdata[0].length-1)}else f>v&&f==y?v=Na("right",h,v,y):y=Na("right",h,y,u.flowdata[0].length-1)}else if(e=="left"){if(v==0)return;if(Nl(f,p,g)){var E=Zl(f,p,g),R=E[0];E[1]<y&&R==v?y=Na("left",h,v,y):v=Na("left",h,0,v)}else f<y&&f==v?y=Na("left",h,v,y):v=Na("left",h,0,v)}var F=[p,g],N=[v,y];a=u.visibledatarow[g],l=p-1==-1?0:u.visibledatarow[p-1],o=u.visibledatacolumn[y],d=v-1==-1?0:u.visibledatacolumn[v-1];var z=dr.mergeMoveMain(N,F,s,l,a-l-1,d,o-d-1);z!=null&&(N=z[0],F=z[1]),s.row=F,s.column=N,Ra()}else if(n=="rangeOfFormula"){var P=m.func_selectedrange,q=P.row_focus,V=P.column_focus,x=P.row[0],ee=P.row[1],ne=P.column[0],ae=P.column[1];if(e=="down"){if(ee==u.flowdata.length-1)return;if(Ml(q,ne,ae)){var de=Xl(q,ne,ae),ve=de[0],U=de[1];ve>x&&U==ee?x=Na("down",V,x,ee):ee=Na("down",V,ee,u.flowdata.length-1)}else q>x&&q==ee?x=Na("down",V,x,ee):ee=Na("down",V,ee,u.flowdata.length-1)}else if(e=="up"){if(x==0)return;if(Ml(q,ne,ae)){var B=Xl(q,ne,ae),le=B[0];B[1]<ee&&le==x?ee=Na("up",V,x,ee):x=Na("up",V,0,x)}else q<ee&&q==x?ee=Na("up",V,x,ee):x=Na("up",V,0,x)}else if(e=="right"){if(ae==u.flowdata[0].length-1)return;if(Nl(V,x,ee)){var Te=Zl(V,x,ee),ue=Te[0],be=Te[1];ue>ne&&be==ae?ne=Na("right",q,ne,ae):ae=Na("right",q,ae,u.flowdata[0].length-1)}else V>ne&&V==ae?ne=Na("right",q,ne,ae):ae=Na("right",q,ae,u.flowdata[0].length-1)}else if(e=="left"){if(ne==0)return;if(Nl(V,x,ee)){var ye=Zl(V,x,ee),ce=ye[0];ye[1]<ae&&ce==ne?ae=Na("left",q,ne,ae):ne=Na("left",q,0,ne)}else V<ae&&V==ne?ae=Na("left",q,ne,ae):ne=Na("left",q,0,ne)}var Re=[x,ee],pe=[ne,ae];a=u.visibledatarow[ee],l=x-1==-1?0:u.visibledatarow[x-1],o=u.visibledatacolumn[ae];var me=l,re=a-l-1,_e=d=ne-1==-1?0:u.visibledatacolumn[ne-1],Ze=o-d-1,We=dr.mergeMoveMain(pe,Re,P,me,re,_e,Ze);We!=null&&(pe=We[0],Re=We[1],me=We[2],re=We[3],_e=We[4],Ze=We[5]),m.func_selectedrange={left:_e,width:Ze,top:me,height:re,left_move:_e,width_move:Ze,top_move:me,height_move:re,row:Re,column:pe,row_focus:q,column_focus:V},$("#luckysheet-formula-functionrange-select").css({left:_e,width:Ze,top:me,height:re}).show(),m.rangeSetValue({row:Re,column:pe})}var Xe=$("#luckysheet-cell-main").scrollLeft(),Ue=$("#luckysheet-cell-main").scrollTop(),mt=$("#luckysheet-cell-main").height(),St=$("#luckysheet-cell-main").width(),at=0,dt=0;o-Xe-St+20>0?(at=o-St+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(at)):d-Xe-20<0&&(at=d-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(at)),a-Ue-mt+20>0?(dt=a-mt+20,t&&$("#luckysheet-scrollbar-y").scrollTop(dt)):l-Ue-20<0&&(dt=l-20,t&&$("#luckysheet-scrollbar-y").scrollTop(dt)),clearTimeout(u.countfuncTimeout),ql()}function Ml(e,n,t){for(var a=!1,l=n;l<=t;l++){var o=u.flowdata[e][l];if(D(o)=="object"&&"mc"in o){a=!0;break}}return a}function Nl(e,n,t){for(var a=!1,l=n;l<=t;l++){var o=u.flowdata[l][e];if(D(o)=="object"&&"mc"in o){a=!0;break}}return a}function Xl(e,n,t){var a=u.flowdata.length-1,l=null;if(e>0)for(var o=e;o>=0;o--){for(var d=n;d<=t;d++){var s=u.flowdata[o][d];if(D(s)=="object"&&"mc"in s){var h=u.config.merge[s.mc.r+"_"+s.mc.c];(l==null||h.r<l)&&(l=h.r)}}if(!(Ml(l-1,n,t)&&l>0))break;o=l-1}else l=0;var f=null;if(e<a)for(var p=e;p<=a;p++){for(var g=n;g<=t;g++){var v=u.flowdata[p][g];if(D(v)=="object"&&"mc"in v){var y=u.config.merge[v.mc.r+"_"+v.mc.c];(f==null||y.r+y.rs-1>f)&&(f=y.r+y.rs-1)}}if(!(Ml(f+1,n,t)&&f<a))break;p=f+1}else f=a;return[l,f]}function Zl(e,n,t){var a=u.flowdata[0].length-1,l=null;if(e>0)for(var o=e;o>=0;o--){for(var d=n;d<=t;d++){var s=u.flowdata[d][o];if(D(s)=="object"&&"mc"in s){var h=u.config.merge[s.mc.r+"_"+s.mc.c];(l==null||h.c<l)&&(l=h.c)}}if(!(Nl(l-1,n,t)&&l>0))break;o=l-1}else l=0;var f=null;if(e<a)for(var p=e;p<=a;p++){for(var g=n;g<=t;g++){var v=u.flowdata[g][p];if(D(v)=="object"&&"mc"in v){var y=u.config.merge[v.mc.r+"_"+v.mc.c];(f==null||y.c+y.cs-1>f)&&(f=y.c+y.cs-1)}}if(!(Nl(f+1,n,t)&&f<a))break;p=f+1}else f=a;return[l,f]}function Na(e,n,t,a){var l,o=null;if(e=="down"){var d=u.flowdata[t][n];l=!(D(d)!="object"||!$t(d.v))||!!$t(d),console.log(l,"stNull");for(var s=[],h=0,f=t+1;f<=a;f++){var p=u.flowdata[f][n];if(D(p)=="object"&&$t(p.v)||$t(p)?s.push(!0):s.push(!1),s.length==1&&l==1&&s[h]==0){o=t+h+1;break}if(s.length>1){if(l&&s[h]==0){o=t+h+1;break}if(!l){if(s[h]==0&&s[h-1]==1){o=t+h+1;break}if(s[h]==1&&s[h-1]==0){o=t+h;break}}}f==a&&(o=a),h++}}else if(e=="up"){var g=u.flowdata[a][n];l=!(D(g)!="object"||!$t(g.v))||!!$t(g);for(var v=[],y=0,b=a-1;b>=t;b--){var k=u.flowdata[b][n];if(D(k)=="object"&&$t(k.v)||$t(k)?v.push(!0):v.push(!1),v.length==1&&l&&v[y]==0){o=a-(y+1);break}if(v.length>1){if(l&&v[y]==0){o=a-(y+1);break}if(!l){if(v[y]==0&&v[y-1]==1){o=a-(y+1);break}if(v[y]==1&&v[y-1]==0){o=a-y;break}}}b==t&&(o=t),y++}}else if(e=="right"){var w=u.flowdata[n][t];l=!(D(w)!="object"||!$t(w.v))||!!$t(w);for(var _=[],C=0,A=t+1;A<=a;A++){var I=u.flowdata[n][A];if(D(I)=="object"&&$t(I.v)||$t(I)?_.push(!0):_.push(!1),_.length==1&&l&&_[C]==0){o=t+C+1;break}if(_.length>1){if(l&&_[C]==0){o=t+C+1;break}if(!l){if(_[C]==0&&_[C-1]==1){o=t+C+1;break}if(_[C]==1&&_[C-1]==0){o=t+C;break}}}A==a&&(o=a),C++}}else if(e=="left"){var S=u.flowdata[n][a];l=!(D(S)!="object"||!$t(S.v))||!!$t(S);for(var E=[],R=0,F=a-1;F>=t;F--){var N=u.flowdata[n][F];if(D(N)=="object"&&$t(N.v)||$t(N)?E.push(!0):E.push(!1),E.length==1&&l&&E[R]==0){o=a-(R+1);break}if(E.length>1){if(l&&E[R]==0){o=a-(R+1);break}if(!l){if(E[R]==0&&E[R-1]==1){o=a-(R+1);break}if(E[R]==1&&E[R-1]==0){o=a-R;break}}}F==t&&(o=t),R++}}return o}var Un={rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,n){$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();for(var t="",a=0;a<this.FixedModelColor.length;a++){var l=this.FixedModelColor[a],o=void 0,d=void 0,s=void 0,h=void 0;e&&n?(o=l.head,d=l.one,s=l.two,h=l.foot):e?(o=l.head,d=l.one,s=l.two,h=l.one):n?(o=l.one,d=l.two,s=l.one,h=l.foot):(o=l.one,d=l.two,s=l.one,h=l.two),t+='<div class="modelbox"><div class="box"><span style="color:'+o.fc+";background-color:"+o.bc+'">  </span><span style="color:'+d.fc+";background-color:"+d.bc+'">  </span><span style="color:'+s.fc+";background-color:"+s.bc+'">  </span><span style="color:'+h.fc+";background-color:"+h.bc+'">  </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(t);var f=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(f!=null&&f.length>0){for(var p="",g=0;g<f.length;g++){var v=f[g],y=void 0,b=void 0,k=void 0,w=void 0;e&&n?(y=v.head,b=v.one,k=v.two,w=v.foot):e?(y=v.head,b=v.one,k=v.two,w=v.one):n?(y=v.one,b=v.two,k=v.one,w=v.foot):(y=v.one,b=v.two,k=v.one,w=v.two),p+='<div class="modelbox"><div class="box"><span style="color:'+y.fc+";background-color:"+y.bc+'">  </span><span style="color:'+b.fc+";background-color:"+b.bc+'">  </span><span style="color:'+k.fc+";background-color:"+k.bc+'">  </span><span style="color:'+w.fc+";background-color:"+w.bc+'">  </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(p)}},init:function(){var e,n,t=this;$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").append((e=st(),n=e.alternatingColors,'<div id="luckysheet-modal-dialog-slider-alternateformat" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-alternateformat" style="display: block;"><div class="luckysheet-modal-dialog-slider-title"><span>'+e.toolbar.alternatingColors+'</span><span class="luckysheet-model-close-btn" title="'+n.close+'"><i class="fa fa-times" aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-slider-content"><div class="textTitle">'+n.applyRange+'</div><div id="luckysheet-alternateformat-range"><input class="formulaInputFocus" placeholder="'+n.selectRange+'"/><i class="fa fa-table" aria-hidden="true"></i></div><div id="luckysheet-alternateformat-checkbox"><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowHeader"/><label for="luckysheet-alternateformat-rowHeader">'+n.header+'</label></div><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowFooter"/><label for="luckysheet-alternateformat-rowFooter">'+n.footer+'</label></div></div><div class="textTitle">'+n.textTitle+'</div><div id="luckysheet-alternateformat-modelList" class="cf"></div><div class="textTitle">'+n.custom+'</div><div id="luckysheet-alternateformat-modelCustom" class="cf"></div><div id="luckysheet-alternateformat-modelToning"><div class="toningbox header"><div class="toningShow"> '+n.header+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctOne"><div class="toningShow"> '+n.colorShow+'1 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctTwo"><div class="toningShow"> '+n.colorShow+'2 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox footer"><div class="toningShow"> '+n.footer+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div></div><button id="luckysheet-alternateformat-remove" class="btn btn-default" style="margin: 10px;">'+n.removeColor+"</button></div></div>")),Rn(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Rn()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){t.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){t.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(a){$(this).val().trim(),a.keyCode==13&&t.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Rn();var a=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();t.rangeDialog(a)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){var a=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(a),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Rn(),t.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Rn()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Rn()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){var a,l;a=!!$(this).is(":checked"),l=!!$("#luckysheet-alternateformat-rowFooter").is(":checked"),t.checkboxChange(a,l),t.modelboxOn(),t.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){var a,l;a=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),l=!!$(this).is(":checked"),t.checkboxChange(a,l),t.modelboxOn(),t.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){var a=$(this).index(),l=$(this).parents(".cf").attr("id");if(l=="luckysheet-alternateformat-modelList")t.modelfocusIndex=a;else if(l=="luckysheet-alternateformat-modelCustom"){var o=t.FixedModelColor.length;t.modelfocusIndex=a+o}t.modelboxOn(),t.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){var a,l,o,d=$(this).closest(".toningbox");$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(a="fc",l=d.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(a="bc",l=d.find(".toningShow").data("bc")),d.hasClass("header")?o="0":d.hasClass("ctOne")?o="1":d.hasClass("ctTwo")?o="2":d.hasClass("footer")&&(o="3"),t.colorSelectDialog(l,a,o)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){var a=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog"),l=st().alternatingColors;$("#luckysheet-modal-dialog-mask").hide(),a.hide();var o,d=a.find(".currenColor span").attr("title");a.find(".luckysheet-modal-dialog-title-text").text()==l.selectionTextColor?o="fc":a.find(".luckysheet-modal-dialog-title-text").text()==l.selectionCellColor&&(o="bc");var s,h,f=a.find(".currenColor").attr("data-source");f=="0"?(o=="fc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",d),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",d),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d)),o=="bc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",d),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",d),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d))):f=="1"?(o=="fc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",d),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",d),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d)),o=="bc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",d),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",d),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d))):f=="2"?(o=="fc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",d),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",d),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d)),o=="bc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",d),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",d),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d))):f=="3"&&(o=="fc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",d),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",d),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d)),o=="bc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",d),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",d),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",d))),s=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),h=!!$("#luckysheet-alternateformat-rowFooter").is(":checked");var p,g,v=t.modelfocusIndex,y=t.FixedModelColor.length;if(v<y)p=$.extend(!0,{},t.getFormatByIndex());else{var b=(g=u.luckysheetfile[je(u.currentSheetIndex)]).luckysheet_alternateformat_save_modelCustom;p=$.extend(!0,{},b[v-y])}f=="0"?o=="fc"?p.head.fc=d:o=="bc"&&(p.head.bc=d):f=="1"?o=="fc"?p.one.fc=d:o=="bc"&&(p.one.bc=d):f=="2"?o=="fc"?p.two.fc=d:o=="bc"&&(p.two.bc=d):f=="3"&&(o=="fc"&&(p.foot.fc=d),o=="bc"&&(p.foot.bc=d)),t.modelfocusIndex<y?(t.addCustomModel(p),t.modelfocusIndex=t.getIndexByFormat(p)):(g.luckysheet_alternateformat_save_modelCustom[v-y]=p,nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,g.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),t.getModelBox(s,h),t.modelboxOn(),t.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){var a=$(this).data("index"),l=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save,o=$.extend(!0,[],l);l.length>1?l.splice(a,1):l=[];var d=$.extend(!0,[],l);t.ref(o,d),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,l,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Rn()})},perfect:function(){var e=$.extend(!0,{},u.luckysheet_select_save[0]),n=this.rangeIsExists(e)[1],t=$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save[n]),a=t.cellrange;$("#luckysheet-alternateformat-range input").val(wn(u.currentSheetIndex,{row:a.row,column:a.column},u.currentSheetIndex)),u.luckysheet_select_save=[{row:a.row,column:a.column}],Ra();var l=t.hasRowHeader,o=t.hasRowFooter,d=t.format;this.modelfocusIndex=this.getIndexByFormat(d),this.modelfocusIndex==null&&(this.addCustomModel(d),this.modelfocusIndex=this.getIndexByFormat(d)),this.checkboxChange(l,o),this.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",n)},checkboxChange:function(e,n){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),n?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),this.getModelBox(e,n)},modelboxOn:function(){$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");var e=this.modelfocusIndex,n=this.FixedModelColor.length;e<n?$("#luckysheet-alternateformat-modelList .modelbox").eq(e).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(e-n).addClass("on"),this.modelToningColor()},modelToningColor:function(){var e=this.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){var n=u.luckysheetfile[je(u.currentSheetIndex)];n.luckysheet_alternateformat_save_modelCustom==null&&(n.luckysheet_alternateformat_save_modelCustom=[]),n.luckysheet_alternateformat_save_modelCustom.push(e),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,n.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,n,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove();var a,l=st(),o=l.alternatingColors,d=l.button,s=l.toolbar;n=="fc"?a=o.selectionTextColor:n=="bc"&&(a=o.selectionCellColor),$("body").append(br(Ga,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:a,content:"<div class='currenColor' data-source='"+t+"'>"+o.currentColor+"<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">'+d.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+d.cancel+"</button>",style:"z-index:100003"}));var h=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),f=h.outerHeight(),p=h.outerWidth(),g=$(window).width(),v=$(window).height(),y=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(g+y-p)/2,top:(v+b-f)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:d.cancel,chooseText:s.confirmColor,togglePaletteMoreText:s.customColor,togglePaletteLessText:s.collapse,togglePaletteOnly:!0,clearText:s.clearText,noColorSelectedText:s.noColorSelectedText,localStorageKey:"spectrum.textcolor"+nt.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(k){k=k!=null?k.toHexString():"#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",k).attr("title",k)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove();var n=st(),t=n.alternatingColors,a=n.button;$("body").append(br(Ga,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:t.selectRange,content:'<input readonly="readonly" placeholder="'+t.tipSelectRange+'" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">'+a.cancel+"</button>",style:"z-index:100003"}));var l=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(s+f-d)/2,top:(h+p-o)/3}).show()},rangeIsExists:function(e,n){var t=!1,a=null,l=$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save);if(n!=null&&n!=null&&(l.length>1?l.splice(n,1):l=[]),l.length>0){for(var o=[],d=0;d<l.length;d++){var s={index:d,map:this.getRangeMap(l[d].cellrange.row,l[d].cellrange.column)};o.push(s)}var h=this.getRangeMap(e.row,e.column);for(var f in h){if(t)break;for(var p=0;p<o.length;p++)if(f in o[p].map){t=!0,a=o[p].index;break}}}return[t,a]},getRangeMap:function(e,n){for(var t={},a=e[0],l=e[1],o=n[0],d=n[1],s=a;s<=l;s++)for(var h=o;h<=d;h++)t[s+"_"+h]=0;return t},getIndexByFormat:function(e){for(var n=null,t=this.FixedModelColor,a=0;a<t.length;a++){var l=t[a];if(e.head.fc==l.head.fc&&e.head.bc==l.head.bc&&e.one.fc==l.one.fc&&e.one.bc==l.one.bc&&e.two.fc==l.two.fc&&e.two.bc==l.two.bc&&e.foot.fc==l.foot.fc&&e.foot.bc==l.foot.bc){n=a;break}}var o=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0)for(var d=0;d<o.length;d++){var s=o[d];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){n=t.length+d;break}}return n},getFormatByIndex:function(){var e=this.modelfocusIndex,n=this.FixedModelColor.length;return e<n?this.FixedModelColor[e]:u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[e-n]},new:function(e){var n=this.getFormatByIndex(),t=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save;t==null&&(t=[]);var a=$.extend(!0,[],t),l={cellrange:{row:e.row,column:e.column},format:n,hasRowHeader:!0,hasRowFooter:!1};t.push(l);var o=$.extend(!0,[],t);this.ref(a,o),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,t,{k:"luckysheet_alternateformat_save"})},update:function(){var e=st().alternatingColors,n=$("#luckysheet-alternateformat-remove").data("index"),t=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();if(m.iscelldata(t)){var a=m.getcellrange(t);if(this.rangeIsExists(a,n)[0])Rt()?alert(e.errorExistColors):Ee.info(e.errorExistColors,"");else{var l,o;l=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked"),o=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked");var d=this.getFormatByIndex(),s=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save;s==null&&(s=[]);var h=$.extend(!0,[],s),f={cellrange:{row:a.row,column:a.column},format:d,hasRowHeader:l,hasRowFooter:o};s[n]=f;var p=$.extend(!0,[],s);this.ref(h,p),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,s,{k:"luckysheet_alternateformat_save"})}}else Rt()?alert(e.errorNoRange):Ee.info(e.errorNoRange,"")},checksAF:function(e,n,t){return e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(){var e=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_alternateformat_save;return this.compute(e)},compute:function(e){var n={};if(e!=null&&e.length>0)for(var t=0;t<e.length;t++){var a=e[t].cellrange,l=e[t].format,o=e[t].hasRowHeader,d=e[t].hasRowFooter,s=a.row[0],h=a.row[1],f=a.column[0],p=a.column[1];if(o&&d){for(var g=f;g<=p;g++)n[s+"_"+g]=[l.head.fc,l.head.bc];if(h-s>1)for(var v=s+1;v<h;v++){var y=void 0,b=void 0;(v-s)%2!=0?(y=l.one.fc,b=l.one.bc):(y=l.two.fc,b=l.two.bc);for(var k=f;k<=p;k++)n[v+"_"+k]=[y,b]}if(h>s)for(var w=f;w<=p;w++)n[h+"_"+w]=[l.foot.fc,l.foot.bc]}else if(o){for(var _=f;_<=p;_++)n[s+"_"+_]=[l.head.fc,l.head.bc];if(h>s)for(var C=s+1;C<=h;C++){var A=void 0,I=void 0;(C-s)%2!=0?(A=l.one.fc,I=l.one.bc):(A=l.two.fc,I=l.two.bc);for(var S=f;S<=p;S++)n[C+"_"+S]=[A,I]}}else if(d){if(h>s)for(var E=s;E<h;E++){var R=void 0,F=void 0;(E-s)%2==0?(R=l.one.fc,F=l.one.bc):(R=l.two.fc,F=l.two.bc);for(var N=f;N<=p;N++)n[E+"_"+N]=[R,F]}for(var z=f;z<=p;z++)n[h+"_"+z]=[l.foot.fc,l.foot.bc]}else for(var P=s;P<=h;P++){var q=void 0,V=void 0;(P-s)%2==0?(q=l.one.fc,V=l.one.bc):(q=l.two.fc,V=l.two.bc);for(var x=f;x<=p;x++)n[P+"_"+x]=[q,V]}}return n},ref:function(e,n){if(u.clearjfundo){u.jfundo.length=0;var t={type:"updateAF"};t.sheetIndex=u.currentSheetIndex,t.data={historyRules:e,currentRules:n},u.jfredo.push(t)}var a=je(u.currentSheetIndex);u.luckysheetfile[a].luckysheet_alternateformat_save=n,setTimeout(function(){Kr()},1)}},fu={parseJsonParm:function(e){if(e==null)return{};if(D(e)!="string")return e;try{return new Function("return "+e)()}catch{return{}}},hasKey:function(e){var n=this.parseJsonParm(e);for(var t in n)return!0;return!1}};function pu(e,n,t,a,l,o,d,s,h,f){if(n?(e.addClass("luckysheet-filter-options-active").data("rowhidden",JSON.stringify(t)).data("caljs",JSON.stringify(a)).html('<i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i>'),a!=null&&(e.data("byconditionvalue",a.value).data("byconditiontype",a.type).data("byconditiontext",a.text),a.value1!=null&&e.data("byconditionvalue1",a.value1),a.value2!=null&&e.data("byconditionvalue2",a.value2))):(e.removeClass("luckysheet-filter-options-active").data("rowhidden","").data("caljs","").html('<i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i>'),e.data("byconditionvalue","null").data("byconditiontype","0").data("byconditiontext","").data("byconditionvalue1","").data("byconditionvalue2","")),l){var p=u.luckysheetfile[je(u.currentSheetIndex)];if(p.filter==null&&(p.filter={}),n){var g={caljs:a,rowhidden:t,optionstate:n,str:o,edr:d,cindex:s,stc:h,edc:f};p.filter[s-h]=g}else delete p.filter[s-h];nt.saveParam("all",u.currentSheetIndex,p.filter,{k:"filter"})}}function $p(e,n,t,a,l,o){for(var d=vr.deepCopyFlowData(u.flowdata),s=!1,h=[],f=e+=1;f<=t;f++){for(var p=[],g=n;g<=a;g++){if(d[f][g]!=null&&d[f][g].mc!=null){s=!0;break}p.push(d[f][g])}h.push(p)}if(s){var v=st().filter;Rt()?alert(v.mergeError):Ee.info(v.mergeError,"")}else{h=zs(h,l-n,o);for(var y=e;y<=t;y++)for(var b=n;b<=a;b++)d[y][b]=h[y-e][b-n];var k={};if(u.config.rowlen!=null){var w=$.extend(!0,{},u.config);k={cfg:w=Yl(d,e,t,w),RowlChange:!0}}wa(d,[{row:[e,t],column:[n,a]}],k)}}function Bh(){if(dn(u.currentSheetIndex,"filter")){if(u.luckysheet_select_save.length>1){$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#"+u.container).attr("tabindex",0).focus();var e=st().splitText;Rt()?alert(e.tipNoMulti):Ee.info(e.tipNoMulti,"")}else if(!u.luckysheetfile[je(u.currentSheetIndex)].isPivotTable){$("#luckysheet-filter-selected-sheet"+u.currentSheetIndex+", #luckysheet-filter-options-sheet"+u.currentSheetIndex).remove();var n=u.luckysheet_select_save[0];if(n.row[0]==n.row[1]&&n.column[0]==n.column[1]){for(var t,a,l=n.row[1],o=0;o<u.flowdata[l].length;o++){var d=u.flowdata[l][o];if(d==null||$t(d.v)){if(t!=null){a=o-1;break}}else t==null&&(t=o)}a==null&&(a=u.flowdata[l].length-1),u.luckysheet_select_save=[{row:[l,l],column:[t,a]}],Ra(),u.luckysheet_shiftpositon=$.extend(!0,{},n),cd("down","range")}else n.row[1]-n.row[0]<2&&(u.luckysheet_shiftpositon=$.extend(!0,{},n),cd("down","range"));u.luckysheet_filter_save=$.extend(!0,{},u.luckysheet_select_save[0]),gi(u.luckysheet_filter_save),nt.saveParam("all",u.currentSheetIndex,u.luckysheet_filter_save,{k:"filter_select"}),u.filterchage&&u.jfredo.push({type:"filtershow",data:[],curdata:[],sheetIndex:u.currentSheetIndex,filter_save:u.luckysheet_filter_save})}}}function gi(e,n){if($("#luckysheet-filter-selected-sheet"+u.currentSheetIndex).remove(),$("#luckysheet-filter-options-sheet"+u.currentSheetIndex).remove(),e!=null&&JSON.stringify(e)!="{}"){var t=e.row[0],a=e.row[1],l=e.column[0],o=e.column[1],d=u.visibledatarow[a],s=t-1==-1?0:u.visibledatarow[t-1],h=u.visibledatacolumn[o],f=l-1==-1?0:u.visibledatacolumn[l-1],p='<div id="luckysheet-filter-selected-sheet'+u.currentSheetIndex+'" class="luckysheet-cell-selected luckysheet-filter-selected"  style="left:'+f+"px;width:"+(h-f-1)+"px;top:"+s+"px;height:"+(d-s-1)+'px;display:block;border-color:#897BFF;z-index:20;background:none;"></div>';$("#luckysheet-cell-main").append(p);for(var g="",v=l;v<=o;v++)if(n==null||n[v-l]==null)g+='<div data-rowhidden="" data-str="'+t+'" data-edr="'+a+'" data-cindex="'+v+'" data-stc="'+l+'" data-edc="'+o+'" class="luckysheet-filter-options" style="left:'+(u.visibledatacolumn[v]-20)+"px;top:"+s+'px;display:block;"><i class="fa fa-caret-down" aria-hidden="true"></i></div>';else{var y=void 0;if(n[v-l].caljs!=null){var b=void 0;b=n[v-l].caljs.value1!=null?'data-byconditionvalue1="'+n[v-l].caljs.value1+'" ':"";var k=void 0;k=n[v-l].caljs.value2!=null?'data-byconditionvalue2="'+n[v-l].caljs.value2+'" ':"",y='data-caljs="'+JSON.stringify(n[v-l].caljs)+'" data-byconditionvalue="'+n[v-l].caljs.value+'" data-byconditiontype="'+n[v-l].caljs.type+'" data-byconditiontext="'+n[v-l].caljs.text+'" '+b+k}else y="";g+='<div data-rowhidden="'+JSON.stringify(n[v-l].rowhidden).replace(/\"/g,"'")+'" '+y+' data-str="'+t+'" data-edr="'+a+'" data-cindex="'+v+'" data-stc="'+l+'" data-edc="'+o+'" class="luckysheet-filter-options luckysheet-filter-options-active" style="left:'+(u.visibledatacolumn[v]-20)+"px;top:"+s+'px;display:block;"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i></div>'}$("#luckysheet-cell-main").append('<div id="luckysheet-filter-options-sheet'+u.currentSheetIndex+'" class="luckysheet-filter-options-c">'+g+"</div>"),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-cell-main").scrollTop()>e.top_move&&$("#luckysheet-scrollbar-y").scrollTop(e.top_move),u.luckysheetfile[je(u.currentSheetIndex)].filter_select=e}}var Kl,_r={imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null,inserImg:function(e){var n=this,t=u.luckysheet_select_save[u.luckysheet_select_save.length-1],a=t.row_focus||0,l=t.column_focus||0,o=l==0?0:u.visibledatacolumn[l-1],d=a==0?0:u.visibledatarow[a-1],s=new Image;s.onload=function(){var h=s.width,f=s.height,p={src:e,left:o,top:d,originWidth:h,originHeight:f};n.addImgItem(p)},s.src=e},generateRandomId:function(e){e==null&&(e="img");for(var n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",a=0;a<12;a++)t+=n[Math.round(Math.random()*(n.length-1))];return e+"_"+t+"_"+new Date().getTime()},modelHtml:function(e,n){var t=n.src,a=this.getImgItemParam(n),l=a.width*u.zoomRatio,o=a.height*u.zoomRatio,d=a.left*u.zoomRatio,s=a.top*u.zoomRatio,h=a.position,f=n.border.width;return'<div id="'.concat(e,'" class="luckysheet-modal-dialog luckysheet-modal-dialog-image" style="width:').concat(l,"px;height:").concat(o,"px;padding:0;position:").concat(h,";left:").concat(d,"px;top:").concat(s,`px;z-index:200;">
                    <div class="luckysheet-modal-dialog-content" style="width:100%;height:100%;overflow:hidden;position:relative;">
                        <img src="`).concat(t,'" style="position:absolute;width:').concat(n.default.width*u.zoomRatio,"px;height:").concat(n.default.height*u.zoomRatio,"px;left:").concat(-n.crop.offsetLeft*u.zoomRatio,"px;top:").concat(-n.crop.offsetTop*u.zoomRatio,`px;" />
                    </div>
                    <div class="luckysheet-modal-dialog-border" style="border:`).concat(f,"px ").concat(n.border.style," ").concat(n.border.color,";border-radius:").concat(n.border.radius*u.zoomRatio,"px;position:absolute;left:").concat(-f,"px;right:").concat(-f,"px;top:").concat(-f,"px;bottom:").concat(-f,`px;"></div>
                </div>`)},getSliderHtml:function(){var e=st().imageText;return`<div id="luckysheet-modal-dialog-slider-imageCtrl" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-imageCtrl" style="display:block;">
                    <div class="luckysheet-modal-dialog-slider-title">
                        <span>`.concat(e.imageSetting,`</span>
                        <span class="luckysheet-model-close-btn" title="`).concat(e.close,`">
                            <i class="fa fa-times" aria-hidden="true"></i>
                        </span>
                    </div>
                    <div class="luckysheet-modal-dialog-slider-content">
                        <div class="slider-box">
                            <div class="slider-box-title">`).concat(e.conventional,`</div>
                            <div class="slider-box-radios">
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType1" name="imgItemType" value="1">
                                    <label for="imgItemType1">`).concat(e.moveCell1,`</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType2" name="imgItemType" value="2">
                                    <label for="imgItemType2">`).concat(e.moveCell2,`</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType3" name="imgItemType" value="3">
                                    <label for="imgItemType3">`).concat(e.moveCell3,`</label>
                                </div>
                            </div>
                            <div class="slider-box-checkbox">
                                <input type="checkbox" id="imgItemIsFixedPos">
                                <label for="imgItemIsFixedPos">`).concat(e.fixedPos,`</label>
                            </div>
                        </div>
                        <div class="slider-box">
                            <div class="slider-box-title">`).concat(e.border,`</div>
                            <div class="slider-box-borderConfig">
                                <div class="border-item">
                                    <label>`).concat(e.width,`</label>
                                    <input type="number" id="imgItemBorderWidth" min="0">
                                </div>
                                <div class="border-item">
                                    <label>`).concat(e.radius,`</label>
                                    <input type="number" id="imgItemBorderRadius" min="0">
                                </div>
                                <div class="border-item">
                                    <label>`).concat(e.style,`</label>
                                    <select id="imgItemBorderStyle">
                                        <option value="solid">`).concat(e.solid,`</option>
                                        <option value="dashed">`).concat(e.dashed,`</option>
                                        <option value="dotted">`).concat(e.dotted,`</option>
                                        <option value="double">`).concat(e.double,`</option>
                                    </select>
                                </div>
                                <div class="border-item">
                                    <label>`).concat(e.color,`</label>
                                    <div id="imgItemBorderColor" class="imgItemBorderColor">
                                        <span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`)},sliderHtmlShow:function(){$("#luckysheet-modal-dialog-slider-imageCtrl").remove();var e=this.getSliderHtml();$("body").append(e),Rn();var n=this.images[this.currentImgId],t=n.type;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemType"+t).prop("checked",!0);var a=n.isFixedPos;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemIsFixedPos").prop("checked",a);var l=n.border;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderWidth").val(l.width),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderRadius").val(l.radius),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderStyle").val(l.style),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",l.color).attr("title",l.color),this.init()},colorSelectDialog:function(e){var n=st(),t=n.button,a=n.toolbar,l=n.imageCtrl;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-imageCtrl-colorSelect-dialog").remove(),$("body").append(br(Ga,{id:"luckysheet-imageCtrl-colorSelect-dialog",addclass:"luckysheet-imageCtrl-colorSelect-dialog",title:l.borderTile,content:`<div class="currenColor">
                            `.concat(l.borderCur,':<span title="').concat(e,'" style="background-color:').concat(e,`"></span>
                        </div>
                        <div class="colorshowbox"></div>`),botton:'<button id="luckysheet-imageCtrl-colorSelect-dialog-confirm" class="btn btn-primary">'.concat(t.confirm,`</button>
                        <button class="btn btn-default luckysheet-model-close-btn">`).concat(t.cancel,"</button>"),style:"z-index:100003"}));var o=$("#luckysheet-imageCtrl-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=o.outerHeight(),s=o.outerWidth(),h=$(window).width(),f=$(window).height(),p=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-imageCtrl-colorSelect-dialog").css({left:(h+p-s)/2,top:(f+g-d)/3}).show(),$("#luckysheet-imageCtrl-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:t.cancel,chooseText:a.confirmColor,togglePaletteMoreText:a.customColor,togglePaletteLessText:a.collapse,togglePaletteOnly:!0,clearText:a.clearText,noColorSelectedText:a.noColorSelectedText,localStorageKey:"spectrum.textcolor"+nt.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(v){v=v!=null?v.toHexString():"#000",$("#luckysheet-imageCtrl-colorSelect-dialog .currenColor span").css("background-color",v).attr("title",v)}})},init:function(){var e=this;$("#luckysheet-modal-dialog-slider-imageCtrl .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),Rn()}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.radio").on("change.radio",".radio-item input[type=radio][name=imgItemType]",function(){e.configChange("type",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.checkbox").on("change.checkbox",".slider-box-checkbox input[type=checkbox]",function(){e.configChange("fixedPos",this.checked)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderWidth").on("change.borderWidth","#imgItemBorderWidth",function(){e.configChange("border-width",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderRadius").on("change.borderRadius","#imgItemBorderRadius",function(){e.configChange("border-radius",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderStyle").on("change.borderStyle","#imgItemBorderStyle",function(){e.configChange("border-style",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("click.color").on("click.color","#imgItemBorderColor",function(){var n=$(this).find("span").attr("title");e.colorSelectDialog(n)}),$(document).off("click.selectColorConfirm").on("click.selectColorConfirm","#luckysheet-imageCtrl-colorSelect-dialog-confirm",function(){var n=$(this).parents("#luckysheet-imageCtrl-colorSelect-dialog");$("#luckysheet-modal-dialog-mask").hide(),n.hide();var t=n.find(".currenColor span").attr("title");$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",t).attr("title",t),e.configChange("border-color",t)}),$("#luckysheet-image-showBoxs").off("mousedown.active").on("mousedown.active",".luckysheet-modal-dialog-image",function(n){if(dn(u.currentSheetIndex,"editObjects",!1)){$(this).hide();var t=$(this).attr("id");e.currentImgId!=null&&e.currentImgId!=t&&e.cancelActiveImgItem(),e.currentImgId=t;var a=e.images[t],l=e.getImgItemParam(a),o=l.width*u.zoomRatio,d=l.height*u.zoomRatio,s=l.left*u.zoomRatio,h=l.top*u.zoomRatio,f=l.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:o,height:d,left:s,top:h,position:f}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+a.src+")","background-size":a.default.width*u.zoomRatio+"px "+a.default.height*u.zoomRatio+"px","background-position":-a.crop.offsetLeft*u.zoomRatio+"px "+-a.crop.offsetTop*u.zoomRatio+"px"}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":a.border.width*u.zoomRatio,"border-style":a.border.style,"border-color":a.border.color,"border-radius":a.border.radius*u.zoomRatio,left:-a.border.width*u.zoomRatio,right:-a.border.width*u.zoomRatio,top:-a.border.width*u.zoomRatio,bottom:-a.border.width*u.zoomRatio}),e.sliderHtmlShow(),n.stopPropagation()}}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.move").on("mousedown.move",".luckysheet-modal-dialog-content",function(n){if(dn(u.currentSheetIndex,"editObjects",!1)){$("#luckysheet-modal-dialog-slider-imageCtrl").is(":visible")||e.sliderHtmlShow(),e.move=!0,e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight;var t=$("#luckysheet-modal-dialog-activeImage").offset();e.moveXY=[n.pageX-t.left,n.pageY-t.top],Rs(!0),n.stopPropagation()}}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.resize").on("mousedown.resize",".luckysheet-modal-dialog-resize-item",function(n){if(dn(u.currentSheetIndex,"editObjects",!1)){e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");var t=$("#luckysheet-cell-main").scrollTop(),a=$("#luckysheet-cell-main").scrollLeft(),l=pa(n.pageX,n.pageY),o=l[0]+a,d=l[1]+t,s=$("#luckysheet-modal-dialog-activeImage").position(),h=$("#luckysheet-modal-dialog-activeImage").width(),f=$("#luckysheet-modal-dialog-activeImage").height();e.resizeXY=[o,d,h,f,s.left+a,s.top+t,a,t],Rs(!0),n.stopPropagation()}}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.croppingEnter").on("mousedown.croppingEnter",".luckysheet-modal-controll-crop",function(n){e.croppingEnter(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.croppingExit").on("mousedown.croppingExit",".luckysheet-modal-controll-crop",function(n){e.croppingExit(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.cropChange").on("mousedown.cropChange",".resize-item",function(n){e.cropChange=$(this).data("type");var t=$("#luckysheet-cell-main").scrollTop(),a=$("#luckysheet-cell-main").scrollLeft(),l=pa(n.pageX,n.pageY),o=l[0]+a,d=l[1]+t;e.cropChangeXY=[o,d],Rs(!0),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.restore").on("mousedown.restore",".luckysheet-modal-controll-restore",function(n){e.restoreImgItem(),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.delete").on("mousedown.delete",".luckysheet-modal-controll-del",function(n){e.removeImgItem(),n.stopPropagation()})},configChange:function(e,n){var t=this.images[this.currentImgId];switch(e){case"type":t.type=n;break;case"fixedPos":t.isFixedPos=n;var a=this.getImgItemParam(t),l=a.width,o=a.height,d=a.left,s=a.top,h=a.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:d,top:s,position:h});break;case"border-width":t.border.width=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":n,left:-n,right:-n,top:-n,bottom:-n});break;case"border-radius":t.border.radius=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-radius",n);break;case"border-style":t.border.style=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-style",n);break;case"border-color":t.border.color=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-color",n)}this.ref()},getImgItemParam:function(e){var n=e.isFixedPos,t=e.default.width,a=e.default.height,l=e.default.left,o=e.default.top;e.crop.width==t&&e.crop.height==a||(t=e.crop.width,a=e.crop.height,l+=e.crop.offsetLeft,o+=e.crop.offsetTop);var d="absolute";return n&&(d="fixed",l=e.fixedLeft+e.crop.offsetLeft,o=e.fixedTop+e.crop.offsetTop),{width:t,height:a,left:l,top:o,position:d}},cancelActiveImgItem:function(){$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();var e=this.images[this.currentImgId],n=this.getImgItemParam(e),t=n.width*u.zoomRatio,a=n.height*u.zoomRatio,l=n.left*u.zoomRatio,o=n.top*u.zoomRatio,d=n.position;$("#"+this.currentImgId).show().css({width:t,height:a,left:l,top:o,position:d}),$("#"+this.currentImgId+" img").css({width:e.default.width*u.zoomRatio,height:e.default.height*u.zoomRatio,left:-e.crop.offsetLeft*u.zoomRatio,top:-e.crop.offsetTop*u.zoomRatio}),$("#"+this.currentImgId+" .luckysheet-modal-dialog-border").css({"border-width":e.border.width*u.zoomRatio,"border-style":e.border.style,"border-color":e.border.color,"border-radius":e.border.radius*u.zoomRatio,left:-e.border.width*u.zoomRatio,right:-e.border.width*u.zoomRatio,top:-e.border.width*u.zoomRatio,bottom:-e.border.width*u.zoomRatio}),this.currentImgId=null},addImgItem:function(e){var n,t;e.originHeight<e.originWidth?(t=Math.round(e.originHeight*(400/e.originWidth)),n=400):(n=Math.round(e.originWidth*(400/e.originHeight)),t=400),this.images==null&&(this.images={});var a=$.extend(!0,{},this.imgItem);a.src=e.src,a.originWidth=e.originWidth,a.originHeight=e.originHeight,a.default.width=n,a.default.height=t,a.default.left=e.left,a.default.top=e.top,a.crop.width=n,a.crop.height=t;var l=$("#luckysheet-cell-main").scrollTop(),o=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=e.left-o+u.rowHeaderWidth,a.fixedTop=e.top-l+u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight;var d=this.generateRandomId(),s=this.modelHtml(d,a);$("#luckysheet-image-showBoxs .img-list").append(s),this.images[d]=a,this.ref(),this.init()},moveImgItem:function(){this.move=!1;var e=$("#luckysheet-modal-dialog-activeImage")[0],n=this.images[this.currentImgId];n.isFixedPos?(n.fixedLeft=e.offsetLeft-n.crop.offsetLeft,n.fixedTop=e.offsetTop-n.crop.offsetTop):(n.default.left=e.offsetLeft-n.crop.offsetLeft,n.default.top=e.offsetTop-n.crop.offsetTop),this.ref()},resizeImgItem:function(){this.resize=null;var e=$("#luckysheet-modal-dialog-activeImage")[0],n=this.images[this.currentImgId],t=e.clientWidth/n.crop.width,a=e.clientHeight/n.crop.height;n.default.width=Math.round(n.default.width*t),n.default.height=Math.round(n.default.height*a),n.crop.width=Math.round(n.crop.width*t),n.crop.height=Math.round(n.crop.height*a),n.crop.offsetLeft=Math.round(n.crop.offsetLeft*t),n.crop.offsetTop=Math.round(n.crop.offsetTop*a),n.isFixedPos?(n.fixedLeft=e.offsetLeft,n.fixedTop=e.offsetTop):(n.default.left=e.offsetLeft-n.crop.offsetLeft,n.default.top=e.offsetTop-n.crop.offsetTop),this.ref()},croppingEnter:function(){if(this.cropping=!0,dn(u.currentSheetIndex,"editObjects",!1)){$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();var e=this.images[this.currentImgId],n=this.getImgItemParam(e),t=n.width,a=n.height,l=n.left,o=n.top,d=n.position;$("#luckysheet-modal-dialog-cropping").show().css({width:t,height:a,left:l,top:o,position:d}),$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:e.default.width,height:e.default.height,"background-image":"url("+e.src+")",left:-e.crop.offsetLeft,top:-e.crop.offsetTop}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+e.src+")","background-size":e.default.width+"px "+e.default.height+"px","background-position":-e.crop.offsetLeft+"px "+-e.crop.offsetTop+"px"}),$("#luckysheet-modal-dialog-cropping .luckysheet-modal-dialog-border").css({"border-width":e.border.width,"border-style":e.border.style,"border-color":e.border.color,"border-radius":e.border.radius,left:-e.border.width,right:-e.border.width,top:-e.border.width,bottom:-e.border.width})}},croppingExit:function(){this.cropping=!1,$("#luckysheet-modal-dialog-cropping").hide();var e=this.images[this.currentImgId],n=this.getImgItemParam(e),t=n.width,a=n.height,l=n.left,o=n.top,d=n.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:t,height:a,left:l,top:o,position:d}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+e.src+")","background-size":e.default.width+"px "+e.default.height+"px","background-position":-e.crop.offsetLeft+"px "+-e.crop.offsetTop+"px"})},cropChangeImgItem:function(){this.cropChange=null;var e=this.images[this.currentImgId];e.crop.width=this.cropChangeObj.width,e.crop.height=this.cropChangeObj.height,e.crop.offsetLeft=this.cropChangeObj.offsetLeft,e.crop.offsetTop=this.cropChangeObj.offsetTop,this.ref()},restoreImgItem:function(){var e=this.images[this.currentImgId];e.default.width=e.originWidth,e.default.height=e.originHeight,e.crop.width=e.originWidth,e.crop.height=e.originHeight,e.crop.offsetLeft=0,e.crop.offsetTop=0;var n=this.getImgItemParam(e),t=n.width,a=n.height,l=n.left,o=n.top,d=n.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:t,height:a,left:l,top:o,position:d}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+e.src+")","background-size":e.default.width+"px "+e.default.height+"px","background-position":-e.crop.offsetLeft+"px "+-e.crop.offsetTop+"px"}),this.ref()},removeImgItem:function(){$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#"+this.currentImgId).remove(),delete this.images[this.currentImgId],this.currentImgId=null,this.ref()},copyImgItem:function(e){this.copyImgItemObj=$.extend(!0,{},this.images[this.currentImgId]);var n=window.clipboardData;n||(n=e.originalEvent.clipboardData);var t='<table data-type="luckysheet_copy_action_image"><tr><td><td></tr></table>';if(n)return n.setData("Text",t),!1;var a=$("#luckysheet-copy-content");a.html(t),a.focus(),a.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)},pasteImgItem:function(){var e=u.luckysheet_select_save[0].row_focus||0,n=u.luckysheet_select_save[0].column_focus||0,t=n==0?0:u.visibledatacolumn[n-1],a=e==0?0:u.visibledatarow[e-1],l=$.extend(!0,{},this.copyImgItemObj);l.default.left=t-l.crop.offsetLeft,l.default.top=a-l.crop.offsetTop;var o=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").scrollLeft();l.fixedLeft=l.default.left-d+u.rowHeaderWidth,l.fixedTop=l.default.top-o+u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight;var s=this.generateRandomId(),h=this.modelHtml(s,l);$("#luckysheet-image-showBoxs .img-list").append(h),this.images[s]=l,this.ref(),this.init()},allImagesShow:function(){if($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#luckysheet-image-showBoxs .img-list").empty(),this.images!=null)for(var e in this.images){var n=this.images[e],t=this.modelHtml(e,n);$("#luckysheet-image-showBoxs .img-list").append(t)}},moveChangeSize:function(e,n,t){var a=$.extend(!0,{},this.images);if(e=="row"){var l=u.visibledatarow[n],o=t-(l-(n-1==-1?0:u.visibledatarow[n-1])-1);for(var d in a){var s=a[d],h=this.getImgItemParam(s),f=s.type;if(f=="1"){if(h.top>=l)s.default.top=h.top+o-s.crop.offsetTop;else if(h.top+h.height>=l-2)if(h.top<l+o){var p=(h.height+o)/h.height;s.default.height=Math.round(s.default.height*p),s.crop.height=Math.round(s.crop.height*p),s.crop.offsetTop=Math.round(s.crop.offsetTop*p)}else{var g=(h.top+h.height-l)/h.height;s.default.height=Math.round(s.default.height*g),s.crop.height=Math.round(s.crop.height*g),s.crop.offsetTop=Math.round(s.crop.offsetTop*g),s.default.top=l+o-s.crop.offsetTop}else if(h.top>l+o){var v=1/h.height;s.default.height=Math.round(s.default.height*v),s.crop.height=Math.round(s.crop.height*v),s.crop.offsetTop=Math.round(s.crop.offsetTop*v),s.default.top=l+o-s.crop.offsetTop}else if(h.top+h.height>l+o){var y=(l+o-h.top)/h.height;s.default.height=Math.round(s.default.height*y),s.crop.height=Math.round(s.crop.height*y),s.crop.offsetTop=Math.round(s.crop.offsetTop*y)}}else f=="2"&&(h.top>=l?s.default.top=h.top+o-s.crop.offsetTop:h.top>l+o&&(s.default.top=l+o-s.crop.offsetTop))}}else if(e=="column"){var b=u.visibledatacolumn[n],k=t-(b-(n-1==-1?0:u.visibledatacolumn[n-1])-1);for(var w in a){var _=a[w],C=this.getImgItemParam(_),A=_.type;if(A=="1"){if(C.left>=b)_.default.left=C.left+k-_.crop.offsetLeft;else if(C.left+C.width>=b-2)if(C.left<b+k){var I=(C.width+k)/C.width;_.default.width=Math.round(_.default.width*I),_.crop.width=Math.round(_.crop.width*I),_.crop.offsetLeft=Math.round(_.crop.offsetLeft*I)}else{var S=(C.left+C.width-b)/C.width;_.default.width=Math.round(_.default.width*S),_.crop.width=Math.round(_.crop.width*S),_.crop.offsetLeft=Math.round(_.crop.offsetLeft*S),_.default.left=b+k-_.crop.offsetLeft}else if(C.left>b+k){var E=1/C.width;_.default.width=Math.round(_.default.width*E),_.crop.width=Math.round(_.crop.width*E),_.crop.offsetLeft=Math.round(_.crop.offsetLeft*E),_.default.left=b+k-_.crop.offsetLeft}else if(C.left+C.width>b+k){var R=(b+k-C.left)/C.width;_.default.width=Math.round(_.default.width*R),_.crop.width=Math.round(_.crop.width*R),_.crop.offsetLeft=Math.round(_.crop.offsetLeft*R)}}else A=="2"&&(C.left>=b?_.default.left=C.left+k-_.crop.offsetLeft:C.left>b+k&&(_.default.left=b+k-_.crop.offsetLeft))}}return a},ref:function(){var e=u.luckysheetfile[je(u.currentSheetIndex)],n=this.images;u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"imageCtrl",sheetIndex:u.currentSheetIndex,images:e.images==null?null:$.extend(!0,{},e.images),curImages:n})),e.images=$.extend(!0,{},n),nt.saveParam("all",u.currentSheetIndex,e.images,{k:"images"})}},aa={defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1,optionLabel:{number:"",number_integer:"",number_decimal:"",bw:"",nb:"",eq:"",ne:"",gt:"",lt:"",gte:"",lte:"",include:"",exclude:"",equal:"",bf:"",nbf:"",af:"",naf:"",card:"",phone:""},optionLabel_en:{number:"numeric",number_integer:"integer",number_decimal:"decimal",bw:"between",nb:"not between",eq:"equal to",ne:"not equal to",gt:"greater",lt:"less than",gte:"greater or equal to",lte:"less than or equal to",include:"include",exclude:"not include",equal:"equal to",bf:"earlier than",nbf:"not earlier than",af:"later than",naf:"not later than",card:"identification number",phone:"phone number"},createDialog:function(){var e=st(),n=e.dataVerification,t=e.toolbar,a=e.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").remove();var l=`<div class="box">
                            <div class="box-item" style="border-top:1px solid #E1E4E8;">
                                <div class="box-item-title">`.concat(n.cellRange,`</div>
                                <div id="data-verification-range" class="range">
                                    <input class="formulaInputFocus" spellcheck="false">
                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(n.selectCellRange,`"></i>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="box-item-title">`).concat(n.verificationCondition,`</div>
                                <select id="data-verification-type-select">
                                    <option value="dropdown">`).concat(n.dropdown,`</option>
                                    <option value="checkbox">`).concat(n.checkbox,`</option>
                                    <option value="number">`).concat(n.number,`</option>
                                    <option value="number_integer">`).concat(n.number_integer,`</option>
                                    <option value="number_decimal">`).concat(n.number_decimal,`</option>
                                    <option value="text_content">`).concat(n.text_content,`</option>
                                    <option value="text_length">`).concat(n.text_length,`</option>
                                    <option value="date">`).concat(n.date,`</option>
                                    <option value="validity">`).concat(n.validity,`</option>
                                </select>
                                <div class="show-box">
                                    <div class="show-box-item show-box-item-dropdown">
                                        <div class="range">
                                            <input class="formulaInputFocus data-verification-value1" placeholder="`).concat(n.placeholder1,`" spellcheck="false">
                                            <i class="fa fa-table" aria-hidden="true" title="`).concat(n.selectCellRange,`"></i>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-checkbox">
                                        <div class="check-box">
                                            <span>`).concat(n.selected,` </span>
                                            <input type="text" class="data-verification-value1" placeholder="`).concat(n.placeholder2,`">
                                        </div>
                                        <div class="check-box">
                                            <span>`).concat(n.notSelected,` </span>
                                            <input type="text" class="data-verification-value2" placeholder="`).concat(n.placeholder2,`">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-number">
                                        <select id="data-verification-number-select">
                                            <option value="bw">`).concat(n.between,`</option>
                                            <option value="nb">`).concat(n.notBetween,`</option>
                                            <option value="eq">`).concat(n.equal,`</option>
                                            <option value="ne">`).concat(n.notEqualTo,`</option>
                                            <option value="gt">`).concat(n.moreThanThe,`</option>
                                            <option value="lt">`).concat(n.lessThan,`</option>
                                            <option value="gte">`).concat(n.greaterOrEqualTo,`</option>
                                            <option value="lte">`).concat(n.lessThanOrEqualTo,`</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="`).concat(n.placeholder3,`">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-text">
                                        <select id="data-verification-text-select">
                                            <option value="include">`).concat(n.include,`</option>
                                            <option value="exclude">`).concat(n.exclude,`</option>
                                            <option value="equal">`).concat(n.equal,`</option>
                                        </select>
                                        <div class="input input2">
                                            <input type="text" class="data-verification-value1" placeholder="`).concat(n.placeholder4,`"/>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-textLength">
                                        <select id="data-verification-textLength-select">
                                            <option value="bw">`).concat(n.between,`</option>
                                            <option value="nb">`).concat(n.notBetween,`</option>
                                            <option value="eq">`).concat(n.equal,`</option>
                                            <option value="ne">`).concat(n.notEqualTo,`</option>
                                            <option value="gt">`).concat(n.moreThanThe,`</option>
                                            <option value="lt">`).concat(n.lessThan,`</option>
                                            <option value="gte">`).concat(n.greaterOrEqualTo,`</option>
                                            <option value="lte">`).concat(n.lessThanOrEqualTo,`</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="`).concat(n.placeholder3,`">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-date">
                                        <select id="data-verification-date-select">
                                            <option value="bw">`).concat(n.between,`</option>
                                            <option value="nb">`).concat(n.notBetween,`</option>
                                            <option value="eq">`).concat(n.equal,`</option>
                                            <option value="ne">`).concat(n.notEqualTo,`</option>
                                            <option value="bf">`).concat(n.earlierThan,`</option>
                                            <option value="nbf">`).concat(n.noEarlierThan,`</option>
                                            <option value="af">`).concat(n.laterThan,`</option>
                                            <option value="naf">`).concat(n.noLaterThan,`</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                            <span>-</span>
                                            <input type="date" class="data-verification-value2" placeholder="2020/9/10">
                                        </div>
                                        <div class="input input2">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-validity">
                                        <select id="data-verification-validity-select">
                                            <option value="card">`).concat(n.identificationNumber,`</option>
                                            <option value="phone">`).concat(n.phoneNumber,`</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="check">
                                    <input type="checkbox" id="data-verification-remote" class="data-verification-remote">
                                    <label for="data-verification-remote">`).concat(n.remote,`</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-prohibitInput">
                                    <label for="data-verification-prohibitInput">`).concat(n.prohibitInput,`</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-hint-show">
                                    <label for="data-verification-hint-show">`).concat(n.hintShow,`</label>
                                </div>
                                <div class="data-verification-hint-text">
                                    <input type="text" placeholder="`).concat(n.placeholder5,`">
                                </div>
                            </div>
                        </div>`);$("body").append(br(Ga,{id:"luckysheet-dataVerification-dialog",addclass:"luckysheet-dataVerification-dialog",title:t.dataVerification,content:l,botton:'<button id="luckysheet-dataVerification-dialog-confirm" class="btn btn-primary">'.concat(a.confirm,`</button>
                        <button id="luckysheet-dataVerification-dialog-delete" class="btn btn-default">`).concat(n.deleteVerification,`</button>
                        <button class="btn btn-default luckysheet-model-close-btn">`).concat(a.cancel,"</button>"),style:"z-index:100003"}));var o=$("#luckysheet-dataVerification-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),d=o.outerHeight(),s=o.outerWidth(),h=$(window).width(),f=$(window).height(),p=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-dataVerification-dialog").css({left:(h+p-s)/2,top:(f+g-d)/3}).show(),this.dataAllocation()},init:function(){var e=this,n=st().dataVerification;$(document).off("click.dropdownBtn").on("click.dropdownBtn","#luckysheet-dataVerification-dropdown-btn",function(t){e.dropdownListShow(),t.stopPropagation()}),$(document).off("click.dropdownListItem").on("click.dropdownListItem","#luckysheet-dataVerification-dropdown-List .dropdown-List-item",function(t){$("#luckysheet-dataVerification-dropdown-List").hide();var a=t.target.innerText,l=u.luckysheet_select_save[u.luckysheet_select_save.length-1],o=l.row_focus,d=l.column_focus;$("#luckysheet-rich-text-editor").text(a),m.updatecell(o,d),t.stopPropagation()}),$(document).off("click.dvRange").on("click.dvRange","#data-verification-range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();var a=$(this).siblings("input").val().trim();e.rangeDialog("0",a),e.selectRange=[];var l=e.getRangeByTxt(a);if(m.rangetosheet=u.currentSheetIndex,l[0].sheetIndex!=u.currentSheetIndex&&ir.changeSheetExec(l[0].sheetIndex),l.length>0)for(var o=0;o<l.length;o++){var d=l[o].row[0],s=l[o].row[1],h=l[o].column[0],f=l[o].column[1],p=u.visibledatarow[s],g=d-1==-1?0:u.visibledatarow[d-1],v=u.visibledatacolumn[f],y=h-1==-1?0:u.visibledatacolumn[h-1];e.selectRange.push({left:y,width:v-y-1,top:g,height:p-g-1,left_move:y,width_move:v-y-1,top_move:g,height_move:p-g-1,row:[d,s],column:[h,f],row_focus:d,column_focus:h})}pn(e.selectRange)}),$(document).off("click.dvRange2").on("click.dvRange2","#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();var a=$(this).siblings("input").val().trim();e.rangeDialog("1",a),e.selectRange=[];var l=e.getRangeByTxt(a);if(m.rangetosheet=u.currentSheetIndex,l[0].sheetIndex!=u.currentSheetIndex&&ir.changeSheetExec(l[0].sheetIndex),l.length>0)for(var o=0;o<l.length;o++){var d=l[o].row[0],s=l[o].row[1],h=l[o].column[0],f=l[o].column[1],p=u.visibledatarow[s],g=d-1==-1?0:u.visibledatarow[d-1],v=u.visibledatacolumn[f],y=h-1==-1?0:u.visibledatacolumn[h-1];e.selectRange.push({left:y,width:v-y-1,top:g,height:p-g-1,left_move:y,width_move:v-y-1,top_move:g,height_move:p-g-1,row:[d,s],column:[h,f],row_focus:d,column_focus:h})}pn(e.selectRange)}),$(document).off("click.dvRangeConfirm").on("click.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(t){var a=$(this).attr("data-source"),l=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val();e.getRangeByTxt(l).length>1?Ee.info('<i class="fa fa-exclamation-triangle"></i>',""):(a=="0"?$("#luckysheet-dataVerification-dialog #data-verification-range input").val(l):a=="1"&&$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input").val(l),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),m.rangetosheet!=null&&m.rangetosheet!=u.currentSheetIndex&&(ir.changeSheetExec(m.rangetosheet),m.rangetosheet=null),pn([]))}),$(document).off("click.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),m.rangetosheet!=null&&m.rangetosheet!=u.currentSheetIndex&&(ir.changeSheetExec(m.rangetosheet),m.rangetosheet=null),pn([])}),$(document).on("click","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),m.rangetosheet!=null&&m.rangetosheet!=u.currentSheetIndex&&(ir.changeSheetExec(m.rangetosheet),m.rangetosheet=null),pn([])}),$(document).off("change.typeSelect").on("change.typeSelect","#data-verification-type-select",function(t){$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide();var a=this.value,l=e.curItem;if(a=="dropdown"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show();var o="";a==l.type&&(o=l.value1),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(o)}else if(a=="checkbox"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show();var d="",s="";a==l.type&&(d=l.value1,s=l.value2),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(d),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s)}else if(a=="number"||a=="number_integer"||a=="number_decimal"){$("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();var h="bw",f="",p="";l.type!="number"&&l.type!="number_integer"&&l.type!="number_decimal"||(h=l.type2,f=l.value1,p=l.value2),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(h),h=="bw"||h=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(f),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(p)}else if(a=="text_content"){$("#luckysheet-dataVerification-dialog .show-box-item-text").show();var g="include",v="";a==l.type&&(g=l.type2,v=l.value1),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(g),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(v)}else if(a=="text_length"){$("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();var y="bw",b="",k="";a==l.type&&(y=l.type2,b=l.value1,k=l.value2),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(y),y=="bw"||y=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(b),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(k)}else if(a=="date"){$("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();var w="bw",_="",C="";a==l.type&&(w=l.type2,_=l.value1,C=l.value2),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(w),w=="bw"||w=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(_),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(C)}else if(a=="validity"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show();var A="card";a==l.type&&(A=l.type2),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(A)}}),$(document).off("change.numberSelect").on("change.numberSelect","#data-verification-number-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();var a=this.value;a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show()}),$(document).off("change.dateSelect").on("change.dateSelect","#data-verification-date-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();var a=this.value;a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show()}),$(document).off("change.hintShow").on("change.hintShow","#data-verification-hint-show",function(t){this.checked?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide()}),$(document).off("click.dvSaveConfirm").on("click.dvSaveConfirm","#luckysheet-dataVerification-dialog-confirm",function(t){var a=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),l=e.getRangeByTxt(a);if(l.length!=0){var o=l[l.length-1].row[0],d=l[l.length-1].row[1],s=l[l.length-1].column[0],h=l[l.length-1].column[1],f=vr.deepCopyFlowData(u.flowdata);o<0&&(o=0),d>f.length-1&&(d=f.length-1),s<0&&(s=0),h>f[0].length-1&&(h=f[0].length-1);var p=$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(),g=null,v="",y="";if(p=="dropdown"){if((v=$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val().trim()).length==0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo1)}else if(p=="checkbox"){if(v=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val().trim(),y=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val().trim(),v.length==0||y.length==0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo2)}else if(p=="number"||p=="number_integer"||p=="number_decimal"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(),!M(v=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1").val().trim()))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);if(g=="bw"||g=="nb"){if(!M(y=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2").val().trim()))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);if(Number(y)<Number(v))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4)}}else if(p=="text_content"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(),(v=$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val().trim()).length==0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo5)}else if(p=="text_length"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(),!M(v=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1").val().trim()))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);if(g=="bw"||g=="nb"){if(!M(y=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2").val().trim()))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);if(Number(y)<Number(v))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4)}}else if(p=="date"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(),!un(v=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1").val().trim()))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);if(g=="bw"||g=="nb"){if(!un(y=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2").val().trim()))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);if(il(v,y)>0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo7)}}else p=="validity"&&(g=$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val());var b=$("#luckysheet-dataVerification-dialog #data-verification-remote").is(":checked"),k=$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").is(":checked"),w=$("#luckysheet-dataVerification-dialog #data-verification-hint-show").is(":checked"),_="";w&&(_=$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val().trim());for(var C={type:p,type2:g,value1:v,value2:y,checked:!1,remote:b,prohibitInput:k,hintShow:w,hintText:_},A=$.extend(!0,{},e.dataVerification),I=$.extend(!0,{},e.dataVerification),S=o;S<=d;S++)for(var E=s;E<=h;E++)I[S+"_"+E]=C,p=="checkbox"&&Ln(S,E,f,C.value2);p=="checkbox"?e.refOfCheckbox(A,I,u.currentSheetIndex,f,l[l.length-1]):e.ref(A,I,u.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}else Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2)}),$(document).off("click.delete").on("click.delete","#luckysheet-dataVerification-dialog-delete",function(t){var a=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),l=e.getRangeByTxt(a);if(l.length!=0){for(var o=$.extend(!0,{},e.dataVerification),d=$.extend(!0,{},e.dataVerification),s=l[l.length-1].row[0],h=l[l.length-1].row[1],f=l[l.length-1].column[0],p=l[l.length-1].column[1],g=s;g<=h;g++)for(var v=f;v<=p;v++)delete d[g+"_"+v];e.ref(o,d,u.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}else Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2)}),$(document).on("click","#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn",function(t){$(this).parents("#luckysheet-info").hide(),$("#luckysheet-dataVerification-dialog").is(":visible")&&$("#luckysheet-modal-dialog-mask").show(),t.stopPropagation()})},dataAllocation:function(){var e=u.luckysheet_select_save[u.luckysheet_select_save.length-1],n=wn(u.currentSheetIndex,e,u.currentSheetIndex);$("#luckysheet-dataVerification-dialog #data-verification-range input").val(n);var t=e.row_focus||e.row[0],a=e.column_focus||e.column[0],l=$.extend(!0,{},this.dataVerification)[t+"_"+a];l==null&&(l=$.extend(!0,{},this.defaultItem)),this.curItem=l,$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(l.type),$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide(),l.type=="dropdown"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show(),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(l.value1)):l.type=="checkbox"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show(),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(l.value1),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(l.value2)):l.type=="number"||l.type=="number_integer"||l.type=="number_decimal"?($("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(l.type2),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide(),l.type2=="bw"||l.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(l.value1),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(l.value2)):l.type=="text_content"?($("#luckysheet-dataVerification-dialog .show-box-item-text").show(),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(l.type2),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(l.value1)):l.type=="text_length"?($("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(l.type2),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide(),l.type2=="bw"||l.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(l.value1),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(l.value2)):l.type=="date"?($("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(l.type2),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide(),l.type2=="bw"||l.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(l.value1),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(l.value2)):l.type=="validity"&&($("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show(),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(l.type2)),$("#luckysheet-dataVerification-dialog #data-verification-remote").prop("checked",l.remote),$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").prop("checked",l.prohibitInput),$("#luckysheet-dataVerification-dialog #data-verification-hint-show").prop("checked",l.hintShow),l.hintShow?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide(),$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val(l.hintText)},rangeDialog:function(e,n){var t=st(),a=t.dataVerification,l=t.button;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerificationRange-dialog").remove(),$("body").append(br(Ga,{id:"luckysheet-dataVerificationRange-dialog",addclass:"luckysheet-dataVerificationRange-dialog",title:a.selectCellRange,content:'<input readonly="readonly" placeholder="'.concat(a.selectCellRange2,'" value="').concat(n,'"/>'),botton:'<button id="luckysheet-dataVerificationRange-dialog-confirm" class="btn btn-primary" data-source="'.concat(e,'">').concat(l.confirm,`</button>
                        <button id="luckysheet-dataVerificationRange-dialog-close" class="btn btn-default">`).concat(l.close,"</button>"),style:"z-index:100003"}));var o=$("#luckysheet-dataVerificationRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=o.outerHeight(),s=o.outerWidth(),h=$(window).width(),f=$(window).height(),p=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-dataVerificationRange-dialog").css({left:(h+p-s)/2,top:(f+g-d)/3}).show()},getTxtByRange:function(e){if(e.length>0){for(var n=[],t=0;t<e.length;t++){var a=e[t].row[0],l=e[t].row[1],o=e[t].column[0],d=e[t].column[1];n.push(wn(u.currentSheetIndex,{row:[a,l],column:[o,d]},u.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){var n=[];if(e.indexOf(",")!=-1)for(var t=e.split(","),a=0;a<t.length;a++){if(!m.iscelldata(t[a])){n=[];break}n.push(m.getcellrange(t[a]))}else m.iscelldata(e)&&n.push(m.getcellrange(e));return n},cellFocus:function(e,n,t){if($("#luckysheet-dataVerification-dropdown-btn").hide(),$("#luckysheet-dataVerification-showHintBox").hide(),this.dataVerification!=null&&this.dataVerification[e+"_"+n]!=null){var a=u.visibledatarow[e],l=e==0?0:u.visibledatarow[e-1],o=u.visibledatacolumn[n],d=n==0?0:u.visibledatacolumn[n-1],s=dr.mergeborer(u.flowdata,e,n);s&&(a=s.row[1],l=s.row[0],o=s.column[1],d=s.column[0]);var h=this.dataVerification[e+"_"+n];if(t&&h.type=="checkbox")this.checkboxChange(e,n);else{var f;if(h.type=="dropdown"?($("#luckysheet-dataVerification-dropdown-btn").show().css({"max-width":o-d,"max-height":a-l,left:o-20,top:l+(a-l-20)/2}),$("#luckysheet-dataVerification-dropdown-List").is(":visible")&&$("#luckysheet-dataVerification-dropdown-List").prop("data-index")!=e+"_"+n&&$("#luckysheet-dataVerification-dropdown-List").hide()):$("#luckysheet-dataVerification-dropdown-List").hide(),h.hintShow)return f=u.lang=="en"?'<span style="color:#f5a623;">Hint: </span>':'<span style="color:#f5a623;"></span>',f+=this.getHintText(h),void $("#luckysheet-dataVerification-showHintBox").html(f).show().css({left:d,top:a});var p,g=Hr(e,n,null);$t(g)||this.validateCellData(g,h)||(p=u.lang=="en"?'<span style="color:#f72626;">Failure: </span>':'<span style="color:#f72626;"></span>',p+=this.getFailureText(h),$("#luckysheet-dataVerification-showHintBox").html(p).show().css({left:d,top:a}))}}else $("#luckysheet-dataVerification-dropdown-List").hide()},getHintText:function(e){var n=e.hintText||"";return n.length==0&&(u.lang=="en"?e.type=="dropdown"?n+="please select an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(n+="please enter a "+this.optionLabel_en[e.type]+" "+this.optionLabel_en[e.type2]+" "+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=" and "+e.value2)):e.type=="text_content"?n+="please enter text "+this.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(n+="please enter text with length "+this.optionLabel_en[e.type2]+" "+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=" and "+e.value2)):e.type=="date"?(n+="please enter a date "+this.optionLabel_en[e.type2]+" "+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=" and "+e.value2)):e.type=="validity"&&(n+="please enter the correct "+this.optionLabel_en[e.type2])):e.type=="dropdown"?n+="":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(n+=""+this.optionLabel[e.type2]+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=""+e.value2+""),n+=""+this.optionLabel[e.type]):e.type=="text_content"?n+=""+this.optionLabel[e.type2]+e.value1+"":e.type=="text_length"?(n+=""+this.optionLabel[e.type2]+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=""+e.value2+""),n+=""):e.type=="date"?(n+=""+this.optionLabel[e.type2]+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=""+e.value2+""),n+=""):e.type=="validity"&&(n+=""+this.optionLabel[e.type2]))),n},getFailureText:function(e){var n="";return u.lang=="en"?e.type=="dropdown"?n+="what you selected is not an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(n+="what you entered is not a "+this.optionLabel_en[e.type]+" "+this.optionLabel_en[e.type2]+" "+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=" and "+e.value2)):e.type=="text_content"?n+="what you entered is not text that "+this.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(n+="the text you entered is not length "+this.optionLabel_en[e.type2]+" "+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=" and "+e.value2)):e.type=="date"?(n+="the date you entered is not "+this.optionLabel_en[e.type2]+" "+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=" and "+e.value2)):e.type=="validity"&&(n+="what you entered is not a correct "+this.optionLabel_en[e.type2])):e.type=="dropdown"?n+="":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(n+=""+this.optionLabel[e.type2]+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=""+e.value2+""),n+=""+this.optionLabel[e.type]):e.type=="text_content"?n+=""+this.optionLabel[e.type2]+e.value1+"":e.type=="text_length"?(n+=""+this.optionLabel[e.type2]+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=""+e.value2+""),n+=""):e.type=="date"?(n+=""+this.optionLabel[e.type2]+e.value1,e.type2!="bw"&&e.type2!="nb"||(n+=""+e.value2+""),n+=""):e.type=="validity"&&(n+=""+this.optionLabel[e.type2])),n},validateCellData:function(e,n){var t=n.type,a=n.type2,l=n.value1,o=n.value2;if(t=="dropdown"){for(var d=this.getDropdownList(l),s=!1,h=0;h<d.length;h++)if(d[h]==e){s=!0;break}return s}if(t!="checkbox"){if(t=="number"||t=="number_integer"||t=="number_decimal"){if(!M(e)||(e=Number(e),t=="number_integer"&&e%1!=0)||t=="number_decimal"&&e%1==0||(l=Number(l),o=Number(o),a=="bw"&&(e<l||e>o))||a=="nb"&&e>=l&&e<=o||a=="eq"&&e!=l||a=="ne"&&e==l||a=="gt"&&e<=l||a=="lt"&&e>=l||a=="gte"&&e<l||a=="lte"&&e>l)return!1}else if(t=="text_content"){if(e=e.toString(),l=l.toString(),a=="include"&&e.indexOf(l)==-1||a=="exclude"&&e.indexOf(l)>-1||a=="equal"&&e!=l)return!1}else if(t=="text_length"){if(e=e.toString().length,l=Number(l),o=Number(o),a=="bw"&&(e<l||e>o)||a=="nb"&&e>=l&&e<=o||a=="eq"&&e!=l||a=="ne"&&e==l||a=="gt"&&e<=l||a=="lt"&&e>=l||a=="gte"&&e<l||a=="lte"&&e>l)return!1}else if(t=="date"){if(!un(e)||a=="bw"&&(il(e,l)<0||il(e,o)>0)||a=="nb"&&il(e,l)>=0&&il(e,o)<=0||a=="eq"&&il(e,l)!=0||a=="ne"&&il(e,l)==0||a=="bf"&&il(e,l)>=0||a=="nbf"&&il(e,l)<0||a=="af"&&il(e,l)<=0||a=="naf"&&il(e,l)>0)return!1}else if(t=="validity"&&(a=="card"&&!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e)||a=="phone"&&!/^[1][3,4,5,7,8][0-9]{9}$/.test(e)))return!1}return!0},dropdownListShow:function(){$("#luckysheet-dataVerification-showHintBox").hide();var e=u.luckysheet_select_save[u.luckysheet_select_save.length-1],n=e.row_focus,t=e.column_focus,a=u.visibledatarow[n],l=n==0?0:u.visibledatarow[n-1],o=u.visibledatacolumn[t],d=t==0?0:u.visibledatacolumn[t-1],s=dr.mergeborer(u.flowdata,n,t);s&&(a=s.row[1],l=s.row[0],o=s.column[1],d=s.column[0]);var h=this.dataVerification[n+"_"+t],f=this.getDropdownList(h.value1),p="";f.forEach(function(v){p+='<div class="dropdown-List-item luckysheet-mousedown-cancel">'.concat(v,"</div>")}),$("#luckysheet-dataVerification-dropdown-List").html(p).prop("data-index",n+"_"+t).show().css({width:o-d-1,left:d,top:a});var g=$("#luckysheet-dataVerification-dropdown-List").outerHeight();a+g>$("#luckysheet-cell-main")[0].scrollHeight-42-6&&$("#luckysheet-dataVerification-dropdown-List").css({top:l-g})},getDropdownList:function(e){var n=[];if(m.iscelldata(e)){for(var t=m.getcellrange(e),a=u.luckysheetfile[je(t.sheetIndex)].data,l=t.row[0];l<=t.row[1];l++)for(var o=t.column[0];o<=t.column[1];o++)if(a[l]!=null){var d=a[l][o];if(d!=null&&d.v!=null){var s=d.m||d.v;n.includes(s)||n.push(s)}}}else for(var h=e.split(","),f=0;f<h.length;f++){var p=h[f];p.length!=0&&(n.includes(p)||n.push(p))}return n},checkboxChange:function(e,n){var t=$.extend(!0,{},this.dataVerification),a=$.extend(!0,{},this.dataVerification),l=a[e+"_"+n];l.checked=!l.checked;var o=l.value2;l.checked&&(o=l.value1);var d=vr.deepCopyFlowData(u.flowdata);Ln(e,n,d,o),this.refOfCheckbox(t,a,u.currentSheetIndex,d,{row:[e,e],column:[n,n]})},ref:function(e,n,t){if(u.clearjfundo){u.jfundo.length=0;var a={type:"updateDataVerification"};a.sheetIndex=t,a.historyDataVerification=e,a.currentDataVerification=n,u.jfredo.push(a)}this.dataVerification=n,u.luckysheetfile[je(t)].dataVerification=n,nt.allowUpdate&&nt.saveParam("all",t,n,{k:"dataVerification"}),setTimeout(function(){Kr()},1)},refOfCheckbox:function(e,n,t,a,l){if(u.clearjfundo){u.jfundo.length=0;var o={type:"updateDataVerificationOfCheckbox"};o.sheetIndex=t,o.historyDataVerification=e,o.currentDataVerification=n,o.data=u.flowdata,o.curData=a,o.range=l,u.jfredo.push(o)}this.dataVerification=n,u.luckysheetfile[je(t)].dataVerification=n,u.flowdata=a,vr.webWorkerFlowDataCache(u.flowdata),u.luckysheetfile[je(t)].data=u.flowdata,nt.allowUpdate&&(nt.saveParam("all",t,n,{k:"dataVerification"}),nt.historyParam(u.flowdata,t,l)),setTimeout(function(){Kr()},1)}};function Ls(e,n,t,a,l){if(l=l||u.currentSheetIndex,(e!="row"||dn(l,"insertRows"))&&(e!="column"||dn(l,"insertColumns"))){var o=je(l),d=u.luckysheetfile[o],s=$.extend(!0,[],d.data);t=Math.floor(t);var h=$.extend(!0,{},d.config);h.merge==null&&(h.merge={});var f={};for(var p in h.merge){var g=h.merge[p],v=g.r,y=g.c,b=g.rs,k=g.cs;e=="row"?n<v?f[v+t+"_"+y]={r:v+t,c:y,rs:b,cs:k}:n==v?a=="lefttop"?f[v+t+"_"+y]={r:v+t,c:y,rs:b,cs:k}:f[v+"_"+y]={r:v,c:y,rs:b+t,cs:k}:f[v+"_"+y]=n<v+b-1||n==v+b-1&&a=="lefttop"?{r:v,c:y,rs:b+t,cs:k}:{r:v,c:y,rs:b,cs:k}:e=="column"&&(n<y?f[v+"_"+(y+t)]={r:v,c:y+t,rs:b,cs:k}:n==y?a=="lefttop"?f[v+"_"+(y+t)]={r:v,c:y+t,rs:b,cs:k}:f[v+"_"+y]={r:v,c:y,rs:b,cs:k+t}:f[v+"_"+y]=n<y+k-1||n==y+k-1&&a=="lefttop"?{r:v,c:y,rs:b,cs:k+t}:{r:v,c:y,rs:b,cs:k})}h.merge=f;var w=d.calcChain,_=[];if(w!=null&&w.length>0)for(var C=0;C<w.length;C++){var A=$.extend(!0,{},w[C]),I=A.r,S=A.c,E=pi(I,S,A.index);if(e=="row"){var R="="+m.functionStrChange(E,"add","row",a,n,t);s[I][S]&&s[I][S].f==E&&(s[I][S].f=R),a=="lefttop"?I>=n&&(A.r+=t):a=="rightbottom"&&I>n&&(A.r+=t),_.push(A)}else if(e=="column"){var F="="+m.functionStrChange(E,"add","col",a,n,t);s[I][S]&&s[I][S].f==E&&(s[I][S].f=F),a=="lefttop"?S>=n&&(A.c+=t):a=="rightbottom"&&S>n&&(A.c+=t),_.push(A)}}var N=d.filter_select,z=d.filter,P=null;if(N!=null&&JSON.stringify(N)!="{}"){P={filter_select:null,filter:null};var q=N.row[0],V=N.row[1],x=N.column[0],ee=N.column[1];if(e=="row"){if(q<n?(V==n&&a=="lefttop"||V>n)&&(V+=t):q==n?a=="lefttop"?(q+=t,V+=t):a=="rightbottom"&&V>n&&(V+=t):(q+=t,V+=t),z!=null)for(var ne in P.filter={},z){var ae=z[ne].rowhidden,de={};for(var ve in ae)(ve=parseFloat(ve))<n?de[ve]=0:ve==n?a=="lefttop"?de[ve+t]=0:a=="rightbottom"&&(de[ve]=0):de[ve+t]=0;P.filter[ne]=$.extend(!0,{},z[ne]),P.filter[ne].rowhidden=de,P.filter[ne].str=q,P.filter[ne].edr=V}}else if(e=="column"&&(x<n?(ee==n&&a=="lefttop"||ee>n)&&(ee+=t):x==n?a=="lefttop"?(x+=t,ee+=t):a=="rightbottom"&&ee>n&&(ee+=t):(x+=t,ee+=t),z!=null))for(var U in P.filter={},z){var B=z[U].cindex;(B==n&&a=="lefttop"||B>n)&&(B+=t),P.filter[B-x]=$.extend(!0,{},z[U]),P.filter[B-x].cindex=B,P.filter[B-x].stc=x,P.filter[B-x].edc=ee}P.filter_select={row:[q,V],column:[x,ee]}}if(P!=null&&P.filter!=null)for(var le in h.rowhidden==null&&(h.rowhidden={}),P.filter){var Te=P.filter[le].rowhidden;for(var ue in Te)h.rowhidden[ue]=0}var be=d.luckysheet_conditionformat_save,ye=[];if(be!=null&&be.length>0)for(var ce=0;ce<be.length;ce++){for(var Re=be[ce].cellrange,pe=[],me=0;me<Re.length;me++){var re=Re[me].row[0],_e=Re[me].row[1],Ze=Re[me].column[0],We=Re[me].column[1];e=="row"?re<n?(_e==n&&a=="lefttop"||_e>n)&&(_e+=t):re==n?a=="lefttop"?(re+=t,_e+=t):a=="rightbottom"&&_e>n&&(_e+=t):(re+=t,_e+=t):e=="column"&&(Ze<n?(We==n&&a=="lefttop"||We>n)&&(We+=t):Ze==n?a=="lefttop"?(Ze+=t,We+=t):a=="rightbottom"&&We>n&&(We+=t):(Ze+=t,We+=t)),pe.push({row:[re,_e],column:[Ze,We]})}var Xe=$.extend(!0,{},be[ce]);Xe.cellrange=pe,ye.push(Xe)}var Ue=d.luckysheet_alternateformat_save,mt=[];if(Ue!=null&&Ue.length>0)for(var St=0;St<Ue.length;St++){var at=Ue[St].cellrange.row[0],dt=Ue[St].cellrange.row[1],wt=Ue[St].cellrange.column[0],ct=Ue[St].cellrange.column[1],bt=$.extend(!0,{},Ue[St]);e=="row"?at<n?(dt==n&&a=="lefttop"||dt>n)&&(dt+=t):at==n?a=="lefttop"?(at+=t,dt+=t):a=="rightbottom"&&dt>n&&(dt+=t):(at+=t,dt+=t):e=="column"&&(wt<n?(ct==n&&a=="lefttop"||ct>n)&&(ct+=t):wt==n?a=="lefttop"?(wt+=t,ct+=t):a=="rightbottom"&&ct>n&&(ct+=t):(wt+=t,ct+=t)),bt.cellrange={row:[at,dt],column:[wt,ct]},mt.push(bt)}var De={freezenhorizontaldata:null,freezenverticaldata:null};if(Ne.freezenhorizontaldata!=null&&e=="row"){var He=Ne.freezenhorizontaldata[2],Dt=Ne.freezenhorizontaldata[1]-1;(Dt==n&&a=="lefttop"||Dt>n)&&(Dt+=t);var et=u.visibledatarow[Dt]-2-He+u.columnHeaderHeight;De.freezenhorizontaldata=[u.visibledatarow[Dt],Dt+1,He,Ne.cutVolumn(u.visibledatarow,Dt+1),et]}else De.freezenhorizontaldata=Ne.freezenhorizontaldata;if(Ne.freezenverticaldata!=null&&e=="column"){var ur=Ne.freezenverticaldata[2],Xt=Ne.freezenverticaldata[1]-1;(Xt==n&&a=="lefttop"||Xt>n)&&(Xt+=t);var jt=u.visibledatacolumn[Xt]-2-ur+u.rowHeaderWidth;De.freezenverticaldata=[u.visibledatacolumn[Xt],Xt+1,ur,Ne.cutVolumn(u.visibledatacolumn,Xt+1),jt]}else De.freezenverticaldata=Ne.freezenverticaldata;var lr=d.dataVerification,tr={};if(lr!=null)for(var xr in lr){var rr=Number(xr.split("_")[0]),nr=Number(xr.split("_")[1]),Ut=lr[xr];if(e=="row")if(n<rr)tr[rr+t+"_"+nr]=Ut;else if(n==rr)if(a=="lefttop"){tr[rr+t+"_"+nr]=Ut;for(var ar=0;ar<t;ar++)tr[rr+ar+"_"+nr]=Ut}else{tr[rr+"_"+nr]=Ut;for(var Jt=0;Jt<t;Jt++)tr[rr+Jt+1+"_"+nr]=Ut}else tr[rr+"_"+nr]=Ut;else if(e=="column")if(n<nr)tr[rr+"_"+(nr+t)]=Ut;else if(n==nr)if(a=="lefttop"){tr[rr+"_"+(nr+t)]=Ut;for(var Qt=0;Qt<t;Qt++)tr[rr+"_"+(nr+Qt)]=Ut}else{tr[rr+"_"+nr]=Ut;for(var _t=0;_t<t;_t++)tr[rr+"_"+(nr+_t+1)]=Ut}else tr[rr+"_"+nr]=Ut}var er,Kt=d.hyperlink,mr={};if(Kt!=null)for(var fr in Kt){var Wt=Number(fr.split("_")[0]),ze=Number(fr.split("_")[1]),Ae=Kt[fr];e=="row"?n<Wt||n==Wt&&a=="lefttop"?mr[Wt+t+"_"+ze]=Ae:mr[Wt+"_"+ze]=Ae:e=="column"&&(n<ze||n==ze&&a=="lefttop"?mr[Wt+"_"+(ze+t)]=Ae:mr[Wt+"_"+ze]=Ae)}if(e=="row"){if(er="r",h.rowlen!=null){var Ve={};for(var gt in h.rowlen)(gt=parseFloat(gt))<n?Ve[gt]=h.rowlen[gt]:gt==n?a=="lefttop"?Ve[gt+t]=h.rowlen[gt]:a=="rightbottom"&&(Ve[gt]=h.rowlen[gt]):Ve[gt+t]=h.rowlen[gt];h.rowlen=Ve}if(h.rowhidden!=null){var vt={};for(var pt in h.rowhidden)(pt=parseFloat(pt))<n?vt[pt]=h.rowhidden[pt]:pt==n?a=="lefttop"?vt[pt+t]=h.rowhidden[pt]:a=="rightbottom"&&(vt[pt]=h.rowhidden[pt]):vt[pt+t]=h.rowhidden[pt];h.rowhidden=vt}for(var Tt=[],Ot=0;Ot<s[0].length;Ot++)Tt.push(null);if(h.borderInfo&&h.borderInfo.length>0){for(var It=[],Lt=0;Lt<h.borderInfo.length;Lt++){var At=h.borderInfo[Lt].rangeType;if(At=="range"){for(var or=h.borderInfo[Lt].range,Cr=[],Ar=0;Ar<or.length;Ar++){var Rr=or[Ar].row[0],Zr=or[Ar].row[1];a=="lefttop"?n<=Rr?(Rr+=t,Zr+=t):n<=Zr&&(Zr+=t):n<Rr?(Rr+=t,Zr+=t):n<Zr&&(Zr+=t),Zr>=Rr&&Cr.push({row:[Rr,Zr],column:or[Ar].column})}if(Cr.length>0){var Tr={rangeType:"range",borderType:h.borderInfo[Lt].borderType,style:h.borderInfo[Lt].style,color:h.borderInfo[Lt].color,range:Cr};It.push(Tr)}}else if(At=="cell"){var jr=h.borderInfo[Lt].value.row_index;a=="lefttop"?n<=jr&&(jr+=t):n<jr&&(jr+=t),h.borderInfo[Lt].value.row_index=jr,It.push(h.borderInfo[Lt])}}h.borderInfo=It}for(var ta=[],ia=0;ia<t;ia++)ta.push(JSON.stringify(Tt));a=="lefttop"?n==0?new Function("d","return d.unshift("+ta.join(",")+")")(s):new Function("d","return d.splice("+n+", 0, "+ta.join(",")+")")(s):new Function("d","return d.splice("+(n+1)+", 0, "+ta.join(",")+")")(s)}else{if(er="c",h.columnlen!=null){var Jr={};for(var ba in h.columnlen)(ba=parseFloat(ba))<n?Jr[ba]=h.columnlen[ba]:ba==n?a=="lefttop"?Jr[ba+t]=h.columnlen[ba]:a=="rightbottom"&&(Jr[ba]=h.columnlen[ba]):Jr[ba+t]=h.columnlen[ba];h.columnlen=Jr}if(h.colhidden!=null){var Wr={};for(var Fr in h.colhidden)(Fr=parseFloat(Fr))<n?Wr[Fr]=h.colhidden[Fr]:Fr==n?a=="lefttop"?Wr[Fr+t]=h.colhidden[Fr]:a=="rightbottom"&&(Wr[Fr]=h.colhidden[Fr]):Wr[Fr+t]=h.colhidden[Fr];h.colhidden=Wr}for(var oa=[],Fa=0;Fa<s.length;Fa++)oa.push(null);if(h.borderInfo&&h.borderInfo.length>0){for(var Da=[],va=0;va<h.borderInfo.length;va++){var Ha=h.borderInfo[va].rangeType;if(Ha=="range"){for(var qr=h.borderInfo[va].range,Ca=[],La=0;La<qr.length;La++){var Ea=qr[La].column[0],Za=qr[La].column[1];a=="lefttop"?n<=Ea?(Ea+=t,Za+=t):n<=Za&&(Za+=t):n<Ea?(Ea+=t,Za+=t):n<Za&&(Za+=t),Za>=Ea&&Ca.push({row:qr[La].row,column:[Ea,Za]})}if(Ca.length>0){var gn={rangeType:"range",borderType:h.borderInfo[va].borderType,style:h.borderInfo[va].style,color:h.borderInfo[va].color,range:Ca};Da.push(gn)}}else if(Ha=="cell"){var Ka=h.borderInfo[va].value.col_index;a=="lefttop"?n<=Ka&&(Ka+=t):n<Ka&&(Ka+=t),h.borderInfo[va].value.col_index=Ka,Da.push(h.borderInfo[va])}}h.borderInfo=Da}for(var ka=0;ka<s.length;ka++)for(var Pa=s[ka],$a=0;$a<t;$a++)a=="lefttop"?n==0?Pa.unshift(oa[ka]):Pa.splice(n,0,oa[ka]):Pa.splice(n+1,0,oa[ka])}d.index==u.currentSheetIndex?wu(s,h,"addRC",{index:n,len:t,direction:a,rc:er,restore:!1},_,P,ye,mt,De,tr,mr):(d.data=s,d.config=h,d.calcChain=_,d.filter=P.filter,d.filter_select=P.filter_select,d.luckysheet_conditionformat_save=ye,d.luckysheet_alternateformat_save=mt,d.dataVerification=tr,d.hyperlink=mr);var on=null;if(on=e=="row"?a=="lefttop"?[{row:[n,n+t-1],column:[0,s[0].length-1]}]:[{row:[n+1,n+t],column:[0,s[0].length-1]}]:a=="lefttop"?[{row:[0,s.length-1],column:[n,n+t-1]}]:[{row:[0,s.length-1],column:[n+1,n+t]}],d.luckysheet_select_save=on,d.index==u.currentSheetIndex&&(u.luckysheet_select_save=on,Ra()),e=="row"){$("#luckysheet-cell-main").scrollLeft();var Dn=$("#luckysheet-cell-main").scrollTop(),Fn=$("#luckysheet-cell-main").height(),_n=($("#luckysheet-cell-main").width(),u.visibledatarow[on[0].row[1]]),dl=on[0].row[0]-1==-1?0:u.visibledatarow[on[0].row[0]-1];_n-Dn-Fn+20>0?$("#luckysheet-scrollbar-y").scrollTop(_n-Fn+20):dl-Dn-20<0&&$("#luckysheet-scrollbar-y").scrollTop(dl-20),t>30&&($("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide())}}}function kc(e,n,t,a){if(a=a||u.currentSheetIndex,(e!="row"||dn(a,"deleteRows"))&&(e!="column"||dn(a,"deleteColumns"))){var l=je(a),o=u.luckysheetfile[l],d=$.extend(!0,[],o.data);if(n<0&&(n=0),t<0&&(t=0),e=="row"?(n>d.length-1&&(n=d.length-1),t>d.length-1&&(t=d.length-1)):(n>d[0].length-1&&(n=d[0].length-1),t>d[0].length-1&&(t=d[0].length-1)),!(n>t)){var s=t-n+1,h=$.extend(!0,{},o.config);h.merge==null&&(h.merge={});var f={};for(var p in h.merge){var g=h.merge[p],v=g.r,y=g.c,b=g.rs,k=g.cs;e=="row"?v<n?v+b-1<n?f[v+"_"+y]={r:v,c:y,rs:b,cs:k}:v+b-1>=n&&v+b-1<t?f[v+"_"+y]={r:v,c:y,rs:n-v,cs:k}:v+b-1>=t&&(f[v+"_"+y]={r:v,c:y,rs:b-s,cs:k}):v>=n&&v<=t?v+b-1>t&&(f[n+"_"+y]={r:n,c:y,rs:v+b-1-t,cs:k}):v>t&&(f[v-s+"_"+y]={r:v-s,c:y,rs:b,cs:k}):e=="column"&&(y<n?y+k-1<n?f[v+"_"+y]={r:v,c:y,rs:b,cs:k}:y+k-1>=n&&y+k-1<t?f[v+"_"+y]={r:v,c:y,rs:b,cs:n-y}:y+k-1>=t&&(f[v+"_"+y]={r:v,c:y,rs:b,cs:k-s}):y>=n&&y<=t?y+k-1>t&&(f[v+"_"+n]={r:v,c:n,rs:b,cs:y+k-1-t}):y>t&&(f[v+"_"+(y-s)]={r:v,c:y-s,rs:b,cs:k}))}h.merge=f;var w=o.calcChain,_=[];if(w!=null&&w.length>0)for(var C=0;C<w.length;C++){var A=$.extend(!0,{},w[C]),I=A.r,S=A.c,E=pi(I,S,A.index);if(e=="row"){if(I<n||I>t){var R="="+m.functionStrChange(E,"del","row",null,n,s);d[I][S]&&d[I][S].f==E&&(d[I][S].f=R),I>t&&(A.r=I-s),_.push(A)}}else if(e=="column"&&(S<n||S>t)){var F="="+m.functionStrChange(E,"del","col",null,n,s);d[I][S]&&d[I][S].f==E&&(d[I][S].f=F),S>t&&(A.c=S-s),_.push(A)}}var N=o.filter_select,z=o.filter,P=null;if(N!=null&&JSON.stringify(N)!="{}"){P={filter_select:null,filter:null};var q=N.row[0],V=N.row[1],x=N.column[0],ee=N.column[1];if(e=="row"){if(q>t?(q-=s,V-=s,P.filter_select={row:[q,V],column:[x,ee]}):q<n&&(V<n||(V<=t?V=n-1:V-=s),P.filter_select={row:[q,V],column:[x,ee]}),P.filter_select!=null&&z!=null)for(var ne in z){var ae=z[ne].rowhidden,de={};for(var ve in ae)ve<n?de[ve]=0:ve>t&&(de[ve-s]=0);JSON.stringify(de)!="{}"&&(P.filter==null&&(P.filter={}),P.filter[ne]=$.extend(!0,{},z[ne]),P.filter[ne].rowhidden=de,P.filter[ne].str=q,P.filter[ne].edr=V)}}else if(e=="column"&&(x>t?(x-=s,ee-=s,P.filter_select={row:[q,V],column:[x,ee]}):x<n?(ee<n||(ee<=t?ee=n-1:ee-=s),P.filter_select={row:[q,V],column:[x,ee]}):ee>t&&(x=n,ee-=s,P.filter_select={row:[q,V],column:[x,ee]}),P.filter_select!=null&&z!=null))for(var U in z){var B=z[U].cindex;B<n?(P.filter==null&&(P.filter={}),P.filter[B-x]=$.extend(!0,{},z[U]),P.filter[B-x].edc=ee):B>t&&(B-=s,P.filter==null&&(P.filter={}),P.filter[B-x]=$.extend(!0,{},z[U]),P.filter[B-x].cindex=B,P.filter[B-x].stc=x,P.filter[B-x].edc=ee)}}if(P!=null&&P.filter!=null)for(var le in h.rowhidden==null&&(h.rowhidden={}),P.filter){var Te=P.filter[le].rowhidden;for(var ue in Te)h.rowhidden[ue]=0}var be=o.luckysheet_conditionformat_save,ye=[];if(be!=null&&be.length>0)for(var ce=0;ce<be.length;ce++){for(var Re=be[ce].cellrange,pe=[],me=0;me<Re.length;me++){var re=Re[me].row[0],_e=Re[me].row[1],Ze=Re[me].column[0],We=Re[me].column[1];e=="row"?re>=n&&_e<=t||(re>t?(re-=s,_e-=s):re<n?_e<n||(_e<=t?_e=n-1:_e-=s):_e>t&&(re=n,_e-=s),pe.push({row:[re,_e],column:[Ze,We]})):e=="column"&&(Ze>=n&&We<=t||(Ze>t?(Ze-=s,We-=s):Ze<n?We<n||(We<=t?We=n-1:We-=s):We>t&&(Ze=n,We-=s),pe.push({row:[re,_e],column:[Ze,We]})))}if(pe.length>0){var Xe=$.extend(!0,{},be[ce]);Xe.cellrange=pe,ye.push(Xe)}}var Ue=o.luckysheet_alternateformat_save,mt=[];if(Ue!=null&&Ue.length>0)for(var St=0;St<Ue.length;St++){var at=Ue[St].cellrange.row[0],dt=Ue[St].cellrange.row[1],wt=Ue[St].cellrange.column[0],ct=Ue[St].cellrange.column[1];if(e=="row"){if(!(at>=n&&dt<=t)){var bt=$.extend(!0,{},Ue[St]);at>t?(at-=s,dt-=s):at<n?dt<n||(dt<=t?dt=n-1:dt-=s):dt>t&&(at=n,dt-=s),bt.cellrange={row:[at,dt],column:[wt,ct]},mt.push(bt)}}else if(e=="column"&&!(wt>=n&&ct<=t)){var De=$.extend(!0,{},Ue[St]);wt>t?(wt-=s,ct-=s):wt<n?ct<n||(ct<=t?ct=n-1:ct-=s):ct>t&&(wt=n,ct-=s),De.cellrange={row:[at,dt],column:[wt,ct]},mt.push(De)}}var He={freezenhorizontaldata:null,freezenverticaldata:null};if(Ne.freezenhorizontaldata!=null&&e=="row"){var Dt=Ne.freezenhorizontaldata[2],et=fa(u.visibledatarow,Dt);et==-1&&(et=0);var ur=Ne.freezenhorizontaldata[1]-1;ur>=n&&(ur<t?ur=n-1:ur-=s),ur<et&&(ur=et);var Xt=u.visibledatarow[ur]-2-Dt+u.columnHeaderHeight;He.freezenhorizontaldata=[u.visibledatarow[ur],ur+1,Dt,Ne.cutVolumn(u.visibledatarow,ur+1),Xt]}else He.freezenhorizontaldata=Ne.freezenhorizontaldata;if(Ne.freezenverticaldata!=null&&e=="column"){var jt=Ne.freezenverticaldata[2],lr=fa(u.visibledatacolumn,jt);lr==-1&&(lr=0);var tr=Ne.freezenverticaldata[1]-1;tr>=n&&(tr<t?tr=n-1:tr-=s),tr<lr&&(tr=lr);var xr=u.visibledatacolumn[tr]-2-jt+u.rowHeaderWidth;He.freezenverticaldata=[u.visibledatacolumn[tr],tr+1,jt,Ne.cutVolumn(u.visibledatacolumn,tr+1),xr]}else He.freezenverticaldata=Ne.freezenverticaldata;var rr=o.dataVerification,nr={};if(rr!=null)for(var Ut in rr){var ar=Number(Ut.split("_")[0]),Jt=Number(Ut.split("_")[1]),Qt=rr[Ut];e=="row"?ar<n?nr[ar+"_"+Jt]=Qt:ar>t&&(nr[ar-s+"_"+Jt]=Qt):e=="column"&&(Jt<n?nr[ar+"_"+Jt]=Qt:Jt>t&&(nr[ar+"_"+(Jt-s)]=Qt))}var _t,er=o.hyperlink,Kt={};if(er!=null)for(var mr in er){var fr=Number(mr.split("_")[0]),Wt=Number(mr.split("_")[1]),ze=er[mr];e=="row"?fr<n?Kt[fr+"_"+Wt]=ze:fr>t&&(Kt[fr-s+"_"+Wt]=ze):e=="column"&&(Wt<n?Kt[fr+"_"+Wt]=ze:Wt>t&&(Kt[fr+"_"+(Wt-s)]=ze))}if(e=="row"){_t="r",h.rowlen==null&&(h.rowlen={});var Ae={};for(var Ve in h.rowlen)Ve<n?Ae[Ve]=h.rowlen[Ve]:Ve>t&&(Ae[Ve-s]=h.rowlen[Ve]);h.rowlen=Ae,h.rowhidden==null&&(h.rowhidden={});var gt={};for(var vt in h.rowhidden)vt<n?gt[vt]=h.rowhidden[vt]:vt>t&&(gt[vt-s]=h.rowhidden[vt]);if(h.rowhidden=gt,h.borderInfo&&h.borderInfo.length>0){for(var pt=[],Tt=0;Tt<h.borderInfo.length;Tt++){var Ot=h.borderInfo[Tt].rangeType;if(Ot=="range"){for(var It=h.borderInfo[Tt].range,Lt=[],At=0;At<It.length;At++){for(var or=It[At].row[0],Cr=It[At].row[1],Ar=n;Ar<=t;Ar++)Ar<It[At].row[0]?(or-=1,Cr-=1):Ar<=It[At].row[1]&&(Cr-=1);Cr>=or&&Lt.push({row:[or,Cr],column:It[At].column})}if(Lt.length>0){var Rr={rangeType:"range",borderType:h.borderInfo[Tt].borderType,style:h.borderInfo[Tt].style,color:h.borderInfo[Tt].color,range:Lt};pt.push(Rr)}}else if(Ot=="cell"){var Zr=h.borderInfo[Tt].value.row_index;Zr<n?pt.push(h.borderInfo[Tt]):Zr>t&&(h.borderInfo[Tt].value.row_index=Zr-(t-n+1),pt.push(h.borderInfo[Tt]))}}h.borderInfo=pt}d.splice(n,s);for(var Tr=0;Tr<s;Tr++){for(var jr=[],ta=0;ta<d[0].length;ta++)jr.push(null);d.push(jr)}}else{_t="c",h.columnlen==null&&(h.columnlen={});var ia={};for(var Jr in h.columnlen)Jr<n?ia[Jr]=h.columnlen[Jr]:Jr>t&&(ia[Jr-s]=h.columnlen[Jr]);h.columnlen=ia,h.colhidden==null&&(h.colhidden={});var ba={};for(var Wr in h.colhidden)Wr<n?ba[Wr]=h.colhidden[Wr]:Wr>t&&(ba[Wr-s]=h.colhidden[Wr]);if(h.colhidden=ba,h.borderInfo&&h.borderInfo.length>0){for(var Fr=[],oa=0;oa<h.borderInfo.length;oa++){var Fa=h.borderInfo[oa].rangeType;if(Fa=="range"){for(var Da=h.borderInfo[oa].range,va=[],Ha=0;Ha<Da.length;Ha++){for(var qr=Da[Ha].column[0],Ca=Da[Ha].column[1],La=n;La<=t;La++)La<Da[Ha].column[0]?(qr-=1,Ca-=1):La<=Da[Ha].column[1]&&(Ca-=1);Ca>=qr&&va.push({row:Da[Ha].row,column:[qr,Ca]})}if(va.length>0){var Ea={rangeType:"range",borderType:h.borderInfo[oa].borderType,style:h.borderInfo[oa].style,color:h.borderInfo[oa].color,range:va};Fr.push(Ea)}}else if(Fa=="cell"){var Za=h.borderInfo[oa].value.col_index;Za<n?Fr.push(h.borderInfo[oa]):Za>t&&(h.borderInfo[oa].value.col_index=Za-(t-n+1),Fr.push(h.borderInfo[oa]))}}h.borderInfo=Fr}for(var gn=[],Ka=0;Ka<s;Ka++)gn.push(null);for(var ka=0;ka<d.length;ka++){var Pa=[].concat(d[ka]);Pa.splice(n,s),d[ka]=Pa.concat(gn)}}o.index==u.currentSheetIndex?wu(d,h,"delRC",{index:n,len:t-n+1,rc:_t},_,P,ye,mt,He,nr,Kt):(o.data=d,o.config=h,o.calcChain=_,o.filter=P.filter,o.filter_select=P.filter_select,o.luckysheet_conditionformat_save=ye,o.luckysheet_alternateformat_save=mt,o.dataVerification=nr,o.hyperlink=Kt)}}}function xc(e,n,t,a,l,o){if(Os(o=o||u.currentSheetIndex)){var d=je(o),s=u.luckysheetfile[d],h=$.extend(!0,[],s.data),f=t-n+1,p=l-a+1,g=$.extend(!0,{},u.config);g.merge==null&&(g.merge={});var v={};for(var y in g.merge){var b=g.merge[y],k=b.r,w=b.c,_=b.rs,C=b.cs;if(e=="moveLeft")if(n>k+_-1||t<k||a>w+C-1)v[k+"_"+w]={r:k,c:w,rs:_,cs:C};else if(n<=k&&t>=k+_-1&&l<w)v[k+"_"+(w-p)]={r:k,c:w-p,rs:_,cs:C};else for(var A=k;A<=k+_-1;A++)for(var I=w;I<=w+C-1;I++)delete h[A][I].mc;else if(e=="moveUp")if(a>w+C-1||l<w||n>k+_-1)v[k+"_"+w]={r:k,c:w,rs:_,cs:C};else if(a<=w&&l>=w+C-1&&t<k)v[k-f+"_"+w]={r:k-f,c:w,rs:_,cs:C};else for(var S=k;S<=k+_-1;S++)for(var E=w;E<=w+C-1;E++)delete h[S][E].mc}g.merge=v;var R=s.calcChain,F=[];if(R!=null&&R.length>0)for(var N=0;N<R.length;N++){var z=$.extend(!0,{},R[N]),P=z.r,q=z.c,V=pi(P,q,z.index);if(P<n||P>t||q<a||q>l){var x=void 0;e=="moveLeft"?(x="="+m.functionStrChange(V,"del","col",null,a,p),q>l&&P>=n&&P<=t&&(z.c=q-p)):e=="moveUp"&&(x="="+m.functionStrChange(V,"del","row",null,n,f),P>t&&q>=a&&q<=l&&(z.r=P-f)),h[P][q]&&h[P][q].f==V&&(h[P][q].f=x),F.push(z)}}var ee=s.filter_select,ne=s.filter,ae=null;if(ee!=null&&JSON.stringify(ee)!="{}"){ae={filter_select:null,filter:null};var de=ee.row[0],ve=ee.row[1],U=ee.column[0],B=ee.column[1];if(e=="moveUp")if(U>=a&&B<=l){if(de>t?ae.filter_select={row:[de-f,ve-f],column:[U,B]}:ve<n?ae.filter_select={row:[de,ve],column:[U,B]}:de<n&&(ae.filter_select=ve>t?{row:[de,ve-f],column:[U,B]}:{row:[de,n-1],column:[U,B]}),ae.filter_select!=null&&ne!=null)for(var le in ne){var Te=ne[le].rowhidden,ue={};for(var be in Te)be<n?ue[be]=0:be>t&&(ue[be-slen]=0);ae.filter==null&&(ae.filter={}),ae.filter[le]=$.extend(!0,{},ne[le]),JSON.stringify(ue)!="{}"&&(ae.filter[le].rowhidden=ue),ae.filter[le].str=ae.filter_select.row[0],ae.filter[le].edr=ae.filter_select.row[1]}}else if(de>=n&&ve<=t){if(U>l?ae.filter_select={row:[de,ve],column:[U,B]}:U>=a?B>l&&(ae.filter_select={row:[de,ve],column:[a,B-p]}):ae.filter_select=B<a?{row:[de,ve],column:[U,B]}:B<=l?{row:[de,ve],column:[U,a-1]}:{row:[de,ve],column:[U,B-p]},ae.filter_select!=null&&ne!=null)for(var ye in ne){var ce=ae.filter_select.column[0],Re=ae.filter_select.column[1],pe=ne[ye].cindex;if(pe<a||pe>l){ae.filter==null&&(ae.filter={}),pe>l&&(pe-=p);var me=pe-ce;ae.filter[me]=$.extend(!0,{},ne[ye]),ae.filter[me].cindex=pe,ae.filter[me].stc=ce,ae.filter[me].edc=Re}}}else ae.filter_select={row:[de,ve],column:[U,B]},ne!=null&&(ae.filter=ne);else if(e=="moveLeft")if(de>=n&&ve<=t){if(U>l?ae.filter_select={row:[de,ve],column:[U-p,B-p]}:B<a?ae.filter_select={row:[de,ve],column:[U,B]}:U<a&&(ae.filter_select=B>l?{row:[de,ve],column:[U,B-p]}:{row:[de,ve],column:[U,a-1]}),ae.filter_select!=null&&ne!=null)for(var re in ne){var _e=ae.filter_select.column[0],Ze=ae.filter_select.column[1],We=ne[re].cindex;if(We<a||We>l){ae.filter==null&&(ae.filter={}),We>l&&(We-=p);var Xe=We-_e;ae.filter[Xe]=$.extend(!0,{},ne[re]),ae.filter[Xe].cindex=We,ae.filter[Xe].stc=_e,ae.filter[Xe].edc=Ze}}}else U>=a&&B<=l?(de<n||de>t)&&(ae.filter_select={row:[de,ve],column:[U,B]},ne!=null&&(ae.filter=ne)):(ae.filter_select={row:[de,ve],column:[U,B]},ne!=null&&(ae.filter=ne))}if(ae!=null&&ae.filter!=null)for(var Ue in g.rowhidden==null&&(g.rowhidden={}),ae.filter){var mt=ae.filter[Ue].rowhidden;for(var St in mt)g.rowhidden[St]=0}var at=s.luckysheet_conditionformat_save,dt=[];if(at!=null&&at.length>0)for(var wt=0;wt<at.length;wt++){for(var ct=at[wt].cellrange,bt=[],De=0;De<ct.length;De++){var He=ct[De].row[0],Dt=ct[De].row[1],et=ct[De].column[0],ur=ct[De].column[1];n<=He&&t>=Dt&&a<=et&&l>=ur||(bt=Dp(e,n,t,a,l,He,Dt,et,ur,f,p))}if(bt.length>0){var Xt=$.extend(!0,{},at[wt]);Xt.cellrange=bt,dt.push(Xt)}}var jt=s.dataVerification,lr={};if(jt!=null)for(var tr in jt){var xr=Number(tr.split("_")[0]),rr=Number(tr.split("_")[1]),nr=jt[tr];(xr<n||xr>t||rr<a||rr>l)&&(e=="moveLeft"?rr>l&&xr>=n&&xr<=t?lr[xr+"_"+(rr-p)]=nr:lr[xr+"_"+rr]=nr:e=="moveUp"&&(xr>t&&rr>=a&&rr<=l?lr[xr-f+"_"+rr]=nr:lr[xr+"_"+rr]=nr))}var Ut=s.hyperlink,ar={};if(Ut!=null)for(var Jt in Ut){var Qt=Number(Jt.split("_")[0]),_t=Number(Jt.split("_")[1]),er=Ut[Jt];(Qt<n||Qt>t||_t<a||_t>l)&&(e=="moveLeft"?_t>l&&Qt>=n&&Qt<=t?ar[Qt+"_"+(_t-p)]=er:ar[Qt+"_"+_t]=er:e=="moveUp"&&(Qt>t&&_t>=a&&_t<=l?ar[Qt-f+"_"+_t]=er:ar[Qt+"_"+_t]=er))}if(g.borderInfo&&g.borderInfo.length>0){for(var Kt=[],mr=0;mr<g.borderInfo.length;mr++){var fr=g.borderInfo[mr].rangeType;if(fr=="range"){for(var Wt=g.borderInfo[mr].range,ze=[],Ae=0;Ae<Wt.length;Ae++){var Ve=Wt[Ae].row[0],gt=Wt[Ae].row[1],vt=Wt[Ae].column[0],pt=Wt[Ae].column[1];n<=Ve&&t>=gt&&a<=vt&&l>=pt||(ze=Dp(e,n,t,a,l,Ve,gt,vt,pt,f,p))}if(ze.length>0){var Tt={rangeType:"range",borderType:g.borderInfo[mr].borderType,style:g.borderInfo[mr].style,color:g.borderInfo[mr].color,range:ze};Kt.push(Tt)}}else if(fr=="cell"){var Ot=g.borderInfo[mr].value.row_index,It=g.borderInfo[mr].value.col_index;(Ot<n||Ot>t||It<a||It>l)&&(e=="moveLeft"?It>l&&Ot>=n&&Ot<=t&&(It-=p,g.borderInfo[mr].value.col_index=It):e=="moveUp"&&Ot>t&&It>=a&&It<=l&&(Ot-=f,g.borderInfo[mr].value.row_index=Ot),Kt.push(g.borderInfo[mr]))}}g.borderInfo=Kt}for(var Lt=[],At=a;At<=l;At++)Lt.push(null);if(e=="moveUp"){for(var or=[],Cr=n;Cr<=h.length-1;Cr++){for(var Ar=[],Rr=a;Rr<=l;Rr++)Ar.push(h[Cr][Rr]);or.push(Ar)}or.splice(0,f);for(var Zr=[],Tr=n;Tr<=t;Tr++)Zr.push(Lt);or=or.concat(Zr);for(var jr=n;jr<=h.length-1;jr++)for(var ta=a;ta<=l;ta++)h[jr][ta]=or[jr-n][ta-a]}else if(e=="moveLeft")for(var ia=n;ia<=t;ia++)h[ia].splice(a,p),h[ia]=h[ia].concat(Lt);s.index==u.currentSheetIndex?tm(h,g,{type:e,str:n,edr:t,stc:a,edc:l},F,ae,dt,lr,ar):(s.data=h,s.config=g,s.calcChain=F,s.filter=ae.filter,s.filter_select=ae.filter_select,s.luckysheet_conditionformat_save=dt,s.dataVerification=lr,s.hyperlink=ar)}}function Dp(e,n,t,a,l,o,d,s,h,f,p){var g=[];if(e=="moveLeft"){if(n>d||t<o||a>h)g.push({row:[o,d],column:[s,h]});else if(l<s){if(n<=o&&t>=d)g.push({row:[o,d],column:[s-p,h-p]});else if(n>o&&t<d){var v=[{row:[o,n-1],column:[s,h]},{row:[t+1,d],column:[s,h]},{row:[n,t],column:[s-p,h-p]}];g=g.concat(v)}else if(n>o){var y=[{row:[o,n-1],column:[s,h]},{row:[n,d],column:[s-p,h-p]}];g=g.concat(y)}else if(t<d){var b=[{row:[o,t],column:[s-p,h-p]},{row:[t+1,d],column:[s,h]}];g=g.concat(b)}}else if(l>=s){if(a<=s&&l>=h){if(n>o&&t<d){var k=[{row:[o,n-1],column:[s,h]},{row:[t+1,d],column:[s,h]}];g=g.concat(k)}else if(n>o){var w=[{row:[o,n-1],column:[s,h]}];g=g.concat(w)}else if(t<d){var _=[{row:[t+1,d],column:[s,h]}];g=g.concat(_)}}else if(a>s&&l<h){if(n<=o&&t>=d)g.push({row:[o,d],column:[s,h-p]});else if(n>o&&t<d){var C=[{row:[o,n-1],column:[s,h]},{row:[t+1,d],column:[s,h]},{row:[n,t],column:[s,h-p]}];g=g.concat(C)}else if(n>o){var A=[{row:[o,n-1],column:[s,h]},{row:[n,d],column:[s,h-p]}];g=g.concat(A)}else if(t<d){var I=[{row:[o,t],column:[s,h-p]},{row:[t+1,d],column:[s,h]}];g=g.concat(I)}}else if(a>s){if(n<=o&&t>=d)g.push({row:[o,d],column:[s,a-1]});else if(n>o&&t<d){var S=[{row:[o,n-1],column:[s,h]},{row:[t+1,d],column:[s,h]},{row:[n,t],column:[s,a-1]}];g=g.concat(S)}else if(n>o){var E=[{row:[o,n-1],column:[s,h]},{row:[n,d],column:[s,a-1]}];g=g.concat(E)}else if(t<d){var R=[{row:[o,t],column:[s,a-1]},{row:[t+1,d],column:[s,h]}];g=g.concat(R)}}else if(l<h){if(n<=o&&t>=d)g.push({row:[o,d],column:[s-p,h-p]});else if(n>o&&t<d){var F=[{row:[o,n-1],column:[s,h]},{row:[t+1,d],column:[s,h]},{row:[n,t],column:[s-p,h-p]}];g=g.concat(F)}else if(n>o){var N=[{row:[o,n-1],column:[s,h]},{row:[n,d],column:[s-p,h-p]}];g=g.concat(N)}else if(t<d){var z=[{row:[o,t],column:[s-p,h-p]},{row:[t+1,d],column:[s,h]}];g=g.concat(z)}}}}else if(e=="moveUp"){if(a>h||l<s||n>d)g.push({row:[o,d],column:[s,h]});else if(t<o){if(a<=s&&l>=h)g.push({row:[o-f,d-f],column:[s,h]});else if(a>s&&l<h){var P=[{row:[o,d],column:[s,a-1]},{row:[o,d],column:[l+1,h]},{row:[o-f,d-f],column:[a,l]}];g=g.concat(P)}else if(a>s){var q=[{row:[o,d],column:[s,a-1]},{row:[o-f,d-f],column:[a,h]}];g=g.concat(q)}else if(l<h){var V=[{row:[o-f,d-f],column:[s,l]},{row:[o,d],column:[l+1,h]}];g=g.concat(V)}}else if(t>=o){if(n<=o&&t>=d){if(a>s&&l<h){var x=[{row:[o,d],column:[s,a-1]},{row:[o,d],column:[l+1,h]}];g=g.concat(x)}else if(a>s){var ee=[{row:[o,d],column:[s,a-1]}];g=g.concat(ee)}else if(l<h){var ne=[{row:[o,d],column:[l+1,h]}];g=g.concat(ne)}}else if(n>o&&t<d){if(a<=s&&l>=h)g.push({row:[o,d-f],column:[s,h]});else if(a>s&&l<h){var ae=[{row:[o,d],column:[s,a-1]},{row:[o,d],column:[l+1,h]},{row:[o,d-f],column:[a,l]}];g=g.concat(ae)}else if(a>s){var de=[{row:[o,d],column:[s,a-1]},{row:[o,d-f],column:[a,h]}];g=g.concat(de)}else if(l<h){var ve=[{row:[o,d-f],column:[s,l]},{row:[o,d],column:[l+1,h]}];g=g.concat(ve)}}else if(n>o){if(a<=s&&l>=h)g.push({row:[o,n-1],column:[s,h]});else if(a>s&&l<h){var U=[{row:[o,d],column:[s,a-1]},{row:[o,d],column:[l+1,h]},{row:[o,n-1],column:[a,l]}];g=g.concat(U)}else if(a>s){var B=[{row:[o,d],column:[s,a-1]},{row:[o,n-1],column:[a,h]}];g=g.concat(B)}else if(l<h){var le=[{row:[o,n-1],column:[s,l]},{row:[o,d],column:[l+1,h]}];g=g.concat(le)}}else if(t<d){if(a<=s&&l>=h)g.push({row:[o-f,d-f],column:[s,h]});else if(a>s&&l<h){var Te=[{row:[o,d],column:[s,a-1]},{row:[o,d],column:[l+1,h]},{row:[o-f,d-f],column:[a,l]}];g=g.concat(Te)}else if(a>s){var ue=[{row:[o,d],column:[s,a-1]},{row:[o-f,d-f],column:[a,h]}];g=g.concat(ue)}else if(l<h){var be=[{row:[o-f,d-f],column:[s,l]},{row:[o,d],column:[l+1,h]}];g=g.concat(be)}}}}return g}var gu={defaultStore:{container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfredo:[],jfundo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],currentSheetView:"viewNormal"},defaultFormula:(Kl={searchFunctionCell:null,functionlistPosition:{},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangedrag_column_start:!1,rangedrag_row_start:!1,rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,functionHTMLIndex:0,functionRangeIndex:null,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},cellTextToIndexList:{},isFunctionRangeSave:!1},Yr(Kl,"execvertex",{}),Yr(Kl,"execFunctionGroupData",null),Yr(Kl,"execFunctionExist",null),Yr(Kl,"formulaContainSheetList",{}),Yr(Kl,"formulaContainCellList",{}),Yr(Kl,"cellTextToIndexList",{}),Yr(Kl,"execFunctionGlobalData",{}),Yr(Kl,"groupValuesRefreshData",[]),Yr(Kl,"functionResizeData",{}),Yr(Kl,"functionResizeStatus",!1),Yr(Kl,"functionResizeTimeout",null),Yr(Kl,"data_parm_index",0),Kl),defaultSheet:{sheetMaxIndex:0,nulldata:null,mergeCalculationSheet:{},checkLoadSheetIndexToDataIndex:{},CacheNotLoadControll:[]},defaultPivotTable:{pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},drawPivotTable:!0,pivotTableBoundary:[12,6]},defaultImage:{imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null},defaultDataVerification:{defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1}},Ya={addDataAjax:function(e,n,t,a){t==null&&(t=nt.loadSheetUrl),$("#luckysheet-grid-window-1").append(Qc()),e.currentPage++;var l=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:t,headers:{"x-auth-token":l},data:JSON.stringify(e),contentType:"application/json;charset=UTF-8",success:function(o){typeof o=="string"&&(o=JSON.parse(o));var d=o.data,s=d.celldata;(function(h,f){var p=vr.deepCopyFlowData(u.flowdata),g=$.extend(!0,{},u.config);g.merge==null&&(g.merge={});var v=cl([],h,p[0].length);p=p.concat(v);for(var y=0;y<f.length;y++){var b=f[y].r,k=f[y].c,w=f[y].v;Ln(b,k,p,w),w!=null&&w.mc!=null&&w.mc.rs!=null&&(g.merge[w.mc.r+"_"+w.mc.c]=$.extend(!0,{},w.mc))}u.flowdata=p,vr.webWorkerFlowDataCache(u.flowdata),u.luckysheetfile[je(u.currentSheetIndex)].data=p,u.config=g,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,ln(u.flowdata.length,u.flowdata[0].length)})(d.row,s),setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),a&&typeof a=="function"&&a(d)}})},reload:function(e,n,t,a){n==null&&(n=u.currentSheetIndex),t==null&&(t=nt.loadSheetUrl),$("#luckysheet-grid-window-1").append(Qc());var l={gridKey:nt.gridKey,index:n};e=$.extend(!0,e,l);var o=u.luckysheetfile[je(n)];$.post(t,e,function(d){var s=new Function("return "+d)();o.celldata=s[n.toString()];var h=ir.buildGridData(o);setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),o.data=h,u.flowdata=h,vr.webWorkerFlowDataCache(h),function(f,p,g,v,y){y==null&&(y=!0),u.visibledatarow=[],u.visibledatacolumn=[],u.ch_width=0,u.rh_height=0,u.zoomRatio=1,u.config=v??{},g.length==0?u.flowdata=cl(g,p,f):g.length<p&&g[0].length<f?u.flowdata=cl(g,p-g.length,f-g[0].length):g.length<p?u.flowdata=cl(g,p-g.length,0):g[0].length<f?u.flowdata=cl(g,0,f-g[0].length):u.flowdata=g,vr.webWorkerFlowDataCache(u.flowdata),ld(p,f),y&&(ir.showSheet(),setTimeout(function(){ir.restoreCache(),m.execFunctionGroup(),ir.restoreSheetAll(u.currentSheetIndex),Kr()},1))}(h[0].length,h.length,h,null,!1),o.load="1",u.luckysheet_select_save.length=0,u.luckysheet_selection_range=[],nt.saveParam("shs",null,u.currentSheetIndex),ir.changeSheet(n),a&&typeof a=="function"&&a()})},clearSheetByIndex:function(e){var n=je(e),t=u.luckysheetfile[n];t.isPivotTable?delete u.luckysheetfile[n]:(t.data=[],t.row=u.defaultrowNum,t.column=u.defaultcolumnNum,t.chart=[],t.config=null,t.filter=null,t.filter_select=null,t.celldata=[],t.pivotTable={},t.calcChain=[],t.status=0,t.load=0,u.flowdata=[],vr.webWorkerFlowDataCache(u.flowdata),$("#"+u.container+" .luckysheet-data-visualization-chart").remove(),$("#"+u.container+" .luckysheet-datavisual-selection-set").remove(),$("#luckysheet-row-count-show, #luckysheet-formula-functionrange-select, #luckysheet-row-count-show, #luckysheet-column-count-show, #luckysheet-change-size-line, #luckysheet-cell-selected-focus, #luckysheet-selection-copy, #luckysheet-cell-selected-extend, #luckysheet-cell-selected-move, #luckysheet-cell-selected").hide(),delete t.load)},clear:function(e){if(e=="all")for(var n=0;n<u.luckysheetfile.length;n++){var t=u.luckysheetfile[n];this.clearSheetByIndex(t.index)}else e==null&&(e=u.currentSheetIndex),this.clearSheetByIndex(e);ir.changeSheet(u.luckysheetfile[0].index)},destroy:function(){$("#"+u.container).empty(),$("body > .luckysheet-cols-menu").remove(),$("#luckysheet-modal-dialog-mask, #luckysheetTextSizeTest, #luckysheet-icon-morebtn-div").remove(),$("#luckysheet-input-box").parent().remove(),$("#luckysheet-formula-help-c").remove(),$(".chartSetting, .luckysheet-modal-dialog-slider").remove(),$(document).off(".luckysheetEvent"),$(document).off(".luckysheetProtection"),Ne.initialHorizontal=!0,Ne.initialVertical=!0;var e=$.extend(!0,{},gu.defaultStore);for(var n in e)n in u&&(u[n]=e[n]);var t=$.extend(!0,{},gu.defaultFormula);for(var a in t)a in m&&(m[a]=t[a]);var l=$.extend(!0,{},gu.defaultSheet);for(var o in l)o in ir&&(ir[o]=l[o]);var d=$.extend(!0,{},gu.defaultPivotTable);for(var s in d)s in Pr&&(Pr[s]=d[s]);var h=$.extend(!0,{},gu.defaultImage);for(var f in h)f in _r&&(_r[f]=h[f]);var p=$.extend(!0,{},gu.defaultDataVerification);for(var g in p)g in aa&&(aa[g]=p[g]);u.asyncLoad=["core"]},editorChart:function(e){var n=Di[0],t="luckysheetEditMode-datav-chart";e.chart_id=t;var a=e.chartTheme;a=a??"default0000",luckysheet.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,n,t,"luckysheetEditMode-datav-chart_selection",e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,a,e.myWidth,e.myHeight,e.myLeft!=null?parseFloat(e.myLeft):null,e.myTop!=null?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+t).find(".luckysheet-modal-controll-update").click()},createHookFunction:function(){var e=arguments[0];if(Nt.hook&&Nt.hook[e]!=null&&typeof Nt.hook[e]=="function"){var n=Array.prototype.slice.apply(arguments);n.shift();var t=Nt.hook[e].apply(this,n);return t!==!1}return!0}},Lr={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,init:function(){var e=this;$("#luckysheet-postil-showBoxs").off("mousedown.showPs").on("mousedown.showPs",".luckysheet-postil-show",function(n){dn(u.currentSheetIndex,"editObjects",!1)&&(e.currentObj=$(this).find(".luckysheet-postil-show-main"),$(this).hasClass("luckysheet-postil-show-active")||(e.removeActivePs(),$(this).addClass("luckysheet-postil-show-active"),$(this).find(".luckysheet-postil-dialog-resize").show(),$(this).find(".arrowCanvas").css("z-index",200),$(this).find(".luckysheet-postil-show-main").css("z-index",200)),n.stopPropagation())}),$("#luckysheet-postil-showBoxs").off("mouseup.showPs").on("mouseup.showPs",".luckysheet-postil-show",function(n){n.which=="3"&&n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.resize").on("mousedown.resize",".luckysheet-postil-show .luckysheet-postil-dialog-resize .luckysheet-postil-dialog-resize-item",function(n){if(dn(u.currentSheetIndex,"editObjects",!1)){e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");var t=$("#luckysheet-cell-main").scrollTop(),a=$("#luckysheet-cell-main").scrollLeft(),l=pa(n.pageX,n.pageY),o=l[0]+a,d=l[1]+t,s=e.currentObj.position(),h=e.currentObj.width(),f=e.currentObj.height();e.resizeXY=[o,d,h,f,s.left+a,s.top+t,a,t],Rs(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")||(e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200)),n.stopPropagation()}}),$("#luckysheet-postil-showBoxs").off("mousedown.move").on("mousedown.move",".luckysheet-postil-show .luckysheet-postil-dialog-move .luckysheet-postil-dialog-move-item",function(n){if(dn(u.currentSheetIndex,"editObjects",!1)){e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.move=!0;var t=$("#luckysheet-cell-main").scrollTop(),a=$("#luckysheet-cell-main").scrollLeft(),l=e.currentObj.offset(),o=e.currentObj.position();e.moveXY=[n.pageX-l.left,n.pageY-l.top,o.left,o.top,a,t],Rs(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")||(e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200)),n.stopPropagation()}})},overshow:function(e){if($("#luckysheet-postil-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length!=0){var n=pa(e.pageX,e.pageY),t=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),l=n[0],o=n[1],d=0,s=0;Ne.freezenverticaldata!=null&&n[0]<Ne.freezenverticaldata[0]-Ne.freezenverticaldata[2]?d=t:l+=t,Ne.freezenhorizontaldata!=null&&n[1]<Ne.freezenhorizontaldata[0]-Ne.freezenhorizontaldata[2]?s=a:o+=a;var h=Wa(o)[2],f=ja(l)[2],p=dr.mergeborer(u.flowdata,h,f);if(p&&(h=p.row[2],f=p.column[2]),u.flowdata[h]!=null&&u.flowdata[h][f]!=null&&u.flowdata[h][f].ps!=null){var g=u.flowdata[h][f].ps;if(!(g.isshow||$("#luckysheet-postil-show_"+h+"_"+f).length>0)){var v=g.value==null?"":g.value,y=(u.visibledatarow[h],h-1==-1?0:u.visibledatarow[h-1]),b=u.visibledatacolumn[f];f-1==-1||u.visibledatacolumn[f-1],p&&(p.row[1],y=p.row[0],b=p.column[1],p.column[0]);var k=b+d,w=y+s,_=k+18*u.zoomRatio,C=w-18*u.zoomRatio;C<0&&(C=2);var A=this.defaultWidth*u.zoomRatio,I=this.defaultHeight*u.zoomRatio,S=this.getArrowCanvasSize(_,C,k,w),E='<div id="luckysheet-postil-overshow"><canvas class="arrowCanvas" width="'+S[2]+'" height="'+S[3]+'" style="position:absolute;left:'+S[0]+"px;top:"+S[1]+'px;z-index:100;pointer-events:none;"></canvas><div style="width:'+(A-12)+"px;min-height:"+(I-12)+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+_+"px;top:"+C+'px;z-index:100;">'+this.htmlEscape(v)+"</div></div>";$(E).appendTo($("#luckysheet-cell-main"));var R=$("#luckysheet-postil-overshow .arrowCanvas").get(0).getContext("2d");this.drawArrow(R,S[4],S[5],S[6],S[7])}}}},getArrowCanvasSize:function(e,n,t,a){var l=t-5;e<t&&(l=e-5);var o=a-5;n<a&&(o=n-5);var d=Math.abs(e-t)+10,s=Math.abs(n-a)+10,h=d-5,f=5;e<t&&(h=5,f=d-5);var p=s-5,g=5;return n<a&&(p=5,g=s-5),[l,o,d,s,h,p,f,g]},drawArrow:function(e,n,t,a,l,o,d,s,h){o=D(o)=="undefined"?30:o,d=D(d)=="undefined"?6:d,s=D(s)=="undefined"?1:s,h=D(h)=="undefined"?"#000":h;var f=180*Math.atan2(t-l,n-a)/Math.PI,p=(f+o)*Math.PI/180,g=(f-o)*Math.PI/180,v=d*Math.cos(p),y=d*Math.sin(p),b=d*Math.cos(g),k=d*Math.sin(g);e.save(),e.beginPath();var w=n-v,_=t-y;e.moveTo(w,_),e.moveTo(n,t),e.lineTo(a,l),e.lineWidth=s,e.strokeStyle=h,e.stroke(),w=a+v,_=l+y,e.moveTo(w,_),e.lineTo(a,l),w=a+b,_=l+k,e.lineTo(w,_),e.fillStyle=h,e.fill(),e.restore()},buildAllPs:function(e){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(var n=0;n<e.length;n++)for(var t=0;t<e[0].length;t++)if(e[n][t]!=null&&e[n][t].ps!=null){var a=e[n][t].ps;this.buildPs(n,t,a)}this.init()},buildPs:function(e,n,t){if($("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove(),t!=null&&t.isshow!=null&&t.isshow){u.visibledatarow[e];var a=e-1==-1?0:u.visibledatarow[e-1],l=u.visibledatacolumn[n],o=(n-1==-1||u.visibledatacolumn[n-1],dr.mergeborer(u.flowdata,e,n));o&&(o.row[1],a=o.row[0],l=o.column[1],o.column[0]);var d=l,s=a,h=t.left==null?d+18*u.zoomRatio:t.left*u.zoomRatio,f=t.top==null?s-18*u.zoomRatio:t.top*u.zoomRatio,p=t.width==null?this.defaultWidth*u.zoomRatio:t.width*u.zoomRatio,g=t.height==null?this.defaultHeight*u.zoomRatio:t.height*u.zoomRatio,v=t.value==null?"":t.value;f<0&&(f=2);var y=this.getArrowCanvasSize(h,f,d,s),b='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+y[2]+'" height="'+y[3]+'" style="position:absolute;left:'+y[0]+"px;top:"+y[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+p+"px;height:"+g+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+h+"px;top:"+f+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(p-12)+"px;height:"+(g-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+this.htmlEscape(v)+"</div></div></div></div>";$(b).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));var k=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");this.drawArrow(k,y[4],y[5],y[6],y[7])}},newPs:function(e,n){if(dn(u.currentSheetIndex,"editObjects")&&Ya.createHookFunction("commentInsertBefore",e,n)){u.visibledatarow[e];var t=e-1==-1?0:u.visibledatarow[e-1],a=u.visibledatacolumn[n],l=(n-1==-1||u.visibledatacolumn[n-1],dr.mergeborer(u.flowdata,e,n));l&&(l.row[1],t=l.row[0],a=l.column[1],l.column[0]);var o=a,d=t,s=o+18*u.zoomRatio,h=d-18*u.zoomRatio;h<0&&(h=2);var f=this.defaultWidth*u.zoomRatio,p=this.defaultHeight*u.zoomRatio,g=this.getArrowCanvasSize(s,h,o,d),v='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+g[2]+'" height="'+g[3]+'" style="position:absolute;left:'+g[0]+"px;top:"+g[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+f+"px;height:"+p+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+s+"px;top:"+h+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:132px;height:72px;line-height:20px;box-sizing:border-box;text-align: center;word-break:break-all;" spellcheck="false" contenteditable="true"></div></div></div></div>';$(v).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));var y=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");this.drawArrow(y,g[4],g[5],g[6],g[7]),$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),this.init();var b=vr.deepCopyFlowData(u.flowdata),k=[];b[e][n]==null&&(b[e][n]={}),b[e][n].ps={left:null,top:null,width:null,height:null,value:"",isshow:!1},k.push(e+"_"+n),this.ref(b,k),setTimeout(function(){Ya.createHookFunction("commentInsertAfter",e,n,b[e][n])},0)}},editPs:function(e,n){if(dn(u.currentSheetIndex,"editObjects")){if($("#luckysheet-postil-show_"+e+"_"+n).length>0)$("#luckysheet-postil-show_"+e+"_"+n).show(),$("#luckysheet-postil-show_"+e+"_"+n).addClass("luckysheet-postil-show-active"),$("#luckysheet-postil-show_"+e+"_"+n).find(".luckysheet-postil-dialog-resize").show();else{var t=u.flowdata[e][n].ps,a=(u.visibledatarow[e],e-1==-1?0:u.visibledatarow[e-1]),l=u.visibledatacolumn[n],o=(n-1==-1||u.visibledatacolumn[n-1],dr.mergeborer(u.flowdata,e,n));o&&(o.row[1],a=o.row[0],l=o.column[1],o.column[0]);var d=l,s=a,h=t.left==null?d+18*u.zoomRatio:t.left*u.zoomRatio,f=t.top==null?s-18*u.zoomRatio:t.top*u.zoomRatio,p=t.width==null?this.defaultWidth*u.zoomRatio:t.width*u.zoomRatio,g=t.height==null?this.defaultHeight*u.zoomRatio:t.height*u.zoomRatio,v=t.value==null?"":t.value;f<0&&(f=2);var y=this.getArrowCanvasSize(h,f,d,s),b='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+y[2]+'" height="'+y[3]+'" style="position:absolute;left:'+y[0]+"px;top:"+y[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+p+"px;height:"+g+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+h+"px;top:"+f+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(p-12)+"px;height:"+(g-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+this.htmlEscape(v)+"</div></div></div></div>";$(b).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));var k=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");this.drawArrow(k,y[4],y[5],y[6],y[7])}$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),rs($("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").get(0)),this.init()}},delPs:function(e,n){if(dn(u.currentSheetIndex,"editObjects")&&Ya.createHookFunction("commentDeleteBefore",e,n,u.flowdata[e][n])){$("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove();var t=vr.deepCopyFlowData(u.flowdata),a=[];delete t[e][n].ps,a.push(e+"_"+n),this.ref(t,a),setTimeout(function(){Ya.createHookFunction("commentDeleteAfter",e,n,u.flowdata[e][n])},0)}},showHidePs:function(e,n){var t=u.flowdata[e][n].ps,a=t.isshow,l=vr.deepCopyFlowData(u.flowdata),o=[];if(a)l[e][n].ps.isshow=!1,$("#luckysheet-postil-show_"+e+"_"+n).remove();else{l[e][n].ps.isshow=!0,u.visibledatarow[e];var d=e-1==-1?0:u.visibledatarow[e-1],s=u.visibledatacolumn[n],h=(n-1==-1||u.visibledatacolumn[n-1],dr.mergeborer(u.flowdata,e,n));h&&(h.row[1],d=h.row[0],s=h.column[1],h.column[0]);var f=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),g=s,v=d;Ne.freezenverticaldata!=null&&g<Ne.freezenverticaldata[0]-Ne.freezenverticaldata[2]&&(g+=f),Ne.freezenhorizontaldata!=null&&v<Ne.freezenhorizontaldata[0]-Ne.freezenhorizontaldata[2]&&(v+=p);var y=t.left==null?g+18*u.zoomRatio:t.left*u.zoomRatio,b=t.top==null?v-18*u.zoomRatio:t.top*u.zoomRatio,k=t.width==null?this.defaultWidth*u.zoomRatio:t.width*u.zoomRatio,w=t.height==null?this.defaultHeight*u.zoomRatio:t.height*u.zoomRatio,_=t.value==null?"":t.value;b<0&&(b=2);var C=this.getArrowCanvasSize(y,b,g,v),A='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+C[2]+'" height="'+C[3]+'" style="position:absolute;left:'+C[0]+"px;top:"+C[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+k+"px;height:"+w+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+y+"px;top:"+b+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(k-12)+"px;height:"+(w-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+this.htmlEscape(_)+"</div></div></div></div>";$(A).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));var I=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");this.drawArrow(I,C[4],C[5],C[6],C[7]),this.init()}o.push(e+"_"+n),this.ref(l,o)},showHideAllPs:function(){for(var e=vr.deepCopyFlowData(u.flowdata),n=!0,t=[],a=0;a<e.length;a++)for(var l=0;l<e[0].length;l++)e[a]!=null&&e[a][l]!=null&&e[a][l].ps!=null&&(t.push(a+"_"+l),e[a][l].ps.isshow||(n=!1));var o=[];if(t.length>0)if(n){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(var d=0;d<t.length;d++){var s=t[d].split("_")[0],h=t[d].split("_")[1];e[s][h].ps.isshow&&(e[s][h].ps.isshow=!1,o.push(t[d]))}}else for(var f=0;f<t.length;f++){var p=t[f].split("_")[0],g=t[f].split("_")[1],v=e[p][g].ps;if(!v.isshow){u.visibledatarow[p];var y=p-1==-1?0:u.visibledatarow[p-1],b=u.visibledatacolumn[g],k=(g-1==-1||u.visibledatacolumn[g-1],dr.mergeborer(u.flowdata,p,g));k&&(k.row[1],y=k.row[0],b=k.column[1],k.column[0]);var w=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop(),C=b,A=y;Ne.freezenverticaldata!=null&&C<Ne.freezenverticaldata[0]-Ne.freezenverticaldata[2]&&(C+=w),Ne.freezenhorizontaldata!=null&&A<Ne.freezenhorizontaldata[0]-Ne.freezenhorizontaldata[2]&&(A+=_);var I=v.left==null?C+18*u.zoomRatio:v.left*u.zoomRatio,S=v.top==null?A-18*u.zoomRatio:v.top*u.zoomRatio,E=v.width==null?this.defaultWidth*u.zoomRatio:v.width*u.zoomRatio,R=v.height==null?this.defaultHeight*u.zoomRatio:v.height*u.zoomRatio,F=v.value==null?"":v.value;S<0&&(S=2);var N=this.getArrowCanvasSize(I,S,C,A),z='<div id="luckysheet-postil-show_'+p+"_"+g+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+N[2]+'" height="'+N[3]+'" style="position:absolute;left:'+N[0]+"px;top:"+N[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+E+"px;height:"+R+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+I+"px;top:"+S+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(E-12)+"px;height:"+(R-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+this.htmlEscape(F)+"</div></div></div></div>";$(z).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));var P=$("#luckysheet-postil-show_"+p+"_"+g+" .arrowCanvas").get(0).getContext("2d");this.drawArrow(P,N[4],N[5],N[6],N[7]),e[p][g].ps.isshow=!0,o.push(t[f])}}this.ref(e,o),this.init()},removeActivePs:function(){if($("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").length>0){var e=$("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").attr("id"),n=e.split("luckysheet-postil-show_")[1].split("_")[0],t=e.split("luckysheet-postil-show_")[1].split("_")[1],a=$("#"+e).find(".formulaInputFocus").text();if(!Ya.createHookFunction("commentUpdateBefore",n,t,a))return;var l=$.extend(!0,{},u.flowdata[n][t]);$("#"+e).removeClass("luckysheet-postil-show-active"),$("#"+e).find(".luckysheet-postil-dialog-resize").hide(),$("#"+e).find(".arrowCanvas").css("z-index",100),$("#"+e).find(".luckysheet-postil-show-main").css("z-index",100);var o=vr.deepCopyFlowData(u.flowdata),d=[];o[n][t].ps.value=a,d.push(n+"_"+t),this.ref(o,d),o[n][t].ps.isshow||$("#"+e).remove(),setTimeout(function(){Ya.createHookFunction("commentUpdateAfter",n,t,l,o[n][t])},0)}},ref:function(e,n){if(u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"postil",data:u.flowdata,curdata:e,sheetIndex:u.currentSheetIndex,rc:n})),u.flowdata=e,vr.webWorkerFlowDataCache(u.flowdata),u.luckysheetfile[je(u.currentSheetIndex)].data=u.flowdata,nt.allowUpdate)for(var t=0;t<n.length;t++){var a=n[t].split("_")[0],l=n[t].split("_")[1];nt.saveParam("v",u.currentSheetIndex,u.flowdata[a][l],{r:a,c:l})}setTimeout(function(){Kr()},1)},positionSync:function(){var e=this;$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(n,t){var a=$(t).attr("id"),l=a.split("luckysheet-postil-show_")[1].split("_")[0],o=a.split("luckysheet-postil-show_")[1].split("_")[1],d=u.flowdata[l][o];d!=null&&d.ps!=null?e.buildPs(l,o,d.ps):$("#"+a).hide()})},htmlEscape:function(e){return e.replace(/[<>"&]/g,function(n,t,a){switch(console.log(n,t,a),n){case"<":return"&lt";case">":return"&gt";case"&":return"&amp";case'"':return"&quot;"}})}};function Fp(e,n,t,a,l){var o,d,s={};l==null?(o=u.config,d=u.flowdata):(o=u.luckysheetfile[je(l)].config,d=u.luckysheetfile[je(l)].data);var h=o.borderInfo;if(h!=null&&h.length>0)for(var f=0;f<h.length;f++){var p=h[f].rangeType;if(p=="range")for(var g=h[f].borderType,v=h[f].color,y=h[f].style,b=h[f].range,k=0;k<b.length;k++){var w=b[k].row[0],_=b[k].row[1],C=b[k].column[0],A=b[k].column[1];if(w<e&&(w=e),_>n&&(_=n),C<t&&(C=t),A>a&&(A=a),g=="border-left"){for(var I=w;I<=_;I++)if(o.rowhidden==null||o.rowhidden[I]==null){s[I+"_"+C]==null&&(s[I+"_"+C]={}),s[I+"_"+C].l={color:v,style:y};var S=C-1;if(S>=0&&s[I+"_"+S])if(d[I]!=null&&D(d[I][S])=="object"&&d[I][S].mc!=null){var E=d[I][S],R=o.merge[E.mc.r+"_"+E.mc.c];R.c+R.cs-1==S&&(s[I+"_"+S].r={color:v,style:y})}else s[I+"_"+S].r={color:v,style:y}}}else if(g=="border-right"){for(var F=w;F<=_;F++)if(o.rowhidden==null||o.rowhidden[F]==null){s[F+"_"+A]==null&&(s[F+"_"+A]={}),s[F+"_"+A].r={color:v,style:y};var N=A+1;if(N<d[0].length&&s[F+"_"+N])if(d[F]!=null&&D(d[F][N])=="object"&&d[F][N].mc!=null){var z=d[F][N];o.merge[z.mc.r+"_"+z.mc.c].c==N&&(s[F+"_"+N].l={color:v,style:y})}else s[F+"_"+N].l={color:v,style:y}}}else if(g=="border-top"){if(o.rowhidden!=null&&o.rowhidden[w]!=null)continue;for(var P=C;P<=A;P++){s[w+"_"+P]==null&&(s[w+"_"+P]={}),s[w+"_"+P].t={color:v,style:y};var q=w-1;if(q>=0&&s[q+"_"+P])if(d[q]!=null&&D(d[q][P])=="object"&&d[q][P].mc!=null){var V=d[q][P],x=o.merge[V.mc.r+"_"+V.mc.c];x.r+x.rs-1==q&&(s[q+"_"+P].b={color:v,style:y})}else s[q+"_"+P].b={color:v,style:y}}}else if(g=="border-bottom"){if(o.rowhidden!=null&&o.rowhidden[_]!=null)continue;for(var ee=C;ee<=A;ee++){s[_+"_"+ee]==null&&(s[_+"_"+ee]={}),s[_+"_"+ee].b={color:v,style:y};var ne=_+1;if(ne<d.length&&s[ne+"_"+ee])if(d[ne]!=null&&D(d[ne][ee])=="object"&&d[ne][ee].mc!=null){var ae=d[ne][ee];o.merge[ae.mc.r+"_"+ae.mc.c].r==ne&&(s[ne+"_"+ee].t={color:v,style:y})}else s[ne+"_"+ee].t={color:v,style:y}}}else if(g=="border-all"){for(var de=w;de<=_;de++)if(o.rowhidden==null||o.rowhidden[de]==null)for(var ve=C;ve<=A;ve++){if(d[de]!=null&&D(d[de][ve])=="object"&&d[de][ve].mc!=null){var U=d[de][ve],B=o.merge[U.mc.r+"_"+U.mc.c];B.r==de&&(s[de+"_"+ve]==null&&(s[de+"_"+ve]={}),s[de+"_"+ve].t={color:v,style:y}),B.r+B.rs-1==de&&(s[de+"_"+ve]==null&&(s[de+"_"+ve]={}),s[de+"_"+ve].b={color:v,style:y}),B.c==ve&&(s[de+"_"+ve]==null&&(s[de+"_"+ve]={}),s[de+"_"+ve].l={color:v,style:y}),B.c+B.cs-1==ve&&(s[de+"_"+ve]==null&&(s[de+"_"+ve]={}),s[de+"_"+ve].r={color:v,style:y})}else s[de+"_"+ve]==null&&(s[de+"_"+ve]={}),s[de+"_"+ve].l={color:v,style:y},s[de+"_"+ve].r={color:v,style:y},s[de+"_"+ve].t={color:v,style:y},s[de+"_"+ve].b={color:v,style:y};if(de==w){var le=w-1;if(le>=0&&s[le+"_"+ve])if(d[le]!=null&&D(d[le][ve])=="object"&&d[le][ve].mc!=null){var Te=d[le][ve],ue=o.merge[Te.mc.r+"_"+Te.mc.c];ue.r+ue.rs-1==le&&(s[le+"_"+ve].b={color:v,style:y})}else s[le+"_"+ve].b={color:v,style:y}}if(de==_){var be=_+1;if(be<d.length&&s[be+"_"+ve])if(d[be]!=null&&D(d[be][ve])=="object"&&d[be][ve].mc!=null){var ye=d[be][ve];o.merge[ye.mc.r+"_"+ye.mc.c].r==be&&(s[be+"_"+ve].t={color:v,style:y})}else s[be+"_"+ve].t={color:v,style:y}}if(ve==C){var ce=C-1;if(ce>=0&&s[de+"_"+ce])if(d[de]!=null&&D(d[de][ce])=="object"&&d[de][ce].mc!=null){var Re=d[de][ce],pe=o.merge[Re.mc.r+"_"+Re.mc.c];pe.c+pe.cs-1==ce&&(s[de+"_"+ce].r={color:v,style:y})}else s[de+"_"+ce].r={color:v,style:y}}if(ve==A){var me=A+1;if(me<d[0].length&&s[de+"_"+me])if(d[de]!=null&&D(d[de][me])=="object"&&d[de][me].mc!=null){var re=d[de][me];o.merge[re.mc.r+"_"+re.mc.c].c==me&&(s[de+"_"+me].l={color:v,style:y})}else s[de+"_"+me].l={color:v,style:y}}}}else if(g=="border-outside"){for(var _e=w;_e<=_;_e++)if(o.rowhidden==null||o.rowhidden[_e]==null){for(var Ze=C;Ze<=A;Ze++)if(_e==w||_e==_||Ze==C||Ze==A){if(_e==w){s[_e+"_"+Ze]==null&&(s[_e+"_"+Ze]={}),s[_e+"_"+Ze].t={color:v,style:y};var We=w-1;if(We>=0&&s[We+"_"+Ze])if(d[We]!=null&&D(d[We][Ze])=="object"&&d[We][Ze].mc!=null){var Xe=d[We][Ze],Ue=o.merge[Xe.mc.r+"_"+Xe.mc.c];Ue.r+Ue.rs-1==We&&(s[We+"_"+Ze].b={color:v,style:y})}else s[We+"_"+Ze].b={color:v,style:y}}if(_e==_){s[_e+"_"+Ze]==null&&(s[_e+"_"+Ze]={}),s[_e+"_"+Ze].b={color:v,style:y};var mt=_+1;if(mt<d.length&&s[mt+"_"+Ze])if(d[mt]!=null&&D(d[mt][Ze])=="object"&&d[mt][Ze].mc!=null){var St=d[mt][Ze];o.merge[St.mc.r+"_"+St.mc.c].r==mt&&(s[mt+"_"+Ze].t={color:v,style:y})}else s[mt+"_"+Ze].t={color:v,style:y}}if(Ze==C){s[_e+"_"+Ze]==null&&(s[_e+"_"+Ze]={}),s[_e+"_"+Ze].l={color:v,style:y};var at=C-1;if(at>=0&&s[_e+"_"+at])if(d[_e]!=null&&D(d[_e][at])=="object"&&d[_e][at].mc!=null){var dt=d[_e][at],wt=o.merge[dt.mc.r+"_"+dt.mc.c];wt.c+wt.cs-1==at&&(s[_e+"_"+at].r={color:v,style:y})}else s[_e+"_"+at].r={color:v,style:y}}if(Ze==A){s[_e+"_"+Ze]==null&&(s[_e+"_"+Ze]={}),s[_e+"_"+Ze].r={color:v,style:y};var ct=A+1;if(ct<d[0].length&&s[_e+"_"+ct])if(d[_e]!=null&&D(d[_e][ct])=="object"&&d[_e][ct].mc!=null){var bt=d[_e][ct];o.merge[bt.mc.r+"_"+bt.mc.c].c==ct&&(s[_e+"_"+ct].l={color:v,style:y})}else s[_e+"_"+ct].l={color:v,style:y}}}}}else if(g=="border-inside"){for(var De=w;De<=_;De++)if(o.rowhidden==null||o.rowhidden[De]==null)for(var He=C;He<=A;He++)if(De==w&&He==C)d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null||(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].r={color:v,style:y},s[De+"_"+He].b={color:v,style:y});else if(De==_&&He==C)d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null||(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].r={color:v,style:y},s[De+"_"+He].t={color:v,style:y});else if(De==w&&He==A)d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null||(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y},s[De+"_"+He].b={color:v,style:y});else if(De==_&&He==A)d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null||(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y},s[De+"_"+He].t={color:v,style:y});else if(De==w)if(d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null){var Dt=d[De][He],et=o.merge[Dt.mc.r+"_"+Dt.mc.c];et.c==He?(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y}):et.c+et.cs-1==He&&(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].r={color:v,style:y})}else s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y},s[De+"_"+He].r={color:v,style:y},s[De+"_"+He].b={color:v,style:y};else if(De==_)if(d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null){var ur=d[De][He],Xt=o.merge[ur.mc.r+"_"+ur.mc.c];Xt.c==He?(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y}):Xt.c+Xt.cs-1==He&&(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].r={color:v,style:y})}else s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y},s[De+"_"+He].r={color:v,style:y},s[De+"_"+He].t={color:v,style:y};else if(He==C)if(d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null){var jt=d[De][He],lr=o.merge[jt.mc.r+"_"+jt.mc.c];lr.r==De?(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].t={color:v,style:y}):lr.r+lr.rs-1==De&&(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].b={color:v,style:y})}else s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].r={color:v,style:y},s[De+"_"+He].t={color:v,style:y},s[De+"_"+He].b={color:v,style:y};else if(He==A)if(d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null){var tr=d[De][He],xr=o.merge[tr.mc.r+"_"+tr.mc.c];xr.r==De?(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].t={color:v,style:y}):xr.r+xr.rs-1==De&&(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].b={color:v,style:y})}else s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y},s[De+"_"+He].t={color:v,style:y},s[De+"_"+He].b={color:v,style:y};else if(d[De]!=null&&D(d[De][He])=="object"&&d[De][He].mc!=null){var rr=d[De][He],nr=o.merge[rr.mc.r+"_"+rr.mc.c];nr.r==De?(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].t={color:v,style:y}):nr.r+nr.rs-1==De&&(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].b={color:v,style:y}),nr.c==He?(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y}):nr.c+nr.cs-1==He&&(s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].r={color:v,style:y})}else s[De+"_"+He]==null&&(s[De+"_"+He]={}),s[De+"_"+He].l={color:v,style:y},s[De+"_"+He].r={color:v,style:y},s[De+"_"+He].t={color:v,style:y},s[De+"_"+He].b={color:v,style:y}}else if(g=="border-horizontal"){for(var Ut=w;Ut<=_;Ut++)if(o.rowhidden==null||o.rowhidden[Ut]==null)for(var ar=C;ar<=A;ar++)if(Ut==w)d[Ut]!=null&&D(d[Ut][ar])=="object"&&d[Ut][ar].mc!=null||(s[Ut+"_"+ar]==null&&(s[Ut+"_"+ar]={}),s[Ut+"_"+ar].b={color:v,style:y});else if(Ut==_)d[Ut]!=null&&D(d[Ut][ar])=="object"&&d[Ut][ar].mc!=null||(s[Ut+"_"+ar]==null&&(s[Ut+"_"+ar]={}),s[Ut+"_"+ar].t={color:v,style:y});else if(d[Ut]!=null&&D(d[Ut][ar])=="object"&&d[Ut][ar].mc!=null){var Jt=d[Ut][ar],Qt=o.merge[Jt.mc.r+"_"+Jt.mc.c];Qt.r==Ut?(s[Ut+"_"+ar]==null&&(s[Ut+"_"+ar]={}),s[Ut+"_"+ar].t={color:v,style:y}):Qt.r+Qt.rs-1==Ut&&(s[Ut+"_"+ar]==null&&(s[Ut+"_"+ar]={}),s[Ut+"_"+ar].b={color:v,style:y})}else s[Ut+"_"+ar]==null&&(s[Ut+"_"+ar]={}),s[Ut+"_"+ar].t={color:v,style:y},s[Ut+"_"+ar].b={color:v,style:y}}else if(g=="border-vertical"){for(var _t=w;_t<=_;_t++)if(o.rowhidden==null||o.rowhidden[_t]==null)for(var er=C;er<=A;er++)if(er==C)d[_t]!=null&&D(d[_t][er])=="object"&&d[_t][er].mc!=null||(s[_t+"_"+er]==null&&(s[_t+"_"+er]={}),s[_t+"_"+er].r={color:v,style:y});else if(er==A)d[_t]!=null&&D(d[_t][er])=="object"&&d[_t][er].mc!=null||(s[_t+"_"+er]==null&&(s[_t+"_"+er]={}),s[_t+"_"+er].l={color:v,style:y});else if(d[_t]!=null&&D(d[_t][er])=="object"&&d[_t][er].mc!=null){var Kt=d[_t][er],mr=o.merge[Kt.mc.r+"_"+Kt.mc.c]||{};mr.c==er?(s[_t+"_"+er]==null&&(s[_t+"_"+er]={}),s[_t+"_"+er].l={color:v,style:y}):mr.c+mr.cs-1==er&&(s[_t+"_"+er]==null&&(s[_t+"_"+er]={}),s[_t+"_"+er].r={color:v,style:y})}else s[_t+"_"+er]==null&&(s[_t+"_"+er]={}),s[_t+"_"+er].l={color:v,style:y},s[_t+"_"+er].r={color:v,style:y}}else if(g=="border-none"){for(var fr=w;fr<=_;fr++)if(o.rowhidden==null||o.rowhidden[fr]==null)for(var Wt=C;Wt<=A;Wt++){if(s[fr+"_"+Wt]!=null&&delete s[fr+"_"+Wt],fr==w){var ze=w-1;ze>=0&&s[ze+"_"+Wt]&&delete s[ze+"_"+Wt].b}if(fr==_){var Ae=_+1;Ae<d.length&&s[Ae+"_"+Wt]&&delete s[Ae+"_"+Wt].t}if(Wt==C){var Ve=C-1;Ve>=0&&s[fr+"_"+Ve]&&delete s[fr+"_"+Ve].r}if(Wt==A){var gt=A+1;gt<d[0].length&&s[fr+"_"+gt]&&delete s[fr+"_"+gt].l}}}}else if(p=="cell"){var vt=h[f].value,pt=vt.row_index,Tt=vt.col_index;if(pt<e||pt>n||Tt<t||Tt>a||o.rowhidden!=null&&o.rowhidden[pt]!=null)continue;if(vt.l!=null||vt.r!=null||vt.t!=null||vt.b!=null)if(s[pt+"_"+Tt]==null&&(s[pt+"_"+Tt]={}),d[pt]!=null&&D(d[pt][Tt])=="object"&&d[pt][Tt].mc!=null){var Ot=d[pt][Tt],It=o.merge[Ot.mc.r+"_"+Ot.mc.c]||{};if(vt.l!=null&&Tt==It.c){s[pt+"_"+Tt].l={color:vt.l.color,style:vt.l.style};var Lt=Tt-1;if(Lt>=0&&s[pt+"_"+Lt])if(d[pt]!=null&&D(d[pt][Lt])=="object"&&d[pt][Lt].mc!=null){var At=d[pt][Lt],or=o.merge[At.mc.r+"_"+At.mc.c];or.c+or.cs-1==Lt&&(s[pt+"_"+Lt].r={color:vt.l.color,style:vt.l.style})}else s[pt+"_"+Lt].r={color:vt.l.color,style:vt.l.style}}else s[pt+"_"+Tt].l=null;if(vt.r!=null&&Tt==It.c+It.cs-1){s[pt+"_"+Tt].r={color:vt.r.color,style:vt.r.style};var Cr=Tt+1;if(Cr<d[0].length&&s[pt+"_"+Cr])if(d[pt]!=null&&D(d[pt][Cr])=="object"&&d[pt][Cr].mc!=null){var Ar=d[pt][Cr];o.merge[Ar.mc.r+"_"+Ar.mc.c].c==Cr&&(s[pt+"_"+Cr].l={color:vt.r.color,style:vt.r.style})}else s[pt+"_"+Cr].l={color:vt.r.color,style:vt.r.style}}else s[pt+"_"+Tt].r=null;if(vt.t!=null&&pt==It.r){s[pt+"_"+Tt].t={color:vt.t.color,style:vt.t.style};var Rr=pt-1;if(Rr>=0&&s[Rr+"_"+Tt])if(d[Rr]!=null&&D(d[Rr][Tt])=="object"&&d[Rr][Tt].mc!=null){var Zr=d[Rr][Tt],Tr=o.merge[Zr.mc.r+"_"+Zr.mc.c];Tr.r+Tr.rs-1==Rr&&(s[Rr+"_"+Tt].b={color:vt.t.color,style:vt.t.style})}else s[Rr+"_"+Tt].b={color:vt.t.color,style:vt.t.style}}else s[pt+"_"+Tt].t=null;if(vt.b!=null&&pt==It.r+It.rs-1){s[pt+"_"+Tt].b={color:vt.b.color,style:vt.b.style};var jr=pt+1;if(jr<d.length&&s[jr+"_"+Tt])if(d[jr]!=null&&D(d[jr][Tt])=="object"&&d[jr][Tt].mc!=null){var ta=d[jr][Tt];o.merge[ta.mc.r+"_"+ta.mc.c].r==jr&&(s[jr+"_"+Tt].t={color:vt.b.color,style:vt.b.style})}else s[jr+"_"+Tt].t={color:vt.b.color,style:vt.b.style}}else s[pt+"_"+Tt].b=null}else{if(vt.l!=null){s[pt+"_"+Tt].l={color:vt.l.color,style:vt.l.style};var ia=Tt-1;if(ia>=0&&s[pt+"_"+ia])if(d[pt]!=null&&D(d[pt][ia])=="object"&&d[pt][ia].mc!=null){var Jr=d[pt][ia],ba=o.merge[Jr.mc.r+"_"+Jr.mc.c];ba.c+ba.cs-1==ia&&(s[pt+"_"+ia].r={color:vt.l.color,style:vt.l.style})}else s[pt+"_"+ia].r={color:vt.l.color,style:vt.l.style}}else s[pt+"_"+Tt].l=null;if(vt.r!=null){s[pt+"_"+Tt].r={color:vt.r.color,style:vt.r.style};var Wr=Tt+1;if(Wr<d[0].length&&s[pt+"_"+Wr])if(d[pt]!=null&&D(d[pt][Wr])=="object"&&d[pt][Wr].mc!=null){var Fr=d[pt][Wr];o.merge[Fr.mc.r+"_"+Fr.mc.c].c==Wr&&(s[pt+"_"+Wr].l={color:vt.r.color,style:vt.r.style})}else s[pt+"_"+Wr].l={color:vt.r.color,style:vt.r.style}}else s[pt+"_"+Tt].r=null;if(vt.t!=null){s[pt+"_"+Tt].t={color:vt.t.color,style:vt.t.style};var oa=pt-1;if(oa>=0&&s[oa+"_"+Tt])if(d[oa]!=null&&D(d[oa][Tt])=="object"&&d[oa][Tt].mc!=null){var Fa=d[oa][Tt],Da=o.merge[Fa.mc.r+"_"+Fa.mc.c];Da.r+Da.rs-1==oa&&(s[oa+"_"+Tt].b={color:vt.t.color,style:vt.t.style})}else s[oa+"_"+Tt].b={color:vt.t.color,style:vt.t.style}}else s[pt+"_"+Tt].t=null;if(vt.b!=null){s[pt+"_"+Tt].b={color:vt.b.color,style:vt.b.style};var va=pt+1;if(va<d.length&&s[va+"_"+Tt])if(d[va]!=null&&D(d[va][Tt])=="object"&&d[va][Tt].mc!=null){var Ha=d[va][Tt];o.merge[Ha.mc.r+"_"+Ha.mc.c].r==va&&(s[va+"_"+Tt].t={color:vt.b.color,style:vt.b.style})}else s[va+"_"+Tt].t={color:vt.b.color,style:vt.b.style}}else s[pt+"_"+Tt].b=null}else delete s[pt+"_"+Tt]}}return s}function Ps(e){var n;return e==null?(u.config,n=u.flowdata):(u.luckysheetfile[je(e)].config,n=u.luckysheetfile[je(e)].data),Fp(0,n.length,0,n[0].length,e)}var Mn={iconHtml:'<div id="luckysheet-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="luckysheet-dropCell-typeList" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${copyCell}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${sequence}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${onlyFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="3"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${noFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="4"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${day}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="5"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${workDay}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="6"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${month}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="7"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${year}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="8"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${chineseNumber}</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{:0,:1,:2,:3,:4,:5,:6,:7,:8,:9},chnNameValue:{:{value:10,secUnit:!1},:{value:100,secUnit:!1},:{value:1e3,secUnit:!1},:{value:1e4,secUnit:!0},:{value:1e8,secUnit:!0}},ChineseToNumber:function(e){for(var n=0,t=0,a=0,l=e.split(""),o=0;o<l.length;o++){var d=this.chnNumChar[l[o]];if(d!==void 0)a=d,o==l.length-1&&(t+=a);else{var s=this.chnNameValue[l[o]].value;this.chnNameValue[l[o]].secUnit?(n+=t=(t+a)*s,t=0):t+=a*s,a=0}}return n+t},chnNumChar2:["","","","","","","","","",""],chnUnitSection:["","","","",""],chnUnitChar:["","","",""],SectionToChinese:function(e){for(var n="",t="",a=0,l=!0;e>0;){var o=e%10;o==0?l||(l=!0,t=this.chnNumChar2[o]+t):(l=!1,n=this.chnNumChar2[o],t=(n+=this.chnUnitChar[a])+t),a++,e=Math.floor(e/10)}return t},NumberToChinese:function(e){var n=0,t="",a="",l=!1;if(e==0)return this.chnNumChar2[0];for(;e>0;){var o=e%1e4;l&&(a=this.chnNumChar2[0]+a),t=this.SectionToChinese(o),a=(t+=o!=0?this.chnUnitSection[n]:this.chnUnitSection[0])+a,l=o<1e3&&o>0,e=Math.floor(e/1e4),n++}return a},isChnNumber:function(e){var n=!0;if(e.length==1)n=e==""||e in this.chnNumChar;else for(var t=e.split(""),a=0;a<t.length;a++)if(!(t[a]in this.chnNumChar)&&!(t[a]in this.chnNameValue)){n=!1;break}return n},isExtendNumber:function(e){var n=/0|([1-9]+[0-9]*)/g,t=n.test(e);if(t){var a=e.match(n),l=a[a.length-1],o=e.lastIndexOf(l),d=e.substr(0,o),s=e.substr(o+l.length);return[t,Number(l),d,s]}return[t]},isChnWeek1:function(e){var n;return n=e.length==1&&(e==""||this.ChineseToNumber(e)<7),n},isChnWeek2:function(e){var n;return n=e.length==2&&(e==""||e==""||e==""||e==""||e==""||e==""||e==""),n},isChnWeek3:function(e){var n;return n=e.length==3&&(e==""||e==""||e==""||e==""||e==""||e==""||e==""),n},createIcon:function(){var e,n,t=this,a=t.copyRange.row[1],l=t.copyRange.column[1],o=t.applyRange.row[1],d=t.applyRange.column[1];o>=a&&d>=l?(e=o,n=d):(e=a,n=l);var s=ol(e)[1],h=(ol(e)[0],En(n)[1]);En(n)[0],$("#luckysheet-dropCell-icon").remove(),$("#luckysheet-cell-main").append(t.iconHtml),$("#luckysheet-dropCell-icon").css({left:h,top:s}),$("#luckysheet-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(f){$("#luckysheet-dropCell-typeList").remove();var p=st().dropCell;$("body").append(br(t.typeListHtml,{copyCell:p.copyCell,sequence:p.sequence,onlyFormat:p.onlyFormat,noFormat:p.noFormat,day:p.day,workDay:p.workDay,month:p.month,year:p.year,chineseNumber:p.chineseNumber}));var g=t.typeItemHide();g[0]||g[1]||g[2]||g[3]||g[4]||g[5]||g[6]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide()),g[2]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide()),g[3]||$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide();var v=$(this).offset().left,y=$(this).offset().top+25,b=$(window).height(),k=$(window).width(),w=$("#luckysheet-dropCell-typeList").width(),_=$("#luckysheet-dropCell-typeList").height();v+w>k&&(v-=w),y+_>b&&(y=y-_-38),y<0&&(y=0),$("#luckysheet-dropCell-typeList").css({left:v,top:y}).show(),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});var C=t.applyType;$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type="+C+"]").find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),f.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#luckysheet-dropCell-typeList .luckysheet-cols-menuitem",function(){$("#luckysheet-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');var f=$(this).attr("data-type");t.applyType=f,t.update(),$("#luckysheet-dropCell-typeList").hide(),$("#luckysheet-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),ql()})},typeItemHide:function(){for(var e=this.copyRange,n=e.row[0],t=e.row[1],a=e.column[0],l=e.column[1],o=!1,d=!1,s=!1,h=!1,f=!1,p=!1,g=!1,v=n;v<=t;v++)for(var y=a;y<=l;y++)if(u.flowdata[v][y]){var b=u.flowdata[v][y];D(b)=="object"&&b.v!=null&&b.f==null&&(b.ct!=null&&b.ct.t=="n"?o=!0:b.ct!=null&&b.ct.t=="d"?s=!0:this.isExtendNumber(b.m)[0]?d=!0:this.isChnNumber(b.m)&&b.m!=""?h=!0:b.m==""?f=!0:this.isChnWeek2(b.m)?p=!0:this.isChnWeek3(b.m)&&(g=!0))}return[o,d,s,h,f,p,g]},update:function(){if(wo([this.applyRange],u.currentSheetIndex)&&u.allowEdit!==!1){var e,n=vr.deepCopyFlowData(u.flowdata),t=u.luckysheetfile[je(u.currentSheetIndex)],a=$.extend(!0,{},u.config),l=Ps(),o=$.extend(!0,{},t.dataVerification),d=this.direction,s=(this.applyType,this.copyRange),h=s.row[0],f=s.row[1],p=s.column[0],g=s.column[1],v=this.getCopyData(n,h,f,p,g,d);d=="down"||d=="up"?e=f-h+1:d!="right"&&d!="left"||(e=g-p+1);var y=this.applyRange,b=y.row[0],k=y.row[1],w=y.column[0],_=y.column[1];if(d=="down"||d=="up")for(var C=k-b+1,A=w;A<=_;A++){var I=v[A-w],S=this.getApplyData(I,e,C);if(d=="down")for(var E=b;E<=k;E++){var R=S[E-b];if(R.f!=null){var F="="+m.functionCopy(R.f,"down",E-b+1),N=m.execfunction(F,E,A);if(m.execFunctionGroup(E,A,N[1],void 0,n),R.f=N[2],R.v=N[1],R.spl!=null)R.spl=N[3].data;else if(M(R.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(R.v)){if(R.v==1/0||R.v==-1/0)R.m=R.v.toString();else if(R.v.toString().indexOf("e")>-1){var z=R.v.toString().split(".")[1].split("e")[0].length;z>5&&(z=5),R.m=R.v.toExponential(z).toString()}else{var P=_a(Math.round(1e9*R.v)/1e9);R.m=P[0].toString()}R.ct={fa:"General",t:"n"}}else{var q=_a(R.v);R.m=q[0].toString(),R.ct=q[1]}}n[E][A]=R;var V=h+(E-b)%e,x=A;if(l[V+"_"+x]){var ee={rangeType:"cell",value:{row_index:E,col_index:A,l:l[V+"_"+x].l,r:l[V+"_"+x].r,t:l[V+"_"+x].t,b:l[V+"_"+x].b}};a.borderInfo.push(ee)}else if(l[E+"_"+A]){var ne={rangeType:"cell",value:{row_index:E,col_index:A,l:null,r:null,t:null,b:null}};a.borderInfo.push(ne)}o[V+"_"+x]&&(o[E+"_"+A]=o[V+"_"+x])}if(d=="up")for(var ae=k;ae>=b;ae--){var de=S[k-ae];if(de.f!=null){var ve="="+m.functionCopy(de.f,"up",k-ae+1),U=m.execfunction(ve,ae,A);if(m.execFunctionGroup(ae,A,U[1],void 0,n),de.f=U[2],de.v=U[1],de.spl!=null)de.spl=U[3].data;else if(M(de.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(de.v)){if(de.v==1/0||de.v==-1/0)de.m=de.v.toString();else if(de.v.toString().indexOf("e")>-1){var B=de.v.toString().split(".")[1].split("e")[0].length;B>5&&(B=5),de.m=de.v.toExponential(B).toString()}else{var le=_a(Math.round(1e9*de.v)/1e9);de.m=le[0].toString()}de.ct={fa:"General",t:"n"}}else{var Te=_a(de.v);de.m=Te[0].toString(),de.ct=Te[1]}}n[ae][A]=de;var ue=f-(k-ae)%e,be=A;if(l[ue+"_"+be]){var ye={rangeType:"cell",value:{row_index:ae,col_index:A,l:l[ue+"_"+be].l,r:l[ue+"_"+be].r,t:l[ue+"_"+be].t,b:l[ue+"_"+be].b}};a.borderInfo.push(ye)}else if(l[ae+"_"+A]){var ce={rangeType:"cell",value:{row_index:ae,col_index:A,l:null,r:null,t:null,b:null}};a.borderInfo.push(ce)}o[ue+"_"+be]&&(o[ae+"_"+A]=o[ue+"_"+be])}}else if(d=="right"||d=="left")for(var Re=_-w+1,pe=b;pe<=k;pe++){var me=v[pe-b],re=this.getApplyData(me,e,Re);if(d=="right")for(var _e=w;_e<=_;_e++){var Ze=re[_e-w];if(Ze.f!=null){var We="="+m.functionCopy(Ze.f,"right",_e-w+1),Xe=m.execfunction(We,pe,_e);if(m.execFunctionGroup(_e,pe,Xe[1],void 0,n),Ze.f=Xe[2],Ze.v=Xe[1],Ze.spl!=null)Ze.spl=Xe[3].data;else if(M(Ze.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(Ze.v)){if(Ze.v==1/0||Ze.v==-1/0)Ze.m=Ze.v.toString();else if(Ze.v.toString().indexOf("e")>-1){var Ue=Ze.v.toString().split(".")[1].split("e")[0].length;Ue>5&&(Ue=5),Ze.m=Ze.v.toExponential(Ue).toString()}else{var mt=_a(Math.round(1e9*Ze.v)/1e9);Ze.m=mt[0].toString()}Ze.ct={fa:"General",t:"n"}}else{var St=_a(Ze.v);Ze.m=St[0].toString(),Ze.ct=St[1]}}n[pe][_e]=Ze;var at=pe,dt=p+(_e-w)%e;if(l[at+"_"+dt]){var wt={rangeType:"cell",value:{row_index:pe,col_index:_e,l:l[at+"_"+dt].l,r:l[at+"_"+dt].r,t:l[at+"_"+dt].t,b:l[at+"_"+dt].b}};a.borderInfo.push(wt)}else if(l[pe+"_"+_e]){var ct={rangeType:"cell",value:{row_index:pe,col_index:_e,l:null,r:null,t:null,b:null}};a.borderInfo.push(ct)}o[at+"_"+dt]&&(o[pe+"_"+_e]=o[at+"_"+dt])}if(d=="left")for(var bt=_;bt>=w;bt--){var De=re[_-bt];if(De.f!=null){var He="="+m.functionCopy(De.f,"left",_-bt+1),Dt=m.execfunction(He,pe,bt);if(m.execFunctionGroup(bt,pe,Dt[1],void 0,n),De.f=Dt[2],De.v=Dt[1],De.spl!=null)De.spl=Dt[3].data;else if(M(De.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(De.v)){if(De.v==1/0||De.v==-1/0)De.m=De.v.toString();else if(De.v.toString().indexOf("e")>-1){var et=De.v.toString().split(".")[1].split("e")[0].length;et>5&&(et=5),De.m=De.v.toExponential(et).toString()}else{var ur=_a(Math.round(1e9*De.v)/1e9);De.m=ur[0].toString()}De.ct={fa:"General",t:"n"}}else{var Xt=_a(De.v);De.m=Xt[0].toString(),De.ct=Xt[1]}}n[pe][bt]=De;var jt=pe,lr=g-(_-bt)%e;if(l[jt+"_"+lr]){var tr={rangeType:"cell",value:{row_index:pe,col_index:bt,l:l[jt+"_"+lr].l,r:l[jt+"_"+lr].r,t:l[jt+"_"+lr].t,b:l[jt+"_"+lr].b}};a.borderInfo.push(tr)}else if(l[pe+"_"+bt]){var xr={rangeType:"cell",value:{row_index:pe,col_index:bt,l:null,r:null,t:null,b:null}};a.borderInfo.push(xr)}o[jt+"_"+lr]&&(o[pe+"_"+bt]=o[jt+"_"+lr])}}var rr=$.extend(!0,[],t.luckysheet_conditionformat_save);if(rr!=null&&rr.length>0)for(var nr=0;nr<rr.length;nr++){for(var Ut=rr[nr].cellrange,ar=[],Jt=0;Jt<Ut.length;Jt++){var Qt=kr.CFSplitRange(Ut[Jt],{row:s.row,column:s.column},{row:y.row,column:y.column},"operatePart");Qt.length>0&&(ar=ar.concat(Qt))}ar.length>0&&rr[nr].cellrange.push(y)}var _t={cfg:a,cdformat:rr,dataVerification:o};wa(n,u.luckysheet_select_save,_t),Ra()}},getCopyData:function(e,n,t,a,l,o){var d,s,h,f,p=[];o=="down"||o=="up"?(d=a,s=l,h=n,f=t):o!="right"&&o!="left"||(d=n,s=t,h=a,f=l);for(var g=d;g<=s;g++){for(var v={},y=[],b=[],k="",w=null,_=null,C=!0,A=h;A<=f;A++){var I=void 0;o=="down"||o=="up"?I=e[A][g]:o!="right"&&o!="left"||(I=e[g][A]);var S=void 0;if(I&&I.v&&I.f==null)if(I.ct&&I.ct.t=="n")S="number",w=null,_=null;else if(I.ct&&I.ct.t=="d")S="date",w=null,_=null;else if(this.isExtendNumber(I.m)[0]){S="extendNumber";var E=this.isExtendNumber(I.m);w==null||_==null?(C=!0,w=E[2],_=E[3]):E[2]!=w||E[3]!=_?(C=!1,w=E[2],_=E[3]):C=!0}else this.isChnNumber(I.m)?(S="chnNumber",w=null,_=null):this.isChnWeek2(I.m)?(S="chnWeek2",w=null,_=null):this.isChnWeek3(I.m)?(S="chnWeek3",w=null,_=null):(S="other",w=null,_=null);else S="other",w=null,_=null;S=="extendNumber"?A==h?h==f?(k=S,y.push(I),b.push(A-h+1),v[k]=[],v[k].push({data:y,index:b})):(k=S,y.push(I),b.push(A-h+1)):A==f?k==S&&C?(y.push(I),b.push(A-h+1),k in v||(v[k]=[]),v[k].push({data:y,index:b})):(k in v||(v[k]=[]),v[k].push({data:y,index:b}),k=S,(y=[]).push(I),(b=[]).push(A-h+1),k in v||(v[k]=[]),v[k].push({data:y,index:b})):k==S&&C?(y.push(I),b.push(A-h+1)):(k in v||(v[k]=[]),v[k].push({data:y,index:b}),k=S,(y=[]).push(I),(b=[]).push(A-h+1)):A==h?h==f?(k=S,y.push(I),b.push(A-h+1),v[k]=[],v[k].push({data:y,index:b})):(k=S,y.push(I),b.push(A-h+1)):A==f?k==S?(y.push(I),b.push(A-h+1),k in v||(v[k]=[]),v[k].push({data:y,index:b})):(k in v||(v[k]=[]),v[k].push({data:y,index:b}),k=S,(y=[]).push(I),(b=[]).push(A-h+1),k in v||(v[k]=[]),v[k].push({data:y,index:b})):k==S?(y.push(I),b.push(A-h+1)):(k in v||(v[k]=[]),v[k].push({data:y,index:b}),k=S,(y=[]).push(I),(b=[]).push(A-h+1))}p.push(v)}return p},getApplyData:function(e,n,t){var a=[],l=this.direction,o=this.applyType,d=Math.floor(t/n),s=t%n,h=e.number,f=[];if(h)for(var p=0;p<h.length;p++){var g=this.getLenS(h[p].index,s),v=h[p].index.length*d+g,y=void 0;y=o=="1"||o=="3"?this.getDataByType(h[p].data,v,l,o,"number"):o=="2"?this.getDataByType(h[p].data,v,l,o):this.getDataByType(h[p].data,v,l,"0");var b=this.getDataIndex(n,t,h[p].index);f.push({data:y,index:b})}var k=e.extendNumber,w=[];if(k)for(var _=0;_<k.length;_++){var C=this.getLenS(k[_].index,s),A=k[_].index.length*d+C,I=void 0;I=o=="1"||o=="3"?this.getDataByType(k[_].data,A,l,o,"extendNumber"):o=="2"?this.getDataByType(k[_].data,A,l,o):this.getDataByType(k[_].data,A,l,"0");var S=this.getDataIndex(n,t,k[_].index);w.push({data:I,index:S})}var E=e.date,R=[];if(E)for(var F=0;F<E.length;F++){var N=this.getLenS(E[F].index,s),z=E[F].index.length*d+N,P=void 0;P=o=="1"||o=="3"?this.getDataByType(E[F].data,z,l,o,"date"):o=="8"?this.getDataByType(E[F].data,z,l,"0"):this.getDataByType(E[F].data,z,l,o);var q=this.getDataIndex(n,t,E[F].index);R.push({data:P,index:q})}var V=e.chnNumber,x=[];if(V)for(var ee=0;ee<V.length;ee++){var ne=this.getLenS(V[ee].index,s),ae=V[ee].index.length*d+ne,de=void 0;de=o=="1"||o=="3"?this.getDataByType(V[ee].data,ae,l,o,"chnNumber"):o=="2"||o=="8"?this.getDataByType(V[ee].data,ae,l,o):this.getDataByType(V[ee].data,ae,l,"0");var ve=this.getDataIndex(n,t,V[ee].index);x.push({data:de,index:ve})}var U=e.chnWeek2,B=[];if(U)for(var le=0;le<U.length;le++){var Te=this.getLenS(U[le].index,s),ue=U[le].index.length*d+Te,be=void 0;be=o=="1"||o=="3"?this.getDataByType(U[le].data,ue,l,o,"chnWeek2"):o=="2"?this.getDataByType(U[le].data,ue,l,o):this.getDataByType(U[le].data,ue,l,"0");var ye=this.getDataIndex(n,t,U[le].index);B.push({data:be,index:ye})}var ce=e.chnWeek3,Re=[];if(ce)for(var pe=0;pe<ce.length;pe++){var me=this.getLenS(ce[pe].index,s),re=ce[pe].index.length*d+me,_e=void 0;_e=o=="1"||o=="3"?this.getDataByType(ce[pe].data,re,l,o,"chnWeek3"):o=="2"?this.getDataByType(ce[pe].data,re,l,o):this.getDataByType(ce[pe].data,re,l,"0");var Ze=this.getDataIndex(n,t,ce[pe].index);Re.push({data:_e,index:Ze})}var We=e.other,Xe=[];if(We)for(var Ue=0;Ue<We.length;Ue++){var mt=this.getLenS(We[Ue].index,s),St=We[Ue].index.length*d+mt,at=void 0;at=o=="2"||o=="3"?this.getDataByType(We[Ue].data,St,l,o):this.getDataByType(We[Ue].data,St,l,"0");var dt=this.getDataIndex(n,t,We[Ue].index);Xe.push({data:at,index:dt})}for(var wt=1;wt<=t;wt++){if(f.length>0)for(var ct=0;ct<f.length;ct++)wt in f[ct].index&&a.push(f[ct].data[f[ct].index[wt]]);if(w.length>0)for(var bt=0;bt<w.length;bt++)wt in w[bt].index&&a.push(w[bt].data[w[bt].index[wt]]);if(R.length>0)for(var De=0;De<R.length;De++)wt in R[De].index&&a.push(R[De].data[R[De].index[wt]]);if(x.length>0)for(var He=0;He<x.length;He++)wt in x[He].index&&a.push(x[He].data[x[He].index[wt]]);if(B.length>0)for(var Dt=0;Dt<B.length;Dt++)wt in B[Dt].index&&a.push(B[Dt].data[B[Dt].index[wt]]);if(Re.length>0)for(var et=0;et<Re.length;et++)wt in Re[et].index&&a.push(Re[et].data[Re[et].index[wt]]);if(Xe.length>0)for(var ur=0;ur<Xe.length;ur++)wt in Xe[ur].index&&a.push(Xe[ur].data[Xe[ur].index[wt]])}return a},getLenS:function(e,n){for(var t=0,a=0;a<e.length&&e[a]<=n;a++)t++;return t},getDataIndex:function(e,n,t){var a={},l=Math.floor(n/e),o=n%e,d=0;if(l>0){for(var s=1;s<=l;s++)for(var h=0;h<t.length;h++)a[t[h]+(s-1)*e]=d,d++;for(var f=0;f<t.length&&t[f]<=o;f++)a[t[f]+e*l]=d,d++}else for(var p=0;p<t.length&&t[p]<=o;p++)a[t[p]]=d,d++;return a},getDataByType:function(e,n,t,a,l){var o=[];if(a=="0")t!="up"&&t!="left"||e.reverse(),o=this.FillCopy(e,n);else if(a=="1")if(l=="number")o=this.FillSeries(e,n,t);else if(l=="extendNumber")if(e.length==1){var d;t=="down"||t=="right"?d=1:t!="up"&&t!="left"||(d=-1),o=this.FillExtendNumber(e,n,d)}else{for(var s=[],h=0;h<e.length;h++){var f=e[h].m;s.push(Number(this.isExtendNumber(f)[1]))}if(t!="up"&&t!="left"||(e.reverse(),s.reverse()),this.isEqualDiff(s)){var p=s[1]-s[0];o=this.FillExtendNumber(e,n,p)}else o=this.FillCopy(e,n)}else if(l=="date")if(e.length==1){var g;t=="down"||t=="right"?g=1:t!="up"&&t!="left"||(g=-1),o=this.FillDays(e,n,g)}else{t!="up"&&t!="left"||e.reverse();var v=this.judgeDate(e);if(v[0]&&v[3]){var y=Q(e[1].m).diff(Q(e[0].m),"months");o=this.FillMonths(e,n,y)}else if(!v[0]&&v[2]){var b=Q(e[1].m).diff(Q(e[0].m),"days");o=this.FillDays(e,n,b)}else o=this.FillCopy(e,n)}else if(l=="chnNumber")if(e.length==1){var k,w;e[0].m==""||this.ChineseToNumber(e[0].m)<7?(t=="down"||t=="right"?k=1:t!="up"&&t!="left"||(k=-1),o=this.FillChnWeek(e,n,k)):(t=="down"||t=="right"?w=1:t!="up"&&t!="left"||(w=-1),o=this.FillChnNumber(e,n,w))}else{for(var _=!1,C=0;C<e.length;C++)if(e[C].m==""){_=!0;break}for(var A=[],I=0,S=0;S<e.length;S++)e[S].m==""?S==0?A.push(0):(I++,A.push(7*I)):_&&this.ChineseToNumber(e[S].m)>0&&this.ChineseToNumber(e[S].m)<7?A.push(this.ChineseToNumber(e[S].m)+7*I):A.push(this.ChineseToNumber(e[S].m));if(t!="up"&&t!="left"||(e.reverse(),A.reverse()),this.isEqualDiff(A))if(_||A[A.length-1]<6&&A[0]>0||A[0]<6&&A[A.length-1]>0){var E=A[1]-A[0];o=this.FillChnWeek(e,n,E)}else{var R=A[1]-A[0];o=this.FillChnNumber(e,n,R)}else o=this.FillCopy(e,n)}else if(l=="chnWeek2")if(e.length==1){var F;t=="down"||t=="right"?F=1:t!="up"&&t!="left"||(F=-1),o=this.FillChnWeek2(e,n,F)}else{for(var N=[],z=0,P=0;P<e.length;P++){var q=e[P].m.substr(e[P].m.length-1,1);e[P].m==""?P==0?N.push(0):(z++,N.push(7*z)):N.push(this.ChineseToNumber(q)+7*z)}if(t!="up"&&t!="left"||(e.reverse(),N.reverse()),this.isEqualDiff(N)){var V=N[1]-N[0];o=this.FillChnWeek2(e,n,V)}else o=this.FillCopy(e,n)}else if(l=="chnWeek3")if(e.length==1){var x;t=="down"||t=="right"?x=1:t!="up"&&t!="left"||(x=-1),o=this.FillChnWeek3(e,n,x)}else{for(var ee=[],ne=0,ae=0;ae<e.length;ae++){var de=e[ae].m.substr(e[ae].m.length-1,1);e[ae].m==""?ae==0?ee.push(0):(ne++,ee.push(7*ne)):ee.push(this.ChineseToNumber(de)+7*ne)}if(t!="up"&&t!="left"||(e.reverse(),ee.reverse()),this.isEqualDiff(ee)){var ve=ee[1]-ee[0];o=this.FillChnWeek3(e,n,ve)}else o=this.FillCopy(e,n)}else t!="up"&&t!="left"||e.reverse(),o=this.FillCopy(e,n);else if(a=="2")t!="up"&&t!="left"||e.reverse(),o=this.FillOnlyFormat(e,n);else if(a=="3"){var U=this.getDataByType(e,n,t,"1",l);o=this.FillWithoutFormat(U)}else if(a=="4"){var B;if(e.length==1)t=="down"||t=="right"?B=1:t!="up"&&t!="left"||(B=-1),o=this.FillDays(e,n,B);else if(e.length==2){t!="up"&&t!="left"||e.reverse();var le=Q(e[1].m).diff(Q(e[0].m),"days");o=this.FillDays(e,n,le)}else{t!="up"&&t!="left"||e.reverse();var Te=this.judgeDate(e);if(Te[0]&&Te[3]){var ue=Q(e[1].m).diff(Q(e[0].m),"months");o=this.FillMonths(e,n,ue)}else if(!Te[0]&&Te[2]){var be=Q(e[1].m).diff(Q(e[0].m),"days");o=this.FillDays(e,n,be)}else o=this.FillCopy(e,n)}}else if(a=="5")if(e.length==1){var ye;t=="down"||t=="right"?ye=1:t!="up"&&t!="left"||(ye=-1);for(var ce=Math.round(1.5*n),Re=1;Re<=ce;Re++){var pe=$.extend(!0,{},e[0]),me=Q(pe.m).add(Re,"days").day();if(me!=0&&me!=6){var re=Q(pe.m).add(ye*Re,"days").format("YYYY-MM-DD");if(pe.m=re,pe.v=_a(re)[2],o.push(pe),o.length==n)break}}}else if(e.length==2)if(Q(e[1].m).date()==Q(e[0].m).date()&&Q(e[1].m).diff(Q(e[0].m),"months")!=0){t!="up"&&t!="left"||e.reverse();for(var _e=Q(e[1].m).diff(Q(e[0].m),"months"),Ze=1;Ze<=n;Ze++){var We=(Ze-1)%e.length,Xe=$.extend(!0,{},e[We]),Ue=Q(e[e.length-1]).add(_e*Ze,"months").day(),mt=void 0;mt=Ue==0?Q(e[e.length-1]).add(_e*Ze,"months").subtract(2,"days").format("YYYY-MM-DD"):Ue==6?Q(e[e.length-1]).add(_e*Ze,"months").subtract(1,"days").format("YYYY-MM-DD"):Q(e[e.length-1]).add(_e*Ze,"months").format("YYYY-MM-DD"),Xe.m=mt,Xe.v=_a(mt)[2],o.push(Xe)}}else if(Math.abs(Q(e[1].m).diff(Q(e[0].m)))>7){var St,at;t=="down"||t=="right"?St=1:t!="up"&&t!="left"||(St=-1,e.reverse());for(var dt=1;dt<=n;dt++){var wt=(dt-1)%e.length,ct=$.extend(!0,{},e[wt]),bt=Math.ceil(dt/e.length);wt==0&&(at=Q(ct.m).add(St*bt,"months").diff(Q(ct.m),"days"));var De=Q(ct.m).add(at,"days").day(),He=void 0;He=De==0?Q(ct.m).add(at,"days").subtract(2,"days").format("YYYY-MM-DD"):De==6?Q(ct.m).add(at,"days").subtract(1,"days").format("YYYY-MM-DD"):Q(ct.m).add(at,"days").format("YYYY-MM-DD"),ct.m=He,ct.v=_a(He)[2],o.push(ct)}}else{var Dt,et;t=="down"||t=="right"?Dt=7:t!="up"&&t!="left"||(Dt=-7,e.reverse());for(var ur=1;ur<=n;ur++){var Xt=(ur-1)%e.length,jt=$.extend(!0,{},e[Xt]),lr=Math.ceil(ur/e.length);Xt==0&&(et=Q(jt.m).add(Dt*lr,"days").diff(Q(jt.m),"days"));var tr=Q(jt.m).add(et,"days").day(),xr=void 0;xr=tr==0?Q(jt.m).add(et,"days").subtract(2,"days").format("YYYY-MM-DD"):tr==6?Q(jt.m).add(et,"days").subtract(1,"days").format("YYYY-MM-DD"):Q(jt.m).add(et,"days").format("YYYY-MM-DD"),jt.m=xr,jt.v=_a(xr)[2],o.push(jt)}}else{var rr=this.judgeDate(e);if(rr[0]&&rr[3]){t!="up"&&t!="left"||e.reverse();for(var nr=Q(e[1].m).diff(Q(e[0].m),"months"),Ut=1;Ut<=n;Ut++){var ar=(Ut-1)%e.length,Jt=$.extend(!0,{},e[ar]),Qt=Q(e[e.length-1].m).add(nr*Ut,"months").day(),_t=void 0;_t=Qt==0?Q(e[e.length-1].m).add(nr*Ut,"months").subtract(2,"days").format("YYYY-MM-DD"):Qt==6?Q(e[e.length-1].m).add(nr*Ut,"months").subtract(1,"days").format("YYYY-MM-DD"):Q(e[e.length-1].m).add(nr*Ut,"months").format("YYYY-MM-DD"),Jt.m=_t,Jt.v=_a(_t)[2],o.push(Jt)}}else if(!rr[0]&&rr[2])if(Math.abs(Q(e[1].m).diff(Q(e[0].m)))>7){var er,Kt;t=="down"||t=="right"?er=1:t!="up"&&t!="left"||(er=-1,e.reverse());for(var mr=1;mr<=n;mr++){var fr=(mr-1)%e.length,Wt=$.extend(!0,{},e[fr]),ze=Math.ceil(mr/e.length);fr==0&&(Kt=Q(Wt.m).add(er*ze,"months").diff(Q(Wt.m),"days"));var Ae=Q(Wt.m).add(Kt,"days").day(),Ve=void 0;Ve=Ae==0?Q(Wt.m).add(Kt,"days").subtract(2,"days").format("YYYY-MM-DD"):Ae==6?Q(Wt.m).add(Kt,"days").subtract(1,"days").format("YYYY-MM-DD"):Q(Wt.m).add(Kt,"days").format("YYYY-MM-DD"),Wt.m=Ve,Wt.v=_a(Ve)[2],o.push(Wt)}}else{var gt,vt;t=="down"||t=="right"?gt=7:t!="up"&&t!="left"||(gt=-7,e.reverse());for(var pt=1;pt<=n;pt++){var Tt=(pt-1)%e.length,Ot=$.extend(!0,{},e[Tt]),It=Math.ceil(pt/e.length);Tt==0&&(vt=Q(Ot.m).add(gt*It,"days").diff(Q(Ot.m),"days"));var Lt=Q(Ot.m).add(vt,"days").day(),At=void 0;At=Lt==0?Q(Ot.m).add(vt,"days").subtract(2,"days").format("YYYY-MM-DD"):Lt==6?Q(Ot.m).add(vt,"days").subtract(1,"days").format("YYYY-MM-DD"):Q(Ot.m).add(vt,"days").format("YYYY-MM-DD"),Ot.m=At,Ot.v=_a(At)[2],o.push(Ot)}}else t!="up"&&t!="left"||e.reverse(),o=this.FillCopy(e,n)}else if(a=="6"){var or;if(e.length==1)t=="down"||t=="right"?or=1:t!="up"&&t!="left"||(or=-1),o=this.FillMonths(e,n,or);else if(e.length==2)if(Q(e[1].m).date()==Q(e[0].m).date()&&Q(e[1].m).diff(Q(e[0].m),"months")!=0){t!="up"&&t!="left"||e.reverse();var Cr=Q(e[1].m).diff(Q(e[0].m),"months");o=this.FillMonths(e,n,Cr)}else{var Ar,Rr;t=="down"||t=="right"?Ar=1:t!="up"&&t!="left"||(Ar=-1,e.reverse());for(var Zr=1;Zr<=n;Zr++){var Tr=(Zr-1)%e.length,jr=$.extend(!0,{},e[Tr]),ta=Math.ceil(Zr/e.length);Tr==0&&(Rr=Q(jr.m).add(Ar*ta,"months").diff(Q(jr.m),"days"));var ia=Q(jr.m).add(Rr,"days").format("YYYY-MM-DD");jr.m=ia,jr.v=_a(ia)[2],o.push(jr)}}else{var Jr=this.judgeDate(e);if(Jr[0]&&Jr[3]){t!="up"&&t!="left"||e.reverse();var ba=Q(e[1].m).diff(Q(e[0].m),"months");o=this.FillMonths(e,n,ba)}else if(!Jr[0]&&Jr[2]){var Wr,Fr;t=="down"||t=="right"?Wr=1:t!="up"&&t!="left"||(Wr=-1,e.reverse());for(var oa=1;oa<=n;oa++){var Fa=(oa-1)%e.length,Da=$.extend(!0,{},e[Fa]),va=Math.ceil(oa/e.length);Fa==0&&(Fr=Q(Da.m).add(Wr*va,"months").diff(Q(Da.m),"days"));var Ha=Q(Da.m).add(Fr,"days").format("YYYY-MM-DD");Da.m=Ha,Da.v=_a(Ha)[2],o.push(Da)}}else t!="up"&&t!="left"||e.reverse(),o=this.FillCopy(e,n)}}else if(a=="7"){var qr;if(e.length==1)t=="down"||t=="right"?qr=1:t!="up"&&t!="left"||(qr=-1),o=this.FillYears(e,n,qr);else if(e.length==2)if(Q(e[1].m).date()==Q(e[0].m).date()&&Q(e[1].m).month()==Q(e[0].m).month()&&Q(e[1].m).diff(Q(e[0].m),"years")!=0){t!="up"&&t!="left"||e.reverse();var Ca=Q(e[1].m).diff(Q(e[0].m),"years");o=this.FillYears(e,n,Ca)}else{var La,Ea;t=="down"||t=="right"?La=1:t!="up"&&t!="left"||(La=-1,e.reverse());for(var Za=1;Za<=n;Za++){var gn=(Za-1)%e.length,Ka=$.extend(!0,{},e[gn]),ka=Math.ceil(Za/e.length);gn==0&&(Ea=Q(Ka.m).add(La*ka,"years").diff(Q(Ka.m),"days"));var Pa=Q(Ka.m).add(Ea,"days").format("YYYY-MM-DD");Ka.m=Pa,Ka.v=_a(Pa)[2],o.push(Ka)}}else{var $a=this.judgeDate(e);if($a[0]&&$a[1]&&$a[4]){t!="up"&&t!="left"||e.reverse();var on=Q(e[1].m).diff(Q(e[0].m),"years");o=this.FillYears(e,n,on)}else if($a[0]&&$a[3]||$a[2]){var Dn,Fn;t=="down"||t=="right"?Dn=1:t!="up"&&t!="left"||(Dn=-1,e.reverse());for(var _n=1;_n<=n;_n++){var dl=(_n-1)%e.length,Or=$.extend(!0,{},e[dl]),en=Math.ceil(_n/e.length);dl==0&&(Fn=Q(Or.m).add(Dn*en,"years").diff(Q(Or.m),"days"));var hn=Q(Or.m).add(Fn,"days").format("YYYY-MM-DD");Or.m=hn,Or.v=_a(hn)[2],o.push(Or)}}else t!="up"&&t!="left"||e.reverse(),o=this.FillCopy(e,n)}}else if(a=="8")if(e.length==1){var tn;t=="down"||t=="right"?tn=1:t!="up"&&t!="left"||(tn=-1),o=this.FillChnNumber(e,n,tn)}else{for(var Sn=[],vn=0;vn<e.length;vn++)Sn.push(this.ChineseToNumber(e[vn].m));if(t!="up"&&t!="left"||(e.reverse(),Sn.reverse()),this.isEqualDiff(Sn)){var Kn=Sn[1]-Sn[0];o=this.FillChnNumber(e,n,Kn)}else o=this.FillCopy(e,n)}return o},FillCopy:function(e,n){for(var t=[],a=1;a<=n;a++){var l=(a-1)%e.length,o=$.extend(!0,{},e[l]);t.push(o)}return t},FillSeries:function(e,n,t){for(var a=[],l=[],o=0;o<e.length;o++)l.push(Number(e[o].v));if(e.length>2&&this.isEqualRatio(l))for(var d=1;d<=n;d++){var s=(d-1)%e.length,h=$.extend(!0,{},e[s]),f=void 0;t=="down"||t=="right"?f=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),d):t!="up"&&t!="left"||(f=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),d)),h.v=f,h.m=za(h.ct.fa,f),a.push(h)}else for(var p=this.getXArr(e.length),g=1;g<=n;g++){var v=(g-1)%e.length,y=$.extend(!0,{},e[v]),b=void 0;t=="down"||t=="right"?b=this.forecast(e.length+g,l,p):t!="up"&&t!="left"||(b=this.forecast(1-g,l,p)),y.v=b,y.m=za(y.ct.fa,b),a.push(y)}return a},FillExtendNumber:function(e,n,t){for(var a=[],l=/0|([1-9]+[0-9]*)/g,o=1;o<=n;o++){var d=(o-1)%e.length,s=$.extend(!0,{},e[d]),h=e[e.length-1].m,f=h.match(l),p=f[f.length-1],g=Math.abs(Number(p)+t*o),v=h.lastIndexOf(p),y=h.substr(0,v)+g.toString()+h.substr(v+p.length);s.v=y,s.m=y,a.push(s)}return a},FillOnlyFormat:function(e,n){for(var t=[],a=1;a<=n;a++){var l=(a-1)%e.length,o=$.extend(!0,{},e[l]);delete o.f,delete o.m,delete o.v,t.push(o)}return t},FillWithoutFormat:function(e){for(var n=[],t=0;t<e.length;t++){var a=$.extend(!0,{},e[t]),l=void 0;l=a.f==null?{m:a.v.toString(),v:a.v}:{f:a.f,m:a.v.toString(),v:a.v},n.push(l)}return n},FillDays:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=za("yyyy-MM-dd",d.v);s=Q(s).add(t*l,"days").format("YYYY-MM-DD"),d.v=_a(s)[2],d.m=za(d.ct.fa,d.v),a.push(d)}return a},FillMonths:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=za("yyyy-MM-dd",d.v);s=Q(s).add(t*l,"months").format("YYYY-MM-DD"),d.v=_a(s)[2],d.m=za(d.ct.fa,d.v),a.push(d)}return a},FillYears:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=za("yyyy-MM-dd",d.v);s=Q(s).add(t*l,"years").format("YYYY-MM-DD"),d.v=_a(s)[2],d.m=za(d.ct.fa,d.v),a.push(d)}return a},FillChnWeek:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=void 0;(s=e[e.length-1].m==""?7+t*l:this.ChineseToNumber(e[e.length-1].m)+t*l)<0&&(s=7*Math.ceil(Math.abs(s)/7)+s);var h=s%7;h==0?(d.m="",d.v=""):h==1?(d.m="",d.v=""):h==2?(d.m="",d.v=""):h==3?(d.m="",d.v=""):h==4?(d.m="",d.v=""):h==5?(d.m="",d.v=""):h==6&&(d.m="",d.v=""),a.push(d)}return a},FillChnWeek2:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=void 0;if(e[e.length-1].m=="")s=7+t*l;else{var h=e[e.length-1].m,f=h.substr(h.length-1,1);s=this.ChineseToNumber(f)+t*l}s<0&&(s=7*Math.ceil(Math.abs(s)/7)+s);var p=s%7;p==0?(d.m="",d.v=""):p==1?(d.m="",d.v=""):p==2?(d.m="",d.v=""):p==3?(d.m="",d.v=""):p==4?(d.m="",d.v=""):p==5?(d.m="",d.v=""):p==6&&(d.m="",d.v=""),a.push(d)}return a},FillChnWeek3:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=void 0;if(e[e.length-1].m=="")s=7+t*l;else{var h=e[e.length-1].m,f=h.substr(h.length-1,1);s=this.ChineseToNumber(f)+t*l}s<0&&(s=7*Math.ceil(Math.abs(s)/7)+s);var p=s%7;p==0?(d.m="",d.v=""):p==1?(d.m="",d.v=""):p==2?(d.m="",d.v=""):p==3?(d.m="",d.v=""):p==4?(d.m="",d.v=""):p==5?(d.m="",d.v=""):p==6&&(d.m="",d.v=""),a.push(d)}return a},FillChnNumber:function(e,n,t){for(var a=[],l=1;l<=n;l++){var o=(l-1)%e.length,d=$.extend(!0,{},e[o]),s=this.ChineseToNumber(e[e.length-1].m)+t*l,h=void 0;h=s<=0?"":this.NumberToChinese(s),d.v=h,d.m=h.toString(),a.push(d)}return a},isEqualDiff:function(e){for(var n=!0,t=e[1]-e[0],a=1;a<e.length;a++)if(e[a]-e[a-1]!=t){n=!1;break}return n},isEqualRatio:function(e){for(var n=!0,t=e[1]/e[0],a=1;a<e.length;a++)if(e[a]/e[a-1]!=t){n=!1;break}return n},getXArr:function(e){for(var n=[],t=1;t<=e;t++)n.push(t);return n},forecast:function(e,n,t){function a(g){for(var v=0,y=0;y<g.length;y++)v+=g[y];return v/g.length}for(var l,o=a(t),d=a(n),s=0,h=0,f=0;f<t.length;f++)s+=(t[f]-o)*(n[f]-d),h+=(t[f]-o)*(t[f]-o);var p=d-(l=h==0?1:s/h)*o;return Math.round(1e5*(p+l*e))/1e5},judgeDate:function(e){for(var n=!0,t=!0,a=!0,l=!0,o=!0,d=Q(e[0].m).date(),s=Q(e[0].m).month(),h=Q(e[1].m).diff(Q(e[0].m),"days"),f=Q(e[1].m).diff(Q(e[0].m),"months"),p=Q(e[1].m).diff(Q(e[0].m),"years"),g=1;g<e.length;g++)Q(e[g].m).date()!=d&&(n=!1),Q(e[g].m).month()!=s&&(t=!1),Q(e[g].m).diff(Q(e[g-1].m),"days")!=h&&(a=!1),Q(e[g].m).diff(Q(e[g-1].m),"months")!=f&&(l=!1),Q(e[g].m).diff(Q(e[g-1].m),"years")!=p&&(o=!1);return h==0&&(a=!1),f==0&&(l=!1),p==0&&(o=!1),[n,t,a,l,o]}},Ne={freezenHorizontalHTML:'<div id="luckysheet-freezebar-horizontal" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="luckysheet-freezebar-vertical" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,windowHeight:null,windowWidth:null,freezenhorizontaldata:null,freezenverticaldata:null,cutVolumn:function(e,n){if(n<=0)return e;var t=e.slice(0,n);return t[t.length-1],e.slice(n)},cancelFreezenVertical:function(e){var n=st().freezen;$("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+n.freezenColumn),this.freezenverticaldata=null;var t=$("#luckysheet-freezebar-vertical").is(":visible");$("#luckysheet-freezebar-vertical").hide(),e==null&&(e=u.currentSheetIndex);var a=u.luckysheetfile[je(e)];a.freezen!=null&&(a.freezen.vertical=null),a.frozen!=null&&t&&nt.saveParam("all",e,a.frozen,{k:"frozen"})},createFreezenVertical:function(e,n){var t=this;if(t.initialVertical){t.initialVertical=!1,$("#luckysheet-grid-window-1").append(t.freezenVerticalHTML),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").mousedown(function(){t.verticalmovestate=!0,t.verticalmoveposition=$(this).position().left,t.windowWidth=$("#luckysheet-grid-window-1").width(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grabbing")});var a=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:a-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".luckysheet-freezebar-vertical-drop").css({height:a-10,width:"4px",top:"0px",cursor:"-webkit-grab"})}if(e==null){var l=$("#luckysheet-cell-main").scrollLeft(),o=fa(u.visibledatacolumn,l);o==-1&&(o=0),n=u.visibledatacolumn[o]-2-l+u.rowHeaderWidth,e=[u.visibledatacolumn[o],o+1,l,t.cutVolumn(u.visibledatacolumn,o+1),n],t.saveFreezen(null,null,e,n)}t.freezenverticaldata=e;var d=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        `.concat(st().freezen.freezenCancel,`
                    </div>
                </div>
            </div>
        `);$("#luckysheet-freezen-btn-horizontal").html(d),$("#luckysheet-freezebar-vertical").show().find(".luckysheet-freezebar-vertical-handle").css({left:n}).end().find(".luckysheet-freezebar-vertical-drop").css({left:n})},saveFreezen:function(e,n,t,a){var l=u.luckysheetfile[je(u.currentSheetIndex)];l.freezen==null&&(l.freezen={}),e!=null&&(l.freezen.horizontal==null&&(l.freezen.horizontal={}),l.freezen.horizontal.freezenhorizontaldata=e,l.freezen.horizontal.top=n),t!=null&&(l.freezen.vertical==null&&(l.freezen.vertical={}),l.freezen.vertical.freezenverticaldata=t,l.freezen.vertical.left=a),l.frozen!=null&&nt.saveParam("all",u.currentSheetIndex,l.frozen,{k:"frozen"})},initialFreezen:function(e){this.frozenTofreezen();var n=u.luckysheetfile[je(e)];n.freezen!=null&&n.freezen.horizontal!=null&&n.freezen.horizontal.freezenhorizontaldata!=null?this.createFreezenHorizontal(n.freezen.horizontal.freezenhorizontaldata,n.freezen.horizontal.top):this.cancelFreezenHorizontal(e),n.freezen!=null&&n.freezen.vertical!=null&&n.freezen.vertical.freezenverticaldata!=null?this.createFreezenVertical(n.freezen.vertical.freezenverticaldata,n.freezen.vertical.left):this.cancelFreezenVertical(e),this.createAssistCanvas()},changeFreezenIndex:function(e,n){if(n=="v"&&this.freezenverticaldata!=null){var t=this.freezenverticaldata[1],a=fa(u.visibledatacolumn,$("#luckysheet-cell-main").scrollLeft());e-a<t&&(e-=a)}else if(n=="h"&&this.freezenhorizontaldata!=null){var l=this.freezenhorizontaldata[1],o=fa(u.visibledatarow,$("#luckysheet-cell-main").scrollTop());e-o<l&&(e-=o)}return e},scrollFreezen:function(){var e,n,t=u.luckysheet_select_save[0].row_focus;t==u.luckysheet_select_save[0].row[0]?e=u.luckysheet_select_save[0].row[1]:t==u.luckysheet_select_save[0].row[1]&&(e=u.luckysheet_select_save[0].row[0]);var a=u.luckysheet_select_save[0].column_focus;if(a==u.luckysheet_select_save[0].column[0]?n=u.luckysheet_select_save[0].column[1]:a==u.luckysheet_select_save[0].column[1]&&(n=u.luckysheet_select_save[0].column[0]),this.freezenverticaldata!=null){var l=this.freezenverticaldata[1],o=fa(this.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()),d=this.freezenverticaldata[4];l+=o,n>=u.visibledatacolumn.length&&(n=u.visibledatacolumn.length-1),l>=u.visibledatacolumn.length&&(l=u.visibledatacolumn.length-1),u.visibledatacolumn[n]<=u.visibledatacolumn[l]+d&&(console.log(1111),setTimeout(function(){$("#luckysheet-scrollbar-x").scrollLeft(0)},100))}if(this.freezenhorizontaldata!=null){var s=this.freezenhorizontaldata[1],h=fa(this.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()),f=this.freezenhorizontaldata[4];s+=h,e>=u.visibledatarow.length&&(e=u.visibledatarow.length-1),s>=u.visibledatarow.length&&(s=u.visibledatarow.length-1),u.visibledatarow[e]<=u.visibledatarow[s]+f&&setTimeout(function(){$("#luckysheet-scrollbar-y").scrollTop(0)},100)}},cancelFreezenHorizontal:function(e){var n=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        `.concat(st().freezen.default,`
                    </div>
                </div>
            </div>
        `);$("#luckysheet-freezen-btn-horizontal").html(n),this.freezenhorizontaldata=null;var t=$("#luckysheet-freezebar-horizontal").is(":visible");$("#luckysheet-freezebar-horizontal").hide(),e==null&&(e=u.currentSheetIndex);var a=u.luckysheetfile[je(e)];a.freezen!=null&&(a.freezen.horizontal=null),a.frozen!=null&&t&&nt.saveParam("all",e,a.frozen,{k:"frozen"})},createFreezenHorizontal:function(e,n){var t=this;if(t.initialHorizontal){t.initialHorizontal=!1,$("#luckysheet-grid-window-1").append(t.freezenHorizontalHTML),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").mousedown(function(){t.horizontalmovestate=!0,t.horizontalmoveposition=$(this).position().top,t.windowHeight=$("#luckysheet-grid-window-1").height(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")});var a=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:a-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:a-10,height:"4px",left:"0px",cursor:"-webkit-grab"})}if(e==null){var l=$("#luckysheet-cell-main").scrollTop(),o=fa(u.visibledatarow,l);o==-1&&(o=0),n=u.visibledatarow[o]-2-l+u.columnHeaderHeight,e=[u.visibledatarow[o],o+1,l,t.cutVolumn(u.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null)}t.freezenhorizontaldata=e;var d=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        `.concat(st().freezen.freezenCancel,`
                    </div>
                </div>
            </div>
        `);$("#luckysheet-freezen-btn-horizontal").html(d),$("#luckysheet-freezebar-horizontal").show().find(".luckysheet-freezebar-horizontal-handle").css({top:n}).end().find(".luckysheet-freezebar-horizontal-drop").css({top:n})},createAssistCanvas:function(){if(this.removeAssistCanvas(),this.freezenverticaldata!=null||this.freezenhorizontaldata!=null){var e,n,t,a,l=u.luckysheetTableContentHW[0],o=u.luckysheetTableContentHW[1];this.freezenverticaldata!=null&&this.freezenhorizontaldata!=null?(e=this.freezenhorizontaldata[0],this.freezenhorizontaldata[1],n=this.freezenhorizontaldata[2],t=this.freezenverticaldata[0],this.freezenverticaldata[1],a=this.freezenverticaldata[2],this.createCanvas("freezen_3",t-a,e-n+1,u.rowHeaderWidth-1,u.columnHeaderHeight-1),this.createCanvas("freezen_4",l-t+a,e-n+1,t-a+u.rowHeaderWidth-1,u.columnHeaderHeight-1),this.createCanvas("freezen_7",t-a,o-e+n-u.columnHeaderHeight,u.rowHeaderWidth-1,e-n+u.columnHeaderHeight-1)):this.freezenhorizontaldata!=null?(e=this.freezenhorizontaldata[0],this.freezenhorizontaldata[1],n=this.freezenhorizontaldata[2],this.createCanvas("freezen_h",l,e-n+1,u.rowHeaderWidth-1,u.columnHeaderHeight-1)):this.freezenverticaldata!=null&&(t=this.freezenverticaldata[0],this.freezenverticaldata[1],a=this.freezenverticaldata[2],this.createCanvas("freezen_v",t-a,o,u.rowHeaderWidth-1,u.columnHeaderHeight-1)),this.scrollAdapt()}},createCanvas:function(e,n,t,a,l){$("<canvas/>").appendTo("#luckysheet-grid-window-1").attr({id:e,width:Math.ceil(n*u.devicePixelRatio),height:Math.ceil(t*u.devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:a,top:l,width:n,height:t,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#luckysheet-grid-window-1 > canvas").not($("#luckysheetTableContent")).remove(),$("#luckysheet-cell-selected").css("z-index",15)},scrollAdapt:function(){if(u.luckysheet_select_save!=null&&u.luckysheet_select_save.length>0&&this.scrollAdaptOfselect(),$("#luckysheet-cell-main .luckysheet-data-visualization-chart").length>0){var e=u.luckysheetfile[je(u.currentSheetIndex)].chart;e!=null&&e.length>0&&this.scrollAdaptOfchart()}$("#luckysheet-postil-showBoxs .luckysheet-postil-show").length>0&&this.scrollAdaptOfpostil(),$("#luckysheet-dropCell-icon").length>0&&this.scrollAdaptOfdpicon(),$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").length>0&&this.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){$("#luckysheet-row-count-show").is(":visible")&&$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").is(":visible")&&$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty();var e=$("#luckysheet-cell-main").scrollTop(),n=$("#luckysheet-cell-main").scrollLeft();if(this.freezenhorizontaldata!=null&&this.freezenverticaldata!=null)for(var t=this.freezenhorizontaldata[0],a=this.freezenhorizontaldata[1],l=e-this.freezenhorizontaldata[2],o=this.freezenverticaldata[0],d=this.freezenverticaldata[1],s=n-this.freezenverticaldata[2],h=0;h<u.luckysheet_select_save.length;h++){var f=$.extend(!0,{},u.luckysheet_select_save[h]),p=f.row[0],g=f.row[1],v=u.visibledatarow[g],y=p-1==-1?0:u.visibledatarow[p-1],b=y,k=v-y-1,w=!0;p>=a?b+k<t+l?w=!1:b<t+l?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({top:t+l,height:k-(t+l-b)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({top:b,height:k}):g>=a?b+k<t+l?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({top:b+l,height:t-b}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({top:b+l,height:k-l}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css("top",b+l);var _=f.column[0],C=f.column[1],A=u.visibledatacolumn[C],I=_-1==-1?0:u.visibledatacolumn[_-1],S=I,E=A-I-1;if(_>=d?S+E<o+s?w=!1:S<o+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({left:o+s,width:E-(o+s-S)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({left:S,width:E}):C>=d?S+E<o+s?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({left:S+s,width:o-S}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css({left:S+s,width:E-s}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).show().css("left",S+s),w||$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(h).hide(),h==u.luckysheet_select_save.length-1){var R=f.row_focus==null?p:f.row_focus,F=f.column_focus==null?_:f.column_focus,N=u.visibledatarow[R],z=R-1==-1?0:u.visibledatarow[R-1],P=u.visibledatacolumn[F],q=F-1==-1?0:u.visibledatacolumn[F-1],V=dr.mergeborer(u.flowdata,R,F);V&&(N=V.row[1],z=V.row[0],P=V.column[1],q=V.column[0]);var x=z,ee=N-z-1,ne=q,ae=P-q-1,de=!0;x>=t?x+ee<t+l?de=!1:x<t+l?$("#luckysheet-cell-selected-focus").show().css({top:t+l,height:ee-(t+l-x)}):$("#luckysheet-cell-selected-focus").show().css({top:x,height:ee}):x+ee>=t?x+ee<t+l?$("#luckysheet-cell-selected-focus").show().css({top:x+l,height:t-x}):$("#luckysheet-cell-selected-focus").show().css({top:x+l,height:ee-l}):$("#luckysheet-cell-selected-focus").show().css("top",x+l),ne>=o?ne+ae<o+s?de=!1:ne<o+s?$("#luckysheet-cell-selected-focus").show().css({left:o+s,width:ae-(o+s-ne)}):$("#luckysheet-cell-selected-focus").show().css({left:ne,width:ae}):ne+ae>=o?ne+ae<o+s?$("#luckysheet-cell-selected-focus").show().css({left:ne+s,width:o-ne}):$("#luckysheet-cell-selected-focus").show().css({left:ne+s,width:ae-s}):$("#luckysheet-cell-selected-focus").show().css("left",ne+s),de||$("#luckysheet-cell-selected-focus").hide()}}else if(this.freezenhorizontaldata!=null)for(var ve=this.freezenhorizontaldata[0],U=this.freezenhorizontaldata[1],B=e-this.freezenhorizontaldata[2],le=0;le<u.luckysheet_select_save.length;le++){var Te=$.extend(!0,{},u.luckysheet_select_save[le]),ue=Te.row[0],be=Te.row[1],ye=u.visibledatarow[be],ce=ue-1==-1?0:u.visibledatarow[ue-1],Re=ce,pe=ye-ce-1;if(ue>=U?Re+pe<ve+B?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(le).hide():Re<ve+B?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(le).show().css({top:ve+B,height:pe-(ve+B-Re)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(le).show().css({top:Re,height:pe}):be>=U?Re+pe<ve+B?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(le).show().css({top:Re+B,height:ve-Re}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(le).show().css({top:Re+B,height:pe-B}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(le).show().css("top",Re+B),le==u.luckysheet_select_save.length-1){var me=Te.row_focus==null?ue:Te.row_focus,re=Te.column_focus==null?Te.column[0]:Te.column_focus,_e=u.visibledatarow[me],Ze=me-1==-1?0:u.visibledatarow[me-1],We=dr.mergeborer(u.flowdata,me,re);We&&(_e=We.row[1],Ze=We.row[0]);var Xe=Ze,Ue=_e-Ze-1;Xe>=ve?Xe+Ue<ve+B?$("#luckysheet-cell-selected-focus").hide():Xe<ve+B?$("#luckysheet-cell-selected-focus").show().css({top:ve+B,height:Ue-(ve+B-Xe)}):$("#luckysheet-cell-selected-focus").show().css({top:Xe,height:Ue}):Xe+Ue>=ve?Xe+Ue<ve+B?$("#luckysheet-cell-selected-focus").show().css({top:Xe+B,height:ve-Xe}):$("#luckysheet-cell-selected-focus").show().css({top:Xe+B,height:Ue-B}):$("#luckysheet-cell-selected-focus").show().css("top",Xe+B)}}else if(this.freezenverticaldata!=null)for(var mt=this.freezenverticaldata[0],St=this.freezenverticaldata[1],at=n-this.freezenverticaldata[2],dt=0;dt<u.luckysheet_select_save.length;dt++){var wt=$.extend(!0,{},u.luckysheet_select_save[dt]),ct=wt.column[0],bt=wt.column[1],De=u.visibledatacolumn[bt],He=ct-1==-1?0:u.visibledatacolumn[ct-1],Dt=He,et=De-He-1;if(ct>=St?Dt+et<mt+at?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(dt).hide():Dt<mt+at?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(dt).show().css({left:mt+at,width:et-(mt+at-Dt)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(dt).show().css({left:Dt,width:et}):bt>=St?Dt+et<mt+at?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(dt).show().css({left:Dt+at,width:mt-Dt}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(dt).show().css({left:Dt+at,width:et-at}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(dt).show().css("left",Dt+at),dt==u.luckysheet_select_save.length-1){var ur=wt.row_focus==null?wt.row[0]:wt.row_focus,Xt=wt.column_focus==null?ct:wt.column_focus,jt=u.visibledatacolumn[Xt],lr=Xt-1==-1?0:u.visibledatacolumn[Xt-1],tr=dr.mergeborer(u.flowdata,ur,Xt);tr&&(jt=tr.column[1],lr=tr.column[0]);var xr=lr,rr=jt-lr-1;xr>=mt?xr+rr<mt+at?$("#luckysheet-cell-selected-focus").hide():xr<mt+at?$("#luckysheet-cell-selected-focus").show().css({left:mt+at,width:rr-(mt+at-xr)}):$("#luckysheet-cell-selected-focus").show().css({left:xr,width:rr}):xr+rr>=mt?xr+rr<mt+at?$("#luckysheet-cell-selected-focus").show().css({left:xr+at,width:mt-xr}):$("#luckysheet-cell-selected-focus").show().css({left:xr+at,width:rr-at}):$("#luckysheet-cell-selected-focus").show().css("left",xr+at)}}else Ra()},scrollAdaptOfchart:function(){var e=$("#luckysheet-cell-main").scrollTop(),n=$("#luckysheet-cell-main").scrollLeft();if(this.freezenhorizontaldata!=null&&this.freezenverticaldata!=null){var t=this.freezenhorizontaldata[0]-this.freezenhorizontaldata[2],a=this.freezenverticaldata[0]-this.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(d,s){var h=$(s).position(),f=$(s).width(),p=$(s).height(),g=$(s).find("canvas").width(),v=$(s).find("canvas").height(),y=v-p,b=g-f;if(h.top-y<t){var k=t-(h.top-y);k>v+40+2?$(s).css("visibility","hidden"):($(s).css({top:t+e,height:v-k,visibility:"visible"}),$(s).find("canvas").css("top",-k))}else $(s).css({top:h.top-y+e,height:v,visibility:"visible"}),$(s).find("canvas").css("top",0);if(h.left-b<a){var w=a-(h.left-b);w>g+20+2?$(s).css("visibility","hidden"):($(s).css({left:a+n,width:g-w,visibility:"visible"}),$(s).find("canvas").css("left",-w))}else $(s).css({left:h.left-b+n,width:g,visibility:"visible"}),$(s).find("canvas").css("left",0)})}else if(this.freezenhorizontaldata!=null){var l=this.freezenhorizontaldata[0]-this.freezenhorizontaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(d,s){var h=$(s).position(),f=$(s).height(),p=$(s).find("canvas").height(),g=p-f;if(h.top-g<l){var v=l-(h.top-g);v>p+40+2?$(s).css("visibility","hidden"):($(s).css({top:l+e,height:p-v,visibility:"visible"}),$(s).find("canvas").css("top",-v))}else $(s).css({top:h.top-g+e,height:p,visibility:"visible"}),$(s).find("canvas").css("top",0)})}else if(this.freezenverticaldata!=null){var o=this.freezenverticaldata[0]-this.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(d,s){var h=$(s).position(),f=$(s).width(),p=$(s).find("canvas").width(),g=p-f;if(h.left-g<o){var v=o-(h.left-g);v>p+20+2?$(s).css("visibility","hidden"):($(s).css({left:o+n,width:p-v,visibility:"visible"}),$(s).find("canvas").css("left",-v))}else $(s).css({left:h.left-g+n,width:p,visibility:"visible"}),$(s).find("canvas").css("left",0)})}else $("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(d,s){var h=$(s).position(),f=$(s).width(),p=$(s).height(),g=$(s).find("canvas").width(),v=$(s).find("canvas").height(),y=v-p,b=g-f;$(s).css({top:h.top-y+e,height:v,left:h.left-b+n,width:g,visibility:"visible"}),$(s).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){var e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){var a=e.freezenhorizontaldata[0],l=e.freezenverticaldata[0],o=n-e.freezenhorizontaldata[2],d=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(g,v){var y=$(v).attr("id"),b=y.split("luckysheet-postil-show_")[1].split("_")[0],k=y.split("luckysheet-postil-show_")[1].split("_")[1],w=u.flowdata[b][k].ps,_=(u.visibledatarow[b],b-1==-1?0:u.visibledatarow[b-1]),C=u.visibledatacolumn[k],A=(k-1==-1||u.visibledatacolumn[k-1],dr.mergeborer(u.flowdata,b,k));A&&(A.row[1],_=A.row[0],C=A.column[1],A.column[0]);var I=C,S=_,E=w.left==null?I+18:w.left,R=w.top==null?S-18:w.top,F=w.width==null?Lr.defaultWidth:w.width,N=w.height==null?Lr.defaultHeight:w.height;R<0&&(R=2);var z=Lr.getArrowCanvasSize(E,R,I,S),P=!0,q=!0;b>=e.freezenhorizontaldata[1]?R+N<a?($(v).show().find(".luckysheet-postil-show-main").css("top",R+o),$(v).show().find(".arrowCanvas").css("top",z[1]+o)):R<a+o?R+N<=a+o?P=!1:($(v).show().find(".luckysheet-postil-show-main").css({top:a+o,height:N-(a+o-R)}),$(v).show().find(".formulaInputFocus").css("margin-top",-(a+o-R)),$(v).show().find(".arrowCanvas").hide(),q=!1):($(v).show().find(".luckysheet-postil-show-main").css({top:R,height:N}),$(v).show().find(".formulaInputFocus").css("margin-top",0),$(v).show().find(".arrowCanvas").css("top",z[1])):($(v).show().find(".luckysheet-postil-show-main").css("top",R+o),$(v).show().find(".arrowCanvas").css("top",z[1]+o)),k>=e.freezenverticaldata[1]?E+F<l?($(v).show().find(".luckysheet-postil-show-main").css("left",E+d),$(v).show().find(".arrowCanvas").css("left",z[0]+d)):E<l+d?E+F<=l+d?P=!1:($(v).show().find(".luckysheet-postil-show-main").css({left:l+d,width:F-(l+d-E)}),$(v).show().find(".formulaInputFocus").css("margin-left",-(l+d-E)),$(v).show().find(".arrowCanvas").hide(),q=!1):($(v).show().find(".luckysheet-postil-show-main").css({left:E,width:F}),$(v).show().find(".formulaInputFocus").css("margin-left",0),$(v).show().find(".arrowCanvas").css("left",z[0])):($(v).show().find(".luckysheet-postil-show-main").css("left",E+d),$(v).show().find(".arrowCanvas").css("left",z[0]+d)),P||$(v).hide(),P&&q&&$(v).show().find(".arrowCanvas").show()})}else if(e.freezenhorizontaldata!=null){var s=e.freezenhorizontaldata[0],h=n-e.freezenhorizontaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(g,v){var y=$(v).attr("id"),b=y.split("luckysheet-postil-show_")[1].split("_")[0],k=y.split("luckysheet-postil-show_")[1].split("_")[1],w=u.flowdata[b][k].ps,_=(u.visibledatarow[b],b-1==-1?0:u.visibledatarow[b-1]),C=u.visibledatacolumn[k],A=(k-1==-1||u.visibledatacolumn[k-1],dr.mergeborer(u.flowdata,b,k));A&&(A.row[1],_=A.row[0],C=A.column[1],A.column[0]);var I=C,S=_,E=w.left==null?I+18:w.left,R=w.top==null?S-18:w.top,F=(w.width==null?Lr.defaultWidth:w.width,w.height==null?Lr.defaultHeight:w.height);R<0&&(R=2);var N=Lr.getArrowCanvasSize(E,R,I,S);b>=e.freezenhorizontaldata[1]?R+F<s?($(v).show().find(".luckysheet-postil-show-main").css("top",R+h),$(v).show().find(".arrowCanvas").css("top",N[1]+h)):R<s+h?R+F<=s+h?$(v).hide():($(v).show().find(".luckysheet-postil-show-main").css({top:s+h,height:F-(s+h-R)}),$(v).show().find(".formulaInputFocus").css("margin-top",-(s+h-R)),$(v).show().find(".arrowCanvas").hide()):Lr.buildPs(b,k,w):($(v).show().find(".luckysheet-postil-show-main").css("top",R+h),$(v).show().find(".arrowCanvas").css("top",N[1]+h))})}else if(e.freezenverticaldata!=null){var f=e.freezenverticaldata[0],p=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(g,v){var y=$(v).attr("id"),b=y.split("luckysheet-postil-show_")[1].split("_")[0],k=y.split("luckysheet-postil-show_")[1].split("_")[1],w=u.flowdata[b][k].ps,_=(u.visibledatarow[b],b-1==-1?0:u.visibledatarow[b-1]),C=u.visibledatacolumn[k],A=(k-1==-1||u.visibledatacolumn[k-1],dr.mergeborer(u.flowdata,b,k));A&&(A.row[1],_=A.row[0],C=A.column[1],A.column[0]);var I=C,S=_,E=w.left==null?I+18:w.left,R=w.top==null?S-18:w.top,F=w.width==null?Lr.defaultWidth:w.width;w.height==null?Lr.defaultHeight:w.height,R<0&&(R=2);var N=Lr.getArrowCanvasSize(E,R,I,S);k>=e.freezenverticaldata[1]?E+F<f?($(v).show().find(".luckysheet-postil-show-main").css("left",E+p),$(v).show().find(".arrowCanvas").css("left",N[0]+p)):E<f+p?E+F<=f+p?$(v).hide():($(v).show().find(".luckysheet-postil-show-main").css({left:f+p,width:F-(f+p-E)}),$(v).show().find(".formulaInputFocus").css("margin-left",-(f+p-E)),$(v).show().find(".arrowCanvas").hide()):Lr.buildPs(b,k,w):($(v).show().find(".luckysheet-postil-show-main").css("left",E+p),$(v).show().find(".arrowCanvas").css("left",N[0]+p))})}else $("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(g,v){var y=$(v).attr("id"),b=y.split("luckysheet-postil-show_")[1].split("_")[0],k=y.split("luckysheet-postil-show_")[1].split("_")[1],w=u.flowdata[b][k].ps;Lr.buildPs(b,k,w)})},scrollAdaptOfdpicon:function(){var e,n,t=Mn.copyRange.row[1],a=Mn.copyRange.column[1],l=Mn.applyRange.row[1],o=Mn.applyRange.column[1];if(l>=t&&o>=a?(e=l,n=o):(e=t,n=a),this.freezenhorizontaldata!=null&&this.freezenverticaldata!=null){var d=this.freezenhorizontaldata[1],s=fa(this.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-this.freezenhorizontaldata[2]),h=this.freezenverticaldata[1],f=fa(this.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-this.freezenverticaldata[2]);if(e>=d&&n>=h)e<d+s-1||n<h+f-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else if(e>=d)if(e<d+s-1)$("#luckysheet-dropCell-icon").hide();else{var p=En(n+f)[1];$("#luckysheet-dropCell-icon").show().css("left",p)}else if(n>=h)if(n<h+f-1)$("#luckysheet-dropCell-icon").hide();else{var g=ol(e+s)[1];$("#luckysheet-dropCell-icon").show().css("top",g)}else{var v=ol(e+s)[1],y=En(n+f)[1];$("#luckysheet-dropCell-icon").show().css({left:y,top:v})}}else if(this.freezenhorizontaldata!=null){var b=this.freezenhorizontaldata[1],k=fa(this.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-this.freezenhorizontaldata[2]);if(e>=b)e<b+k-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{var w=ol(e+k)[1];$("#luckysheet-dropCell-icon").show().css("top",w)}}else if(this.freezenverticaldata!=null){var _=this.freezenverticaldata[1],C=fa(this.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-this.freezenverticaldata[2]);if(n>=_)n<_+C-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{var A=En(n+C)[1];$("#luckysheet-dropCell-icon").show().css("left",A)}}else{var I=ol(e)[1],S=En(n)[1];$("#luckysheet-dropCell-icon").show().css({left:S,top:I})}},scrollAdaptOffilteroptions:function(){if(this.freezenhorizontaldata!=null&&this.freezenverticaldata!=null){var e=this.freezenhorizontaldata[1],n=this.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),t=this.freezenverticaldata[1],a=fa(this.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-this.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").each(function(h,f){var p=$(f).data("str"),g=p-1==-1?0:u.visibledatarow[p-1],v=$(f).data("cindex");if(p>=e&&v>=t)g<n||v<t+a?$(f).hide():$(f).show();else if(p>=e)if(g<n)$(f).hide();else{var y=u.visibledatacolumn[v+a]-20;$(f).show().css("left",y)}else if(v>=t)v<t+a?$(f).hide():$(f).show().css("top",g+$("#luckysheet-cell-main").scrollTop());else{var b=u.visibledatacolumn[v+a]-20;$(f).show().css({left:b,top:g+$("#luckysheet-cell-main").scrollTop()})}})}else if(this.freezenhorizontaldata!=null){var l=this.freezenhorizontaldata[1],o=this.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").each(function(h,f){var p=$(f).data("str"),g=p-1==-1?0:u.visibledatarow[p-1];p>=l?g<o?$(f).hide():$(f).show():$(f).show().css("top",g+$("#luckysheet-cell-main").scrollTop())})}else if(this.freezenverticaldata!=null){var d=this.freezenverticaldata[1],s=fa(this.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-this.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").each(function(h,f){var p=$(f).data("cindex");if(p>=d)p<d+s?$(f).hide():$(f).show();else{var g=u.visibledatacolumn[p+s]-20;$(f).show().css("left",g)}})}else $("#luckysheet-filter-options-sheet"+u.currentSheetIndex).empty(),gi(u.luckysheetfile[je(u.currentSheetIndex)].filter_select)},saveFrozen:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};n==null&&(n=je(u.currentSheetIndex));var a=u.luckysheet_select_save[u.luckysheet_select_save.length-1],l=a.row_focus==null?a.row[0]:a.row_focus,o=a.column_focus==null?a.column[0]:a.column_focus,d={row_focus:t.row_focus||l,column_focus:t.column_focus||o},s={freezenRow:{type:"row"},freezenColumn:{type:"column"},freezenRC:{type:"both"},freezenRowRange:{type:"rangeRow",range:d},freezenColumnRange:{type:"rangeColumn",range:d},freezenRCRange:{type:"rangeBoth",range:d},freezenCancel:{type:"cancel"}};u.luckysheetfile[n].frozen=s[e]},frozenTofreezen:function(){var e=u.luckysheetfile[je(u.currentSheetIndex)],n=e.frozen;if(n!=null){var t=null;if(n.type==="row"){var a=fa(u.visibledatarow,0);a==-1&&(a=0);var l=u.visibledatarow[a]-2-0+u.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[u.visibledatarow[a],a+1,0,Ne.cutVolumn(u.visibledatarow,a+1),l],top:l}}}else if(n.type==="column"){var o=fa(u.visibledatacolumn,0);o==-1&&(o=0);var d=u.visibledatacolumn[o]-2-0+u.rowHeaderWidth;t={vertical:{freezenverticaldata:[u.visibledatacolumn[o],o+1,0,Ne.cutVolumn(u.visibledatacolumn,o+1),d],left:d}}}else if(n.type==="both"){var s=fa(u.visibledatarow,0);s==-1&&(s=0);var h=u.visibledatarow[s]-2-0+u.columnHeaderHeight,f=[u.visibledatarow[s],s+1,0,Ne.cutVolumn(u.visibledatarow,s+1),h],p=fa(u.visibledatacolumn,0);p==-1&&(p=0);var g=u.visibledatacolumn[p]-2-0+u.rowHeaderWidth;t={horizontal:{freezenhorizontaldata:f,top:h},vertical:{freezenverticaldata:[u.visibledatacolumn[p],p+1,0,Ne.cutVolumn(u.visibledatacolumn,p+1),g],left:g}}}else if(n.type==="rangeRow"){var v=fa(u.visibledatarow,0),y=n.range.row_focus;y>v&&(v=y),v==-1&&(v=0);var b=u.visibledatarow[v]-2-0+u.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[u.visibledatarow[v],v+1,0,Ne.cutVolumn(u.visibledatarow,v+1),b],top:b}}}else if(n.type==="rangeColumn"){var k=fa(u.visibledatacolumn,0),w=n.range.column_focus;w>k&&(k=w),k==-1&&(k=0);var _=u.visibledatacolumn[k]-2-0+u.rowHeaderWidth;t={vertical:{freezenverticaldata:[u.visibledatacolumn[k],k+1,0,Ne.cutVolumn(u.visibledatacolumn,k+1),_],left:_}}}else if(n.type==="rangeBoth"){var C=fa(u.visibledatarow,0),A=n.range.row_focus;A>C&&(C=A),C==-1&&(C=0);var I=u.visibledatarow[C]-2-0+u.columnHeaderHeight,S=[u.visibledatarow[C],C+1,0,Ne.cutVolumn(u.visibledatarow,C+1),I],E=fa(u.visibledatacolumn,0),R=n.range.column_focus;R>E&&(E=R),E==-1&&(E=0);var F=u.visibledatacolumn[E]-2-0+u.rowHeaderWidth;t={horizontal:{freezenhorizontaldata:S,top:I},vertical:{freezenverticaldata:[u.visibledatacolumn[E],E+1,0,Ne.cutVolumn(u.visibledatacolumn,E+1),F],left:F}}}else n.type==="cancel"&&(t={horizontal:null,vertical:null});e.freezen=t}}},ls=0,Vh=0;function Rn(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];Nt.showinfobar?($("#luckysheet_info_detail").show(),u.infobarHeight=document.querySelector("#luckysheet_info_detail").offsetHeight):(u.infobarHeight=0,$("#luckysheet_info_detail").hide()),u.toobarObject&&u.toobarObject.toobarElements&&u.toobarObject.toobarElements.length===0?($("#"+u.container).find(".luckysheet-wa-editor").hide(),u.toolbarHeight=0):($("#"+u.container).find(".luckysheet-wa-editor").show(),u.toolbarHeight=document.querySelector("#"+u.container+" .luckysheet-wa-editor").offsetHeight),ub(),cb();var n=document.querySelector("#"+u.container+" .luckysheet-wa-calculate");Nt.sheetFormulaBar?(n.style.display="block",u.calculatebarHeight=n.offsetHeight):(n.style.display="none",u.calculatebarHeight=0),$("#"+u.container).find(".luckysheet-grid-container").css("top",u.toolbarHeight+u.infobarHeight+u.calculatebarHeight),ls=$("#"+u.container).width(),Nt.showConfigWindowResize&&($("#luckysheet-modal-dialog-slider-pivot").is(":visible")?ls-=$("#luckysheet-modal-dialog-slider-pivot").outerWidth():$(".chartSetting").is(":visible")?ls-=$(".chartSetting").outerWidth():$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")&&(ls-=$("#luckysheet-modal-dialog-slider-alternateformat").outerWidth()),$("#luckysheet-modal-dialog-slider-protection").is(":visible")&&(ls-=$("#luckysheet-modal-dialog-slider-protection").outerWidth()));var t=st(),a=t.toolbar,l=!1,o='<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="'.concat(a.toolMoreTip,`" id="luckysheet-icon-morebtn" role="button" style="user-select: none;"> 
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> 
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                        `).concat(a.toolMore,`
                    </div> 
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                    </div>

                </div> 
            </div>
         </div>`),d='<div id="luckysheet-icon-morebtn-div" class="luckysheet-wa-editor" style="position:absolute;top:'+(u.infobarHeight+u.toolbarHeight+$("#"+u.container).offset().top+$("body").scrollTop())+'px; right:0px;z-index:1003;padding:5.5px;display:none;height:auto;white-space:initial;"></div>';$("#luckysheet-icon-morebtn-div").length==0&&$("body").append(d),$("#luckysheet-icon-morebtn-div").hide(),$("#luckysheet-icon-morebtn-div > div").each(function(){var w=$(this)[0],_=$("#luckysheet-wa-editor")[0];_.appendChild(document.createTextNode(" ")),_.appendChild(w)}),$("#luckysheet-icon-morebtn").remove();var s=u.toobarObject.toobarWidths,h=u.toobarObject.toobarElements,f=0;if(s!=null){for(var p=s.length-1;p>=0;p--)if(s[p]<ls-90){(f=p)<s.length-1&&(l=!0);break}for(var g=f;g<h.length;g++){var v=h[g];if(v instanceof Array){var y,b=sf(v);try{for(b.s();!(y=b.n()).done;){var k=y.value;$("#luckysheet-icon-morebtn-div").append($("".concat(k)))}}catch(w){b.e(w)}finally{b.f()}}else $("#luckysheet-icon-morebtn-div").append($("".concat(v)))}l&&($("#luckysheet-wa-editor").append(o),$("#luckysheet-icon-morebtn").click(function(){var w=$(window).width()-$("#luckysheet-icon-morebtn").offset().left-$("#luckysheet-icon-morebtn").width()+$("body").scrollLeft();if($("#luckysheet-icon-morebtn-div").toggle().css("right",w<0?0:w),$(this).find(".luckysheet-toolbar-menu-button-caption").text().indexOf(a.toolMore)>-1){var _=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    `.concat(a.toolClose,`
                </div> 
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-shangyige" style="user-select: none;font-size:12px;">
                </div>
                `);$(this).find(".luckysheet-toolbar-button-inner-box").html(_)}else{var C=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    `.concat(a.toolMore,`
                </div> 
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                </div>
                `);$(this).find(".luckysheet-toolbar-button-inner-box").html(C)}}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),Ee.createHoverTip("#luckysheet-icon-morebtn-div",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button")),$("#"+u.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#"+u.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),Vh=$("#"+u.container).height(),$("#"+u.container).find(".luckysheet").height(Vh-2).width(ls-2),qp(ls,Vh),e&&Kr($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop()),ir.sheetArrowShowAndHide(),ir.sheetBarShowAndHide()}}function qp(e,n){e==null&&(e=$("#"+u.container).width()),n==null&&(n=$("#"+u.container).height()),u.cellmainHeight=n-(u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight+u.sheetBarHeight+u.statisticBarHeight),u.cellmainWidth=e-u.rowHeaderWidth,$("#luckysheet-cols-h-c, #luckysheet-cell-main").width(u.cellmainWidth),$("#luckysheet-cell-main").height(u.cellmainHeight),$("#luckysheet-rows-h").height(u.cellmainHeight-u.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").height(u.cellmainHeight+u.columnHeaderHeight-u.cellMainSrollBarSize-3),$("#luckysheet-scrollbar-x").height(u.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").width(u.cellMainSrollBarSize),$("#luckysheet-scrollbar-x").width(u.cellmainWidth).css("left",u.rowHeaderWidth-2),u.luckysheetTableContentHW=[u.cellmainWidth+u.rowHeaderWidth-u.cellMainSrollBarSize,u.cellmainHeight+u.columnHeaderHeight-u.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(u.luckysheetTableContentHW[0]*u.devicePixelRatio),height:Math.ceil(u.luckysheetTableContentHW[1]*u.devicePixelRatio)}).css({width:u.luckysheetTableContentHW[0],height:u.luckysheetTableContentHW[1]}),$("#"+u.container).find("#luckysheet-grid-window-1").css("bottom",u.sheetBarHeight),$("#"+u.container).find(".luckysheet-grid-window").css("bottom",u.statisticBarHeight);var t=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:t-10}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:t-10});var a=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:a-10}).end().find(".luckysheet-freezebar-vertical-drop").css({height:a-10}),Ne.createAssistCanvas()}function ub(){if(!Nt.initShowsheetbarConfig){Nt.initShowsheetbarConfig=!0;var e={add:!0,menu:!0,sheet:!0};if(!Nt.showsheetbar)for(var n in e)e[n]=!1;JSON.stringify(Nt.showsheetbarConfig)!=="{}"&&Object.assign(e,Nt.showsheetbarConfig),Nt.showsheetbarConfig=e}var t=Nt.showsheetbarConfig,a=0;for(var l in t)if(!t[l])switch(l){case"add":$("#luckysheet-sheets-add").hide(),a++;break;case"menu":$("#luckysheet-sheets-m").hide(),a++;break;case"sheet":$("#luckysheet-sheet-container").hide(),$("#luckysheet-sheets-leftscroll").hide(),$("#luckysheet-sheets-rightscroll").hide(),a++}a===3?($("#"+u.container).find("#luckysheet-sheet-area").hide(),u.sheetBarHeight=0):($("#"+u.container).find("#luckysheet-sheet-area").show(),u.sheetBarHeight=31)}function cb(){if(!Nt.initStatisticBarConfig){Nt.initStatisticBarConfig=!0;var e={count:!0,view:!0,zoom:!0};if(!Nt.showstatisticBar)for(var n in e)e[n]=!1;JSON.stringify(Nt.showstatisticBarConfig)!=="{}"&&Object.assign(e,Nt.showstatisticBarConfig),Nt.showstatisticBarConfig=e}var t=Nt.showstatisticBarConfig,a=0;for(var l in t)if(!t[l])switch(l){case"count":$("#luckysheet-sta-content").hide(),a++;break;case"view":$(".luckysheet-print-viewList").hide(),a++;break;case"zoom":$("#luckysheet-zoom-content").hide(),a++}a===3?($("#"+u.container).find(".luckysheet-stat-area").hide(),u.statisticBarHeight=0):($("#"+u.container).find(".luckysheet-stat-area").show(),u.statisticBarHeight=23)}var Mp=!1,Np=!1,to=[],Uh=!0,Lp=null,dd=null,Pp=null,Hh=!0,jh={},Op=!1,vu=["selectLockedCells","selectunLockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","filter","usePivotTablereports","editObjects","editScenarios"];function zp(e){var n=st(),t=n.protection,a=n.button,l=e.name,o=e.sqref,d=e.password,s="";d!=null&&d.length>0&&(s='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>');var h=`
        <div class="luckysheet-protection-rangeItem" title="`.concat(t.rangeItemDblclick,`">
            <div class="luckysheet-protection-rangeItem-del" title="`).concat(a.delete,`">
                <i class="icon iconfont luckysheet-iconfont-shanchu"></i>
            </div>
            <div class="luckysheet-protection-rangeItem-name" title="`).concat(l,`">
                `).concat(l).concat(s,`
            </div>
            <div class="luckysheet-protection-rangeItem-range" title="`).concat(o,`">
                `).concat(o,`
            </div>
            <div class="luckysheet-protection-rangeItem-update" title="`).concat(a.update,`">
                <i class="icon iconfont luckysheet-iconfont-bianji"></i>
            </div>
        </div>
    `);$("#luckysheet-protection-rangeItem-container").append(h)}function Bp(e){if(!Np){Np=!0;var n=st(),t=n.protection,a=n.button;$("body").append(br(Ga,{id:"luckysheet-protection-rangeItem-dialog",addclass:"luckysheet-protection-rangeItem-dialog",title:t.allowRangeTitle,content:`
            <div class="luckysheet-protection-rangeItem-content">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        `.concat(t.allowRangeAddTitle,`
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-title"  placeHolder="`).concat(t.allowRangeAddtitleDefault,`">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        `).concat(t.allowRangeAddSqrf,`
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <div id="protection-allowRangeAdd-range" class="range">
                            <input class="formulaInputFocus" spellcheck="false" placeHolder="`).concat(t.selectCellRangeHolder,`">
                            <i class="fa fa-table" aria-hidden="true" title="`).concat(t.selectCellRange,`"></i>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        `).concat(t.allowRangeAddTitlePassword,`
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-password"  placeHolder="`).concat(t.enterPassword,`">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        `).concat(t.allowRangeAddTitleHint,`
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <textarea class="luckysheet-protection-rangeItemTextarea" id="protection-allowRangeAdd-hint"  placeHolder="`).concat(t.allowRangeAddTitleHintTitle,`"></textarea>
                    </div>
                </div>
            </div>
        `),botton:'<button id="luckysheet-protection-rangeItem-confirm" class="btn btn-primary">'.concat(a.insert,`</button>
                    <button class="btn btn-default luckysheet-model-close-btn">`).concat(a.cancel,"</button>"),style:"z-index:100003"}))}}function Gh(e){e==null&&(e={});for(var n=0;n<vu.length;n++){var t=vu[n],a="luckysheet-protection-check-"+t,l=e[t];l==null&&(l=0),l==null&&t in{selectLockedCells:1,selectunLockedCells:1}&&(l=1),$("#"+a).prop("checked",l==1)}e.password!=null&&e.password.length>0?e.algorithmName=="None"||e.algorithmName==null?$("#protection-password").val(e.password):$("#protection-password").val(""):$("#protection-password").val("");var o=e.sheet;e.sheet==null&&(o=0),$("#protection-swichProtectionState").prop("checked",o==1);var d=e.hintText;d==null&&(d=""),$("#protection-hint").val(d),to=[],$("#luckysheet-protection-rangeItem-container").empty();var s=e.allowRangeList;if(s!=null&&s.length>0)for(var h=0;h<s.length;h++){var f=s[h];zp(f),to.push(f)}}function db(e){var n,t,a;if(Mp||(function(o){for(var d=st(),s=d.protection,h=d.button,f="",p=0;p<vu.length;p++){var g=vu[p];f+=`
            <div class="luckysheet-slider-protection-row" style="height:18px;">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                <label for="luckysheet-protection-check-`.concat(g,'"><input id="luckysheet-protection-check-').concat(g,'" name="luckysheet-protection-check-').concat(g,'" type="checkbox">').concat(s[g],`</label>
                </div>
            </div>
        `)}var v=`
    <div id="luckysheet-modal-dialog-slider-protection" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot" style="display:none;">
        <div class="luckysheet-modal-dialog-slider-title"> <span>`.concat(s.protectiontTitle,'</span> <span id="luckysheet-modal-dialog-protection-close" title="').concat(h.close,`"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-slider-protection-config" style="top:10px;height:115px">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <label for="protection-swichProtectionState"><input id="protection-swichProtectionState" name="protection-swichProtectionState" type="checkbox">`).concat(s.swichProtectionTip,`</label>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:23px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <input class="luckysheet-protection-input" id="protection-password"  placeHolder="`).concat(s.enterPassword,`">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:47px;margin-top:4px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <textarea class="luckysheet-protection-textarea" id="protection-hint"  placeHolder="`).concat(s.enterHintTitle,`"></textarea>
                    </div>
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="top:130px;height:290px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:20px;">
                    `).concat(s.authorityTitle,`
                </div>
                `).concat(f,`
            </div>
            <div class="luckysheet-slider-protection-config" style="top:440px;bottom:45px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:25px;">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:0px;line-height: 25px;">
                        `).concat(s.allowRangeTitle,`
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x" style="left:70%;">
                        <div class="luckysheet-slider-protection-ok luckysheet-slider-protection-addRange" id="luckysheet-slider-protection-addRange">
                            `).concat(s.allowRangeAdd,`
                        </div>
                    </div>
                </div>

                <div id="luckysheet-protection-rangeItem-container" class="luckysheet-slider-protection-row" style="top:25px;bottom:0px;position:absolute">
                   
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="bottom:0px;height:45px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:0px;">
                    <div class="luckysheet-slider-protection-ok" id="luckysheet-slider-protection-ok">
                        `).concat(h.confirm,`
                    </div>
                </div>
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:50%;">
                    <div class="luckysheet-slider-protection-cancel" id="luckysheet-slider-protection-cancel">
                        `).concat(h.cancel,`
                    </div>
                </div>
            </div>
        </div>
    </div>
    `);$("body").append(v),$("body").append(br(Ga,{id:"luckysheet-protection-sheet-validation",addclass:"luckysheet-protection-sheet-validation",title:s.validationTitle,content:`
            <div class="luckysheet-slider-protection-row">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    `.concat(s.validationTips,`
                </div>
            </div>
            <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="`).concat(s.validationInputHint,`">
                </div>
            </div>
        `),botton:'<button id="luckysheet-protection-sheet-validation-confirm" class="btn btn-primary">'.concat(h.confirm,`</button>
                    <button class="btn btn-default luckysheet-model-close-btn">`).concat(h.cancel,"</button>"),style:"z-index:100003"}))}(),n=st(),t=n.protection,a=n.button,$("#luckysheet-slider-protection-ok").click(function(){var o=$("#protection-password").val(),d=$("#protection-swichProtectionState").is(":checked"),s=$("#protection-hint").val(),h=Pp,f={};h!=null&&h.config!=null&&h.config.authority!=null&&(f=h.config.authority);var p={};o!=""?(p.password=o,p.algorithmName="None",p.saltValue=null):f!=null?(p.algorithmName=f.algorithmName,p.saltValue=f.saltValue,p.password=f.password):(p.algorithmName="None",p.saltValue=null,p.password=""),p.hintText=s,p.sheet=d==1?1:0;for(var g=0;g<vu.length;g++){var v=vu[g],y=$("#luckysheet-protection-check-"+v).is(":checked");p[v]=y==1?1:0}p.allowRangeList=to,to=[],Hh=!0,h.config==null&&(h.config={}),h.config.authority=p,jh={},Vp()}),$("#luckysheet-slider-protection-cancel, #luckysheet-modal-dialog-protection-close").click(function(){Vp()}),$("#luckysheet-slider-protection-addRange").click(function(){Bp(),Uh=!0,$("#luckysheet-protection-rangeItem-confirm").html(a.insert),Ec("luckysheet-protection-rangeItem-dialog"),$("#protection-allowRangeAdd-title").val("Default"+to.length),$("#protection-allowRangeAdd-range input").val(""),$("#protection-allowRangeAdd-password").val(""),$("#protection-allowRangeAdd-hint").val("")}),$(document).off("click.luckysheetProtection.rangeItemUpdate").on("click.luckysheetProtection.rangeItemUpdate","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-update",function(o){Bp(),Uh=!1,$("#luckysheet-protection-rangeItem-confirm").html(a.update),Ec("luckysheet-protection-rangeItem-dialog");var d=$(o.target).closest(".luckysheet-protection-rangeItem"),s=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(d),h=to[s];Lp=s,$("#protection-allowRangeAdd-title").val(h.name),$("#protection-allowRangeAdd-range input").val(h.sqref),h.algorithmName=="None"?$("#protection-allowRangeAdd-password").val(h.password):$("#protection-allowRangeAdd-password").val(""),$("#protection-allowRangeAdd-hint").val(h.hintText)}),$(document).off("click.luckysheetProtection.rangeItemDelete").on("click.luckysheetProtection.rangeItemDelete","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-del",function(o){var d=$(o.target).closest(".luckysheet-protection-rangeItem"),s=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(d);to[s],to.splice(s,1),d.remove()}),$(document).off("click.luckysheetProtection.rangeItemConfirm").on("click.luckysheetProtection.rangeItemConfirm","#luckysheet-protection-rangeItem-confirm",function(){var o=$("#protection-allowRangeAdd-title").val(),d=$("#protection-allowRangeAdd-range input").val(),s=$("#protection-allowRangeAdd-password").val(),h=$("#protection-allowRangeAdd-hint").val();if(o.length!=0){var f=aa.getRangeByTxt(d);if(d.length!=0)if(f.length!=0){if(d=function(w){if(w==null||w.length==0)return null;for(var _=w.split(","),C="",A=0;A<_.length;A++){var I=_[A].split("!"),S="",E="";I.length>1?(S=I[0],E=I[1]):E=I[0];for(var R=E.split(":"),F="",N=0;N<R.length;N++){var z=R[N],P=z.replace(/[^0-9]/g,""),q=z.replace(/[^A-Za-z]/g,""),V="";q!=""&&(V+="$"+q),P!=""&&(V+="$"+P),F+=V+":"}F=F.substr(0,F.length-1),C+=S+F+","}return C.substr(0,C.length-1)}(d),Uh){var p={name:o,password:s,hintText:h,algorithmName:"None",saltValue:null,checkRangePasswordUrl:null,sqref:d};zp(p),to.push(p)}else{var g=Lp,v=to[g];v.name=o,v.sqref=d,v.hintText=h,s!=""&&(v.password=s,v.algorithmName="None");var y=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").eq(g),b=y.find(".luckysheet-protection-rangeItem-name"),k="";s!=null&&s.length>0&&(k='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>'),b.html(o+k).attr("title",o),y.find(".luckysheet-protection-rangeItem-range").html(d).attr("title",d)}$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}else alert(t.rangeItemErrorRange);else alert(t.rangeItemErrorRangeNull)}else alert(t.rangeItemErrorTitleNull)}),$(document).off("click.luckysheetProtection.validationConfirm").on("click.luckysheetProtection.validationConfirm","#luckysheet-protection-sheet-validation-confirm",function(o){var d=$("#luckysheet-protection-sheet-validation"),s=dd;if(s==null)return Gh(dd),d.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),void Rn();var h=d.find("input").val();if(h!=null&&h.length!=0){if(s.algorithmName!=null&&s.algorithmName!="None")if(s.saltValue!=null&&s.saltValue.length>0){var f=CryptoApi.getHasher(s.algorithmName);h=CryptoApi.hmac(s.saltValue,h,f)}else h=CryptoApi.hash(s.algorithmName,h);h==s.password?(Gh(dd),d.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),Rn(),Hh=!1):alert(t.checkPasswordWrongalert)}else alert(t.checkPasswordNullalert)}),$("#luckysheet-protection-check-selectLockedCells").change(function(){var o=$("#luckysheet-protection-check-selectLockedCells"),d=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked");d.is(":checked"),s&&d.prop("checked",!0)}),$("#luckysheet-protection-check-selectunLockedCells").change(function(){var o=$("#luckysheet-protection-check-selectLockedCells"),d=$("#luckysheet-protection-check-selectunLockedCells");o.is(":checked"),d.is(":checked")||o.prop("checked",!1)}),$(document).off("click.luckysheetProtection.dvRange").on("click.luckysheetProtection.dvRange","#protection-allowRangeAdd-range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();var d=$(this).siblings("input").val().trim();aa.rangeDialog("0",d),aa.selectRange=[];var s=aa.getRangeByTxt(d);if(s.length>0)for(var h=0;h<s.length;h++){var f=s[h].row[0],p=s[h].row[1],g=s[h].column[0],v=s[h].column[1],y=u.visibledatarow[p],b=f-1==-1?0:u.visibledatarow[f-1],k=u.visibledatacolumn[v],w=g-1==-1?0:u.visibledatacolumn[g-1];aa.selectRange.push({left:w,width:k-w-1,top:b,height:y-b-1,left_move:w,width_move:k-w-1,top_move:b,height_move:y-b-1,row:[f,p],column:[g,v],row_focus:f,column_focus:g})}pn(aa.selectRange)}),$(document).off("click.luckysheetProtection.dvRange2").on("click.luckysheetProtection.dvRange2","#luckysheet-protection-rangeItem-dialog .show-box-item-dropdown .range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();var d=$(this).siblings("input").val().trim();aa.rangeDialog("1",d),aa.selectRange=[];var s=aa.getRangeByTxt(d);if(s.length>0)for(var h=0;h<s.length;h++){var f=s[h].row[0],p=s[h].row[1],g=s[h].column[0],v=s[h].column[1],y=u.visibledatarow[p],b=f-1==-1?0:u.visibledatarow[f-1],k=u.visibledatacolumn[v],w=g-1==-1?0:u.visibledatacolumn[g-1];aa.selectRange.push({left:w,width:k-w-1,top:b,height:y-b-1,left_move:w,width_move:k-w-1,top_move:b,height_move:y-b-1,row:[f,p],column:[g,v],row_focus:f,column_focus:g})}pn(aa.selectRange)}),$(document).off("click.luckysheetProtection.dvRangeConfirm").on("click.luckysheetProtection.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(o){var d=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val(),s=$("#protection-allowRangeAdd-range input"),h=s.val();h.substr(h.length-1,1)==","?s.val(h+d):s.val(d),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),pn([])}),$(document).off("click.luckysheetProtection.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),pn([])}),$(document).on("click.luckysheetProtection.luckysheetProtection","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),pn([])}),Mp=!0),Pp=e,e!=null&&e.config!=null&&e.config.authority!=null){var l=e.config.authority;if(Hh&&l.sheet==1&&l.password!=null&&l.password.length>0)return dd=l,$("#luckysheet-protection-sheet-validation input").val(""),void Ec("luckysheet-protection-sheet-validation");Gh(l)}else $("#luckysheet-protection-check-selectLockedCells").prop("checked",!0),$("#luckysheet-protection-check-selectunLockedCells").prop("checked",!0);$("#luckysheet-modal-dialog-slider-protection").show(),Rn()}function Vp(){$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-slider-protection").hide(),Rn()}function Wh(e,n,t,a){var l,o=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],d=!1,s=t.allowRangeList;if(s!=null&&s.length>0)for(var h=!1,f=0;f<s.length;f++){var p=s[f],g=p.sqref,v=aa.getRangeByTxt(g);if(v.length>0)for(var y=0;y<v.length;y++){var b=v[y].row[0],k=v[y].row[1],w=v[y].column[0],_=v[y].column[1];if(e>=b&&e<=k&&n>=w&&n<=_){h=!0;break}}if(h){var C=p.password;if(C!=null&&C.length>0&&!(g in jh))return o&&(hb(p),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()),!1;d=!0;break}}return!d&&o&&(l=t.hintText!=null&&t.hintText.length>0?t.hintText:a.defaultSheetHintText,Ee.info("",l),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()),d}function hb(e){var n=st(),t=n.protection,a=n.button;Op||$("body").append(br(Ga,{id:"luckysheet-protection-range-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
                <div class="luckysheet-slider-protection-row">
                    <div id="luckysheet-protection-range-validation-hint" class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="`.concat(t.validationInputHint,`">
                    </div>
                </div>
            `),botton:'<button id="luckysheet-protection-range-validation-confirm" class="btn btn-primary">'.concat(a.confirm,`</button>
                        <button class="btn btn-default luckysheet-model-close-btn">`).concat(a.cancel,"</button>"),style:"z-index:100003"})),Op=!0,Ec("luckysheet-protection-range-validation");var l=$("#luckysheet-protection-range-validation-hint");e.hintText!=null&&e.hintText.length>0?l.html(e.hintText):l.html(t.defaultRangeHintText);var o=$("#luckysheet-protection-range-validation"),d=o.find("input");d.val(""),$("#luckysheet-protection-range-validation-confirm").off("click").on("click",function(){var s=d.val();if(s!=null&&s.length!=0){if(e.algorithmName!=null&&e.algorithmName!="None")if(e.saltValue!=null&&e.saltValue.length>0){var h=CryptoApi.getHasher(e.algorithmName);s=CryptoApi.hmac(e.saltValue,s,h)}else s=CryptoApi.hash(e.algorithmName,s);s==e.password?(jh[e.sqref]=1,o.hide(),$("#luckysheet-modal-dialog-mask").hide(),alert(t.checkPasswordSucceedalert)):alert(t.checkPasswordWrongalert)}else alert(t.checkPasswordNullalert)})}function Os(e){var n=ir.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;var t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0)return!0;var a,l=st().protection;return a=t.hintText!=null&&t.hintText.length>0?t.hintText:l.defaultSheetHintText,Ee.info("",a),!1}function Up(e,n,t){var a=ir.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;var l=a.data[e][n],o=a.config.authority;return o==null||o.sheet==null||o.sheet==0||!(!l||l.lo)||Wh(e,n,o,st().protection)}function Hp(e,n,t){var a=ir.getSheetByIndex(t);if(!a||!a.data[e]||!a.data[e][n]||a.config==null||a.config.authority==null)return!0;var l=a.data[e][n],o=a.config.authority;return o==null||o.sheet==null||o.sheet==0||l==null||l.hi==null||l.hi==0}function wo(e,n){if(e[0].column[0]!==e[0].column[1])return!0;var t=ir.getSheetByIndex(n);if(t==null||t.config==null||t.config.authority==null)return!0;var a=t.config.authority;if(a==null||a.sheet==null||a.sheet==0||e==null||e.length==0)return!0;var l=t.data[e[0].row[0]][e[0].column[0]];if(l&&!l.lo)return!0;for(var o=st().protection,d=0;d<e.length;d++)for(var s=e[d].row[0],h=e[d].row[1],f=e[d].column[0],p=e[d].column[1],g=s;g<=h;g++)for(var v=f;v<=p;v++)if(Wh(g,v,a,o)==0)return!1;return!0}function jp(e,n,t){var a=st().protection,l=ir.getSheetByIndex(t);if(l==null||l.config==null||l.config.authority==null)return!0;var o=l.data[e][n],d=l.config.authority;return d==null||d.sheet==null||d.sheet==0||(o&&!o.lo||Wh(e,n,d,a,!1)?d.selectunLockedCells==1||d.selectunLockedCells==null:d.selectLockedCells==1||d.selectLockedCells==null)}function Yh(e){st().protection;var n=ir.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;var t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0)return!0;var a=!1;t.selectunLockedCells!=1&&t.selectunLockedCells!=null||(a=!0);var l=!1;return t.selectLockedCells!=1&&t.selectLockedCells!=null||(l=!0),!(!a||!l)}function ro(e){var n=ir.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;var t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0||t.formatCells==1||t.formatCells==null)return!0;var a,l=st().protection;return a=t.hintText!=null&&t.hintText.length>0?t.hintText:l.defaultSheetHintText,Ee.info("",a),!1}function dn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"formatColumns",t=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],a=ir.getSheetByIndex(e);if(a==null||a.config==null||a.config.authority==null)return!0;var l=a.config.authority;if(l==null||l.sheet==null||l.sheet==0||l[n]==1||l[n]==null)return!0;if(t){var o,d=st(),s=d.protection;o=l.hintText!=null&&l.hintText.length>0?l.hintText:s.defaultSheetHintText,Ee.info("",o)}return!1}function zs(e,n,t){return t==null&&(t=!0),t?e.sort(function(a,l){var o=a[n],d=l[n];return D(a[n])=="object"&&(o=a[n].v),D(l[n])=="object"&&(d=l[n].v),$t(o)?1:$t(d)?-1:un(o)&&un(d)?il(o,d):M(o)&&M(d)?cn(o).value()-cn(d).value():M(o)||M(d)?M(o)?M(d)?void 0:-1:1:o.localeCompare(d,"zh")}):e.sort(function(a,l){var o=a[n],d=l[n];return D(a[n])=="object"&&(o=a[n].v),D(l[n])=="object"&&(d=l[n].v),$t(o)?1:$t(d)?-1:un(o)&&un(d)?il(d,o):M(o)&&M(d)?cn(d).value()-cn(o).value():M(o)||M(d)?M(o)?M(d)?void 0:1:-1:d.localeCompare(o,"zh")})}function Gp(e,n){return n==null&&(n=!0),n?e.sort(function(t,a){var l=t,o=a;return D(t)=="object"&&(l=t.v),D(a)=="object"&&(o=a.v),l==null&&(l=""),o==null&&(o=""),un(l)&&un(o)?il(l,o):M(l)&&M(o)?cn(l).value()-cn(o).value():M(l)||M(o)?M(l)?M(o)?void 0:-1:1:l.localeCompare(o,"zh")}):e.sort(function(t,a){var l=t,o=a;return D(t)=="object"&&(l=t.v),D(a)=="object"&&(o=a.v),l==null&&(l=""),o==null&&(o=""),un(l)&&un(o)?il(o,l):M(l)&&M(o)?cn(o).value()-cn(l).value():M(l)||M(o)?M(l)?M(o)?void 0:1:-1:o.localeCompare(l,"zh")})}function Wp(e){if(dn(u.currentSheetIndex,"sort"))if(u.luckysheet_select_save.length>1)Rt()?alert(""):Ee.info("","");else{e==null&&(e=!0);for(var n,t,a=vr.deepCopyFlowData(u.flowdata),l=u.luckysheet_select_save[0].row[0],o=u.luckysheet_select_save[0].row[1],d=u.luckysheet_select_save[0].column[0],s=u.luckysheet_select_save[0].column[1],h=l;h<=o;h++)if(a[h]!=null&&a[h][d]!=null){var f=a[h][d];if(f.mc!=null||$t(f.v))continue;if(n==null&&/[\u4e00-\u9fa5]+/g.test(f.v)){n=h+1,t=h+1;continue}n==null&&(n=h),t=h}if(!(n==null||n>o)){for(var p=!1,g=[],v=n;v<=t;v++){for(var y=[],b=d;b<=s;b++){if(a[v][b]!=null&&a[v][b].mc!=null){p=!0;break}y.push(a[v][b])}g.push(y)}if(p)Rt()?alert(""):Ee.info("","");else{g=zs(g,0,e);for(var k=n;k<=t;k++)for(var w=d;w<=s;w++)a[k][w]=g[k-n][w-d];var _={};if(u.config.rowlen!=null){var C=$.extend(!0,{},u.config);_={cfg:C=Yl(a,n,t,C),RowlChange:!0}}wa(a,[{row:[n,t],column:[d,s]}],_)}}}}function Yp(e,n){if(dn(u.currentSheetIndex,"sort")){n==null&&(n=!0);for(var t,a,l=vr.deepCopyFlowData(u.flowdata),o=l.length-1,d=l[0].length-1,s=0;s<=o;s++)l[s][e]!=null&&l[s][e].mc!=null||(l[s][e]==null||$t(l[s][e].v)||!/[\u4e00-\u9fa5]+/g.test(l[s][e].v)||t!=null?(t==null&&(t=s),l[s][e]==null||$t(l[s][e].v)||(a=s)):(t=s+1,a=s+1));if(!(t==null||t>o)){for(var h=!1,f=[],p=t;p<=a;p++){for(var g=[],v=0;v<=d;v++){if(l[p][v]!=null&&l[p][v].mc!=null){h=!0;break}g.push(l[p][v])}f.push(g)}if(h)Rt()?alert(""):Ee.info("","");else{f=zs(f,e,n);for(var y=t;y<=a;y++)for(var b=0;b<=d;b++)l[y][b]=f[y-t][b-0];var k={};if(u.config.rowlen!=null){var w=$.extend(!0,{},u.config);k={cfg:w=Yl(l,t,a,w),RowlChange:!0}}wa(l,[{row:[t,a],column:[0,d]}],k)}}}}var mb=function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],t=[];if(e.length==0)return[];if(e[0].length==0)return[];for(var a=0;a<e[0].length;a++){for(var l=[],o=0;o<e.length;o++){var d="";e[o]!=null&&e[o][a]!=null&&(d=n?Hr(o,a,e):e[o][a]),l.push(d)}t.push(l)}return t},fb=function(e,n){for(var t=0,a=0;a<n.length;a++){var l=n[a];t+=Math.pow(l-e,2)}return Bl(Math.sqrt(t/n.length))},pb=function(e,n){for(var t=0,a=0;a<n.length;a++){var l=n[a];t+=Math.pow(l-e,2)}return Bl(Math.sqrt(t/(n.length-1)))},gb=function(e,n){for(var t=0,a=0;a<n.length;a++){var l=n[a];t+=Math.pow(l-e,2)}return Bl(t/n.length)},vb=function(e,n){for(var t=0,a=0;a<n.length;a++){var l=n[a];t+=Math.pow(l-e,2)}return Bl(t/(n.length-1))},Pr={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,getCellData:function(e,n,t){var a,l=je(a=e??u.currentSheetIndex);D(u.luckysheetfile[l].pivotTable)!="object"&&(u.luckysheetfile[l].pivotTable=new Function("return "+u.luckysheetfile[l].pivotTable)()),u.luckysheetfile[l].pivotTable!=null?(this.column=u.luckysheetfile[l].pivotTable.column,this.row=u.luckysheetfile[l].pivotTable.row,this.values=u.luckysheetfile[l].pivotTable.values,this.filter=u.luckysheetfile[l].pivotTable.filter,this.showType=u.luckysheetfile[l].pivotTable.showType,this.filterparm=u.luckysheetfile[l].pivotTable.filterparm,u.luckysheetfile[l].pivotTable.drawPivotTable!=null?this.drawPivotTable=u.luckysheetfile[l].pivotTable.drawPivotTable:this.drawPivotTable=!0,u.luckysheetfile[l].pivotTable.pivotTableBoundary!=null?this.pivotTableBoundary=u.luckysheetfile[l].pivotTable.pivotTableBoundary:this.pivotTableBoundary=[12,6],this.pivot_select_save=t??u.luckysheetfile[l].pivotTable.pivot_select_save,this.pivotDataSheetIndex=n??u.luckysheetfile[l].pivotTable.pivotDataSheetIndex):(this.column=null,this.row=null,this.values=null,this.filter=null,this.showType=null,this.filterparm=null,this.drawPivotTable=!0,this.pivotTableBoundary=[12,6],this.pivot_select_save=t??u.luckysheet_select_save,this.pivotDataSheetIndex=n??a);var o=je(this.pivotDataSheetIndex),d=u.luckysheetfile[o];d.data==null&&(d.data=ir.buildGridData(d)),this.origindata=$h(d.data,this.pivot_select_save);var s={};if(this.filterparm!=null)for(var h in this.filterparm)for(var f in this.filterparm[h])f==="rowhidden"&&this.filterparm[h][f]!=null&&(s=$.extend(!0,s,this.filterparm[h][f]));this.rowhidden=s,this.pivotSheetIndex=a;for(var p=[],g=0;g<this.origindata.length;g++)this.rowhidden!=null&&this.rowhidden[g]!=null||p.push([].concat(this.origindata[g]));this.celldata=p,this.pivot_data_type={};for(var v=0;v<this.celldata[1].length;v++){var y=ko(this.celldata[1][v]);this.pivot_data_type[v.toString()]=y}},pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},showvaluecolrow:function(){$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").length>=2?($("#luckysheetpivottablevaluecolrowshow").show(),this.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active"))):$("#luckysheetpivottablevaluecolrowshow").hide()},resetOrderby:function(e){var n=$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").index(e);$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("orderby")==n&&$(this).data("orderby","self")})},luckysheetsliderlistclearfilter:function(e){var n=e.parent(),t=n.data("index"),a={},l=this.origindata;n.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),this.setDatatojsfile("selected",{},t),this.setDatatojsfile("rowhidden",null,t);for(var o=[],d=0;d<l.length;d++)a[d]==null&&o.push([].concat(l[d]));this.celldata=o,this.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()},luckysheetsliderlistitemfilter:function(e){var n=st().filter,t=e.parent(),a=t.offset(),l=$("#luckysheet-pivotTableFilter-menu"),o=$(window).height(),d=($(window).width(),t.data("index")),s=t.data("rowhidden");s==null||s==""?s={}:D(s)=="string"&&(s=JSON.parse(s)),$("body .luckysheet-cols-menu").hide(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-byvalue-input").val(""),$("#luckysheet-pivotTableFilter-bycondition").next().hide(),$("#luckysheet-pivotTableFilter-byvalue").next().show(),l.data("index",d),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(n.filiterInputNone);var h=t.data("byconditiontype");if($("#luckysheet-pivotTableFilter-selected span").data("value",t.data("byconditionvalue")).data("type",h).text(t.data("byconditiontext")),h=="2"){var f=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show().find("input");f.eq(0).val(t.data("byconditionvalue1")),f.eq(1).val(t.data("byconditionvalue2"))}else h=="1"&&$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show().find("input").val(t.data("byconditionvalue1"));$("#luckysheet-pivotTableFilter-byvalue-select").empty().html('<div style="width:100%;text-align:center;position:relative;top:45%;font-size: 14px;"> <div class="luckysheetLoaderGif"> </div> <span>'+n.filiterMoreDataTip+"</span></div>");var p={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").not(t.get(0)).each(function(){var v=$(this).data("rowhidden");if(v==null||v=="")return!0;for(var y in D(v)=="string"&&(v=JSON.parse(v)),v)p[y]=0});var g=this.origindata;setTimeout(function(){for(var v={},y={},b={},k={},w=1;w<g.length;w++)if(!(w in p)&&g[w]!=null){var _=g[w][d];if(_!=null&&_.ct!=null&&_.ct.t=="d"){var C=za("YYYY-MM-DD",_.v),A=C.split("-")[0],I=C.split("-")[1],S=C.split("-")[2];A in v||(v[A]={}),I in v[A]||(v[A][I]={}),S in v[A][I]||(v[A][I][S]=0),v[A][I][S]++,w in s&&(y[A]=0,y[I]=0,y[S]=0)}else{var E=void 0,R=void 0;_==null||$t(_.v)?(E=null,R=null):(E=_.v,R=_.m),E in b||(b[E]={}),R in b[E]||(b[E][R]=0),b[E][R]++,w in s&&(k[E+"#$$$#"+R]=0)}}var F=[];if(JSON.stringify(v).length>2)for(var N in v){var z=0,P="";for(var q in v[N]){var V=0,x="";for(var ee in v[N][q]){var ne=v[N][q][ee];V+=ne;var ae=void 0;ae=Number(q)<10?"0"+Number(q):q;var de=void 0;de=Number(ee)<10?"0"+Number(ee):ee,x+=N in y&&q in y&&ee in y?'<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+N+"-"+ae+"-"+de+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+ee+'</label><span class="count luckysheet-mousedown-cancel">( '+ne+" )</span></div>":'<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+N+"-"+ae+"-"+de+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+ee+'</label><span class="count luckysheet-mousedown-cancel">( '+ne+" )</span></div>"}z+=V;var ve=void 0;ve=Number(q)<10?"0"+Number(q):q,P+=N in y&&q in y?'<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+N+"-"+ve+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+q+n.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+V+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+x+"</div></div>":'<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+N+"-"+ve+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+q+n.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+V+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+x+"</div></div>"}var U=void 0;U=N in y?'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+N+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+N+n.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+z+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+P+"</div></div>":'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+N+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+N+n.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+z+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+P+"</div></div>",F.unshift(U)}if(JSON.stringify(b).length>2){var B=Object.keys(b);B=Gp(B,!0);for(var le=0;le<B.length;le++){var Te=B[le];for(var ue in b[Te]){var be=void 0;be=Te+"#$$$#"+ue=="null#$$$#null"?n.valueBlank:ue;var ye=void 0;ye=Te+"#$$$#"+ue in k?'<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+Te+"#$$$#"+ue+'" title="'+ue+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+be+'</label><span class="luckysheet-mousedown-cancel count">( '+b[Te][ue]+" )</span></div>":'<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+Te+"#$$$#"+ue+'" title="'+ue+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+be+'</label><span class="luckysheet-mousedown-cancel count">( '+b[Te][ue]+" )</span></div>",F.push(ye)}}}$("#luckysheet-pivotTableFilter-byvalue-select").html("<div class='ListBox luckysheet-mousedown-cancel' style='max-height:"+(o-a.top-350)+"px;overflow-y:auto;overflow-x:hidden;'>"+F.join("")+"</div>")},1),Au(l,a.left-250,a.top)},getSumTypeName:function(e){var n="",t=st().pivotTable;return e=="SUM"?n=t.valueStatisticsSUM:e=="COUNT"?n=t.valueStatisticsCOUNT:e=="COUNTA"?n=t.valueStatisticsCOUNTA:e=="COUNTUNIQUE"?n=t.valueStatisticsCOUNTUNIQUE:e=="AVERAGE"?n=t.valueStatisticsAVERAGE:e=="MAX"?n=t.valueStatisticsMAX:e=="MIN"?n=t.valueStatisticsMIN:e=="MEDIAN"?n=t.valueStatisticsMEDIAN:e=="PRODUCT"?n=t.valueStatisticsPRODUCT:e=="STDEV"?n=t.valueStatisticsSTDEV:e=="STDEVP"?n=t.valueStatisticsSTDEVP:e=="let"?n=t.valueStatisticslet:e=="VARP"&&(n=t.valueStatisticsVARP),n},setDatatojsfile:function(e,n,t){var a=je(this.pivotSheetIndex);u.luckysheetfile[a].pivotTable==null&&(u.luckysheetfile[a].pivotTable={}),t==null?(u.luckysheetfile[a].pivotTable[e]=n,this[e]=n):(u.luckysheetfile[a].pivotTable.filterparm==null&&(u.luckysheetfile[a].pivotTable.filterparm={}),u.luckysheetfile[a].pivotTable.filterparm[t.toString()]==null&&(u.luckysheetfile[a].pivotTable.filterparm[t.toString()]={}),u.luckysheetfile[a].pivotTable.filterparm[t.toString()][e]=n,this.filterparm==null&&(this.filterparm={}),this.filterparm[t.toString()]==null&&(this.filterparm[t.toString()]={}),this.filterparm[t.toString()][e]=n)},createPivotTable:function(e){if(!Rt()&&u.allowEdit!==!1){var n=u.currentSheetIndex,t=st().pivotTable;if(Rt())alert(t.errorNotAllowEdit);else if(u.luckysheet_select_save.length>1)Ee.info("",t.errorNotAllowMulti);else if(u.luckysheet_select_save.length!=0&&u.luckysheet_select_save[0].row[0]!=u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]!=u.luckysheet_select_save[0].column[1]){var a=$.extend(!0,{},u.luckysheet_select_save[0]);ir.addNewSheet(e,!0),this.getCellData(u.currentSheetIndex,n,a),this.setDatatojsfile("pivot_select_save",a),this.setDatatojsfile("pivotDataSheetIndex",n),this.initialPivotManage()}else Ee.info("",t.errorSelectRange)}},changePivotTable:function(e){var n=st().pivotTable,t=u.luckysheetfile[je(e)].pivotTable.pivotDataSheetIndex;je(t)!=null?(this.getCellData(e),this.initialPivotManage(!0),this.refreshPivotTable()):Ee.info(n.errorIsDamage,"")},refreshPivotTable:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n=this,t={};t.pivotTable=b,t.data=vr.deepCopyFlowData(u.flowdata),n.storePivotTableParam();var a=n.dataHandler(n.column,n.row,n.values,n.showType,n.celldata);n.setDatatojsfile("pivotDatas",a);var l=$.extend(!0,[],ir.nulldata),o=l,d=0,s=0;if(a.length==0)n.setDatatojsfile("drawPivotTable",!0),n.setDatatojsfile("pivotTableBoundary",[12,6]);else{n.setDatatojsfile("drawPivotTable",!1),n.setDatatojsfile("pivotTableBoundary",[a.length,a[0].length]);var h=a.length,f=a[0].length;o=cl(l,(d=h-l.length)+20,(s=f-l[0].length)+10,!0);for(var p=0;p<h;p++){for(var g=[].concat(o[p]),v=0;v<f;v++){var y="";a[p]!=null&&a[p][v]!=null&&(y=Hr(p,v,a)),g[v]=y}o[p]=g}}t.type="pivotTable_change",t.curdata=$.extend(!0,[],o),t.sheetIndex=u.currentSheetIndex;var b=n.getPivotTableData();t.pivotTablecur=b,u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push(t)),bl(),u.clearjfundo=!1,d>0||s>0?Ni(o[0].length,o.length,o,null,u.luckysheet_select_save,"datachangeAll",void 0,void 0,e):(wa(o,u.luckysheet_select_save,{},null,e),Ra()),u.clearjfundo=!0},drawPivotTable:!0,pivotTableBoundary:[12,6],pivotclick:function(e,n,t){t==null&&(t=u.currentSheetIndex);var a=u.luckysheetfile[je(t)];if(a.isPivotTable&&je(a.pivotTable.pivotDataSheetIndex)!=null){var l=$("#luckysheet-modal-dialog-slider-pivot"),o=this.isPivotRange(e,n);if(o&&l.is(":hidden")){if(!dn(t,"usePivotTablereports",!1))return;l.show(),Rn(),$("#luckysheet-sta-content").css("padding-right",260)}else!o&&l.is(":visible")&&(l.hide(),Rn(),$("#luckysheet-sta-content").css("padding-right",10))}},isPivotRange:function(e,n){if(u.luckysheetcurrentisPivotTable)return e<this.pivotTableBoundary[0]&&n<this.pivotTableBoundary[1]},storePivotTableParam:function(){var e=[],n=[],t=[],a=[];$("#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item").each(function(){var d={};d.index=$(this).data("index"),d.name=$(this).data("name"),d.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),t.push(d)}),$("#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item").each(function(){var d={};d.index=$(this).data("index"),d.name=$(this).data("name"),d.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),d.order=$(this).data("order"),d.orderby=$(this).data("orderby"),d.stastic=$(this).data("stastic"),n.push(d)}),$("#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item").each(function(){var d={};d.index=$(this).data("index"),d.name=$(this).data("name"),d.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),d.order=$(this).data("order"),d.orderby=$(this).data("orderby"),d.stastic=$(this).data("stastic"),e.push(d)}),$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(){var d={};d.index=$(this).data("index"),d.name=$(this).data("name"),d.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),d.sumtype=$(this).data("sumtype"),d.nameindex=$(this).data("nameindex"),a.push(d)}),this.setDatatojsfile("column",e),this.setDatatojsfile("row",n),this.setDatatojsfile("filter",t),this.setDatatojsfile("values",a);var l=$("#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked").val();this.setDatatojsfile("showType",l=="0"?"row":"column");var o=this.getPivotTableData();delete o.pivotDatas,nt.saveParam("all",this.pivotSheetIndex,o,{k:"pivotTable"})},getPivotTableData:function(e){e==null&&(e=this.pivotSheetIndex);var n=je(e),t=u.luckysheetfile[n].pivotTable;return t=D(t)=="object"?$.extend(!0,{},u.luckysheetfile[n].pivotTable):new Function("return "+t)()},addValuesToTitle:function(e,n){var t=e.length*n.length,a=e[0].length+1,l=[];if(e.length==0&&n.length>0){for(var o=0;o<n.length;o++)l.push(n[o].fullname);return l}if(n.length==0&&e.length>0)return e;for(var d=0;d<t;d++){l[d]=new Array(a);for(var s=0;s<a-1;s++)l[d][s]=e[Math.floor(d/n.length)][s];l[d][a-1]=n[d%n.length].fullname}return l},initialPivotManage:function(e){var n=this,t=st(),a=t.pivotTable,l=t.button,o=t.filter;if(n.initial){n.initial=!1,$("body").append(function(){var U=st().pivotTable;return`
        <div id="luckysheet-modal-dialog-slider-pivot" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot">
        <div class="luckysheet-modal-dialog-slider-title"> <span>`.concat(U.title,'</span> <span id="luckysheet-modal-dialog-slider-close" title="').concat(U.closePannel,`"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-modal-dialog-slider-range">
                <div id="luckysheet-dialog-pivotTable-range"></div>
                <div id="luckysheet-dialog-pivotTable-range-seleted">`).concat(U.editRange,`</div>
            </div>
            <div class="luckysheet-modal-dialog-slider-list-title"> `).concat(U.tipPivotFieldSelected,' <span title="').concat(U.tipClearSelectedField,'" id="luckysheet-dialog-pivotTable-clearitem">').concat(U.btnClearSelectedField,`</span></div>
            <div id="luckysheet-modal-dialog-pivotTable-list" class="luckysheet-modal-dialog-slider-list luckysheet-scrollbars"> </div>
            <div class="luckysheet-modal-dialog-slider-config-c">
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-filter">
                    <div> <span><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i> `).concat(U.btnFilter,`</span> </div>
                    <div id="luckysheet-modal-dialog-config-filter" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-row">
                    <div> <span><i class="fa fa-list-alt" aria-hidden="true"></i> `).concat(U.titleRow,`</span> </div>
                    <div id="luckysheet-modal-dialog-config-row" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-column">
                    <div> <span><i class="fa fa-indent" aria-hidden="true"></i> `).concat(U.titleColumn,`</span> </div>
                    <div id="luckysheet-modal-dialog-config-column" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-value">
                    <div> <span><i class="fa fa-cube" aria-hidden="true"></i> `).concat(U.titleValue,'</span> <span style="float: right;margin-right: 10px;display:none;" id="luckysheetpivottablevaluecolrowshow"><label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="').concat(U.tipShowColumn,'" for="luckysheetpivottablevaluecolrow">').concat(U.titleColumn,'</label> <input type="radio" checked="checked" value="1" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow" /> <label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="').concat(U.tipShowRow,'" for="luckysheetpivottablevaluecolrow1">').concat(U.titleRow,`</label> <input type="radio" value="0" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow1" /></span></div>
                    <div id="luckysheet-modal-dialog-config-value" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
            </div>
        </div>
        </div>
        `)}()),$("#luckysheet-modal-dialog-slider-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),Rn()}),$("body").append(br(Ga,{id:"luckysheet-data-pivotTable-selection",addclass:"luckysheet-data-pivotTable-selection",title:a.titleSelectionDataRange,content:'<input id="luckysheet-pivotTable-range-selection-input" class="luckysheet-datavisual-range-container" style="font-size: 14px;padding:5px;max-width:none;" spellcheck="false" aria-label="'+a.titleDataRange+'" placeholder="'+a.titleDataRange+'">',botton:'<button id="luckysheet-pivotTable-selection-confirm" class="btn btn-primary">'+l.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+l.cancel+"</button>"})),$("body").append(br(wf(),{menuid:"pivotTableFilter"})),$("body").append(br(_f(),{menuid:"pivotTableFilter"})),$("body").append(function(){var U=st().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.titleSort+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-order"> <option selected="selected" value="default">'+U.titleNoSort+'</option> <option value="asc">'+U.titleSortAsc+'</option> <option value="desc">'+U.titleSortDesc+'</option> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.titleSortBy+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-orderby"> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.titleShowSum+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-stastic"> <option  value="0">'+U.titleStasticFalse+'</option> <option value="1" selected="selected">'+U.titleStasticTrue+"</option> </select> </div> </div> </div> </div>"}()),$("body").append(function(){var U=st().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option-sumtype"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="SUM"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsSUM+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsCOUNT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTA"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsCOUNTA+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTUNIQUE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsCOUNTUNIQUE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="AVERAGE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsAVERAGE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MAX"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsMAX+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MIN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsMIN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MEDIAN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsMEDIAN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="PRODUCT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsPRODUCT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEV"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsSTDEV+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEVP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsSTDEVP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VAR"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticslet+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VARP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+U.valueStatisticsVARP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> </div>'}()),$("#luckysheet-pivotTableFilter-orderby-asc").remove(),$("#luckysheet-pivotTableFilter-orderby-desc").next().remove(),$("#luckysheet-pivotTableFilter-orderby-desc").remove(),$("#luckysheet-pivotTableFilter-orderby-color").next().remove(),$("#luckysheet-pivotTableFilter-orderby-color").remove(),$("#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1").checkboxradio({icon:!1}).change(function(){n.refreshPivotTable()});var d=null;$("#luckysheet-pivotTableFilter-menu").mouseover(function(){clearTimeout(d),d=setTimeout(function(){$("#luckysheet-pivotTableFilter-submenu").hide()},500)}),$(document).off("click.ptFilterCheckbox1").on("click.ptFilterCheckbox1","#luckysheet-pivotTableFilter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox2").on("click.ptFilterCheckbox2","#luckysheet-pivotTableFilter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox3").on("click.ptFilterCheckbox3","#luckysheet-pivotTableFilter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));var U=!0;$(this).parents(".yearBox").find(".day").each(function(B,le){$(le).attr("data-check")=="true"||(U=!1)}),U?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterCheckbox4").on("click.ptFilterCheckbox4","#luckysheet-pivotTableFilter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));var U=!0;$(this).parents(".monthBox").find(".day").each(function(le,Te){$(Te).attr("data-check")=="true"||(U=!1)}),U?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));var B=!0;$(this).parents(".yearBox").find(".day").each(function(le,Te){$(Te).attr("data-check")=="true"||(B=!1)}),B?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterYearDropdown").on("click.ptFilterYearDropdown","#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right",function(){var U=$(this).parents(".luckysheet-mousedown-cancel");U.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),U.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle()}),$("#luckysheet-pivotTableFilter-byvalue-btn-all").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-pivotTableFilter-byvalue-btn-contra").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(U,B){$(B).is(":checked")?($(B).removeAttr("checked"),$(B).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(B).prop("checked",!0),$(B).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox").each(function(U,B){var le=!0;$(B).find(".day input[type='checkbox']").each(function(Te,ue){$(ue).is(":checked")||(le=!1)}),le?($(B).find(".month input[type='checkbox']").prop("checked",!0),$(B).attr("data-check","true")):($(B).find(".month input[type='checkbox']").removeAttr("checked"),$(B).attr("data-check","false"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox").each(function(U,B){var le=!0;$(B).find(".day input[type='checkbox']").each(function(Te,ue){$(ue).is(":checked")||(le=!1)}),le?($(B).find(".year input[type='checkbox']").prop("checked",!0),$(B).attr("data-check","true")):($(B).find(".year input[type='checkbox']").removeAttr("checked"),$(B).attr("data-check","false"))})}),$("#luckysheet-pivotTableFilter-byvalue-btn-clear").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-pivotTableFilter-byvalue-input").on("input propertychange",function(){var U=$(this).val().toString();$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),U!=""&&$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(B,le){var Te=$(le).parents(".luckysheet-mousedown-cancel");if(Te.hasClass("day")){var ue=$(le).siblings("label").text().toString(),be=$(le).parents(".monthBox").find(".month label").text().toString();($(le).parents(".yearBox").find(".year label").text().toString()+"-"+be+"-"+ue).indexOf(U)==-1&&($(le).parents(".day").hide(),$(le).parents(".dayList").find(".day:visible").length==0&&$(le).parents(".monthBox").find(".month").hide(),$(le).parents(".monthList").find(".day:visible").length==0&&$(le).parents(".yearBox").find(".year").hide())}Te.hasClass("textBox")&&$(le).siblings("label").text().toString().indexOf(U)==-1&&$(le).parents(".textBox").hide()})}),$("#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue").click(function(){var U=$(this);U.next().slideToggle(200),setTimeout(function(){U.attr("id")=="luckysheet-pivotTableFilter-bycondition"&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-selected span").text()!=o.filiterInputNone&&$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(200),U.is($("#luckysheet-pivotTableFilter-bycondition"))&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-pivotTableFilter-cancel").click(function(){$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-pivotTableFilter-selected").click(function(){var U=$(this).offset(),B=$("#luckysheet-pivotTableFilter-submenu");B.hide();var le=$(window).height(),Te=$(window).width(),ue=B.width(),be=(B.height(),U.top),ye=U.left,ce=le-U.top-20;U.left+ue>Te&&(ye=U.left-ue),U.top>le/2&&((be=le-U.top)<0&&(be=0),ce=U.top-20),B.css({top:be,left:ye,height:ce}).show(),clearTimeout(d)}),$("#luckysheet-pivotTableFilter-submenu").mouseover(function(){clearTimeout(d)}).find(".luckysheet-cols-menuitem").click(function(U){$("#luckysheet-pivotTableFilter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide(),$(this).data("type")=="2"?($("#luckysheet-pivotTableFilter-selected span").data("type","2"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show()):$(this).data("type")=="0"?$("#luckysheet-pivotTableFilter-selected span").data("type","0"):($("#luckysheet-pivotTableFilter-selected span").data("type","1"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show(),$(this).attr("data-value")=="dateequal"||$(this).attr("data-value")=="datelessthan"||$(this).attr("data-value")=="datemorethan"?$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","date"):$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","text")),$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(),$("#luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filter",function(U){return n.luckysheetsliderlistitemfilter($(this)),U.stopPropagation(),!1}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filtered",function(U){return n.luckysheetsliderlistclearfilter($(this).next()),U.stopPropagation(),!1}),$("#luckysheet-dialog-pivotTable-range-seleted").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),Rn();var U=$("#luckysheet-data-pivotTable-selection"),B=U.outerHeight(),le=U.outerWidth(),Te=$(window).width(),ue=$(window).height(),be=$(document).scrollLeft(),ye=$(document).scrollTop();$("#luckysheet-data-pivotTable-selection").css({left:(Te+be-le)/2,top:(ue+ye-B)/4}).show(),n.jgridCurrentPivotInput=$("#luckysheet-dialog-pivotTable-range").html(),$("#luckysheet-pivotTable-range-selection-input").val(n.jgridCurrentPivotInput),n.luckysheet_pivotTable_select_state=!0}),$("#luckysheet-pivotTableFilter-initial").click(function(){$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered").hide(),$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").data("rowhidden",""),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(o.filiterInputNone),n.setDatatojsfile("filterparm",null),n.celldata=n.origindata,n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(U){var B=$(U.target).closest(".luckysheet-modal-dialog-slider-config-item"),le=B.data("index"),Te=B.offset(),ue=B.data("order"),be=B.data("orderby"),ye=B.data("stastic");ue==null&&(ue="default");var ce='<option value="self">'+B.find(".luckysheet-modal-dialog-slider-config-item-txt").data("name")+"</option>";return $("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(Re){ce+='<option value="'+Re+'">'+$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()+"</option>"}),$("#luckysheet-pivotTable-config-option-orderby").empty().html(ce),be==null&&(be="self"),ye==null&&(ye="1"),$("#luckysheet-pivotTable-config-option-order").val(ue).data("index",le),$("#luckysheet-pivotTable-config-option-orderby").val(be).data("index",le),$("#luckysheet-pivotTable-config-option-stastic").val(ye).data("index",le),al($("#luckysheet-pivotTable-config-option"),Te.left+B.outerWidth(),Te.top-13,"rightbottom"),U.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic").change(function(){var U=$(this),B=U.data("index");$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==B&&$(this).data(U.attr("id").replace("luckysheet-pivotTable-config-option-",""),U.val())}),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-value").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(U){var B=$(U.target).closest(".luckysheet-modal-dialog-slider-config-item"),le=B.data("index"),Te=B.offset(),ue=B.data("sumtype"),be=n.pivot_data_type[le.toString()];ue==null&&(ue=be=="num"?"SUM":"COUNTA");var ye=$("#luckysheet-pivotTable-config-option-sumtype");return ye.find(".luckysheet-submenu-arrow").hide(),ye.find(".luckysheet-cols-menuitem[sumtype='"+ue+"'] .luckysheet-submenu-arrow").css("display","inline"),ye.data("item",B),al(ye,Te.left+B.outerWidth(),Te.top-13,"rightbottom"),U.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem").click(function(){var U=$("#luckysheet-pivotTable-config-option-sumtype").data("item"),B=$(this).attr("sumtype");U.data("sumtype",$(this).attr("sumtype"));var le=n.getSumTypeName(B)+":"+U.data("name");U.attr("title",le).find(".luckysheet-modal-dialog-slider-config-item-txt").html(le),$("#luckysheet-pivotTable-config-option-sumtype").hide(),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-filter").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(U){var B=$(U.target).closest(".luckysheet-modal-dialog-slider-config-item").data("index");return n.luckysheetsliderlistitemfilter($("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(B).find(".luckysheet-slider-list-item-filter")),U.stopPropagation(),!1}),$("#luckysheet-pivotTableFilter-confirm").click(function(){var U=$("#luckysheet-pivotTableFilter-menu").data("index"),B={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").each(function(){var mr=$(this),fr=mr.data("rowhidden");if(mr.data("index")!=U){if(fr==null||fr=="")return!0;for(var Wt in D(fr)=="string"&&(fr=JSON.parse(fr)),fr)B[Wt]=0}});var le=n.origindata,Te={},ue={},be={};if($("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"){var ye=$("#luckysheet-pivotTableFilter-selected span"),ce=ye.data("type"),Re=ye.data("value");if(be.value=Re,be.text=ye.text(),ce=="0")be.type="0";else if(ce=="2"){var pe=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input");be.type="2",be.value1=pe.eq(0).val(),be.value2=pe.eq(1).val()}else be.type="1",be.value1=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).find("input").val();for(var me=1;me<le.length;me++)if(!(me in B)&&le[me]!=null){var re=le[me][U];if(Re=="cellnull")re==null||$t(re.v)||(ue[me]=0);else if(Re=="cellnonull")(re==null||$t(re.v))&&(ue[me]=0);else if(Re=="textinclude"){var _e=be.value1;(re==null||$t(re.v)||re.m.indexOf(_e)==-1)&&(ue[me]=0)}else if(Re=="textnotinclude"){var Ze=be.value1;re==null||$t(re.v)||re.m.indexOf(Ze)>-1&&(ue[me]=0)}else if(Re=="textstart"){var We=be.value1,Xe=We.length;(re==null||$t(re.v)||re.m.substr(0,Xe)!=We)&&(ue[me]=0)}else if(Re=="textend"){var Ue=be.value1,mt=Ue.length;(re==null||$t(re.v)||mt>re.m.length||re.m.substr(re.m.length-mt,mt)!=Ue)&&(ue[me]=0)}else if(Re=="textequal"){var St=be.value1;(re==null||$t(re.v)||re.m!=St)&&(ue[me]=0)}else if(Re=="dateequal"){var at=_a(be.value1)[2];re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="d"?parseInt(re.v)!=at&&(ue[me]=0):ue[me]=0}else if(Re=="datelessthan"){var dt=_a(be.value1)[2];re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="d"?parseInt(re.v)>=dt&&(ue[me]=0):ue[me]=0}else if(Re=="datemorethan"){var wt=_a(be.value1)[2];re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="d"?parseInt(re.v)<=wt&&(ue[me]=0):ue[me]=0}else if(Re=="morethan"){var ct=parseFloat(be.value1);re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v<=ct&&(ue[me]=0):ue[me]=0}else if(Re=="moreequalthan"){var bt=parseFloat(be.value1);re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v<bt&&(ue[me]=0):ue[me]=0}else if(Re=="lessthan"){var De=parseFloat(be.value1);re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v>=De&&(ue[me]=0):ue[me]=0}else if(Re=="lessequalthan"){var He=parseFloat(be.value1);re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v>He&&(ue[me]=0):ue[me]=0}else if(Re=="equal"){var Dt=parseFloat(be.value1);re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v!=Dt&&(ue[me]=0):ue[me]=0}else if(Re=="noequal"){var et=parseFloat(be.value1);re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v==et&&(ue[me]=0):ue[me]=0}else if(Re=="include"){var ur=parseFloat(be.value1),Xt=parseFloat(be.value2),jt=void 0,lr=void 0;ur<Xt?(jt=ur,lr=Xt):(lr=ur,jt=Xt),re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?(re.v<jt||re.v>lr)&&(ue[me]=0):ue[me]=0}else if(Re=="noinclude"){var tr=parseFloat(be.value1),xr=parseFloat(be.value2),rr=void 0,nr=void 0;tr<xr?(rr=tr,nr=xr):(nr=tr,rr=xr),re==null||$t(re.v)?ue[me]=0:re.ct!=null&&re.ct.t=="n"?re.v>=rr&&re.v<=nr&&(ue[me]=0):ue[me]=0}}}else{$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(mr,fr){if($(fr).is(":visible")&&$(fr).is(":checked"))return!0;if($(fr).closest(".day").length>0){var Wt=$(fr).siblings("label").text();Number(Wt)<10&&(Wt="0"+Wt);var ze=$(fr).closest(".monthBox").find(".month label").text().replace(o.filiterMonthText,"");Number(ze)<10&&(ze="0"+ze);var Ae=$(fr).closest(".yearBox").find(".year label").text().replace(o.filiterYearText,""),Ve=o.filterDateFormatTip+"#$$$#"+Ae+"-"+ze+"-"+Wt;Te[Ve]="1"}if($(fr).closest(".textBox").length>0){var gt=$(fr).closest(".textBox").data("filter");Te[gt]="1"}});for(var Ut=1;Ut<le.length;Ut++)if(!(Ut in B)&&le[Ut]!=null){var ar=le[Ut][U],Jt=void 0;if(ar==null||$t(ar.v))Jt="null#$$$#null";else if(ar.ct!=null&&ar.ct.t=="d"){var Qt=za("YYYY-MM-DD",ar.v);Jt=o.filterDateFormatTip+"#$$$#"+Qt}else Jt=ar.v+"#$$$#"+ar.m;Jt in Te&&(ue[Ut]=0)}}var _t=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(U);$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-pivotTableFilter-byvalue-input").val().length>0||$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"?(_t.data("rowhidden",JSON.stringify(ue)).find(".luckysheet-slider-list-item-filtered").show(),n.setDatatojsfile("rowhidden",ue,U),be!=null&&(_t.data("byconditionvalue",be.value).data("byconditiontype",be.type).data("byconditiontext",be.text),be.value1!=null&&_t.data("byconditionvalue1",be.value1),be.value2!=null&&_t.data("byconditionvalue2",be.value2),n.setDatatojsfile("caljs",be,U))):(_t.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("rowhidden",null,U));for(var er=[],Kt=0;Kt<le.length;Kt++)Kt in ue||Kt in B||er.push([].concat(le[Kt]));n.celldata=er,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),bl()}),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").show(),Rn(),$("#luckysheet-cell-main .luckysheet-pivotTable-selection-set div").show(),$("#luckysheet-data-pivotTable-selection").hide(),ir.changeSheetExec(n.pivotSheetIndex),n.luckysheet_pivotTable_select_state=!1,bl()}),$("#luckysheet-pivotTable-selection-confirm").click(function(){var U=$("#luckysheet-pivotTable-range-selection-input"),B=U.val();if($.trim(B).length==0||$.trim(B).toUpperCase()==n.jgridCurrentPivotInput.toUpperCase())return U.val(n.jgridCurrentPivotInput),void $("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn").click();var le=B.split("!"),Te="",ue="",be=-1;if(le.length>1){for(var ye in Te=le[0],ue=le[1],u.luckysheetfile)if(Te==u.luckysheetfile[ye].name){be=u.luckysheetfile[ye].index;break}be==-1&&(be=0)}else{var ce=je(u.currentSheetIndex);Te=u.luckysheetfile[ce].name,be=u.luckysheetfile[ce].index,ue=le[0]}if(u.luckysheetfile[je(be)].isPivotTable)return Rt()?alert(a.errorNotAllowPivotData):Ee.info("",a.errorNotAllowPivotData),void U.val(n.jgridCurrentPivotInput);if(ue.indexOf(":")==-1)return Rt()?alert(a.errorSelectionRange):Ee.info("",a.errorSelectionRange),void U.val(n.jgridCurrentPivotInput);ue=ue.split(":");var Re=[],pe=[];return Re[0]=parseInt(ue[0].replace(/[^0-9]/g,""))-1,Re[1]=parseInt(ue[1].replace(/[^0-9]/g,""))-1,Re[0]>Re[1]?(Rt()?alert(a.errorSelectionRange):Ee.info("",a.errorSelectionRange),void U.val(n.jgridCurrentPivotInput)):(pe[0]=rl(ue[0].replace(/[^A-Za-z]/g,"")),pe[1]=rl(ue[1].replace(/[^A-Za-z]/g,"")),pe[0]>pe[1]?(Rt()?alert(a.errorSelectionRange):Ee.info(a.errorSelectionRange),void U.val(n.jgridCurrentPivotInput)):(ir.changeSheetExec(n.pivotSheetIndex),n.setDatatojsfile("pivot_select_save",{row:Re,column:pe}),n.setDatatojsfile("pivotDataSheetIndex",be),n.getCellData(n.pivotSheetIndex,be,{row:Re,column:pe}),n.initialPivotManage(),$("#luckysheet-dialog-pivotTable-range").html(B),$("#luckysheet-modal-dialog-slider-pivot").show(),$("#luckysheet-data-pivotTable-selection").hide(),n.luckysheet_pivotTable_select_state=!1,n.refreshPivotTable(),Rn(),void bl()))}),$("#luckysheet-modal-dialog-slider-pivot").on("mousedown",".luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt",function(U){var B=$(U.target);n.movestate=!0,n.movesave.obj=B.parent(),n.movesave.name=B.data("name"),n.movesave.containerid=B.parent().parent().attr("id"),n.movesave.index=B.data("index"),$("#luckysheet-modal-dialog-slider-pivot-move").length==0&&$("body").append('<div id="luckysheet-modal-dialog-slider-pivot-move">'+n.movesave.name+"</div>"),n.movesave.width=$("#luckysheet-modal-dialog-slider-pivot-move").outerWidth(),n.movesave.height=$("#luckysheet-modal-dialog-slider-pivot-move").outerHeight(),$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default")}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").mousemove(function(U){if(n.movestate){n.moveitemposition.length==0&&(n.moveitemposition=[0],$(this).find(".luckysheet-modal-dialog-slider-config-item").each(function(ye){var ce=$(this).outerHeight();n.moveitemposition.push(n.moveitemposition[ye]+ce+2)}),$(this).append('<div id="luckysheet-modal-dialog-config-order-help" style="position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;"></div>')),$("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#FD8585",color:"#fff",border:"1px solid #FD7070"}),event.pageX;var B=event.pageY,le=$(this),Te=B-le.offset().top+le.scrollTop(),ue=n.moveitemposition,be=fa(ue,Te);be==-1?$("#luckysheet-modal-dialog-config-order-help").css({top:ue[ue.length-1]}):Te-ue[be-1]>(ue[be]-ue[be-1])/2?$("#luckysheet-modal-dialog-config-order-help").css({top:ue[be]}):$("#luckysheet-modal-dialog-config-order-help").css({top:ue[be-1]})}}).mouseleave(function(){n.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#fff",color:"#000",border:"1px dotted #000"}),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove())}).mouseup(function(U){if(n.movestate){var B,le=$(this);if(n.movesave.containerid==le.attr("id"))B=n.movesave.obj.clone();else{var Te=n.movesave.name,ue="",be="";le.attr("id")=="luckysheet-modal-dialog-config-value"&&(n.pivot_data_type[n.movesave.index.toString()]=="num"?(Te=a.valueStatisticsSUM+":"+Te,ue="data-sumtype='SUM'",be="data-nameindex='0'"):(Te=a.valueStatisticsCOUNTA+":"+Te,ue="data-sumtype='COUNTA'",be="data-nameindex='0'"),$("#luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){if($(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()==Te){var re=parseFloat($(this).data("nameindex"))+1;return Te+=re.toString(),$(this).data("nameindex",re),!1}})),B='<div title="'+Te+'" class="luckysheet-modal-dialog-slider-config-item" '+be+" "+ue+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+be+" "+ue+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'">'+Te+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}event.pageX;var ye=event.pageY,ce=$(this),Re=ye-ce.offset().top+ce.scrollTop(),pe=n.moveitemposition,me=fa(pe,Re);(n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=le.attr("id"))&&$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==n.movesave.index&&$(this).remove()}),me==-1?le.find(".luckysheet-modal-dialog-slider-config-item").length==0?le.append(B):le.find(".luckysheet-modal-dialog-slider-config-item").last().after(B):Re-pe[me-1]>(pe[me]-pe[me-1])/2?le.find(".luckysheet-modal-dialog-slider-config-item").eq(me-1).after(B):le.find(".luckysheet-modal-dialog-slider-config-item").eq(me-1).before(B),n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=le.attr("id")||n.movesave.obj.remove(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){var re=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==n.movesave.index&&re.find("i").length==0&&re.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}),n.refreshPivotTable(),$("#luckysheet-modal-dialog-slider-pivot-move").remove(),n.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove(),n.showvaluecolrow(),U.stopPropagation()}}),$("#luckysheet-modal-dialog-pivotTable-list").on("click",".luckysheet-slider-list-item-selected",function(){var U,B=$(this),le=B.parent(),Te=le.data("index"),ue=le.data("name");if(B.find("i").length==0)if(B.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),n.pivot_data_type[Te.toString()]=="num")U='<div title="'+ue+'" class="luckysheet-modal-dialog-slider-config-item" data-nameindex="0" data-sumtype="SUM" data-index="'+Te+'" data-name="'+ue+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-nameindex="0" data-sumtype="SUM" data-index="'+Te+'" data-name="'+ue+'">:'+ue+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',$("#luckysheet-modal-dialog-config-value").append(U);else{U='<div title="'+ue+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+Te+'" data-name="'+ue+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+Te+'" data-name="'+ue+'">'+ue+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';var be=$("#luckysheet-modal-dialog-config-column"),ye=$("#luckysheet-modal-dialog-config-row"),ce=be.find(".luckysheet-modal-dialog-slider-config-item"),Re=ye.find(".luckysheet-modal-dialog-slider-config-item");ce.length<2?be.append(U):Re.length<2?ye.append(U):be.append(U)}else B.find("i").remove(),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==Te&&($(this).parent().attr("id")=="luckysheet-modal-dialog-config-value"&&n.resetOrderby($(this)),$(this).remove())});n.refreshPivotTable(),n.showvaluecolrow()}),$("#luckysheet-dialog-pivotTable-clearitem").click(function(){$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).remove()}),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),n.refreshPivotTable(),n.showvaluecolrow()})}e==null&&(e=!1),n.celldata.length<=1&&n.celldata[0].length<=1&&(Rt()?alert(a.errorIncreaseRange):Ee.info("",a.errorIncreaseRange));for(var s="",h=1,f={},p=1,g=0;g<n.celldata[0].length;g++){var v=void 0;(v=n.celldata[0][g]&&n.celldata[0][g].m?n.celldata[0][g].m:Hr(0,g,n.celldata))!=null&&(v=v.toString()),v!=null&&$.trim(v.toString()).length!=0||(v=a.titleColumn+" "+p),p++,v in f&&(v+=h++)in f&&(v+=h++)in f&&(v+=h++),f[v]=1;var y="",b="";if(e&&n.filterparm!=null&&n.filterparm[g.toString()]!=null){var k=n.filterparm[g.toString()];if(k.rowhidden!=null&&(y+="data-rowhidden='"+JSON.stringify(k.rowhidden)+"'"),k.selected!=null&&(y+="data-selected='"+JSON.stringify(k.selected)+"'"),k.caljs!=null){var w=k.caljs;w.value!=null&&(y+="data-byconditionvalue='"+w.value+"'"),w.type!=null&&(y+="data-byconditiontype='"+w.type+"'"),w.text!=null&&(y+="data-byconditiontext='"+w.text+"'"),w.value1!=null&&(y+="data-byconditionvalue1='"+w.value1+"'"),w.value2!=null&&(y+="data-byconditionvalue2='"+w.value2+"'")}}y.length>0&&(b="display:block;"),s+='<div class="luckysheet-modal-dialog-slider-list-item" '+y+' data-index="'+g+'" data-name="'+v+'"><div title="'+a.titleAddColumn+'" class="luckysheet-slider-list-item-selected"><div></div></div><div title="'+a.titleMoveColumn+'" class="luckysheet-slider-list-item-name" '+y+' data-index="'+g+'" data-name="'+v+'">'+v+'</div><div title="'+a.titleClearColumnFilter+'" class="luckysheet-slider-list-item-filtered" style="'+b+'"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i><i class="fa fa-times" aria-hidden="true"></i></div><div title="'+a.titleFilterColumn+'" class="luckysheet-slider-list-item-filter"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}if($("#luckysheet-modal-dialog-pivotTable-list").html(s),$("#luckysheetpivottablevaluecolrowshow").hide(),$("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").empty(),e){if(n.filter!=null&&n.filter.length>0)for(var _=0;_<n.filter.length;_++){var C=n.filter[_],A='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+C.index+'" data-name="'+C.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+C.index+'" data-name="'+C.name+'">'+C.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-filter").append(A);var I=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(C.index).find(".luckysheet-slider-list-item-selected");I.find("i").length==0&&I.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.row!=null&&n.row.length>0)for(var S=0;S<n.row.length;S++){var E=n.row[S],R="";E.order!=null&&(R+="data-order = '"+E.order+"'"),E.orderby!=null&&(R+="data-orderby = '"+E.orderby+"'"),E.order!=null&&(R+="data-stastic = '"+E.stastic+"'");var F='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+R+' data-index="'+E.index+'" data-name="'+E.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+R+' data-index="'+E.index+'" data-name="'+E.name+'">'+E.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-row").append(F);var N=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(E.index).find(".luckysheet-slider-list-item-selected");N.find("i").length==0&&N.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.column!=null&&n.column.length>0)for(var z=0;z<n.column.length;z++){var P=n.column[z],q="";P.order!=null&&(q+="data-order = '"+P.order+"'"),P.orderby!=null&&(q+="data-orderby = '"+P.orderby+"'"),P.order!=null&&(q+="data-stastic = '"+P.stastic+"'");var V='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+q+' data-index="'+P.index+'" data-name="'+P.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+q+' data-index="'+P.index+'" data-name="'+P.name+'">'+P.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-column").append(V);var x=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(P.index).find(".luckysheet-slider-list-item-selected");x.find("i").length==0&&x.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.values!=null&&n.values.length>0){for(var ee=0;ee<n.values.length;ee++){var ne=n.values[ee],ae="";ne.sumtype!=null&&(ae+="data-sumtype = '"+ne.sumtype+"'"),ne.nameindex!=null&&(ae+="data-nameindex = '"+ne.nameindex+"'");var de='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+ae+' data-index="'+ne.index+'" data-name="'+ne.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+ae+' data-index="'+ne.index+'" data-name="'+ne.name+'">'+n.getSumTypeName(ne.sumtype)+":"+ne.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-value").append(de);var ve=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(ne.index).find(".luckysheet-slider-list-item-selected");ve.find("i").length==0&&ve.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}n.values.length>=2&&($("#luckysheetpivottablevaluecolrowshow").show(),n.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active")))}}$("#luckysheet-dialog-pivotTable-range").html(wn(n.pivotDataSheetIndex,n.pivot_select_save)),$("#luckysheet-modal-dialog-slider-pivot").show(),Rn(!1)},getComposeArray:function(e){if(e.length==0)return[];for(var n=[],t=0;t<e.length;t++){for(var a="",l=0;l<=t;l++)e[l]&&e[l].m?a+=e[l].m:a+=Hr(l,null,e);n.push(a)}return n},getnameArray:function(e,n){if(e.length==0)return[];if(n.length==0)return[];for(var t=[],a=0;a<n.length;a++){var l=void 0;l=e[n[a].index]&&e[n[a].index].m?e[n[a].index].m:Hr(n[a].index,null,e),t.push(l)}return t},getTitleFromGroup:function(e,n,t){var a=this.orderbygroup(e,n,t);return this.generategrouparraymain(a,n)},orderbygroup:function(e,n,t){var a=[];if(e.length==0)return[];for(var l=null,o=(a=e).length,d=a.length,s=0;o!=0;)if(o--,(l=a[s++]).children!=null&&l.children.length>0){l.children=this.orderbygroupchildren(l.children,n[l.index].orderby,n[l.index].order,t);for(var h=0;h<l.children.length;h++)a.push(l.children[h]),o++}return e.splice(0,d)},orderbygroupchildren:function(e,n,t,a){if(e.length==0)return[];var l=!1;t!=null&&t!="asc"||(l=!0);var o=st().filter;return l?e.sort(function(d,s){var h=null,f=null;if(n=="self"||n==null){if(h=d.name==null?o.valueBlank:d.name.toString(),f=s.name==null?o.valueBlank:s.name.toString(),un(h)&&un(f))return il(h,f)}else h=parseFloat(a[d.orderby].result),f=parseFloat(a[s.orderby].result);return isNaN(h)||isNaN(f)?isNaN(h)&&isNaN(f)?h.localeCompare(f):isNaN(h)?1:isNaN(f)?-1:void 0:cn(h).value()-cn(f).value()}):e.sort(function(d,s){var h=null,f=null;if(n=="self"||n==null){if(h=d.name==null?o.valueBlank:d.name.toString(),f=s.name==null?o.valueBlank:s.name.toString(),un(h)&&un(f))return il(h,f)}else h=parseFloat(a[d.orderby].result),f=parseFloat(a[s.orderby].result);return isNaN(h)||isNaN(f)?isNaN(h)&&isNaN(f)?f.localeCompare(h):isNaN(h)?-1:isNaN(f)?1:void 0:cn(f).value()-cn(h).value()})},generategroupaddstatic:function(e,n){for(var t=[],a=st().pivotTable,l=0;l<e[0].length;l++)l==0?n==a.valueSum?t.push(n):t.push({name:n,issum:!0}):t.push("");return t},generategrouparraymain:function(e,n){for(var t=[],a=0;a<e.length;a++){var l=e[a].name,o=this.generategrouparray(e[a].children,n,1);n[0].stastic!="1"&&n[0].stastic!=null||o.push(this.generategroupaddstatic(o,l)),t=t.concat(o)}return t},generategrouparray:function(e,n,t){for(var a=[],l=0;l<e.length;l++){var o=e[l].name,d=void 0;if(e[l].children==0||e[l].children.length==0)d=[o],a.push(d);else{d=this.generategrouparray(e[l].children,n,t+1);for(var s=0;s<d.length;s++)d[s].unshift(o);n[t].stastic!="1"&&n[t].stastic!=null||d.push(this.generategroupaddstatic(d,o)),a=a.concat(d)}}return a},addStatisticsData:function(e,n,t,a){if(e[t]==null&&(e[t]={data:[],count:0,max:-1/0,min:1/0,counta:0,countunique:0,countuniquedata:{},sum:0,digitaldata:[],sumtype:n.sumtype,index:n.index,name:n.fullname,acc:0}),vc(a).num===!0){var l=Bl(a);e[t].digitaldata.push(l),e[t].count+=1,e[t].sum+=l,l>e[t].max&&(e[t].max=l),l<e[t].min&&(e[t].min=l);var o=Zg(l);o>e[t].acc&&(e[t].acc=o)}a!=""&&(e[t].data.push(a),e[t].counta+=1,a in e[t].countuniquedata||(e[t].countuniquedata[a]=1,e[t].countunique+=1))},dataHandler:function(e,n,t,a,l){var o=st(),d=o.filter,s=o.pivotTable;if(a==null&&(a="column"),e.length==0&&n.length==0&&t.length==0||l.length==0)return this.pivotDatas=[],[];for(var h={},f=l,p=[],g=[],v={},y=[],b=[],k={},w=1;w<f.length;w++){var _,C,A=f[w],I=[],S=[];_=this.getnameArray(A,n),C=this.getnameArray(A,e),I=this.getComposeArray(_),S=this.getComposeArray(C),I.length>0&&I.unshift(s.valueSum),S.length>0&&S.unshift(s.valueSum);for(var E=v,R=g,F=0;F<I.length;F++){var N=I[F],z=F==0?s.valueSum:_[F-1];if(E[F.toString()]!=null&&E[F.toString()][N]!=null)R=R[E[F.toString()][N]].children;else{var P=F==0?"self":n[F-1].orderby=="self"||n[F-1].orderby==null?N:a=="column"?N+t[parseInt(n[F-1].orderby)].fullname:N+s.valueSum;z==null&&(z=d.valueBlank),R.push({name:z,fullname:N,index:F,orderby:P,children:[]}),E[F.toString()]==null&&(E[F.toString()]={}),E[F.toString()][N]==null&&(E[F.toString()][N]=R.length-1),R=R[R.length-1].children}}for(var q=k,V=b,x=0;x<S.length;x++){var ee=S[x],ne=x==0?s.valueSum:C[x-1];if(q[x.toString()]!=null&&q[x.toString()][ee]!=null)V=V[q[x.toString()][ee]].children;else{var ae=x==0?"self":e[x-1].orderby=="self"||e[x-1].orderby==null?ee:a=="column"?s.valueSum+ee:t[parseInt(e[x-1].orderby)].fullname+ee;ne==null&&(ne=d.valueBlank),V.push({name:ne,fullname:ee,index:x,orderby:ae,children:[]}),q[x.toString()]==null&&(q[x.toString()]={}),q[x.toString()][ee]==null&&(q[x.toString()][ee]=V.length-1),V=V[V.length-1].children}}for(var de=0;de<t.length;de++){var ve=Hr(t[de].index,null,A),U=[].concat(S),B=[].concat(I);a=="column"?U.length>0?(U.push(""),U=U.join(t[de].fullname+"|||").split("|||").slice(0,U.length-1)):U.push(t[de].fullname):B.length>0?(B.push(""),B=B.join(t[de].fullname+"|||").split("|||").slice(0,B.length-1)):B.push(t[de].fullname),U.length==0&&U.push(""),B.length==0&&B.push("");for(var le=0;le<B.length;le++)for(var Te=0;Te<U.length;Te++){var ue=B[le]+U[Te];this.addStatisticsData(h,t[de],ue,ve)}}}for(var be in h){var ye=h[be];if(ye.sumtype=="SUM")ye.result=ye.sum;else if(ye.sumtype=="COUNT")ye.result=ye.count;else if(ye.sumtype=="COUNTA")ye.result=ye.counta;else if(ye.sumtype=="COUNTUNIQUE")ye.result=ye.countunique;else if(ye.sumtype=="AVERAGE")ye.result=Bl(ye.sum/ye.count);else if(ye.sumtype=="MAX")ye.result=ye.max;else if(ye.sumtype=="MIN")ye.result=ye.min;else if(ye.sumtype=="MEDIAN"){var ce=ye.digitaldata.sort(function(Jt,Qt){return Jt-Qt}),Re=ce.length,pe=parseInt(Re/2);ye.result=Re%2==0?(ce[pe-1]+ce[pe])/2:ce[pe]}else if(ye.sumtype=="PRODUCT")ye.result=new Function("return "+ye.digitaldata.join("*"))();else if(ye.sumtype=="STDEV"){var me=ye.sum/ye.count;ye.result=pb(me,ye.digitaldata)}else if(ye.sumtype=="STDEVP"){var re=ye.sum/ye.count;ye.result=fb(re,ye.digitaldata)}else if(ye.sumtype=="let"){var _e=ye.sum/ye.count;ye.result=vb(_e,ye.digitaldata)}else if(ye.sumtype=="VARP"){var Ze=ye.sum/ye.count;ye.result=gb(Ze,ye.digitaldata)}var We=Zg(ye.result);We>ye.acc&&(ye.acc=We),ye.result=Bl(ye.result,ye.acc)}if(p=this.getTitleFromGroup(g,n,h),y=this.getTitleFromGroup(b,e,h),a=="column")if(y.length>0&&y[0].length>0)y=this.addValuesToTitle(y,t);else for(var Xe=0;Xe<t.length;Xe++)y.push([t[Xe].fullname]);else if(p.length>0&&p[0].length>0)p=this.addValuesToTitle(p,t);else for(var Ue=0;Ue<t.length;Ue++)p.push([t[Ue].fullname]);var mt=y;y=mb(y,!1);for(var St=t.length==0?0:1,at=(y.length==0?St:y.length)+(p.length==0?St:p.length),dt=(y.length==0?St:y[0].length)+(p.length==0?St:p[0].length),wt=y.length,ct=p.length==0?0:p[0].length,bt=[],De=0;De<at;De++){bt[De]=new Array(dt);for(var He=0;He<dt;He++){var Dt=p[De-wt];if(De<wt&&He<ct)bt[De][He]="";else if(De<wt&&He>=ct)y[De]!=null?D(y[De][He-ct])=="object"?bt[De][He]=y[De][He-ct].name+s.valueSum:bt[De][He]=y[De][He-ct]:bt[De][He]="";else if(De>=wt&&He<ct)Dt!=null?D(Dt[He])=="object"?bt[De][He]=Dt[He].name+s.valueSum:bt[De][He]=Dt[He]:bt[De][He]="";else{var et="";if(Dt!=null)if(Dt instanceof Array&&Dt.length!=1)for(var ur=0;ur<Dt.length;ur++)D(Dt[ur])=="object"?et+=Dt[ur].name:et+=Dt[ur];else et=Dt instanceof Array?Dt[0]:Dt;var Xt="",jt=mt[He-ct];if(jt!=null)if(jt instanceof Array&&jt.length!=1)for(var lr=0;lr<jt.length;lr++)D(jt[lr])=="object"?Xt+=jt[lr].name:Xt+=jt[lr];else Xt=jt instanceof Array?jt[0]:jt;var tr=et;et!=""&&Xt!=""?tr=et+Xt:et==""&&(tr=Xt),bt[De][He]=h[tr]==null?"":h[tr].result}}}if(t.length==1&&e.length>0&&n.length>0)bt[0][0]=t[0].fullname,bt.splice(e.length,1);else if(t.length==1&&e.length>0){for(var xr=bt.splice(e.length,1),rr=[],nr=0;nr<bt.length;nr++){var Ut=[];nr==bt.length-1?Ut.push(xr[0][0]):Ut.push("");for(var ar=0;ar<bt[nr].length-1;ar++)Ut.push(bt[nr][ar]);rr.push(Ut)}bt=rr}return this.pivotDatas=bt,bt},drillDown:function(e,n){if(dn(u.currentSheetIndex,"usePivotTablereports")){this.pivotDatas[e][n];for(var t=$.extend(!0,[],ir.nulldata),a=st(),l=a.filter,o=a.pivotTable,d=1,s=0;s<this.celldata[0].length;s++){var h=void 0;(h=this.celldata[0][s]&&this.celldata[0][s].m?this.celldata[0][s].m:Hr(0,s,this.celldata))!=null&&(h=h.toString()),h!=null&&$.trim(h.toString()).length!=0||(h=o.titleColumn+" "+d),d++,t[0][s]=h}var f={};if(this.row!=null&&this.row.length>0)for(var p=0;p<this.row.length;p++)f[this.row[p].index]=this.pivotDatas[e][p];if(this.column!=null&&this.column.length>0)for(var g=0;g<this.column.length;g++)f[this.column[g].index]=this.pivotDatas[g][n];for(var v=[],y=1;y<this.celldata.length;y++){var b=!0;for(var k in f){var w=void 0;if((w=(w=this.celldata[y][k]&&this.celldata[y][k].m?this.celldata[y][k].m:Hr(y,k,this.celldata))!=null?w.toString():l.valueBlank)!=f[k]){b=!1;break}}b&&v.push(y)}for(var _=0;_<v.length;_++)for(var C=0;C<this.celldata[0].length;C++){var A=void 0;A=(A=this.celldata[v[_]][C]&&this.celldata[v[_]][C].m?this.celldata[v[_]][C].m:Hr(v[_],C,this.celldata))!=null?A.toString():"",t[_+1][C]=A}u.luckysheet_select_save=[{row:[0,v.length],column:[0,this.celldata[0].length-1]}],u.clearjfundo=!1,wa(t,u.luckysheet_select_save),Ra(),u.clearjfundo=!0}}},Xp=function(){var e,n;return e=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(e.prototype=$.extend(new arguments[0],arguments[arguments.length-1]),e._super=arguments[0].prototype):e.prototype=arguments[arguments.length-1],arguments.length>2&&((n=Array.prototype.slice.call(arguments,1,-1)).unshift(e.prototype),$.extend.apply($,n))):e.prototype=arguments[0],e.prototype.cls=e,e},yb=Xp({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,n){this.format=e,this.fclass=n},render:function(e,n,t){var a,l,o,d,s,h=this,f=e;return this.format.replace(this.fre,function(){return l=arguments[1],o=arguments[3],(a=h.precre.exec(l))?(s=a[2],l=a[1]):s=!1,(d=f[l])===void 0?"":o&&n&&n[o]?n[o].get?n[o].get(d)||d:n[o][d]||d:(bb(d)&&(d=t.get("numberFormatter")?t.get("numberFormatter")(d):kb(d,s,t.get("numberDigitGroupCount"),t.get("numberDigitGroupSep"),t.get("numberDecimalMark"))),d)})}});$.spformat=function(e,n){return new yb(e,n)};var wc=function(e,n,t){return e<n?n:e>t?t:e},Xh=function(e,n){var t;return n===2?(t=Math.floor(e.length/2),e.length%2?e[t]:(e[t-1]+e[t])/2):e.length%2?(t=(e.length*n+n)/4)%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]:(t=(e.length*n+2)/4)%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]},Zh=function(e){var n;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:e==(n=parseFloat(e))&&(e=n)}return e},Kh=function(e){var n,t=[];for(n=e.length;n--;)t[n]=Zh(e[n]);return t},hd=function(e,n,t){var a;for(a=n.length;a--;)if((!t||n[a]!==null)&&n[a]!==e)return!1;return!0},Zp=function(e,n){var t,a,l=[];for(t=0,a=e.length;t<a;t++)e[t]!==n&&l.push(e[t]);return l},bb=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},kb=function(e,n,t,a,l){var o,d;for(e=(n===!1?parseFloat(e).toString():e.toFixed(n)).split(""),(o=(o=$.inArray(".",e))<0?e.length:o)<e.length&&(e[o]=l),d=o-t;d>0;d-=t)e.splice(d,0,a);return e.join("")},_c=Xp({init:function(e){var n,t,a=[];for(n in e)e.hasOwnProperty(n)&&typeof n=="string"&&n.indexOf(":")>-1&&((t=n.split(":"))[0]=t[0].length===0?-1/0:parseFloat(t[0]),t[1]=t[1].length===0?1/0:parseFloat(t[1]),t[2]=e[n],a.push(t));this.map=e,this.rangelist=a||!1},get:function(e){var n,t,a,l=this.rangelist;if((a=this.map[e])!==void 0)return a;if(l){for(n=l.length;n--;)if((t=l[n])[0]<=e&&t[1]>=e)return t[2]}}});$.range_map=function(e){return new _c(e)};var Hn={defaultOption:{common:{type:"line",lineColor:"#2ec7c9",fillColor:"#CCF3F4",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!0,disableInteraction:!0,offsetX:0,offsetY:0},line:{spotColor:0,highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:0,maxSpotColor:0,lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!0,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0},bar:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},column:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},tristate:{barWidth:4,barSpacing:1,posBarColor:"#fc5c5c",negBarColor:"#97b552",zeroBarColor:"#999",colorMap:{}},discrete:{lineHeight:"auto",thresholdColor:"#fc5c5c",thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff","#6D87FF","#5876FF","#4465FF","#2F54FF","#1A43FF","#0532FF"],base:void 0},pie:{offset:0,sliceColors:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderWidth:0,borderColor:"#000"},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#5E5E5E",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0}},line:{type:"line",init:function(e,n,t,a,l){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null},getRegion:function(e,n,t){var a,l=this.regionMap;for(a=l.length;a--;)if(l[a]!==null&&n>=l[a][0]&&n<=l[a][1])return l[a][2]},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.yvalues[e]===null,x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){var e,n,t=this.currentRegion,a=this.target,l=this.vertices[t],o=this.options,d=o.get("spotRadius"),s=o.get("highlightSpotColor"),h=o.get("highlightLineColor");l&&(d&&s&&(e=a.drawCircle(l[0],l[1],d,void 0,s),this.highlightSpotId=e.id,a.insertAfterShape(this.lastShapeId,e)),h&&(n=a.drawLine(l[0],this.canvasTop,l[0],this.canvasTop+this.canvasHeight,h),this.highlightLineId=n.id,a.insertAfterShape(this.lastShapeId,n)))},removeHighlight:function(){var e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var e,n,t,a,l,o=this.values,d=o.length,s=this.xvalues,h=this.yvalues,f=this.yminmax;for(e=0;e<d;e++)n=o[e],t=typeof o[e]=="string",a=ul(o[e])==="object"&&o[e]instanceof Array,l=t&&o[e].split(":"),t&&l.length===2?(s.push(Number(l[0])),h.push(Number(l[1])),f.push(Number(l[1]))):a?(s.push(n[0]),h.push(n[1]),f.push(n[1])):(s.push(e),o[e]===null||o[e]==="null"?h.push(null):(h.push(Number(n)),f.push(Number(n))));this.options.get("xvalues")&&(s=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,f),this.miny=this.minyorg=Math.min.apply(Math,f),this.maxx=Math.max.apply(Math,s),this.minx=Math.min.apply(Math,s),this.xvalues=s,this.yvalues=h,this.yminmax=f},processRangeOptions:function(){var e=this.options,n=e.get("normalRangeMin"),t=e.get("normalRangeMax");n!==void 0&&(n<this.miny&&(this.miny=n),t>this.maxy&&(this.maxy=t)),e.get("chartRangeMin")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),e.get("chartRangeMax")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),e.get("chartRangeMinX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),e.get("chartRangeMaxX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,n,t,a,l){var o=this.options.get("normalRangeMin"),d=this.options.get("normalRangeMax"),s=n+Math.round(t-t*((d-this.miny)/l)),h=Math.round(t*(d-o)/l);h==0&&o==d&&(h=1),this.target.drawRect(e,s,a,h,void 0,this.options.get("normalRangeColor")).append()},render:function(e,n){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.values=n;var t,a,l,o,d,s,h,f,p,g,v,y,b,k,w,_,C,A,I,S,E,R,F,N,z=this.options,P=this.target,q=e.mergedOptions.width,V=e.mergedOptions.height,x=this.vertices,ee=z.get("spotRadius"),ne=this.regionMap;if(this.scanValues(),this.processRangeOptions(),R=this.xvalues,F=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2)){for(o=d=0,t=this.maxx-this.minx==0?1:this.maxx-this.minx,a=this.maxy-this.miny==0?1:this.maxy-this.miny,l=this.yvalues.length-1,ee&&(q<4*ee||V<4*ee)&&(ee=0),ee&&(((S=z.get("highlightSpotColor")&&!z.get("disableInteraction"))||z.get("minSpotColor")||z.get("spotColor")&&F[l]===this.miny)&&(V-=Math.ceil(ee)),(S||z.get("maxSpotColor")||z.get("spotColor")&&F[l]===this.maxy)&&(V-=Math.ceil(ee),o+=Math.ceil(ee)),(S||(z.get("minSpotColor")||z.get("maxSpotColor"))&&(F[0]===this.miny||F[0]===this.maxy))&&(d+=Math.ceil(ee),q-=Math.ceil(ee)),(S||z.get("spotColor")||z.get("minSpotColor")||z.get("maxSpotColor")&&(F[l]===this.miny||F[l]===this.maxy))&&(q-=Math.ceil(ee))),V--,z.get("normalRangeMin")===void 0||z.get("drawNormalOnTop")||this.drawNormalRange(d,o,V,q,a),f=[h=[]],b=k=null,w=F.length,N=0;N<w;N++)p=R[N],v=R[N+1],g=F[N],k=(y=d+Math.round((p-this.minx)*(q/t)))+((N<w-1?d+Math.round((v-this.minx)*(q/t)):q)-y)/2,ne[N]=[b||0,k,N],b=k,g===null?N&&(F[N-1]!==null&&(h=[],f.push(h)),x.push(null)):(g<this.miny&&(g=this.miny),g>this.maxy&&(g=this.maxy),h.length||h.push([y,o+V]),s=[y,o+Math.round(V-V*((g-this.miny)/a))],h.push(s),x.push(s));for(_=[],C=[],A=f.length,N=0;N<A;N++)(h=f[N]).length&&(z.get("fillColor")&&(h.push([h[h.length-1][0],o+V]),C.push(h.slice(0)),h.pop()),h.length>2&&(h[0]=[h[0][0],h[1][1]]),_.push(h));for(A=C.length,N=0;N<A;N++)P.drawShape(C[N],z.get("fillColor"),z.get("fillColor")).append();for(A=_.length,N=0;N<A;N++)P.drawShape(_[N],z.get("lineColor"),void 0,z.get("lineWidth")).append();if(z.get("normalRangeMin")!==void 0&&z.get("drawNormalOnTop")&&this.drawNormalRange(d,o,V,q,a),ee&&z.get("valueSpots"))for((I=z.get("valueSpots")).get===void 0&&(I=new _c(I)),N=0;N<w;N++)(E=I.get(F[N]))&&P.drawCircle(d+Math.round((R[N]-this.minx)*(q/t)),o+Math.round(V-V*((F[N]-this.miny)/a)),ee,void 0,E).append();ee&&z.get("spotColor")&&F[l]!==null&&P.drawCircle(d+Math.round((R[R.length-1]-this.minx)*(q/t)),o+Math.round(V-V*((F[l]-this.miny)/a)),ee,void 0,z.get("spotColor")).append(),this.maxy!==this.minyorg&&(ee&&z.get("minSpotColor")&&(p=R[$.inArray(this.minyorg,F)],P.drawCircle(d+Math.round((p-this.minx)*(q/t)),o+Math.round(V-V*((this.minyorg-this.miny)/a)),ee,void 0,z.get("minSpotColor")).append()),ee&&z.get("maxSpotColor")&&(p=R[$.inArray(this.maxyorg,F)],P.drawCircle(d+Math.round((p-this.minx)*(q/t)),o+Math.round(V-V*((this.maxyorg-this.miny)/a)),ee,void 0,z.get("maxSpotColor")).append()))}}},bar:{type:"bar",init:function(e,n){var t=this.options,a=e.mergedOptions.height;e.mergedOptions.width,this.canvasWidth=e.mergedOptions.height,this.canvasHeight=e.mergedOptions.width,parseInt(t.get("barWidth"),10);var l,o,d,s,h,f,p,g,v,y,b,k,w,_,C,A,I,S,E,R,F,N=parseInt(t.get("barSpacing"),10),z=t.get("chartRangeMin"),P=t.get("chartRangeMax"),q=t.get("chartRangeClip"),V=1/0,x=-1/0;for(this.values=n,f=0,p=n.length;f<p;f++)((l=typeof(R=n[f])=="string"&&R.indexOf(":")>-1)||$.isArray(R))&&(C=!0,l&&(R=n[f]=Kh(R.split(":"))),R=Zp(R,null),(o=Math.min.apply(Math,R))<V&&(V=o),(d=Math.max.apply(Math,R))>x&&(x=d));this.stacked=C,this.regionShapes={},this.barWidth=Math.floor(a/n.length)-N,this.barSpacing=N,this.totalBarWidth=this.barWidth+N,this.width=a,q&&(w=z===void 0?-1/0:z,_=P===void 0?1/0:P),h=[],s=C?[]:h;var ee=[],ne=[];for(f=0,p=n.length;f<p;f++)if(C)for(A=n[f],n[f]=E=[],ee[f]=0,s[f]=ne[f]=0,I=0,S=A.length;I<S;I++)(R=E[I]=q?wc(A[I],w,_):A[I])!==null&&(R>0&&(ee[f]+=R),V<0&&x>0?R<0?ne[f]+=Math.abs(R):s[f]+=R:s[f]+=Math.abs(R),h.push(R));else R=q?wc(n[f],w,_):n[f],(R=n[f]=Zh(R))!==null&&h.push(R);this.max=k=Math.max.apply(Math,h),this.min=b=Math.min.apply(Math,h),this.stackMax=x=C?Math.max.apply(Math,ee):k,this.stackMin=V=C?Math.min.apply(Math,h):b,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<b)&&(b=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>k)&&(k=t.get("chartRangeMax")),this.zeroAxis=v=t.get("zeroAxis",!0),y=b<=0&&k>=0&&v?0:v==0?b:b>0?0:k,this.xaxisOffset=y,g=C?Math.max.apply(Math,s)+Math.max.apply(Math,ne):k-y,this.canvasHeightEf=v&&b<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,b<y?(F=Math.floor(this.canvasHeight/2),this.isNeg=!0,F!==Math.ceil(F)&&(this.canvasHeightEf-=2,F=Math.ceil(F))):F=0,this.yoffset=F,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new _c(this.colorMapByValue))),this.range=g},getRegion:function(e,n,t){var a=Math.floor(n/this.totalBarWidth);return a<0||a>=this.values.length?void 0:a},getCurrentRegionFields:function(){var e,n,t=this.currentRegion,a=ensureArray(this.values[t]),l=[];for(n=a.length;n--;)e=a[n],l.push({isNull:e===null,value:e,color:this.calcColor(n,e,t),offset:t});return l},calcColor:function(e,n,t){var a,l,o=this.colorMapByIndex,d=this.colorMapByValue,s=this.options;return a=this.stacked?s.get("stackedBarColor"):n<0?s.get("negBarColor"):s.get("barColor"),n===0&&s.get("zeroColor")!==void 0&&(a=s.get("zeroColor")),d&&(l=d.get(n))?a=l:o&&o.length>t&&(a=o[t]),$.isArray(a)?a[e%a.length]:a},renderRegion:function(e,n){var t,a,l,o,d,s,h,f,p,g,v=this.values[e],y=this.options,b=this.xaxisOffset,k=[],w=this.range,_=this.stacked,C=this.target,A=e*this.totalBarWidth,I=this.canvasHeightEf,S=this.yoffset;if(h=(v=$.isArray(v)?v:[v]).length,f=v[0],o=hd(null,v),g=hd(b,v,!0),o)return y.get("nullColor")?(l=n?y.get("nullColor"):this.calcHighlightColor(y.get("nullColor"),y),t=S>0?S-1:S,C.drawRect(t,A,0,this.barWidth-1,l,l)):void 0;for(d=S,this.isNeg&&(I=Math.floor(I/2)),s=0;s<h;s++){if(f=v[s],_&&f===b){if(!g||p)continue;p=!0}a=w>0?Math.floor(I*(Math.abs(f-b)/w)):I,f<b||f===b&&S===0?(t=d-a,d+=a):_?(t=S,S+=a):(t=S,S-=a),l=this.calcColor(s,f,e),n&&(l=this.calcHighlightColor(l,y)),k.push(C.drawRect(t,A,a-1,this.barWidth-1,l,l))}return k.length===1?k[0]:k}},column:{type:"column",init:function(e,n){var t=this.options,a=e.mergedOptions.width;e.mergedOptions.height,this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,parseInt(t.get("barWidth"),10);var l,o,d,s,h,f,p,g,v,y,b,k,w,_,C,A,I,S,E,R,F,N=parseInt(t.get("barSpacing"),10),z=t.get("chartRangeMin"),P=t.get("chartRangeMax"),q=t.get("chartRangeClip"),V=1/0,x=-1/0;for(this.values=n,f=0,p=n.length;f<p;f++)((l=typeof(R=n[f])=="string"&&R.indexOf(":")>-1)||$.isArray(R))&&(C=!0,l&&(R=n[f]=Kh(R.split(":"))),R=Zp(R,null),(o=Math.min.apply(Math,R))<V&&(V=o),(d=Math.max.apply(Math,R))>x&&(x=d));this.stacked=C,this.regionShapes={},this.barWidth=Math.floor(a/n.length)-N,this.barSpacing=N,this.totalBarWidth=this.barWidth+N,this.width=a,q&&(w=z===void 0?-1/0:z,_=P===void 0?1/0:P),h=[],s=C?[]:h;var ee=[],ne=[];for(f=0,p=n.length;f<p;f++)if(C)for(A=n[f],n[f]=E=[],ee[f]=0,s[f]=ne[f]=0,I=0,S=A.length;I<S;I++)(R=E[I]=q?wc(A[I],w,_):A[I])!==null&&(R>0&&(ee[f]+=R),V<0&&x>0?R<0?ne[f]+=Math.abs(R):s[f]+=R:s[f]+=Math.abs(R),h.push(R));else R=q?wc(n[f],w,_):n[f],(R=n[f]=Zh(R))!==null&&h.push(R);this.max=k=Math.max.apply(Math,h),this.min=b=Math.min.apply(Math,h),this.stackMax=x=C?Math.max.apply(Math,ee):k,this.stackMin=V=C?Math.min.apply(Math,h):b,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<b)&&(b=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>k)&&(k=t.get("chartRangeMax")),this.zeroAxis=v=t.get("zeroAxis",!0),y=b<=0&&k>=0&&v?0:v==0?b:b>0?0:k,this.xaxisOffset=y,g=C?Math.max.apply(Math,s)+Math.max.apply(Math,ne):k-y,this.canvasHeightEf=v&&b<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,b<y?(F=Math.floor(this.canvasHeight/2),this.isNeg=!0,F!==Math.ceil(F)&&(this.canvasHeightEf-=2,F=Math.ceil(F))):F=this.canvasHeight,this.yoffset=F,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new _c(this.colorMapByValue))),this.range=g},getRegion:function(e,n,t){var a=Math.floor(n/this.totalBarWidth);return a<0||a>=this.values.length?void 0:a},getCurrentRegionFields:function(){var e,n,t=this.currentRegion,a=ensureArray(this.values[t]),l=[];for(n=a.length;n--;)e=a[n],l.push({isNull:e===null,value:e,color:this.calcColor(n,e,t),offset:t});return l},calcColor:function(e,n,t){var a,l,o=this.colorMapByIndex,d=this.colorMapByValue,s=this.options;return a=this.stacked?s.get("stackedBarColor"):n<0?s.get("negBarColor"):s.get("barColor"),n===0&&s.get("zeroColor")!==void 0&&(a=s.get("zeroColor")),d&&(l=d.get(n))?a=l:o&&o.length>t&&(a=o[t]),$.isArray(a)?a[e%a.length]:a},renderRegion:function(e,n){var t,a,l,o,d,s,h,f,p,g,v=this.values[e],y=this.options,b=this.xaxisOffset,k=[],w=this.range,_=this.stacked,C=this.target,A=e*this.totalBarWidth,I=this.canvasHeightEf,S=this.yoffset;if(h=(v=$.isArray(v)?v:[v]).length,f=v[0],o=hd(null,v),g=hd(b,v,!0),o)return y.get("nullColor")?(l=n?y.get("nullColor"):this.calcHighlightColor(y.get("nullColor"),y),t=S>0?S-1:S,C.drawRect(A,t,this.barWidth-1,0,l,l)):void 0;for(d=S,this.isNeg&&(I=Math.floor(I/2)),s=0;s<h;s++){if(f=v[s],_&&f===b){if(!g||p)continue;p=!0}a=w>0?Math.floor(I*(Math.abs(f-b)/w)):I,f<b||f===b&&S===0?(t=d,d+=a):(t=S-a,S-=a),l=this.calcColor(s,f,e),n&&(l=this.calcHighlightColor(l,y)),k.push(C.drawRect(A,t,this.barWidth-1,a-1,l,l))}return k.length===1?k[0]:k}},tristate:{type:"tristate",init:function(e,n){var t=this.options;e.mergedOptions.width,e.mergedOptions.height,this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;var a=parseInt(t.get("barWidth"),10),l=parseInt(t.get("barSpacing"),10);this.regionShapes={},this.barWidth=a,this.barSpacing=l,this.totalBarWidth=a+l,this.values=$.map(n,Number),this.width=n.length*a+(n.length-1)*l,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new _c(this.colorMapByValue)))},getRegion:function(e,n,t){return Math.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,n){var t,a=this.values,l=this.options,o=this.colorMapByIndex,d=this.colorMapByValue;return d&&(t=d.get(e))?t:o&&o.length>n?o[n]:a[n]<0?l.get("negBarColor"):a[n]>0?l.get("posBarColor"):l.get("zeroBarColor")},renderRegion:function(e,n){var t,a,l,o,d,s,h=this.values,f=this.options,p=this.target;if(t=this.canvasHeight,l=Math.round(t/2),o=e*this.totalBarWidth,h[e]<0?(d=l,a=l-1):h[e]>0?(d=0,a=l-1):(d=l-1,a=2),(s=this.calcColor(h[e],e))!==null)return n&&(s=this.calcHighlightColor(s,f)),p.drawRect(o,d,this.barWidth-1,a-1,s,s)}},discrete:{type:"discrete",init:function(e,n){var t=this.options,a=e.mergedOptions.width;e.mergedOptions.height,this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.regionShapes={},this.values=n=$.map(n,Number),this.min=Math.min.apply(Math,n),this.max=Math.max.apply(Math,n),this.range=this.max-this.min,this.width=a,this.interval=Math.floor(a/n.length),this.itemWidth=a/n.length,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.min)&&(this.min=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.max)&&(this.max=t.get("chartRangeMax")),this.target&&(this.lineHeight=t.get("lineHeight")==="auto"?Math.round(.3*this.canvasHeight):t.get("lineHeight"))},getRegion:function(e,n,t){return Math.floor(n/this.itemWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],offset:e}},renderRegion:function(e,n){var t,a,l,o,d=this.values,s=this.options,h=this.min,f=this.max,p=this.range,g=this.interval,v=(this.target,this.canvasHeight),y=this.lineHeight,b=v-y;return a=wc(d[e],h,f),o=e*g,t=Math.round(b-b*((a-h)/p)),l=s.get("thresholdColor")&&a<s.get("thresholdValue")?s.get("thresholdColor"):s.get("lineColor"),n&&(l=this.calcHighlightColor(l,s)),this.target.drawRect(o,t,g<=2?1:g-2,y,l,l)}},bullet:{type:"bullet",init:function(e,n){var t,a,l,o=this.options,d=e.mergedOptions.width;e.mergedOptions.height,this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=n=Kh(n),(l=n.slice())[0]=l[0]===null?l[2]:l[0],l[1]=n[1]===null?l[2]:l[1],t=Math.min.apply(Math,n),a=Math.max.apply(Math,n),t=o.get("base")===void 0?t<0?t:0:o.get("base"),this.min=t,this.max=a,this.range=a-t,this.shapes={},this.valueShapes={},this.regiondata={},this.width=d,n.length||(this.disabled=!0)},getRegion:function(e,n,t){var a=this.target.getShapeAt(e,n,t);return a!==void 0&&this.shapes[a]!==void 0?this.shapes[a]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){var n,t=this.currentRegion,a=this.valueShapes[t];switch(delete this.shapes[a],t.substr(0,1)){case"r":n=this.renderRange(t.substr(1),e);break;case"p":n=this.renderPerformance(e);break;case"t":n=this.renderTarget(e)}this.valueShapes[t]=n.id,this.shapes[n.id]=t,this.target.replaceWithShape(a,n)},renderRange:function(e,n){var t=this.values[e],a=Math.round(this.canvasWidth*((t-this.min)/this.range)),l=this.options.get("rangeColors")[e-2];return n&&(l=this.calcHighlightColor(l,this.options)),this.target.drawRect(0,0,a-1,this.canvasHeight-1,l,l)},renderPerformance:function(e){var n=this.values[1],t=Math.round(this.canvasWidth*((n-this.min)/this.range)),a=this.options.get("performanceColor");return e&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(0,Math.round(.3*this.canvasHeight),t-1,Math.round(.4*this.canvasHeight)-1,a,a)},renderTarget:function(e){var n=this.values[0],t=Math.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),a=Math.round(.1*this.canvasHeight),l=this.canvasHeight-2*a,o=this.options.get("targetColor");return e&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(t,a,this.options.get("targetWidth")-1,l-1,o,o)},render:function(e,n){this.init(e,n);var t,a,l=this.values.length;for(this.target,t=2;t<l;t++)a=this.renderRange(t).append(),this.shapes[a.id]="r"+t,this.valueShapes["r"+t]=a.id;this.values[1]!==null&&(a=this.renderPerformance().append(),this.shapes[a.id]="p1",this.valueShapes.p1=a.id),this.values[0]!==null&&(a=this.renderTarget().append(),this.shapes[a.id]="t0",this.valueShapes.t0=a.id)}},pie:{type:"pie",init:function(e,n){var t=this.options;e.mergedOptions.width,e.mergedOptions.height,this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;var a,l=0;if(this.shapes={},this.valueShapes={},this.values=n=$.map(n,Number),t.get("width")==="auto"&&(this.width=this.height),n.length>0)for(a=n.length;a--;)l+=n[a];this.total=l,this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,n,t){var a=this.target.getShapeAt(e,n,t);return a!==void 0&&this.shapes[a]!==void 0?this.shapes[a]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){var n=this.currentRegion,t=this.renderSlice(n,e),a=this.valueShapes[n];delete this.shapes[a],this.target.replaceWithShape(a,t),this.valueShapes[n]=t.id,this.shapes[t.id]=n},renderSlice:function(e,n){var t,a,l,o,d,s=this.target,h=this.options,f=this.radius,p=h.get("borderWidth"),g=h.get("offset"),v=2*Math.PI,y=this.values,b=this.total,k=g?2*Math.PI*(g/360):0;for(o=y.length,l=0;l<o;l++){if(t=k,a=k,b>0&&(a=k+v*(y[l]/b)),e===l)return d=h.get("sliceColors")[l%h.get("sliceColors").length],n&&(d=this.calcHighlightColor(d,h)),s.drawPieSlice(f,f,f-p,t,a,void 0,d);k=a}},render:function(e,n){this.init(e,n);var t,a,l=this.target,o=this.values,d=this.options,s=this.radius,h=d.get("borderWidth");for(h&&l.drawCircle(s,s,Math.floor(s-h/2),d.get("borderColor"),void 0,h).append(),a=o.length;a--;)o[a]&&(t=this.renderSlice(a).append(),this.valueShapes[a]=t.id,this.shapes[t.id]=a)}},box:{type:"box",init:function(e,n){var t=this.options,a=e.mergedOptions.width;e.mergedOptions.height,this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=$.map(n,Number),this.width=t.get("width")==="auto"?"4.0em":a,this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==void 0&&e.push({field:"lo",value:this.loutlier}),this.routlier!==void 0&&e.push({field:"ro",value:this.routlier}),this.lwhisker!==void 0&&e.push({field:"lw",value:this.lwhisker}),this.rwhisker!==void 0&&e.push({field:"rw",value:this.rwhisker}),e},render:function(e,n){this.init(e,n);var t,a,l,o,d,s,h,f,p,g,v,y=this.target,b=this.values,k=b.length,w=this.options,_=this.canvasWidth,C=this.canvasHeight,A=w.get("chartRangeMin")===void 0?Math.min.apply(Math,b):w.get("chartRangeMin"),I=w.get("chartRangeMax")===void 0?Math.max.apply(Math,b):w.get("chartRangeMax"),S=0;if(w.get("raw"))w.get("showOutliers")&&b.length>5?(a=b[0],t=b[1],o=b[2],d=b[3],s=b[4],h=b[5],f=b[6]):(t=b[0],o=b[1],d=b[2],s=b[3],h=b[4]);else if(b.sort(function(E,R){return E-R}),o=Xh(b,1),d=Xh(b,2),l=(s=Xh(b,3))-o,w.get("showOutliers")){for(t=h=void 0,p=0;p<k;p++)t===void 0&&b[p]>o-l*w.get("outlierIQR")&&(t=b[p]),b[p]<s+l*w.get("outlierIQR")&&(h=b[p]);a=b[0],f=b[k-1]}else t=b[0],h=b[k-1];this.quartiles=[o,d,s],this.lwhisker=t,this.rwhisker=h,this.loutlier=a,this.routlier=f,v=_/(I-A+1),w.get("showOutliers")&&(S=Math.ceil(w.get("spotRadius")),v=(_-=2*Math.ceil(w.get("spotRadius")))/(I-A+1),a<t&&y.drawCircle((a-A)*v+S,C/2,w.get("spotRadius"),w.get("outlierLineColor"),w.get("outlierFillColor")).append(),f>h&&y.drawCircle((f-A)*v+S,C/2,w.get("spotRadius"),w.get("outlierLineColor"),w.get("outlierFillColor")).append()),y.drawRect(Math.round((o-A)*v+S),Math.round(.1*C),Math.round((s-o)*v),Math.round(.8*C),w.get("boxLineColor"),w.get("boxFillColor")).append(),y.drawLine(Math.round((t-A)*v+S),Math.round(C/2),Math.round((o-A)*v+S),Math.round(C/2),w.get("lineColor")).append(),y.drawLine(Math.round((t-A)*v+S),Math.round(C/4),Math.round((t-A)*v+S),Math.round(C-C/4),w.get("whiskerColor")).append(),y.drawLine(Math.round((h-A)*v+S),Math.round(C/2),Math.round((s-A)*v+S),Math.round(C/2),w.get("lineColor")).append(),y.drawLine(Math.round((h-A)*v+S),Math.round(C/4),Math.round((h-A)*v+S),Math.round(C-C/4),w.get("whiskerColor")).append(),y.drawLine(Math.round((d-A)*v+S),Math.round(.1*C),Math.round((d-A)*v+S),Math.round(.9*C),w.get("medianColor")).append(),w.get("target")&&(g=Math.ceil(w.get("spotRadius")),y.drawLine(Math.round((w.get("target")-A)*v+S),Math.round(C/2-g),Math.round((w.get("target")-A)*v+S),Math.round(C/2+g),w.get("targetColor")).append(),y.drawLine(Math.round((w.get("target")-A)*v+S-g),Math.round(C/2),Math.round((w.get("target")-A)*v+S+g),Math.round(C/2),w.get("targetColor")).append())}},shapeCount:0,shapes:{},shapeseq:[],lastShapeId:null,mergedOptions:null,init:function(e,n){var t,a,l;return n=n||{},l=(a=this.defaultOption).common,t=a[n.type||l.type],this.shapeCount=0,this.shapes={},this.shapeseq=[],this.lastShapeId=null,this.mergedOptions=$.extend({},l,t,n),this.mergedOptions.width=this.mergedOptions.width,this.mergedOptions.height=this.mergedOptions.height,this[this.mergedOptions.type].render(this,e),{shapes:this.shapes,shapeseq:this.shapeseq,offsetX:this.mergedOptions.offsetX,offsetY:this.mergedOptions.offsetY,pixelWidth:this.mergedOptions.width,pixelHeight:this.mergedOptions.height}},_getContext:function(e,n,t){var a;return a=this.ctx!=null?this.ctx:$("#"+this._canvasID).get(0).getContext("2d"),e!==void 0&&(a.strokeStyle=e),a.lineWidth=t===void 0?1:t,n!==void 0&&(a.fillStyle=n),a},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,n,t,a,l){var o,d,s=this._getContext(t,a,l);for(s.beginPath(),s.moveTo(n[0][0]+.5+this.offsetX,n[0][1]+.5+this.offsetY),o=1,d=n.length;o<d;o++)s.lineTo(n[o][0]+.5+this.offsetX,n[o][1]+.5+this.offsetY);t!==void 0&&s.stroke(),a!==void 0&&s.fill(),this.targetX!==void 0&&this.targetY!==void 0&&s.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,n,t,a,l,o,d){var s=this._getContext(l,o,d);s.beginPath(),n+=this.offsetX,t+=this.offsetY,s.arc(n,t,a,0,2*Math.PI,!1),this.targetX!==void 0&&this.targetY!==void 0&&s.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e),l!==void 0&&s.stroke(),o!==void 0&&s.fill()},_drawPieSlice:function(e,n,t,a,l,o,d,s){var h=this._getContext(d,s);n+=this.offsetX,t+=this.offsetY,h.beginPath(),h.moveTo(n,t),h.arc(n,t,a,l,o,!1),h.lineTo(n,t),h.closePath(),d!==void 0&&h.stroke(),s&&h.fill(),this.targetX!==void 0&&this.targetY!==void 0&&h.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,n,t,a,l,o,d){return this._drawShape(e,[[n,t],[n+a,t],[n+a,t+l],[n,t+l],[n,t]],o,d)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,n){var t,a=this.shapeseq;for(this.shapes[n.id]=n,t=a.length;t--;)a[t]==e&&(a[t]=n.id);delete this.shapes[e]},replaceWithShapes:function(e,n){var t,a,l,o=this.shapeseq,d={};for(a=e.length;a--;)d[e[a]]=!0;for(a=o.length;a--;)d[t=o[a]]&&(o.splice(a,1),delete this.shapes[t],l=a);for(a=n.length;a--;)o.splice(l,0,n[a].id),this.shapes[n[a].id]=n[a]},insertAfterShape:function(e,n){var t,a=this.shapeseq;for(t=a.length;t--;)if(a[t]===e)return a.splice(t+1,0,n.id),void(this.shapes[n.id]=n)},removeShapeId:function(e){var n,t=this.shapeseq;for(n=t.length;n--;)if(t[n]===e){t.splice(n,1);break}delete this.shapes[e]},getShapeAt:function(e,n,t){return this.targetX=n,this.targetY=t,this.render(),this.currentTargetShapeId},_canvasID:"luckysheetTableContent",render:function(e,n,t,a,l,o,d,s){d==null&&(d="luckysheetTableContent"),this._canvasID=d,s!=null&&(this.ctx=s);var h,f,p=e.length;for(this._getContext(),this.offsetX=t,this.offsetY=a,this.pixelWidth=l,this.pixelHeight=o,f=0;f<p;f++)this["_draw"+(h=n[e[f]]).type].apply(this,h.args)},drawLine:function(e,n,t,a,l,o){return this.drawShape([[e,n],[t,a]],l,o)},drawShape:function(e,n,t,a){return this._genShape("Shape",[e,n,t,a])},drawCircle:function(e,n,t,a,l,o){return this._genShape("Circle",[e,n,t,a,l,o])},drawPieSlice:function(e,n,t,a,l,o,d){return this._genShape("PieSlice",[e,n,t,a,l,o,d])},drawRect:function(e,n,t,a,l,o){return this._genShape("Rect",[e,n,t,a,l,o])},_genShape:function(e,n){var t=this.shapeCount++;n.unshift(t);var a={id:t,type:e,args:n};return this.shapes[t]=a,this.shapeseq.push(t),this.lastShapeId=t,{append:function(){return a},get:function(){return t}}}},xb=function(e){var n,t=this.currentRegion,a=this.target,l=this.regionShapes[t];l&&(n=this.renderRegion(t,e),$.isArray(n)||$.isArray(l)?(a.replaceWithShapes(l,n),this.regionShapes[t]=$.map(n,function(o){return o.id})):(a.replaceWithShape(l,n),this.regionShapes[t]=n.id))},wb=function(e,n){this.init(e,n);var t,a,l,o,d=this.values,s=(this.target,this.regionShapes);for(l=d.length;l--;)if(t=this.renderRegion(l))if($.isArray(t)){for(a=[],o=t.length;o--;)t[o].append(),a.push(t[o].id);s[l]=a}else t.append(),s[l]=t.id;else s[l]=null},_b={get:function(e){return Hn.mergedOptions[e]}},Cb={drawLine:function(e,n,t,a,l,o){return Hn.drawLine(e,n,t,a,l,o)},drawShape:function(e,n,t,a){return Hn.drawShape(e,n,t,a)},drawCircle:function(e,n,t,a,l,o){return Hn.drawCircle(e,n,t,a,l,o)},drawPieSlice:function(e,n,t,a,l,o,d){return Hn.drawPieSlice(e,n,t,a,l,o,d)},drawRect:function(e,n,t,a,l,o){return Hn.drawRect(e,n,t,a,l,o)}};for(var yu in Hn)yu in{line:null,bar:null,column:null,tristate:null,discrete:null,bullet:null,pie:null,box:null}&&(Hn[yu].options=_b,Hn[yu].target=Cb),yu in{bar:null,column:null,tristate:null,discrete:null}&&(Hn[yu].changeHighlight=xb,Hn[yu].render=wb);function bu(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollTop()),n==null&&(n=u.luckysheetTableContentHW[1]),t==null&&(t=u.columnHeaderHeight);var a,l,o,d,s=$("#luckysheetTableContent").get(0).getContext("2d");s.save(),s.scale(u.devicePixelRatio,u.devicePixelRatio),s.clearRect(0,t,u.rowHeaderWidth-1,n),s.font=lc(),s.textBaseline=Tf,s.fillStyle=ih,(a=fa(u.visibledatarow,e))==-1&&(a=0),(l=fa(u.visibledatarow,e+n))==-1&&(l=u.visibledatarow.length-1),s.save(),s.beginPath(),s.rect(0,t-1,u.rowHeaderWidth-1,n-2),s.clip();for(var h,f=a;f<=l;f++){d=f==0?-e-1:u.visibledatarow[f-1]-e-1,o=u.visibledatarow[f]-e;var p=a==f?-2:0,g=l==f?-2:0;if(Ya.createHookFunction("rowTitleCellRenderBefore",f+1,{r:f,top:d+t+p,width:u.rowHeaderWidth-1,height:o-d+1+g-p},s)){if(!(u.config.rowhidden!=null&&u.config.rowhidden[f]!=null)){s.fillStyle="#ffffff",s.fillRect(0,d+t+p,u.rowHeaderWidth-1,o-d+1+g-p),s.fillStyle="#000000",s.save(),s.scale(u.zoomRatio,u.zoomRatio);var v=eo(f+1,s),y=(u.rowHeaderWidth-v.width)/2,b=d+(o-d)/2+t;s.fillText(f+1,y/u.zoomRatio,b/u.zoomRatio),s.restore()}s.beginPath(),s.moveTo(u.rowHeaderWidth-2+.5,d+t-2),s.lineTo(u.rowHeaderWidth-2+.5,o+t-2),s.lineWidth=1,s.strokeStyle=Fi,s.stroke(),s.closePath(),u.config.rowhidden!=null&&u.config.rowhidden[f]==null&&u.config.rowhidden[f+1]!=null?(s.beginPath(),s.moveTo(-1,o+t-4+.5),s.lineTo(u.rowHeaderWidth-1,o+t-4+.5),s.closePath(),s.stroke()):u.config.rowhidden!=null&&u.config.rowhidden[f]!=null||(s.beginPath(),s.moveTo(-1,o+t-2+.5),s.lineTo(u.rowHeaderWidth-1,o+t-2+.5),s.closePath(),s.stroke()),u.config.rowhidden!=null&&u.config.rowhidden[f-1]!=null&&h!=null&&(s.beginPath(),s.moveTo(-1,h+t+.5),s.lineTo(u.rowHeaderWidth-1,h+t+.5),s.closePath(),s.stroke()),h=o,Ya.createHookFunction("rowTitleCellRenderAfter",f+1,{r:f,top:d+t+p,width:u.rowHeaderWidth-1,height:o-d+1+g-p},s)}}s.restore(),s.restore()}function ku(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=u.luckysheetTableContentHW[0]),t==null&&(t=u.rowHeaderWidth);var a,l,o,d,s=$("#luckysheetTableContent").get(0).getContext("2d");s.save(),s.scale(u.devicePixelRatio,u.devicePixelRatio),s.clearRect(t,0,n,u.columnHeaderHeight-1),s.font=lc(),s.textBaseline=Tf,s.fillStyle=ih,(a=fa(u.visibledatacolumn,e))==-1&&(a=0),(l=fa(u.visibledatacolumn,e+n))==-1&&(l=u.visibledatacolumn.length-1),s.save(),s.beginPath(),s.rect(t-1,0,n,u.columnHeaderHeight-1),s.clip();for(var h,f=a;f<=l;f++){d=f==0?-e:u.visibledatacolumn[f-1]-e,o=u.visibledatacolumn[f]-e;var p=ya(f);if(Ya.createHookFunction("columnTitleCellRenderBefore",p,{c:f,left:d+t-1,width:o-d,height:u.columnHeaderHeight-1},s)){if(!(u.config.colhidden!=null&&u.config.colhidden[f]!=null)){s.fillStyle="#ffffff",s.fillRect(d+t-1,0,o-d,u.columnHeaderHeight-1),s.fillStyle="#000000",s.save(),s.scale(u.zoomRatio,u.zoomRatio);var g=eo(p,s),v=Math.round(d+(o-d)/2+t-g.width/2),y=Math.round(u.columnHeaderHeight/2);s.fillText(p,v/u.zoomRatio,y/u.zoomRatio),s.restore()}u.config.colhidden!=null&&u.config.colhidden[f]==null&&u.config.colhidden[f+1]!=null?(s.beginPath(),s.moveTo(o+t-4+.5,0),s.lineTo(o+t-4+.5,u.columnHeaderHeight-2),s.lineWidth=1,s.strokeStyle=Fi,s.closePath(),s.stroke()):u.config.colhidden!=null&&u.config.colhidden[f]!=null||(s.beginPath(),s.moveTo(o+t-2+.5,0),s.lineTo(o+t-2+.5,u.columnHeaderHeight-2),s.lineWidth=1,s.strokeStyle=Fi,s.closePath(),s.stroke()),u.config.colhidden!=null&&u.config.colhidden[f-1]!=null&&h!=null&&(s.beginPath(),s.moveTo(h+t+.5,0),s.lineTo(h+t+.5,u.columnHeaderHeight-2),s.closePath(),s.stroke()),s.beginPath(),s.moveTo(d+t-1,u.columnHeaderHeight-2+.5),s.lineTo(o+t-1,u.columnHeaderHeight-2+.5),s.stroke(),s.closePath(),h=o,Ya.createHookFunction("columnTitleCellRenderAfter",p,{c:f,left:d+t-1,width:o-d,height:u.columnHeaderHeight-1},s)}}s.restore(),s.restore()}function Mi(e,n,t,a,l,o,d,s,h){if(u.flowdata!=null){var f=ir.getSheetByIndex();clearTimeout(u.measureTextCacheTimeOut),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),t==null&&(t=u.luckysheetTableContentHW[0]),a==null&&(a=u.luckysheetTableContentHW[1]),l==null&&(l=u.rowHeaderWidth),o==null&&(o=u.columnHeaderHeight),d==null&&(d=0),s==null&&(s=0);var p,g,v,y,b,k,w=null;if(h==null)w=$("#luckysheetTableContent").get(0).getContext("2d");else if(D(h)=="object")try{w=h.get(0).getContext("2d")}catch{w=h}else w=$("#"+h).get(0).getContext("2d");w.save(),w.scale(u.devicePixelRatio,u.devicePixelRatio),w.clearRect(0,0,u.luckysheetTableContentHW[0],u.luckysheetTableContentHW[1]),(p=fa(u.visibledatarow,n))==-1&&(p=0),p+=s,(g=fa(u.visibledatarow,n+a))==-1&&(g=u.visibledatarow.length-1),(g+=s)>=u.visibledatarow.length&&(g=u.visibledatarow.length-1),(v=fa(u.visibledatacolumn,e))==-1&&(v=0),v+=d,(y=fa(u.visibledatacolumn,e+t))==-1&&(y=u.visibledatacolumn.length-1),(y+=d)>=u.visibledatacolumn.length&&(y=u.visibledatacolumn.length-1),p==0||u.visibledatarow[p-1],b=u.visibledatarow[g],v==0||u.visibledatacolumn[v-1],k=u.visibledatacolumn[y],w.fillStyle="#ffffff",w.fillRect(l-1,o-1,k-e,b-n),w.font=lc(),w.fillStyle=ih;var _=[],C={},A={};Ya.createHookFunction("cellAllRenderBefore",u.flowdata,f,w);for(var I=p;I<=g;I++){var S=void 0;S=I==0?-n-1:u.visibledatarow[I-1]-n-1;var E=u.visibledatarow[I]-n;if(u.config.rowhidden==null||u.config.rowhidden[I]==null)for(var R=v;R<=y;R++){var F=void 0;F=R==0?-e:u.visibledatacolumn[R-1]-e;var N=u.visibledatacolumn[R]-e;if(u.config.colhidden==null||u.config.colhidden[R]==null){var z=u.defaultcollen;if(u.config.columnlen!=null&&u.config.columnlen[R]!=null&&(z=u.config.columnlen[R]),u.flowdata[I]!=null&&u.flowdata[I][R]!=null){var P=u.flowdata[I][R];if(D(P)=="object"&&"mc"in P){if(A[I+"_"+R]={start_r:S,start_c:F,end_r:E,end_c:N},!("rs"in P.mc)){var q="r"+P.mc.r+"c"+P.mc.c,V=_[C[q]];V==null?(C[q]=_.length,_.push({r:I,c:R,start_c:F,start_r:S,end_r:E,end_c:N,firstcolumnlen:z})):(V.c==R&&(V.end_r+=E-S-1),V.r==I&&(V.end_c+=N-F,V.firstcolumnlen+=z));continue}C["r"+I+"c"+R]=_.length}}_.push({r:I,c:R,start_r:S,start_c:F,end_r:E,end_c:N,firstcolumnlen:z}),A[I+"_"+R]={start_r:S,start_c:F,end_r:E,end_c:N}}}}for(var x=Sh(u.luckysheetfile[je(u.currentSheetIndex)].dynamicArray),ee=Un.getComputeMap(),ne=kr.getComputeMap(),ae=function(Ae,Ve,gt,vt,pt){for(var Tt={},Ot=u.flowdata,It=vt;It<=pt;It++)if(Ot[It]!=null)if(u.cellOverflowMapCache[It]==null){for(var Lt=!1,At=0;At<Ot[It].length;At++){var or=Ot[It][At];if((u.config.colhidden==null||u.config.colhidden[At]==null)&&or!=null&&(!$t(or.v)||qi(or))&&or.mc==null&&or.tb=="1"){var Cr=dr.checkstatus(Ot,It,At,"ht"),Ar=qs(or,Ae,{r:It,c:At}),Rr=0;Ar!=null&&(Rr=Ar.textWidthAll);var Zr=At-1<0?0:u.visibledatacolumn[At-1],Tr=u.visibledatacolumn[At],jr=void 0,ta=void 0;if(Tr-Zr<Rr){if(Cr=="0"){var ia=xu(It,At,At-1,"forward",Cr,Rr),Jr=xu(It,At,At+1,"backward",Cr,Rr);jr=ia.success?ia.c:ia.c+1,ta=Jr.success?Jr.c:Jr.c-1}else if(Cr=="1"){var ba=xu(It,At,At+1,"backward",Cr,Rr);jr=At,ta=ba.success?ba.c:ba.c-1}else if(Cr=="2"){var Wr=xu(It,At,At-1,"forward",Cr,Rr);ta=At,jr=Wr.success?Wr.c:Wr.c+1}}else jr=At,ta=At;if((jr<=gt||ta>=Ve)&&jr<ta){var Fr={r:It,stc:jr,edc:ta};Tt[It]==null&&(Tt[It]={}),Tt[It][At]=Fr,Lt=!0}}}Lt&&(u.cellOverflowMapCache[It]=Tt[It])}else Tt[It]=u.cellOverflowMapCache[It];return Tt}(w,v,y,p,g),de=[],ve=0;ve<_.length;ve++){var U=_[ve],B=U.r,le=U.c,Te=U.start_r,ue=U.start_c,be=U.end_r,ye=U.end_c;if(U.firstcolumnlen,u.flowdata[B]!=null)if(u.flowdata[B][le]==null)Jh(B,le,Te,ue,be,ye,w,ee,ne,l,o,x,ae,v,y,n,e,.5);else{var ce=u.flowdata[B][le],Re=null;if(ul(ce)=="object"&&"mc"in ce?de.push(_[ve]):Re=bp(B,le),Re==null||Re.toString().length==0){Jh(B,le,Te,ue,be,ye,w,ee,ne,l,o,x,ae,v,y,n,e,.5);var pe=dr.borderfix(u.flowdata,B,le),me=[ue+l+pe[0],Te+o+pe[1],ye-ue-3+pe[2],be-Te-3-1+pe[3]];Kp(B,le,me[0],me[1],"luckysheetTableContent",w)}else B+"_"+le in x&&(Re=x[B+"_"+le].v),Jp(B,le,Te,ue,be,ye,Re,w,ee,ne,l,o,x,ae,v,y,n,e,.5)}}for(var re=0;re<de.length;re++){var _e=de[re],Ze=_e.r,We=_e.c,Xe=_e.start_r,Ue=_e.start_c,mt=_e.end_r,St=_e.end_c,at=(_e.firstcolumnlen,null),dt=u.flowdata[Ze][We].mc;at=bp(dt.r,dt.c),Ze=dt.r,We=dt.c;var wt=u.flowdata[Ze][We];if(Ue=We==0?-e:u.visibledatacolumn[We-1]-e,Xe=Ze==0?-n-1:u.visibledatarow[Ze-1]-n-1,mt=u.visibledatarow[Ze+wt.mc.rs-1]-n,St=u.visibledatacolumn[We+wt.mc.cs-1]-e,at==null||at.toString().length==0){Jh(Ze,We,Xe,Ue,mt,St,w,ee,ne,l,o,x,ae,v,y,n,e,.5,!0);var ct=dr.borderfix(u.flowdata,Ze,We),bt=[Ue+l+ct[0],Xe+o+ct[1],St-Ue-3+ct[2],mt-Xe-3-1+ct[3]];Kp(Ze,We,bt[0],bt[1],"luckysheetTableContent",w)}else Ze+"_"+We in x&&(at=x[Ze+"_"+We].v),Jp(Ze,We,Xe,Ue,mt,St,at,w,ee,ne,l,o,x,ae,v,y,n,e,.5,!0)}for(var De=p;De<=g;De++){var He=void 0;He=De==0?-n-1:u.visibledatarow[De-1]-n-1;for(var Dt=u.visibledatarow[De]-n,et=v;et<=y;et++){var ur=void 0;ur=et==0?-e:u.visibledatacolumn[et-1]-e;var Xt=u.visibledatacolumn[et]-e;u.luckysheetcurrentisPivotTable&&Pr.drawPivotTable?((et==0||et==5)&&De<=11&&(w.beginPath(),w.moveTo(Xt-2+.5+l,He+o),w.lineTo(Xt-2+.5+l,Dt-2+.5+o),w.lineWidth=1,w.strokeStyle="#000000",w.closePath(),w.stroke()),(De==2||De==11)&&et<=5&&(w.beginPath(),w.moveTo(ur-1+l,Dt-2+.5+o),w.lineTo(Xt-2+.5+l,Dt-2+.5+o),w.lineWidth=1,w.strokeStyle="#000000",w.closePath(),w.stroke()),De==6&&et==3&&(w.save(),w.font="bold 30px Arial",w.fillStyle="#626675",w.textAlign="center",w.fillText(st().pivotTable.title,ur+(Xt-ur)/2+4+l,He+(Dt-He)/2-1+o),w.restore())):u.luckysheetcurrentisPivotTable&&et<Pr.pivotTableBoundary[1]&&De<Pr.pivotTableBoundary[0]&&(w.beginPath(),w.moveTo(Xt-2+.5+l,He+o),w.lineTo(Xt-2+.5+l,Dt-2+.5+o),w.lineWidth=1,w.strokeStyle="#000000",w.closePath(),w.stroke(),w.beginPath(),w.moveTo(ur-1+l,Dt-2+.5+o),w.lineTo(Xt-2+l,Dt-2+.5+o),w.lineWidth=1,w.strokeStyle="#000000",w.closePath(),w.stroke())}}if(u.config.borderInfo!=null&&u.config.borderInfo.length>0){var jt=function(Ae,Ve,gt,vt,pt,Tt,Ot,It,Lt){var At=Ae,or=vt-2+.5+Ot,Cr=gt+It-1,Ar=vt-2+.5+Ot,Rr=pt-2+.5+It;Lt.save(),dr.setLineDash(Lt,At,"v",or,Cr,Ar,Rr),Lt.strokeStyle=Ve,Lt.stroke(),Lt.closePath(),Lt.restore()},lr=function(Ae,Ve,gt,vt,pt,Tt,Ot,It,Lt){var At=Ae,or=Tt-2+.5+Ot,Cr=gt+It-1,Ar=Tt-2+.5+Ot,Rr=pt-2+.5+It;Lt.save(),dr.setLineDash(Lt,At,"v",or,Cr,Ar,Rr),Lt.strokeStyle=Ve,Lt.stroke(),Lt.closePath(),Lt.restore()},tr=function(Ae,Ve,gt,vt,pt,Tt,Ot,It,Lt){var At=Ae,or=vt-2+.5+Ot,Cr=pt-2+.5+It,Ar=Tt-2+.5+Ot,Rr=pt-2+.5+It;Lt.save(),dr.setLineDash(Lt,At,"h",or,Cr,Ar,Rr),Lt.strokeStyle=Ve,Lt.stroke(),Lt.closePath(),Lt.restore()},xr=function(Ae,Ve,gt,vt,pt,Tt,Ot,It,Lt){var At=Ae,or=vt-2+.5+Ot,Cr=gt-1+.5+It,Ar=Tt-2+.5+Ot,Rr=gt-1+.5+It;Lt.save(),dr.setLineDash(Lt,At,"h",or,Cr,Ar,Rr),Lt.strokeStyle=Ve,Lt.stroke(),Lt.closePath(),Lt.restore()},rr=Fp(p,g,v,y);for(var nr in rr){var Ut=nr.substr(0,nr.indexOf("_")),ar=nr.substr(nr.indexOf("_")+1);if(A[Ut+"_"+ar]){var Jt=A[Ut+"_"+ar].start_r,Qt=A[Ut+"_"+ar].start_c,_t=A[Ut+"_"+ar].end_r,er=A[Ut+"_"+ar].end_c,Kt=Qh(ae,Ut,ar,v,y),mr=rr[nr].l;mr==null||Kt.colIn&&Kt.stc!=ar||jt(mr.style,mr.color,Jt,Qt,_t,0,l,o,w);var fr=rr[nr].r;fr==null||Kt.colIn&&!Kt.colLast||lr(fr.style,fr.color,Jt,0,_t,er,l,o,w);var Wt=rr[nr].t;Wt!=null&&xr(Wt.style,Wt.color,Jt,Qt,0,er,l,o,w);var ze=rr[nr].b;ze!=null&&tr(ze.style,ze.color,0,Qt,_t,er,l,o,w)}}}y==u.visibledatacolumn.length-1&&w.clearRect(k-e+l-1,o-1,u.ch_width-u.visibledatacolumn[y],b-n),w.restore(),u.measureTextCacheTimeOut=setTimeout(function(){u.measureTextCache={},u.measureTextCellInfoCache={},u.cellOverflowMapCache={}},100)}}var Kp=function(e,n,t,a,l,o){if(u.flowdata[e]!=null&&u.flowdata[e][n]!=null){var d=u.flowdata[e][n].spl;if(d!=null){if(typeof d=="string"&&(d=new Function("return "+d)()),D(d)=="object"){var s=d,h=s.offsetX,f=s.offsetY;h=h??0,f=f??0,Hn.render(s.shapeseq,s.shapes,t+h,a+f,s.pixelWidth,s.pixelHeight,l,o)}else if(D(d)=="array"&&D(d[0])=="object")for(var p=0;p<d.length;p++){var g=d[p],v=g.offsetX,y=g.offsetY;v=v??0,y=y??0,Hn.render(g.shapeseq,g.shapes,t+v,a+y,g.pixelWidth,g.pixelHeight,l,o)}}}},Jh=function(e,n,t,a,l,o,d,s,h,f,p,g,v,y,b,k,w,_,C){var A=Un.checksAF(e,n,s),I=kr.checksCF(e,n,h),S=dr.borderfix(u.flowdata,e,n),E=dr.checkstatus(u.flowdata,e,n,"bg");A!=null&&A[1]!=null&&(E=A[1]),I!=null&&I.cellColor!=null&&(E=I.cellColor),u.flowdata[e][n]!=null&&u.flowdata[e][n].tc!=null&&(E=u.flowdata[e][n].tc),d.fillStyle=E??"#FFFFFF";var R=[a+f+S[0],t+p+S[1],o-a+S[2]-(C?1:0),l-t+S[3]];if(Ya.createHookFunction("cellRenderBefore",u.flowdata[e][n],{r:e,c:n,start_r:R[1],start_c:R[0],end_r:R[3]+R[1],end_c:R[2]+R[0]},ir.getSheetByIndex(),d)){if(d.fillRect(R[0],R[1],R[2],R[3]),e+"_"+n in g){var F=g[e+"_"+n].v;d.fillStyle="#000000";var N=lc();d.font=N;var z=a+4+f,P=(Ko.luckysheetrefreshfixed(),l+p-2);d.textBaseline="bottom",d.fillText(F??"",z,P)}if(u.flowdata[e][n]!=null&&u.flowdata[e][n].ps!=null){var q=8*u.zoomRatio,V=8*u.zoomRatio;d.beginPath(),d.moveTo(o+f-1-q,t+p),d.lineTo(o+f-1,t+p),d.lineTo(o+f-1,t+p+V),d.fillStyle="#FC6666",d.fill(),d.closePath()}var x=Qh(v,e,n,y,b);x.colLast&&Qp(x.rowIndex,x.colIndex,x.stc,x.edc,d,k,w,f,p,s,h),x.colIn&&!x.colLast||u.luckysheetcurrentisPivotTable||E||!u.showGridLines||(d.beginPath(),d.moveTo(o+f-2+_,t+p),d.lineTo(o+f-2+_,l+p),d.lineWidth=1,d.strokeStyle=Fi,d.stroke(),d.closePath()),u.luckysheetcurrentisPivotTable||E||!u.showGridLines||(d.beginPath(),d.moveTo(a+f-1,l+p-2+_),d.lineTo(o+f-1,l+p-2+_),d.lineWidth=1,d.strokeStyle=Fi,d.stroke(),d.closePath()),Ya.createHookFunction("cellRenderAfter",u.flowdata[e][n],{r:e,c:n,start_r:R[1],start_c:R[0],end_r:R[3]+R[1],end_c:R[2]+R[0]},ir.getSheetByIndex(),d)}},Jp=function(e,n,t,a,l,o,d,s,h,f,p,g,v,y,b,k,w,_,C,A){var I=u.flowdata[e][n],S=o-a-2,E=l-t-2,R=dr.checkstatus(u.flowdata,e,n,"ht"),F=dr.checkstatus(u.flowdata,e,n,"vt"),N=Un.checksAF(e,n,h),z=kr.checksCF(e,n,f),P=dr.checkstatus(u.flowdata,e,n,"bg");N!=null&&N[1]!=null&&(P=N[1]),z!=null&&z.cellColor!=null&&(P=z.cellColor),s.fillStyle=P??"#FFFFFF";var q=dr.borderfix(u.flowdata,e,n),V=[a+p+q[0],t+g+q[1],o-a+q[2]-(A?1:0),l-t+q[3]];if(Ya.createHookFunction("cellRenderBefore",u.flowdata[e][n],{r:e,c:n,start_r:V[1],start_c:V[0],end_r:V[3]+V[1],end_c:V[2]+V[0]},ir.getSheetByIndex(),s)){s.fillRect(V[0],V[1],V[2],V[3]);var x=aa.dataVerification;if(x!=null&&x[e+"_"+n]!=null&&!aa.validateCellData(d,x[e+"_"+n])){var ee=5*u.zoomRatio,ne=5*u.zoomRatio;s.beginPath(),s.moveTo(a+p,t+g),s.lineTo(a+p+ee,t+g),s.lineTo(a+p,t+g+ne),s.fillStyle="#FC6666",s.fill(),s.closePath()}if(I.ps!=null){var ae=8*u.zoomRatio,de=8*u.zoomRatio;s.beginPath(),s.moveTo(o+p-ae,t+g),s.lineTo(o+p,t+g),s.lineTo(o+p,t+g+de),s.fillStyle="#FC6666",s.fill(),s.closePath()}if(I.qp==1&&M(I.v)){var ve=6*u.zoomRatio,U=6*u.zoomRatio;s.beginPath(),s.moveTo(a+p+ve-1,t+g),s.lineTo(a+p-1,t+g),s.lineTo(a+p-1,t+g+U),s.fillStyle="#487f1e",s.fill(),s.closePath()}var B=!0,le=Qh(y,e,n,b,k);if(I.tb=="1"&&le.colIn)le.colLast?Qp(le.rowIndex,le.colIndex,le.stc,le.edc,s,w,_,p,g,h,f):B=!1;else if(x!=null&&x[e+"_"+n]!=null&&x[e+"_"+n].type=="checkbox"){var Te=a+p,ue=t+g+1;s.save(),s.beginPath(),s.rect(Te,ue,S,E),s.clip(),s.scale(u.zoomRatio,u.zoomRatio);var be=eo(d,s),ye=be.width+14,ce=be.actualBoundingBoxDescent+be.actualBoundingBoxAscent,Re=Te+2;R=="0"?Re=Te+S/2-ye/2:R=="2"&&(Re=Te+S-2-ye);var pe=E>ce?E:ce,me=ue+pe-2;s.textBaseline="bottom";var re=me-13*u.zoomRatio;F=="0"?(me=ue+pe/2,s.textBaseline="middle",re=me-6*u.zoomRatio):F=="1"&&(me=ue+2,s.textBaseline="top",re=me+1*u.zoomRatio),Re/=u.zoomRatio,me/=u.zoomRatio,re/=u.zoomRatio,s.lineWidth=1,s.strokeStyle="#000",s.strokeRect(Re,re,10,10),x[e+"_"+n].checked&&(s.beginPath(),s.lineTo(Re+1,re+6),s.lineTo(Re+4,re+9),s.lineTo(Re+9,re+2),s.stroke(),s.closePath()),s.fillStyle=dr.checkstatus(u.flowdata,e,n,"fc"),s.fillText(d??"",Re+14,me),s.restore()}else{if(z!=null&&z.dataBar!=null){var _e=a+p+2,Ze=t+g+2,We=S-4,Xe=E-4,Ue=z.dataBar.valueType,mt=z.dataBar.valueLen,St=z.dataBar.format;if(Ue=="minus"){var at=z.dataBar.minusLen;if(St.length>1){var dt=s.createLinearGradient(_e+We*at*(1-mt),Ze,_e+We*at,Ze);dt.addColorStop(0,"#ffffff"),dt.addColorStop(1,"#ff0000"),s.fillStyle=dt}else s.fillStyle="#ff0000";s.fillRect(_e+We*at*(1-mt),Ze,We*at*mt,Xe),s.beginPath(),s.moveTo(_e+We*at*(1-mt),Ze),s.lineTo(_e+We*at*(1-mt),Ze+Xe),s.lineTo(_e+We*at,Ze+Xe),s.lineTo(_e+We*at,Ze),s.lineTo(_e+We*at*(1-mt),Ze),s.lineWidth=1,s.strokeStyle="#ff0000",s.stroke(),s.closePath()}else if(Ue=="plus"){var wt=z.dataBar.plusLen;if(wt==1){if(St.length>1){var ct=s.createLinearGradient(_e,Ze,_e+We*mt,Ze);ct.addColorStop(0,St[0]),ct.addColorStop(1,St[1]),s.fillStyle=ct}else s.fillStyle=St[0];s.fillRect(_e,Ze,We*mt,Xe),s.beginPath(),s.moveTo(_e,Ze),s.lineTo(_e,Ze+Xe),s.lineTo(_e+We*mt,Ze+Xe),s.lineTo(_e+We*mt,Ze),s.lineTo(_e,Ze),s.lineWidth=1,s.strokeStyle=St[0],s.stroke(),s.closePath()}else{var bt=z.dataBar.minusLen;if(St.length>1){var De=s.createLinearGradient(_e+We*bt,Ze,_e+We*bt+We*wt*mt,Ze);De.addColorStop(0,St[0]),De.addColorStop(1,St[1]),s.fillStyle=De}else s.fillStyle=St[0];s.fillRect(_e+We*bt,Ze,We*wt*mt,Xe),s.beginPath(),s.moveTo(_e+We*bt,Ze),s.lineTo(_e+We*bt,Ze+Xe),s.lineTo(_e+We*bt+We*wt*mt,Ze+Xe),s.lineTo(_e+We*bt+We*wt*mt,Ze),s.lineTo(_e+We*bt,Ze),s.lineWidth=1,s.strokeStyle=St[0],s.stroke(),s.closePath()}}}var He=a+p,Dt=t+g+1;s.save(),s.beginPath(),s.rect(He,Dt,S,E),s.clip(),s.scale(u.zoomRatio,u.zoomRatio);var et=qs(I,s,{cellWidth:S,cellHeight:E,space_width:2,space_height:2,r:e,c:n});if(z!=null&&z.icons!=null&&et.type=="plain"){var ur=z.icons.left,Xt=z.icons.top,jt=et.values[0],lr=(jt.left,Dt+jt.top-et.textHeightAll);F=="0"?lr=Dt+E/2-et.textHeightAll/2:F=="1"?lr=Dt:F=="2"&&(lr-=et.desc),lr/=u.zoomRatio,u.zoomRatio,s.drawImage(td,42*ur,32*Xt,32,32,He/u.zoomRatio,lr,et.textHeightAll/u.zoomRatio,et.textHeightAll/u.zoomRatio),R!="0"&&R!="2"&&et.textHeightAll/u.zoomRatio}s.fillStyle=dr.checkstatus(u.flowdata,e,n,"fc"),N!=null&&N[0]!=null&&(s.fillStyle=N[0]),z!=null&&z.textColor!=null&&(s.fillStyle=z.textColor),I.ct&&I.ct.fa&&I.ct.fa.indexOf("[Red]")>-1&&I.ct.t=="n"&&I.v<0&&(s.fillStyle="#ff0000"),eg(et,s,{pos_x:He,pos_y:Dt}),s.restore()}B&&(u.luckysheetcurrentisPivotTable||P||!u.showGridLines||(s.beginPath(),s.moveTo(o+p-2+C,t+g),s.lineTo(o+p-2+C,l+g),s.lineWidth=1,s.strokeStyle=Fi,s.stroke(),s.closePath())),u.luckysheetcurrentisPivotTable||P||!u.showGridLines||(s.beginPath(),s.moveTo(a+p-1,l+g-2+C),s.lineTo(o+p-1,l+g-2+C),s.lineWidth=1,s.strokeStyle=Fi,s.stroke(),s.closePath()),Ya.createHookFunction("cellRenderAfter",u.flowdata[e][n],{r:e,c:n,start_r:V[1],start_c:V[0],end_r:V[3]+V[1],end_c:V[2]+V[0]},ir.getSheetByIndex(),s)}},Qp=function(e,n,t,a,l,o,d,s,h,f,p){var g;g=e==0?-o-1:u.visibledatarow[e-1]-o-1;var v,y=u.visibledatarow[e]-o;v=t==0?-d:u.visibledatacolumn[t-1]-d;var b=u.visibledatacolumn[a]-d,k=u.flowdata[e][n],w=b-v-2,_=y-g-2,C=v+s,A=g+h+1,I=bd(k);l.font=I,l.save(),l.beginPath(),l.rect(C,A,w,_),l.clip(),l.scale(u.zoomRatio,u.zoomRatio);var S=qs(k,l,{cellWidth:w,cellHeight:_,space_width:2,space_height:2,r:e,c:n}),E=Un.checksAF(e,n,f),R=kr.checksCF(e,n,p);l.fillStyle=dr.checkstatus(u.flowdata,e,n,"fc"),E!=null&&E[0]!=null&&(l.fillStyle=E[0]),R!=null&&R.textColor!=null&&(l.fillStyle=R.textColor),eg(S,l,{pos_x:C,pos_y:A}),l.restore()};function xu(e,n,t,a,l,o){var d=u.flowdata;if(a=="forward"&&t<0)return{success:!1,r:e,c:t};if(a=="backward"&&t>d[e].length-1)return{success:!1,r:e,c:t};var s=d[e][t];if(s!=null&&(!$t(s.v)||s.mc!=null))return{success:!1,r:e,c:t};var h=n-1<0?0:u.visibledatacolumn[n-1],f=u.visibledatacolumn[n],p=o-(f-h);l=="0"?(h-=p/2,f+=p/2):l=="1"?f+=p:l=="2"&&(h-=p);var g=t-1<0?0:u.visibledatacolumn[t-1],v=u.visibledatacolumn[t];return a=="forward"?h<g?xu(e,n,t-1,a,l,o):h<v?{success:!0,r:e,c:t}:{success:!1,r:e,c:t}:a=="backward"?f>v?xu(e,n,t+1,a,l,o):f>g?{success:!0,r:e,c:t}:{success:!1,r:e,c:t}:void 0}function Qh(e,n,t,a,l){var o,d,s,h,f=!1,p=!1;for(var g in e){for(var v in e[g]){o=g,d=v;var y=e[g][v];if(s=y.stc,h=y.edc,o==n&&t>=s&&t<=h&&(f=!0,t==h||t==l)){p=!0;break}}if(p)break}return{colIn:f,colLast:p,rowIndex:o,colIndex:d,stc:s,edc:h}}function eg(e,n,t){if(e!=null){var a=e.values,l=t.pos_x,o=t.pos_y;if(a!=null){e.rotate!=0&&e.type!="verticalWrap"&&(n.save(),n.translate((l+e.textLeftAll)/u.zoomRatio,(o+e.textTopAll)/u.zoomRatio),n.rotate(-e.rotate*Math.PI/180),n.translate(-(e.textLeftAll+l)/u.zoomRatio,-(o+e.textTopAll)/u.zoomRatio));for(var d=0;d<a.length;d++){var s=a[d];s.inline===!0&&s.style!=null?(n.font=s.style.fontset,n.fillStyle=s.style.fc):n.font=s.style;var h=ul(s.content)==="object"?s.content.m:s.content;if(n.fillText(h,(l+s.left)/u.zoomRatio,(o+s.top)/u.zoomRatio),s.cancelLine!=null){var f=s.cancelLine;n.beginPath(),n.moveTo(Math.floor((l+f.startX)/u.zoomRatio)+.5,Math.floor((o+f.startY)/u.zoomRatio)+.5),n.lineTo(Math.floor((l+f.endX)/u.zoomRatio)+.5,Math.floor((o+f.endY)/u.zoomRatio)+.5),n.lineWidth=Math.floor(f.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}if(s.underLine!=null)for(var p=s.underLine,g=0;g<p.length;g++){var v=p[g];n.beginPath(),n.moveTo(Math.floor((l+v.startX)/u.zoomRatio)+.5,Math.floor((o+v.startY)/u.zoomRatio)),n.lineTo(Math.floor((l+v.endX)/u.zoomRatio)+.5,Math.floor((o+v.endY)/u.zoomRatio)+.5),n.lineWidth=Math.floor(v.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}}e.rotate!=0&&e.type!="verticalWrap"&&n.restore()}}}var Jl={item:{linkType:"external",linkAddress:"",linkTooltip:""},hyperlink:null,createDialog:function(){var e=st(),n=e.insertLink,t=e.toolbar,a=e.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-insertLink-dialog").remove();var l="";u.luckysheetfile.forEach(function(y){l+='<option value="'.concat(y.name,'">').concat(y.name,"</option>")});var o=`<div class="box">
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkText">`.concat(n.linkText,`</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkText"/>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkType">`).concat(n.linkType,`</label>
                                <select id="luckysheet-insertLink-dialog-linkType">
                                    <option value="external">`).concat(n.external,`</option>
                                    <option value="internal">`).concat(n.internal,`</option>
                                </select>
                            </div>
                            <div class="show-box show-box-external">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkAddress">`).concat(n.linkAddress,`</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkAddress" placeholder="`).concat(n.placeholder1,`" />
                                </div>
                            </div>
                            <div class="show-box show-box-internal">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkSheet">`).concat(n.linkSheet,`</label>
                                    <select id="luckysheet-insertLink-dialog-linkSheet">
                                        `).concat(l,`
                                    </select>
                                </div>
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkCell">`).concat(n.linkCell,`</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkCell" value="A1" placeholder="`).concat(n.placeholder2,`" />
                                </div>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkTooltip">`).concat(n.linkTooltip,`</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkTooltip" placeholder="`).concat(n.placeholder3,`" />
                            </div>
                        </div>`);$("body").append(br(Ga,{id:"luckysheet-insertLink-dialog",addclass:"luckysheet-insertLink-dialog",title:t.insertLink,content:o,botton:'<button id="luckysheet-insertLink-dialog-confirm" class="btn btn-primary">'.concat(a.confirm,`</button>
                        <button class="btn btn-default luckysheet-model-close-btn">`).concat(a.cancel,"</button>"),style:"z-index:100003"}));var d=$("#luckysheet-insertLink-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),s=d.outerHeight(),h=d.outerWidth(),f=$(window).width(),p=$(window).height(),g=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-insertLink-dialog").css({left:(f+g-h)/2,top:(p+v-s)/3}).show(),this.dataAllocation()},init:function(){var e=this,n=st().insertLink;$(document).off("change.linkType").on("change.linkType","#luckysheet-insertLink-dialog-linkType",function(t){var a=this.value;$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+a).show()}),$(document).off("click.confirm").on("click.confirm","#luckysheet-insertLink-dialog-confirm",function(t){var a=u.luckysheet_select_save[u.luckysheet_select_save.length-1],l=a.row_focus||a.row[0],o=a.column_focus||a.column[0],d=$("#luckysheet-insertLink-dialog-linkText").val(),s=$("#luckysheet-insertLink-dialog-linkType").val(),h=$("#luckysheet-insertLink-dialog-linkAddress").val(),f=$("#luckysheet-insertLink-dialog-linkSheet").val(),p=$("#luckysheet-insertLink-dialog-linkCell").val(),g=$("#luckysheet-insertLink-dialog-linkTooltip").val();if(s=="external"){if(/^http[s]?:\/\//.test(h)||(h="https://"+h),!/^http[s]?:\/\/([\w\-\.]+)+[\w-]*([\w\-\.\/\?%&=]+)?$/gi.test(h))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo1)}else{if(!m.iscelldata(p))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo2);h=f+"!"+p}d!=null&&d.replace(/\s/g,"")!=""||(d=h);var v={linkType:s,linkAddress:h,linkTooltip:g},y=$.extend(!0,{},e.hyperlink),b=$.extend(!0,{},e.hyperlink);b[l+"_"+o]=v;var k=vr.deepCopyFlowData(u.flowdata),w=k[l][o];w==null&&(w={}),w.fc="rgb(0, 0, 255)",w.un=1,w.v=d,k[l][o]=w,e.ref(y,b,u.currentSheetIndex,k,{row:[l,l],column:[o,o]}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-insertLink-dialog").hide()})},dataAllocation:function(){var e=u.luckysheet_select_save[u.luckysheet_select_save.length-1],n=e.row_focus||e.row[0],t=e.column_focus||e.column[0],a=(this.hyperlink||{})[n+"_"+t]||{},l=Hr(n,t,null,"m");$("#luckysheet-insertLink-dialog-linkText").val(l);var o=a.linkType||"external";$("#luckysheet-insertLink-dialog-linkType").val(o),$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+o).show();var d=a.linkAddress||"";if(o=="external")$("#luckysheet-insertLink-dialog-linkAddress").val(d);else if(m.iscelldata(d)){var s=d.split("!")[0],h=d.split("!")[1];$("#luckysheet-insertLink-dialog-linkSheet").val(s),$("#luckysheet-insertLink-dialog-linkCell").val(h)}var f=a.linkTooltip||"";$("#luckysheet-insertLink-dialog-linkTooltip").val(f)},cellFocus:function(e,n){if(this.hyperlink!=null&&this.hyperlink[e+"_"+n]!=null){var t=this.hyperlink[e+"_"+n];if(t.linkType=="external")window.open(t.linkAddress);else{var a=m.getcellrange(t.linkAddress),l=a.sheetIndex,o=[{row:a.row,column:a.column}];l!=u.currentSheetIndex&&($("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+l).addClass("luckysheet-sheets-item-active"),ir.changeSheet(l)),u.luckysheet_select_save=o,Ra();var d=a.row[0]-1==-1?0:u.visibledatarow[a.row[0]-1],s=a.column[0]-1==-1?0:u.visibledatacolumn[a.column[0]-1];$("#luckysheet-scrollbar-x").scrollLeft(s),$("#luckysheet-scrollbar-y").scrollTop(d)}}},overshow:function(e){if($("#luckysheet-hyperlink-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length!=0){var n=pa(e.pageX,e.pageY),t=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),l=n[0]+t,o=n[1]+a;if(!(Ne.freezenverticaldata!=null&&n[0]<Ne.freezenverticaldata[0]-Ne.freezenverticaldata[2]||Ne.freezenhorizontaldata!=null&&n[1]<Ne.freezenhorizontaldata[0]-Ne.freezenhorizontaldata[2])){var d=Wa(o)[2],s=ja(l)[2],h=dr.mergeborer(u.flowdata,d,s);if(h&&(d=h.row[2],s=h.column[2]),this.hyperlink!=null&&this.hyperlink[d+"_"+s]!=null){var f=this.hyperlink[d+"_"+s],p=f.linkTooltip;p!=null&&p.replace(/\s/g,"")!=""||(p=f.linkAddress);var g=u.visibledatarow[d],v=(d-1==-1||u.visibledatarow[d-1],u.visibledatacolumn[s],s-1==-1?0:u.visibledatacolumn[s-1]);h&&(g=h.row[1],h.row[0],h.column[1],v=h.column[0]);var y='<div id="luckysheet-hyperlink-overshow" style="background:#fff;padding:5px 10px;border:1px solid #000;box-shadow:2px 2px #999;position:absolute;left:'.concat(v,"px;top:").concat(g+5,`px;z-index:100;">
                        <div>`).concat(p,`</div>
                        <div></div>
                    </div>`);$(y).appendTo($("#luckysheet-cell-main"))}}}},ref:function(e,n,t,a,l){if(u.clearjfundo){u.jfundo.length=0;var o={type:"updateHyperlink"};o.sheetIndex=t,o.historyHyperlink=e,o.currentHyperlink=n,o.data=u.flowdata,o.curData=a,o.range=l,u.jfredo.push(o)}this.hyperlink=n,u.luckysheetfile[je(t)].hyperlink=n,u.flowdata=a,vr.webWorkerFlowDataCache(u.flowdata),u.luckysheetfile[je(t)].data=u.flowdata,nt.allowUpdate&&(nt.saveParam("all",t,n,{k:"hyperlink"}),nt.historyParam(u.flowdata,t,l)),setTimeout(function(){Kr()},1)}},vi=null;function em(e,n,t){m.execFunctionExist=[];for(var a=0;a<e.length;a++)for(var l=e[a].row[0];l<=e[a].row[1];l++)for(var o=e[a].column[0];o<=e[a].column[1];o++)m.execFunctionExist.push({r:l,c:o,i:n});m.execFunctionExist.reverse(),m.execFunctionGroup(null,null,null,null,t),m.execFunctionGlobalData=null}function wa(e,n,t){var a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],l=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];e==null&&(e=u.flowdata),n==null&&(n=u.luckysheet_select_save),clearTimeout(vi),t==null&&(t={});var o,d,s,h,f=t.cfg,p=t.RowlChange,g=t.cdformat,v=t.dataVerification,y=t.dynamicArray,b=u.luckysheetfile[je(u.currentSheetIndex)];u.clearjfundo&&(u.jfundo.length=0,o=f==null?$.extend(!0,{},u.config):$.extend(!0,{},f),d=g??$.extend(!0,[],b.luckysheet_conditionformat_save),s=v??$.extend(!0,{},b.dataVerification),h=y??$.extend(!0,[],b.dynamicArray),u.jfredo.push({type:"datachange",data:u.flowdata,curdata:e,sheetIndex:u.currentSheetIndex,range:n,config:$.extend(!0,{},u.config),curConfig:o,cdformat:$.extend(!0,[],b.luckysheet_conditionformat_save),curCdformat:d,RowlChange:p,dataVerification:$.extend(!0,[],b.dataVerification),curDataVerification:s,dynamicArray:$.extend(!0,[],b.dynamicArray),curDynamicArray:h,dataRange:Ei(b.luckysheet_select_save)})),u.flowdata=e,vr.webWorkerFlowDataCache(u.flowdata),b.data=u.flowdata,f!=null&&(u.config=f,b.config=u.config,nt.saveParam("all",u.currentSheetIndex,f,{k:"config"}),p!=null&&ln(u.flowdata.length,u.flowdata[0].length)),g!=null&&(b.luckysheet_conditionformat_save=g,nt.saveParam("all",u.currentSheetIndex,g,{k:"luckysheet_conditionformat_save"})),v!=null&&(aa.dataVerification=v,b.dataVerification=v,nt.saveParam("all",u.currentSheetIndex,v,{k:"dataVerification"})),y!=null&&(b.dynamicArray=y,nt.saveParam("all",u.currentSheetIndex,y,{k:"dynamicArray"}));for(var k=0;k<n.length;k++){var w=n[k].row[0],_=n[k].column[0];if(u.flowdata[w][_]!=null&&u.flowdata[w][_].spl!=null){window.luckysheetCurrentRow=w,window.luckysheetCurrentColumn=_,window.luckysheetCurrentFunction=u.flowdata[w][_].f;var C=$.trim(m.functionParserExe(u.flowdata[w][_].f)),A=new Function("return "+C)();u.flowdata[w][_].spl=A}nt.allowUpdate&&nt.historyParam(u.flowdata,u.currentSheetIndex,n[k]),typeof u.chartparam.jfrefreshchartall=="function"&&u.chartparam.jfrefreshchartall(u.flowdata,n[k].row[0],n[k].row[1],n[k].column[0],n[k].column[1])}a&&em(n,u.currentSheetIndex,e),l&&(vi=setTimeout(function(){Kr()},1)),window.luckysheet_getcelldata_cache=null}function Ni(e,n,t,a,l,o,d,s){var h=!(arguments.length>8&&arguments[8]!==void 0)||arguments[8],f={},p=!1;if(clearTimeout(vi),o=="cellRowChange"){f.type="cellRowChange",f.config=$.extend(!0,{},u.config),f.curconfig=$.extend(!0,{},a),f.range=$.extend(!0,[],u.luckysheet_select_save),f.currange=l,f.ctrlType=o,f.ctrlValue=d;var g=a.rowlen;g==null&&(g={}),nt.saveParam("cg",u.currentSheetIndex,g,{k:"rowlen"})}else if(o=="resizeC"){f.type="resize",f.config=$.extend(!0,{},u.config),f.curconfig=$.extend(!0,{},a),f.range=$.extend(!0,[],u.luckysheet_select_save),f.currange=l,f.ctrlType=o,f.ctrlValue=d;var v=a.columnlen;v==null&&(v={}),nt.saveParam("cg",u.currentSheetIndex,v,{k:"columnlen"})}else if(o.indexOf("extend")>-1)f.type="extend",f.config=$.extend(!0,{},u.config),f.curconfig=$.extend(!0,{},a),f.range=$.extend(!0,[],u.luckysheet_select_save),f.currange=l,f.ctrlType=o,f.ctrlValue=d,nt.saveParam("arc",u.currentSheetIndex,{index:d.index,len:d.len,direction:d.direction,mc:a.merge},{rc:d.type});else if(o.indexOf("dele")>-1)f.type="dele",f.config=$.extend(!0,{},u.config),f.curconfig=$.extend(!0,{},a),f.range=$.extend(!0,[],u.luckysheet_select_save),f.currange=l,f.ctrlType=o,f.ctrlValue=d,nt.saveParam("drc",u.currentSheetIndex,{index:d.index,len:d.len,mc:a.merge,borderInfo:a.borderInfo},{rc:d.type});else{f.type="datachangeAll",f.range=$.extend(!0,[],u.luckysheet_select_save),f.currange=l,f.ctrlType=o,f.ctrlValue=d,p=!0;for(var y=0;y<l.length;y++)nt.historyParam(t,u.currentSheetIndex,l[y])}u.clearjfundo&&(u.jfundo.length=0,f.data=u.flowdata,f.curdata=t,f.sheetIndex=u.currentSheetIndex,f.cdformat=$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save),f.curCdformat=s,u.jfredo.push(f)),u.flowdata=t,vr.webWorkerFlowDataCache(t),u.luckysheetfile[je(u.currentSheetIndex)].data=u.flowdata,a!=null&&(u.config=a,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("all",u.currentSheetIndex,a,{k:"config"})),s!=null&&(u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save=s,nt.saveParam("all",u.currentSheetIndex,s,{k:"luckysheet_conditionformat_save"})),u.luckysheet_select_save=$.extend(!0,[],l),u.luckysheet_select_save.length>0&&Ra(),p&&em(l,u.currentSheetIndex,t),ln(n,e),h&&(vi=setTimeout(function(){Kr()},1)),ir.storeSheetParamALL(),window.luckysheet_getcelldata_cache=null}function md(e,n,t){clearTimeout(vi),u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"rangechange",data:u.flowdata,curdata:e,range:n,sheetIndex:u.currentSheetIndex,cdformat:$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save),curCdformat:t})),u.flowdata=e,vr.webWorkerFlowDataCache(u.flowdata),u.luckysheetfile[je(u.currentSheetIndex)].data=u.flowdata,t!=null&&(u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save=t),em(n,u.currentSheetIndex,e),vi=setTimeout(function(){Kr()},1);for(var a=0;a<n.length;a++)nt.historyParam(u.flowdata,u.currentSheetIndex,n[a])}function wu(e,n,t,a,l,o,d,s,h,f,p){var g=u.luckysheetfile[je(u.currentSheetIndex)];Sc();var v=[];for(var y in n.merge)for(var b=n.merge[y],k=b.r;k<=b.r+b.rs-1;k++)for(var w=b.c;w<=b.c+b.cs-1;w++)e[k][w]==null&&(e[k][w]={}),k==b.r&&w==b.c?e[k][w].mc=b:e[k][w].mc={r:b.r,c:b.c},v.push({r:k,c:w});var _=[];u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:t,sheetIndex:u.currentSheetIndex,data:u.flowdata,curData:e,config:$.extend(!0,{},u.config),curConfig:n,ctrlValue:a,mcData:v,calc:$.extend(!0,[],g.calcChain),curCalc:l,funcData:_,filterObj:{filter_select:$.extend(!0,{},g.filter_select),filter:$.extend(!0,{},g.filter)},curFilterObj:o,cf:$.extend(!0,[],g.luckysheet_conditionformat_save),curCf:d,af:$.extend(!0,[],g.luckysheet_alternateformat_save),curAf:s,freezen:{freezenhorizontaldata:Ne.freezenhorizontaldata,freezenverticaldata:Ne.freezenverticaldata},curFreezen:h,dataVerification:$.extend(!0,{},g.dataVerification),curDataVerification:f,hyperlink:$.extend(!0,{},g.hyperlink),curHyperlink:p,dataRange:Ei(g.luckysheet_select_save)}));var C=a.index,A=a.len,I=a.rc;if(t=="addRC"){var S=a.direction,E=[];if(a.restore){if(I=="r"){var R;S=="lefttop"?R=C:S=="rightbottom"&&(R=C+1);for(var F=R+A-1,N=R;N<=F;N++){for(var z=[],P=0;P<e[0].length;P++){var q=e[N][P];z.push(q)}E.push(z)}}else if(I=="c"){var V;S=="lefttop"?V=C:S=="rightbottom"&&(V=C+1);for(var x=V+A-1,ee=0;ee<e.length;ee++){for(var ne=[],ae=V;ae<=x;ae++){var de=e[ee][ae];ne.push(de)}E.push(ne)}}}nt.saveParam("arc",u.currentSheetIndex,{index:C,len:A,direction:S,data:E},{rc:I})}else t=="delRC"&&nt.saveParam("drc",u.currentSheetIndex,{index:C,len:A},{rc:I});u.flowdata=e,vr.webWorkerFlowDataCache(u.flowdata),g.data=e,u.config=n,g.config=u.config,nt.saveParam("all",u.currentSheetIndex,n,{k:"config"});for(var ve=0;ve<v.length;ve++){var U=v[ve].r,B=v[ve].c;nt.saveParam("v",u.currentSheetIndex,u.flowdata[U][B],{r:U,c:B})}if(l.length>0)for(var le=0;le<l.length;le++){var Te=l[le],ue=Te.r,be=Te.c,ye=Te.index,ce=pi(ue,be,ye,e),Re=m.execfunction(ce,ue,be,ye,null,!0);Te.func=Re,e[ue][be].f==ce&&Ln(ue,be,e,Re[1])}g.calcChain=l,nt.saveParam("all",u.currentSheetIndex,l,{k:"calcChain"});for(var pe=0;pe<_.length;pe++){var me=_[pe].r,re=_[pe].c;nt.saveParam("v",u.currentSheetIndex,u.flowdata[me][re],{r:me,c:re})}o!=null?(g.filter_select=o.filter_select,g.filter=o.filter):(g.filter_select=null,g.filter=null),gi(g.filter_select,g.filter),nt.saveParam("all",u.currentSheetIndex,g.filter_select,{k:"filter_select"}),nt.saveParam("all",u.currentSheetIndex,g.filter,{k:"filter"}),g.luckysheet_conditionformat_save=d,nt.saveParam("all",u.currentSheetIndex,g.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),g.luckysheet_alternateformat_save=s,nt.saveParam("all",u.currentSheetIndex,g.luckysheet_alternateformat_save,{k:"luckysheet_alternateformat_save"}),h!=null?(Ne.freezenhorizontaldata=h.freezenhorizontaldata,Ne.freezenverticaldata=h.freezenverticaldata):(Ne.freezenhorizontaldata=null,Ne.freezenverticaldata=null),aa.dataVerification=f,g.dataVerification=f,nt.saveParam("all",u.currentSheetIndex,g.dataVerification,{k:"dataVerification"}),Jl.hyperlink=p,g.hyperlink=p,nt.saveParam("all",u.currentSheetIndex,g.hyperlink,{k:"hyperlink"}),ln(u.flowdata.length,u.flowdata[0].length)}function tm(e,n,t,a,l,o,d,s){var h=u.luckysheetfile[je(u.currentSheetIndex)];clearTimeout(vi),Sc();var f=[];if(JSON.stringify(n.merge)=="{}")for(var p=0;p<e.length;p++)for(var g=0;g<e[0].length;g++){var v=e[p][g];v!=null&&v.mc!=null&&(delete v.mc,f.push({r:p,c:g}))}else for(var y in n.merge)for(var b=n.merge[y],k=b.r;k<=b.r+b.rs-1;k++)for(var w=b.c;w<=b.c+b.cs-1;w++)e[k][w]==null&&(e[k][w]={}),k==b.r&&w==b.c?e[k][w].mc=b:e[k][w].mc={r:b.r,c:b.c},f.push({r:k,c:w});var _=[];if(u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"deleteCell",sheetIndex:u.currentSheetIndex,ctrl:t,data:u.flowdata,curData:e,config:$.extend(!0,{},u.config),curConfig:n,mcData:f,calc:$.extend(!0,[],h.calcChain),curCalc:a,funcData:_,filterObj:{filter_select:$.extend(!0,{},h.filter_select),filter:$.extend(!0,{},h.filter)},curFilterObj:l,cf:$.extend(!0,[],h.luckysheet_conditionformat_save),curCf:o,dataVerification:$.extend(!0,{},h.dataVerification),curDataVerification:d,hyperlink:$.extend(!0,{},h.hyperlink),curHyperlink:s,dataRange:Ei(h.luckysheet_select_save)})),u.flowdata=e,vr.webWorkerFlowDataCache(u.flowdata),h.data=e,nt.allowUpdate){var C,A=t.type,I=t.str,S=t.edr,E=t.stc,R=t.edc;A=="moveUp"?C={row:[I,e.length-1],column:[E,R]}:A=="moveLeft"&&(C={row:[I,S],column:[E,e[0].length-1]}),nt.historyParam(u.flowdata,u.currentSheetIndex,C)}u.config=n,h.config=u.config,nt.saveParam("all",u.currentSheetIndex,n,{k:"config"});for(var F=0;F<f.length;F++){var N=f[F].r,z=f[F].c;nt.saveParam("v",u.currentSheetIndex,u.flowdata[N][z],{r:N,c:z})}if(a.length>0)for(var P=0;P<a.length;P++){var q=a[P],V=q.r,x=q.c,ee=q.index,ne=pi(V,x,ee,e),ae=m.execfunction(ne,V,x,ee,null,!0);q.func=ae,e[V][x].f==ne&&Ln(V,x,e,ae[1])}h.calcChain=a,nt.saveParam("all",u.currentSheetIndex,a,{k:"calcChain"});for(var de=0;de<_.length;de++){var ve=_[de].r,U=_[de].c;nt.saveParam("v",u.currentSheetIndex,u.flowdata[ve][U],{r:ve,c:U})}l!=null?(h.filter_select=l.filter_select,h.filter=l.filter):(h.filter_select=null,h.filter=null),gi(h.filter_select,h.filter),nt.saveParam("all",u.currentSheetIndex,h.filter_select,{k:"filter_select"}),nt.saveParam("all",u.currentSheetIndex,h.filter,{k:"filter"}),h.luckysheet_conditionformat_save=o,nt.saveParam("all",u.currentSheetIndex,h.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),aa.dataVerification=d,h.dataVerification=d,nt.saveParam("all",u.currentSheetIndex,h.dataVerification,{k:"dataVerification"}),Jl.hyperlink=s,h.hyperlink=s,nt.saveParam("all",u.currentSheetIndex,h.hyperlink,{k:"hyperlink"}),vi=setTimeout(function(){Kr()},1)}function rm(e,n,t){var a,l={};m.execFunctionExist=[],clearTimeout(vi);for(var o=e.range.row[0];o<=e.range.row[1];o++)for(var d=e.range.column[0];d<=e.range.column[1];d++)o+"_"+d+"_"+e.sheetIndex in l||(l[o+"_"+d+"_"+e.sheetIndex]=0,m.execFunctionExist.push({r:o,c:d,i:e.sheetIndex}));for(var s=n.range.row[0];s<=n.range.row[1];s++)for(var h=n.range.column[0];h<=n.range.column[1];h++)s+"_"+h+"_"+n.sheetIndex in l||(l[s+"_"+h+"_"+n.sheetIndex]=0,m.execFunctionExist.push({r:s,c:h,i:n.sheetIndex}));if(u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"pasteCut",source:e,target:n,RowlChange:t})),u.currentSheetIndex==e.sheetIndex?(u.config=e.curConfig,a=e.curData.length,u.luckysheetfile[je(n.sheetIndex)].config=n.curConfig):u.currentSheetIndex==n.sheetIndex&&(u.config=n.curConfig,a=n.curData.length,u.luckysheetfile[je(e.sheetIndex)].config=e.curConfig),t){u.visibledatarow=[],u.rh_height=0;for(var f=0;f<a;f++){var p=u.defaultrowlen;u.config.rowlen!=null&&u.config.rowlen[f]!=null&&(p=u.config.rowlen[f]),u.config.rowhidden==null||u.config.rowhidden[f]==null?(u.rh_height+=p+1,u.visibledatarow.push(u.rh_height)):(p=u.config.rowhidden[f],u.visibledatarow.push(u.rh_height))}if(u.rh_height+=110,u.currentSheetIndex==e.sheetIndex){var g=wp(n.curData.length,n.curConfig);u.luckysheetfile[je(n.sheetIndex)].visibledatarow=g}else if(u.currentSheetIndex==n.sheetIndex){var v=wp(e.curData.length,e.curConfig);u.luckysheetfile[je(e.sheetIndex)].visibledatarow=v}}u.currentSheetIndex==e.sheetIndex?(u.flowdata=e.curData,u.luckysheetfile[je(n.sheetIndex)].data=n.curData):u.currentSheetIndex==n.sheetIndex&&(u.flowdata=n.curData,u.luckysheetfile[je(e.sheetIndex)].data=e.curData),vr.webWorkerFlowDataCache(u.flowdata),u.luckysheetfile[je(u.currentSheetIndex)].data=u.flowdata,u.currentSheetIndex==n.sheetIndex?u.luckysheet_select_save=[{row:n.range.row,column:n.range.column}]:u.luckysheet_select_save=[{row:e.range.row,column:e.range.column}],u.luckysheet_select_save.length>0&&Ra(),u.luckysheetfile[je(e.sheetIndex)].luckysheet_conditionformat_save=e.curCdformat,u.luckysheetfile[je(n.sheetIndex)].luckysheet_conditionformat_save=n.curCdformat,u.currentSheetIndex==e.sheetIndex?aa.dataVerification=e.curDataVerification:u.currentSheetIndex==n.sheetIndex&&(aa.dataVerification=n.curDataVerification),u.luckysheetfile[je(e.sheetIndex)].dataVerification=e.curDataVerification,u.luckysheetfile[je(n.sheetIndex)].dataVerification=n.curDataVerification,m.execFunctionExist.reverse(),m.execFunctionGroup(null,null,null,null,n.curData),m.execFunctionGlobalData=null,vi=setTimeout(function(){Kr()},1),ir.storeSheetParamALL(),nt.saveParam("all",e.sheetIndex,e.curConfig,{k:"config"}),nt.saveParam("all",n.sheetIndex,n.curConfig,{k:"config"}),nt.historyParam(e.curData,e.sheetIndex,{row:e.range.row,column:e.range.column}),nt.historyParam(n.curData,n.sheetIndex,{row:n.range.row,column:n.range.column}),nt.saveParam("all",e.sheetIndex,e.curCdformat,{k:"luckysheet_conditionformat_save"}),nt.saveParam("all",n.sheetIndex,n.curCdformat,{k:"luckysheet_conditionformat_save"}),nt.saveParam("all",e.sheetIndex,e.curDataVerification,{k:"dataVerification"}),nt.saveParam("all",n.sheetIndex,n.curDataVerification,{k:"dataVerification"})}function ln(e,n){var t=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];ld(e,n),clearTimeout(vi),ir.storeSheetParam();var a=u.luckysheetfile[je(u.currentSheetIndex)].calcChain;if(a!=null&&a.length>0){u.config.rowlen==null&&(u.config.rowlen={}),u.config.columnlen==null&&(u.config.columnlen={});for(var l=0;l<a.length;l++){var o=a[l].r,d=a[l].c,s=a[l].index;if(s==u.currentSheetIndex&&u.flowdata[o][d]!=null&&u.flowdata[o][d].spl!=null&&(o in u.config.rowlen||d in u.config.columnlen)){window.luckysheetCurrentRow=o,window.luckysheetCurrentColumn=d,window.luckysheetCurrentFunction=u.flowdata[o][d].f;var h=$.trim(m.functionParserExe(u.flowdata[o][d].f)),f=new Function("return "+h)();u.flowdata[o][d].spl=f,nt.saveParam("v",u.currentSheetIndex,u.flowdata[o][d],{r:o,c:d})}}u.luckysheetfile[je(u.currentSheetIndex)].data=u.flowdata}if(Lr.positionSync(),Ra(),Sc(),$(".luckysheet-selection-copy").is(":visible")&&pn(),$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove(),Ne.freezenhorizontaldata!=null&&Ne.freezenverticaldata!=null){var p=Ne.freezenhorizontaldata[1]-1,g=Ne.freezenverticaldata[1]-1,v=Ne.freezenhorizontaldata[2],y=Ne.freezenverticaldata[2],b=u.visibledatarow[p]-2-v+u.columnHeaderHeight,k=[u.visibledatarow[p],p+1,v,Ne.cutVolumn(u.visibledatarow,p+1),b],w=u.visibledatacolumn[g]-2-y+u.rowHeaderWidth,_=[u.visibledatacolumn[g],g+1,y,Ne.cutVolumn(u.visibledatacolumn,g+1),w];Ne.saveFreezen(k,b,_,w),Ne.createFreezenHorizontal(k,b),Ne.createFreezenVertical(_,w),Ne.createAssistCanvas()}else if(Ne.freezenhorizontaldata!=null){var C=Ne.freezenhorizontaldata[1]-1,A=Ne.freezenhorizontaldata[2],I=u.visibledatarow[C]-2-A+u.columnHeaderHeight,S=[u.visibledatarow[C],C+1,A,Ne.cutVolumn(u.visibledatarow,C+1),I];Ne.saveFreezen(S,I,null,null),Ne.createFreezenHorizontal(S,I),Ne.createAssistCanvas()}else if(Ne.freezenverticaldata!=null){var E=Ne.freezenverticaldata[1]-1,R=Ne.freezenverticaldata[2],F=u.visibledatacolumn[E]-2-R+u.rowHeaderWidth,N=[u.visibledatacolumn[E],E+1,R,Ne.cutVolumn(u.visibledatacolumn,E+1),F];Ne.saveFreezen(null,null,N,F),Ne.createFreezenVertical(N,F),Ne.createAssistCanvas()}else $("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").length>0&&$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").each(function(ve,U){var B=$(U).data("str"),le=$(U).data("cindex"),Te=u.visibledatacolumn[le]-20,ue=B-1==-1?0:u.visibledatarow[B-1];$(U).css({left:Te,top:ue})});if($("#luckysheet-filter-selected-sheet"+u.currentSheetIndex).length>0){var z=u.luckysheetfile[je(u.currentSheetIndex)].filter_select,P=z.row[0],q=z.row[1],V=z.column[0],x=z.column[1],ee=u.visibledatarow[q],ne=P-1==-1?0:u.visibledatarow[P-1],ae=u.visibledatacolumn[x],de=V-1==-1?0:u.visibledatacolumn[V-1];$("#luckysheet-filter-selected-sheet"+u.currentSheetIndex).css({left:de,width:ae-de-1,top:ne,height:ee-ne-1})}ir.showSheet(),t&&(vi=setTimeout(function(){Kr()},1))}function Kr(e,n){if(m.groupValuesRefresh(),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),Ne.freezenverticaldata!=null||Ne.freezenhorizontaldata!=null){var t,a,l,o,d=u.luckysheetTableContentHW[0],s=u.luckysheetTableContentHW[1];Ne.freezenverticaldata!=null&&Ne.freezenhorizontaldata!=null?(t=Ne.freezenhorizontaldata[0],Ne.freezenhorizontaldata[1],a=Ne.freezenhorizontaldata[2],l=Ne.freezenverticaldata[0],Ne.freezenverticaldata[1],Mi(o=Ne.freezenverticaldata[2],a,l,t,1,1,null,null,"freezen_3"),Mi(e+l-o,a,d-l+o,t,1,1,null,null,"freezen_4"),Mi(o,n+t-a,l,s-t+a,1,1,null,null,"freezen_7"),Mi(e+l-o,n+t-a,d-l+o,s-t+a,l-o+u.rowHeaderWidth,t-a+u.columnHeaderHeight),ku(o,l,u.rowHeaderWidth),ku(e+l-o,d-l+o,l-o+u.rowHeaderWidth),bu(a,t,u.columnHeaderHeight),bu(n+t-a,s-t+a,t-a+u.columnHeaderHeight)):Ne.freezenhorizontaldata!=null?(t=Ne.freezenhorizontaldata[0],Ne.freezenhorizontaldata[1],Mi(e,a=Ne.freezenhorizontaldata[2],d,t,1,1,null,null,"freezen_h"),Mi(e,n+t-a,d,s-t+a,null,t-a+u.columnHeaderHeight),ku(e,d,null),bu(a,t,u.columnHeaderHeight),bu(n+t-a,s-t+a,t-a+u.columnHeaderHeight)):Ne.freezenverticaldata!=null&&(l=Ne.freezenverticaldata[0],Ne.freezenverticaldata[1],Mi(o=Ne.freezenverticaldata[2],n,l,s,1,1,null,null,"freezen_v"),Mi(e+l-o,n,d-l+o,s,l-o+u.rowHeaderWidth,null),bu(n,s,null),ku(o,l,u.rowHeaderWidth),ku(e+l-o,d-l+o,l-o+u.rowHeaderWidth))}else{if($("#luckysheetTableContent").length==0)return;var h=$("#luckysheetTableContent").get(0).getContext("2d");Mi(e,n),ku(e),bu(n),h.clearRect(0,0,u.rowHeaderWidth*u.devicePixelRatio-1,u.columnHeaderHeight*u.devicePixelRatio-1)}}var nt={gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,loadSheetUrl:null,retryTimer:null,allowUpdate:!1,historyParam:function(e,n,t){var a=t.row[0],l=t.row[1],o=t.column[0],d=t.column[1];if(a==l&&o==d){var s=e[a][o];this.saveParam("v",n,s,{r:a,c:o})}else for(var h=l-a+1,f=d-o+1,p=Math.floor(1e3/f),g=Math.ceil(h/p),v=0;v<g;v++){var y=a+p*v,b=void 0;b=v==g-1?l:a+p*(v+1)-1;for(var k=[],w=y;w<=b;w++){for(var _=[],C=o;C<=d;C++)e[w]==null?_.push(null):_.push(e[w][C]);k.push(_)}this.saveParam("rv",n,k,{range:{row:[y,b],column:[o,d]}}),v==g-1&&this.saveParam("rv_end",n,null)}},saveParam:function(e,n,t,a){if(this.allowUpdate){t==null&&(t=null);var l={};if(l.t=e,l.i=n,l.v=t,e!=="shs"){e=="rv"?l.range=a.range:e=="v"||e=="fu"||e=="fm"?(l.r=a.r,l.c=a.c):e=="fc"?(l.op=a.op,l.pos=a.pos):e=="drc"||e=="arc"||e=="h"||e=="wh"?l.rc=a.rc:e=="c"?(l.cid=a.cid,l.op=a.op):e=="f"?(l.op=a.op,l.pos=a.pos):e=="s"||(e=="sh"?(l.op=a.op,a.cur!=null&&(l.cur=a.cur)):(e=="cg"||e=="all")&&(l.k=a.k));var o=U1.gzip(encodeURIComponent(JSON.stringify(l)),{to:"string"});this.websocket!=null&&this.websocket.send(o)}}},websocket:null,wxErrorCount:0,openWebSocket:function(){var e=this;if("WebSocket"in window){var n=e.updateUrl+"?t=111&g="+encodeURIComponent(e.gridKey);e.updateUrl.indexOf("?")>-1&&(n=e.updateUrl+"&t=111&g="+encodeURIComponent(e.gridKey)),e.websocket=new WebSocket(n),e.websocket.onopen=function(){console.info(st().websocket.success),$("#luckysheet-cell-loading").hide(),e.wxErrorCount=0,e.retryTimer=setInterval(function(){e.websocket.send("rub")},6e4)},e.websocket.onmessage=function(t){u.result=t;var a=new Function("return "+t.data)();console.info(a);var l=a.type,o=a.message,d=a.id;if(o===""&&($("#luckysheet-multipleRange-show-"+d).hide(),u.cooperativeEdit.changeCollaborationSize=u.cooperativeEdit.changeCollaborationSize.filter(function(A){return A.id!=d}),u.cooperativeEdit.checkoutData=u.cooperativeEdit.checkoutData.filter(function(A){return A.id!=d})),l!=1){if(l==2){var s=JSON.parse(a.data);e.wsUpdateMsg(s);var h=JSON.parse(a.data);(h.k=="columnlen"||h.k=="rowlen")&&Sc(h.v)}else if(l==3){var f=a.id,p=a.username,g=JSON.parse(a.data),v=(g.t,g.i),y=g.v;u.cooperativeEdit.changeCollaborationSize.length===0&&u.cooperativeEdit.changeCollaborationSize.push({id:f,v:g.v[0],i:v}),u.cooperativeEdit.changeCollaborationSize.some(function(A){return A.id==f})?u.cooperativeEdit.changeCollaborationSize.forEach(function(A){A.id==f&&(A.v=g.v[0],A.i=v)}):u.cooperativeEdit.changeCollaborationSize.push({id:f,v:g.v[0],i:v}),D(y)!="array"&&D(y)!=="object"&&(y=JSON.parse(y));var b=0,k=0;if(v==u.currentSheetIndex?D(y)==="object"&&y.op==="enterEdit"?(b=y.range[y.range.length-1].row[0],k=y.range[y.range.length-1].column[0],e.multipleRangeShow(f,p,b,k,y.op)):(b=y[y.length-1].row[0],k=y[y.length-1].column[0],e.multipleRangeShow(f,p,b,k)):D(y)==="object"&&y.op==="enterEdit"?(b=y.range[y.range.length-1].row[0],k=y.range[y.range.length-1].column[0]):(b=y[y.length-1].row[0],k=y[y.length-1].column[0]),u.cooperativeEdit.checkoutData.length===0&&(y.op?u.cooperativeEdit.checkoutData.push({id:f,username:p,r:b,c:k,op:y.op,index:v}):u.cooperativeEdit.checkoutData.push({id:f,username:p,r:b,c:k,index:v})),u.cooperativeEdit.checkoutData.some(function(A){return A.id==f})?u.cooperativeEdit.checkoutData.forEach(function(A){A.id==f&&(A.username=p,A.r=b,A.c=k,A.index=v,y.op==="enterEdit"&&(A.op=y.op))}):y.op==="enterEdit"?u.cooperativeEdit.checkoutData.push({id:f,username:p,r:b,c:k,op:y.op,index:v}):u.cooperativeEdit.checkoutData.push({id:f,username:p,r:b,c:k,index:v}),u.cooperativeEdit.checkoutData.forEach(function(A){A.index!=u.currentSheetIndex&&($("#luckysheet-multipleRange-show-"+A.id).hide(),A.op)}),$("#luckysheet-multipleRange-show-"+f)[0]){var w=$("#luckysheet-multipleRange-show-"+f)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+f+">.username").css({bottom:w+"px"})}}else if(l==4)for(var _=a.data===""?a.data:JSON.parse(a.data),C=0;C<_.length;C++)e.wsUpdateMsg(item[C])}},e.websocket.onerror=function(){e.wxErrorCount++,e.wxErrorCount>3?fp(st().websocket.refresh):(fp(st().websocket.wait),e.openWebSocket())},e.websocket.onclose=function(t){console.info(st().websocket.close),t.code===1e3?(clearInterval(e.retryTimer),e.retryTimer=null):alert(st().websocket.contact)}}else alert(st().websocket.support)},wsUpdateMsg:function(e){var n=e.t,t=e.i,a=e.v,l=u.luckysheetfile[je(t)];if(!["v","rv","cg","all","fc","drc","arc","f","fsc","fsr","sh","c"].includes(n)||l!=null)if(n=="v"){if(l.data==null||l.data.length==0)return;var o=e.r,d=e.c;l.data[o][d]=a,t==u.currentSheetIndex&&(u.flowdata=l.data,vr.webWorkerFlowDataCache(u.flowdata),a!=null&&a.ps!=null?Lr.buildPs(o,d,a.ps):Lr.buildPs(o,d,null),setTimeout(function(){Kr()},1))}else if(n=="rv"){if(Object.keys(e.range).length>0&&(u.cooperativeEdit.merge_range=e.range,u.cooperativeEdit.merge_range.v=e.v,Sc()),l.data==null||l.data.length==0)return;for(var s=e.range.row[0],h=e.range.row[1],f=e.range.column[0],p=e.range.column[1],g=s;g<=h;g++)for(var v=f;v<=p;v++)l.data[g][v]=a[g-s][v-f];if(t==u.currentSheetIndex){u.flowdata=l.data,vr.webWorkerFlowDataCache(u.flowdata);for(var y=s;y<=h;y++)for(var b=f;b<=p;b++)a[y-s][b-f]!=null&&a[y-s][b-f].ps!=null?Lr.buildPs(y,b,a[y-s][b-f].ps):Lr.buildPs(y,b,null);setTimeout(function(){Kr()},1)}}else if(n=="cg"){var k=e.k;if(k=="borderInfo")l.config.borderInfo=a;else for(var w in k in l.config||(l.config[k]={}),a)l.config[k][w]=a[w];t==u.currentSheetIndex&&(u.config=l.config,k!="rowlen"&&k!="columnlen"&&k!="rowhidden"||ln(u.flowdata.length,u.flowdata[0].length),setTimeout(function(){Kr()},1))}else if(n=="all"){var _=e.k;if(l[_]=a,_=="name")$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t).find("span.luckysheet-sheets-item-name").html(a);else if(_=="color"){var C=$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t);C.find(".luckysheet-sheets-item-color").remove(),a==null&&a==""||C.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+a+';"></div>')}else if(_!="pivotTable")if(_=="frozen"){if(Ne.frozenTofreezen(),t==u.currentSheetIndex){var A=st().freezen;l.freezen.horizontal==null?($("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> '+A.freezenRow),Ne.freezenhorizontaldata=null,$("#luckysheet-freezebar-horizontal").hide()):Ne.createFreezenHorizontal(l.freezen.horizontal.freezenhorizontaldata,l.freezen.horizontal.top),l.freezen.vertical==null?($("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+A.freezenColumn),Ne.freezenverticaldata=null,$("#luckysheet-freezebar-vertical").hide()):Ne.createFreezenVertical(l.freezen.vertical.freezenverticaldata,l.freezen.vertical.left),Ne.createAssistCanvas()}}else _=="filter_select"?t==u.currentSheetIndex&&gi(a):_=="filter"?t==u.currentSheetIndex&&gi(l.filter_select,a):_=="luckysheet_conditionformat_save"||_=="luckysheet_alternateformat_save"?t==u.currentSheetIndex&&setTimeout(function(){Kr()},1):_=="config"?t==u.currentSheetIndex&&(u.config=a,ln(u.flowdata.length,u.flowdata[0].length)):_=="dynamicArray"?t==u.currentSheetIndex&&setTimeout(function(){Kr()},1):_=="images"?t==u.currentSheetIndex&&(_r.images=a,_r.allImagesShow(),_r.init()):_=="dataVerification"?t==u.currentSheetIndex&&(aa.dataVerification=a,aa.init()):_=="hyperlink"&&t==u.currentSheetIndex&&(Jl.hyperlink=a,Jl.init())}else if(n=="fc"){var I=e.op;e.pos,D(a)!="object"&&(a=new Function("return "+a)());var S=a.r,E=a.c,R=l.calcChain==null?[]:l.calcChain;if(I=="add")R.push(a);else if(I=="del")for(var F=0;F<R.length;F++)S==R[F].r&&E==R[F].c&&t==R[F].index&&R.splice(F,1);setTimeout(function(){Kr()},1)}else if(n=="drc"){if(l.data==null||l.data.length==0)return;var N=e.rc,z=a.index,P=a.len,q=a.mc,V=a.borderInfo,x=l.data;if(N=="r"){l.row-=P,x.splice(z,P);for(var ee=[],ne=0;ne<x[0].length;ne++)ee.push(null);for(var ae=0;ae<P;ae++)x.push(ee)}else{l.column-=P;for(var de=[],ve=0;ve<P;ve++)de.push(null);for(var U=0;U<x.length;U++)x[U].splice(z,P),x[U]=x[U].concat(de)}for(var B in q){var le=q[B].r,Te=q[B].c;x[le][Te].mc=q[B]}l.config.merge=q,l.config.borderInfo=V,t==u.currentSheetIndex&&(u.flowdata=x,vr.webWorkerFlowDataCache(u.flowdata),u.config.merge=q,u.config.borderInfo=V,setTimeout(function(){Kr()},1))}else if(n=="arc"){if(l.data==null||l.data.length==0)return;var ue=e.rc,be=a.index,ye=a.len,ce=a.data,Re=a.direction,pe=a.mc,me=a.borderInfo,re=$.extend(!0,[],l.data);if(ue=="r"){l.row+=ye;for(var _e=[],Ze=0;Ze<re[0].length;Ze++)_e.push(null);for(var We=[],Xe=0;Xe<ye;Xe++)ce[Xe]==null?We.push(JSON.stringify(_e)):We.push(JSON.stringify(ce[Xe]));Re=="lefttop"?be==0?new Function("data","return data.unshift("+We.join(",")+")")(re):new Function("data","return data.splice("+be+", 0, "+We.join(",")+")")(re):new Function("data","return data.splice("+(be+1)+", 0, "+We.join(",")+")")(re)}else{l.column+=ye;for(var Ue=0;Ue<re.length;Ue++)re[Ue].splice(be,0,ce[Ue])}for(var mt in pe){var St=pe[mt].r,at=pe[mt].c;re[St][at].mc=pe[mt]}l.data=re,l.config.merge=pe,l.config.borderInfo=me,t==u.currentSheetIndex&&(u.flowdata=re,vr.webWorkerFlowDataCache(u.flowdata),u.config.merge=pe,u.config.borderInfo=me,setTimeout(function(){Kr()},1))}else if(n=="f"){var dt=e.op,wt=e.pos,ct=l.filter;ct==null&&(ct={}),dt=="upOrAdd"?ct[wt]=a:dt=="del"&&delete ct[wt],t==u.currentSheetIndex&&gi(l.filter_select,ct)}else if(n=="fsc")l.filter=null,l.filter_select=null,t==u.currentSheetIndex&&($("#luckysheet-filter-selected-sheet"+u.currentSheetIndex+", #luckysheet-filter-options-sheet"+u.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide());else if(n=="fsr")l.filter=a.filter,l.filter_select=a.filter_select,t==u.currentSheetIndex&&gi(l.filter_select,l.filter);else if(n=="sha"){u.luckysheetfile.push(a);var bt="";a.color!=null&&(bt='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+a.color+';"></div>'),$("#luckysheet-sheet-container-c").append(br($i,{index:a.index,active:"",name:a.name,style:"",colorset:bt})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if(n=="shc"){var De=a.copyindex,He=a.name,Dt=je(De),et=$.extend(!0,{},u.luckysheetfile[Dt]);et.index=t,et.name=He,u.luckysheetfile.splice(Dt+1,0,et);var ur=$("#luckysheet-sheets-item"+De);$("#luckysheet-sheet-container-c").append(br($i,{index:et.index,active:"",name:et.name,style:"",colorset:""})),$("#luckysheet-sheets-item"+et.index).insertAfter(ur),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+et.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if(n=="shd"){for(var Xt=0;Xt<u.luckysheetfile.length;Xt++)if(u.luckysheetfile[Xt].index==a.deleIndex){if(u.currentSheetIndex===a.deleIndex){var jt=a.deleIndex;u.luckysheetfile[ir.getSheetIndex(jt)].hide=1;var lr=$("#luckysheet-sheets-item"+jt);lr.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");var tr=lr.nextAll(":visible");tr=lr.nextAll(":visible").length>0?tr.eq(0).data("index"):lr.prevAll(":visible").eq(0).data("index"),$("#luckysheet-sheets-item"+tr).addClass("luckysheet-sheets-item-active"),ir.changeSheetExec(tr)}nt.sheetDeleSave.push(u.luckysheetfile[Xt]),u.luckysheetfile.splice(Xt,1);break}$("#luckysheet-sheets-item"+a.deleIndex).remove(),$("#luckysheet-datavisual-selection-set-"+a.deleIndex).remove()}else if(n=="shr")for(var xr in a)u.luckysheetfile[je(xr)].order=a[xr];else if(n=="shre"){for(var rr=0;rr<nt.sheetDeleSave.length;rr++)if(nt.sheetDeleSave[rr].index==a.reIndex){var nr=nt.sheetDeleSave[rr];u.luckysheetfile.push(nr);var Ut="";a.color!=null&&(Ut='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+nr.color+';"></div>'),$("#luckysheet-sheet-container-c").append(br($i,{index:nr.index,active:"",name:nr.name,style:"",colorset:Ut})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+nr.index+'" class="luckysheet-datavisual-selection-set"></div>');break}}else if(n=="sh"){var ar=e.op,Jt=e.cur;ar=="hide"?(l.hide=1,$("#luckysheet-sheets-item"+t).hide(),t==u.currentSheetIndex&&($("#luckysheet-sheets-item"+Jt).addClass("luckysheet-sheets-item-active"),ir.changeSheetExec(Jt))):ar=="show"&&(l.hide=0,$("#luckysheet-sheets-item"+t).show())}else if(n=="c"){var Qt=e.op,_t=e.cid;if(Qt=="add")l.chart.push(a),luckysheet.insertChartTosheet(a.sheetIndex,a.dataSheetIndex,a.option,a.chartType,a.selfOption,a.defaultOption,a.row,a.column,a.chart_selection_color,a.chart_id,a.chart_selection_id,a.chartStyle,a.rangeConfigCheck,a.rangeRowCheck,a.rangeColCheck,a.chartMarkConfig,a.chartTitleConfig,a.winWidth,a.winHeight,a.scrollLeft1,a.scrollTop1,a.chartTheme,a.myWidth,a.myHeight,a.myLeft,a.myTop,a.myindexrank1,!0);else if(Qt=="xy"||Qt=="wh"||Qt=="update")for(var er=0;er<l.chart.length;er++){var Kt=l.chart[er];if(Kt.chart_id==_t){for(var mr in Kt)for(var fr in a)mr==fr&&(Kt[mr]=a[fr]);return void ir.saveChart(Kt)}}else if(Qt=="del"){for(var Wt=0;Wt<l.chart.length;Wt++)if(l.chart[Wt].chart_id==_t)return l.chart.splice(Wt,1),$("#"+_t).remove(),void ir.delChart($("#"+_t).attr("chart_id"),$("#"+_t).attr("sheetIndex"))}}else n=="na"&&$("#luckysheet_info_detail_input").val(a).css("width",10*Rc(a))},multipleIndex:0,multipleRangeShow:function(e,n,t,a,l){var o=u.visibledatarow[t],d=t-1==-1?0:u.visibledatarow[t-1],s=u.visibledatacolumn[a],h=a-1==-1?0:u.visibledatacolumn[a-1],f=dr.mergeborer(u.flowdata,t,a);if(f&&(o=f.row[1],d=f.row[0],s=f.column[1],h=f.column[0]),Rc(n)>16&&(n=Rc(n,16)+"..."),l==="enterEdit"&&(n+=" "+st().edit.typing),$("#luckysheet-multipleRange-show-"+e).length>0)$("#luckysheet-multipleRange-show-"+e).css({position:"absolute",left:h-1,width:s-h-1,top:d-1,height:o-d-1}),$("#luckysheet-multipleRange-show-"+e+" .username").text(n),$("#luckysheet-multipleRange-show-"+e+" .username").show(),u.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(u.cooperativeEdit.usernameTimeout["user"+e]),u.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(function(){clearTimeout(u.cooperativeEdit.usernameTimeout["user"+e]),u.cooperativeEdit.usernameTimeout["user"+e]=null},1e4);else{var p=`<div 
								id="luckysheet-multipleRange-show-`.concat(e,`"
								class="luckysheet-multipleRange-show"
								data-color="`).concat(Di[this.multipleIndex],`" 
								title="`).concat(n,`" 
								style="position: absolute;left: `).concat(h-1,"px;width: ").concat(s-h-1,"px;top: ").concat(d-1,"px;height: ").concat(o-d-1,"px;border: 1px solid ").concat(Di[this.multipleIndex],`;z-index: 15;">

								<div class="username" style="height: 19px;line-height:19px;width: max-content;position: absolute;bottom: `).concat(o-d-1,"px;right: 0;background-color: ").concat(Di[this.multipleIndex],`;color:#ffffff;padding:0 10px;">
								`).concat(n,`
								</div>

								<div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: `).concat(Di[this.multipleIndex],`">
								</div>

							</div>`);$(p).appendTo($("#luckysheet-cell-main #luckysheet-multipleRange-show")),this.multipleIndex++,u.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(u.cooperativeEdit.usernameTimeout["user"+e]),u.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(function(){clearTimeout(u.cooperativeEdit.usernameTimeout["user"+e]),u.cooperativeEdit.usernameTimeout["user"+e]=null},1e4)}},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){var n=this;n.submitTimeout(),clearTimeout(n.imageRequestTimeout),n.imageRequestTimeout=setTimeout(function(){n.imageRequest()},n.imagesubmitInterval)},submitTimeout:function(){var e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&e.requestlast!=null&&e.requestlast.clone().add(1,"seconds").isBefore(Q())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){var e=this;this.gridKey,e.cachelocaldata(function(n,t){t.length!=0&&((t=encodeURIComponent(JSON.stringify(t))).length,e.requestLock=!0,e.updateUrl!=""&&$.post(e.updateUrl,{compress:!1,gridKey:e.gridKey,data:t},function(a){new Function("return "+a)().status?($("#luckysheet_info_detail_update").html(":"+Q().format("M-D H:m:s")),$("#luckysheet_info_detail_save").html(""),e.clearcachelocaldata()):($("#luckysheet_info_detail_save").html("<span style='color:#ff2121'></span>"),e.restorecachelocaldata()),e.requestlast=Q(),e.requestLock=!1}))})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){var e=this;html2canvas($("#"+container).find(".luckysheet-grid-window").get(0),{onrendered:function(n){var t=$(n).appendTo("body");t.hide();var a=t.width(),l=t.height(),o=t.get(0).getContext("2d").getImageData(0,0,a,l),d=a,s=l;.54*d>s?d=s/.54:s=.54*d;var h=$("<canvas>").attr("width",d).attr("height",s)[0];h.getContext("2d").putImageData(o,0,0),t.attr("width",350),t.attr("height",189),t.get(0).getContext("2d").drawImage(h,0,0,350,189);var f=t.get(0).toDataURL("image/jpeg",.9),p=luckysheet.sheetmanage.getCurSheetnoset();e.imageRequestLock=!0;var g=encodeURIComponent(JSON.stringify({t:"thumb",img:f,curindex:p}));t.remove(),e.updateImageUrl!=""&&$.post(e.updateImageUrl,{compress:!1,gridKey:e.gridKey,data:g},function(v){new Function("return "+v)().status?imageRequestLast=Q():$("#luckysheet_info_detail_save").html("<span style='color:#ff2121'></span>"),e.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,n){for(var t in e)if(t=="t"&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1}||t!="v"&&(!(t in n)||n[t]!=e[t]))return!1;return!0},deleteRepeatOpt:function(e,n){var t=e;if(n instanceof Array)for(var a=0;a<n.length;a++)for(var l=n[a],o=0;o<t.length;o++){var d=e[a];this.matchOpt(l,d)&&delete t[o]}else for(var s=0;s<t.length;s++){var h=t[s];this.matchOpt(n,h)&&delete t[s]}for(var f=[],p=0;p<t.length;p++)t[p]!=null&&f.push(t[p]);return f},setlocaldata:function(e,n){this.gridKey;var t=this;t.getlocaldata(function(a){a==null&&(a=[]),e instanceof Array?a=a.concat(e):a.push(e),t.localdata=a,n(t.localdata)})},getlocaldata:function(e){this.gridKey,e(this.localdata)},clearlocaldata:function(e){this.gridKey,this.localdata=[],e()},cachelocaldata:function(e){var n=this.gridKey+"__qkcache",t=this.localdata,a=t.length;if(a>1){var l=[];l[0]=t[0];for(var o=1;o<a;o++){for(var d=t[o],s=!0,h=0;h<l.length;h++){var f=l[h];if(this.matchOpt(d,f)){l.splice(h,1,d),s=!1;break}}s&&(l=l.concat(d))}t=l}t!=null&&t.length!=0&&this.clearlocaldata(function(){localforage.setItem(n,t).then(function(){e(n,t)})})},clearcachelocaldata:function(e){var n=this.gridKey+"__qkcache";localforage.removeItem(n,function(t,a){e&&typeof e=="function"&&e()})},restorecachelocaldata:function(e){var n=this.gridKey+"__qkcache",t=this;localforage.getItem(n).then(function(a){var l=a;t.getlocaldata(function(o){o==null&&(o=[]);var d=l.concat(o);t.localdata=d,e instanceof Function&&e(t.localdata)})})},keepHighLightBox:function(){u.cooperativeEdit.checkoutData.forEach(function(e){e.index==u.currentSheetIndex&&(e.op==="enterEdit"?nt.multipleRangeShow(e.id,e.username,e.r,e.c,e.op):nt.multipleRangeShow(e.id,e.username,e.r,e.c))})}},Ee={info:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove();var t=st().button;$("body").append(br(Ga,{id:"luckysheet-info",addclass:"",title:e,content:n,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+t.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));var a=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=a.outerHeight(),o=a.outerWidth(),d=$(window).width(),s=$(window).height(),h=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-info").css({left:(d+h-o)/2,top:(s+f-l)/3}).show()},confirm:function(e,n,t,a,l,o){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove();var d=st().button;l==null&&(l=d.confirm),o==null&&(o=d.cancel),$("body").append(br(Ga,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+l+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+o+"&nbsp;&nbsp;</button>"}));var s=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),h=s.outerHeight(),f=s.outerWidth(),p=$(window).width(),g=$(window).height(),v=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-confirm").css({left:(p+v-f)/2,top:(g+y-h)/3}).show(),s.find(".luckysheet-model-conform-btn").click(function(){typeof t=="function"&&t(),nt.keepHighLightBox(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),s.find(".luckysheet-model-cancel-btn").click(function(){typeof a=="function"&&a(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(e,n,t){var a=st().screenshot;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").append(br(Ga,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+a.downLoadBtn+'&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;'+a.downLoadCopy+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+a.downLoadClose+"&nbsp;&nbsp;</button>"}));var l=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-confirm").css({left:(s+f-d)/2,top:(h+p-o)/3}).show(),l.find(".luckysheet-model-conform-btn").click(function(){Ko.isIE()=="1"?alert(a.browserNotTip):(window.ActiveXObject||"ActiveXObject"in window)&&($("#IframeReportImg").length===0&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=t?$("#IframeReportImg").attr("src",t):$("#IframeReportImg").src!="about:blank"&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),l.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){var g=new clipboard.DT;g.setData("text/html","<img src='"+t+"'>"),Ko.isIE()=="1"?alert(a.rightclickTip):(clipboard.write(g),alert(a.successTip))})},chartPointConfig:function(e,n,t){$("body").append(br(Ga,{id:e,addclass:"luckysheet-chart-point-config-c",title:"",content:'<div class="luckysheet-chart-point-config"> <div class="luckysheet-chart-point-config-set"> <div class="luckysheet-chart-point-config-left"> <div class="luckysheet-chart-point-config-left-top"> <div class="luckysheet-chart-point-searchcondition"> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 0px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="" name="luckysheetpointconfigsearchdim" id="luckysheetpointconfigsearchdim"> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 3px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="" for="luckysheetpointconfigsearchorderno"></label> <input type="radio" checked="checked" value="0" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderno"> <label data-tips="" for="luckysheetpointconfigsearchorderasc"></label> <input type="radio" value="1" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderasc"> <label data-tips="" for="luckysheetpointconfigsearchorderdesc"></label> <input type="radio" value="2" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderdesc"> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 5px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:90%;text-align: left;"> <select data-width="70" data-tips="" name="luckysheetpointconfigsearchtype" id="luckysheetpointconfigsearchtype"> <option value="0" selected="selected"></option> <option value="1">%</option> </select> <input data-tips="" id="luckysheetpointconfigsearchcontent" type="text" class="luckysheet-datavisual-config-input-no" style="width:40%;" placeholder="" /> <button id="luckysheetpointconfigsearchcomfirm" class="btn btn-primary luckysheet-model-conform-btn"></button> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-left-mid"> <span id="luckysheet-chart-point-btn-all" class="luckysheet-mousedown-cancel"></span> - <span id="luckysheet-chart-point-btn-clear" class="luckysheet-mousedown-cancel"></span> - <span id="luckysheet-chart-point-btn-contra" class="luckysheet-mousedown-cancel"></span><span style="text-decoration:none;color:#8D8D8D;float:right;margin-right:40px;cursor:default;" class="luckysheet-mousedown-cancel"></span> </div> <div class="luckysheet-chart-point-config-left-bottom"> <div class="luckysheet-chart-point-searchitem-c luckysheet-noselected-text">  </div> </div> </div> <div class="luckysheet-chart-point-config-right"> <div class="luckysheet-chart-point-itemconfig"> <div class="luckysheet-datavisual-content-row" style="font-size: 16px;font-weight: bold;">  </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstylecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="color" /> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleallsymbolsizeslider" data-tips="" name="scattersingleallsymbolsize" id="scattersingleallsymbolsize" data-width="50" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize"> <option value="4" selected="selected">4px</option> <option value="6">6px</option> <option value="8">8px</option> <option value="10">10px</option> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="diy"></option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="" id="scattersingleallsymbolsizeslider" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="1" data-max="50" data-step="1"></div> <input data-tips="" data-sliderid="scattersingleallsymbolsizeslider" id="scattersingleallsymbolsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" placeholder="" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleallsymbolsizesliderdiy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="" data-width="70" name="scattersingleallsymboltype" id="scattersingleallsymboltype" data-bigclass="scattersingle" data-attr="all" data-func="symboltype"> <option value="emptyCircle" selected="selected"></option> <option value="circle"></option> <option value="emptyRectangle"></option> <option value="rect"></option> <option value="roundRect"></option> <option value="emptyTriangle"></option> <option value="triangle"></option> <option value="emptyDiamond"></option> <option value="diamond"></option> <option value="droplet"></option> <option value="pin"></option> <option value="arrow"></option> <option value="heart"></option> <option value="star"></option> </select> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleitemstyleborderwidthslider" data-tips="" name="scattersingleitemstyleborderwidth" id="scattersingleitemstyleborderwidth" data-width="50" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth"><option value="0" selected="selected"></option> <option value="1">1px</option> <option value="2">2px</option> <option value="3">3px</option> <option value="4">4px</option> <option value="5">5px</option> <option value="6">6px</option> <option value="7">7px</option> <option value="8">8px</option> <option value="diy"></option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="" id="scattersingleitemstyleborderwidthslider" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="" data-sliderid="scattersingleitemstyleborderwidthslider" id="scattersingleitemstyleborderwidthsliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" placeholder="" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleitemstyleborderwidthsliderdiy">%</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="" data-width="50" name="scattersingleitemstyleborderlinetype" id="scattersingleitemstyleborderlinetype" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinetype"> <option value="solid" selected="selected"></option> <option value="dashed"></option> <option value="dotted"></option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstyleborderlinecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinecolor" /> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"><i class="fa fa-th-large" aria-hidden="true"></i> </div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow"></label> <input type="radio" checked="checked" value="1" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> <label data-tips="" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow1"></label> <input type="radio" value="0" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow1" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> </div> </div> <div class="luckysheet-datavisual-content-row" style="height:auto;line-height: initial;margin-left:auto;" showfor="scattersinglelabellabelshow1" hidefor="scattersinglelabellabelshow"> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="" name="scattersinglelabelformatratio" id="scattersinglelabelformatratio" data-bigclass="scattersingle" data-attr="label" data-func="formatratio"> <option value="0.01">100</option> <option value="0.1">10</option> <option value="1" selected="selected"></option> <option value="10">10</option> <option value="100">100</option> <option value="1000">1000</option> <option value="10000">1</option> <option value="100000">10</option> <option value="1000000"></option> <option value="10000000"></option> <option value="100000000"></option> <option value="1000000000"></option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;white-space: nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="" name="scattersinglelabelfloatlen" id="scattersinglelabelfloatlen" data-bigclass="scattersingle" data-attr="label" data-func="floatlen"> <option value="auto" selected="selected"></option> <option value="0"></option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> <option value="6">6</option> <option value="7">7</option> <option value="8">8</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:20%;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:70%;"> <select data-sliderdiy="scattersinglelabelcontentformatslider" data-tips="" name="scattersinglelabelcontentformat" id="scattersinglelabelcontentformat" data-bigclass="scattersingle" data-attr="label" data-func="contentformat"> <option value="default" selected="selected"></option> <option value="1"></option> <option value="2">+2</option> <option value="5">+</option> <option value="diy"></option> </select> </div> </div> <div style="display:none;"> <div class="luckysheet-datavisual-content-row" id="scattersinglelabelcontentformatslider"> <div style="text-align:center; width:60px; display:inline-block;"></div> <label data-tips="" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow" for="scattersinglelabeldatalabelshow" style="font-weight:bold;"><i class="fa fa-eye" aria-hidden="true"></i></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelshow" id="scattersinglelabeldatalabelshow" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow"> <input data-tips="" placeholder="" id="scattersinglelabeldatalabelprefix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelprefix" /> <input data-tips="" placeholder="" id="scattersinglelabeldatalabelsuffix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelsuffix" /> <label data-tips="" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline" for="scattersinglelabeldatalabelline" style="font-weight:bold;"></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelline" id="scattersinglelabeldatalabelline" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline"> </div> </div> <div class="luckysheet-datavisual-content-row" > <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"></div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersinglelabellabelplaceslider" data-tips="" data-width="70" name="scattersinglelabellabelplace" id="scattersinglelabellabelplace" data-bigclass="scattersingle" data-attr="label" data-func="labelplace"> <option value="top" selected="selected"></option> <option value="left"></option> <option value="right"></option> <option value="bottom"></option> <option value="inside"></option> <option value="diy"></option> <option value="insideLeft"></option> <option value="insideRight"></option> <option value="insideTop"></option> <option value="insideBottom"></option> <option value="insideTopLeft"></option> <option value="insideBottomLeft"></option> <option value="insideTopRight"></option> <option value="insideBottomRight"></option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;height:65px;"> <div data-tips="" id="scattersinglelabellabelplaceslider" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="" data-sliderid="scattersinglelabellabelplaceslider" id="scattersinglelabellabelplacesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplacesliderdiy">px</label> <br /> <div data-tips="" id="scattersinglelabellabelplaceslider1" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="" data-sliderid="scattersinglelabellabelplaceslider1" id="scattersinglelabellabelplaceslider1diy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplaceslider1diy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <label data-tips="" data-bigclass="scattersingle" data-attr="label" data-func="labelbold" for="scattersinglelabellabelbold" style="font-weight:bold;"><i class="fa fa-bold" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelbold" id="scattersinglelabellabelbold" data-bigclass="scattersingle" data-attr="label" data-func="labelbold"> <label data-tips="" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic" for="scattersinglelabellabelitalic" class="luckysheet-datavisual-content-column-italic"><i class="fa fa-italic" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelitalic" id="scattersinglelabellabelitalic" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic"> <select data-sliderdiy="scattersinglelabellabelfontsizeslider" data-width="50" data-tips="" name="scattersinglelabellabelfontsize" id="scattersinglelabellabelfontsize" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize"> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="18">18px</option> <option value="20">20px</option> <option value="22">22px</option> <option value="24">24px</option> <option value="30">30px</option> <option value="36">36px</option> <option value="diy"></option> </select> <input data-tips="" class="luckysheet-datavisual-config-color" id="scattersinglelinelabelcolor" type="text" data-bigclass="scattersingle" data-attr="label" data-func="labelcolor" /> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="" id="scattersinglelabellabelfontsizeslider" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="" data-sliderid="scattersinglelabellabelfontsizeslider" id="scattersinglelabellabelfontsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" placeholder="" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelfontsizesliderdiy">px</label> </div> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-chart"> <div id="luckysheet-chart-point-config-chart-c" class="luckysheet-chart-point-config-chart-c"> </div> </div> </div>',botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();var a=$(window).width(),l=$(window).height();$("#"+e).find(".luckysheet-chart-point-config").css("height",l-160),$("#"+e).css({height:l-90,width:a-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){typeof n=="function"&&n(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+e).find(".luckysheet-model-save-btn").click(function(){typeof t=="function"&&t(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(e,n){var t=this;$(e).on("mouseover",n,function(a){t.hoverTipshowState||(clearTimeout(t.hoverTipshowTimeOut),t.hoverTipshowTimeOut=setTimeout(function(){var l=$(a.currentTarget),o=l.offset(),d=$("#luckysheet-tooltip-up"),s=l.data("tips");if(s!=null&&s.length!=0||(s=l.prev().data("tips"))!=null&&s.length!=0){d.length==0&&($("body").append('<div id="luckysheet-tooltip-up" class="jfk-tooltip" role="tooltip" aria-hidden="true" style="left: 505px; top: 410px;"><div class="jfk-tooltip-contentId"></div><div class="jfk-tooltip-arrow jfk-tooltip-arrowup" style="left: 35.5px;"><div class="jfk-tooltip-arrowimplbefore"></div><div class="jfk-tooltip-arrowimplafter"></div></div></div>'),d=$("#luckysheet-tooltip-up")),d.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(s);var h=d.outerWidth();d.find("div.jfk-tooltip-arrow").css("left",h/2);var f=o.left+(l.outerWidth()-h)/2;f<2&&(f=2,d.find("div.jfk-tooltip-arrow").css("left",l.outerWidth()/2)),d.css({top:o.top+l.outerHeight()+1,left:f})}},300))}).on("mouseout",n,function(a){t.hoverTipshowState=!1,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",n,function(a){t.hoverTipshowState=!0,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(e,n,t,a,l,o){var d=st(),s=d.button,h=d.paint;l==null&&(l=s.close);var f='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">'+h.start+'</div><div class="luckysheetpopover-btn">'+l+"</div></div>";$("#luckysheetpopover").remove(),$("body").append(f),$("#luckysheetpopover .luckysheetpopover-content").html(e);var p=$("#luckysheetpopover").outerWidth(),g=$("#luckysheetpopover").outerHeight(),v={};n=="topLeft"?(v.top="20px",v.left="20px"):n=="topCenter"?(v.top="20px",v.left="50%",v["margin-left"]=-p/2):n=="topRight"?(v.top="20px",v.right="20px"):n=="midLeft"?(v.top="50%",v["margin-top"]=-g/2,v.left="20px"):n=="center"?(v.top="50%",v["margin-top"]=-g/2,v.left="50%",v["margin-left"]=-p/2):n=="midRight"?(v.top="50%",v["margin-top"]=-g/2,v.right="20px"):n=="bottomLeft"?(v.bottom="20px",v.left="20px"):n=="bottomCenter"?(v.bottom="20px",v.left="50%",v["margin-left"]=-p/2):n=="bottomRight"?(v.bottom="20px",v.right="20px"):(v.top="20px",v.left="50%",v["margin-left"]=-p/2),a=="white"&&(v.background="rgba(255, 255, 255, 0.65)",v.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(v).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){typeof o=="function"&&o()}),t!=null&&typeof t=="number"&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),typeof o=="function"&&o()},t)}},kr={fileClone:[],editorRule:null,ruleTypeHtml:function(){var e=st().conditionformat;return`<div class="ruleTypeBox">
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>`.concat(e.ruleTypeItem1,`</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>`).concat(e.ruleTypeItem2,`</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>`).concat(e.ruleTypeItem3,`</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>`).concat(e.ruleTypeItem4,`</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>`).concat(e.ruleTypeItem5,`</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>`).concat(e.ruleTypeItem6,`</span>
                    </div>
                </div>`)},textCellColorHtml:function(){var e=st().conditionformat;return`<div id="textCellColor">
                    <div class="colorbox">
                        <input id="checkTextColor" type="checkbox" checked="checked">
                        <label for="checkTextColor">`.concat(e.textColor,`</label>
                        <input id="textcolorshow" data-tips="`).concat(e.textColor,`" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#9c0006" style="display: none;">
                    </div>
                    <div class="colorbox">
                        <input id="checkCellColor" type="checkbox" checked="checked">
                        <label for="checkCellColor">`).concat(e.cellColor,`</label>
                        <input id="cellcolorshow" data-tips="`).concat(e.cellColor,`" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#ffc7ce" style="display: none;">
                    </div>
                </div>`)},selectRange:[],selectStatus:!1,dataBarList:[{format:["#638ec6","#ffffff"]},{format:["#63c384","#ffffff"]},{format:["#ff555a","#ffffff"]},{format:["#ffb628","#ffffff"]},{format:["#008aef","#ffffff"]},{format:["#d6007b","#ffffff"]},{format:["#638ec6"]},{format:["#63c384"]},{format:["#ff555a"]},{format:["#ffb628"]},{format:["#008aef"]},{format:["#d6007b"]}],colorGradationList:[{format:["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(255, 235, 132)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(90, 138, 198)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(90, 138, 198)"]},{format:["rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)"]},{format:["rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(255, 235, 132)"]},{format:["rgb(255, 235, 132)","rgb(99, 190, 123)"]}],init:function(){var e=this,n=st().conditionformat;$(document).off("change.CFchooseSheet").on("change.CFchooseSheet","#luckysheet-administerRule-dialog .chooseSheet",function(){var t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.getConditionRuleList(t)}),$(document).off("click.CFadministerRuleItem").on("click.CFadministerRuleItem","#luckysheet-administerRule-dialog .ruleList .listBox .item",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.CFadministerRuleConfirm").on("click.CFadministerRuleConfirm","#luckysheet-administerRule-dialog-confirm",function(){if(ro(u.currentSheetIndex)){for(var t=$.extend(!0,[],u.luckysheetfile),a=e.getHistoryRules(t),l=$.extend(!0,[],e.fileClone),o=0;o<l.length;o++){var d=l[o].index;u.luckysheetfile[je(d)].luckysheet_conditionformat_save=l[je(d)].luckysheet_conditionformat_save}var s=$.extend(!0,[],u.luckysheetfile),h=e.getCurrentRules(s);if(e.ref(a,h),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),nt.allowUpdate)for(var f=$.extend(!0,[],u.luckysheetfile),p=0;p<f.length;p++)nt.saveParam("all",f[p].index,f[p].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}}),$(document).off("click.CFadministerRuleClose").on("click.CFadministerRuleClose","#luckysheet-administerRule-dialog-close",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),e.fileClone=[]}),$(document).off("click.CFadministerRuleFa").on("click.CFadministerRuleFa","#luckysheet-administerRule-dialog .item .fa-table",function(){$(this).parents("#luckysheet-administerRule-dialog").hide();var t=$("#luckysheet-administerRule-dialog .chooseSheet select option:selected").val();t!=u.currentSheetIndex&&ir.changeSheetExec(t);var a=$(this).siblings("input").val().trim(),l=$(this).parents(".item").attr("data-item");e.multiRangeDialog(l,a),e.selectRange=[];var o=e.getRangeByTxt(a);if(o.length>0)for(var d=0;d<o.length;d++){var s=o[d].row[0],h=o[d].row[1],f=o[d].column[0],p=o[d].column[1],g=u.visibledatarow[h],v=s-1==-1?0:u.visibledatarow[s-1],y=u.visibledatacolumn[p],b=f-1==-1?0:u.visibledatacolumn[f-1];e.selectRange.push({left:b,width:y-b-1,top:v,height:g-v-1,left_move:b,width_move:y-b-1,top_move:v,height_move:g-v-1,row:[s,h],column:[f,p],row_focus:s,column_focus:f})}pn(e.selectRange)}),$(document).off("click.CFmultiRangeConfirm").on("click.CFmultiRangeConfirm","#luckysheet-multiRange-dialog-confirm",function(){$(this).parents("#luckysheet-multiRange-dialog").hide();var t=$(this).attr("data-item"),a=$(this).parents("#luckysheet-multiRange-dialog").find("input").val();$("#luckysheet-administerRule-dialog .item[data-item="+t+"] input").val(a);var l=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.fileClone[je(l)].luckysheet_conditionformat_save[t].cellrange=e.getRangeByTxt(a),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),pn([])}),$(document).off("click.CFmultiRangeClose").on("click.CFmultiRangeClose","#luckysheet-multiRange-dialog-close",function(){$(this).parents("#luckysheet-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),pn([])}),$(document).off("click.CFnewConditionRule").on("click.CFnewConditionRule","#newConditionRule",function(){ro($("#luckysheet-administerRule-dialog .chooseSheet option:selected").val())&&(u.luckysheet_select_save.length!=0?e.newConditionRuleDialog(1):Rt()?alert(n.pleaseSelectRange):Ee.info(n.pleaseSelectRange,""))}),$(document).off("click.CFnewConditionRuleConfirm").on("click.CFnewConditionRuleConfirm","#luckysheet-newConditionRule-dialog-confirm",function(){if(ro(u.currentSheetIndex)){var t,a,l=$("#luckysheet-newConditionRule-dialog .ruleTypeItem.on").index(),o=$("#luckysheet-newConditionRule-dialog #type1 option:selected").val(),d=$("#luckysheet-newConditionRule-dialog ."+o+"Box #type2 option:selected").val();if(l==0)if(o=="dataBar"){var s=$(this).parents("#luckysheet-newConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();d=="gradient"?t=[s,"#ffffff"]:d=="solid"&&(t=[s]),a={type:"dataBar",cellrange:$.extend(!0,[],u.luckysheet_select_save),format:t}}else if(o=="colorGradation"){var h=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),p=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();d=="threeColor"?t=[h,f,p]:d=="twoColor"&&(t=[h,p]),a={type:"colorGradation",cellrange:$.extend(!0,[],u.luckysheet_select_save),format:t}}else o=="icons"&&(t={len:$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-len"),leftMin:$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),top:$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-top")},a={type:"icons",cellrange:$.extend(!0,[],u.luckysheet_select_save),format:t});else{var g="",v=[],y=[];if(l==1){if(o=="number")if(g=d,d=="betweenness"){var b=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),k=$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val().trim(),w=e.getRangeByTxt(b);if(w.length>1)return void e.infoDialog(n.onlySingleCell,"");if(w.length==1){var _=w[0].row[0],C=w[0].row[1],A=w[0].column[0],I=w[0].column[1];if(_!=C||A!=I)return void e.infoDialog(n.onlySingleCell,"");b=Hr(_,A,u.flowdata),v.push({row:w[0].row,column:w[0].column}),y.push(b)}else if(w.length==0){if(isNaN(b)||b=="")return void e.infoDialog(n.conditionValueCanOnly,"");y.push(b)}var S=e.getRangeByTxt(k);if(S.length>1)return void e.infoDialog(n.onlySingleCell,"");if(S.length==1){var E=S[0].row[0],R=S[0].row[1],F=S[0].column[0],N=S[0].column[1];if(E!=R||F!=N)return void e.infoDialog(n.onlySingleCell,"");k=Hr(E,F,u.flowdata),v.push({row:S[0].row,column:S[0].column}),y.push(k)}else if(S.length==0){if(isNaN(k)||k=="")return void e.infoDialog(n.conditionValueCanOnly,"");y.push(k)}}else{var z=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),P=e.getRangeByTxt(z);if(P.length>1)return void e.infoDialog(n.onlySingleCell,"");if(P.length==1){var q=P[0].row[0],V=P[0].row[1],x=P[0].column[0],ee=P[0].column[1];if(q!=V||x!=ee)return void e.infoDialog(n.onlySingleCell,"");z=Hr(q,x,u.flowdata),v.push({row:P[0].row,column:P[0].column}),y.push(z)}else if(P.length==0){if(isNaN(z)||z=="")return void e.infoDialog(n.conditionValueCanOnly,"");y.push(z)}}else if(o=="text"){g="textContains";var ne=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),ae=e.getRangeByTxt(ne);if(ae.length>1)return void e.infoDialog(n.onlySingleCell,"");if(ae.length==1){var de=ae[0].row[0],ve=ae[0].row[1],U=ae[0].column[0],B=ae[0].column[1];if(de!=ve||U!=B)return void e.infoDialog(n.onlySingleCell,"");ne=Hr(de,U,u.flowdata),v.push({row:ae[0].row,column:ae[0].column}),y.push(ne)}else if(ae.length==0){if(ne=="")return void e.infoDialog(n.conditionValueCanOnly,"");y.push(ne)}}else if(o=="date"){g="occurrenceDate";var le=$("#luckysheet-newConditionRule-dialog #daterange-btn").val();if(le==""||le==null)return void e.infoDialog(n.pleaseSelectADate,"");y.push(le)}}else if(l==2){o=="top"?g=$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?"top10%":"top10":o=="last"&&(g=$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?"last10%":"last10");var Te=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(parseInt(Te)!=Te||parseInt(Te)<1||parseInt(Te)>1e3)return void e.infoDialog(n.pleaseEnterInteger,"");y.push(parseInt(Te))}else if(l==3)o=="AboveAverage"?(g="AboveAverage",y.push("AboveAverage")):o=="SubAverage"&&(g="SubAverage",y.push("SubAverage"));else if(l==4)g="duplicateValue",y.push(o);else if(l==5){g="formula";var ue=$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val().trim();if(ue=="")return void e.infoDialog("Condition value cannot be empty!","");y.push(ue)}t={textColor:$("#luckysheet-newConditionRule-dialog #checkTextColor").is(":checked")?$("#luckysheet-newConditionRule-dialog #textcolorshow").spectrum("get").toHexString():null,cellColor:$("#luckysheet-newConditionRule-dialog #checkCellColor").is(":checked")?$("#luckysheet-newConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():null},a={type:"default",cellrange:$.extend(!0,[],u.luckysheet_select_save),format:t,conditionName:g,conditionRange:v,conditionValue:y}}$("#luckysheet-newConditionRule-dialog").hide();var be=$(this).attr("data-source");if(be==0){$("#luckysheet-modal-dialog-mask").hide();var ye=$.extend(!0,[],u.luckysheetfile),ce=e.getHistoryRules(ye),Re=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save;Re.push(a),u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save=Re;var pe=$.extend(!0,[],u.luckysheetfile),me=e.getCurrentRules(pe);e.ref(ce,me),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,Re,{k:"luckysheet_conditionformat_save"})}else if(be==1){var re=e.fileClone[je(u.currentSheetIndex)].luckysheet_conditionformat_save?e.fileClone[je(u.currentSheetIndex)].luckysheet_conditionformat_save:[];re.push(a),e.fileClone[je(u.currentSheetIndex)].luckysheet_conditionformat_save=re,e.administerRuleDialog()}}}),$(document).off("click.CFnewConditionRuleClose").on("click.CFnewConditionRuleClose","#luckysheet-newConditionRule-dialog-close",function(){var t=$(this).attr("data-source");t==0&&$("#luckysheet-modal-dialog-mask").hide(),t==1&&$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-newConditionRule-dialog").hide(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFeditorConditionRule").on("click.CFeditorConditionRule","#editorConditionRule",function(){var t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(ro(t)){var a=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item"),l={sheetIndex:t,itemIndex:a,data:e.fileClone[je(t)].luckysheet_conditionformat_save[a]};e.editorRule=l,e.editorConditionRuleDialog()}}),$(document).off("click.CFeditorConditionRuleConfirm").on("click.CFeditorConditionRuleConfirm","#luckysheet-editorConditionRule-dialog-confirm",function(){var t,a,l=$("#luckysheet-editorConditionRule-dialog .ruleTypeItem.on").index(),o=$("#luckysheet-editorConditionRule-dialog #type1 option:selected").val(),d=$("#luckysheet-editorConditionRule-dialog ."+o+"Box #type2 option:selected").val(),s=e.editorRule.data.cellrange;if(l==0)if(o=="dataBar"){var h=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();d=="gradient"?t=[h,"#ffffff"]:d=="solid"&&(t=[h]),a={type:"dataBar",cellrange:s,format:t}}else if(o=="colorGradation"){var f=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),p=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),g=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();d=="threeColor"?t=[f,p,g]:d=="twoColor"&&(t=[f,g]),a={type:"colorGradation",cellrange:s,format:t}}else o=="icons"&&(a={type:"icons",cellrange:s,format:t={len:$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-len"),leftMin:$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),top:$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-top")}});else{var v="",y=[],b=[];if(l==1){if(o=="number")if(v=d,d=="betweenness"){var k=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),w=$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val().trim(),_=e.getRangeByTxt(k);if(_.length>1)return void e.infoDialog(n.onlySingleCell,"");if(_.length==1){var C=_[0].row[0],A=_[0].row[1],I=_[0].column[0],S=_[0].column[1];if(C!=A||I!=S)return void e.infoDialog(n.onlySingleCell,"");k=Hr(C,I,u.flowdata),y.push({row:_[0].row,column:_[0].column}),b.push(k)}else if(_.length==0){if(isNaN(k)||k=="")return void e.infoDialog(n.conditionValueCanOnly,"");b.push(k)}var E=e.getRangeByTxt(w);if(E.length>1)return void e.infoDialog(n.onlySingleCell,"");if(E.length==1){var R=E[0].row[0],F=E[0].row[1],N=E[0].column[0],z=E[0].column[1];if(R!=F||N!=z)return void e.infoDialog(n.onlySingleCell,"");w=Hr(R,N,u.flowdata),y.push({row:E[0].row,column:E[0].column}),b.push(w)}else if(E.length==0){if(isNaN(w)||w=="")return void e.infoDialog(n.conditionValueCanOnly,"");b.push(w)}}else{var P=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),q=e.getRangeByTxt(P);if(q.length>1)return void e.infoDialog(n.onlySingleCell,"");if(q.length==1){var V=q[0].row[0],x=q[0].row[1],ee=q[0].column[0],ne=q[0].column[1];if(V!=x||ee!=ne)return void e.infoDialog(n.onlySingleCell,"");P=Hr(V,ee,u.flowdata),y.push({row:q[0].row,column:q[0].column}),b.push(P)}else if(q.length==0){if(isNaN(P)||P=="")return void e.infoDialog(n.conditionValueCanOnly,"");b.push(P)}}else if(o=="text"){v="textContains";var ae=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),de=e.getRangeByTxt(ae);if(de.length>1)return void e.infoDialog(n.onlySingleCell,"");if(de.length==1){var ve=de[0].row[0],U=de[0].row[1],B=de[0].column[0],le=de[0].column[1];if(ve!=U||B!=le)return void e.infoDialog(n.onlySingleCell,"");ae=Hr(ve,B,u.flowdata),y.push({row:de[0].row,column:de[0].column}),b.push(ae)}else if(de.length==0){if(isNaN(ae)||ae=="")return void e.infoDialog(n.conditionValueCanOnly,"");b.push(ae)}}else if(o=="date"){v="occurrenceDate";var Te=$("#luckysheet-editorConditionRule-dialog #daterange-btn").val();if(Te==""||Te==null)return void e.infoDialog(n.pleaseSelectADate,"");b.push(Te)}}else if(l==2){o=="top"?v=$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?"top10%":"top10":o=="last"&&(v=$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?"last10%":"last10");var ue=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(parseInt(ue)!=ue||parseInt(ue)<1||parseInt(ue)>1e3)return void e.infoDialog(n.pleaseEnterInteger,"");b.push(ue)}else if(l==3)o=="AboveAverage"?(v="AboveAverage",b.push("AboveAverage")):o=="SubAverage"&&(v="SubAverage",b.push("SubAverage"));else if(l==4)v="duplicateValue",b.push(o);else if(l==5){v="formula";var be=$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val().trim();if(console.log(be),be=="")return void e.infoDialog("Condition value cannot be empty!","");b.push(be)}a={type:"default",cellrange:s,format:t={textColor:$("#luckysheet-editorConditionRule-dialog #checkTextColor").is(":checked")?$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("get").toHexString():null,cellColor:$("#luckysheet-editorConditionRule-dialog #checkCellColor").is(":checked")?$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():null},conditionName:v,conditionRange:y,conditionValue:b}}var ye=e.editorRule.sheetIndex,ce=e.editorRule.itemIndex;e.fileClone[je(ye)].luckysheet_conditionformat_save[ce]=a,$("#luckysheet-editorConditionRule-dialog").hide(),e.administerRuleDialog()}),$(document).off("click.CFeditorConditionRuleClose").on("click.CFeditorConditionRuleClose","#luckysheet-editorConditionRule-dialog-close",function(){$("#luckysheet-editorConditionRule-dialog").hide(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFnewEditorRuleItem").on("click.CFnewEditorRuleItem",".luckysheet-newEditorRule-dialog .ruleTypeItem",function(){$(this).addClass("on").siblings().removeClass("on");var t=$(this).index();$(this).parents(".luckysheet-newEditorRule-dialog").find(".ruleExplainBox").html(e.getRuleExplain(t)),e.colorSelectInit()}),$(document).off("change.CFnewEditorRuleType1").on("change.CFnewEditorRuleType1",".luckysheet-newEditorRule-dialog #type1",function(){var t=$(this).find("option:selected").val();t!="dataBar"&&t!="colorGradation"&&t!="icons"&&t!="number"&&t!="text"&&t!="date"||$(this).parents(".luckysheet-newEditorRule-dialog").find("."+t+"Box").show().siblings().hide(),t=="date"&&e.daterangeInit($(this).parents(".luckysheet-newEditorRule-dialog").attr("id"))}),$(document).off("change.CFnewEditorRuleType2").on("change.CFnewEditorRuleType2",".luckysheet-newEditorRule-dialog #type2",function(){var t=$(this).parents(".luckysheet-newEditorRule-dialog").find("#type1 option:selected").val();t=="colorGradation"?$(this).find("option:selected").val()=="threeColor"?$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").show():$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").hide():t=="number"&&($(this).find("option:selected").val()=="betweenness"?($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").show(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").show()):($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").hide(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").hide()))}),$(document).off("click.CFiconsShowbox").on("click.CFiconsShowbox",".luckysheet-newEditorRule-dialog .iconsBox .showbox",function(){$(this).parents(".iconsBox").find("ul").toggle()}),$(document).off("click.CFiconsLi").on("click.CFiconsLi",".luckysheet-newEditorRule-dialog .iconsBox li",function(){var t=$(this).find("div").attr("data-len"),a=$(this).find("div").attr("data-leftmin"),l=$(this).find("div").attr("data-top"),o=$(this).find("div").attr("title"),d=$(this).find("div").css("background-position");$(this).parents(".iconsBox").find(".showbox .model").css("background-position",d),$(this).parents(".iconsBox").find(".showbox .model").attr("data-len",t),$(this).parents(".iconsBox").find(".showbox .model").attr("data-leftmin",a),$(this).parents(".iconsBox").find(".showbox .model").attr("data-top",l),$(this).parents(".iconsBox").find(".showbox .model").attr("title",o),$(this).parents("ul").hide()}),$(document).off("click.CFdeleteConditionRule").on("click.CFdeleteConditionRule","#deleteConditionRule",function(){var t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(ro(t)){var a=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item");e.fileClone[je(t)].luckysheet_conditionformat_save.splice(a,1),e.administerRuleDialog()}}),$(document).off("click.CFdefault").on("click.CFdefault","#luckysheet-conditionformat-dialog-confirm",function(){if(ro(u.currentSheetIndex)){var t,a,l=$("#luckysheet-conditionformat-dialog .box").attr("data-itemvalue"),o=[],d=[];if(l=="greaterThan"||l=="lessThan"||l=="equal"||l=="textContains"){var s=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),h=e.getRangeByTxt(s);if(h.length>1)return void e.infoDialog(n.onlySingleCell,"");if(h.length==1){var f=h[0].row[0],p=h[0].row[1],g=h[0].column[0],v=h[0].column[1];if(f!=p||g!=v)return void e.infoDialog(n.onlySingleCell,"");s=Hr(f,g,u.flowdata),o.push({row:h[0].row,column:h[0].column}),d.push(s)}else if(h.length==0){if(isNaN(s)||s=="")return void e.infoDialog(n.conditionValueCanOnly,"");d.push(s)}}else if(l=="betweenness"){var y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),b=$("#luckysheet-conditionformat-dialog #conditionVal2").val().trim(),k=e.getRangeByTxt(y);if(k.length>1)return void e.infoDialog(n.onlySingleCell,"");if(k.length==1){var w=k[0].row[0],_=k[0].row[1],C=k[0].column[0],A=k[0].column[1];if(w!=_||C!=A)return void e.infoDialog(n.onlySingleCell,"");y=Hr(w,C,u.flowdata),o.push({row:k[0].row,column:k[0].column}),d.push(y)}else if(k.length==0){if(isNaN(y)||y=="")return void e.infoDialog(n.conditionValueCanOnly,"");d.push(y)}var I=e.getRangeByTxt(b);if(I.length>1)return void e.infoDialog(n.onlySingleCell,"");if(I.length==1){var S=I[0].row[0],E=I[0].row[1],R=I[0].column[0],F=I[0].column[1];if(S!=E||R!=F)return void e.infoDialog(n.onlySingleCell,"");b=Hr(S,R,u.flowdata),o.push({row:I[0].row,column:I[0].column}),d.push(b)}else if(I.length==0){if(isNaN(b)||b=="")return void e.infoDialog(n.conditionValueCanOnly,"");d.push(b)}}else if(l=="occurrenceDate"){var N=$("#luckysheet-conditionformat-dialog #daterange-btn").val();if(N==""||N==null)return void e.infoDialog(n.pleaseSelectADate,"");d.push(N)}else if(l=="duplicateValue")d.push($("#luckysheet-conditionformat-dialog #conditionVal option:selected").val());else if(l=="top10"||l=="top10%"||l=="last10"||l=="last10%"){var z=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim();if(parseInt(z)!=z||parseInt(z)<1||parseInt(z)>1e3)return void e.infoDialog(n.pleaseEnterInteger,"");d.push(z)}else l=="AboveAverage"?d.push("AboveAverage"):l=="SubAverage"&&d.push("SubAverage");t=$("#checkTextColor").is(":checked")?$("#textcolorshow").spectrum("get").toHexString():null,a=$("#checkCellColor").is(":checked")?$("#cellcolorshow").spectrum("get").toHexString():null;var P=$.extend(!0,[],u.luckysheetfile),q=e.getHistoryRules(P),V={type:"default",cellrange:$.extend(!0,[],u.luckysheet_select_save),format:{textColor:t,cellColor:a},conditionName:l,conditionRange:o,conditionValue:d},x=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save;x.push(V),u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save=x;var ee=$.extend(!0,[],u.luckysheetfile),ne=e.getCurrentRules(ee);e.ref(q,ne),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-conditionformat-dialog").hide(),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,x,{k:"luckysheet_conditionformat_save"})}}),$(document).off("click.CFicons").on("click.CFicons","#luckysheet-CFicons-dialog .item",function(){if($("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-CFicons-dialog").hide(),u.luckysheet_select_save.length>0){var t=$.extend(!0,[],u.luckysheet_select_save),a={len:$(this).attr("data-len"),leftMin:$(this).attr("data-leftMin"),top:$(this).attr("data-top")};e.updateItem("icons",t,a)}}),$(document).on("click",".range .fa-table",function(){var t,a=$(this).parents(".luckysheet-modal-dialog").attr("id");if($("#"+a).hide(),a=="luckysheet-conditionformat-dialog")t=$(this).siblings("input").attr("id")=="conditionVal"?"0_1":"0_2";else if(a=="luckysheet-newConditionRule-dialog"){var l=$(this).parents(".range").attr("id");t=l=="formulaConditionVal"?"1_0":l=="conditionVal"?"1_1":"1_2"}else if(a=="luckysheet-editorConditionRule-dialog"){var o=$(this).parents(".range").attr("id");t=o=="formulaConditionVal"?"2_0":o=="conditionVal"?"2_1":"2_2"}var d=$(this).siblings("input").val();e.singleRangeDialog(t,d),pn(e.getRangeByTxt(d))}),$(document).on("click","#luckysheet-singleRange-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();var t=$(this).attr("data-source"),a=$(this).parents("#luckysheet-singleRange-dialog").find("input").val();t=="0_1"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal").val(a)):t=="0_2"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal2").val(a)):t=="1_0"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val(a)):t=="1_1"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal input").val(a)):t=="1_2"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val(a)):t=="2_0"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(a)):t=="2_1"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal input").val(a)):t=="2_2"&&($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val(a)),pn([])}),$(document).on("click","#luckysheet-singleRange-dialog-close",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();var t=$(this).attr("data-source");t=="0_1"||t=="0_2"?$("#luckysheet-conditionformat-dialog").show():t=="1_0"||t=="1_1"||t=="1_2"?$("#luckysheet-newConditionRule-dialog").show():t!="2_0"&&t!="2_1"&&t!="2_2"||$("#luckysheet-editorConditionRule-dialog").show(),pn([])}),$(document).on("click",".luckysheet-modal-dialog-title-close",function(){var t=$(this).parents(".luckysheet-modal-dialog").attr("id");if(t=="luckysheet-newConditionRule-dialog"&&$("#"+t).find("#luckysheet-newConditionRule-dialog-close").attr("data-source")==1&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-editorConditionRule-dialog"&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-singleRange-dialog"){$("#luckysheet-modal-dialog-mask").show();var a=$(this).parents("#luckysheet-singleRange-dialog").find("#luckysheet-singleRange-dialog-confirm").attr("data-source");a=="0_1"||a=="0_2"?$("#luckysheet-conditionformat-dialog").show():a=="1_1"||a=="1_2"?$("#luckysheet-newConditionRule-dialog").show():a!="2_1"&&a!="2_2"||$("#luckysheet-editorConditionRule-dialog").show(),pn([])}t=="luckysheet-multiRange-dialog"&&($("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),pn([])),t=="luckysheet-conditionformat-info-dialog"&&$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-conditionformat-info-dialog-close",function(){$(this).parents("#luckysheet-conditionformat-info-dialog").hide()})},singleRangeDialog:function(e,n){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-singleRange-dialog").remove();var t=st().conditionformat;$("body").append(br(Ga,{id:"luckysheet-singleRange-dialog",addclass:"luckysheet-singleRange-dialog",title:t.selectCell,content:'<input readonly="readonly" placeholder="'.concat(t.pleaseSelectCell,'" value="').concat(n,'"/>'),botton:'<button id="luckysheet-singleRange-dialog-confirm" class="btn btn-primary" data-source="'.concat(e,'">').concat(t.confirm,`</button>
                        <button id="luckysheet-singleRange-dialog-close" class="btn btn-default" data-source="`).concat(e,'">').concat(t.cancel,"</button>"),style:"z-index:100003"}));var a=$("#luckysheet-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=a.outerHeight(),o=a.outerWidth(),d=$(window).width(),s=$(window).height(),h=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-singleRange-dialog").css({left:(d+h-o)/2,top:(s+f-l)/3}).show()},multiRangeDialog:function(e,n){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-multiRange-dialog").remove();var t=st().conditionformat;$("body").append(br(Ga,{id:"luckysheet-multiRange-dialog",addclass:"luckysheet-multiRange-dialog",title:t.selectRange,content:'<input readonly="readonly" placeholder="'.concat(t.pleaseSelectRange,'" value="').concat(n,'"/>'),botton:'<button id="luckysheet-multiRange-dialog-confirm" class="btn btn-primary" data-item="'.concat(e,'">').concat(t.confirm,`</button>
                        <button id="luckysheet-multiRange-dialog-close" class="btn btn-default">`).concat(t.cancel,"</button>"),style:"z-index:100003"}));var a=$("#luckysheet-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=a.outerHeight(),o=a.outerWidth(),d=$(window).width(),s=$(window).height(),h=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-multiRange-dialog").css({left:(d+h-o)/2,top:(s+f-l)/3}).show(),pn(this.getRangeByTxt(n))},getTxtByRange:function(e){if(e.length>0){for(var n=[],t=0;t<e.length;t++){var a=e[t].row[0],l=e[t].row[1],o=e[t].column[0],d=e[t].column[1];n.push(wn(u.currentSheetIndex,{row:[a,l],column:[o,d]},u.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){var n=[];if((e=e.toString()).indexOf(",")!=-1)for(var t=e.split(","),a=0;a<t.length;a++){if(!m.iscelldata(t[a])){n=[];break}n.push(m.getcellrange(t[a]))}else m.iscelldata(e)&&n.push(m.getcellrange(e));return n},colorSelectInit:function(){var e=st().conditionformat;$(".luckysheet-conditionformat-config-color").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:e.cancel,chooseText:e.confirmColor,togglePaletteMoreText:"",togglePaletteLessText:"",togglePaletteOnly:!0,clearText:e.clearColorSelect,noColorSelectedText:"",localStorageKey:"spectrum.textcolor"+nt.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(n){n!=null&&(n=n.toHexString())}})},conditionformatDialog:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-dialog").remove();var t=st().conditionformat;$("body").append(br(Ga,{id:"luckysheet-conditionformat-dialog",addclass:"luckysheet-conditionformat-dialog",title:e,content:n,botton:'<button id="luckysheet-conditionformat-dialog-confirm" class="btn btn-primary">'.concat(t.confirm,`</button>
                        <button class="btn btn-default luckysheet-model-close-btn">`).concat(t.cancel,"</button>"),style:"z-index:9999"}));var a=$("#luckysheet-conditionformat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=a.outerHeight(),o=a.outerWidth(),d=$(window).width(),s=$(window).height(),h=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-conditionformat-dialog").css({left:(d+h-o)/2,top:(s+f-l)/3}).show(),this.init(),this.colorSelectInit(),e==st().conditionformat.conditionformat_occurrenceDate&&this.daterangeInit("luckysheet-conditionformat-dialog")},CFiconsDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-CFicons-dialog").remove();var e=st().conditionformat,n=`<div class="box">
                            <div style="margin-bottom: 10px;">`.concat(e.pleaseSelectIcon,`</div>
                            <div class="title">`).concat(e.direction,`</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="0" title="`).concat(e.threeWayArrow,"(").concat(e.multicolor,`)"><div style="background-position:0 0;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="1" title="`).concat(e.threeTriangles,`"><div style="background-position:0 -20px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="2" title="`).concat(e.fourWayArrow,"(").concat(e.multicolor,`)"><div style="background-position:0 -40px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="3" title="`).concat(e.fiveWayArrow,"(").concat(e.multicolor,`)"><div style="background-position:0 -60px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="0" title="`).concat(e.threeWayArrow,"(").concat(e.grayColor,`)"><div style="background-position:-131px 0;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="1" title="`).concat(e.fourWayArrow,"(").concat(e.grayColor,`)"><div style="background-position:-131px -20px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="2" title="`).concat(e.fiveWayArrow,"(").concat(e.grayColor,`)"><div style="background-position:-131px -40px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">`).concat(e.shape,`</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="4" title="`).concat(e.threeColorTrafficLight,"(").concat(e.rimless,`)"><div style="background-position:0 -80px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="5" title="`).concat(e.threeSigns,`"><div style="background-position:0 -100px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="6" title="`).concat(e.greenRedBlackGradient,`"><div style="background-position:0 -120px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="4" title="`).concat(e.threeColorTrafficLight,"(").concat(e.bordered,`)"><div style="background-position:-131px -80px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="5" title="`).concat(e.fourColorTrafficLight,`"><div style="background-position:-131px -100px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">`).concat(e.mark,`</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="7" title="`).concat(e.threeSymbols,"(").concat(e.circled,`)"><div style="background-position:0 -140px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="8" title="`).concat(e.tricolorFlag,`"><div style="background-position:0 -160px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="7" title="`).concat(e.threeSymbols,"(").concat(e.noCircle,`)"><div style="background-position:-131px -140px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">`).concat(e.grade,`</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="9" title="`).concat(e.threeStars,`"><div style="background-position:0 -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="10" title="`).concat(e.fiveQuadrantDiagram,`"><div style="background-position:0 -200px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="11" title="`).concat(e.fiveBoxes,`"><div style="background-position:0 -220px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="4" data-leftMin="5" data-top="9" title="`).concat(e.grade4,`"><div style="background-position:-131px -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="10" title="`).concat(e.grade5,`"><div style="background-position:-131px -200px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                        </div>`);$("body").append(br(Ga,{id:"luckysheet-CFicons-dialog",addclass:"luckysheet-CFicons-dialog",title:e.icons,content:n,botton:'<button class="btn btn-default luckysheet-model-close-btn">'.concat(e.close,"</button>"),style:"z-index:100003"}));var t=$("#luckysheet-CFicons-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=t.outerHeight(),l=t.outerWidth(),o=$(window).width(),d=$(window).height(),s=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-CFicons-dialog").css({left:(o+s-l)/2,top:(d+h-a)/3}).show()},administerRuleDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").remove();for(var e=st().conditionformat,n="",t=0;t<u.luckysheetfile.length;t++)u.luckysheetfile[t].status=="1"?n+='<option value="'.concat(u.luckysheetfile[t].index,`" selected="selected">
                                `).concat(e.currentSheet,"").concat(u.luckysheetfile[t].name,`
                            </option>`):n+='<option value="'.concat(u.luckysheetfile[t].index,`">
                                `).concat(e.sheet,"").concat(u.luckysheetfile[t].name,`
                            </option>`);var a=`<div class="chooseSheet">
                            <label>`.concat(e.showRules,`</label>
                            <select>`).concat(n,`</select>
                        </div>
                        <div class="ruleBox">
                            <div class="ruleBtn">
                                <button id="newConditionRule" class="btn btn-default">`).concat(e.newRule,`</button>
                                <button id="editorConditionRule" class="btn btn-default">`).concat(e.editRule,`</button>
                                <button id="deleteConditionRule" class="btn btn-default">`).concat(e.deleteRule,`</button>
                            </div>
                            <div class="ruleList">
                                <div class="listTitle">
                                    <span>`).concat(e.rule,`</span>
                                    <span>`).concat(e.format,`</span>
                                    <span>`).concat(e.applyRange,`</span>
                                </div>
                                <div class="listBox"></div>
                            </div>
                        </div>`);$("body").append(br(Ga,{id:"luckysheet-administerRule-dialog",addclass:"luckysheet-administerRule-dialog",title:e.conditionformatManageRules,content:a,botton:'<button id="luckysheet-administerRule-dialog-confirm" class="btn btn-primary">'.concat(e.confirm,`</button>
                        <button id="luckysheet-administerRule-dialog-close" class="btn btn-default">`).concat(e.close,"</button>"),style:"z-index:100003"}));var l=$("#luckysheet-administerRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-administerRule-dialog").css({left:(s+f-d)/2,top:(h+p-o)/3}).show();var g=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();this.getConditionRuleList(g)},getConditionRuleList:function(e){$("#luckysheet-administerRule-dialog .ruleList .listBox").empty();var n=this.fileClone[je(e)].luckysheet_conditionformat_save;if(n!=null&&n.length>0){for(var t=st().conditionformat,a=0;a<n.length;a++){var l=n[a].type,o=n[a].format,d=n[a].cellrange,s=void 0,h="";l=="dataBar"?(s=t.dataBar,h='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):l=="colorGradation"?(s=t.colorGradation,h='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):l=="icons"?(s=t.icons,h='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):(s=this.getConditionRuleName(n[a].conditionName,n[a].conditionRange,n[a].conditionValue),o.textColor!=null&&(h+='<span class="colorbox" title="'+t.textColor+'" style="background-color:'+o.textColor+'"></span>'),o.cellColor!=null&&(h+='<span class="colorbox" title="'+t.cellColor+'" style="background-color:'+o.cellColor+'"></span>'));for(var f=[],p=0;p<d.length;p++){var g=d[p].row[0],v=d[p].row[1],y=d[p].column[0],b=d[p].column[1];f.push(ya(y)+(g+1)+":"+ya(b)+(v+1))}var k='<div class="item" data-item="'+a+'"><div class="ruleName" title="'+s+'">'+s+'</div><div class="format">'+h+'</div><div class="ruleRange"><input class="formulaInputFocus" readonly="true" value="'+f.join(",")+'"/><i class="fa fa-table" aria-hidden="true" title="'+t.selectRange+'"></i></div></div>';$("#luckysheet-administerRule-dialog .ruleList .listBox").prepend(k)}$("#luckysheet-administerRule-dialog .ruleList .listBox .item canvas").each(function(w){var _=$(this).closest(".item").attr("data-item"),C=n[_].type,A=n[_].format,I=$(this).get(0).getContext("2d");if(C=="dataBar")if(A.length==2){var S=I.createLinearGradient(0,0,46,0);S.addColorStop(0,A[0]),S.addColorStop(1,A[1]),I.fillStyle=S,I.fillRect(0,0,46,18),I.beginPath(),I.moveTo(0,0),I.lineTo(0,18),I.lineTo(46,18),I.lineTo(46,0),I.lineTo(0,0),I.lineWidth=u.devicePixelRatio,I.strokeStyle=A[0],I.stroke(),I.closePath()}else A.length==1&&(I.fillStyle=A[0],I.fillRect(0,0,46,18),I.beginPath(),I.moveTo(0,0),I.lineTo(0,18),I.lineTo(46,18),I.lineTo(46,0),I.lineTo(0,0),I.lineWidth=u.devicePixelRatio,I.strokeStyle=A[0],I.stroke(),I.closePath());else if(C=="colorGradation"){var E=I.createLinearGradient(0,0,46,0);A.length==3?(E.addColorStop(0,A[0]),E.addColorStop(.5,A[1]),E.addColorStop(1,A[2])):A.length==2&&(E.addColorStop(0,A[0]),E.addColorStop(1,A[1])),I.fillStyle=E,I.fillRect(0,0,46,18)}else if(C=="icons"){var R=A.len,F=A.leftMin,N=A.top,z=32*R+10*(R-1),P=1472/z;F=="0"?I.drawImage(td,0,32*N,z,32,0,(18-P)/2,46,P):F=="5"&&I.drawImage(td,210,32*N,z,32,0,(18-P)/2,46,P)}}),$("#luckysheet-administerRule-dialog .ruleList .listBox .item").eq(0).addClass("on")}},getConditionRuleName:function(e,n,t){var a;a=n[0]!=null?ya(n[0].column[0])+(n[0].row[0]+1):t[0];var l,o=st().conditionformat;if(e=="greaterThan")return o.cellValue+" > "+a;if(e=="lessThan")return o.cellValue+" < "+a;if(e=="betweenness")return l=n[1]!=null?ya(n[1].column[0])+(n[1].row[0]+1):t[1],o.cellValue+" "+o.between+" "+a+" "+o.in+" "+l+" "+o.between2;if(e=="equal")return o.cellValue+" = "+a;if(e=="textContains")return o.cellValue+o.contain+" ="+a;if(e=="occurrenceDate")return t;if(e=="duplicateValue"){if(t=="0")return o.duplicateValue;if(t=="1")return o.uniqueValue}else{if(e=="top10")return o.top+" "+a+" "+o.oneself;if(e=="top10%")return o.top+" "+a+"% "+o.oneself;if(e=="last10")return o.last+" "+a+" "+o.oneself;if(e=="last10%")return o.last+" "+a+"% "+o.oneself;if(e=="AboveAverage")return o.aboveAverage;if(e=="SubAverage")return o.belowAverage;if(e=="formula")return a.slice(0,1)!="="&&(a="="+a),o.formula+": "+a}},newConditionRuleDialog:function(e){var n=st().conditionformat,t=this.getRuleExplain(0);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-newConditionRule-dialog").remove();var a='<div><div class="boxTitle">'+n.chooseRuleType+"</div>"+this.ruleTypeHtml()+'<div class="boxTitle">'+n.editRuleDescription+'</div><div class="ruleExplainBox">'+t+"</div></div>";$("body").append(br(Ga,{id:"luckysheet-newConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:n.newFormatRule,content:a,botton:'<button id="luckysheet-newConditionRule-dialog-confirm" class="btn btn-primary" data-source="'.concat(e,'">').concat(n.confirm,`</button>
                        <button id="luckysheet-newConditionRule-dialog-close" class="btn btn-default" data-source="`).concat(e,'">').concat(n.cancel,"</button>"),style:"z-index:100003"}));var l=$("#luckysheet-newConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-newConditionRule-dialog").css({left:(s+f-d)/2,top:(h+p-o)/3}).show(),$("#luckysheet-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)").addClass("on").siblings().removeClass("on"),this.colorSelectInit()},editorConditionRuleDialog:function(){var e=st().conditionformat,n=this.editorRule.data;if(n!=null){var t,a,l=n.type,o=n.format,d=n.conditionName;l=="dataBar"||l=="colorGradation"||l=="icons"?(t=0,a=l):d=="greaterThan"||d=="lessThan"||d=="betweenness"||d=="equal"||d=="textContains"||d=="occurrenceDate"?(t=1,d=="greaterThan"||d=="lessThan"||d=="betweenness"||d=="equal"?a="number":d=="textContains"?a="text":d=="occurrenceDate"&&(a="date")):d=="top10"||d=="top10%"||d=="last10"||d=="last10%"?(t=2,d=="top10"||d=="top10%"?a="top":d!="last10"&&d!="last10%"||(a="last")):d=="AboveAverage"||d=="SubAverage"?(t=3,a=d):d=="duplicateValue"?(t=4,a=n.conditionValue):d=="formula"&&(t=5);var s=this.getRuleExplain(t);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-editorConditionRule-dialog").remove();var h='<div><div class="boxTitle">'+e.chooseRuleType+"</div>"+this.ruleTypeHtml()+'<div class="boxTitle">'+e.editRuleDescription+'</div><div class="ruleExplainBox">'+s+"</div></div>";$("body").append(br(Ga,{id:"luckysheet-editorConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:e.editFormatRule,content:h,botton:'<button id="luckysheet-editorConditionRule-dialog-confirm" class="btn btn-primary">'.concat(e.confirm,`</button>
                        <button id="luckysheet-editorConditionRule-dialog-close" class="btn btn-default">`).concat(e.cancel,"</button>"),style:"z-index:100003"}));var f=$("#luckysheet-editorConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),p=f.outerHeight(),g=f.outerWidth(),v=$(window).width(),y=$(window).height(),b=$(document).scrollLeft(),k=$(document).scrollTop();if($("#luckysheet-editorConditionRule-dialog").css({left:(v+b-g)/2,top:(y+k-p)/3}).show(),this.colorSelectInit(),$("#luckysheet-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq("+t+")").addClass("on").siblings().removeClass("on"),$("#luckysheet-editorConditionRule-dialog #type1").val(a),a!="dataBar"&&a!="colorGradation"&&a!="icons"&&a!="number"&&a!="text"&&a!="date"||($("#luckysheet-editorConditionRule-dialog ."+a+"Box").show(),$("#luckysheet-editorConditionRule-dialog ."+a+"Box").siblings().hide()),a=="date"&&this.daterangeInit("luckysheet-editorConditionRule-dialog"),l=="dataBar"||l=="colorGradation"||l=="icons"){if(a=="dataBar")o.length==2?$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("gradient"):o.length==1&&$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("solid"),$("#luckysheet-editorConditionRule-dialog .dataBarBox .luckysheet-conditionformat-config-color").spectrum("set",o[0]);else if(a=="colorGradation")o.length==3?($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("threeColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").show(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[2])):o.length==2&&($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("twoColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").hide(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]));else if(a=="icons"){var w=o.len,_=o.leftMin,C=o.top;$("#luckysheet-editorConditionRule-dialog .iconsBox li").each(function(F,N){if($(N).find("div").attr("data-len")==w&&$(N).find("div").attr("data-leftmin")==_&&$(N).find("div").attr("data-top")==C)return $("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").css("background-position",$(N).find("div").css("background-position")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-len",$(N).find("div").attr("data-len")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-leftmin",$(N).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-top",$(N).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("title",$(N).find("div").attr("title")),!0})}}else{var A,I;if(a=="number")$("#luckysheet-editorConditionRule-dialog .numberBox #type2").val(d),A=n.conditionRange[0]!=null?wn(u.currentSheetIndex,{row:n.conditionRange[0].row,column:n.conditionRange[0].column},u.currentSheetIndex):n.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal input").val(A),d=="betweenness"?($("#luckysheet-editorConditionRule-dialog .numberBox .txt").show(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").show(),I=n.conditionRange[1]!=null?wn(u.currentSheetIndex,{row:n.conditionRange[1].row,column:n.conditionRange[1].column},u.currentSheetIndex):n.conditionValue[1],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2 input").val(I)):($("#luckysheet-editorConditionRule-dialog .numberBox .txt").hide(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").hide());else if(a=="text"){var S;S=n.conditionRange[0]!=null?wn(u.currentSheetIndex,{row:n.conditionRange[0].row,column:n.conditionRange[0].column},u.currentSheetIndex):n.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .textBox #conditionVal input").val(S)}else if(a=="date"){this.daterangeInit("luckysheet-editorConditionRule-dialog");var E=n.conditionValue[0];$("#luckysheet-editorConditionRule-dialog .dateBox #daterange-btn").val(E)}else if(a=="top"||a=="last")n.conditionValue[0],d!="top10%"&&d!="last10%"||$("#luckysheet-editorConditionRule-dialog #isPercent").attr("checked","checked");else if(d=="formula"){var R=n.conditionValue[0];$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(R)}$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("set",o.textColor),$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("set",o.cellColor)}}},infoDialog:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-info-dialog").remove(),$("body").append(br(Ga,{id:"luckysheet-conditionformat-info-dialog",addclass:"",title:e,content:n,botton:'<button id="luckysheet-conditionformat-info-dialog-close" class="btn btn-default">'.concat(st().conditionformat.close,"</button>"),style:"z-index:100003"}));var t=$("#luckysheet-conditionformat-info-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=t.outerHeight(),l=t.outerWidth(),o=$(window).width(),d=$(window).height(),s=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-conditionformat-info-dialog").css({left:(o+s-l)/2,top:(d+h-a)/3}).show()},getRuleExplain:function(e){var n,t=st().conditionformat,a=this.textCellColorHtml();switch(e){case 0:n='<div class="title">'.concat(t.ruleTypeItem1,`</div>
                                    <div style="height: 30px;margin-bottom: 5px;">
                                        <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.formatStyle,`</label>
                                        <select id="type1">
                                            <option value="dataBar">`).concat(t.dataBar,`</option>
                                            <option value="colorGradation">`).concat(t.colorGradation,`</option>
                                            <option value="icons">`).concat(t.icons,`</option>
                                        </select>
                                    </div>
                                    <div>
                                        <div class="type1Box dataBarBox">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.fillType,`</label>
                                                <select id="type2">
                                                    <option value="gradient">`).concat(t.gradient,`</option>
                                                    <option value="solid">`).concat(t.solid,`</option>
                                                </select>
                                            </div>
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.color,`</label>
                                                <input data-tips="`).concat(t.dataBarColor,`" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#638ec6" style="display: none;"> 
                                            </div>
                                        </div>
                                        <div class="type1Box colorGradationBox" style="display: none;">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.fillType,`</label>
                                                <select id="type2">
                                                    <option value="threeColor">`).concat(t.tricolor,`</option>
                                                    <option value="twoColor">`).concat(t.twocolor,`</option>
                                                </select>
                                            </div>
                                            <div class="maxVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.maxValue,`</label>
                                                <input data-tips="`).concat(t.maxValue," ").concat(t.color,`" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(99, 190, 123)" style="display: none;">
                                            </div>
                                            <div class="midVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.medianValue,`</label>
                                                <input data-tips="`).concat(t.medianValue," ").concat(t.color,`" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(255, 235, 132)" style="display: none;">
                                            </div>
                                            <div class="minVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">`).concat(t.minValue,`</label>
                                                <input data-tips="`).concat(t.minValue," ").concat(t.color,`" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(248, 105, 107)" style="display: none;">
                                            </div>
                                        </div>
                                        <div class="type1Box iconsBox" style="display: none;">
                                            <label>`).concat(t.fillType,`</label>
                                            <div class="showbox">
                                                <div class="model" data-len="3" data-leftmin="0" data-top="0" title="`).concat(t.threeWayArrow,"(").concat(t.multicolor,`)" style="background-position: 0 0;"></div>
                                                <span class="ui-selectmenu-icon ui-icon ui-icon-triangle-1-s" style="margin-top: 2px;"></span>
                                            </div>
                                            <ul>
                                                <li><div data-len="3" data-leftmin="0" data-top="0" title="`).concat(t.threeWayArrow,"(").concat(t.multicolor,`)" style="background-position: 0 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="0" title="`).concat(t.threeWayArrow,"(").concat(t.grayColor,`)" style="background-position: -131px 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="1" title="`).concat(t.threeTriangles,`" style="background-position: 0 -20px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="2" title="`).concat(t.fourWayArrow,"(").concat(t.multicolor,`)" style="background-position: 0 -40px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="1" title="`).concat(t.fourWayArrow,"(").concat(t.grayColor,`)" style="background-position: -131px -20px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="3" title="`).concat(t.fiveWayArrow,"(").concat(t.multicolor,`)" style="background-position: 0 -60px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="2" title="`).concat(t.fiveWayArrow,"(").concat(t.grayColor,`)" style="background-position: -131px -40px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="4" title="`).concat(t.threeColorTrafficLight,"(").concat(t.rimless,`)" style="background-position: 0 -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="4" title="`).concat(t.threeColorTrafficLight,"(").concat(t.bordered,`)" style="background-position: -131px -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="5" title="`).concat(t.threeSigns,`" style="background-position: 0 -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="5" title="`).concat(t.fourColorTrafficLight,`" style="background-position: -131px -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="6" title="`).concat(t.greenRedBlackGradient,`" style="background-position: 0 -120px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="7" title="`).concat(t.threeSymbols,"(").concat(t.circled,`)" style="background-position: 0 -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="7" title="`).concat(t.threeSymbols,"(").concat(t.noCircle,`)" style="background-position: -131px -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="8" title="`).concat(t.tricolorFlag,`" style="background-position: 0 -160px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="9" title="`).concat(t.threeStars,`" style="background-position: 0 -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="10" title="`).concat(t.fiveQuadrantDiagram,`" style="background-position: 0 -200px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="11" title="`).concat(t.fiveBoxes,`" style="background-position: 0 -220px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="9" title="`).concat(t.grade4,`" style="background-position: -131px -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="10" title="`).concat(t.grade5,`" style="background-position: -131px -200px;"></div></li>
                                            </ul>
                                        </div>
                                    </div>`);break;case 1:n='<div class="title">'.concat(t.ruleTypeItem2_title,`</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="number">`).concat(t.cellValue,`</option>
                                            <option value="text">`).concat(t.specificText,`</option>
                                            <option value="date">`).concat(t.occurrence,`</option>
                                        </select>
                                        <div>
                                            <div class="type1Box numberBox">
                                                <select id="type2">
                                                    <option value="greaterThan">`).concat(t.greaterThan,`</option>
                                                    <option value="lessThan">`).concat(t.lessThan,`</option>
                                                    <option value="betweenness">`).concat(t.between,`</option>
                                                    <option value="equal">`).concat(t.equal,`</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(t.selectCell,`"></i>
                                                </div>
                                                <span class="txt" style="display: none;">`).concat(t.in,`</span>
                                                <div class="inpbox range" id="conditionVal2" style="display: none;">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(t.selectDataRange,`"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box textBox" style="display: none;">
                                                <select id="type2">
                                                    <option value="">`).concat(t.contain,`</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(t.selectCell,`"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box dateBox" style="display: none;">
                                                <div style="width: 162px;" class="inpbox">
                                                    <input style="width: 150px;" id="daterange-btn" readonly="readonly" placeholder="`).concat(t.pleaseSelectADate,`"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="title">`).concat(t.setFormat,": </div>").concat(a);break;case 2:n='<div class="title">'.concat(t.ruleTypeItem3_title,`</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="top">`).concat(t.top,`</option>
                                            <option value="last">`).concat(t.last,`</option>
                                        </select>
                                        <div class="inpbox" id="conditionVal">
                                            <input class="formulaInputFocus" type="number" value="10"/>
                                        </div>
                                        <input id="isPercent" type="checkbox"/>
                                        <label for="isPercent" class="txt">`).concat(t.selectRange_percent,`</label>
                                    </div>
                                    <div class="title">`).concat(t.setFormat,"</div>").concat(a);break;case 3:n='<div class="title">'.concat(t.ruleTypeItem4_title,`</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="AboveAverage">`).concat(t.above,`</option>
                                            <option value="SubAverage">`).concat(t.below,`</option>
                                        </select>
                                        <span class="txt">`).concat(t.selectRange_average,`</span>
                                    </div>
                                    <div class="title">`).concat(t.setFormat,"</div>").concat(a);break;case 4:n='<div class="title">'.concat(t.all,`</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="0">`).concat(t.duplicateValue,`</option>
                                            <option value="1">`).concat(t.uniqueValue,`</option>
                                        </select>
                                        <span class="txt">`).concat(t.selectRange_value,`</span>
                                    </div>
                                    <div class="title">`).concat(t.setFormat,"</div>").concat(a);break;case 5:n='<div class="title">'.concat(t.ruleTypeItem2_title,`</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <div class="inpbox range" id="formulaConditionVal" style="width: 250px;">
                                            <input class="formulaInputFocus" style="width: 200px;"/>
                                            <i class="fa fa-table" aria-hidden="true" title="`).concat(t.selectCell,`"></i>
                                        </div>
                                    </div>
                                    <div class="title">`).concat(t.setFormat,": </div>").concat(a)}return n},daterangeInit:function(e){var n=st().conditionformat;$(".ranges_1 ul").remove(),$("#"+e).find("#daterange-btn").flatpickr({mode:"range",onChange:function(t,a){var l=a0(t,2),o=l[0],d=l[1],s=[n.yesterday,n.today],h=[n.lastWeek,n.thisWeek,n.lastMonth,n.thisMonth,n.lastYear,n.thisYear,n.last7days,n.last30days];a==n.all?$("#daterange-btn").val(""):s.indexOf(a)>-1?$("#daterange-btn").val(Q(o).format("YYYY/MM/DD")):h.indexOf(a)>-1&&$("#daterange-btn").val(Q(o).format("YYYY/MM/DD")+"-"+Q(d).format("YYYY/MM/DD"))}})},CFSplitRange:function(e,n,t,a){var l=[],o=t.row[0]-n.row[0],d=t.column[0]-n.column[0],s=e.row[0],h=e.row[1],f=e.column[0],p=e.column[1];return s>=n.row[0]&&h<=n.row[1]&&f>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[s+o,h+o],column:[f+d,p+d]}]:a=="restPart"?l=[]:a=="operatePart"&&(l=[{row:[s+o,h+o],column:[f+d,p+d]}]):s>=n.row[0]&&s<=n.row[1]&&f>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[n.row[1]+1,h],column:[f,p]},{row:[s+o,n.row[1]+o],column:[f+d,p+d]}]:a=="restPart"?l=[{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[s+o,n.row[1]+o],column:[f+d,p+d]}]):h>=n.row[0]&&h<=n.row[1]&&f>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0]+o,h+o],column:[f+d,p+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,h+o],column:[f+d,p+d]}]):s<n.row[0]&&h>n.row[1]&&f>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[1]+1,h],column:[f,p]},{row:[n.row[0]+o,n.row[1]+o],column:[f+d,p+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,n.row[1]+o],column:[f+d,p+d]}]):f>=n.column[0]&&f<=n.column[1]&&s>=n.row[0]&&h<=n.row[1]?a=="allPart"?l=[{row:[s,h],column:[n.column[1]+1,p]},{row:[s+o,h+o],column:[f+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,h],column:[n.column[1]+1,p]}]:a=="operatePart"&&(l=[{row:[s+o,h+o],column:[f+d,n.column[1]+d]}]):p>=n.column[0]&&p<=n.column[1]&&s>=n.row[0]&&h<=n.row[1]?a=="allPart"?l=[{row:[s,h],column:[f,n.column[0]-1]},{row:[s+o,h+o],column:[n.column[0]+d,p+d]}]:a=="restPart"?l=[{row:[s,h],column:[f,n.column[0]-1]}]:a=="operatePart"&&(l=[{row:[s+o,h+o],column:[n.column[0]+d,p+d]}]):f<n.column[0]&&p>n.column[1]&&s>=n.row[0]&&h<=n.row[1]?a=="allPart"?l=[{row:[s,h],column:[f,n.column[0]-1]},{row:[s,h],column:[n.column[1]+1,p]},{row:[s+o,h+o],column:[n.column[0]+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,h],column:[f,n.column[0]-1]},{row:[s,h],column:[n.column[1]+1,p]}]:a=="operatePart"&&(l=[{row:[s+o,h+o],column:[n.column[0]+d,n.column[1]+d]}]):s>=n.row[0]&&s<=n.row[1]&&f>=n.column[0]&&f<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]},{row:[s+o,n.row[1]+o],column:[f+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[s+o,n.row[1]+o],column:[f+d,n.column[1]+d]}]):s>=n.row[0]&&s<=n.row[1]&&p>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[1]],column:[f,n.column[0]-1]},{row:[n.row[1]+1,h],column:[f,p]},{row:[s+o,n.row[1]+o],column:[n.column[0]+d,p+d]}]:a=="restPart"?l=[{row:[s,n.row[1]],column:[f,n.column[0]-1]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[s+o,n.row[1]+o],column:[n.column[0]+d,p+d]}]):h>=n.row[0]&&h<=n.row[1]&&f>=n.column[0]&&f<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],h],column:[n.column[1]+1,p]},{row:[n.row[0]+o,h+o],column:[f+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],h],column:[n.column[1]+1,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,h+o],column:[f+d,n.column[1]+d]}]):h>=n.row[0]&&h<=n.row[1]&&p>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],h],column:[f,n.column[0]-1]},{row:[n.row[0]+o,h+o],column:[n.column[0]+d,p+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],h],column:[f,n.column[0]-1]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,h+o],column:[n.column[0]+d,p+d]}]):s<n.row[0]&&h>n.row[1]&&f>=n.column[0]&&f<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]},{row:[n.row[0]+o,n.row[1]+o],column:[f+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,n.row[1]+o],column:[f+d,n.column[1]+d]}]):s<n.row[0]&&h>n.row[1]&&p>=n.column[0]&&p<=n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],n.row[1]],column:[f,n.column[0]-1]},{row:[n.row[1]+1,h],column:[f,p]},{row:[n.row[0]+o,n.row[1]+o],column:[n.column[0]+d,p+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],n.row[1]],column:[f,n.column[0]-1]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,n.row[1]+o],column:[n.column[0]+d,p+d]}]):f<n.column[0]&&p>n.column[1]&&s>=n.row[0]&&s<=n.row[1]?a=="allPart"?l=[{row:[s,n.row[1]],column:[f,n.column[0]-1]},{row:[s,n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]},{row:[s+o,n.row[1]+o],column:[n.column[0]+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,n.row[1]],column:[f,n.column[0]-1]},{row:[s,n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[s+o,n.row[1]+o],column:[n.column[0]+d,n.column[1]+d]}]):f<n.column[0]&&p>n.column[1]&&h>=n.row[0]&&h<=n.row[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],h],column:[f,n.column[0]-1]},{row:[n.row[0],h],column:[n.column[1]+1,p]},{row:[n.row[0]+o,h+o],column:[n.column[0]+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],h],column:[f,n.column[0]-1]},{row:[n.row[0],h],column:[n.column[1]+1,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,h+o],column:[n.column[0]+d,n.column[1]+d]}]):s<n.row[0]&&h>n.row[1]&&f<n.column[0]&&p>n.column[1]?a=="allPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],n.row[1]],column:[f,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]},{row:[n.row[0]+o,n.row[1]+o],column:[n.column[0]+d,n.column[1]+d]}]:a=="restPart"?l=[{row:[s,n.row[0]-1],column:[f,p]},{row:[n.row[0],n.row[1]],column:[f,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,p]},{row:[n.row[1]+1,h],column:[f,p]}]:a=="operatePart"&&(l=[{row:[n.row[0]+o,n.row[1]+o],column:[n.column[0]+d,n.column[1]+d]}]):a=="allPart"||a=="restPart"?l=[{row:[s,h],column:[f,p]}]:a=="operatePart"&&(l=[]),l},getcolorGradation:function(e,n,t,a,l){var o=e.split(","),d=parseInt(o[0].split("(")[1]),s=parseInt(o[1]),h=parseInt(o[2].split(")")[0]),f=n.split(","),p=parseInt(f[0].split("(")[1]),g=parseInt(f[1]),v=parseInt(f[2].split(")")[0]);return"rgb("+Math.round(d-(d-p)/(t-a)*(t-l))+", "+Math.round(s-(s-g)/(t-a)*(t-l))+", "+Math.round(h-(h-v)/(t-a)*(t-l))+")"},getCFPartRange:function(e,n,t){var a=[],l=u.luckysheetfile[je(e)].luckysheet_conditionformat_save;if(l!=null&&l.length>0){e:for(var o=0;o<l.length;o++)for(var d=l[o].cellrange,s=0;s<d.length;s++)for(var h=d[s].row[0],f=d[s].row[1],p=d[s].column[0],g=d[s].column[1],v=0;v<range.length;v++)if(range[v].row[0]>=h&&range[v].row[0]<=f||range[v].row[1]>=h&&range[v].row[1]<=f||range[v].column[0]>=p&&range[v].column[0]<=g||range[v].column[1]>=p&&range[v].column[1]<=g){a.push(l[o]);continue e}}return a},checksCF:function(e,n,t){return t!=null&&e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(e){var n=je(u.currentSheetIndex);e!=null&&(n=je(e));var t=u.luckysheetfile[n].luckysheet_conditionformat_save,a=u.luckysheetfile[n].data;return a==null?null:this.compute(t,a)},compute:function(e,n){e==null&&(e=[]);var t={};if(e.length>0)for(var a=0;a<e.length;a++){var l=e[a].type,o=e[a].cellrange,d=e[a].format;if(l=="dataBar"){for(var s=null,h=null,f=0;f<o.length;f++)for(var p=o[f].row[0];p<=o[f].row[1];p++)for(var g=o[f].column[0];g<=o[f].column[1];g++)if(n[p]!=null&&n[p][g]!=null){var v=n[p][g];D(v)=="object"&&v.ct!=null&&v.ct.t=="n"&&v.v!=null&&((s==null||parseInt(v.v)>s)&&(s=parseInt(v.v)),(h==null||parseInt(v.v)<h)&&(h=parseInt(v.v)))}if(s!=null&&h!=null){if(h<0){for(var y=Math.round(s/(s-h)*10)/10,b=Math.round(Math.abs(h)/(s-h)*10)/10,k=0;k<o.length;k++)for(var w=o[k].row[0];w<=o[k].row[1];w++)for(var _=o[k].column[0];_<=o[k].column[1];_++)if(n[w]!=null&&n[w][_]!=null){var C=n[w][_];if(D(C)=="object"&&C.ct!=null&&C.ct.t=="n"&&C.v!=null){if(parseInt(C.v)<0){var A=Math.round(Math.abs(parseInt(C.v))/Math.abs(h)*100)/100;w+"_"+_ in t?t[w+"_"+_].dataBar={valueType:"minus",minusLen:b,valueLen:A,format:d}:t[w+"_"+_]={dataBar:{valueType:"minus",minusLen:b,valueLen:A,format:d}}}if(parseInt(C.v)>0){var I=Math.round(parseInt(C.v)/s*100)/100;w+"_"+_ in t?t[w+"_"+_].dataBar={valueType:"plus",plusLen:y,minusLen:b,valueLen:I,format:d}:t[w+"_"+_]={dataBar:{valueType:"plus",plusLen:y,minusLen:b,valueLen:I,format:d}}}}}}else for(var S=0;S<o.length;S++)for(var E=o[S].row[0];E<=o[S].row[1];E++)for(var R=o[S].column[0];R<=o[S].column[1];R++)if(n[E]!=null&&n[E][R]!=null){var F=n[E][R];if(D(F)=="object"&&F.ct!=null&&F.ct.t=="n"&&F.v!=null){var N=void 0;N=s==0?1:Math.round(parseInt(F.v)/s*100)/100,E+"_"+R in t?t[E+"_"+R].dataBar={valueType:"plus",plusLen:1,valueLen:N,format:d}:t[E+"_"+R]={dataBar:{valueType:"plus",plusLen:1,valueLen:N,format:d}}}}}}else if(l=="colorGradation"){for(var z=null,P=null,q=0,V=0,x=0;x<o.length;x++)for(var ee=o[x].row[0];ee<=o[x].row[1];ee++)for(var ne=o[x].column[0];ne<=o[x].column[1];ne++)if(n[ee]!=null&&n[ee][ne]!=null){var ae=n[ee][ne];D(ae)=="object"&&ae.ct!=null&&ae.ct.t=="n"&&ae.v!=null&&(V++,q+=parseInt(ae.v),(z==null||parseInt(ae.v)>z)&&(z=parseInt(ae.v)),(P==null||parseInt(ae.v)<P)&&(P=parseInt(ae.v)))}if(z!=null&&P!=null){if(d.length==3){for(var de=Math.floor(q/V),ve=0;ve<o.length;ve++)for(var U=o[ve].row[0];U<=o[ve].row[1];U++)for(var B=o[ve].column[0];B<=o[ve].column[1];B++)if(n[U]!=null&&n[U][B]!=null){var le=n[U][B];D(le)=="object"&&le.ct!=null&&le.ct.t=="n"&&le.v!=null&&(parseInt(le.v)==P?U+"_"+B in t?t[U+"_"+B].cellColor=d[2]:t[U+"_"+B]={cellColor:d[2]}:parseInt(le.v)>P&&parseInt(le.v)<de?U+"_"+B in t?t[U+"_"+B].cellColor=this.getcolorGradation(d[2],d[1],P,de,parseInt(le.v)):t[U+"_"+B]={cellColor:this.getcolorGradation(d[2],d[1],P,de,parseInt(le.v))}:parseInt(le.v)==de?U+"_"+B in t?t[U+"_"+B].cellColor=d[1]:t[U+"_"+B]={cellColor:d[1]}:parseInt(le.v)>de&&parseInt(le.v)<z?U+"_"+B in t?t[U+"_"+B].cellColor=this.getcolorGradation(d[1],d[0],de,z,parseInt(le.v)):t[U+"_"+B]={cellColor:this.getcolorGradation(d[1],d[0],de,z,parseInt(le.v))}:parseInt(le.v)==z&&(U+"_"+B in t?t[U+"_"+B].cellColor=d[0]:t[U+"_"+B]={cellColor:d[0]}))}}else if(d.length==2){for(var Te=0;Te<o.length;Te++)for(var ue=o[Te].row[0];ue<=o[Te].row[1];ue++)for(var be=o[Te].column[0];be<=o[Te].column[1];be++)if(n[ue]!=null&&n[ue][be]!=null){var ye=n[ue][be];D(ye)=="object"&&ye.ct!=null&&ye.ct.t=="n"&&ye.v!=null&&(parseInt(ye.v)==P?ue+"_"+be in t?t[ue+"_"+be].cellColor=d[1]:t[ue+"_"+be]={cellColor:d[1]}:parseInt(ye.v)>P&&parseInt(ye.v)<z?ue+"_"+be in t?t[ue+"_"+be].cellColor=this.getcolorGradation(d[1],d[0],P,z,parseInt(ye.v)):t[ue+"_"+be]={cellColor:this.getcolorGradation(d[1],d[0],P,z,parseInt(ye.v))}:parseInt(ye.v)==z&&(ue+"_"+be in t?t[ue+"_"+be].cellColor=d[0]:t[ue+"_"+be]={cellColor:d[0]}))}}}}else if(l=="icons"){for(var ce=parseInt(d.len),Re=parseInt(d.leftMin),pe=parseInt(d.top),me=null,re=null,_e=0;_e<o.length;_e++)for(var Ze=o[_e].row[0];Ze<=o[_e].row[1];Ze++)for(var We=o[_e].column[0];We<=o[_e].column[1];We++)if(n[Ze]!=null&&n[Ze][We]!=null){var Xe=n[Ze][We];D(Xe)=="object"&&Xe.ct!=null&&Xe.ct.t=="n"&&Xe.v!=null&&((me==null||parseInt(Xe.v)>me)&&(me=parseInt(Xe.v)),(re==null||parseInt(Xe.v)<re)&&(re=parseInt(Xe.v)))}if(me!=null&&re!=null){var Ue=Math.floor((me-re+1)/ce),mt=(me-re+1)%ce;if(ce==3){var St=void 0,at=void 0,dt=void 0;mt==2?(St=[re,re+Ue],at=[re+Ue+1,re+2*Ue],dt=[re+2*Ue+1,me]):(St=[re,re+Ue-1],at=[re+Ue,re+2*Ue-1],dt=[re+2*Ue,me]);for(var wt=0;wt<o.length;wt++)for(var ct=o[wt].row[0];ct<=o[wt].row[1];ct++)for(var bt=o[wt].column[0];bt<=o[wt].column[1];bt++)if(n[ct]!=null&&n[ct][bt]!=null){var De=n[ct][bt];D(De)=="object"&&De.ct!=null&&De.ct.t=="n"&&De.v!=null&&(parseInt(De.v)>=St[0]&&parseInt(De.v)<=St[1]?ct+"_"+bt in t?t[ct+"_"+bt].icons={left:Re+2,top:pe}:t[ct+"_"+bt]={icons:{left:Re+2,top:pe}}:parseInt(De.v)>=at[0]&&parseInt(De.v)<=at[1]?ct+"_"+bt in t?t[ct+"_"+bt].icons={left:Re+1,top:pe}:t[ct+"_"+bt]={icons:{left:Re+1,top:pe}}:parseInt(De.v)>=dt[0]&&parseInt(De.v)<=dt[1]&&(ct+"_"+bt in t?t[ct+"_"+bt].icons={left:Re,top:pe}:t[ct+"_"+bt]={icons:{left:Re,top:pe}}))}}else if(ce==4){var He=void 0,Dt=void 0,et=void 0,ur=void 0;mt==2?(He=[re,re+Ue],Dt=[re+Ue+1,re+2*Ue],et=[re+2*Ue+1,re+3*Ue],ur=[re+3*Ue+1,me]):mt==3?(He=[re,re+Ue],Dt=[re+Ue+1,re+2*Ue],et=[re+2*Ue+1,re+3*Ue+1],ur=[re+3*Ue+2,me]):(He=[re,re+Ue-1],Dt=[re+Ue,re+2*Ue-1],et=[re+2*Ue,re+3*Ue-1],ur=[re+3*Ue,me]);for(var Xt=0;Xt<o.length;Xt++)for(var jt=o[Xt].row[0];jt<=o[Xt].row[1];jt++)for(var lr=o[Xt].column[0];lr<=o[Xt].column[1];lr++)if(n[jt]!=null&&n[jt][lr]!=null){var tr=n[jt][lr];D(tr)=="object"&&tr.ct!=null&&tr.ct.t=="n"&&tr.v!=null&&(parseInt(tr.v)>=He[0]&&parseInt(tr.v)<=He[1]?jt+"_"+lr in t?t[jt+"_"+lr].icons={left:Re+3,top:pe}:t[jt+"_"+lr]={icons:{left:Re+3,top:pe}}:parseInt(tr.v)>=Dt[0]&&parseInt(tr.v)<=Dt[1]?jt+"_"+lr in t?t[jt+"_"+lr].icons={left:Re+2,top:pe}:t[jt+"_"+lr]={icons:{left:Re+2,top:pe}}:parseInt(tr.v)>=et[0]&&parseInt(tr.v)<=et[1]?jt+"_"+lr in t?t[jt+"_"+lr].icons={left:Re+1,top:pe}:t[jt+"_"+lr]={icons:{left:Re+1,top:pe}}:parseInt(tr.v)>=ur[0]&&parseInt(tr.v)<=ur[1]&&(jt+"_"+lr in t?t[jt+"_"+lr].icons={left:Re,top:pe}:t[jt+"_"+lr]={icons:{left:Re,top:pe}}))}}else if(ce==5){var xr=void 0,rr=void 0,nr=void 0,Ut=void 0,ar=void 0;mt==2?(xr=[re,re+Ue],rr=[re+Ue+1,re+2*Ue],nr=[re+2*Ue+1,re+3*Ue],Ut=[re+3*Ue+1,re+4*Ue],ar=[re+4*Ue+1,me]):mt==3?(xr=[re,re+Ue],rr=[re+Ue+1,re+2*Ue],nr=[re+2*Ue+1,re+3*Ue+1],Ut=[re+3*Ue+2,re+4*Ue+1],ar=[re+4*Ue+2,me]):mt==4?(xr=[re,re+Ue],rr=[re+Ue+1,re+2*Ue+1],nr=[re+2*Ue+2,re+3*Ue+1],Ut=[re+3*Ue+2,re+4*Ue+2],ar=[re+4*Ue+3,me]):(xr=[re,re+Ue-1],rr=[re+Ue,re+2*Ue-1],nr=[re+2*Ue,re+3*Ue-1],Ut=[re+3*Ue,re+4*Ue-1],ar=[re+4*Ue,me]);for(var Jt=0;Jt<o.length;Jt++)for(var Qt=o[Jt].row[0];Qt<=o[Jt].row[1];Qt++)for(var _t=o[Jt].column[0];_t<=o[Jt].column[1];_t++)if(n[Qt]!=null&&n[Qt][_t]!=null){var er=n[Qt][_t];D(er)=="object"&&er.ct!=null&&er.ct.t=="n"&&er.v!=null&&(parseInt(er.v)>=xr[0]&&parseInt(er.v)<=xr[1]?Qt+"_"+_t in t?t[Qt+"_"+_t].icons={left:Re+4,top:pe}:t[Qt+"_"+_t]={icons:{left:Re+4,top:pe}}:parseInt(er.v)>=rr[0]&&parseInt(er.v)<=rr[1]?Qt+"_"+_t in t?t[Qt+"_"+_t].icons={left:Re+3,top:pe}:t[Qt+"_"+_t]={icons:{left:Re+3,top:pe}}:parseInt(er.v)>=nr[0]&&parseInt(er.v)<=nr[1]?Qt+"_"+_t in t?t[Qt+"_"+_t].icons={left:Re+2,top:pe}:t[Qt+"_"+_t]={icons:{left:Re+2,top:pe}}:parseInt(er.v)>=Ut[0]&&parseInt(er.v)<=Ut[1]?Qt+"_"+_t in t?t[Qt+"_"+_t].icons={left:Re+1,top:pe}:t[Qt+"_"+_t]={icons:{left:Re+1,top:pe}}:parseInt(er.v)>=ar[0]&&parseInt(er.v)<=ar[1]&&(Qt+"_"+_t in t?t[Qt+"_"+_t].icons={left:Re,top:pe}:t[Qt+"_"+_t]={icons:{left:Re,top:pe}}))}}}}else for(var Kt=e[a].conditionName,mr=e[a].conditionValue[0],fr=e[a].conditionValue[1],Wt=d.textColor,ze=d.cellColor,Ae=0;Ae<o.length;Ae++)if(Kt=="greaterThan"||Kt=="lessThan"||Kt=="equal"||Kt=="textContains"){for(var Ve=o[Ae].row[0];Ve<=o[Ae].row[1];Ve++)for(var gt=o[Ae].column[0];gt<=o[Ae].column[1];gt++)if(n[Ve]!=null&&n[Ve][gt]!=null){var vt=n[Ve][gt];D(vt)!="object"||$t(vt.v)||(Kt=="greaterThan"&&vt.v>mr||Kt=="lessThan"&&vt.v<mr||Kt=="equal"&&vt.v==mr||Kt=="textContains"&&vt.v.toString().indexOf(mr)!=-1)&&(Ve+"_"+gt in t?(t[Ve+"_"+gt].textColor=Wt,t[Ve+"_"+gt].cellColor=ze):t[Ve+"_"+gt]={textColor:Wt,cellColor:ze})}}else if(Kt=="betweenness"){var pt=void 0,Tt=void 0;mr>fr?(pt=mr,Tt=fr):(pt=fr,Tt=mr);for(var Ot=o[Ae].row[0];Ot<=o[Ae].row[1];Ot++)for(var It=o[Ae].column[0];It<=o[Ae].column[1];It++)if(n[Ot]!=null&&n[Ot][It]!=null){var Lt=n[Ot][It];D(Lt)!="object"||$t(Lt.v)||Lt.v>=Tt&&Lt.v<=pt&&(Ot+"_"+It in t?(t[Ot+"_"+It].textColor=Wt,t[Ot+"_"+It].cellColor=ze):t[Ot+"_"+It]={textColor:Wt,cellColor:ze})}}else if(Kt=="occurrenceDate"){var At=void 0,or=void 0;if(mr.toString().indexOf("-")==-1)At=_a(mr)[2],or=_a(mr)[2];else{var Cr=mr.toString().split("-");At=_a(Cr[1].trim())[2],or=_a(Cr[0].trim())[2]}for(var Ar=o[Ae].row[0];Ar<=o[Ae].row[1];Ar++)for(var Rr=o[Ae].column[0];Rr<=o[Ae].column[1];Rr++)if(n[Ar]!=null&&n[Ar][Rr]!=null&&n[Ar][Rr].ct!=null&&n[Ar][Rr].ct.t=="d"){var Zr=Hr(Ar,Rr,n);Zr>=or&&Zr<=At&&(Ar+"_"+Rr in t?(t[Ar+"_"+Rr].textColor=Wt,t[Ar+"_"+Rr].cellColor=ze):t[Ar+"_"+Rr]={textColor:Wt,cellColor:ze})}}else if(Kt=="duplicateValue"){for(var Tr={},jr=o[Ae].row[0];jr<=o[Ae].row[1];jr++)for(var ta=o[Ae].column[0];ta<=o[Ae].column[1];ta++){var ia=Hr(jr,ta,n);ia in Tr||(Tr[ia]=[]),Tr[ia].push({r:jr,c:ta})}if(mr=="0"){for(var Jr in Tr)if(Jr!="null"&&Jr!="undefined"&&Tr[Jr].length>1)for(var ba=0;ba<Tr[Jr].length;ba++)Tr[Jr][ba].r+"_"+Tr[Jr][ba].c in t?(t[Tr[Jr][ba].r+"_"+Tr[Jr][ba].c].textColor=Wt,t[Tr[Jr][ba].r+"_"+Tr[Jr][ba].c].cellColor=ze):t[Tr[Jr][ba].r+"_"+Tr[Jr][ba].c]={textColor:Wt,cellColor:ze}}if(mr=="1")for(var Wr in Tr)Wr!="null"&&Wr!="undefined"&&Tr[Wr].length==1&&(Tr[Wr][0].r+"_"+Tr[Wr][0].c in t?(t[Tr[Wr][0].r+"_"+Tr[Wr][0].c].textColor=Wt,t[Tr[Wr][0].r+"_"+Tr[Wr][0].c].cellColor=ze):t[Tr[Wr][0].r+"_"+Tr[Wr][0].c]={textColor:Wt,cellColor:ze})}else if(Kt=="top10"||Kt=="top10%"||Kt=="last10"||Kt=="last10%"||Kt=="AboveAverage"||Kt=="SubAverage"){for(var Fr=[],oa=o[Ae].row[0];oa<=o[Ae].row[1];oa++)for(var Fa=o[Ae].column[0];Fa<=o[Ae].column[1];Fa++)n[oa]!=null&&n[oa][Fa]!=null&&n[oa][Fa].ct!=null&&n[oa][Fa].ct.t=="n"&&Fr.push(Hr(oa,Fa,n));if(Kt=="top10"||Kt=="top10%"||Kt=="last10"||Kt=="last10%"){for(var Da=0;Da<Fr.length;Da++)for(var va=0;va<Fr.length-1-Da;va++)if(Fr[va]<Fr[va+1]){var Ha=Fr[va];Fr[va]=Fr[va+1],Fr[va+1]=Ha}var qr=void 0;Kt=="top10"?qr=Fr.slice(0,mr):Kt=="top10%"?qr=Fr.slice(0,Math.floor(mr*Fr.length/100)):Kt=="last10"?qr=Fr.slice(Fr.length-mr,Fr.length):Kt=="last10%"&&(qr=Fr.slice(Fr.length-Math.floor(mr*Fr.length/100),Fr.length));for(var Ca=o[Ae].row[0];Ca<=o[Ae].row[1];Ca++)for(var La=o[Ae].column[0];La<=o[Ae].column[1];La++)if(n[Ca]!=null&&n[Ca][La]!=null){var Ea=Hr(Ca,La,n);qr.indexOf(Ea)!=-1&&(Ca+"_"+La in t?(t[Ca+"_"+La].textColor=Wt,t[Ca+"_"+La].cellColor=ze):t[Ca+"_"+La]={textColor:Wt,cellColor:ze})}}else if(Kt=="AboveAverage"||Kt=="SubAverage"){for(var Za=0,gn=0;gn<Fr.length;gn++)Za+=Fr[gn];var Ka=Za/Fr.length;if(Kt=="AboveAverage")for(var ka=o[Ae].row[0];ka<=o[Ae].row[1];ka++)for(var Pa=o[Ae].column[0];Pa<=o[Ae].column[1];Pa++)n[ka]!=null&&n[ka][Pa]!=null&&Hr(ka,Pa,n)>Ka&&(ka+"_"+Pa in t?(t[ka+"_"+Pa].textColor=Wt,t[ka+"_"+Pa].cellColor=ze):t[ka+"_"+Pa]={textColor:Wt,cellColor:ze});else if(Kt=="SubAverage")for(var $a=o[Ae].row[0];$a<=o[Ae].row[1];$a++)for(var on=o[Ae].column[0];on<=o[Ae].column[1];on++)n[$a]!=null&&n[$a][on]!=null&&Hr($a,on,n)<Ka&&($a+"_"+on in t?(t[$a+"_"+on].textColor=Wt,t[$a+"_"+on].cellColor=ze):t[$a+"_"+on]={textColor:Wt,cellColor:ze})}}else if(Kt=="formula"){var Dn=o[Ae].row[0],Fn=o[Ae].row[1],_n=o[Ae].column[0],dl=o[Ae].column[1],Or=mr;mr.toString().slice(0,1)!="="&&(Or="="+mr);for(var en=Dn;en<=Fn;en++)for(var hn=_n;hn<=dl;hn++){var tn=Or,Sn=en-Dn,vn=hn-_n;Sn>0&&(tn="="+m.functionCopy(tn,"down",Sn)),vn>0&&(tn="="+m.functionCopy(tn,"right",vn));var Kn=m.execfunction(tn)[1];typeof Kn!="boolean"&&(Kn=!!Number(Kn)),Kn&&(en+"_"+hn in t?(t[en+"_"+hn].textColor=Wt,t[en+"_"+hn].cellColor=ze):t[en+"_"+hn]={textColor:Wt,cellColor:ze})}}}return t},updateItem:function(e,n,t){if(ro(u.currentSheetIndex)){var a,l=je(u.currentSheetIndex),o=$.extend(!0,[],u.luckysheetfile),d=this.getHistoryRules(o);if(e=="delSheet")a=[];else{var s={type:e,cellrange:n,format:t};(a=u.luckysheetfile[l].luckysheet_conditionformat_save==null?[]:u.luckysheetfile[l].luckysheet_conditionformat_save).push(s)}u.luckysheetfile[l].luckysheet_conditionformat_save=a;var h=$.extend(!0,[],u.luckysheetfile),f=this.getCurrentRules(h);this.ref(d,f),nt.allowUpdate&&nt.saveParam("all",u.currentSheetIndex,a,{k:"luckysheet_conditionformat_save"})}},getHistoryRules:function(e){for(var n=[],t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},getCurrentRules:function(e){for(var n=[],t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},ref:function(e,n){if(u.clearjfundo){u.jfundo.length=0;var t={type:"updateCF"};t.data={historyRules:e,currentRules:n},u.jfredo.push(t)}setTimeout(function(){Kr()},1)}},Ba={clearcopy:function(e){var n=window.clipboardData;if(n||e&&(n=e.originalEvent.clipboardData),u.luckysheet_selection_range=[],pn(),n)return n.setData("Text"," "),!1;var t=$("#luckysheet-copy-content").css("visibility","hidden");t.val(" "),t.focus(),t.select(),setTimeout(function(){t.blur().css("visibility","visible")},10)},getHtmlBorderStyle:function(e,n){var t="";return(e={0:"none",1:"Thin",2:"Hair",3:"Dotted",4:"Dashed",5:"DashDot",6:"DashDotDot",7:"Double",8:"Medium",9:"MediumDashed",10:"MediumDashDot",11:"MediumDashDotDot",12:"SlantedDashDot",13:"Thick"}[e.toString()]).indexOf("Medium")>-1?t+="1pt ":t+=e=="Thick"?"1.5pt ":"0.5pt ",e=="Hair"?t+="double ":e.indexOf("DashDotDot")>-1?t+="dotted ":e.indexOf("DashDot")>-1?t+="dashed ":e.indexOf("Dotted")>-1?t+="dotted ":e.indexOf("Dashed")>-1?t+="dashed ":t+="solid ",t+n+";"},copy:function(e){var n=window.clipboardData;n||(n=e.originalEvent.clipboardData),u.luckysheet_selection_range=[];for(var t=[],a=[],l=[],o=!1,d=!1,s=0;s<u.luckysheet_select_save.length;s++){for(var h=u.luckysheet_select_save[s],f=h.row[0],p=h.row[1],g=h.column[0],v=h.column[1],y=f;y<=p;y++)if(u.config.rowhidden==null||u.config.rowhidden[y]==null){t.includes(y)||t.push(y),u.config.rowlen!=null&&y in u.config.rowlen&&(o=!0);for(var b=g;b<=v;b++)if(u.config.colhidden==null||u.config.colhidden[b]==null){a.includes(b)||a.push(b);var k=u.flowdata[y][b];D(k)=="object"&&"mc"in k&&k.mc.rs!=null&&(d=!0)}}u.luckysheet_selection_range.push({row:h.row,column:h.column}),l.push({row:h.row,column:h.column})}pn(),u.luckysheet_copy_save={dataSheetIndex:u.currentSheetIndex,copyRange:l,RowlChange:o,HasMC:d};var w;u.config.borderInfo&&u.config.borderInfo.length>0&&(w=Ps());for(var _="",C=vr.deepCopyFlowData(u.flowdata),A="",I=0;I<t.length;I++){var S=t[I];if(u.config.rowhidden==null||u.config.rowhidden[S]==null){_+="<tr>";for(var E=0;E<a.length;E++){var R=a[E];if(u.config.colhidden==null||u.config.colhidden[R]==null){var F='<td ${span} style="${style}">';if(C[S]!=null&&C[S][R]!=null){var N="",z="";S==t[0]&&(u.config==null||u.config.columnlen==null||u.config.columnlen[R.toString()]==null?A+='<colgroup width="72px"></colgroup>':A+='<colgroup width="'+u.config.columnlen[R.toString()]+'px"></colgroup>'),R==a[0]&&(u.config==null||u.config.rowlen==null||u.config.rowlen[S.toString()]==null?N+="height:19px;":N+="height:"+u.config.rowlen[S.toString()]+"px;");var P=void 0;if(P=C[S][R].ct!=null&&C[S][R].ct.fa!=null&&C[S][R].ct.fa.match(/^(w|W)((0?)|(0\.0+))$/)?Hr(S,R,C):Hr(S,R,C,"m"),N+=dr.getStyleByCell(C,S,R),D(C[S][R])=="object"&&"mc"in C[S][R]){if(!("rs"in C[S][R].mc))continue;if(z='rowspan="'+C[S][R].mc.rs+'" colspan="'+C[S][R].mc.cs+'"',w&&w[S+"_"+R]){for(var q={color:{},style:{}},V={color:{},style:{}},x={color:{},style:{}},ee={color:{},style:{}},ne=S;ne<S+C[S][R].mc.rs;ne++)for(var ae=R;ae<R+C[S][R].mc.cs;ae++){if(ne==S&&w[ne+"_"+ae]&&w[ne+"_"+ae].t){var de=w[ne+"_"+ae].t.style,ve=w[ne+"_"+ae].t.color;x.style[de]==null?x.style[de]=1:x.style[de]=x.style[de]+1,x.color[ve]==null?x.color[ve]=1:x.color[ve]=x.color[ve]+1}if(ne==S+C[S][R].mc.rs-1&&w[ne+"_"+ae]&&w[ne+"_"+ae].b){var U=w[ne+"_"+ae].b.style,B=w[ne+"_"+ae].b.color;ee.style[U]==null?ee.style[U]=1:ee.style[U]=ee.style[U]+1,ee.color[B]==null?ee.color[B]=1:ee.color[B]=ee.color[B]+1}if(ae==R&&w[ne+"_"+ae]&&w[ne+"_"+ae].l){var le=w[S+"_"+R].l.style,Te=w[ne+"_"+ae].l.color;q.style[le]==null?q.style[le]=1:q.style[le]=q.style[le]+1,q.color[Te]==null?q.color[Te]=1:q.color[Te]=q.color[Te]+1}if(ae==R+C[S][R].mc.cs-1&&w[ne+"_"+ae]&&w[ne+"_"+ae].r){var ue=w[ne+"_"+ae].r.style,be=w[ne+"_"+ae].r.color;V.style[ue]==null?V.style[ue]=1:V.style[ue]=V.style[ue]+1,V.color[be]==null?V.color[be]=1:V.color[be]=V.color[be]+1}}var ye=C[S][R].mc.rs,ce=C[S][R].mc.cs;if(JSON.stringify(q).length>23){var Re=null,pe=null;for(var me in q.color)q.color[me]>=ye/2&&(Re=me);for(var re in q.style)q.style[re]>=ye/2&&(pe=re);Re!=null&&pe!=null&&(N+="border-left:"+this.getHtmlBorderStyle(pe,Re))}if(JSON.stringify(V).length>23){var _e=null,Ze=null;for(var We in V.color)V.color[We]>=ye/2&&(_e=We);for(var Xe in V.style)V.style[Xe]>=ye/2&&(Ze=Xe);_e!=null&&Ze!=null&&(N+="border-right:"+this.getHtmlBorderStyle(Ze,_e))}if(JSON.stringify(x).length>23){var Ue=null,mt=null;for(var St in x.color)x.color[St]>=ce/2&&(Ue=St);for(var at in x.style)x.style[at]>=ce/2&&(mt=at);Ue!=null&&mt!=null&&(N+="border-top:"+this.getHtmlBorderStyle(mt,Ue))}if(JSON.stringify(ee).length>23){var dt=null,wt=null;for(var ct in ee.color)ee.color[ct]>=ce/2&&(dt=ct);for(var bt in ee.style)ee.style[bt]>=ce/2&&(wt=bt);dt!=null&&wt!=null&&(N+="border-bottom:"+this.getHtmlBorderStyle(wt,dt))}}}else if(w&&w[S+"_"+R]){if(w[S+"_"+R].l){var De=w[S+"_"+R].l.style,He=w[S+"_"+R].l.color;N+="border-left:"+this.getHtmlBorderStyle(De,He)}if(w[S+"_"+R].r){var Dt=w[S+"_"+R].r.style,et=w[S+"_"+R].r.color;N+="border-right:"+this.getHtmlBorderStyle(Dt,et)}if(w[S+"_"+R].b){var ur=w[S+"_"+R].b.style,Xt=w[S+"_"+R].b.color;N+="border-bottom:"+this.getHtmlBorderStyle(ur,Xt)}if(w[S+"_"+R].t){var jt=w[S+"_"+R].t.style,lr=w[S+"_"+R].t.color;N+="border-top:"+this.getHtmlBorderStyle(jt,lr)}}F=br(F,{style:N,span:z}),P==null&&(P=Hr(S,R,C)),P==null&&(P=""),F+=P}else{var tr="";if(w&&w[S+"_"+R]){if(w[S+"_"+R].l){var xr=w[S+"_"+R].l.style,rr=w[S+"_"+R].l.color;tr+="border-left:"+this.getHtmlBorderStyle(xr,rr)}if(w[S+"_"+R].r){var nr=w[S+"_"+R].r.style,Ut=w[S+"_"+R].r.color;tr+="border-right:"+this.getHtmlBorderStyle(nr,Ut)}if(w[S+"_"+R].b){var ar=w[S+"_"+R].b.style,Jt=w[S+"_"+R].b.color;tr+="border-bottom:"+this.getHtmlBorderStyle(ar,Jt)}if(w[S+"_"+R].t){var Qt=w[S+"_"+R].t.style,_t=w[S+"_"+R].t.color;tr+="border-top:"+this.getHtmlBorderStyle(Qt,_t)}}F+="",S==t[0]&&(u.config==null||u.config.columnlen==null||u.config.columnlen[R.toString()]==null?A+='<colgroup width="72px"></colgroup>':A+='<colgroup width="'+u.config.columnlen[R.toString()]+'px"></colgroup>'),R==a[0]&&(u.config==null||u.config.rowlen==null||u.config.rowlen[S.toString()]==null?tr+="height:19px;":tr+="height:"+u.config.rowlen[S.toString()]+"px;"),F=br(F,{style:tr,span:""}),F+=""}_+=F+="</td>"}}_+="</tr>"}}if(_='<table data-type="luckysheet_copy_action_table">'+A+_+"</table>",u.iscopyself=!0,n)return n.setData("Text",_),!1;var er=document.createElement("input");er.setAttribute("readonly","readonly"),er.value=_,document.body.appendChild(er),er.select(),document.execCommand("Copy"),er.style.display="none",document.body.removeChild(er)},copybyformat:function(e,n){var t=window.clipboardData;t||(t=e.originalEvent&&e.originalEvent.clipboardData),u.luckysheet_selection_range=[{row:u.luckysheet_select_save[0].row,column:u.luckysheet_select_save[0].column}],pn();var a=n;if(u.iscopyself=!0,t)return t.setData("Text",a),!1;var l=$("#luckysheet-copy-content");l.text(a),l.focus(),l.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){l.blur()},10)},isPasteAction:!1,paste:function(e,n){var t=this;if(u.allowEdit!==!1){var a=st().drag,l=$("#luckysheet-copy-content");l.focus(),l.select(),setTimeout(function(){var o=l.html();o.indexOf("luckysheet_copy_action_table")>-1&&u.luckysheet_copy_save.copyRange!=null&&u.luckysheet_copy_save.copyRange.length>0?u.luckysheet_paste_iscut?(u.luckysheet_paste_iscut=!1,t.pasteHandlerOfCutPaste(u.luckysheet_copy_save),t.clearcopy(e)):t.pasteHandlerOfCopyPaste(u.luckysheet_copy_save):n!="btn"?t.pasteHandler(o):Rt()?alert(a.pasteMustKeybordAlert):Ee.info(a.pasteMustKeybordAlertHTMLTitle,a.pasteMustKeybordAlertHTML)},10)}},pasteHandler:function(e,n){if(wo(u.luckysheet_select_save,u.currentSheetIndex)&&u.allowEdit!==!1)if(u.luckysheet_select_save.length>1&&(Rt()?alert(""):Ee.info('<i class="fa fa-exclamation-triangle"></i>',"")),ul(e)=="object"){if(e.length==0)return;var t=$.extend(!0,{},u.config);t.merge==null&&(t.merge={}),JSON.stringify(n).length>2&&t.borderInfo==null&&(t.borderInfo=[]);var a=e.length,l=e[0].length,o=u.luckysheet_select_save[0].row[0],d=o+a-1,s=u.luckysheet_select_save[0].column[0],h=s+l-1,f=!1;if(t.merge!=null&&(f=mn(t,o,d,s,h)),f)return void(Rt()?alert(""):Ee.info('<i class="fa fa-exclamation-triangle"></i>',""));var p=vr.deepCopyFlowData(u.flowdata),g=d-p.length+1,v=h-p[0].length+1;(g>0||v>0)&&(p=cl([].concat(p),g,v,!0)),t.rowlen==null&&(t.rowlen={});for(var y=!1,b={},k=o;k<=d;k++){var w=[].concat(p[k]),_=u.defaultrowlen;t.rowlen[k]!=null&&(_=t.rowlen[k]);for(var C=s;C<=h;C++){D(w[C])=="object"&&"mc"in w[C]&&("rs"in w[C].mc&&delete t.merge[w[C].mc.r+"_"+w[C].mc.c],delete w[C].mc);var A=null;if(e[k-o]!=null&&e[k-o][C-s]!=null&&(A=e[k-o][C-s]),w[C]=$.extend(!0,{},A),A!=null&&"mc"in w[C]&&(w[C].mc.rs!=null?(w[C].mc.r=k,w[C].mc.c=C,t.merge[w[C].mc.r+"_"+w[C].mc.c]=w[C].mc,b[A.mc.r+"_"+A.mc.c]=[w[C].mc.r,w[C].mc.c]):w[C]={mc:{r:b[A.mc.r+"_"+A.mc.c][0],c:b[A.mc.r+"_"+A.mc.c][1]}}),n[k-o+"_"+(C-s)]){var I={rangeType:"cell",value:{row_index:k,col_index:C,l:n[k-o+"_"+(C-s)].l,r:n[k-o+"_"+(C-s)].r,t:n[k-o+"_"+(C-s)].t,b:n[k-o+"_"+(C-s)].b}};t.borderInfo.push(I)}var S=bd(w[C]),E=dr.getTextSize("",S)[1];E>_&&(_=E,y=!0)}p[k]=w,_!=u.defaultrowlen&&(t.rowlen[k]=_)}if(u.luckysheet_select_save=[{row:[o,d],column:[s,h]}],g>0||v>0||y){var R={cfg:t,RowlChange:!0};wa(p,u.luckysheet_select_save,R)}else{var F={cfg:t};wa(p,u.luckysheet_select_save,F),Ra()}}else{for(var N=[],z=(e=e.replace(/\r/g,"")).split(`
`),P=z[0].split("	").length,q=0;q<z.length;q++)z[q].split("	").length<P||N.push(z[q].split("	"));var V=vr.deepCopyFlowData(u.flowdata),x=u.luckysheet_select_save[u.luckysheet_select_save.length-1],ee=x.row==null?0:x.row[0],ne=x.column==null?0:x.column[0],ae=N.length,de=N[0].length,ve=!1;if(u.config.merge!=null&&(ve=mn(u.config,ee,ee+ae-1,ne,ne+de-1)),ve)return void(Rt()?alert(""):Ee.info('<i class="fa fa-exclamation-triangle"></i>',""));var U=ee+ae-V.length,B=ne+de-V[0].length;(U>0||B>0)&&(V=cl([].concat(V),U,B,!0));for(var le=0;le<ae;le++){for(var Te=[].concat(V[le+ee]),ue=0;ue<de;ue++){var be=Te[ue+ne],ye=N[le][ue];if(M(ye)&&(ye=be&&be.ct&&be.ct.fa==="@"?String(ye):parseFloat(ye)),be instanceof Object)be.v=ye,be.ct!=null&&be.ct.fa!=null?be.m=za(be.ct.fa,ye):be.m=ye,be.f!=null&&be.f.length>0&&(be.f="",m.delFunctionGroup(le+ee,ue+ne,u.currentSheetIndex));else{var ce={},Re=_a(ye);ce.v=Re[2],ce.ct=Re[1],ce.m=Re[0],Te[ue+ne]=ce}}V[le+ee]=Te}x.row=[ee,ee+ae-1],x.column=[ne,ne+de-1],U>0||B>0?wa(V,u.luckysheet_select_save,{RowlChange:!0}):(wa(V,u.luckysheet_select_save),Ra())}},pasteHandlerOfCutPaste:function(e){if(wo(u.luckysheet_select_save,u.currentSheetIndex)&&u.allowEdit!==!1){var n=$.extend(!0,{},u.config);n.merge==null&&(n.merge={});var t=e.HasMC,a=e.RowlChange,l=e.dataSheetIndex,o=e.copyRange[0].row[0],d=e.copyRange[0].row[1],s=e.copyRange[0].column[0],h=e.copyRange[0].column[1],f=$.extend(!0,[],nn({row:[o,d],column:[s,h]},l)),p=f.length,g=f[0].length,v=u.luckysheet_select_save[u.luckysheet_select_save.length-1],y=v.row_focus,b=y+p-1,k=v.column_focus,w=k+g-1,_=!1;if(n.merge!=null&&(_=mn(n,y,b,k,w)),_)Rt()?alert(""):Ee.info('<i class="fa fa-exclamation-triangle"></i>',"");else{var C=vr.deepCopyFlowData(u.flowdata),A=p+y-C.length,I=g+k-C[0].length;(A>0||I>0)&&(C=cl([].concat(C),A,I,!0));var S=Ps(l),E=$.extend(!0,{},u.luckysheetfile[je(l)].dataVerification),R=$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].dataVerification);if(u.currentSheetIndex==l){for(var F=o;F<=d;F++)for(var N=s;N<=h;N++){var z=C[F][N];D(z)=="object"&&"mc"in z&&("rs"in z.mc&&delete n.merge[z.mc.r+"_"+z.mc.c],delete z.mc),C[F][N]=null,delete R[F+"_"+N]}if(n.borderInfo&&n.borderInfo.length>0){for(var P=[],q=0;q<n.borderInfo.length;q++){var V=n.borderInfo[q].rangeType;if(V=="range"){for(var x=n.borderInfo[q].range,ee=[],ne=0;ne<x.length;ne++)ee=ee.concat(kr.CFSplitRange(x[ne],{row:[o,d],column:[s,h]},{row:[y,b],column:[k,w]},"restPart"));n.borderInfo[q].range=ee,P.push(n.borderInfo[q])}else if(V=="cell"){var ae=n.borderInfo[q].value.row_index,de=n.borderInfo[q].value.col_index;ae>=o&&ae<=d&&de>=s&&de<=h||P.push(n.borderInfo[q])}}n.borderInfo=P}}for(var ve,U,B={},le=y;le<=b;le++){for(var Te=[].concat(C[le]),ue=k;ue<=w;ue++){if(S[o+le-y+"_"+(s+ue-k)]){var be={rangeType:"cell",value:{row_index:le,col_index:ue,l:S[o+le-y+"_"+(s+ue-k)].l,r:S[o+le-y+"_"+(s+ue-k)].r,t:S[o+le-y+"_"+(s+ue-k)].t,b:S[o+le-y+"_"+(s+ue-k)].b}};n.borderInfo==null&&(n.borderInfo=[]),n.borderInfo.push(be)}else if(S[le+"_"+ue]){var ye={rangeType:"cell",value:{row_index:le,col_index:ue,l:null,r:null,t:null,b:null}};n.borderInfo==null&&(n.borderInfo=[]),n.borderInfo.push(ye)}E[o+le-y+"_"+(s+ue-k)]&&(R[le+"_"+ue]=E[o+le-y+"_"+(s+ue-k)]),D(Te[ue])=="object"&&"mc"in Te[ue]&&("rs"in Te[ue].mc&&delete n.merge[Te[ue].mc.r+"_"+Te[ue].mc.c],delete Te[ue].mc);var ce=null;f[le-y]!=null&&f[le-y][ue-k]!=null&&(ce=f[le-y][ue-k]),Te[ue]=$.extend(!0,{},ce),ce!=null&&t&&"mc"in Te[ue]&&(Te[ue].mc.rs!=null?(Te[ue].mc.r=le,Te[ue].mc.c=ue,n.merge[Te[ue].mc.r+"_"+Te[ue].mc.c]=Te[ue].mc,B[ce.mc.r+"_"+ce.mc.c]=[Te[ue].mc.r,Te[ue].mc.c]):Te[ue]={mc:{r:B[ce.mc.r+"_"+ce.mc.c][0],c:B[ce.mc.r+"_"+ce.mc.c][1]}})}C[le]=Te}if(v.row=[y,b],v.column=[k,w],a&&(u.currentSheetIndex!=l||(n=Yl(C,o,d,n)),n=Yl(C,y,b,n)),u.currentSheetIndex!=l){var Re=$.extend(!0,[],u.luckysheetfile[je(l)].data),pe=$.extend(!0,{},u.luckysheetfile[je(l)].config),me=$.extend(!0,[],Re),re=$.extend(!0,{},pe);re.merge==null&&(re.merge={});for(var _e=o;_e<=d;_e++)for(var Ze=s;Ze<=h;Ze++){var We=me[_e][Ze];D(We)=="object"&&"mc"in We&&("rs"in We.mc&&delete re.merge[We.mc.r+"_"+We.mc.c],delete We.mc),me[_e][Ze]=null}if(a&&(re=Yl(me,o,d,re)),re.borderInfo&&re.borderInfo.length>0){for(var Xe=[],Ue=0;Ue<re.borderInfo.length;Ue++){var mt=re.borderInfo[Ue].rangeType;if(mt=="range"){for(var St=re.borderInfo[Ue].range,at=[],dt=0;dt<St.length;dt++)at=at.concat(kr.CFSplitRange(St[dt],{row:[o,d],column:[s,h]},{row:[y,b],column:[k,w]},"restPart"));re.borderInfo[Ue].range=at,Xe.push(re.borderInfo[Ue])}else if(mt=="cell"){var wt=re.borderInfo[Ue].value.row_index,ct=re.borderInfo[Ue].value.col_index;wt>=o&&wt<=d&&ct>=s&&ct<=h||Xe.push(re.borderInfo[Ue])}}re.borderInfo=Xe}var bt=$.extend(!0,[],u.luckysheetfile[je(l)].luckysheet_conditionformat_save),De=$.extend(!0,[],bt),He=[];if(De!=null&&De.length>0)for(var Dt=0;Dt<De.length;Dt++){for(var et=De[Dt].cellrange,ur=[],Xt=[],jt=0;jt<et.length;jt++){var lr=kr.CFSplitRange(et[jt],{row:[o,d],column:[s,h]},{row:[y,b],column:[k,w]},"restPart");ur=ur.concat(lr);var tr=kr.CFSplitRange(et[jt],{row:[o,d],column:[s,h]},{row:[y,b],column:[k,w]},"operatePart");tr.length>0&&(Xt=Xt.concat(tr))}if(De[Dt].cellrange=ur,Xt.length>0){var xr=$.extend(!0,{},De[Dt]);xr.cellrange=Xt,He.push(xr)}}var rr=$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save),nr=$.extend(!0,[],rr);He.length>0&&(nr=nr.concat(He));for(var Ut=o;Ut<=d;Ut++)for(var ar=s;ar<=h;ar++)delete E[Ut+"_"+ar];ve={sheetIndex:l,data:Re,curData:me,config:pe,curConfig:re,cdformat:bt,curCdformat:De,dataVerification:$.extend(!0,{},u.luckysheetfile[je(l)].dataVerification),curDataVerification:E,range:{row:[o,d],column:[s,h]}},U={sheetIndex:u.currentSheetIndex,data:u.flowdata,curData:C,config:$.extend(!0,{},u.config),curConfig:n,cdformat:rr,curCdformat:nr,dataVerification:$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].dataVerification),curDataVerification:R,range:{row:[y,b],column:[k,w]}}}else{var Jt=$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save),Qt=$.extend(!0,[],Jt);if(Qt!=null&&Qt.length>0)for(var _t=0;_t<Qt.length;_t++){for(var er=Qt[_t].cellrange,Kt=[],mr=0;mr<er.length;mr++){var fr=kr.CFSplitRange(er[mr],{row:[o,d],column:[s,h]},{row:[y,b],column:[k,w]},"allPart");Kt=Kt.concat(fr)}Qt[_t].cellrange=Kt}ve={sheetIndex:u.currentSheetIndex,data:u.flowdata,curData:C,config:$.extend(!0,{},u.config),curConfig:n,cdformat:Jt,curCdformat:Qt,dataVerification:$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].dataVerification),curDataVerification:R,range:{row:[o,d],column:[s,h]}},U={sheetIndex:u.currentSheetIndex,data:u.flowdata,curData:C,config:$.extend(!0,{},u.config),curConfig:n,cdformat:Jt,curCdformat:Qt,dataVerification:$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].dataVerification),curDataVerification:R,range:{row:[y,b],column:[k,w]}}}rm(ve,U,A>0||I>0||a)}}},pasteHandlerOfCopyPaste:function(e){if(wo(u.luckysheet_select_save,u.currentSheetIndex)){var n=$.extend(!0,{},u.config);n.merge==null&&(n.merge={});for(var t=e.HasMC,a=e.RowlChange,l=e.dataSheetIndex,o=e.copyRange[0].row[0],d=e.copyRange[0].row[1],s=e.copyRange[0].column[0],h=e.copyRange[0].column[1],f=[],p=!1,g=function(Dt){var et=nn({row:e.copyRange[Dt].row,column:e.copyRange[Dt].column},l);e.copyRange.length>1?o==e.copyRange[1].row[0]&&d==e.copyRange[1].row[1]?(et=et[0].map(function(ur,Xt){return et.map(function(jt){return jt[Xt]})}),f=f.concat(et),p=!0):s==e.copyRange[1].column[0]&&h==e.copyRange[1].column[1]&&(f=f.concat(et)):f=et},v=0;v<e.copyRange.length;v++)g(v);p&&(f=f[0].map(function(Dt,et){return f.map(function(ur){return ur[et]})}));var y=$.extend(!0,[],f);if(e.copyRange.length>1)for(var b=0;b<y.length;b++)for(var k=0;k<y[b].length;k++)y[b][k]!=null&&y[b][k].f!=null&&(delete y[b][k].f,delete y[b][k].spl);var w=y.length,_=y[0].length,C=u.luckysheet_select_save[u.luckysheet_select_save.length-1],A=C.row[0],I=C.row[1],S=C.column[0],E=C.column[1];(I-A+1)%w==0&&(E-S+1)%_==0||(I=A+w-1,E=S+_-1);var R=!1;if(n.merge!=null&&(R=mn(n,A,I,S,E)),R)Rt()?alert(""):Ee.info('<i class="fa fa-exclamation-triangle"></i>',"");else{var F=(I-A+1)/w,N=(E-S+1)/_,z=vr.deepCopyFlowData(u.flowdata),P=w+A-z.length,q=_+S-z[0].length;(P>0||q>0)&&(z=cl([].concat(z),P,q,!0));for(var V=Ps(l),x=$.extend(!0,{},u.luckysheetfile[je(l)].dataVerification),ee=null,ne=0,ae=0,de=0,ve=0,U=1;U<=F;U++)for(var B=1;B<=N;B++){ve=A+U*w,de=S+B*_;for(var le=(ne=A+(U-1)*w)-o,Te=(ae=S+(B-1)*_)-s,ue={},be=ne;be<ve;be++){for(var ye=[].concat(z[be]),ce=ae;ce<de;ce++){if(V[o+be-ne+"_"+(s+ce-ae)]){var Re={rangeType:"cell",value:{row_index:be,col_index:ce,l:V[o+be-ne+"_"+(s+ce-ae)].l,r:V[o+be-ne+"_"+(s+ce-ae)].r,t:V[o+be-ne+"_"+(s+ce-ae)].t,b:V[o+be-ne+"_"+(s+ce-ae)].b}};n.borderInfo==null&&(n.borderInfo=[]),n.borderInfo.push(Re)}else if(V[be+"_"+ce]){var pe={rangeType:"cell",value:{row_index:be,col_index:ce,l:null,r:null,t:null,b:null}};n.borderInfo==null&&(n.borderInfo=[]),n.borderInfo.push(pe)}x[o+be-ne+"_"+(s+ce-ae)]&&(ee==null&&(ee=$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].dataVerification)),ee[be+"_"+ce]=x[o+be-ne+"_"+(s+ce-ae)]),D(ye[ce])=="object"&&"mc"in ye[ce]&&("rs"in ye[ce].mc&&delete n.merge[ye[ce].mc.r+"_"+ye[ce].mc.c],delete ye[ce].mc);var me=null;if(y[be-ne]!=null&&y[be-ne][ce-ae]!=null&&(me=$.extend(!0,{},y[be-ne][ce-ae])),me!=null&&me.f!=null){var re=me.f;le>0&&(re="="+m.functionCopy(re,"down",le)),le<0&&(re="="+m.functionCopy(re,"up",Math.abs(le))),Te>0&&(re="="+m.functionCopy(re,"right",Te)),Te<0&&(re="="+m.functionCopy(re,"left",Math.abs(Te)));var _e=m.execfunction(re,be,ce,void 0,!0);me.spl!=null?(me.f=_e[2],me.v=_e[1],me.spl=_e[3].data):(me.f=_e[2],me.v=_e[1],me.ct!=null&&me.ct.fa!=null&&(me.m=za(me.ct.fa,_e[1])))}ye[ce]=$.extend(!0,{},me),me!=null&&t&&"mc"in ye[ce]&&(ye[ce].mc.rs!=null?(ye[ce].mc.r=be,ye[ce].mc.c=ce,n.merge[ye[ce].mc.r+"_"+ye[ce].mc.c]=ye[ce].mc,ue[me.mc.r+"_"+me.mc.c]=[ye[ce].mc.r,ye[ce].mc.c]):ye[ce]={mc:{r:ue[me.mc.r+"_"+me.mc.c][0],c:ue[me.mc.r+"_"+me.mc.c][1]}})}z[be]=ye}}var Ze=null;if(e.copyRange.length==1){var We=u.luckysheetfile[je(l)],Xe=u.luckysheetfile[je(u.currentSheetIndex)],Ue=$.extend(!0,[],We.luckysheet_conditionformat_save);if(Ue!=null&&Ue.length>0){Ze=$.extend(!0,[],Xe.luckysheet_conditionformat_save);for(var mt=0;mt<Ue.length;mt++){for(var St=Ue[mt].cellrange,at=[],dt=1;dt<=F;dt++)for(var wt=1;wt<=N;wt++){ne=A+(dt-1)*w,ae=S+(wt-1)*_,ve=A+dt*w,de=S+wt*_;for(var ct=0;ct<St.length;ct++){var bt=kr.CFSplitRange(St[ct],{row:[o,d],column:[s,h]},{row:[ne,ve-1],column:[ae,de-1]},"operatePart");bt.length>0&&(at=at.concat(bt))}}at.length>0&&(Ue[mt].cellrange=at,Ze.push(Ue[mt]))}}}if(C.row=[A,I],C.column=[S,E],a||P>0||q>0){var De={cfg:n=Yl(z,A,I,n),RowlChange:!0,cdformat:Ze,dataVerification:ee};wa(z,u.luckysheet_select_save,De)}else{var He={cfg:n,cdformat:Ze,dataVerification:ee};wa(z,u.luckysheet_select_save,He),Ra()}}}},pasteHandlerOfPaintModel:function(e){if(wo(u.luckysheet_select_save,u.currentSheetIndex)){var n=$.extend(!0,{},u.config);n.merge==null&&(n.merge={});var t=e.HasMC,a=e.RowlChange,l=e.dataSheetIndex,o=e.copyRange[0].row[0],d=e.copyRange[0].row[1],s=e.copyRange[0].column[0],h=e.copyRange[0].column[1],f=$.extend(!0,[],nn({row:[o,d],column:[s,h]},l)),p=u.luckysheet_select_save[u.luckysheet_select_save.length-1],g=p.row[0],v=p.row[1],y=p.column[0],b=p.column[1],k=f.length,w=f[0].length;if(g==v&&y==b){var _=!1;if(n.merge!=null&&(_=mn(n,g,g+k-1,y,y+w-1)),_)return void(Rt()?alert(""):Ee.info('<i class="fa fa-exclamation-triangle"></i>',""));v=g+k-1,b=y+w-1}for(var C=Math.ceil((v-g+1)/k),A=Math.ceil((b-y+1)/w),I=vr.deepCopyFlowData(u.flowdata),S=I[0].length,E=I.length,R=Ps(l),F=$.extend(!0,{},u.luckysheetfile[je(l)].dataVerification),N=null,z=0,P=0,q=0,V=0,x=1;x<=C;x++)for(var ee=1;ee<=A;ee++){P=y+(ee-1)*w,(V=g+x*k>E?E:g+x*k)>v+1&&(V=v+1),(q=y+ee*w>S?S:y+ee*w)>b+1&&(q=b+1);for(var ne={},ae=z=g+(x-1)*k;ae<V;ae++){for(var de=[].concat(I[ae]),ve=P;ve<q;ve++){if(R[o+ae-z+"_"+(s+ve-P)]){var U={rangeType:"cell",value:{row_index:ae,col_index:ve,l:R[o+ae-z+"_"+(s+ve-P)].l,r:R[o+ae-z+"_"+(s+ve-P)].r,t:R[o+ae-z+"_"+(s+ve-P)].t,b:R[o+ae-z+"_"+(s+ve-P)].b}};n.borderInfo==null&&(n.borderInfo=[]),n.borderInfo.push(U)}else if(R[ae+"_"+ve]){var B={rangeType:"cell",value:{row_index:ae,col_index:ve,l:null,r:null,t:null,b:null}};n.borderInfo==null&&(n.borderInfo=[]),n.borderInfo.push(B)}F[o+ae-z+"_"+(s+ve-P)]&&(N==null&&(N=$.extend(!0,{},u.luckysheetfile[je(u.currentSheetIndex)].dataVerification)),N[ae+"_"+ve]=F[o+ae-z+"_"+(s+ve-P)]),D(de[ve])=="object"&&"mc"in de[ve]&&("rs"in de[ve].mc&&delete n.merge[de[ve].mc.r+"_"+de[ve].mc.c],delete de[ve].mc);var le=null;if(f[ae-z]!=null&&f[ae-z][ve-P]!=null&&(le=f[ae-z][ve-P]),le!=null&&(delete le.v,delete le.m,delete le.f,delete le.spl,le.ct&&le.ct.t=="inlineStr"&&delete le.ct,D(de[ve])=="object"||(de[ve]={v:de[ve]}),de[ve]=$.extend(!0,de[ve],le),t&&"mc"in de[ve]&&(de[ve].mc.rs!=null?(de[ve].mc.r=ae,de[ve].mc.rs+ae>=V&&(de[ve].mc.rs=V-ae),de[ve].mc.c=ve,de[ve].mc.cs+ve>=q&&(de[ve].mc.cs=q-ve),n.merge[de[ve].mc.r+"_"+de[ve].mc.c]=de[ve].mc,ne[le.mc.r+"_"+le.mc.c]=[de[ve].mc.r,de[ve].mc.c]):de[ve]={mc:{r:ne[le.mc.r+"_"+le.mc.c][0],c:ne[le.mc.r+"_"+le.mc.c][1]}}),de[ve].v!=null&&le.ct!=null&&le.ct.fa!=null)){var Te=za(le.ct.fa,de[ve].v);de[ve].m=Te}}I[ae]=de}}var ue=null,be=$.extend(!0,[],u.luckysheetfile[je(l)].luckysheet_conditionformat_save);if(be!=null&&be.length>0){ue=$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save);for(var ye=0;ye<be.length;ye++){for(var ce=be[ye].cellrange,Re=[],pe=0;pe<ce.length;pe++){var me=kr.CFSplitRange(ce[pe],{row:[o,d],column:[s,h]},{row:[g,v],column:[y,b]},"operatePart");me.length>0&&(Re=Re.concat(me))}Re.length>0&&(be[ye].cellrange=[{row:[g,v],column:[y,b]}],ue.push(be[ye]))}}if(p.row=[g,v],p.column=[y,b],a){var re={cfg:n=Yl(I,g,v,n),RowlChange:!0,cdformat:ue,dataVerification:N};wa(I,u.luckysheet_select_save,re)}else{var _e={cfg:n,cdformat:ue,dataVerification:N};wa(I,u.luckysheet_select_save,_e),Ra()}}},matchcopy:function(e,n){var t,a,l=[],o=[];if(ul(e)=="object")l=e;else{l=e.split(`
`);for(var d=0;d<l.length;d++)l[d]=l[d].split("	")}if(t=l.length,ul(n)=="object")o=n;else{o=n.split(`
`);for(var s=0;s<o.length;s++)o[s]=o[s].split("	")}if(t!=(a=o.length))return!1;for(var h=0;h<t;h++)if(u.config.rowhidden==null||u.config.rowhidden[h]==null){for(var f=0;f<a;f++)if(l[h].length!=o[f].length)return!1}for(var p=0;p<t;p++)if(u.config.rowhidden==null||u.config.rowhidden[p]==null){for(var g=0;g<l[0].length;g++)if(Hr(p,g,l)!=Hr(p,g,o))return!1}return!0}};function bl(e){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cell-selected-boxs .luckysheet-cell-selected").hide(),$("#luckysheet-cols-h-selected .luckysheet-cols-h-selected").hide(),$("#luckysheet-rows-h-selected .luckysheet-rows-h-selected").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),e||Ba.clearcopy(e),$("#luckysheet-dropCell-icon").is(":visible")&&e&&$("#luckysheet-dropCell-icon").remove(),dr.luckysheetPaintModelOn&&!e&&dr.cancelPaintModel()}function Tb(e,n,t,a,l){var o,d,s,h=function(){var A=st(),I=A.info,S=A.print,E=Nt.userInfo===!0?'<i style="font-size:16px;color:#ff6a00;" class="fa fa-taxi" aria-hidden="true"></i> Lucky':Nt.userInfo;return`<div class="luckysheet">
                    <canvas id="luckysheetTableContentF" style="display:none;" class="luckysheetTableContent"></canvas> 
                    <div class="luckysheet-work-area luckysheet-noselected-text"> 
                        <div id ="luckysheet_info_detail" class="luckysheet_info_detail"> 
                            <div data-tips="`.concat(I.return,`" id="luckysheet_info_detail_title" class="luckysheet_info_detail_back"> 
                                <i style="color:#444D5A;" class="fa fa-angle-left fa-2x" aria-hidden="true"></i> 
                            </div> 
                            <div class="luckysheet-share-logo" title="\${logotitle}"></div>
                            <div class="sheet-name"> 
                                <input data-tips="`).concat(I.tips,'" id="luckysheet_info_detail_input" class="luckysheet_info_detail_input luckysheet-mousedown-cancel" value="').concat(I.noName,'" tabindex="0" dir="ltr" aria-label="').concat(I.rename,'" style="visibility: visible; width: 149px;" data-tooltip="').concat(I.rename,`"> 
                            </div> 
                            <div id="luckysheet_info_detail_update" class="luckysheet_info_detail_update"> `).concat(I.detailUpdate,` </div> 
                            <div id="luckysheet_info_detail_save" class="luckysheet_info_detail_save"> `).concat(I.wait,` </div>
                            
                            \${functionButton}
                            
                            `).concat(D(E)==="string"?`<div class="luckysheet_info_detail_user">
                            <span id="luckysheet_info_detail_user">`.concat(E,"</span></div>"):"",`

                            `).concat(D(E)==="object"?`<div class="luckysheet_info_detail_user">                            
                            <img src="`.concat(E.userImage,`" id="luckysheet_info_detail_user_img">
                            <span id="luckysheet_info_detail_user">`).concat(E.userName,`</span>
                            </div>`):"",`
                            
                        </div> 
                        <div id="luckysheet-wa-editor" class="luckysheet-wa-editor toolbar"> \${menu} </div> 
                        <div id="luckysheet-wa-calculate" class="luckysheet-wa-calculate"> 
                            <div class="luckysheet-wa-calculate-size" id="luckysheet-wa-calculate-size"></div> 
                            <div class="luckysheet-wa-calculate-help"> 
                                <div class="luckysheet-wa-calculate-help-box"> 
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-helpbox">
                                        <div id="luckysheet-helpbox-cell" class="luckysheet-helpbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list"></div>
                                    </div> 
                                </div>  
                                <div class="luckysheet-wa-calculate-help-tool">
                                    <i class="fa fa-caret-down" aria-hidden="true" style="margin-top: 7px;"></i>
                                </div> 
                            </div> 
                            <div id="luckysheet-wa-functionbox-cancel" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-qingchu" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-confirm" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-yunhang" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-fx" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-hanshu" aria-hidden="true" style="color:#333"></i></span> 
                            </div> 
                            <div id="luckysheet-functionbox-container" class="luckysheet-mousedown-cancel">
                                <div class="luckysheet-mousedown-cancel" dir="ltr">
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-functionbox">
                                        <div id="luckysheet-functionbox-cell" class="luckysheet-functionbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list" aria-label="D4"></div>
                                    </div>
                                </div>
                            </div>   
                        </div> 
                    </div> 
                    <div class="luckysheet-grid-container luckysheet-scrollbars-enabled"> 
                        <div class="luckysheet-grid-window"> 
                            <div class="luckysheet-help-sub"></div> 
                            <div class="luckysheet-grid-window-1" id="luckysheet-grid-window-1">
                                <canvas id="luckysheetTableContent" class="luckysheetTableContent"></canvas> 
                                <table class="luckysheet-grid-window-2" cellspacing="0" cellpadding="0" dir="ltr" tabindex="-1" > 
                                    <tbody> 
                                        <tr> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-left-top" id="luckysheet-left-top"> </div> 
                                            </td> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div id="luckysheet-cols-h-c" class="luckysheet-cols-h-c">
                                                    <div class="luckysheet-cols-change-size" id="luckysheet-cols-change-size"></div>  
                                                    <div class="luckysheet-cols-menu-btn luckysheet-mousedown-cancel" id="luckysheet-cols-menu-btn"><i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i></div>  
                                                    <div class="luckysheet-cols-h-hover" id="luckysheet-cols-h-hover"></div>  
                                                    <div id="luckysheet-cols-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${columnHeader}
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-rows-h" id="luckysheet-rows-h"> 
                                                    <div class="luckysheet-rows-change-size" id="luckysheet-rows-change-size"></div> 
                                                    <div class="luckysheet-rows-h-hover" id="luckysheet-rows-h-hover"></div> 
                                                    <div id="luckysheet-rows-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div> \${rowHeader}
                                                </div> 
                                            </td>  
                                            <td valign="top" class="luckysheet-paneswrapper">
                                                <div class="luckysheet-cell-loading" id="luckysheet-cell-loading">
                                                    <div class="luckysheet-cell-loading-inner">
                                                        <i class="fa fa-circle-o-notch fa-spin"></i>
                                                        <span></span>
                                                    </div>
                                                </div> 
                                                <div class="luckysheet-cell-freezen"></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-x" id="luckysheet-scrollbar-x"><div></div></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-y" id="luckysheet-scrollbar-y"><div></div></div> 
                                                <div class="luckysheet-cell-main " id="luckysheet-cell-main">
                                                    <div id="luckysheet-formula-functionrange"></div>  
                                                    <div id="luckysheet-formula-functionrange-select" class="luckysheet-selection-copy luckysheet-formula-functionrange-select">
                                                        <div class="luckysheet-selection-copy-top luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-right luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-bottom luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-left luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-hc"></div>
                                                    </div>  
                                                    <div class="luckysheet-row-count-show luckysheet-count-show" id="luckysheet-row-count-show"></div>
                                                    <div class="luckysheet-column-count-show luckysheet-count-show" id="luckysheet-column-count-show"></div>
                                                    <div class="luckysheet-change-size-line" id="luckysheet-change-size-line"></div>  
                                                    <div class="luckysheet-cell-selected-focus" id="luckysheet-cell-selected-focus"></div>  
                                                    <div id="luckysheet-selection-copy"></div>  
                                                    <div id="luckysheet-chart-rangeShow"></div>
                                                    <div class="luckysheet-cell-selected-extend" id="luckysheet-cell-selected-extend"></div>  
                                                    <div class="luckysheet-cell-selected-move" id="luckysheet-cell-selected-move"></div>  
                                                    <div id="luckysheet-cell-selected-boxs">
                                                        <div id="luckysheet-cell-selected" class="luckysheet-cell-selected">
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-fillhandle"></div>
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-draghandle-top luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-left luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-right luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-postil-showBoxs"></div>
                                                    <div id="luckysheet-multipleRange-show"></div>  
                                                    <div id="luckysheet-dynamicArray-hightShow"></div>  
                                                    <div id="luckysheet-image-showBoxs">
                                                        <div id="luckysheet-modal-dialog-activeImage" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div> 
                                                            <div class="luckysheet-modal-dialog-content"></div>  
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt" data-type="lt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt" data-type="mt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm" data-type="lm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm" data-type="rm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt" data-type="rt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb" data-type="lb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb" data-type="mb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="" title="">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="" title="">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="" title="">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div id="luckysheet-modal-dialog-cropping" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="cropping-mask"></div>
                                                            <div class="cropping-content"></div>
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div>
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="resize-item lt" data-type="lt"></div> 
                                                                <div class="resize-item mt" data-type="mt"></div> 
                                                                <div class="resize-item lm" data-type="lm"></div> 
                                                                <div class="resize-item rm" data-type="rm"></div> 
                                                                <div class="resize-item rt" data-type="rt"></div> 
                                                                <div class="resize-item lb" data-type="lb"></div> 
                                                                <div class="resize-item mb" data-type="mb"></div> 
                                                                <div class="resize-item rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="" title="">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="" title="">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="" title="">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="img-list"></div>
                                                        <div class="cell-date-picker">
                                                            <input id="cellDatePickerBtn" class="formulaInputFocus" readonly="readonly"/>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-dataVerification-dropdown-btn"></div>
                                                    <div id="luckysheet-dataVerification-dropdown-List" class="luckysheet-mousedown-cancel"></div>
                                                    <div id="luckysheet-dataVerification-showHintBox" class="luckysheet-mousedown-cancel"></div>
                                                    <div class="luckysheet-cell-copy"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${flow} 
                                                </div> 
                                            </td> 
                                        </tr> 
                                    </tbody> 
                                </table> 
                            </div> 
                            <div class="luckysheet-sheet-area luckysheet-noselected-text" id="luckysheet-sheet-area">
                                <div id="luckysheet-sheets-add" class="luckysheet-sheets-add lucky-button-custom"><i class="iconfont luckysheet-iconfont-jia1"></i></div>
                                <div id="luckysheet-sheets-m" class="luckysheet-sheets-m lucky-button-custom"><i class="iconfont luckysheet-iconfont-caidan2"></i></div>
                                <div class="luckysheet-sheet-container" id="luckysheet-sheet-container">
                                    <div class="docs-sheet-fade docs-sheet-fade-left" style="display: none;">
                                        <div class="docs-sheet-fade3"></div>
                                        <div class="docs-sheet-fade2"></div>
                                        <div class="docs-sheet-fade1"></div>
                                    </div>
                                    <div class="docs-sheet-fade docs-sheet-fade-right" style="display: none;">
                                        <div class="docs-sheet-fade1"></div>
                                        <div class="docs-sheet-fade2"></div>
                                        <div class="docs-sheet-fade3"></div>
                                    </div>
                                    <div class="luckysheet-sheet-container-c" id="luckysheet-sheet-container-c"></div>
                                </div>
                                <div id="luckysheet-sheets-leftscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-left"></i></div>
                                <div id="luckysheet-sheets-rightscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-right"></i></div>
                            </div> 
                        </div> 
                        <div class="luckysheet-stat-area"> 
                            <div class="luckysheet-sta-c">
                                <div class="luckysheet-zoom-content" id="luckysheet-zoom-content">
                                    <div class="luckysheet-zoom-minus" id="luckysheet-zoom-minus">
                                        <div class="luckysheet-zoom-minus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-slider" id="luckysheet-zoom-slider">
                                        <div class="luckysheet-zoom-line"></div>
                                        <div class="luckysheet-zoom-cursor" id="luckysheet-zoom-cursor"></div>
                                        <div class="luckysheet-zoom-hundred"></div>
                                    </div>
                                    <div class="luckysheet-zoom-plus" id="luckysheet-zoom-plus">
                                        <div class="luckysheet-zoom-plus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-ratioText" id="luckysheet-zoom-ratioText">100%</div>
                                </div>
                                <div class="luckysheet-print-viewList">
                                    <div type="viewNormal" class="luckysheet-print-viewBtn luckysheet-print-viewNormal luckysheet-print-viewBtn-active" title="`).concat(S.normalBtn,`"><i class="icon iconfont luckysheet-iconfont-putong"></i></div>
                                    <div type="viewLayout" class="luckysheet-print-viewBtn luckysheet-print-viewLayout" title="`).concat(S.layoutBtn,`"><i class="icon iconfont luckysheet-iconfont-yemianbuju"></i></div>
                                    <div type="viewPage" class="luckysheet-print-viewBtn luckysheet-print-viewPage" title="`).concat(S.pageBtn,`"><i class="icon iconfont luckysheet-iconfont-fenyeyulan"></i></div>
                                </div>
                                <div class="luckysheet-sta-content" id="luckysheet-sta-content"></div>  
                                <!--<div class="luckysheet-bottom-content" id="luckysheet-bottom-content-show"></div> -->
                            </div> 
                        </div> 
                    </div>
                    <div id="luckysheet-copy-content" contenteditable="true"></div>
                    <input id="luckysheet-copy-btn" type="button" data-clipboard-target="luckysheet-copy-content">
                    <div id="testdpidiv" style="height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;"></div>
                  </div>`)}();h=br(h,{logotitle:l}),h=br(h,{menu:(o=st().toolbar,d=st().fontarray,s=st().defaultFmt,`<div class="luckysheet-toolbar-left-theme">
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`.concat(o.undo,`"
        id="luckysheet-icon-undo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-undo iconfont luckysheet-iconfont-qianjin"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.redo,`"
        id="luckysheet-icon-redo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-redo iconfont luckysheet-iconfont-houtui"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.paintFormat,`"
        id="luckysheet-icon-paintformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-geshishua"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class="luckysheet-toolbar-separator luckysheet-inline-block"
        style="user-select: none;"> </div> <div class="luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block" data-tips="" id="luckysheet-icon-zoom" style="user-select: none;"> <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption" style="user-select: none;"> <input aria-label="" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput luckysheet-mousedown-cancel" role="combobox" style="user-select: none;" tabindex="-1" type="text" value="100%"/> </div> <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> -->
        <div id="toolbar-separator-paint-format" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.currencyFormat,`"
        id="luckysheet-icon-currency" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-jine"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.percentageFormat,`"
        id="luckysheet-icon-percent" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-baifenhao"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.numberDecrease,`"
        id="luckysheet-icon-fmt-decimal-decrease" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-decrease iconfont luckysheet-iconfont-jianxiaoxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.numberIncrease,`"
        id="luckysheet-icon-fmt-decimal-increase" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-increase iconfont luckysheet-iconfont-zengjiaxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="`).concat(o.moreFormats,`"
        id="luckysheet-icon-fmt-other" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        `).concat(s[0].text,`
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div id="toolbar-separator-more-format" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.font,`" id="luckysheet-icon-font-family" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        `).concat(d[0],`
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>

        <div id="toolbar-separator-font-family" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block"
        data-tips="`).concat(o.fontSize,`" id="luckysheet-icon-font-size" style="user-select: none;">
            <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption"
                    style="user-select: none;">
                        <input aria-label="`).concat(o.fontSize,`" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput"
                        role="combobox" style="user-select: none;" tabindex="-1" type="text" value="10"
                        />
                    </div>
                    <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div id="toolbar-separator-font-size" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.bold,`"
        id="luckysheet-icon-bold" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-bold iconfont luckysheet-iconfont-jiacu"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.italic,`"
        id="luckysheet-icon-italic" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-italic iconfont luckysheet-iconfont-wenbenqingxie1"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.strikethrough,`"
        id="luckysheet-icon-strikethrough" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-strikethrough iconfont luckysheet-iconfont-wenbenshanchuxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="`).concat(o.underline,`"
        id="luckysheet-icon-underline" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-underline iconfont luckysheet-iconfont-wenbenxiahuaxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-text-color"
        data-tips="`).concat(o.textColor,`" id="luckysheet-icon-text-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(0, 0, 0); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:`).concat(Nt.defaultTextColor,`"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color iconfont luckysheet-iconfont-wenbenyanse"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.chooseColor,`..." id="luckysheet-icon-text-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div id="toolbar-separator-text-color" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-cell-color"
        data-tips="`).concat(o.fillColor,`" id="luckysheet-icon-cell-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(255, 255, 255); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:`).concat(Nt.defaultCellColor,`"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color iconfont luckysheet-iconfont-tianchong"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.chooseColor,`..." id="luckysheet-icon-cell-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-border-all"
        data-tips="`).concat(o.border,`" id="luckysheet-icon-border-all" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.borderStyle,`..." id="luckysheet-icon-border-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-merge-button"
        data-tips="`).concat(o.mergeCell,`" id="luckysheet-icon-merge-button" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-merge iconfont luckysheet-iconfont-hebing"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.chooseMergeType,`..." id="luckysheet-icon-merge-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div id="toolbar-separator-merge-cell" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-align"
        data-tips="`).concat(o.horizontalAlign,`" id="luckysheet-icon-align" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.alignment,`..." id="luckysheet-icon-align-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-valign"
        data-tips="`).concat(o.verticalAlign,`" id="luckysheet-icon-valign" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.alignment,`..." id="luckysheet-icon-valign-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-textwrap"
        data-tips="`).concat(o.textWrap,`" id="luckysheet-icon-textwrap" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.textWrapMode,`..." id="luckysheet-icon-textwrap-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-rotation"
        data-tips="`).concat(o.textRotate,`" id="luckysheet-icon-rotation" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.textRotateMode,`..." id="luckysheet-icon-rotation-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div id="toolbar-separator-text-rotate" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.insertImage,`" id="luckysheet-insertImg-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tupian"
                            style="user-select: none;">
                                <input id="luckysheet-imgUpload" type="file" accept="image/*" style="display:none;"></input>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.insertLink,`" id="luckysheet-insertLink-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-lianjie"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.chart,`" id="luckysheet-chart-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tubiao"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>        
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="`).concat(o.postil,`"
        id="luckysheet-icon-postil" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon-img-container luckysheet-toolbar-menu-button-caption luckysheet-inline-block iconfont luckysheet-iconfont-zhushi"
                    style="user-select: none;">
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.pivotTable,`" id="luckysheet-pivot-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujutoushi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>       
        <div id="toolbar-separator-pivot-table" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;">
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-function"
        data-tips="`).concat(o.autoSum,`" id="luckysheet-icon-function" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-jisuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        `).concat(o.sum,`
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.moreFunction,`..." id="luckysheet-icon-function-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-freezen-btn-horizontal"
        data-tips="`).concat(o.freezeTopRow,`" id="luckysheet-freezen-btn-horizontal" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-dongjie1"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="`).concat(o.moreOptions,`..." id="luckysheet-icon-freezen-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="`).concat(o.sortAndFilter,`"
        id="luckysheet-icon-autofilter" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-shaixuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="`).concat(o.conditionalFormat,`"
        id="luckysheet-icon-conditionformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-geshitiaojian"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.dataVerification,`" id="luckysheet-dataVerification-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujuyanzheng"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.splitColumn,`" id="luckysheet-splitColumn-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wenbenfenge"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.screenshot,`" id="luckysheet-chart-btn-screenshot" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-jieping"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="`).concat(o.findAndReplace,`"
        id="luckysheet-icon-seachmore" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-sousuo"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="`).concat(o.protection,`" id="luckysheet-icon-protection" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-biaogesuoding"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="`).concat(o.print,`"
        id="luckysheet-icon-print" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-dayin"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>
        `))});var f='<div id="luckysheet-cell-flow_${index}" class="luckysheet-cell-flow luckysheetsheetchange" style="width:${width}px;"><div class="luckysheet-cell-flow-clip"><div class="luckysheet-grdblkpush"></div>${flow}</div></div>';u.config==null&&(u.config={}),ld(n,e);var p=st().info,g='<button id="luckysheet-bottom-add-row" class="btn btn-default">'+p.add+'</button><input id="luckysheet-bottom-add-row-input" type="text" class="luckysheet-datavisual-config-input luckysheet-mousedown-cancel" placeholder="100"><span style="font-size: 14px;">'+p.row+'</span><span style="font-size: 14px;color: #9c9c9c;">('+p.addLast+")</span>",v=' <button id="luckysheet-bottom-bottom-top" class="btn btn-default" style="">'+p.backTop+"</button>",y=br(p.pageInfo,{total:Nt.total?Nt.total:"",totalPage:Nt.pageInfo.totalPage?Nt.pageInfo.totalPage:"",currentPage:Nt.pageInfo.currentPage?Nt.pageInfo.currentPage:""}),b=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+y+'</span> <button id="luckysheet-bottom-page-next" class="btn btn-danger" style=""></button>',k=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+y+"</span>",w="";Nt.enableAddRow&&(w+=g),Nt.enablePage&&(parseInt(Nt.pageInfo.totalPage)==1?w+=k:w+=b),Nt.enableAddBackTop&&(w+=v);var _=br('<div id="luckysheetcoltable_0" class="luckysheet-cell-flow-col"> <div id ="luckysheet-sheettable_0" class="luckysheet-cell-sheettable" style="height:${height}px;width:${width}px;"></div><div id="luckysheet-bottom-controll-row" class="luckysheet-bottom-controll-row"> '+w+" </div> </div>",{height:u.rh_height,width:u.ch_width-1}),C=br('<div class="luckysheet-cols-h-cells luckysheetsheetchange"  id="luckysheet-cols-h-cells_${index}" style="width:${width}px;"> <div class="luckysheet-cols-h-cells-c"> <div class="luckysheet-grdblkpush"></div>${column}</div></div>',{width:u.ch_width,index:0,column:""});f=br(f,{width:u.ch_width,flow:_,index:0}),h=br(h,{flow:f,rowHeader:"<div style='height:"+u.rh_height+"px' id='luckysheetrowHeader_0' class='luckysheetsheetchange'></div>",columnHeader:C,functionButton:Nt.functionButton}),$("#"+u.container).append(h),$("#luckysheet-scrollbar-x div").width(u.ch_width),$("#luckysheet-scrollbar-y div").height(u.rh_height+u.columnHeaderHeight-u.cellMainSrollBarSize-3),$("body").append('<div class="luckysheet-modal-dialog-mask" id="luckysheet-modal-dialog-mask"></div>'),$("body").append(""),$("body").append(J0()),$("body").append('<div dir="ltr"><div class="luckysheet-input-box-index" id="luckysheet-input-box-index"></div><div id="luckysheet-input-box" spellcheck="false" aria-hidden="false" class="luckysheet-input-box"><div class="luckysheet-cell-input editable" tabindex="0" role="combobox" contenteditable="true" id="luckysheet-rich-text-editor" dir="ltr" g_editable="true" aria-autocomplete="list"></div></div></div>'),$("body").append(br(wf(),{menuid:"filter"})),$("body").append(br(_f(),{menuid:"filter"})),$("body").append(Q0()),$("#luckysheet-rows-h").width(u.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(u.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:u.rowHeaderWidth-1.5,height:u.columnHeaderHeight-1.5}),$("#luckysheet_info_detail_input").val(Nt.title)}var Ab=zl.findIndex,tg=!0,Sb=Er("findIndex");"findIndex"in[]&&Array(1).findIndex(function(){tg=!1}),Ce({target:"Array",proto:!0,forced:tg||!Sb},{findIndex:function(e){return Ab(this,e,arguments.length>1?arguments[1]:void 0)}}),Is("findIndex");var Ib=!we(function(){return Object.isExtensible(Object.preventExtensions({}))}),rg=Fe(function(e){var n=Be.f,t=Ht("meta"),a=0,l=Object.isExtensible||function(){return!0},o=function(s){n(s,t,{value:{objectID:"O"+ ++a,weakData:{}}})},d=e.exports={REQUIRED:!1,fastKey:function(s,h){if(!O(s))return typeof s=="symbol"?s:(typeof s=="string"?"S":"P")+s;if(!$e(s,t)){if(!l(s))return"F";if(!h)return"E";o(s)}return s[t].objectID},getWeakData:function(s,h){if(!$e(s,t)){if(!l(s))return!0;if(!h)return!1;o(s)}return s[t].weakData},onFreeze:function(s){return Ib&&d.REQUIRED&&l(s)&&!$e(s,t)&&o(s),s}};Vr[t]=!0}),Rb=bn("iterator"),Eb=Array.prototype,am=function(e){return e!==void 0&&(du.Array===e||Eb[Rb]===e)},$b=bn("iterator"),Cc=function(e){if(e!=null)return e[$b]||e["@@iterator"]||du[As(e)]},ag=function(e,n,t,a){try{return a?n(Et(t)[0],t[1]):n(t)}catch(o){var l=e.return;throw l!==void 0&&Et(l.call(e)),o}},ng=Fe(function(e){var n=function(t,a){this.stopped=t,this.result=a};(e.exports=function(t,a,l,o,d){var s,h,f,p,g,v,y,b=ru(a,l,o?2:1);if(d)s=t;else{if(typeof(h=Cc(t))!="function")throw TypeError("Target is not iterable");if(am(h)){for(f=0,p=Zt(t.length);p>f;f++)if((g=o?b(Et(y=t[f])[0],y[1]):b(t[f]))&&g instanceof n)return g;return new n(!1)}s=h.call(t)}for(v=s.next;!(y=v.call(s)).done;)if(typeof(g=ag(s,b,y.value,o))=="object"&&g&&g instanceof n)return g;return new n(!1)}).stop=function(t){return new n(!0,t)}}),ao=function(e,n,t){if(!(e instanceof n))throw TypeError("Incorrect "+(t?t+" ":"")+"invocation");return e},lg=bn("iterator"),ig=!1;try{var Db=0,og={next:function(){return{done:!!Db++}},return:function(){ig=!0}};og[lg]=function(){return this},Array.from(og,function(){throw 2})}catch{}var sg=function(e,n){if(!n&&!ig)return!1;var t=!1;try{var a={};a[lg]=function(){return{next:function(){return{done:t=!0}}}},e(a)}catch{}return t},Tc=function(e,n,t){for(var a in n)$r(e,a,n[a],t);return e},Fb=Be.f,ug=rg.fastKey,cg=Vt.set,nm=Vt.getterFor,qb=(function(e,n,t){var a=e.indexOf("Map")!==-1,l=e.indexOf("Weak")!==-1,o=a?"set":"add",d=K[e],s=d&&d.prototype,h=d,f={},p=function(w){var _=s[w];$r(s,w,w=="add"?function(C){return _.call(this,C===0?0:C),this}:w=="delete"?function(C){return!(l&&!O(C))&&_.call(this,C===0?0:C)}:w=="get"?function(C){return l&&!O(C)?void 0:_.call(this,C===0?0:C)}:w=="has"?function(C){return!(l&&!O(C))&&_.call(this,C===0?0:C)}:function(C,A){return _.call(this,C===0?0:C,A),this})};if(Pt(e,typeof d!="function"||!(l||s.forEach&&!we(function(){new d().entries().next()}))))h=t.getConstructor(n,e,a,o),rg.REQUIRED=!0;else if(Pt(e,!0)){var g=new h,v=g[o](l?{}:-0,1)!=g,y=we(function(){g.has(1)}),b=sg(function(w){new d(w)}),k=!l&&we(function(){for(var w=new d,_=5;_--;)w[o](_,_);return!w.has(-0)});b||((h=n(function(w,_){ao(w,h,e);var C=ti(new d,w,h);return _!=null&&ng(_,C[o],C,a),C})).prototype=s,s.constructor=h),(y||k)&&(p("delete"),p("has"),a&&p("get")),(k||v)&&p(o),l&&s.clear&&delete s.clear}f[e]=h,Ce({global:!0,forced:h!=d},f),Ms(h,e),l||t.setStrong(h,e,a)}("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},{getConstructor:function(e,n,t,a){var l=e(function(h,f){ao(h,l,n),cg(h,{type:n,index:gl(null),first:void 0,last:void 0,size:0}),H||(h.size=0),f!=null&&ng(f,h[a],h,t)}),o=nm(n),d=function(h,f,p){var g,v,y=o(h),b=s(h,f);return b?b.value=p:(y.last=b={index:v=ug(f,!0),key:f,value:p,previous:g=y.last,next:void 0,removed:!1},y.first||(y.first=b),g&&(g.next=b),H?y.size++:h.size++,v!=="F"&&(y.index[v]=b)),h},s=function(h,f){var p,g=o(h),v=ug(f);if(v!=="F")return g.index[v];for(p=g.first;p;p=p.next)if(p.key==f)return p};return Tc(l.prototype,{clear:function(){for(var h=o(this),f=h.index,p=h.first;p;)p.removed=!0,p.previous&&(p.previous=p.previous.next=void 0),delete f[p.index],p=p.next;h.first=h.last=void 0,H?h.size=0:this.size=0},delete:function(h){var f=o(this),p=s(this,h);if(p){var g=p.next,v=p.previous;delete f.index[p.index],p.removed=!0,v&&(v.next=g),g&&(g.previous=v),f.first==p&&(f.first=g),f.last==p&&(f.last=v),H?f.size--:this.size--}return!!p},forEach:function(h){for(var f,p=o(this),g=ru(h,arguments.length>1?arguments[1]:void 0,3);f=f?f.next:p.first;)for(g(f.value,f.key,this);f&&f.removed;)f=f.previous},has:function(h){return!!s(this,h)}}),Tc(l.prototype,t?{get:function(h){var f=s(this,h);return f&&f.value},set:function(h,f){return d(this,h===0?0:h,f)}}:{add:function(h){return d(this,h=h===0?0:h,h)}}),H&&Fb(l.prototype,"size",{get:function(){return o(this).size}}),l},setStrong:function(e,n,t){var a=n+" Iterator",l=nm(n),o=nm(a);Lh(e,n,function(d,s){cg(this,{type:a,target:d,state:l(d),kind:s,last:void 0})},function(){for(var d=o(this),s=d.kind,h=d.last;h&&h.removed;)h=h.previous;return d.target&&(d.last=h=h?h.next:d.state.first)?s=="keys"?{value:h.key,done:!1}:s=="values"?{value:h.value,done:!1}:{value:[h.key,h.value],done:!1}:(d.target=void 0,{value:void 0,done:!0})},t?"entries":"values",!t,!0),sh(n)}}),Wd.charAt),Mb=Vt.set,Nb=Vt.getterFor("String Iterator");function dg(e,n){return e.replace(/\$\{([\w]+)\}/g,function(t,a){var l=n[a];return l!==void 0?l:t})}Lh(String,"String",function(e){Mb(this,{type:"String Iterator",string:String(e),index:0})},function(){var e,n=Nb(this),t=n.string,a=n.index;return a>=t.length?{value:void 0,done:!0}:(e=qb(t,a),n.index+=e.length,{value:e,done:!1})});var _o="#VALUE!",T={getCellDataArr:function(e,n,t){var a=[];if(e.data==null)t||(n==="number"?a.push(0):n==="text"&&a.push(""));else if(D(e.data)==="array")for(var l=0;l<e.data.length;l++)for(var o=0;o<e.data[l].length;o++){var d=e.data[l][o],s=d;D(d)==="object"&&(s=d.v),s==null?t||(n==="number"?s=0:n==="text"&&(s=""),a.push(s)):a.push(s)}else $t(e.data.v)?t||(n=="number"?a.push(0):n=="text"&&a.push("")):a.push(e.data.v);return a},getCellDataDyadicArr:function(e,n){var t=[];if(e.data==null){var a=[];n=="number"?a.push(0):n=="text"&&a.push(""),t.push(a)}else if(D(e.data)=="array")for(var l=0;l<e.data.length;l++){for(var o=[],d=0;d<e.data[l].length;d++){var s=e.data[l][d],h=s;D(s)==="object"&&(h=s.v),h==null&&(n==="number"?h=0:n==="text"&&(h="")),o.push(h)}t.push(o)}else{var f=[],p=e.data.v;$t(p)&&(n=="number"?p=0:n=="text"&&(p="")),f.push(p),t.push(f)}return t},getDataArr:function(e,n){var t=[];if(n==null&&(n=!1),D(e[0])=="array")for(var a=0;a<e.length;a++)for(var l=0;l<e[a].length;l++)n&&!M(e[a][l])||t.push(e[a][l]);else for(var o=0;o<e.length;o++)n&&!M(e[o])||t.push(e[o]);return t},getDataDyadicArr:function(e){var n=[];if(D(e[0])=="array")for(var t=0;t<e.length;t++){for(var a=[],l=0;l<e[t].length;l++)a.push(e[t][l]);n.push(a)}else{for(var o=[],d=0;d<e.length;d++)o.push(e[d]);n.push(o)}return n},isDyadicArr:function(e){var n=!0;if(e.length>1){for(var t=e[0].length,a=1;a<e.length;a++)if(e[a].length!=t){n=!1;break}}return n},getFirstValue:function(e,n){var t;if(n==null&&(n="number"),D(e)=="array")if(D(e[0])=="array"){if(!this.isDyadicArr(e))return _o;t=e[0][0]}else t=e[0];else if(D(e)=="object"&&e.startCell!=null)if(e.data==null)n=="number"?t=0:n=="text"&&(t="");else{var a=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn;if(e.rowl==1&&e.coll==1)(t=e.data)==null||$t(t.v)?n=="number"?t=0:n=="text"&&(t=""):t=t.v;else if(e.data[0][0].mc!=null&&e.data[0][0].mc.rs==e.rowl&&e.data[0][0].mc.cs==e.coll)(t=e.data[0][0])==null||$t(t.v)?n=="number"?t=0:n=="text"&&(t=""):t=t.v;else{if(e.rowl!=1&&e.coll!=1)return _o;var o=m.getcellrange(e.startCell),d=o.row[0],s=d+e.rowl-1,h=o.column[0],f=h+e.coll-1;if(e.rowl==1){if(l<h||l>f)return _o;t=e.data[0][l-h]}else if(e.coll==1){if(a<d||a>s)return _o;t=e.data[a-d][0]}t==null||$t(t.v)||t.mc!=null?n=="number"?t=0:n=="text"&&(t=""):t=t.v}}else t=e;return t},getCellBoolen:function(e){var n=this.getFirstValue(e);if(j(n))return n;if(D(n)!="boolean")if(D(n)!="string"||n.toLowerCase()!="true"&&n.toLowerCase()!="false"){if(!M(n))return _o;n=(n=parseFloat(n))!=0}else n.toLowerCase()=="true"?n=!0:n.toLowerCase()=="false"&&(n=!1);return n},getCellDate:function(e){var n;if(D(e)=="array")if(D(e[0])=="array"){if(!this.isDyadicArr(e))return _o;n=e[0][0]}else n=e[0];else if(D(e)=="object"&&e.startCell!=null){if(e.data==null||D(e.data)=="array"||$t(e.data.v))return _o;n=e.data.v,e.data.ct!=null&&e.data.ct.t=="d"&&(n=za("YYYY-MM-DD h:mm:ss",n))}else n=e;return n},getCellrangeDate:function(e){var n=[];if(D(e)=="array"){if(D(e[0])=="array"&&!this.isDyadicArr(e))return _o;n=n.concat(this.getDataArr(e,!1))}else if(D(e)=="object"&&e.startCell!=null)if(e.data==null)n.push(0);else if(D(e.data)=="array")for(var t=0;t<e.data.length;t++)for(var a=0;a<e.data[t].length;a++)if(e.data[t][a]==null||$t(e.data[t][a].v))n.push(0);else{var l=e.data[t][a].v;e.data[t][a].ct!=null&&e.data[t][a].ct.t=="d"&&(l=za("YYYY-MM-DD h:mm:ss",l)),n.push(l)}else{var o=e.data.v;e.data.ct!=null&&e.data.ct.t=="d"&&(o=za("YYYY-MM-DD h:mm:ss",o)),n.push(o)}else n.push(e);return n},getRegExpStr:function(e){return e.replace("~*","\\*").replace("~?","\\?").replace(".","\\.").replace("*",".*").replace("?",".")},factorial:function(e){return e==0||e==1?1:e*this.factorial(e-1)},factorialDouble:function(e){return e<=0?1:e*this.factorialDouble(e-2)},variance:function(e){for(var n=0,t=0,a=0;a<e.length;a++)n+=e[a],t++;for(var l=n/t,o=0,d=0;d<e.length;d++){var s=e[d];o+=(s-l)*(s-l)}return o/t},variance_s:function(e){for(var n=0,t=0,a=0;a<e.length;a++)n+=e[a],t++;for(var l=n/t,o=0,d=0;d<e.length;d++){var s=e[d];o+=(s-l)*(s-l)}return o/(t-1)},standardDeviation:function(e){for(var n=0,t=0,a=0;a<e.length;a++)n+=e[a],t++;for(var l=n/t,o=0,d=0;d<e.length;d++){var s=e[d];o+=(s-l)*(s-l)}return Math.sqrt(o/t)},standardDeviation_s:function(e){for(var n=0,t=0,a=0;a<e.length;a++)n+=e[a],t++;for(var l=n/t,o=0,d=0;d<e.length;d++){var s=e[d];o+=(s-l)*(s-l)}return Math.sqrt(o/(t-1))},isLeapYear:function(e){return new Date(e,1,29).getMonth()===1},feb29Between:function(e,n){var t=Q(e).year(),a=Q().set({year:t,month:2,date:1});if(this.isLeapYear(t)&&Q(e)<Q(a)&&Q(n)>=Q(a))return!0;var l=Q(n).year(),o=Q().set({year:l,month:2,date:1});return this.isLeapYear(l)&&Q(n)>=Q(o)&&Q(e)<Q(o)},findResultIndex:function(e,n){for(var t={},a=1;a<e[0].length;++a)t[a]=!0;var l=n[0].length;for(i=1;i<n.length;++i)n[i].length>l&&(l=n[i].length);for(var o=1;o<e.length;++o)for(var d=1;d<e[o].length;++d){for(var s=!1,h=!1,f=0;f<n.length;++f){var p=n[f];if(!(p.length<l)){var g=p[0];if(e[o][0]===g){h=!0;for(var v=1;v<p.length;++v)s=s||new Function("return "+e[o][d]+p[v])()}}}h&&(t[d]=t[d]&&s)}for(var y=[],b=0;b<e[0].length;++b)t[b]&&y.push(b-1);return y},findField:function(e,n){for(var t=null,a=0;a<e.length;a++)if(e[a][0]==n){t=a;break}return t??_o},rest:function(e,n){return n=n||1,e&&typeof e.slice=="function"?e.slice(n):e},compact:function(e){if(!e)return e;for(var n=[],t=0;t<e.length;++t)e[t]&&n.push(e[t]);return n}},hg={};function mg(e){return hg.sylvester_matrix.create(e).inverse().elements}function Ac(){var e,n=arguments[1],t=arguments[0];D(t)=="object"&&t.startCell!=null?(e=n=="&"?T.getCellDataDyadicArr(t,"text"):T.getCellDataDyadicArr(t,"number")).length==1&&e[0].length==1&&(e=e[0][0]):e=t;var a,l=arguments[2];if(D(l)=="object"&&l.startCell!=null?(a=n=="&"?T.getCellDataDyadicArr(l,"text"):T.getCellDataDyadicArr(l,"number")).length==1&&a[0].length==1&&(a=a[0][0]):a=l,j(e))return e;if(j(a))return a;if(D(e)=="array"&&D(e[0])=="array"&&!T.isDyadicArr(e)||D(a)=="array"&&D(a[0])=="array"&&!T.isDyadicArr(a))return yr.v;if(n=="<>"&&(n="!="),n=="="&&(n="=="),e==null&&a==null)return"#INVERSE!";if(e=="#INVERSE!")e=0,n=="-"?n="+":n=="+"&&(n="-");else if(n=="-"&&e==null)e=0;else if(n=="/"&&(a==0||a==null))return yr.d;function o(Cl,Vo,_i){return M(Cl)&&(Cl=parseFloat(Cl)),M(_i)&&(_i=parseFloat(_i)),Vo=="=="?Cl==_i:Vo=="!="?Cl!=_i:Vo==">="?Cl>=_i:Vo=="<="?Cl<=_i:Vo==">"?Cl>_i:Vo=="<"?Cl<_i:void 0}function d(Cl){return Cl==null?Cl:Cl.toString().toLowerCase()=="true"?1:Cl.toString().toLowerCase()=="false"?0:Cl}if(n=="*"){if(D(e)=="array"&&D(a)=="array"){var s=[];if(D(e[0])=="array"&&D(a[0])=="array")if(e.length==a.length&&e[0].length==a[0].length)for(var h=0;h<e.length;h++){for(var f=[],p=0;p<e[h].length;p++){e[h][p]=d(e[h][p]),a[h][p]=d(a[h][p]);var g=void 0;g=M(e[h][p])&&M(a[h][p])?Xa(e[h][p],n,a[h][p]):yr.v,f.push(g)}s.push(f)}else if(e[0].length==a.length)for(var v=e.length,y=a[0].length,b=0;b<v;b++){for(var k=[],w=0;w<y;w++){for(var _=0,C=0;C<e[0].length;C++)e[b][C]=d(e[b][C]),a[C][w]=d(a[C][w]),M(e[b][C])&&M(a[C][w])?_+=Xa(e[b][C],n,a[C][w]):_+=yr.v;_.toString()=="NaN"&&(_=yr.v),k.push(_)}s.push(k)}else{if(e.length!=a[0].length)return yr.na;for(var A=a.length,I=e[0].length,S=0;S<A;S++){for(var E=[],R=0;R<I;R++){for(var F=0,N=0;N<a[0].length;N++)e[N][R]=d(e[N][R]),a[S][N]=d(a[S][N]),M(a[S][N])&&M(e[N][R])?F+=Xa(e[N][R],n,a[S][N]):F+=yr.v;F.toString()=="NaN"&&(F=yr.v),E.push(F)}s.push(E)}}else if(D(e[0])=="array")if(e[0].length==a.length)for(var z=0;z<e.length;z++){for(var P=[],q=0;q<e[z].length;q++){e[z][q]=d(e[z][q]),a[q]=d(a[q]);var V=void 0;V=M(e[z][q])&&M(a[q])?Xa(e[z][q],n,a[q]):yr.v,P.push(V)}s.push(P)}else{if(e[0].length!=1)return yr.na;for(var x=e.length,ee=a.length,ne=0;ne<x;ne++){for(var ae=[],de=0;de<ee;de++){e[ne][0]=d(e[ne][0]),a[de]=d(a[de]);var ve=void 0;ve=M(e[ne][0])&&M(a[de])?Xa(e[ne][0],n,a[de]):yr.v,ae.push(ve)}s.push(ae)}}else if(D(a[0])=="array")if(a[0].length==e.length)for(var U=0;U<a.length;U++){for(var B=[],le=0;le<a[U].length;le++){e[le]=d(e[le]),a[U][le]=d(a[U][le]);var Te=void 0;Te=M(e[le])&&M(a[U][le])?Xa(e[le],n,a[U][le]):yr.v,B.push(Te)}s.push(B)}else{if(a[0].length!=1)return yr.na;for(var ue=a.length,be=e.length,ye=0;ye<ue;ye++){for(var ce=[],Re=0;Re<be;Re++){e[Re]=d(e[Re]),a[ye][0]=d(a[ye][0]);var pe=void 0;pe=M(e[Re])&&M(a[ye][0])?Xa(e[Re],n,a[ye][0]):yr.v,ce.push(pe)}s.push(ce)}}else{if(e.length!=a.length)return yr.na;for(var me=0;me<e.length;me++){e[me]=d(e[me]),a[me]=d(a[me]);var re=void 0;re=M(e[me])&&M(a[me])?Xa(e[me],n,a[me]):yr.v,s.push(re)}}return s}if(D(e)=="array"){a=d(a);var _e=[];if(D(e[0])=="array")for(var Ze=0;Ze<e.length;Ze++){for(var We=[],Xe=0;Xe<e[Ze].length;Xe++){e[Ze][Xe]=d(e[Ze][Xe]);var Ue=void 0;Ue=M(e[Ze][Xe])&&M(a)?Xa(e[Ze][Xe],n,a):yr.v,We.push(Ue)}_e.push(We)}else for(var mt=0;mt<e.length;mt++){e[mt]=d(e[mt]);var St=void 0;St=M(e[mt])&&M(a)?Xa(e[mt],n,a):yr.v,_e.push(St)}return _e}if(D(a)=="array"){e=d(e);var at=[];if(D(a[0])=="array")for(var dt=0;dt<a.length;dt++){for(var wt=[],ct=0;ct<a[dt].length;ct++){a[dt][ct]=d(a[dt][ct]);var bt=void 0;bt=M(e)&&M(a[dt][ct])?Xa(e,n,a[dt][ct]):yr.v,wt.push(bt)}at.push(wt)}else for(var De=0;De<a.length;De++){a[De]=d(a[De]);var He=void 0;He=M(e)&&M(a[De])?Xa(e,n,a[De]):yr.v,at.push(He)}return at}return e=d(e),a=d(a),M(e)&&M(a)?Xa(e,n,a):yr.v}if(n=="/"){if(D(e)=="array"&&D(a)=="array"){var Dt=[];if(D(e[0])=="array"&&D(a[0])=="array")if(e.length==a.length&&e[0].length==a[0].length)for(var et=0;et<e.length;et++){for(var ur=[],Xt=0;Xt<e[et].length;Xt++){e[et][Xt]=d(e[et][Xt]),a[et][Xt]=d(a[et][Xt]);var jt=void 0;jt=M(e[et][Xt])&&M(a[et][Xt])?parseFloat(a[et][Xt])==0?yr.d:Xa(e[et][Xt],n,a[et][Xt]):yr.v,ur.push(jt)}Dt.push(ur)}else{if(e[0].length!=a.length)return yr.na;for(var lr=mg(a),tr=e.length,xr=lr[0].length,rr=0;rr<tr;rr++){for(var nr=[],Ut=0;Ut<xr;Ut++){for(var ar=0,Jt=0;Jt<e[0].length;Jt++)e[rr][Jt]=d(e[rr][Jt]),lr[Jt][Ut]=d(lr[Jt][Ut]),M(e[rr][Jt])&&M(lr[Jt][Ut])?ar+=Xa(e[rr][Jt],"*",lr[Jt][Ut]):ar+=yr.v;ar.toString()=="NaN"&&(ar=yr.v),nr.push(ar)}Dt.push(nr)}}else if(D(e[0])=="array")if(e[0].length==a.length)for(var Qt=0;Qt<e.length;Qt++){for(var _t=[],er=0;er<e[Qt].length;er++){e[Qt][er]=d(e[Qt][er]),a[er]=d(a[er]);var Kt=void 0;Kt=M(e[Qt][er])&&M(a[er])?parseFloat(a[er])==0?yr.d:Xa(e[Qt][er],n,a[er]):yr.v,_t.push(Kt)}Dt.push(_t)}else{if(e[0].length!=1)return yr.na;for(var mr=e.length,fr=a.length,Wt=0;Wt<mr;Wt++){for(var ze=[],Ae=0;Ae<fr;Ae++){e[Wt][0]=d(e[Wt][0]),a[Ae]=d(a[Ae]);var Ve=void 0;Ve=M(e[Wt][0])&&M(a[Ae])?parseFloat(a[Ae])==0?yr.d:Xa(e[Wt][0],n,a[Ae]):yr.v,ze.push(Ve)}Dt.push(ze)}}else if(D(a[0])=="array")if(a[0].length==e.length)for(var gt=0;gt<a.length;gt++){for(var vt=[],pt=0;pt<a[gt].length;pt++){e[pt]=d(e[pt]),a[gt][pt]=d(a[gt][pt]);var Tt=void 0;Tt=M(e[pt])&&M(a[gt][pt])?parseFloat(a[gt][pt])==0?yr.d:Xa(e[pt],n,a[gt][pt]):yr.v,vt.push(Tt)}Dt.push(vt)}else{if(a[0].length!=1)return yr.na;for(var Ot=a.length,It=e.length,Lt=0;Lt<Ot;Lt++){for(var At=[],or=0;or<It;or++){e[or]=d(e[or]),a[Lt][0]=d(a[Lt][0]);var Cr=void 0;Cr=M(e[or])&&M(a[Lt][0])?parseFloat(a[Lt][0])==0?yr.d:Xa(e[or],n,a[Lt][0]):yr.v,At.push(Cr)}Dt.push(At)}}else{if(e.length!=a.length)return yr.na;for(var Ar=0;Ar<e.length;Ar++){e[Ar]=d(e[Ar]),a[Ar]=d(a[Ar]);var Rr=void 0;Rr=M(e[Ar])&&M(a[Ar])?parseFloat(a[Ar])==0?yr.d:Xa(e[Ar],n,a[Ar]):yr.v,Dt.push(Rr)}}return Dt}if(D(e)=="array"){a=d(a);var Zr=[];if(D(e[0])=="array")for(var Tr=0;Tr<e.length;Tr++){for(var jr=[],ta=0;ta<e[Tr].length;ta++){e[Tr][ta]=d(e[Tr][ta]);var ia=void 0;ia=M(e[Tr][ta])&&M(a)?parseFloat(a)==0?yr.d:Xa(e[Tr][ta],n,a):yr.v,jr.push(ia)}Zr.push(jr)}else for(var Jr=0;Jr<e.length;Jr++){e[Jr]=d(e[Jr]);var ba=void 0;ba=M(e[Jr])&&M(a)?parseFloat(a)==0?yr.d:Xa(e[Jr],n,a):yr.v,Zr.push(ba)}return Zr}if(D(a)=="array"){e=d(e);var Wr=[];if(D(a[0])=="array")for(var Fr=0;Fr<a.length;Fr++){for(var oa=[],Fa=0;Fa<a[Fr].length;Fa++){a[Fr][Fa]=d(a[Fr][Fa]);var Da=void 0;Da=M(e)&&M(a[Fr][Fa])?parseFloat(a[Fr][Fa])==0?yr.d:Xa(e,n,a[Fr][Fa]):yr.v,oa.push(Da)}Wr.push(oa)}else for(var va=0;va<a.length;va++){a[va]=d(a[va]);var Ha=void 0;Ha=M(e)&&M(a[va])?parseFloat(a[va])==0?yr.d:Xa(e,n,a[va]):yr.v,Wr.push(Ha)}return Wr}return e=d(e),a=d(a),M(e)&&M(a)?parseFloat(a)==0?yr.d:Xa(e,n,a):yr.v}if(n=="+"||n=="-"||n=="%"){if(D(e)=="array"&&D(a)=="array"){var qr=[];if(D(e[0])=="array"&&D(a[0])=="array"){if(e.length!=a.length&&e[0].length!=a[0].length)return yr.na;for(var Ca=0;Ca<e.length;Ca++){for(var La=[],Ea=0;Ea<e[Ca].length;Ea++){e[Ca][Ea]=d(e[Ca][Ea]),a[Ca][Ea]=d(a[Ca][Ea]);var Za=void 0;Za=M(e[Ca][Ea])&&M(a[Ca][Ea])?n=="%"&&parseFloat(a[Ca][Ea])==0?yr.d:Xa(e[Ca][Ea],n,a[Ca][Ea]):yr.v,La.push(Za)}qr.push(La)}}else if(D(e[0])=="array"){if(e[0].length!=a.length)return yr.na;for(var gn=0;gn<e.length;gn++){for(var Ka=[],ka=0;ka<e[gn].length;ka++){e[gn][ka]=d(e[gn][ka]),a[ka]=d(a[ka]);var Pa=void 0;Pa=M(e[gn][ka])&&M(a[ka])?n=="%"&&parseFloat(a[ka])==0?yr.d:Xa(e[gn][ka],n,a[ka]):yr.v,Ka.push(Pa)}qr.push(Ka)}}else if(D(a[0])=="array"){if(a[0].length!=e.length)return yr.na;for(var $a=0;$a<a.length;$a++){for(var on=[],Dn=0;Dn<a[$a].length;Dn++){e[Dn]=d(e[Dn]),a[$a][Dn]=d(a[$a][Dn]);var Fn=void 0;Fn=M(e[Dn])&&M(a[$a][Dn])?n=="%"&&parseFloat(a[$a][Dn])==0?yr.d:Xa(e[Dn],n,a[$a][Dn]):yr.v,on.push(Fn)}qr.push(on)}}else{if(e.length!=a.length)return yr.na;for(var _n=0;_n<e.length;_n++){e[_n]=d(e[_n]),a[_n]=d(a[_n]);var dl=void 0;dl=M(e[_n])&&M(a[_n])?n=="%"&&parseFloat(a[_n])==0?yr.d:Xa(e[_n],n,a[_n]):yr.v,qr.push(dl)}}return qr}if(D(e)=="array"){a=d(a);var Or=[];if(D(e[0])=="array")for(var en=0;en<e.length;en++){for(var hn=[],tn=0;tn<e[en].length;tn++){e[en][tn]=d(e[en][tn]);var Sn=void 0;Sn=M(e[en][tn])&&M(a)?n=="%"&&parseFloat(a)==0?yr.d:Xa(e[en][tn],n,a):yr.v,hn.push(Sn)}Or.push(hn)}else for(var vn=0;vn<e.length;vn++){e[vn]=d(e[vn]);var Kn=void 0;Kn=M(e[vn])&&M(a)?n=="%"&&parseFloat(a)==0?yr.d:Xa(e[vn],n,a):yr.v,Or.push(Kn)}return Or}if(D(a)=="array"){e=d(e);var ni=[];if(D(a[0])=="array")for(var Jn=0;Jn<a.length;Jn++){for(var li=[],Ma=0;Ma<a[Jn].length;Ma++){a[Jn][Ma]=d(a[Jn][Ma]);var nl=void 0;nl=M(e)&&M(a[Jn][Ma])?n=="%"&&parseFloat(a[Jn][Ma])==0?yr.d:Xa(e,n,a[Jn][Ma]):yr.v,li.push(nl)}ni.push(li)}else for(var Pn=0;Pn<a.length;Pn++){a[Pn]=d(a[Pn]);var Mr=void 0;Mr=M(e)&&M(a[Pn])?n=="%"&&parseFloat(a[Pn])==0?yr.d:Xa(e,n,a[Pn]):yr.v,ni.push(Mr)}return ni}return e=d(e),a=d(a),M(e)&&M(a)?n=="%"&&parseFloat(a)==0?yr.d:Xa(e,n,a):yr.v}if(n=="=="||n=="!="||n==">="||n=="<="||n==">"||n=="<"){if(D(e)=="array"&&D(a)=="array"){var Qn=[];if(D(e[0])=="array"&&D(a[0])=="array"){if(e.length!=a.length&&e[0].length!=a[0].length)return yr.na;for(var Ja=0;Ja<e.length;Ja++){for(var ii=[],On=0;On<e[Ja].length;On++){var Eo=o(e[Ja][On],n,a[Ja][On]);ii.push(Eo)}Qn.push(ii)}}else if(D(e[0])=="array"){if(e[0].length!=a.length)return yr.na;for(var Vi=0;Vi<e.length;Vi++){for(var cs=[],oi=0;oi<e[Vi].length;oi++){var ds=o(e[Vi][oi],n,a[oi]);cs.push(ds)}Qn.push(cs)}}else if(D(a[0])=="array"){if(a[0].length!=e.length)return yr.na;for(var wl=0;wl<a.length;wl++){for(var Al=[],sl=0;sl<a[wl].length;sl++){var Vl=o(e[sl],n,a[wl][sl]);Al.push(Vl)}Qn.push(Al)}}else{if(e.length!=a.length)return yr.na;for(var _l=0;_l<e.length;_l++){var $o=o(e[_l],n,a[_l]);Qn.push($o)}}return Qn}if(D(e)=="array"){var uo=[];if(D(e[0])=="array")for(var hl=0;hl<e.length;hl++){for(var xi=[],ll=0;ll<e[hl].length;ll++){var Wn=o(e[hl][ll],n,a);xi.push(Wn)}uo.push(xi)}else for(var jn=0;jn<e.length;jn++){var Ul=o(e[jn],n,a);uo.push(Ul)}return uo}if(D(a)=="array"){var Ll=[];if(D(a[0])=="array")for(var ml=0;ml<a.length;ml++){for(var si=[],Hl=0;Hl<a[ml].length;Hl++){var Sl=o(e,n,a[ml][Hl]);si.push(Sl)}Ll.push(si)}else for(var hs=0;hs<a.length;hs++){var Do=o(e,n,a[hs]);Ll.push(Do)}return Ll}return o(e,n,a)}if(n=="&"){if(D(e)=="array"&&D(a)=="array"){var Ui=[];if(D(e[0])=="array"&&D(a[0])=="array"){if(e.length!=a.length&&e[0].length!=a[0].length)return yr.na;for(var ui=0;ui<e.length;ui++){for(var wi=[],Ql=0;Ql<e[ui].length;Ql++)wi.push(e[ui][Ql]+""+a[ui][Ql]);Ui.push(wi)}}else if(D(e[0])=="array"){if(e[0].length!=a.length)return yr.na;for(var Fo=0;Fo<e.length;Fo++){for(var ms=[],fs=0;fs<e[Fo].length;fs++)ms.push(e[Fo][fs]+""+a[fs]);Ui.push(ms)}}else if(D(a[0])=="array"){if(a[0].length!=e.length)return yr.na;for(var Fu=0;Fu<a.length;Fu++){for(var Md=[],qo=0;qo<a[Fu].length;qo++)Md.push(e[qo]+""+a[Fu][qo]);Ui.push(Md)}}else{if(e.length!=a.length)return yr.na;for(var Mo=0;Mo<e.length;Mo++)Ui.push(e[Mo]+""+a[Mo])}return Ui}if(D(e)=="array"){var ps=[];if(D(e[0])=="array")for(var No=0;No<e.length;No++){for(var qu=[],Ws=0;Ws<e[No].length;Ws++)qu.push(e[No][Ws]+""+a);ps.push(qu)}else for(var Ys=0;Ys<e.length;Ys++)ps.push(e[Ys]+""+a);return ps}if(D(a)=="array"){var Xs=[];if(D(a[0])=="array")for(var Mu=0;Mu<a.length;Mu++){for(var Nc=[],Lo=0;Lo<a[Mu].length;Lo++)Nc.push(e+""+a[Mu][Lo]);Xs.push(Nc)}else for(var Lc=0;Lc<a.length;Lc++)Xs.push(e+""+a[Lc]);return Xs}return e+""+a}if(n=="^"){if(D(e)=="array"&&D(a)=="array"){var Zs=[];if(D(e[0])=="array"&&D(a[0])=="array"){if(e.length!=a.length&&e[0].length!=a[0].length)return yr.na;for(var jl=0;jl<e.length;jl++){for(var Nd=[],ci=0;ci<e[jl].length;ci++){e[jl][ci]=d(e[jl][ci]),a[jl][ci]=d(a[jl][ci]);var gs=void 0;gs=M(e[jl][ci])&&M(a[jl][ci])?Math.pow(parseFloat(e[jl][ci]),parseFloat(a[jl][ci])):yr.v,Nd.push(gs)}Zs.push(Nd)}}else if(D(e[0])=="array"){if(e[0].length!=a.length)return yr.na;for(var Po=0;Po<e.length;Po++){for(var Nu=[],di=0;di<e[Po].length;di++){e[Po][di]=d(e[Po][di]),a[di]=d(a[di]);var Ld=void 0;Ld=M(e[Po][di])&&M(a[di])?Math.pow(parseFloat(e[Po][di]),parseFloat(a[di])):yr.v,Nu.push(Ld)}Zs.push(Nu)}}else if(D(a[0])=="array"){if(a[0].length!=e.length)return yr.na;for(var Oo=0;Oo<a.length;Oo++){for(var Pc=[],hi=0;hi<a[Oo].length;hi++){e[hi]=d(e[hi]),a[Oo][hi]=d(a[Oo][hi]);var vs=void 0;vs=M(e[hi])&&M(a[Oo][hi])?Math.pow(parseFloat(e[hi]),parseFloat(a[Oo][hi])):yr.v,Pc.push(vs)}Zs.push(Pc)}}else{if(e.length!=a.length)return yr.na;for(var Pl=0;Pl<e.length;Pl++){e[Pl]=d(e[Pl]),a[Pl]=d(a[Pl]);var Oc=void 0;Oc=M(e[Pl])&&M(a[Pl])?Math.pow(parseFloat(e[Pl]),parseFloat(a[Pl])):yr.v,Zs.push(Oc)}}return Zs}if(D(e)=="array"){a=d(a);var Lu=[];if(D(e[0])=="array")for(var zo=0;zo<e.length;zo++){for(var Pd=[],Bo=0;Bo<e[zo].length;Bo++){e[zo][Bo]=d(e[zo][Bo]);var Pu=void 0;Pu=M(e[zo][Bo])&&M(a)?Math.pow(parseFloat(e[zo][Bo]),parseFloat(a)):yr.v,Pd.push(Pu)}Lu.push(Pd)}else for(var co=0;co<e.length;co++){e[co]=d(e[co]);var zc=void 0;zc=M(e[co])&&M(a)?Math.pow(parseFloat(e[co]),parseFloat(a)):yr.v,Lu.push(zc)}return Lu}if(D(a)=="array"){e=d(e);var Ou=[];if(D(a[0])=="array")for(var ei=0;ei<a.length;ei++){for(var Hi=[],mi=0;mi<a[ei].length;mi++){a[ei][mi]=d(a[ei][mi]);var ji=void 0;ji=M(e)&&M(a[ei][mi])?Math.pow(parseFloat(e),parseFloat(a[ei][mi])):yr.v,Hi.push(ji)}Ou.push(Hi)}else for(var ys=0;ys<a.length;ys++){a[ys]=d(a[ys]);var Bc=void 0;Bc=M(e)&&M(a[ys])?Math.pow(parseFloat(e),parseFloat(a[ys])):yr.v,Ou.push(Bc)}return Ou}return e=d(e),a=d(a),M(e)&&M(a)?Math.pow(parseFloat(e),parseFloat(a)):yr.v}}function fg(){var e=arguments[0],n=[];if((e=e.replace("{","").replace("}","").replace(/\"/g,"")).indexOf(";")>-1){n=e.split(";");for(var t=0;t<n.length;t++)n[t]=n[t].split(",")}else n=e.split(",");return n}function Xa(e,n,t){var a;return n=="+"?a=cn(e).add(t).value():n=="-"?a=cn(e).subtract(t).value():n=="%"?a=new Function("return "+parseFloat(e)+n+"("+parseFloat(t)+")")():n=="/"?a=cn(e).divide(t).value():n=="*"&&(a=cn(e).multiply(t).value()),a}function no(e){if(window.luckysheet_getcelldata_cache==null&&(window.luckysheet_getcelldata_cache={}),e in window.luckysheet_getcelldata_cache)return window.luckysheet_getcelldata_cache[e];var n=an(),t=e.split("!"),a="",l="",o=-1,d=null;if(t.length>1){for(var s in a=t[0].replace(/''/g,"'"),l=t[1],a.substr(0,1)=="'"&&a.substr(a.length-1,1)=="'"&&(a=a.substring(1,a.length-1)),n)if(a==n[s].name){o=n[s].index,d=n[s].data;break}o==-1&&(o=0)}else{var h=je(u.calculateSheetIndex);a=n[h].name,o=n[h].index,d=n[h].data,l=t[0]}if(l.indexOf(":")==-1){var f=parseInt(l.replace(/[^0-9]/g,""))-1,p=rl(l.replace(/[^A-Za-z]/g,""));if(isNaN(f)||isNaN(p))return[];var g=$h(d,{row:[f,f],column:[p,p]})[0][0];if(m.execFunctionGlobalData!=null){var v=m.execFunctionGlobalData[f+"_"+p+"_"+o];v!=null&&(g=v)}var y={sheetName:a,startCell:l,rowl:1,coll:1,data:g};return window.luckysheet_getcelldata_cache[e]=y,y}l=l.split(":");var b=[],k=[];if(b[0]=parseInt(l[0].replace(/[^0-9]/g,""))-1,b[1]=parseInt(l[1].replace(/[^0-9]/g,""))-1,isNaN(b[0])&&(b[0]=0),isNaN(b[1])&&(b[1]=d.length-1),b[0]>b[1])return Ee.info("",""),[];if(k[0]=rl(l[0].replace(/[^A-Za-z]/g,"")),k[1]=rl(l[1].replace(/[^A-Za-z]/g,"")),isNaN(k[0])&&(k[0]=0),isNaN(k[1])&&(k[1]=d[0].length-1),k[0]>k[1])return Ee.info("",""),[];var w=$h(d,{row:b,column:k});if(m.execFunctionGlobalData!=null)for(var _=b[0];_<=b[1];_++)for(var C=k[0];C<=k[1];C++){var A=m.execFunctionGlobalData[_+"_"+C+"_"+o];A!=null&&(w[_-b[0]][C-k[0]]=A)}var I=b[1]-b[0]+1,S=k[1]-k[0]+1,E={sheetName:a,startCell:l[0],rowl:I,coll:S,data:w};return window.luckysheet_getcelldata_cache[e]=E,E}function fd(e){return ul(e)==="object"?e==null?"":Array.isArray(e)?_a(e[0])[2]:Array.isArray(e.data)?yr.v:e.data.v===void 0?"":e.data.v:m.isCompareOperator(e).flag?typeof e=="string"||typeof e=="number"?e:yr.v:_a(e)[2]}function Bs(){for(var e=arguments[0],n=0;n<e.length;n++){var t=e[n];if(ul(t)==="object")if(t==null)t="";else if(Array.isArray(t)){var a=_a(t[0]);t=a[2]}else t=Array.isArray(t.data)?t.data:t.data.v===void 0?"":t.data.v;else if(!m.isCompareOperator(t).flag){var l=_a(t);t=l[2]}e[n]=t}}function pg(){var e=arguments[0];return e==null||e.length==0?null:e}function gg(e){return e}function vg(){if(D(arguments[0])!="object"||arguments[0].startCell==null)return m.error.v;var e=arguments[0].startCell,n=T.getFirstValue(arguments[1]);if(j(n))return n;if(!M(n))return m.error.v;n=parseInt(n);var t=T.getFirstValue(arguments[2]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=arguments[0].rowl;if(arguments.length>=4){if(j(a=T.getFirstValue(arguments[3])))return a;if(!M(a))return m.error.v;a=parseInt(a)}var l=arguments[0].coll;if(arguments.length==5){if(j(l=T.getFirstValue(arguments[4])))return l;if(!M(l))return m.error.v;l=parseInt(l)}if(a<1||l<1)return m.error.r;var o=m.getcellrange(e),d=o.row[0],s=o.column[0],h=(d+=n)+a-1,f=(s+=t)+l-1;return d<0||h>=u.flowdata.length||s<0||f>=u.flowdata[0].length?m.error.r:wn(u.calculateSheetIndex,{row:[d,h],column:[s,f]})}function yg(e,n,t){var a,l;if(e?(l=n,a=t):(a=n,l=t),a.startCell.indexOf(":")>-1||l.indexOf(":")>-1)return yr.v;if(e)return no(l+":"+a.startCell);var o=l,d="";if(l.indexOf("!")>-1){var s=l.split("!");d=s[0]+"!",o=s[1]}return no(d+a.startCell+":"+o)}(function(e){var n=function(){};n.precision=1e-6,n.create=function(t){return new n().setElements(t)},n.I=function(t){for(var a,l=[],o=t;o--;)for(a=t,l[o]=[];a--;)l[o][a]=o===a?1:0;return n.create(l)},n.prototype={e:function(t,a){return t<1||t>this.elements.length||a<1||a>this.elements[0].length?null:this.elements[t-1][a-1]},dimensions:function(){var t=this.elements.length===0?0:this.elements[0].length;return{rows:this.elements.length,cols:t}},rows:function(){return this.elements.length},cols:function(){return this.elements.length===0?0:this.elements[0].length},eql:function(t){var a=t.elements||t;if(a[0]&&a[0][0]!==void 0||(a=n.create(a).elements),this.elements.length===0||a.length===0)return this.elements.length===a.length;if(this.elements.length!==a.length||this.elements[0].length!==a[0].length)return!1;for(var l,o=this.elements.length,d=this.elements[0].length;o--;)for(l=d;l--;)if(Math.abs(this.elements[o][l]-a[o][l])>n.precision)return!1;return!0},dup:function(){return n.create(this.elements)},map:function(t,a){if(this.elements.length===0)return n.create([]);for(var l,o=[],d=this.elements.length,s=this.elements[0].length;d--;)for(l=s,o[d]=[];l--;)o[d][l]=t.call(a,this.elements[d][l],d+1,l+1);return n.create(o)},isSameSizeAs:function(t){var a=t.elements||t;return a[0][0]===void 0&&(a=n.create(a).elements),this.elements.length===0?a.length===0:this.elements.length===a.length&&this.elements[0].length===a[0].length},add:function(t){if(this.elements.length===0)return this.map(function(l){return l});var a=t.elements||t;return a[0][0]===void 0&&(a=n.create(a).elements),this.isSameSizeAs(a)?this.map(function(l,o,d){return l+a[o-1][d-1]}):null},subtract:function(t){if(this.elements.length===0)return this.map(function(l){return l});var a=t.elements||t;return a[0][0]===void 0&&(a=n.create(a).elements),this.isSameSizeAs(a)?this.map(function(l,o,d){return l-a[o-1][d-1]}):null},canMultiplyFromLeft:function(t){if(this.elements.length===0)return!1;var a=t.elements||t;return a[0][0]===void 0&&(a=n.create(a).elements),this.elements[0].length===a.length},multiply:function(t){if(this.elements.length===0)return null;if(!t.elements)return this.map(function(v){return v*t});var a=!!t.modulus;if((g=t.elements||t)[0][0]===void 0&&(g=n.create(g).elements),!this.canMultiplyFromLeft(g))return null;for(var l,o,d,s=this.elements.length,h=g[0].length,f=this.elements[0].length,p=[];s--;)for(l=h,p[s]=[];l--;){for(o=f,d=0;o--;)d+=this.elements[s][o]*g[o][l];p[s][l]=d}var g=n.create(p);return a?g.col(1):g},minor:function(t,a,l,o){if(this.elements.length===0)return null;for(var d,s,h,f=[],p=l,g=this.elements.length,v=this.elements[0].length;p--;)for(f[d=l-p-1]=[],s=o;s--;)h=o-s-1,f[d][h]=this.elements[(t+d-1)%g][(a+h-1)%v];return n.create(f)},transpose:function(){if(this.elements.length===0)return n.create([]);for(var t,a=this.elements.length,l=[],o=this.elements[0].length;o--;)for(t=a,l[o]=[];t--;)l[o][t]=this.elements[t][o];return n.create(l)},isSquare:function(){var t=this.elements.length===0?0:this.elements[0].length;return this.elements.length===t},max:function(){if(this.elements.length===0)return null;for(var t,a=0,l=this.elements.length,o=this.elements[0].length;l--;)for(t=o;t--;)Math.abs(this.elements[l][t])>Math.abs(a)&&(a=this.elements[l][t]);return a},indexOf:function(t){if(this.elements.length===0)return null;var a,l,o=this.elements.length,d=this.elements[0].length;for(a=0;a<o;a++)for(l=0;l<d;l++)if(this.elements[a][l]===t)return{i:a+1,j:l+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var t=[],a=this.elements.length,l=0;l<a;l++)t.push(this.elements[l][l]);return n.create(t)},toRightTriangular:function(){if(this.elements.length===0)return n.create([]);var t,a,l,o,d=this.dup(),s=this.elements.length,h=this.elements[0].length;for(a=0;a<s;a++){if(d.elements[a][a]===0){for(l=a+1;l<s;l++)if(d.elements[l][a]!==0){for(t=[],o=0;o<h;o++)t.push(d.elements[a][o]+d.elements[l][o]);d.elements[a]=t;break}}if(d.elements[a][a]!==0)for(l=a+1;l<s;l++){var f=d.elements[l][a]/d.elements[a][a];for(t=[],o=0;o<h;o++)t.push(o<=a?0:d.elements[l][o]-d.elements[a][o]*f);d.elements[l]=t}}return d},determinant:function(){if(this.elements.length===0)return 1;if(!this.isSquare())return null;for(var t=this.toRightTriangular(),a=t.elements[0][0],l=t.elements.length,o=1;o<l;o++)a*=t.elements[o][o];return a},isSingular:function(){return this.isSquare()&&this.determinant()===0},trace:function(){if(this.elements.length===0)return 0;if(!this.isSquare())return null;for(var t=this.elements[0][0],a=this.elements.length,l=1;l<a;l++)t+=this.elements[l][l];return t},rank:function(){if(this.elements.length===0)return 0;for(var t,a=this.toRightTriangular(),l=0,o=this.elements.length,d=this.elements[0].length;o--;)for(t=d;t--;)if(Math.abs(a.elements[o][t])>n.precision){l++;break}return l},augment:function(t){if(this.elements.length===0)return this.dup();var a=t.elements||t;a[0][0]===void 0&&(a=n.create(a).elements);var l,o=this.dup(),d=o.elements[0].length,s=o.elements.length,h=a[0].length;if(s!==a.length)return null;for(;s--;)for(l=h;l--;)o.elements[s][d+l]=a[s][l];return o},inverse:function(){if(this.elements.length===0||!this.isSquare()||this.isSingular())return null;for(var t,a,l,o,d,s=this.elements.length,h=s,f=this.augment(n.I(s)).toRightTriangular(),p=f.elements[0].length,g=[];h--;){for(l=[],g[h]=[],o=f.elements[h][h],a=0;a<p;a++)d=f.elements[h][a]/o,l.push(d),a>=s&&g[h].push(d);for(f.elements[h]=l,t=h;t--;){for(l=[],a=0;a<p;a++)l.push(f.elements[t][a]-f.elements[h][a]*f.elements[t][h]);f.elements[t]=l}}return n.create(g)},round:function(){return this.map(function(t){return Math.round(t)})},snapTo:function(t){return this.map(function(a){return Math.abs(a-t)<=n.precision?t:a})},setElements:function(t){var a,l,o=t.elements||t;if(o[0]&&o[0][0]!==void 0){for(a=o.length,this.elements=[];a--;)for(l=o[a].length,this.elements[a]=[];l--;)this.elements[a][l]=o[a][l];return this}var d=o.length;for(this.elements=[],a=0;a<d;a++)this.elements.push([o[a]]);return this}},e.sylvester_matrix=n})(hg);var bg=Wa,kg=ja,Lb=["https://cdn.jsdelivr.net/npm/vue@2.6.11","https://unpkg.com/vuex@3.4.0","https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/index.js","https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts.min.js","https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/expendPlugins/chart/chartmix.umd.min.js"],Pb=["https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/theme-chalk/index.css","https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/expendPlugins/chart/chartmix.css"];function Ob(e,n){if(e!=null)for(var t=function(l){var o=e[l];n&&u.chartparam.insertToStore({chart_id:o.chart_id,chartOptions:o.chartOptions});var d=o.chart_id,s=d+"_c",h=$(dg('<div id="${id}"class="luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}"tabindex="0"role="dialog"aria-labelledby=":41e"dir="ltr"><div class="luckysheet-modal-dialog-resize"><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt"data-type="lt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt"data-type="mt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm"data-type="lm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm"data-type="rm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt"data-type="rt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb"data-type="lb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb"data-type="mb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb"data-type="rb"></div></div><div class="luckysheet-modal-dialog-controll"><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-update"role="button"tabindex="0"aria-label=""title=""><i class="fa fa-pencil"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-max"role="butluckysheet_chartIns_indexton"tabindex="0"aria-label=""title=""><i class="fa fa-window-maximize"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del"role="button"tabindex="0"aria-label=""title=""><i class="fa fa-trash"aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-content">${content}</div></div>',{id:s,addclass:"luckysheet-data-visualization-chart",title:"",content:""})).appendTo($(".luckysheet-cell-main"));wg(h),$("#".concat(s)).children(".luckysheet-modal-dialog-content")[0].id=d;var f,p=document.getElementById(s);f=u.chartparam.getChartJson(o.chart_id),u.chartparam.renderChart({chart_id:o.chart_id,chartOptions:f}),u.currentChart=f,_u(d),$("#".concat(d,"_c .luckysheet-modal-controll-del")).click(function(k){_g(d)}),$("#".concat(d,"_c .luckysheet-modal-controll-update")).click(function(k){Sg()}),h.children(".luckysheet-modal-dialog-content").mousedown(function(k){u.chartparam.luckysheetCurrentChartMaxState||_u(d),k.stopPropagation()}),h.mousedown(function(k){if(!u.chartparam.luckysheetCurrentChartMaxState){_u(d),Rs(!0),$(k.target).is(".luckysheet-modal-dialog-controll")||$(k.target).is(".luckysheet-modal-controll-btn")||$(k.target).is("i")||(u.chartparam.luckysheetCurrentChartMoveTimeout=setTimeout(function(){u.chartparam.luckysheetCurrentChartMove=!0},100));var w=u.chartparam.luckysheetCurrentChartMoveObj.offset(),_=u.chartparam.luckysheetCurrentChartMoveObj.position();u.chartparam.luckysheetCurrentChartMoveXy=[k.pageX-w.left,k.pageY-w.top,_.left,_.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()],u.chartparam.luckysheetCurrentChartMoveWinH=$("#luckysheet-cell-main")[0].scrollHeight,u.chartparam.luckysheetCurrentChartMoveWinW=$("#luckysheet-cell-main")[0].scrollWidth,$(k.target).hasClass("luckysheet-mousedown-cancel")||$(k.target).filter("[class*='sp-palette']").length!=0||$(k.target).filter("[class*='sp-thumb']").length!=0||$(k.target).filter("[class*='sp-']").length!=0||($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide()),k.stopPropagation()}}).find(".luckysheet-modal-dialog-resize-item").mousedown(function(k){if(u.chartparam.luckysheetCurrentChartActive){u.chartparam.luckysheetCurrentChartResize=$(this).data("type");var w=pa(k.pageX,k.pageY),_=$("#luckysheet-scrollbar-x").scrollLeft(),C=$("#luckysheet-scrollbar-y").scrollTop(),A=w[0]+_,I=w[1]+C,S=u.chartparam.luckysheetCurrentChartResizeObj.position();u.chartparam.luckysheetCurrentChartResizeXy=[A,I,h.width(),h.height(),S.left+_,S.top+C,_,C],u.chartparam.luckysheetCurrentChartResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,u.chartparam.luckysheetCurrentChartResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,u.chartparam.luckysheetCurrentChart=d,k.stopPropagation()}});var g=o.width,v=o.height,y=o.left,b=o.top;p.style.width=g+"px",p.style.height=v+"px",p.style.position="absolute",p.style.background="#fff",p.style.left=y+"px",p.style.top=b+"px",p.style.zIndex=u.zIndex?u.zIndex:15,u.zIndex++},a=0;a<e.length;a++)t(a)}function zb(e,n,t,a,l){var o=u.currentChart;if(o&&o.rangeArray.length==1){var d=o.rangeArray[0].row,s=o.rangeArray[0].column;if(n>d[1]||t<d[0]||a>s[1]||l<s[0])return;var h=m.getcellrange(o.rangeTxt);h.sheetIndex==-1||h.sheetIndex;var f=(h.row,h.column,no(o.rangeTxt));if(ul(f)==="object"&&f.length!=0&&f.data.length!=null){var p=f.data;u.chartparam.changeChartCellData(o.chart_id,p)}}}function xg(e,n,t,a){var l=luckysheet.getluckysheet_select_save();l.length==1&&l[0].row[0]==l[0].row[1]&&l[0].column[0]==l[0].column[1]&&(ns("right","rangeOfSelect"),ns("down","rangeOfSelect"),l=luckysheet.getluckysheet_select_save());for(var o=-1,d=l[0].row[1]-l[0].row[0],s=l[0].row[0];s<=l[0].row[1];s++){for(var h=l[0].column[0];h<=l[0].column[1];h++)if((g=Hr(s,h,luckysheet.flowdata()))!=null&&g.toString().length>0){o=s;break}if(o!==-1)break}o==-1&&(o=0),l[0].row=[o,o],luckysheet.setluckysheet_select_save(l),u.luckysheet_shiftpositon=$.extend(!0,{},l[0]),cd("down","range",!1,d);var f=-1,p=(l=luckysheet.getluckysheet_select_save())[0].column[1]-l[0].column[0];for(h=l[0].column[0];h<=l[0].column[1];h++){for(s=l[0].row[0];s<=l[0].row[1];s++){var g;if((g=Hr(s,h,luckysheet.flowdata()))!=null&&g.toString().length>0){f=h;break}}if(f!==-1)break}f==-1&&(f=0),l[0].column=[f,f],luckysheet.setluckysheet_select_save(l),u.luckysheet_shiftpositon=$.extend(!0,{},l[0]),cd("right","range",!1,p),l=luckysheet.getluckysheet_select_save();var v=$.extend(!0,[],l),y=wn(u.currentSheetIndex,v[0],u.currentSheetIndex),b=nn();console.dir(b);var k=function(R){R==null&&(R="chart");for(var F=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),N="",z=0;z<12;z++)N+=F[Math.round(Math.random()*(F.length-1))];return R+"_"+N+"_"+new Date().getTime()}("chart"),w=k+"_c",_=$(dg('<div id="${id}"class="luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}"tabindex="0"role="dialog"aria-labelledby=":41e"dir="ltr"><div class="luckysheet-modal-dialog-resize"><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt"data-type="lt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt"data-type="mt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm"data-type="lm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm"data-type="rm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt"data-type="rt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb"data-type="lb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb"data-type="mb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb"data-type="rb"></div></div><div class="luckysheet-modal-dialog-controll"><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-update"role="button"tabindex="0"aria-label=""title=""><i class="fa fa-pencil"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-max"role="butluckysheet_chartIns_indexton"tabindex="0"aria-label=""title=""><i class="fa fa-window-maximize"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del"role="button"tabindex="0"aria-label=""title=""><i class="fa fa-trash"aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-content">${content}</div></div>',{id:w,addclass:"luckysheet-data-visualization-chart",title:"",content:""})).appendTo($(".luckysheet-cell-main")),C=document.getElementById(w),A=u.createChart($("#".concat(w)).children(".luckysheet-modal-dialog-content")[0],b,k,v,y),I=A.render,S=A.chart_json;console.dir(JSON.stringify(S)),e=e||400,n=n||250,t=t||0,a=a||0,C.style.width=e+"px",C.style.height=n+"px",C.style.position="absolute",C.style.background="#fff",C.style.left=t+"px",C.style.top=a+"px",I.style.width="100%",I.style.height="100%",C.style.zIndex=u.zIndex?u.zIndex:15,u.zIndex++;var E=u.luckysheetfile[je(u.currentSheetIndex)];E.chart||(E.chart=[]),E.chart.push({chart_id:k,width:e,height:n,left:t,top:a,sheetIndex:E.index}),_u(k),$("#".concat(k,"_c .luckysheet-modal-controll-del")).click(function(R){_g(k)}),wg(_),$("#".concat(k,"_c .luckysheet-modal-controll-update")).click(function(R){Sg()}),_.children(".luckysheet-modal-dialog-content").mousedown(function(R){u.chartparam.luckysheetCurrentChartMaxState||_u(k),R.stopPropagation()}),_.mousedown(function(R){if(!u.chartparam.luckysheetCurrentChartMaxState){_u(k),Rs(!0),$(R.target).is(".luckysheet-modal-dialog-controll")||$(R.target).is(".luckysheet-modal-controll-btn")||$(R.target).is("i")||(u.chartparam.luckysheetCurrentChartMoveTimeout=setTimeout(function(){u.chartparam.luckysheetCurrentChartMove=!0},100));var F=u.chartparam.luckysheetCurrentChartMoveObj.offset(),N=u.chartparam.luckysheetCurrentChartMoveObj.position();u.chartparam.luckysheetCurrentChartMoveXy=[R.pageX-F.left,R.pageY-F.top,N.left,N.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()],u.chartparam.luckysheetCurrentChartMoveWinH=$("#luckysheet-cell-main")[0].scrollHeight,u.chartparam.luckysheetCurrentChartMoveWinW=$("#luckysheet-cell-main")[0].scrollWidth,$(R.target).hasClass("luckysheet-mousedown-cancel")||$(R.target).filter("[class*='sp-palette']").length!=0||$(R.target).filter("[class*='sp-thumb']").length!=0||$(R.target).filter("[class*='sp-']").length!=0||($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide()),R.stopPropagation()}}).find(".luckysheet-modal-dialog-resize-item").mousedown(function(R){if(u.chartparam.luckysheetCurrentChartActive){u.chartparam.luckysheetCurrentChartResize=$(this).data("type");var F=pa(R.pageX,R.pageY),N=$("#luckysheet-scrollbar-x").scrollLeft(),z=$("#luckysheet-scrollbar-y").scrollTop(),P=F[0]+N,q=F[1]+z,V=u.chartparam.luckysheetCurrentChartResizeObj.position();u.chartparam.luckysheetCurrentChartResizeXy=[P,q,_.width(),_.height(),V.left+N,V.top+z,N,z],u.chartparam.luckysheetCurrentChartResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,u.chartparam.luckysheetCurrentChartResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,u.chartparam.luckysheetCurrentChart=k,R.stopPropagation()}})}function wg(e){e.find(".luckysheet-modal-dialog-content").hover(function(){e.removeClass("chart-moveable")},function(){e.addClass("chart-moveable")}),e.hover(function(){e.addClass("chart-moveable")},function(){e.removeClass("chart-moveable")})}function _g(e){$(".luckysheet-cell-main #".concat(e,"_c")).remove(),Cg();var n=u.luckysheetfile[je(u.currentSheetIndex)],t=n.chart.findIndex(function(a){return a.chart_id==e});n.chart.splice(t,1),u.deleteChart(e)}function _u(e){var n=u.luckysheetfile[je(u.currentSheetIndex)].chart;for(var t in n)n[t].needRangeShow=!1,n[t].chart_id==e&&(n[t].needRangeShow=!0,u.currentChart=u.getChartJson(e));Tg(e)}function Cg(){var e=u.luckysheetfile[je(u.currentSheetIndex)].chart;for(var n in e)e[n].needRangeShow=!1;Ag()}function Tg(e){var n=$("#"+e+"_c");u.chart_selection.create(),u.chartparam.luckysheetCurrentChartActive=!0,u.chartparam.luckysheetCurrentChartMoveObj=n,u.chartparam.luckysheetCurrentChartResizeObj=n,u.chartparam.luckysheetCurrentChart=e,$("#luckysheet-cell-main").find(".luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize").hide(),$("#luckysheet-cell-main").find(".luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),n.css("z-index",u.chartparam.luckysheetCurrentChartZIndexRank++),n.find(".luckysheet-modal-dialog-resize").show(),n.find(".luckysheet-modal-dialog-controll").show(),($(".chartSetting").is(":visible")||u.chartparam.luckysheet_chart_redo_click)&&e!=u.chartparam.luckysheetCurrentChart&&$("body .luckysheet-cols-menu").hide(),u.currentChart=u.highlightChart(e)}function Ag(e){$("#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").remove(),u.chartparam.luckysheetCurrentChartActive=!1,$("#luckysheet-chart-rangeShow").empty(),e||!$(".chartSetting").is(":visible")||Rt()||function(n){$(".chartSetting").is(":visible")&&($(".chartSetting").hide(),$("#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").remove(),u.chartparam.luckysheetCurrentChartActive=!1,Rt()||n||setTimeout(function(){Rn()},0))}()}function Sg(e,n){$(".chartSetting").is(":visible")||($(".chartSetting").show(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").show(),u.chartparam.luckysheetCurrentChartActive=!0,setTimeout(function(){Rn()},0))}function Ig(e){Ag("true"),u.luckysheetfile.forEach(function(n){n.index==e?(n.chart||[]).forEach(function(t){t.isShow=!0,$("#"+t.chart_id+"_c").show(),u.resizeChart(t.chart_id),t.needRangeShow==1&&(u.currentChart=u.getChartJson(t.chart_id),Tg(t.chart_id))}):(n.chart||[]).forEach(function(t){t.isShow=!1,$("#"+t.chart_id+"_c").hide()})})}var Rg=null;function Cu(e){u.flowdata!=null&&u.flowdata.length!=0&&(clearTimeout(Rg),Rg=setTimeout(function(){u.clearjfundo&&u.jfredo.push({type:"zoomChange",zoomRatio:u.zoomRatio,curZoomRatio:e,sheetIndex:u.currentSheetIndex}),u.zoomRatio=e;var n=ir.getSheetByIndex();Lr.buildAllPs(n.data),_r.images=n.images,_r.allImagesShow(),_r.init(),n.config==null&&(n.config={}),n.config.sheetViewZoom==null&&(n.config.sheetViewZoom={});var t=n.config.curentsheetView;t==null&&(t="viewNormal"),n.config.sheetViewZoom[t+"ZoomScale"]=e,nt.saveParam("all",u.currentSheetIndex,u.zoomRatio,{k:"zoomRatio"}),nt.saveParam("cg",u.currentSheetIndex,n.config.sheetViewZoom,{k:"sheetViewZoom"}),pd()},100))}function pd(){ln(u.flowdata.length,u.flowdata[0].length),qp()}function Eg(e){var n=1;return e<50?n=Math.round(100*(1.8*e/100+.1))/100:e>50&&(n=Math.round(100*(6*(e-50)/100+1))/100),n}function Co(e){var n=Math.round(100*e)+"%";$("#luckysheet-zoom-ratioText").html(n),function(t){var a=50;t<1?a=Math.round(100*(t-.1)/.18)/10:t>1&&(a=Math.round(100*(t-1)/.6)/10+50),$("#luckysheet-zoom-cursor").css("left",a-4)}(e)}var ir={generateRandomSheetIndex:function(e){e==null&&(e="Sheet");for(var n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",a=0;a<12;a++)t+=n[Math.round(Math.random()*(n.length-1))];return e+"_"+t+"_"+new Date().getTime()},generateRandomSheetName:function(e,n){for(var t=e.length,a=st().pivotTable.title,l=0;l<e.length;l++)if(e[l].name.indexOf("Sheet")>-1||e[l].name.indexOf(a)>-1){var o=parseFloat(e[l].name.replace("Sheet","").replace(a,""));o!="NaN"&&Math.ceil(o)>t&&(t=Math.ceil(o))}return n?a+(t+1):"Sheet"+(t+1)},generateCopySheetName:function(e,n){var t="",a=st().info;if(n.toString().indexOf("("+a.copy)>-1){for(var l=n.toString().indexOf("("+a.copy),o=n.toString().substring(0,l)+"("+a.copy,d=null,s=0;s<e.length;s++){var h=e[s].name.toString(),f=h.indexOf(o);if(f>-1){var p=h.indexOf(")",f+o.length),g=h.substring(f+o.length,p);M(g)&&(d==null||parseInt(g)>d)&&(d=parseInt(g))}}t=d==null?o+"2)":o+ ++d+")"}else{for(var v=null,y=!1,b=n+"("+a.copy,k=0;k<e.length;k++){var w=e[k].name.toString(),_=w.indexOf(b);if(_>-1){y=!0;var C=w.indexOf(")",_+b.length),A=w.substring(_+b.length,C);M(A)&&(v==null||parseInt(A)>v)&&(v=parseInt(A))}}y?v==null?t=n+"("+a.copy+"2)":(v++,t=n+"("+a.copy+v+")"):t=n+"("+a.copy+")"}return t},getSheetByIndex:function(e){e==null&&(e=u.currentSheetIndex);var n=this.getSheetIndex(e);return u.luckysheetfile[n]},getSheetByName:function(e){if(e==null)return null;for(var n=0;n<u.luckysheetfile.length;n++){var t=u.luckysheetfile[n];if(t.name==e)return t}return null},getCurSheetnoset:function(){for(var e=0,n=0;n<u.luckysheetfile.length;n++)if(u.luckysheetfile[n].status==1){e=u.luckysheetfile[n].index;break}return e},getCurSheet:function(){var e=this;if(u.luckysheetfile.length){var n=!1,t=[];u.luckysheetfile.forEach(function(l){l.index===void 0&&(l.index=e.generateRandomSheetIndex()),t.includes(l.index)?l.index=e.generateRandomSheetIndex():t.push(l.index),l.status===void 0&&(l.status=0),l.status==1&&(n?l.status=0:n=!0)}),n||(u.luckysheetfile[0].status=1)}u.currentSheetIndex=u.luckysheetfile[0].index;for(var a=0;a<u.luckysheetfile.length;a++)if(u.luckysheetfile[a].status==1){u.currentSheetIndex=u.luckysheetfile[a].index;break}return u.currentSheetIndex},addNewSheet:function(e,n){if(!Rt()&&u.allowEdit!==!1){var t=u.luckysheetfile.length,a=this.generateRandomSheetIndex(),l=this.generateRandomSheetName(u.luckysheetfile,n);$("#luckysheet-sheet-container-c").append(br($i,{index:a,active:"",name:l,style:"",colorset:""}));var o={name:l,color:"",status:"0",order:t,index:a,celldata:[],row:u.defaultrowNum,column:u.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!n};if(u.luckysheetfile.push(o),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a+'" class="luckysheet-datavisual-selection-set"></div>'),bl(e),nt.saveParam("sha",null,$.extend(!0,{},o)),u.clearjfundo){u.jfundo.length=0;var d={type:"addSheet"};d.sheetconfig=$.extend(!0,{},o),d.index=a,d.currentSheetIndex=u.currentSheetIndex,u.jfredo.push(d)}this.changeSheetExec(a,n,!0)}},setSheetHide:function(e){var n=this.getSheetIndex(e);u.luckysheetfile[n].hide=1;var t,a=$("#luckysheet-sheets-item"+e);if(a.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),Nt.showsheetbarConfig.sheet)t=a.nextAll(":visible"),t=a.nextAll(":visible").length>0?t.eq(0).data("index"):a.prevAll(":visible").eq(0).data("index");else{var l,o=[];u.luckysheetfile.forEach(function(s,h){s.hide!==1&&o.push(h)});var d=o.length;l=d===1?o[0]:o[d-1]>n?o.find(function(s){return s>n}):o[d-1],t=u.luckysheetfile[l].index}$("#luckysheet-sheets-item"+t).addClass("luckysheet-sheets-item-active"),this.changeSheetExec(t),nt.saveParam("sh",a.data("index"),1,{op:"hide",cur:t})},setSheetShow:function(e){u.luckysheetfile[this.getSheetIndex(e)].hide=0,this.changeSheetExec(e),nt.saveParam("sh",e,0,{op:"show",cur:null})},sheetMaxIndex:0,ordersheet:function(e){return function(n,t){return n[e]-t[e]}},getCurrentOrder:function(){var e={};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){for(var t=$(this).data("index"),a=0;a<u.luckysheetfile.length;a++)if(u.luckysheetfile[a].index==t){e[t.toString()]=n;break}}),e},reOrderAllSheet:function(){var e={};$("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){for(var t=$(this).data("index"),a=0;a<u.luckysheetfile.length;a++)if(u.luckysheetfile[a].index==t){u.luckysheetfile[a].order=n,e[t.toString()]=n;break}}),nt.saveParam("shr",null,e),u.luckysheetfile.sort(function(n,t){var a=n.order,l=t.order;return a!=null&&l!=null?a-l:a!=null?-1:1})},createSheet:function(){var e=[];u.luckysheetfile.sort(this.ordersheet("order"));for(var n=0;n<u.luckysheetfile.length;n++){var t="",a=u.luckysheetfile[n].index,l="";u.luckysheetfile[n].color!=null&&(l='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+u.luckysheetfile[n].color+';"></div>'),u.currentSheetIndex==a?e.push(br($i,{index:a,active:"luckysheet-sheets-item-active",name:u.luckysheetfile[n].name,style:"",colorset:l})):(u.luckysheetfile[n].hide==1?e.push(br($i,{index:a,active:"",name:u.luckysheetfile[n].name,style:"display:none;",colorset:l})):e.push(br($i,{index:a,active:"",name:u.luckysheetfile[n].name,style:"",colorset:l})),t="style='display:none;'"),$("#luckysheet-cell-main").append("<div "+t+' id="luckysheet-datavisual-selection-set-'+a+'" class="luckysheet-datavisual-selection-set"></div>')}$("#luckysheet-sheet-container-c").append(e.join("")),this.locationSheet()},locationSheet:function(){var e=$("#luckysheet-sheet-container-c"),n=$("#"+u.container).width(),t=($("#luckysheet-sheet-container-c > div.luckysheet-sheets-item-active").eq(0),0),a=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){$(this).hasClass("luckysheet-sheets-item-active")&&(t=a),a+=$(this).outerWidth()}),setTimeout(function(){e.scrollLeft(t-10),a>=.7*n&&Nt.showsheetbarConfig.sheet&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show())},1)},copySheet:function(e,n){if(!Rt()&&u.allowEdit!==!1){var t=u.luckysheetfile.length,a=this.generateRandomSheetIndex(),l=this.getSheetIndex(e),o=$.extend(!0,{},u.luckysheetfile[l]);o.order=t,o.index=a,o.name=this.generateCopySheetName(u.luckysheetfile,o.name);var d="";o.color!=null&&(d='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+o.color+';"></div>');var s=$("#luckysheet-sheets-item"+e);if($("#luckysheet-sheet-container-c").append(br($i,{index:o.index,active:"",name:o.name,order:o.order,style:"",colorset:d})),$("#luckysheet-sheets-item"+o.index).insertAfter(s),u.luckysheetfile.splice(l+1,0,o),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a+'" class="luckysheet-datavisual-selection-set"></div>'),bl(n),nt.saveParam("shc",a,{copyindex:e,name:o.name}),this.changeSheetExec(a),this.reOrderAllSheet(),u.clearjfundo)u.jfredo.push({type:"copySheet",copyindex:e,index:o.index,sheetIndex:o.index});else if(u.jfredo.length>0){var h=u.jfredo[u.jfredo.length-1];h.type=="copySheet"&&(h.index=o.index,h.sheetIndex=o.index)}}},hasSheet:function(e){return e!=null&&(e=this.getSheetIndex(e))!=null},createSheetbydata:function(e,n){var t=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],a=this,l="";if(e.color!=null&&(l='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),$("#luckysheet-sheet-container-c").append(br($i,{index:e.index,active:"",name:e.name,order:e.order,style:"",colorset:l})),t){var o=e.order;o>=u.luckysheetfile.length?(o=u.luckysheetfile.length-1,$("#luckysheet-sheets-item"+e.index).insertAfter($("#luckysheet-sheets-item"+u.luckysheetfile[o].index))):$("#luckysheet-sheets-item"+e.index).insertBefore($("#luckysheet-sheets-item"+u.luckysheetfile[o].index))}u.luckysheetfile.push(e),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+e.index).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+e.index+'" class="luckysheet-datavisual-selection-set"></div>'),bl(),n!=null?(nt.saveParam("shre",null,{reIndex:e.index}),e.hide=0,nt.saveParam("sh",e.index,0,{op:"show",cur:null})):nt.saveParam("sha",null,e),a.changeSheetExec(e.index,e.isPivotTable,!0),a.reOrderAllSheet()},deleteSheet:function(e){if(u.allowEdit!==!1){var n=this.getSheetIndex(e);this.setSheetHide(e),$("#luckysheet-sheets-item"+e).remove(),$("#luckysheet-datavisual-selection-set-"+e).remove();var t=u.luckysheetfile.splice(n,1);this.reOrderAllSheet(),nt.saveParam("shd",null,{deleIndex:e}),u.clearjfundo&&(t[0].type="deleteSheet",u.jfredo.push(t[0]))}},nulldata:null,getGridData:function(e){for(var n=[],t=0;t<e.length;t++)for(var a=0;a<e[0].length;a++)e[t][a]!=null&&n.push({r:t,c:a,v:e[t][a]});return n},buildGridData:function(e){var n=e.row==null?u.defaultrowNum:e.row,t=e.column==null?u.defaultcolumnNum:e.column,a=e.data&&e.data.length>0?e.data:cl([],n,t),l=e.celldata;if(e.data&&e.data.length>0)for(var o=0;o<a.length;o++)for(var d=0;d<a[0].length;d++)Ln(o,d,a,a[o][d]);else if(l&&l.length>0)for(var s=0;s<l.length;s++){var h=l[s],f=h.r,p=h.c,g=h.v;f>=a.length&&(a=cl(a,f-a.length+1,0)),p>=a[0].length&&(a=cl(a,0,p-a[0].length+1)),Ln(f,p,a,g)}return Nt.autoFormatw=!1,Nt.accuracy=void 0,a},cutGridData:function(e){for(var n=0,t=e.length-1;t>=0;t--){for(var a=!0,l=0;l<e[0].length;l++){var o=Hr(t,l);if(o!=null&&$.trim(o).length>0){a=!1;break}}if(!a)break;n=t}return e.slice(0,n)},addGridData:function(e,n,t){var a=cl([],n,t);if(e!=null)for(var l=0;l<e.length;l++){var o=e[l],d=o.r,s=o.c,h=o.v;d>=a.length&&(a=cl(a,d-a.length+1,0)),s>=a[0].length&&(a=cl(a,0,s-a[0].length+1)),Ln(d,s,a,h)}return a},sheetParamRestore:function(e,n){if(u.luckysheet_select_save=e.luckysheet_select_save,u.luckysheet_select_save!=null&&u.luckysheet_select_save.length!=0||(n[0]!=null&&n[0][0]!=null&&n[0][0].mc!=null?u.luckysheet_select_save=[{row:[0,n[0][0].mc.rs-1],column:[0,n[0][0].mc.cs-1]}]:u.luckysheet_select_save=[{row:[0,0],column:[0,0]}]),u.luckysheet_selection_range=e.luckysheet_selection_range==null?[]:e.luckysheet_selection_range,u.config=e.config==null?{}:e.config,u.zoomRatio=e.zoomRatio==null?1:e.zoomRatio,e.defaultRowHeight!=null?u.defaultrowlen=parseFloat(e.defaultRowHeight):u.defaultrowlen=Nt.defaultRowHeight,e.defaultColWidth!=null?u.defaultcollen=parseFloat(e.defaultColWidth):u.defaultcollen=Nt.defaultColWidth,e.showGridLines!=null){var t=e.showGridLines;u.showGridLines=t!=0&&t!=0}else u.showGridLines=!0},initialjfFile:function(e,n){var t=this;t.getCurSheet();var a=u.luckysheetfile[t.getSheetIndex(u.currentSheetIndex)];t.nulldata=cl([],u.defaultrowNum,u.defaultcolumnNum);var l=t.buildGridData(a),o=[];a.jfgird_select_save=a.jfgird_select_save||[],a.jfgird_select_save.forEach(function(g){return o.push({row:g.row,column:g.column})}),a.luckysheet_select_save=o,this.sheetParamRestore(a,l);var d=u.luckysheet_select_save[0].row[1],s=u.luckysheet_select_save[0].column[1];if(u.luckysheet_select_save.length>1)for(var h=0;h<u.luckysheet_select_save.length;h++)u.luckysheet_select_save[h].row[1]>d&&(d=u.luckysheet_select_save[h].row[1]),u.luckysheet_select_save[h].column[1]>s&&(s=u.luckysheet_select_save[h].column[1]);dr.fontInitial(u.fontList),a.data=l;var f=l.length;d>f-1&&(f=d+1);var p=l[0].length;s>p-1&&(p=s+1),typeof Nt.beforeCreateDom=="function"&&Nt.beforeCreateDom(luckysheet),typeof Nt.workbookCreateBefore=="function"&&Nt.workbookCreateBefore(luckysheet),Tb(p,f,0,0,n),setTimeout(function(){Ee.createHoverTip("#luckysheet_info_detail",".luckysheet_info_detail_back, .luckysheet_info_detail_input, .luckysheet_info_detail_update"),Ee.createHoverTip("#luckysheet-wa-editor",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button"),u.luckysheetTableContentHW=[$("#luckysheet-cell-main").width()+u.rowHeaderWidth-u.cellMainSrollBarSize,$("#luckysheet-cell-main").height()+u.columnHeaderHeight-u.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(u.luckysheetTableContentHW[0]*u.devicePixelRatio),height:Math.ceil(u.luckysheetTableContentHW[1]*u.devicePixelRatio)}).css({width:u.luckysheetTableContentHW[0],height:u.luckysheetTableContentHW[1]}).get(0).getContext("2d");var g=st().info,v=nt.gridKey+"__qkcache",y=function(){a.load="1",t.createSheet();var b=function(){t.mergeCalculation(a.index),t.setSheetParam(!1),t.storeSheetParam(),t.restoreselect(),t.CacheNotLoadControll=[],t.restoreCache(),m.execFunctionGroupForce(Nt.forceCalculation),t.restoreSheetAll(u.currentSheetIndex),$("#luckysheet_info_detail_save").html(g.detailSave),a.isPivotTable?u.luckysheetcurrentisPivotTable=!0:(u.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide()),function(){var I=Nt.showtoolbar,S=Nt.showtoolbarConfig,E=u.toobarObject.toobarWidths=[],R=u.toobarObject.toobarElements=[],F=u.toobarObject.toobarConfig={undo:{ele:"#luckysheet-icon-undo",index:0},redo:{ele:"#luckysheet-icon-redo",index:1},paintFormat:{ele:["#luckysheet-icon-paintformat","#toolbar-separator-paint-format"],index:2},currencyFormat:{ele:"#luckysheet-icon-currency",index:3},percentageFormat:{ele:"#luckysheet-icon-percent",index:4},numberDecrease:{ele:"#luckysheet-icon-fmt-decimal-decrease",index:5},numberIncrease:{ele:"#luckysheet-icon-fmt-decimal-increase",index:6},moreFormats:{ele:["#luckysheet-icon-fmt-other","#toolbar-separator-more-format"],index:7},font:{ele:["#luckysheet-icon-font-family","#toolbar-separator-font-family"],index:8},fontSize:{ele:["#luckysheet-icon-font-size","#toolbar-separator-font-size"],index:9},bold:{ele:"#luckysheet-icon-bold",index:10},italic:{ele:"#luckysheet-icon-italic",index:11},strikethrough:{ele:"#luckysheet-icon-strikethrough",index:12},underline:{ele:"#luckysheet-icon-underline",index:13},textColor:{ele:["#luckysheet-icon-text-color","#luckysheet-icon-text-color-menu","#toolbar-separator-text-color"],index:14},fillColor:{ele:["#luckysheet-icon-cell-color","#luckysheet-icon-cell-color-menu"],index:15},border:{ele:["#luckysheet-icon-border-all","#luckysheet-icon-border-menu"],index:16},mergeCell:{ele:["#luckysheet-icon-merge-button","#luckysheet-icon-merge-menu","#toolbar-separator-merge-cell"],index:17},horizontalAlignMode:{ele:["#luckysheet-icon-align","#luckysheet-icon-align-menu"],index:18},verticalAlignMode:{ele:["#luckysheet-icon-valign","#luckysheet-icon-valign-menu"],index:19},textWrapMode:{ele:["#luckysheet-icon-textwrap","#luckysheet-icon-textwrap-menu"],index:20},textRotateMode:{ele:["#luckysheet-icon-rotation","#luckysheet-icon-rotation-menu","#toolbar-separator-text-rotate"],index:21},image:{ele:"#luckysheet-insertImg-btn-title",index:22},link:{ele:"#luckysheet-insertLink-btn-title",index:23},chart:{ele:"#luckysheet-chart-btn-title",index:24},postil:{ele:"#luckysheet-icon-postil",index:25},pivotTable:{ele:["#luckysheet-pivot-btn-title","#toolbar-separator-pivot-table"],index:26},function:{ele:["#luckysheet-icon-function","#luckysheet-icon-function-menu"],index:27},frozenMode:{ele:["#luckysheet-freezen-btn-horizontal","#luckysheet-icon-freezen-menu"],index:28},sortAndFilter:{ele:"#luckysheet-icon-autofilter",index:29},conditionalFormat:{ele:"#luckysheet-icon-conditionformat",index:30},dataVerification:{ele:"#luckysheet-dataVerification-btn-title",index:31},splitColumn:{ele:"#luckysheet-splitColumn-btn-title",index:32},screenshot:{ele:"#luckysheet-chart-btn-screenshot",index:33},findAndReplace:{ele:"#luckysheet-icon-seachmore",index:34},protection:{ele:"#luckysheet-icon-protection",index:35},print:{ele:"#luckysheet-icon-print",index:36}},N={undo:!0,redo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,postil:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataVerification:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0};if(!I)for(var z in N)N[z]=!1;for(var P in JSON.stringify(S)!=="{}"&&(S.hasOwnProperty("undoRedo")&&(N.undo=N.redo=S.undoRedo,delete S.undoRedo),Object.assign(N,S)),N)if(N[P])R.push($.extend(!0,{},F[P]));else if(F[P].ele instanceof Array){var q,V=sf(F[P].ele);try{for(V.s();!(q=V.n()).done;){var x=q.value;$(x).remove()}}catch(ee){V.e(ee)}finally{V.f()}}else $(F[P].ele).remove();R.sort(function(ee,ne){return ee.index>ne.index?1:-1}),R.forEach(function(ee,ne,ae){ae[ne]=ee.ele,ne!==R.length-1?ee.ele instanceof Array?E.push($(ee.ele[0]).offset().left):E.push($(ee.ele).offset().left):ee.ele instanceof Array?(E.push($(ee.ele[0]).offset().left),E.push($(ee.ele[0]).offset().left+$(ee.ele[0]).outerWidth()+5)):(E.push($(ee.ele).offset().left),E.push($(ee.ele).offset().left+$(ee.ele).outerWidth()+5))})}(),Rn(),a.scrollLeft!=null&&a.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(a.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),a.scrollTop!=null&&a.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(a.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0),ev(u.asyncLoad,"core"),Nt.pointEdit?setTimeout(function(){$("#luckysheetloadingdata").remove()},0):setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500)},k=nt.loadSheetUrl;if(k=="")t.loadOtherFile(a),b();else{for(var w=t.checkLoadSheetIndex(a),_=[],C=0;C<w.length;C++){var A=w[C];A!=a.index&&_.push(A)}if(_.length===0)return void b();$.post(k,{gridKey:nt.gridKey,index:_.join(",")},function(I){var S=new Function("return "+I)();for(var E in S)if(E!=a.index){var R=u.luckysheetfile[t.getSheetIndex(E)];R.load!=null&&R.load!="0"||(R.celldata=S[E.toString()],R.data=t.buildGridData(R),R.load="1")}b()})}};try{localforage.getItem(v).then(function(b){b!=null&&(t.CacheNotLoadControll=b),nt.clearcachelocaldata(function(){y()})})}catch{y(),console.log("")}},1)},storeSheetParam:function(){var e=this.getSheetIndex(u.currentSheetIndex),n=u.luckysheetfile[e];n.config=u.config,n.visibledatarow=u.visibledatarow,n.visibledatacolumn=u.visibledatacolumn,n.ch_width=u.ch_width,n.rh_height=u.rh_height,n.luckysheet_select_save=$.extend(!0,[],u.luckysheet_select_save),n.luckysheet_selection_range=$.extend(!0,[],u.luckysheet_selection_range),$("#luckysheet-scrollbar-x")[0].scrollWidth>$("#luckysheet-scrollbar-x")[0].offsetWidth&&(n.scrollLeft=$("#luckysheet-scrollbar-x").scrollLeft()),$("#luckysheet-scrollbar-y")[0].scrollHeight>$("#luckysheet-scrollbar-y")[0].offsetHeight&&(n.scrollTop=$("#luckysheet-scrollbar-y").scrollTop()),n.zoomRatio=u.zoomRatio},setSheetParam:function(){var e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],n=this.getSheetIndex(u.currentSheetIndex),t=u.luckysheetfile[n];u.flowdata=t.data,vr.webWorkerFlowDataCache(u.flowdata),m.execFunctionGlobalData=null,window.luckysheet_getcelldata_cache=null,this.sheetParamRestore(t,u.flowdata),t.freezen==null?(Ne.freezenhorizontaldata=null,Ne.freezenverticaldata=null):(Ne.freezenhorizontaldata=t.freezen.horizontal==null?null:t.freezen.horizontal.freezenhorizontaldata,Ne.freezenverticaldata=t.freezen.vertical==null?null:t.freezen.vertical.freezenverticaldata),e&&ld(u.flowdata.length,u.flowdata[0].length),Lr.buildAllPs(u.flowdata),_r.currentImgId=null,_r.images=t.images,_r.allImagesShow(),_r.init(),aa.dataVerification=t.dataVerification,aa.init(),Jl.hyperlink=t.hyperlink,Jl.init(),gi(t.filter_select,t.filter)},restoreselect:function(){var e=this.getSheetIndex(u.currentSheetIndex),n=u.luckysheetfile[e];Ra(),pn(),n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0)},storeSheetParamALL:function(){this.storeSheetParam();var e=this.getSheetIndex(u.currentSheetIndex);u.luckysheetfile[e].data=u.flowdata,u.luckysheetfile[e].config=$.extend(!0,{},u.config)},mergeCalculationSheet:{},mergeCalculation:function(e){var n=u.luckysheetfile[this.getSheetIndex(e)],t=n.config,a=n.data;if(t!=null){var l=t.merge;if(l!=null&&!(e in this.mergeCalculationSheet)&&n.autoCalculationMerge!==!1)for(var o in this.mergeCalculationSheet[e]=1,l){var d=parseInt(o.substr(0,o.indexOf("_"))),s=parseInt(o.substr(o.indexOf("_")+1)),h=l[o];a[d][s]==null&&(a[d][s]={}),a[d][s].mc={r:d,c:s,rs:h.rs,cs:h.cs};for(var f=d;f<d+h.rs;f++)for(var p=s;p<s+h.cs;p++)f==d&&p==s||(a[f][p]==null&&(a[f][p]={}),a[f][p].mc={r:d,c:s})}}},loadOtherFile:function(e){for(var n=0;n<u.luckysheetfile.length;n++){var t=u.luckysheetfile[n];t.index!=e.index&&(t.load!=null&&t.load!="0"||(t.data=this.buildGridData(t),t.load="1"))}},changeSheet:function(e,n,t){if(!Rt()){var a=this;if(e!=u.currentSheetIndex){nt.allowUpdate&&($("#luckysheet-cell-main #luckysheet-multipleRange-show").empty(),nt.multipleIndex=0),Ya.createHookFunction("sheetActivate",e,n,t),$("#luckysheet-filter-selected-sheet"+u.currentSheetIndex+", #luckysheet-filter-options-sheet"+u.currentSheetIndex).hide(),$("#luckysheet-filter-selected-sheet"+e+", #luckysheet-filter-options-sheet"+e).show(),a.storeSheetParamALL(),a.setCurSheet(e);var l=u.luckysheetfile[a.getSheetIndex(e)];if(l.isPivotTable?(u.luckysheetcurrentisPivotTable=!0,n||Pr.changePivotTable(e)):(u.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),Rn(!1)),l.load!=null){var o=a.buildGridData(l);l.data=o,a.mergeCalculation(e),a.setSheetParam(!0),a.showSheet(),setTimeout(function(){m.execFunctionGroup(),Kr(),nt.saveParam("shs",null,u.currentSheetIndex)},1)}else{var d=nt.loadSheetUrl;if(d==""||u.luckysheetcurrentisPivotTable||t){var s=a.buildGridData(l);l.data=s,l.load="1",a.loadOtherFile(l),a.mergeCalculation(e),a.setSheetParam(),a.showSheet(),setTimeout(function(){a.restoreCache(),m.execFunctionGroupForce(Nt.forceCalculation),a.restoreSheetAll(u.currentSheetIndex),Kr()},1),nt.saveParam("shs",null,u.currentSheetIndex)}else{$("#luckysheet-grid-window-1").append(Qc());var h=a.checkLoadSheetIndex(l);$.post(d,{gridKey:nt.gridKey,index:h.join(",")},function(f){var p=new Function("return "+f)();l.celldata=p[e.toString()];var g=a.buildGridData(l);for(var v in setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),p)if(v!=e){var y=u.luckysheetfile[a.getSheetIndex(v)];y.load!=null&&y.load!="0"||(y.celldata=p[v.toString()],y.data=a.buildGridData(y),y.load="1")}l.data=g,l.load="1",a.mergeCalculation(e),a.setSheetParam(),a.showSheet(),setTimeout(function(){a.restoreCache(),m.execFunctionGroupForce(Nt.forceCalculation),a.restoreSheetAll(u.currentSheetIndex),Kr()},1),nt.saveParam("shs",null,u.currentSheetIndex)})}}$("#luckysheet-cell-main .luckysheet-datavisual-selection-set").hide(),$("#luckysheet-datavisual-selection-set-"+e).show(),Ig(e),Ne.initialFreezen(e),a.restoreselect()}}},checkLoadSheetIndexToDataIndex:{},checkLoadSheetIndex:function(e){var n=this,t=m.getAllFunctionGroup(),a=e.chart,l=e.pivotTable,o=[],d={};if(e.index in this.checkLoadSheetIndexToDataIndex)return[];if(o.push(e.index),d[e.index.toString()]=1,this.checkLoadSheetIndexToDataIndex[e.index]=1,t!=null&&function(){for(var p={},g=function(k){var w=t[k],_=w.index,C=pi(w.r,w.c,_);if(C==null){var A=u.luckysheetfile[n.getSheetIndex(_)];if(A.data=n.buildGridData(A),(C=pi(w.r,w.c,_))==null)return"continue"}if(C.indexOf("!")==-1)m.addToSheetIndexList(C,_);else if(m.formulaContainSheetList!=null&&m.formulaContainSheetList[C]!=null)for(var I in m.formulaContainSheetList[C])p[I]=1;else m.functionParser(C,function(S){if(m.addToCellList(C,S),S.indexOf("!")>-1){var E=S.substr(0,S.indexOf("!")),R=n.getSheetByName(E);if(R!=null){var F=R.index;p[F]=1,m.addToSheetIndexList(C,F)}}}),m.formulaContainSheetList[C]==null&&m.addToSheetIndexList(C,_);if(_==null)return"continue"},v=0;v<t.length;v++)g(v);for(var y in p){var b=y;d[b.toString()]==null&&(o.push(b),d[b.toString()]=1,n.checkLoadSheetIndexToDataIndex[b]=1)}}(),a!=null)for(var s=0;s<a.length;s++){var h=a[s].dataSheetIndex;h!=null&&d[h.toString()]==null&&(o.push(h),d[h.toString()]=1)}if(l!=null){var f=l.pivotDataSheetIndex;f!=null&&d[f.toString()]==null&&(o.push(f),d[f.toString()]=1)}return o},showSheet:function(){$("#luckysheet-cell-flow_0").css({width:u.ch_width,top:"-1px"}),$("#luckysheet-sheettable_0").css({width:u.ch_width-1,height:u.rh_height}),$("#luckysheetrowHeader_0").css("height",u.rh_height),$("#luckysheet-cols-h-cells_0").css("width",u.ch_width),$("#luckysheet-scrollbar-x div").width(u.ch_width),$("#luckysheet-scrollbar-y div").height(u.rh_height+u.columnHeaderHeight-u.cellMainSrollBarSize-3);var e=this.getSheetIndex(u.currentSheetIndex),n=u.luckysheetfile[e];u.scrollRefreshSwitch=!1,n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft*u.zoomRatio):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop*u.zoomRatio):$("#luckysheet-scrollbar-y").scrollTop(0),setTimeout(function(){u.scrollRefreshSwitch=!0},0),Co(u.zoomRatio)},setCurSheet:function(e){for(var n=0;n<u.luckysheetfile.length;n++)u.luckysheetfile[n].index==e?u.luckysheetfile[n].status=1:u.luckysheetfile[n].status=0;u.currentSheetIndex=e},getSheetIndex:function(e){for(var n=0;n<u.luckysheetfile.length;n++)if(u.luckysheetfile[n].index==e)return n;return null},changeSheetExec:function(e,n,t){var a=$("#luckysheet-sheets-item"+e);window.luckysheet_getcelldata_cache=null,$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),a.addClass("luckysheet-sheets-item-active").show(),bl(),this.changeSheet(e,n,t),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),m.rangestart&&m.createRangeHightlight(),this.sheetBarShowAndHide(e)},sheetArrowShowAndHide:function(){var e=$("#luckysheet-sheet-container").width(),n=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){n+=$(this).outerWidth()}),n>=e?Nt.showsheetbarConfig.sheet&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide())},sheetBarShowAndHide:function(e){var n=$("#luckysheet-sheet-container-c");if(e!=null){var t=$("#luckysheet-sheets-item"+e);n.scrollLeft(t.offset().left)}var a=n.width(),l=n[0].scrollWidth,o=n.scrollLeft();o<=0?$("#luckysheet-sheet-container .docs-sheet-fade-left").hide():$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),a+o>=l?$("#luckysheet-sheet-container .docs-sheet-fade-right").hide():$("#luckysheet-sheet-container .docs-sheet-fade-right").show()},delChart:function(e,n){var t=this.getSheetIndex(n),a=u.luckysheetfile[t];if(a.chart==null)a.chart=[];else for(var l=0;l<a.chart.length;l++)if(a.chart[l].chart_id==e){u.luckysheetfile[t].chart.splice(l,1);break}},saveChart:function(e){var n=this.getSheetIndex(e.sheetIndex),t=u.luckysheetfile[n];if(t.chart==null)t.chart=[],t.chart.push(e);else{for(var a=0;a<t.chart.length;a++)if(t.chart[a].chart_id==e.chart_id){var l=$.extend(!0,{},t.chart[a]);return void(t.chart[a]=$.extend(!0,{},l,e))}t.chart.push(e)}},getChart:function(e,n){var t=this.getSheetIndex(e),a=u.luckysheetfile[t];if(a.chart==null)return null;for(var l=0;l<a.chart.length;l++)if(a.chart[l].chart_id==n)return a.chart[l];return null},getRangetxt:function(e,n,t){var a="";t==null&&(t=u.currentSheetIndex),e!=t&&(a=u.luckysheetfile[this.getSheetIndex(e)].name+"!");var l=n.row[0],o=n.row[1],d=n.column[0],s=n.column[1];return l==null&&o==null?a+ya(d)+":"+ya(s):d==null&&s==null?a+(l+1)+":"+(o+1):d==s&&l==o?a+ya(d)+(l+1):a+ya(d)+(l+1)+":"+ya(s)+(o+1)},getSheetName:function(e){return e==null&&(e=u.currentSheetIndex),u.luckysheetfile[this.getSheetIndex(e)].name},getSheetMerge:function(){return u.config.merge==null?null:u.config.merge},getSheetData:function(e){return e==null&&(e=u.currentSheetIndex),u.luckysheetfile[this.getSheetIndex(e)].data},getSheetConfig:function(e){return e==null&&(e=u.currentSheetIndex),u.luckysheetfile[this.getSheetIndex(e)].config==null&&(u.luckysheetfile[this.getSheetIndex(e)].config={}),u.luckysheetfile[this.getSheetIndex(e)].config},restoreFilter:function(e){var n=this.getSheetIndex(e),t=u.luckysheetfile[n];if(D(t.filter_select)=="string"&&(t.filter_select=JSON.parse(t.filter_select)),t.filter_select!=null&&t.filter_select.row!=null&&t.filter_select.column!=null){gi(t.filter_select),D(t.filter)!="object"&&t.filter!=null&&D(t.filter)=="string"&&(t.filter=JSON.parse(t.filter));var a={};t.config!=null&&t.config.rowhidden!=null&&(a=t.config.rowhidden),$("#luckysheet-filter-options-sheet"+e+" .luckysheet-filter-options").each(function(l){if(t.filter==null)return!1;var o=$(this),d=t.filter[l];if(d==null)return!0;D(d)!="object"&&(d=JSON.parse(d)),pu(o,d.optionstate,d.rowhidden,d.caljs,!1,d.st_r,d.ed_r,d.cindex,d.st_c,d.ed_c),a=$.extend(!0,a,d.rowhidden)}),t.config==null&&(t.config={}),t.config.rowhidden=a,u.config=t.config,ln(u.flowdata.length,u.flowdata[0].length,!1)}},restorePivot:function(e){var n=this.getSheetIndex(e);u.luckysheetfile[n].isPivotTable&&(Pr.getCellData(e),Pr.initialPivotManage(!0),Pr.refreshPivotTable(!1))},restoreSheetAll:function(e){this.restorePivot(e),this.restoreFilter(e),this.restoreFreezen(e)},restoreFreezen:function(e){Ne.initialFreezen(e)},restoreCache:function(){var e=this.CacheNotLoadControll;if(this.CacheNotLoadControll=[],e.length!=0)for(var n=0;n<e.length;n++){var t=e[n];this.execCache(t)}},CacheNotLoadControll:[],execCache:function(e){var n=this,t=e.t,a=e.i,l=e.v,o=u.luckysheetfile[n.getSheetIndex(a)];if(t=="sha")u.luckysheetfile.push(l);else if(t=="shc"){var d=$.extend(!0,{},u.luckysheetfile[n.getSheetIndex(l.copyindex)]);d.index=a,u.luckysheetfile.push(d)}else if(t=="shd")u.luckysheetfile.splice(l.deleIndex,1);else if(t=="shr")for(var s in l)u.luckysheetfile[n.getSheetIndex(s)].order=l[s];if(o!=null&&o.load=="1"||t in{sha:0,shc:0,shd:0,shr:0})if(t=="v"){var h=e.r,f=e.c,p=e.v;n.getSheetData(a),o.data[h][f]=p}else if(t=="fc"){var g=e.op;e.pos,D(l)!="object"&&(l=new Function("return "+l)());var v=l.r,y=l.c;g=="del"?m.delFunctionGroup(v,y,a):m.insertUpdateFunctionGroup(v,y,a)}else if(t=="cg"){var b=l,k=e.k,w=n.getSheetConfig(a);for(var _ in k in w||(w[k]={}),b)w[k][_]=b[_];u.config=w}else if(t=="f"){var C=l,A=e.op,I=e.pos,S=o.filter;S==null&&(S={}),A=="upOrAdd"?S[I]=C:A=="del"&&delete S[I]}else if(t=="fsc")o.filter=null,o.filter_select=null;else if(t=="fsr"){var E=l;o.filter=E.filter,o.filter_select=E.filter_select}else if(t=="sh"){var R=e.op,F=e.cur;if(R=="hide")o.status=0,u.luckysheetfile[n.getSheetIndex(F)].status=1;else if(R=="show"){for(var N=0;N<u.luckysheetfile.length;N++)u.luckysheetfile[N].status=0;o.status=1}}else if(t=="all"){var z=e.k;e.s&&D(l)!="object"?o[z]=JSON.stringify(l):o[z]=l}else if(t=="c"){var P=e.op,q=e.cid;if(P=="add")o.chart.push(l);else if(P=="xy"||P=="wh"||P=="update"){for(var V=0;V<o.chart.length;V++)if(o.chart[V].chart_id==q){for(var x in o.chart[V])for(var ee in l)x==ee&&(o.chart[V][x]=l[ee]);return}}else if(P=="del"){for(var ne=0;ne<o.chart.length;ne++)if(o.chart[ne].chart_id==q)return void o.chart.splice(ne,1)}}else if(t=="drc"){var ae=e.rc,de=l.index,ve=l.len,U=o.celldata;if(ae=="r"){for(var B=0;U.length==0;B++){var le=U[B];le.r>=de&&le.r<de+ve?delete U[B]:le.r>=de+ve&&(le.r-=ve)}o.row-=ve}else{for(var Te=0;U.length==0;Te++){var ue=U[Te];ue.c>=de&&ue.c<de+ve?delete U[Te]:ue.c>=de+ve&&(ue.c-=ve)}o.column-=ve}for(var be=[],ye=0;ye<U.length;ye++)U[ye]!=null&&be.push(U[ye]);o.celldata=be,kc(ae=="r"?"row":"column",de,de+ve-1,!0)}else if(t=="arc"){var ce=e.rc,Re=l.index,pe=l.len,me=o.celldata;if(ce=="r"){for(var re=0;re<me.length;re++){var _e=me[re];_e.r>Re&&(_e.r+=pe)}o.row+=pe}else{for(var Ze=0;Ze<me.length;Ze++){var We=me[Ze];We.c>Re&&(We.c+=pe)}o.column+=pe}Ls(ce=="r"?"row":"column",Re,pe,!0)}else t=="na"?nt.saveParam("na",null,l):t=="thumb"&&setTimeout(function(){n.imageRequest()},2e3);else n.CacheNotLoadControll.push(e)}},m={error:{v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},errorInfo:function(e){return e},errorParamCheck:function(e,n,t){var a,l,o=st().formulaMore;return t<e.length?(a=e[t].type,l=e[t].require):(a=e[e.length-1].type,l=e[e.length-1].require),l!="o"||n!=null&&n!=""?a.indexOf("all")>-1||a.indexOf("range")>-1&&(D(n)=="object"||D(n)=="array")||a.indexOf("number")>-1&&(M(n)||D(n)=="boolean")||a.indexOf("string")>-1&&D(n)=="string"||a.indexOf("date")>-1&&un(n)?[!0,o.tipSuccessText]:[!1,o.tipParamErrorText]:[!0,o.tipSuccessText]},getPureValueByData:function(e){if(e.length==0)return[];var n=[];if(D(e)=="array")if(D(e[0])=="array")for(var t=0;t<e.length;t++){for(var a=[],l=0;l<e[0].length;l++){var o=e[t][l];D(o)=="object"?a.push(o.v):a.push(o)}n.push(a)}else for(var d=0;d<e.length;d++){var s=e[d];D(s)=="object"?n.push(s.v):n.push(s)}else{var h=e;D(h)=="object"?n.push(h.v):n.push(h)}return n},readCellDataToOneArray:function(e){if(e==null)return[];if(D(e)!="object")return[e];var n=[],t=[];if(e==null||e.data==null)return e==null||$t(e.v)?[]:[e.v];if(D(t=e.data)=="array")t=this.getPureValueByData(t);else{if(D(t)=="object")return[t=t.v];/\{.*?\}/.test(t)&&(t=t.replace(/\{/g,"[").replace(/\}/g,"]")),t=new Function("return "+t)()}if(D(t[0])=="array")for(var a=0;a<t.length;a++)n=n.concat(t[a]);else n=t;return n},getValueByFuncData:function(e,n){return e==null?null:D(e)=="array"?n=="avg"?luckysheet_function.AVERAGE.f.apply(luckysheet_function.AVERAGE,e):n=="sum"?luckysheet_function.SUM.f.apply(luckysheet_function.SUM,e):D(e[0])=="object"?luckysheet.mask.getValueByFormat(e[0]):e[0]:D(e)=="object"?luckysheet.mask.getValueByFormat(e):e},sparklinesColorMap:function(e,n){var t=null;if(n==null&&(n=5),e.length>n)for(var a=n;a<e.length;a++)for(var l=e[a],o=this.readCellDataToOneArray(l),d=0;d<o.length;d++){var s=o[d];if(s.indexOf(":")>-1){t||(t={});var h=s.split(":");h.length==2?t[h[0]]=h[1]:h.length>1&&(t[h[0]+":"+h[1]]=h[2])}else t||(t=[]),t.push(s)}return t},colorList:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],classlist:{province:{11:"",12:"",13:"",14:"",15:"",21:"",22:"",23:"",31:"",32:"",33:"",34:"",35:"",36:"",37:"",41:"",42:"",43:"",44:"",45:"",46:"",50:"",51:"",52:"",53:"",54:"",61:"",62:"",63:"",64:"",65:"",71:"",81:"",82:"",91:""}},oldvalue:null,dontupdate:function(){u.luckysheetCellUpdate.length=0,$("#luckysheet-functionbox-cell, #luckysheet-rich-text-editor").html(this.oldvalue),this.cancelNormalSelected(),this.rangetosheet!=u.currentSheetIndex&&ir.changeSheetExec(this.rangetosheet)},fucntionboxshow:function(e,n){if(Hp(e,n,u.currentSheetIndex)){var t=u.flowdata,a="";if(t[e]!=null&&t[e][n]!=null){var l=$.extend(!0,{},t[e][n]);a=qi(l)?function(o,d){var s=Hr(o,d,null,"ct");if(Ih(s)){for(var h=s.s,f="",p=0;p<h.length;p++){var g=h[p];g.v!=null&&(f+=g.v)}return f}return""}(e,n):l.f!=null?Hr(e,n,t,"f"):uu(e,n,t)}this.oldvalue=a,$("#luckysheet-functionbox-cell").html(a)}else $("#luckysheet-functionbox-cell").html("")},cellOffset:function(e,n,t,a,l){var o=e.startCell,d=(e.rowl,e.coll,parseInt(o.replace(/[^0-9]/g,""))),s=rl(o.replace(/[^A-Za-z]/g,"")),h=[],f=[];h[0]=d+n,f[0]=s+t,h[1]=h[0]+a-1,f[1]=f[0]+l-1,f[0]=ya(f[0]),f[1]=ya(f[1]);var p=f[0]+h[0],g=f[1]+h[1];return p==g?e.sheetName+"!"+p:e.sheetName+"!"+p+":"+g},parseDatetoNum:function(e){if(ul(e)=="object"&&typeof e.v=="number")e=e.v;else if(ko(e)=="num")e=parseFloat(e);else{if(ko(e)!="date")return this.error.v;e=_a(e)[2]}return e},getRangeArray:function(e){var n=[],t="General";if(e.length==1)for(var a=0;a<e[0].length;a++)if(e[0][a]!=null&&e[0][a].v){n.push(e[0][a].v);var l=e[0][a].ct.fa;t=t=="General"?l:t}else n.push(null);else if(e[0].length==1)for(var o=0;o<e.length;o++)if(e[o][0]!=null&&e[o][0].v){n.push(e[o][0].v);var d=e[o][0].ct.fa;t=t=="General"?d:t}else n.push(null);else for(var s=0;s<e.length;s++)for(var h=0;h<e[s].length;h++)if(e[s][h]!=null&&e[s][h].v){n.push(e[s][h].v);var f=e[s][h].ct.fa;t=t=="General"?f:t}else n.push(null);return[e=n,t]},getRangeArrayTwo:function(e){var n=$.extend(!0,[],e);if(n.length==1)for(var t=0;t<n[0].length;t++)n[0][t]instanceof Object&&(n[0][t]!=null&&n[0][t]instanceof Object&&n[0][t].m?n[0][t]=n[0][t].m:n[0][t]!=null&&n[0][t]instanceof Object&&n[0][t].v?n[0][t]=n[0][t].v:n[0][t]=null);else if(n[0].length==1)for(var a=0;a<n.length;a++)n[a][0]instanceof Object&&(n[a][0]!=null&&n[a][0]instanceof Object&&n[a][0].m?n[a][0]=n[a][0].m:n[a][0]!=null&&n[a][0]instanceof Object&&n[a][0].v?n[a][0]=n[a][0].v:n[a][0]=null);else for(var l=0;l<n.length;l++)for(var o=0;o<n[l].length;o++)n[l][o]instanceof Object&&(n[l][o]!=null&&n[l][o]instanceof Object&&n[l][o].m?n[l][o]=n[l][o].m:n[l][o]!=null&&n[l][o]instanceof Object&&n[l][o].v?n[l][o]=n[l][o].v:n[l][o]=null);return n},isWildcard:function(e,n){e=e.toString(),n=n.toString(),this.isCompareOperator(n).flag&&(n=this.isCompareOperator(n).num);for(var t="",a=0;a<n.length;a++){var l=n.charAt(a);l=="*"?t+=".*":l=="?"?t+=".":l=="~"?n.charAt(a+1)=="*"?(t+="\\*",a++):n.charAt(a+1)=="?"?(t+="\\?",a++):t+="~":t+=l}var o=new RegExp("^"+t+"$","g");return!!e.match(o)},isCompareOperator:function(e){var n="",t="",a=(e=e.toString()).substr(0,1),l=e.substr(1,1),o=!1;return a==">"?l=="="?(n=e.substr(0,2),t=e.substr(2),o=!0):l!="="&&(n=e.substr(0,1),t=e.substr(1),o=!0):a=="<"?l=="="||l==">"?(n=e.substr(0,2),t=e.substr(2),o=!0):l!="="&&l!=">"&&(n=e.substr(0,1),t=e.substr(1),o=!0):a=="="&&l!="="&&(n=e.substr(0,1),t=e.substr(1),o=!0),{flag:o,ope:n,num:t}},acompareb:function(e,n){var t=!1;if(M(n))t=Ac(e,"==",n);else if(typeof n=="string"){if(n.indexOf("*")!=-1||n.indexOf("?")!=-1)return this.isWildcard(e,n);t=this.isCompareOperator(n).flag?Ac(e,this.isCompareOperator(n).ope,this.isCompareOperator(n).num):Ac(e,"==",n)}return t},compareParams:function(e,n,t){var a=!1,l=toString.call(e),o=toString.call(n);if((t==">"&&e>n||t==">="&&e>=n||t=="<"&&e<n||t=="<="&&e<=n||t=="="&&e==n||t=="<>"&&e!=n)&&(a=!0),l=="[object Object]"&&o=="[object Object]"){var d=Object.getOwnPropertyNames(e),s=Object.getOwnPropertyNames(n);if(d.length!=s.length)return!1;for(var h=0;h<d.length;h++){var f=d[h];if(e[f]!==n[f])return!1}return!0}return l=="[object Array]"&&o=="[object Array]"?e.toString()==n.toString():a},parseDecimal:function(e){e=parseFloat(e);var n=parseInt(e,10);return n==0?e:e%=n},getcellrange:function(e,n){if(e!=null&&e.length!=0){var t="",a="",l=null,o=null,d=an();if(e.indexOf("!")>-1){if(e in this.cellTextToIndexList)return this.cellTextToIndexList[e];var s=e.split("!");for(var h in t=s[0],a=s[1],(t=t.replace(/\\'/g,"'").replace(/''/g,"'")).substr(0,1)=="'"&&t.substr(t.length-1,1)=="'"&&(t=t.substring(1,t.length-1)),d)if(t==d[h].name){l=d[h].index,o=d[h].data;break}}else{var f=n;if(f==null&&(f=u.currentSheetIndex),e+"_"+f in this.cellTextToIndexList)return this.cellTextToIndexList[e+"_"+f];var p=je(f);t=d[p].name,l=d[p].index,o=u.flowdata,a=e}if(a.indexOf(":")==-1){var g=parseInt(a.replace(/[^0-9]/g,""))-1,v=rl(a.replace(/[^A-Za-z]/g,""));if(isNaN(g)||isNaN(v))return null;var y={row:[g,g],column:[v,v],sheetIndex:l};return this.addToCellIndexList(e,y),y}a=a.split(":");var b=[],k=[];if(b[0]=parseInt(a[0].replace(/[^0-9]/g,""))-1,b[1]=parseInt(a[1].replace(/[^0-9]/g,""))-1,isNaN(b[0])&&(b[0]=0),isNaN(b[1])&&(b[1]=o.length-1),b[0]>b[1]||(k[0]=rl(a[0].replace(/[^A-Za-z]/g,"")),k[1]=rl(a[1].replace(/[^A-Za-z]/g,"")),isNaN(k[0])&&(k[0]=0),isNaN(k[1])&&(k[1]=o[0].length-1),k[0]>k[1]))return null;var w={row:b,column:k,sheetIndex:l};return this.addToCellIndexList(e,w),w}},rangeHightlightHTML:'<div id="luckysheet-formula-functionrange-highlight-${id}" rangeindex="${id}"  class="luckysheet-selection-highlight luckysheet-formula-functionrange-highlight"><div data-type="top" class="luckysheet-selection-copy-top luckysheet-copy"></div><div data-type="right" class="luckysheet-selection-copy-right luckysheet-copy"></div><div data-type="bottom" class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div data-type="left" class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div><div data-type="lt" class="luckysheet-selection-highlight-topleft luckysheet-highlight"></div><div data-type="rt" class="luckysheet-selection-highlight-topright luckysheet-highlight"></div><div data-type="lb" class="luckysheet-selection-highlight-bottomleft luckysheet-highlight"></div><div data-type="rb" class="luckysheet-selection-highlight-bottomright luckysheet-highlight"></div></div>',createRangeHightlight:function(){var e=this,n=$("#luckysheet-rich-text-editor").find("span.luckysheet-formula-functionrange-cell");$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),n.each(function(){var t=$(this).attr("rangeindex"),a=$(this).text();$("#luckysheet-formula-functionrange").append(br(e.rangeHightlightHTML,{id:t}));var l=e.getcellrange(a),o="luckysheet-formula-functionrange-highlight-"+t;l==null||(l.sheetIndex==u.currentSheetIndex||l.sheetIndex==-1&&e.rangetosheet==u.currentSheetIndex)&&($("#"+o).data("range",l).find(".luckysheet-copy").css({background:Di[t]}).end().find(".luckysheet-highlight").css({background:Di[t]}).end().find(".luckysheet-selection-copy-hc").css({background:Di[t]}),function(d,s,h,f,p){var g=u.visibledatarow[h],v=s-1==-1?0:u.visibledatarow[s-1],y=u.visibledatacolumn[p],b=f-1==-1?0:u.visibledatacolumn[f-1];$("#"+d).css({left:b,width:y-b-1,top:v,height:g-v-1})}(o,l.row[0],l.row[1],l.column[0],l.column[1]))}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").show()},searchHTML:'<div id="luckysheet-formula-search-c" class="luckysheet-formula-search-c"></div>',helpHTML:'<div id="luckysheet-formula-help-c" class="luckysheet-formula-help-c"> <div class="luckysheet-formula-help-close" title="${helpClose}"><i class="fa fa-times" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-collapse" title="${helpCollapse}"><i class="fa fa-angle-up" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-title"><div class="luckysheet-formula-help-title-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div></div> <div class="luckysheet-formula-help-content"> <div class="luckysheet-formula-help-content-example"> <div class="luckysheet-arguments-help-section-title">${helpExample}</div> <div class="luckysheet-arguments-help-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div> </div> <div class="luckysheet-formula-help-content-detail"> <div class="luckysheet-arguments-help-section"> <div class="luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name">${helpAbstract}</div> <span class="luckysheet-arguments-help-parameter-content">${helpAbstract}</span> </div> </div> <div class="luckysheet-formula-help-content-param"> ${param} </div> </div> <div class="luckysheet-formula-help-foot"></div></div>',getrangeseleciton:function(){var e=window.getSelection(),n=$(e.anchorNode),t=e.anchorOffset;if(n.parent().is("span")&&t!=0){var a=$.trim(n.text());if(a.length==0&&n.parent().prev().length>0){var l=n.parent().prev();return(a=$.trim(l.text())).substr(a.length-1,1),l}return a.substr(t-1,1),n.parent()}if(n.is("#luckysheet-rich-text-editor")||n.is("#luckysheet-functionbox-cell")){var o=$.trim(n.find("span").last().text());if(o.length==0&&n.find("span").length>1){var d=n.find("span");return o=$.trim(d.eq(d.length-2).text()),d}return n.find("span").last()}if((n.parent().is("#luckysheet-rich-text-editor")||n.parent().is("#luckysheet-functionbox-cell")||t==0)&&(t==0&&(n=n.parent()),n.prev().length>0)){var s=$.trim(n.prev().text());return s.substr(s.length-1,1),n.prev()}return null},searchFunctionPosition:function(e,n,t,a,l){var o=$(window).height(),d=$(window).width(),s=e.outerWidth(),h=e.outerHeight();l==null&&(l=!1);var f=t;f=t+s>d?t-s+n.outerWidth():t;var p=a;a+h>o?p=a-h:(p=a+n.outerHeight(),l||e.html(e.find(".luckysheet-formula-search-item").get().reverse())),p<0&&(p=0),f<0&&(f=0),e.css({top:p,left:f}).show()},searchFunctionCell:null,searchFunction:function(e){var n=u.functionlist,t=this.getrangeseleciton();if(this.searchFunctionCell=t,t!=null&&e!=null){var a=e.text(),l=t.text().toUpperCase();if(/^[a-zA-Z]|[a-zA-Z_]+$/.test(l)&&a.substr(0,1)=="="){for(var o={f:[],s:[],t:[]},d=0,s=0;s<n.length;s++){var h=n[s],f=h.n;if(f==l?(o.f.unshift(h),d++):f.substr(0,l.length)==l?(o.s.unshift(h),d++):f.indexOf(l)>-1&&(o.t.unshift(h),d++),d>=10)break}var p=o.t.concat(o.s.concat(o.f));if(!(p.length<=0)){var g=this.searchFunctionHTML(p);$("#luckysheet-formula-search-c").html(g).show(),$("#luckysheet-formula-help-c").hide();var v=e.parent(),y=v.offset();this.searchFunctionPosition($("#luckysheet-formula-search-c"),v,y.left,y.top)}}}},searchFunctionEnter:function(e){var n=e.data("func");this.searchFunctionCell.text(n).after('<span dir="auto" class="luckysheet-formula-text-color">(</span>'),this.setCaretPosition(this.searchFunctionCell.next().get(0),0,1),$("#luckysheet-formula-search-c").hide(),this.helpFunctionExe(this.searchFunctionCell.closest("div"),this.searchFunctionCell.next())},searchFunctionHTML:function(e){var n=this;$("#luckysheet-formula-search-c").length==0&&($("body").append(n.searchHTML),$("#luckysheet-formula-search-c").on("mouseover",".luckysheet-formula-search-item",function(){$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),$(this).addClass("luckysheet-formula-search-item-active")}).on("mouseout",".luckysheet-formula-search-item",function(){}).on("click",".luckysheet-formula-search-item",function(){n.searchFunctionCell!=null&&n.searchFunctionEnter($(this))}));for(var t='<div data-func="${n}" class="luckysheet-formula-search-item ${class}"><div class="luckysheet-formula-search-func">${n}</div><div class="luckysheet-formula-search-detail">${a}</div></div>',a="",l=0;l<e.length;l++){var o=e[l];l==e.length-1?a+=br(t,{class:"luckysheet-formula-search-item-active",n:o.n,a:o.a}):a+=br(t,{class:"",n:o.n,a:o.a})}return a},functionlistPosition:{},helpFunction:function(e,n,t){var a=u.functionlist[this.functionlistPosition[$.trim(n).toUpperCase()]];if(a!=null){var l=st().formulaMore;$("#luckysheet-formula-help-c .luckysheet-arguments-help-function-name").html(a.n),$("#luckysheet-formula-help-c .luckysheet-arguments-help-parameter-content").html(a.d);for(var o="",d="",s="",h=0;h<a.p.length;h++){var f=a.p[h],p=f.name,g=f.name;f.repeat=="y"&&(p+=", ...",g+='<span class="luckysheet-arguments-help-argument-info">...-'+l.allowRepeatText+"</span>"),f.require=="o"&&(p="["+p+"]",g+='<span class="luckysheet-arguments-help-argument-info">-['+l.allowOptionText+"]</span>"),o+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+p+"</span>, ",d+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+f.example+"</span>, ",s+=br('<div class="luckysheet-arguments-help-section"><div class="luckysheet-arguments-help-section-title">${param}</div><span class="luckysheet-arguments-help-parameter-content">${content}</span></div>',{param:g,content:f.detail})}if(o=o.substr(0,o.length-2),d=d.substr(0,d.length-2),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder").html(o),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder").html(d),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param").html(s),t==null)$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","bold");else{$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","normal");var v=t>=a.p.length?a.p.length-1:t;$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(v).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(v).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").eq(v).addClass("luckysheet-arguments-help-parameter-active")}var y=e.parent(),b=y.offset();this.searchFunctionPosition($("#luckysheet-formula-help-c"),y,b.left,b.top,!0)}},helpFunctionExe:function(e,n){var t=this,a=u.functionlist,l=st().formulaMore;if($("#luckysheet-formula-help-c").length==0){$("body").after(br(t.helpHTML,{helpClose:l.helpClose,helpCollapse:l.helpCollapse,helpExample:l.helpExample,helpAbstract:l.helpAbstract})),$("#luckysheet-formula-help-c .luckysheet-formula-help-close").click(function(){$("#luckysheet-formula-help-c").hide()}),$("#luckysheet-formula-help-c .luckysheet-formula-help-collapse").click(function(){var w=$("#luckysheet-formula-help-c .luckysheet-formula-help-content");w.slideToggle(100,function(){var _=t.rangeResizeTo.parent(),C=_.offset();t.searchFunctionPosition($("#luckysheet-formula-help-c"),_,C.left,C.top,!0)}),w.is(":hidden")?$(this).html('<i class="fa fa-angle-up" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-angle-down" aria-hidden="true"></i>')});for(var o=0;o<a.length;o++)t.functionlistPosition[a[o].n]=o}if(n){var d=n,s=(e.length,e.find("span")),h=n.index(),f=h;if(d!=null){var p=null,g=null;if(s.eq(f).is(".luckysheet-formula-text-func"))p=s.eq(f).text();else for(var v=null,y=[-1,-1];--f>0;)if((v=s.eq(f)).is(".luckysheet-formula-text-func")||$.trim(v.text()).toUpperCase()in t.functionlistPosition){p=v.text(),g=null;for(var b=!0,k=f;k<=h;k++)if(g||(g=0),!(k>=y[0]&&k<=y[1])){if((v=s.eq(k)).is(".luckysheet-formula-text-rpar")){y=[f,k],p=null,b=!1;break}v.is(".luckysheet-formula-text-comma")&&g++}if(b)break}p!=null&&t.helpFunction(e,p,g)}}},rangeHightlightselected:function(e,n){var t=this.getrangeseleciton();if($("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight .luckysheet-selection-copy-hc").css("opacity","0.03"),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),this.helpFunctionExe(e,t),$(t).closest(".luckysheet-formula-functionrange-cell").length!=0){var a=$(t).closest(".luckysheet-formula-functionrange-cell").attr("rangeindex");$("#"+("luckysheet-formula-functionrange-highlight-"+a)).find(".luckysheet-selection-copy-hc").css({opacity:"0.13"})}else this.searchFunction(e)},updatecell:function(e,n,t){var a=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],l=this,o=$("#luckysheet-rich-text-editor"),d=o.text(),s=o.html();if(l.rangetosheet!=null&&l.rangetosheet!=u.currentSheetIndex&&ir.changeSheetExec(l.rangetosheet),Up(e,n,u.currentSheetIndex)){if(aa.dataVerification!=null){var h=aa.dataVerification[e+"_"+n];if(h!=null&&h.prohibitInput&&!aa.validateCellData(d,h)){var f=aa.getFailureText(h);return Ee.info(f,""),void l.cancelNormalSelected()}}var p=u.flowdata[e][n],g=JSON.stringify(p),v=qi(p),y=d.slice(0,1)!="="&&s.substr(0,5)=="<span",b=!1;if(!y&&d&&d.length>0){var k=d.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_").split("_x000D_");k.length>1&&(b=!0,y=!0,d=k.join(`\r
`))}if(t||y||!v?y&&(D(p)!="object"&&(p={}),delete p.f,delete p.v,delete p.m,p.ct==null&&(p.ct={},p.ct.fa="General"),p.ct.t="inlineStr",p.ct.s=Z1(o.find("span")),b&&(p.ct.s=[{v:d}])):(delete p.ct.s,p.ct.t="g",p.ct.fa="General",t=""),t=t||o.text(),Ya.createHookFunction("cellUpdateBefore",e,n,t,a)){if(!y){if($t(t)&&!v){if(p==null||$t(p.v)&&p.spl==null&&p.f==null)return void l.cancelNormalSelected()}else if(p!=null&&p.qp!=1&&(D(p)=="object"&&(t==p.f||t==p.v||t==p.m)||t==p))return void l.cancelNormalSelected();D(t)=="string"&&t.slice(0,1)=="="&&t.length>1||D(p)!="object"||p.ct==null||p.ct.fa==null||p.ct.fa=="@"||$t(t)||(delete p.m,p.f!=null&&(delete p.f,delete p.spl))}window.luckysheet_getcelldata_cache=null;var w=!0,_=vr.deepCopyFlowData(u.flowdata),C=null;if(D(p)=="object"){if(!y)if(D(t)=="string"&&t.slice(0,1)=="="&&t.length>1){var A=l.execfunction(t,e,n,void 0,!0);if(w=!1,(p=$.extend(!0,{},_[e][n])).v=A[1],p.f=A[2],A.length==4&&A[3].type=="sparklines"){delete p.m,delete p.v;var I=A[3].data;D(I)=="array"&&D(I[0])!="object"?p.v=I[0]:p.spl=A[3].data}else A.length==4&&A[3].type=="dynamicArrayItem"&&(C=A[3].data)}else if(D(t)=="object"){var S=t.f;if(D(S)=="string"&&S.slice(0,1)=="="&&S.length>1){var E=l.execfunction(S,e,n,void 0,!0);if(w=!1,(p=$.extend(!0,{},_[e][n])).v=E[1],p.f=E[2],E.length==4&&E[3].type=="sparklines"){delete p.m,delete p.v;var R=E[3].data;D(R)=="array"&&D(R[0])!="object"?p.v=R[0]:p.spl=E[3].data}else E.length==4&&E[3].type=="dynamicArrayItem"&&(C=E[3].data)}else for(var F in t)p[F]=t[F]}else l.delFunctionGroup(e,n),l.execFunctionGroup(e,n,t),w=!1,(p=$.extend(!0,{},_[e][n])).v=t,delete p.f,delete p.spl,p.qp==1&&(""+t).substr(0,1)!="'"&&(p.qp=0,p.ct!=null&&(p.ct.fa="General",p.ct.t="n"));t=p}else if(D(t)=="string"&&t.slice(0,1)=="="&&t.length>1){var N=l.execfunction(t,e,n,void 0,!0);if(w=!1,t={v:N[1],f:N[2]},N.length==4&&N[3].type=="sparklines"){var z=N[3].data;D(z)=="array"&&D(z[0])!="object"?t.v=z[0]:t.spl=N[3].data}else N.length==4&&N[3].type=="dynamicArrayItem"&&(C=N[3].data)}else if(D(t)=="object"){var P=t.f;if(D(P)=="string"&&P.slice(0,1)=="="&&P.length>1){var q=l.execfunction(P,e,n,void 0,!0);if(w=!1,t.v=q[1],t.f=q[2],q.length==4&&q[3].type=="sparklines"){var V=q[3].data;D(V)=="array"&&D(V[0])!="object"?t.v=V[0]:t.spl=q[3].data}else q.length==4&&q[3].type=="dynamicArrayItem"&&(C=q[3].data)}else{var x=p;t.v==null&&(t.v=x)}}else l.delFunctionGroup(e,n),l.execFunctionGroup(e,n,t),w=!1;Ln(e,n,_,t),l.cancelNormalSelected();var ee=!1,ne=$.extend(!0,{},an()[je(u.currentSheetIndex)].config);if(ne.rowlen==null&&(ne.rowlen={}),_[e][n].tb=="2"&&_[e][n].v!=null||qi(_[e][n])){var ae=u.defaultrowlen,de=$("#luckysheetTableContent").get(0).getContext("2d");if(!(ne.customHeight&&ne.customHeight[e]==1)){var ve=En(n)[1]-En(n)[0]-2,U=qs(_[e][n],de,{r:e,c:n,cellWidth:ve}),B=ae;U!=null&&(B=U.textHeightAll+2),B>ae&&(ne.rowlen[e]=B,ee=!0)}}var le=null;C&&(le=$.extend(!0,[],this.insertUpdateDynamicArray(C)));var Te={dynamicArray:le};if(ee&&(Te={cfg:ne,dynamicArray:le,RowlChange:ee}),setTimeout(function(){Ya.createHookFunction("cellUpdated",e,n,JSON.parse(g),u.flowdata[e][n],a)},0),!a)return{data:_,allParam:Te};wa(_,[{row:[e,e],column:[n,n]}],Te,w),l.execFunctionGlobalData=null}else l.cancelNormalSelected()}},cancelNormalSelected:function(){this.canceFunctionrangeSelected(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-input-box-index").hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").removeClass("luckysheet-wa-calculate-active"),this.rangestart=!1,this.rangedrag_column_start=!1,this.rangedrag_row_start=!1},canceFunctionrangeSelected:function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide()},iscellformat:function(e){},iscelldata:function(e){var n,t=e.split("!"),a=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if((n=t.length>1?t[1]:t[0]).indexOf(":")==-1){var l=parseInt(n.replace(/[^0-9]/g,""))-1,o=rl(n.replace(/[^A-Za-z]/g,""));return!(isNaN(l)||isNaN(o)||!n.toString().match(/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g))||!!isNaN(l)&&!1}a=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,n=n.split(":");var d=[],s=[];return d[0]=parseInt(n[0].replace(/[^0-9]/g,""))-1,d[1]=parseInt(n[1].replace(/[^0-9]/g,""))-1,!(d[0]>d[1])&&(s[0]=rl(n[0].replace(/[^A-Za-z]/g,"")),s[1]=rl(n[1].replace(/[^A-Za-z]/g,"")),!(s[0]>s[1])&&!(!n[0].toString().match(a)||!n[1].toString().match(a)))},operator:"==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",operatorjson:null,functionCopy:function(e,n,t){if(this.operatorjson==null){for(var a=this.operator.split("|"),l={},o=0;o<a.length;o++)l[a[o].toString()]=1;this.operatorjson=l}n==null&&(n="down"),t==null&&(t=1),e.substr(0,1)=="="&&(e=e.substr(1));for(var d=e.split(""),s=0,h="",f="",p={bracket:0,comma:0,squote:0,dquote:0};s<d.length;){var g=d[s];if(g=="("&&p.dquote==0)p.bracket+=1,h.length>0?f+=h+"(":f+="(",h="";else if(g==")"&&p.dquote==0)p.bracket-=1,f+=this.functionCopy(h,n,t)+")",h="";else if(g=='"'&&p.squote==0)p.dquote>0?(f+=h+'"',p.dquote-=1,h=""):(p.dquote+=1,h+='"');else if(g==","&&p.dquote==0)f+=this.functionCopy(h,n,t)+",",h="";else if(g=="&"&&p.dquote==0)h.length>0?(f+=this.functionCopy(h,n,t)+"&",h=""):f+="&";else if(g in this.operatorjson&&p.dquote==0){var v="";s+1<d.length&&(v=d[s+1]);var y=s-1,b=null;if(y>=0)do b=d[y--];while(y>=0&&b==" ");g+v in this.operatorjson?(h.length>0?(f+=this.functionCopy(h,n,t)+g+v,h=""):f+=g+v,s++):/[^0-9]/.test(v)||g!="-"||b!="("&&b!=null&&b!=","&&b!=" "&&!(b in this.operatorjson)?h.length>0?(f+=this.functionCopy(h,n,t)+g,h=""):f+=g:h+=g}else h+=g;s==d.length-1&&(this.iscelldata($.trim(h))?n=="down"?f+=this.downparam($.trim(h),t):n=="up"?f+=this.upparam($.trim(h),t):n=="left"?f+=this.leftparam($.trim(h),t):n=="right"&&(f+=this.rightparam($.trim(h),t)):f+=$.trim(h)),s++}return f},isfreezonFuc:function(e){var n=e.replace(/[^0-9]/g,""),t=e.replace(/[^A-Za-z]/g,""),a=e.substr(e.indexOf(n)-1,1),l=e.substr(e.indexOf(t)-1,1),o=[!1,!1];return a=="$"&&(o[0]=!0),l=="$"&&(o[1]=!0),o},setfreezonFuceExe:function(e){var n=parseInt(e.replace(/[^0-9]/g,"")),t=rl(e.replace(/[^A-Za-z]/g,""));return isNaN(n)||isNaN(t)?isNaN(n)?isNaN(t)?e:"$"+ya(t):"$"+n:"$"+ya(t)+"$"+n},setfreezonFuc:function(e){var n=this.getrangeseleciton();if(this.iscelldata(n.text())){var t,a=n.text(),l=window.getSelection().anchorOffset,o=a.split("!"),d="";o.length>1?(t=o[1],d=o[0]+"!"):t=o[0];var s="",h="",f=t.indexOf(":");if(f==-1)h=(s=d+this.setfreezonFuceExe(t)).length;else if(t=t.split(":"),l>f){var p=d+t[0]+":"+this.setfreezonFuceExe(t[1]);s=p,h=p.length}else{var g=d+this.setfreezonFuceExe(t[0]);s=g+":"+t[1],h=g.length}n.text(d+s),this.setCaretPosition(n.get(0),0,h)}},updateparam:function(e,n,t){var a,l=n.split("!"),o="";if(l.length>1?(a=l[1],o=l[0]+"!"):a=l[0],a.indexOf(":")==-1){var d=parseInt(a.replace(/[^0-9]/g,"")),s=rl(a.replace(/[^A-Za-z]/g,"")),h=this.isfreezonFuc(a),f=h[0]?"$":"",p=h[1]?"$":"";return e!="u"||h[0]?e!="r"||h[1]?e!="l"||h[1]?e!="d"||h[0]||(d+=t):s-=t:s+=t:d-=t,d[0]<0||s[0]<0?this.error.r:isNaN(d)||isNaN(s)?isNaN(d)?isNaN(s)?n:o+p+ya(s):o+f+d:o+p+ya(s)+f+d}a=a.split(":");var g=[],v=[];if(g[0]=parseInt(a[0].replace(/[^0-9]/g,"")),g[1]=parseInt(a[1].replace(/[^0-9]/g,"")),g[0]>g[1]||(v[0]=rl(a[0].replace(/[^A-Za-z]/g,"")),v[1]=rl(a[1].replace(/[^A-Za-z]/g,"")),v[0]>v[1]))return n;var y=this.isfreezonFuc(a[0]),b=this.isfreezonFuc(a[1]),k=y[0]?"$":"",w=y[1]?"$":"",_=b[0]?"$":"",C=b[1]?"$":"";return e=="u"?(y[0]||(g[0]-=t),b[0]||(g[1]-=t)):e=="r"?(y[1]||(v[0]+=t),b[1]||(v[1]+=t)):e=="l"?(y[1]||(v[0]-=t),b[1]||(v[1]-=t)):e=="d"&&(y[0]||(g[0]+=t),b[0]||(g[1]+=t)),g[0]<0||v[0]<0?this.error.r:isNaN(v[0])&&isNaN(v[1])?o+k+g[0]+":"+_+g[1]:isNaN(g[0])&&isNaN(g[1])?o+w+ya(v[0])+":"+C+ya(v[1]):o+w+ya(v[0])+k+g[0]+":"+C+ya(v[1])+_+g[1]},downparam:function(e,n){return this.updateparam("d",e,n)},upparam:function(e,n){return this.updateparam("u",e,n)},leftparam:function(e,n){return this.updateparam("l",e,n)},rightparam:function(e,n){return this.updateparam("r",e,n)},functionStrChange:function(e,n,t,a,l,o){if(this.operatorjson==null){for(var d=this.operator.split("|"),s={},h=0;h<d.length;h++)s[d[h].toString()]=1;this.operatorjson=s}e.substr(0,1)=="="&&(e=e.substr(1));for(var f=e.split(""),p=0,g="",v="",y={bracket:0,comma:0,squote:0,dquote:0};p<f.length;){var b=f[p];if(b=="("&&y.dquote==0)y.bracket+=1,g.length>0?v+=g+"(":v+="(",g="";else if(b==")"&&y.dquote==0)y.bracket-=1,v+=this.functionStrChange(g,n,t,a,l,o)+")",g="";else if(b=='"'&&y.squote==0)y.dquote>0?(v+=g+'"',y.dquote-=1,g=""):(y.dquote+=1,g+='"');else if(b==","&&y.dquote==0)v+=this.functionStrChange(g,n,t,a,l,o)+",",g="";else if(b=="&"&&y.dquote==0)g.length>0?(v+=this.functionStrChange(g,n,t,a,l,o)+"&",g=""):v+="&";else if(b in this.operatorjson&&y.dquote==0){var k="";p+1<f.length&&(k=f[p+1]);var w=p-1,_=null;if(w>=0)do _=f[w--];while(w>=0&&_==" ");b+k in this.operatorjson?(g.length>0?(v+=this.functionStrChange(g,n,t,a,l,o)+b+k,g=""):v+=b+k,p++):/[^0-9]/.test(k)||b!="-"||_!="("&&_!=null&&_!=","&&_!=" "&&!(_ in this.operatorjson)?g.length>0?(v+=this.functionStrChange(g,n,t,a,l,o)+b,g=""):v+=b:g+=b}else g+=b;p==f.length-1&&(this.iscelldata($.trim(g))?v+=this.functionStrChange_range($.trim(g),n,t,a,l,o):v+=$.trim(g)),p++}return v},functionStrChange_range:function(e,n,t,a,l,o){var d,s,h,f,p,g,v,y,b,k=e.split("!"),w="";if(k.length>1?(d=k[1],w=k[0]+"!"):d=k[0],d.indexOf(":")==-1){s=h=parseInt(d.replace(/[^0-9]/g,""))-1,f=p=rl(d.replace(/[^A-Za-z]/g,""));var _=this.isfreezonFuc(d);g=v=_[0]?"$":"",y=b=_[1]?"$":""}else{if(d=d.split(":"),(s=parseInt(d[0].replace(/[^0-9]/g,""))-1)>(h=parseInt(d[1].replace(/[^0-9]/g,""))-1)||(f=rl(d[0].replace(/[^A-Za-z]/g,"")))>(p=rl(d[1].replace(/[^A-Za-z]/g,""))))return e;var C=this.isfreezonFuc(d[0]);g=C[0]?"$":"",y=C[1]?"$":"";var A=this.isfreezonFuc(d[1]);v=A[0]?"$":"",b=A[1]?"$":""}if(n=="del"){if(t=="row"){if(s>=l&&h<=l+o-1)return this.error.r;s>l+o-1?s-=o:s>=l&&(s=l),h>l+o-1?h-=o:h>=l&&(h=l-1),s<0&&(s=0),h<s&&(h=s)}else if(t=="col"){if(f>=l&&p<=l+o-1)return this.error.r;f>l+o-1?f-=o:f>=l&&(f=l),p>l+o-1?p-=o:p>=l&&(p=l-1),f<0&&(f=0),p<f&&(p=f)}return s==h&&f==p?isNaN(s)||isNaN(f)?isNaN(s)?isNaN(f)?e:w+y+ya(f):w+g+(s+1):w+y+ya(f)+g+(s+1):isNaN(f)&&isNaN(p)?w+g+(s+1)+":"+v+(h+1):isNaN(s)&&isNaN(h)?w+y+ya(f)+":"+b+ya(p):w+y+ya(f)+g+(s+1)+":"+b+ya(p)+v+(h+1)}if(n=="add")return t=="row"?a=="lefttop"?(s>=l&&(s+=o),h>=l&&(h+=o)):a=="rightbottom"&&(s>l&&(s+=o),h>l&&(h+=o)):t=="col"&&(a=="lefttop"?(f>=l&&(f+=o),p>=l&&(p+=o)):a=="rightbottom"&&(f>l&&(f+=o),p>l&&(p+=o))),s==h&&f==p?isNaN(s)||isNaN(f)?isNaN(s)?isNaN(f)?e:w+y+ya(f):w+g+(s+1):w+y+ya(f)+g+(s+1):isNaN(f)&&isNaN(p)?w+g+(s+1)+":"+v+(h+1):isNaN(s)&&isNaN(h)?w+y+ya(f)+":"+b+ya(p):w+y+ya(f)+g+(s+1)+":"+b+ya(p)+v+(h+1)},israngeseleciton:function(e){if(this.operatorjson==null){for(var n=this.operator.split("|"),t={},a=0;a<n.length;a++)t[n[a].toString()]=1;this.operatorjson=t}e==null&&(e=!1);var l=window.getSelection(),o=$(l.anchorNode),d=l.anchorOffset;if(o.parent().is("span")&&d!=0){var s=$.trim(o.text()),h="";if(s.length==0&&o.parent().prev().length>0){var f=o.parent().prev();h=(s=$.trim(f.text())).substr(s.length-1,1),this.rangeSetValueTo=f}else h=s.substr(d-1,1),this.rangeSetValueTo=o.parent();if(e&&(h=="("||h==",")||!e&&(h=="("||h==","||h=="="||h in this.operatorjson||h=="&"))return!0}else if(o.is("#luckysheet-rich-text-editor")||o.is("#luckysheet-functionbox-cell")){var p,g=$.trim(o.find("span").last().text());if(this.rangeSetValueTo=o.find("span").last(),g.length==0&&o.find("span").length>1){var v=o.find("span");g=$.trim(v.eq(v.length-2).text()),this.rangeSetValueTo=v}if(p=g.substr(g.length-1,1),e&&(p=="("||p==",")||!e&&(p=="("||p==","||p=="="||p in this.operatorjson||p=="&"))return!0}else if((o.parent().is("#luckysheet-rich-text-editor")||o.parent().is("#luckysheet-functionbox-cell")||d==0)&&(d==0&&(o=o.parent()),o.prev().length>0)){var y=$.trim(o.prev().text()),b=y.substr(y.length-1,1);if(this.rangeSetValueTo=o.prev(),e&&(b=="("||b==",")||!e&&(b=="("||b==","||b=="="||b in this.operatorjson||b=="&"))return!0}return!1},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangeSetValue:function(e,n){var t,a="",l=e.row[0],o=e.column[0];if(a=u.config.merge!=null&&l+"_"+o in u.config.merge?wn(u.currentSheetIndex,{column:[o,o],row:[l,l]},this.rangetosheet):wn(u.currentSheetIndex,e,this.rangetosheet),this.rangestart||this.rangedrag_column_start||this.rangedrag_row_start)if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")){t=$("#luckysheet-rich-text-editor"),$("#luckysheet-search-formula-parm-select-input").val(a),$("#luckysheet-search-formula-parm .parmBox").eq(this.data_parm_index).find(".txt input").val(a);var d=no(a).data;if(d instanceof Array){for(var s=[],h=0;h<d.length;h++)for(var f=0;f<d[h].length;f++)d[h][f]==null?s.push(null):s.push(d[h][f].v);$("#luckysheet-search-formula-parm .parmBox").eq(this.data_parm_index).find(".val").text(" = {"+s.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(this.data_parm_index).find(".val").text(" = {"+d.v+"}");var p,g=!0,v=[],y=-1;if($("#luckysheet-search-formula-parm .parmBox").each(function(S,E){var R=$(E).find(".txt input").val();R==""&&$(E).find(".txt input").attr("data_parm_require")=="m"&&(g=!1),R!=""&&(y=S)}),y==-1)p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(y==0)p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(var b=0;b<=y;b++)v.push($("#luckysheet-search-formula-parm .parmBox").eq(b).find(".txt input").val());p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+v.join(",")+")"}var k=this.functionHTMLGenerate(p);if($("#luckysheet-rich-text-editor").html(k),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),g){var w=$.trim(this.functionParserExe($("#luckysheet-rich-text-editor").text())),_=new Function("return "+w)();$("#luckysheet-search-formula-parm .result span").text(_)}}else{var C=window.getSelection().anchorNode,A=(t=$(C).closest("div")).find("span[rangeindex='"+this.rangechangeindex+"']").html(a);this.setCaretPosition(A.get(0),0,a.length)}else{var I='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+this.functionHTMLIndex+'" dir="auto" style="color:'+Di[this.functionHTMLIndex]+';">'+a+"</span>";$(I).insertAfter(this.rangeSetValueTo),this.rangechangeindex=this.functionHTMLIndex,t=$(this.rangeSetValueTo).closest("div"),this.setCaretPosition(t.find("span[rangeindex='"+this.rangechangeindex+"']").get(0),0,a.length),this.functionHTMLIndex++}t.attr("id")=="luckysheet-rich-text-editor"?$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()):$("#luckysheet-rich-text-editor").html($("#luckysheet-functionbox-cell").html())},rangedrag:function(e){var n=pa(e.pageX,e.pageY),t=n[0]+$("#luckysheet-cell-main").scrollLeft(),a=Wa(n[1]+$("#luckysheet-cell-main").scrollTop()),l=a[1],o=a[0],d=a[2],s=ja(t),h=s[1],f=s[0],p=s[2],g=0,v=0,y=[];this.func_selectedrange.top>o?(g=o,v=this.func_selectedrange.top+this.func_selectedrange.height-o,y=[d,this.func_selectedrange.row[1]]):this.func_selectedrange.top==o?(g=o,v=this.func_selectedrange.top+this.func_selectedrange.height-o,y=[d,this.func_selectedrange.row[0]]):(g=this.func_selectedrange.top,v=l-this.func_selectedrange.top-1,y=[this.func_selectedrange.row[0],d]);var b=0,k=0,w=[];this.func_selectedrange.left>f?(b=f,k=this.func_selectedrange.left+this.func_selectedrange.width-f,w=[p,this.func_selectedrange.column[1]]):this.func_selectedrange.left==f?(b=f,k=this.func_selectedrange.left+this.func_selectedrange.width-f,w=[p,this.func_selectedrange.column[0]]):(b=this.func_selectedrange.left,k=h-this.func_selectedrange.left-1,w=[this.func_selectedrange.column[0],p]),y[0]=Ne.changeFreezenIndex(y[0],"h"),y[1]=Ne.changeFreezenIndex(y[1],"h"),w[0]=Ne.changeFreezenIndex(w[0],"v"),w[1]=Ne.changeFreezenIndex(w[1],"v");var _=dr.mergeMoveMain(w,y,this.func_selectedrange,g,v,b,k);if(_!=null&&(w=_[0],y=_[1],g=_[2],v=_[3],b=_[4],k=_[5]),this.func_selectedrange.row=y,this.func_selectedrange.column=w,this.func_selectedrange.left_move=b,this.func_selectedrange.width_move=k,this.func_selectedrange.top_move=g,this.func_selectedrange.height_move=v,lo(b,g,k,v,y,w),$("#luckysheet-formula-functionrange-select").css({left:b,width:k,top:g,height:v}).show(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var C=wn(u.currentSheetIndex,{row:y,column:w},u.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(C)}else this.rangeSetValue({row:y,column:w});Ne.scrollFreezen(y,w)},rangedrag_column_start:!1,rangedrag_row_start:!1,rangedrag_column:function(e){var n=pa(e.pageX,e.pageY),t=n[0]+$("#luckysheet-cell-main").scrollLeft(),a=(n[1],$("#luckysheet-cell-main").scrollTop(),u.visibledatarow),l=a.length-1,o=a[l],d=ja(t),s=d[1],h=d[0],f=d[2],p=0,g=0,v=[];this.func_selectedrange.left>h?(p=h,g=this.func_selectedrange.left+this.func_selectedrange.width-h,v=[f,this.func_selectedrange.column[1]]):this.func_selectedrange.left==h?(p=h,g=this.func_selectedrange.left+this.func_selectedrange.width-h,v=[f,this.func_selectedrange.column[0]]):(p=this.func_selectedrange.left,g=s-this.func_selectedrange.left-1,v=[this.func_selectedrange.column[0],f]),v[0]=Ne.changeFreezenIndex(v[0],"v"),v[1]=Ne.changeFreezenIndex(v[1],"v");var y=dr.mergeMoveMain(v,[0,l],this.func_selectedrange,0,o-0-1,p,g);y!=null&&(v=y[0],p=y[4],g=y[5]),this.func_selectedrange.column=v,this.func_selectedrange.left_move=p,this.func_selectedrange.width_move=g,lo(p,0,g,o-0-1,[0,l],v),this.rangeSetValue({row:[null,null],column:v}),$("#luckysheet-formula-functionrange-select").css({left:p,width:g,top:0,height:o-0-1}).show(),Ne.scrollFreezen([0,l],v)},rangedrag_row:function(e){var n=pa(e.pageX,e.pageY),t=(n[0],$("#luckysheet-cell-main").scrollLeft(),Wa(n[1]+$("#luckysheet-cell-main").scrollTop())),a=t[1],l=t[0],o=t[2],d=u.visibledatacolumn,s=d.length-1,h=d[s],f=0,p=0,g=[];this.func_selectedrange.top>l?(f=l,p=this.func_selectedrange.top+this.func_selectedrange.height-l,g=[o,this.func_selectedrange.row[1]]):this.func_selectedrange.top==l?(f=l,p=this.func_selectedrange.top+this.func_selectedrange.height-l,g=[o,this.func_selectedrange.row[0]]):(f=this.func_selectedrange.top,p=a-this.func_selectedrange.top-1,g=[this.func_selectedrange.row[0],o]),g[0]=Ne.changeFreezenIndex(g[0],"h"),g[1]=Ne.changeFreezenIndex(g[1],"h");var v=dr.mergeMoveMain([0,s],g,this.func_selectedrange,f,p,0,h-0-1);v!=null&&(g=v[1],f=v[2],p=v[3]),this.func_selectedrange.row=g,this.func_selectedrange.top_move=f,this.func_selectedrange.height_move=p,lo(0,f,h-0-1,p,g,[0,s]),this.rangeSetValue({row:g,column:[null,null]}),$("#luckysheet-formula-functionrange-select").css({left:0,width:h-0-1,top:f,height:p}).show(),Ne.scrollFreezen(g,[0,s])},rangedragged:function(){},rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeResizeDraging:function(e,n,t,a,l,o,d,s){var h=$("#luckysheet-scrollbar-y").scrollTop(),f=$("#luckysheet-scrollbar-x").scrollLeft(),p=pa(e.pageX,e.pageY),g=p[0]+f,v=p[1]+h,y=Wa(v),b=y[1],k=y[0],w=ja(g),_=w[1],C=w[0];if(g<0||v<0)return!1;var A=k-t[1],I=C-t[0],S=t[5],E=t[3],R=t[4],F=t[2];if(a=="lt"||a=="lb"){if(t[0]+t[2]<C)return;R=C,F=t[2]-I,R>t[2]+t[4]-_+C?(R=t[2]+t[4]-_+C,F=t[2]-(t[2]+t[4]-_+C-t[0])):R<=0&&(R=0,F=t[2]+t[0])}if(a=="rt"||a=="rb"){if(t[6]-t[2]>_)return;(F=t[2]+_-t[6])<_-C-1?F=_-C-1:F>=d-R&&(F=d-R)}if(a=="lt"||a=="rt"){if(t[1]+t[3]<k)return;S=k,E=t[3]-A,S>t[3]+t[5]-b+k?(S=t[3]+t[5]-b+k,E=t[3]-(t[3]+t[5]-b+k-t[1])):S<=0&&(S=0,E=t[3]+t[1])}if(a=="lb"||a=="rb"){if(t[7]-t[3]>b)return;(E=t[3]+b-t[7])<b-k-1?E=b-k-1:E>=s-S&&(E=s-S)}var N=this.rangeResizeIndex,z={top:S,left:R,height:E,width:F},P=this.getSelectedFromRange(z),q=wn(u.currentSheetIndex,P,this.rangetosheet);this.rangeResizeTo.find("span[rangeindex='"+N+"']").html(q),rs(this.rangeResizeTo[0]),n.css(z).data("range",P)},getSelectedFromRange:function(e){var n=e.top+2,t=e.top+e.height-2,a=e.left+2,l=e.left+e.width-2;return{row:[Wa(n)[2],Wa(t)[2]],column:[ja(a)[2],ja(l)[2]]}},rangeResizeDragged:function(e,n,t,a,l,o){this.rangeResize=null,$("#luckysheet-formula-functionrange-highlight-"+this.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.03)},rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,rangeMoveDraging:function(e,n,t,a,l,o){var d=pa(e.pageX,e.pageY),s=$("#luckysheet-scrollbar-x").scrollLeft(),h=$("#luckysheet-scrollbar-y").scrollTop(),f=d[0]+s,p=d[1]+h,g=$(window).height()+h-l-o,v=$(window).width()+s,y=n[0],b=n[1],k=t.row[0]-y+Wa(p)[2],w=t.row[1]-y+Wa(p)[2],_=t.column[0]-b+ja(f)[2],C=t.column[1]-b+ja(f)[2];(k<0||p<0)&&(k=0,w=t.row[1]-t.row[0]),(_<0||f<0)&&(_=0,C=t.column[1]-t.column[0]);var A=u.visibledatarow;(w>=A[A.length-1]||p>g)&&(k=A.length-1-t.row[1]+t.row[0],w=A.length-1);var I=u.visibledatacolumn;(C>=I[I.length-1]||f>v)&&(_=I.length-1-t.column[1]+t.column[0],C=I.length-1);var S=_-1==-1?0:I[_-1],E=I[C],R=k-1==-1?0:A[k-1],F=A[w],N=this.rangeMoveIndex,z={left:S,width:E-S-2,top:R,height:F-R-2,display:"block"},P=this.getSelectedFromRange(z),q=wn(u.currentSheetIndex,P,this.rangetosheet);this.rangeResizeTo.find("span[rangeindex='"+N+"']").html(q),rs(this.rangeResizeTo[0]),this.rangeMoveRangedata=P,a.css(z)},rangeMoveDragged:function(e){this.rangeMove=!1,$("#luckysheet-formula-functionrange-highlight-"+this.rangeMoveIndex).data("range",this.rangeMoveRangedata).find(".luckysheet-selection-copy-hc").css("opacity",.03)},functionHTMLIndex:0,functionRangeIndex:null,findrangeindex:function(e,n){var t=/<span.*?>/g,a=e.replace(t,""),l=n.replace(t,"");a=a.split("</span>"),l=l.split("</span>"),a.pop(),l.pop();var o=this.functionRangeIndex,d=(l.length>a.length?a.length:l.length,l.length),s=a.length;if(d==s){var h=o[0],f=l[h],p=a[h];if(f==null)return l.length<=h?o=[l.length-1,l.length-1]:a.length<=h&&(o=[a.length-1,a.length-1]),o;if(f.length==p.length)return l[h+1]!=null&&a[h+1]!=null&&l[h+1].length<a[h+1].length&&(o[0]=o[0]+1,o[1]=1),o;if(f.length>p.length)return f!=null&&a[h+1]!=null&&a[h+1].substr(0,1)=='"'&&(f.indexOf("{")>-1||f.indexOf("}")>-1)&&(o[0]=o[0]+1,o[1]=1),o;if(f.length<p.length)return o[1]>p.length&&(o[1]=p.length),o}else{if(d>s){var g=o[0],v=l[g],y=a[g];if(y==null)if(a[g-1].indexOf("{")>-1){o[0]=o[0]-1;var b=a[g-1].search("{");o[1]=o[1]+b}else o[0]=0,o[1]=0;else{if(v.length==y.length)return a[g+1]==null||a[g+1].substr(0,1)!='"'&&a[g+1].substr(0,1)!="{"&&a[g+1].substr(0,1)!="}"?v!=null&&v.length>2&&v.substr(0,1)=='"'&&v.substr(v.length-1,1)=='"'||(a[g]!=null&&a[g]=='")'||a[g]!=null&&a[g]=='"}'||a[g]!=null&&a[g]=="{)"?o[1]=1:o[1]=y.length):(o[0]=o[0]+1,o[1]=1),o;if(v.length>y.length)return a[g+1]==null||a[g+1].substr(0,1)!='"'&&a[g+1].substr(0,1)!="{"&&a[g+1].substr(0,1)!="}"||(o[0]=o[0]+1,o[1]=1),o;if(v.length<y.length)return o}return o}if(d<s){var k=o[0],w=l[k],_=a[k];if(w==null)o[0]=a.length-1,o[1]=_!=null?_.length:1;else{if(w.length==_.length)return l[k+1]==null||l[k+1].substr(0,1)!='"'&&l[k+1].substr(0,1)!="{"&&l[k+1].substr(0,1)!="}"?a[k+1]==null||a[k+1].substr(0,1)!='"'||a[k+1].substr(0,1)!="{"&&a[k+1].substr(0,1)!="}"?_!=null&&_.substr(0,1)=='"'&&_.substr(_.length-1,1)=='"'&&w.substr(0,1)=='"'&&w.substr(w.length-1,1)==")"||_!=null&&_.substr(0,1)=="{"&&_.substr(_.length-1,1)=="}"&&w.substr(0,1)=="{"&&w.substr(w.length-1,1)==")"?o[1]=_.length:(o[0]=o[0]+s-d,a.length>l.length?o[1]=a[k+1].length:o[1]=1):(o[0]=o[0]+1,o[1]=1):o[1]=_.length,o;if(w.length>_.length)return w!=null&&w.substr(0,1)=='"'?o[1]=_.length:a[k+1]!=null&&/{.*?}/.test(a[k+1])?(o[0]=o[0]+1,o[1]=a[k+1].length):w!=null&&a[k+1].substr(0,1)=='"'&&(w.indexOf("{")>-1||w.indexOf("}")>-1)?(o[0]=o[0]+1,o[1]=1):w!=null&&(w.indexOf("{")>-1||w.indexOf("}")>-1)||(o[0]=o[0]+s-d-1,o[1]=a[k-1].length),o;if(w.length<_.length)return o}return o}}return null},setCaretPosition:function(e,n,t){try{var a=e,l=document.createRange(),o=window.getSelection();l.setStart(a.childNodes[n],t),l.collapse(!0),o.removeAllRanges(),o.addRange(l),a.focus()}catch{rs(this.rangeResizeTo[0])}},functionRange:function(e,n,t){if(window.getSelection){var a=window.getSelection(),l=this.findrangeindex(n,t);l==null?(a.selectAllChildren(e.get(0)),a.collapseToEnd()):this.setCaretPosition(e.find("span").get(l[0]),0,l[1])}else document.selection&&(this.functionRangeIndex.moveToElementText(e),this.functionRangeIndex.collapse(!1),this.functionRangeIndex.select())},functionInputHanddler:function(e,n,t){if(!Rt()){var a=this,l=e,o=n,d=o.html(),s=o.text();setTimeout(function(){var h=o.text();if(h.length>0&&h.substr(0,1)=="="&&(t!=229||h.length==1)){if(h=a.functionHTMLGenerate(h),d=a.functionHTMLGenerate(s),window.getSelection){var f=window.getSelection();if($(f.anchorNode).is("div")){var p=$("#luckysheet-rich-text-editor span").length;a.functionRangeIndex=[p-1,$("#luckysheet-rich-text-editor").find("span").eq(p-1).text().length]}else a.functionRangeIndex=[$(f.anchorNode).parent().index(),f.anchorOffset]}else{var g=document.selection.createRange();a.functionRangeIndex=g}o.html(h),a.functionRange(o,h,d),a.canceFunctionrangeSelected(),t!=46&&a.createRangeHightlight(),l.html(h),a.rangestart=!1,a.rangedrag_column_start=!1,a.rangedrag_row_start=!1,a.rangeHightlightselected(o,t)}else s.substr(0,1)!="="&&(l.attr("id")=="luckysheet-rich-text-editor"&&l.html().substr(0,5)=="<span"||l.html(h))},1)}},functionHTMLGenerate:function(e){return e.length==0||e.substr(0,1)!="="?e:(this.functionHTMLIndex=0,'<span dir="auto" class="luckysheet-formula-text-color">=</span>'+this.functionHTML(e))},functionHTML:function(e){if(this.operatorjson==null){for(var n=this.operator.split("|"),t={},a=0;a<n.length;a++)t[n[a].toString()]=1;this.operatorjson=t}e.substr(0,1)=="="&&(e=e.substr(1));for(var l=e.split(""),o=0,d="",s="",h={bracket:0,comma:0,squote:0,dquote:0,braces:0};o<l.length;){var f=l[o];if(f=="("&&h.squote==0&&h.dquote==0&&h.braces==0)h.bracket+=1,d.length>0?s+='<span dir="auto" class="luckysheet-formula-text-func">'+d+'</span><span dir="auto" class="luckysheet-formula-text-lpar">(</span>':s+='<span dir="auto" class="luckysheet-formula-text-lpar">(</span>',d="";else if(f==")"&&h.squote==0&&h.dquote==0&&h.braces==0)h.bracket-=1,s+=this.functionHTML(d)+'<span dir="auto" class="luckysheet-formula-text-rpar">)</span>',d="";else if(f=="{"&&h.squote==0&&h.dquote==0)d+="{",h.braces+=1;else if(f=="}"&&h.squote==0&&h.dquote==0)d+="}",h.braces-=1;else if(f=='"'&&h.squote==0)h.dquote>0?(d.length>0?s+=d+'"</span>':s+='"</span>',h.dquote-=1,d=""):(h.dquote+=1,d.length>0?s+=this.functionHTML(d)+'<span dir="auto" class="luckysheet-formula-text-string">"':s+='<span dir="auto" class="luckysheet-formula-text-string">"',d="");else if(f=="'"&&h.dquote==0)d+="'",h.squote=h.squote==0?1:0;else if(f==","&&h.squote==0&&h.dquote==0&&h.braces==0)s+=this.functionHTML(d)+'<span dir="auto" class="luckysheet-formula-text-comma">,</span>',d="";else if(f=="&"&&h.squote==0&&h.dquote==0&&h.braces==0)d.length>0?(s+=this.functionHTML(d)+'<span dir="auto" class="luckysheet-formula-text-calc">&</span>',d=""):s+='<span dir="auto" class="luckysheet-formula-text-calc">&</span>';else if(f in this.operatorjson&&h.squote==0&&h.dquote==0&&h.braces==0){var p="";o+1<l.length&&(p=l[o+1]);var g=o-1,v=null;if(g>=0)do v=l[g--];while(g>=0&&v==" ");f+p in this.operatorjson?(d.length>0?(s+=this.functionHTML(d)+'<span dir="auto" class="luckysheet-formula-text-calc">'+f+p+"</span>",d=""):s+='<span dir="auto" class="luckysheet-formula-text-calc">'+f+p+"</span>",o++):/[^0-9]/.test(p)||f!="-"||v!="("&&v!=null&&v!=","&&v!=" "&&!(v in this.operatorjson)?d.length>0?(s+=this.functionHTML(d)+'<span dir="auto" class="luckysheet-formula-text-calc">'+f+"</span>",d=""):s+='<span dir="auto" class="luckysheet-formula-text-calc">'+f+"</span>":d+=f}else d+=f;if(o==l.length-1){if(this.iscelldata($.trim(d)))s+='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+this.functionHTMLIndex+'" dir="auto" style="color:'+Di[this.functionHTMLIndex]+';">'+d+"</span>",this.functionHTMLIndex++;else if(h.dquote>0)s+=d+"</span>";else if(d.indexOf("</span>")==-1&&d.length>0){var y=/{.*?}/;if(y.test($.trim(d))){var b=y.exec(d)[0],k=d.search(y),w="";k>0&&(w+='<span dir="auto" class="luckysheet-formula-text-color">'+d.substr(0,k)+"</span>"),w+='<span dir="auto" style="color:#959a05" class="luckysheet-formula-text-array">'+b+"</span>",k+b.length<d.length&&(w+='<span dir="auto" class="luckysheet-formula-text-color">'+d.substr(k+b.length,d.length)+"</span>"),s+=w}else s+='<span dir="auto" class="luckysheet-formula-text-color">'+d+"</span>"}}o++}return s},getfunctionParam:function(e){if(this.operatorjson==null){for(var n=this.operator.split("|"),t={},a=0;a<n.length;a++)t[n[a].toString()]=1;this.operatorjson=t}e.substr(0,1)=="="&&(e=e.substr(1));for(var l=e.split(""),o=0,d="",s={bracket:0,comma:0,squote:0,dquote:0,compare:0},h=null,f=[],p=[];o<l.length;){var g=l[o];if(g=="("&&s.dquote==0)d.length>0&&p.length==0?(h=d.toUpperCase(),p.push(1),d=""):p.length==0?(p.push(0),d=""):(p.push(0),d+=g);else if(g==")"&&s.dquote==0)p.pop(),p.length==0?(f.push(d),d=""):d+=g;else if(g=='"')d+='"',s.dquote>0?(s.dquote-=1,d=""):s.dquote+=1;else if(g==","&&s.dquote==0)p.length<=1?(f.push(d),d=""):d+=",";else if(g in this.operatorjson&&s.dquote==0){var v="";o+1<l.length&&(v=l[o+1]);var y=o-1,b=null;if(y>=0)do b=l[y--];while(y>=0&&b==" ");/[^0-9]/.test(v)||g!="-"||b!="("&&b!=null&&b!=","&&b!=" "&&!(b in this.operatorjson)?d="":s.dquote==0?d+=$.trim(g):d+=g}else s.dquote==0?d+=$.trim(g):d+=g;o++}return{fn:h,param:f}},calPostfixExpression:function(e){if(e.length==0)return"";for(var n=[],t=e.length-1;t>=0;t--){var a=e[t];if(a in this.operatorjson){var l=n.pop(),o="luckysheet_compareWith("+n.pop()+",'"+a+"', "+l+")";n.push(o)}else n.push(a)}return n.length>0?n[0]:""},checkBracketNum:function(e){var n=e.match(/\(/g),t=e.match(/\)/g),a=e.match(/(['"])(?:(?!\1).)*?\1/g),l=e.match(/(['"])(?:(?!\1).)*?\1/g),o=0,d=0;n!=null&&(o+=n.length),t!=null&&(d+=t.length);var s=0,h=0;if(a!=null)for(var f=0;f<a.length;f++){var p=a[f].match(/\(/g);p!=null&&(s+=p.length)}if(l!=null)for(var g=0;g<l.length;g++){var v=l[g].match(/\)/g);v!=null&&(h+=v.length)}return(o-=s)==(d-=h)},operatorPriority:{"^":0,"%":1,"*":1,"/":1,"+":2,"-":2},functionParserExe:function(e){return this.functionParser(e)},functionParser:function(e,n){if(this.operatorjson==null){for(var t=this.operator.split("|"),a={},l=0;l<t.length;l++)a[t[l].toString()]=1;this.operatorjson=a}if(e==null)return"";e.substr(0,2)=="=+"?e=e.substr(2):e.substr(0,1)=="="&&(e=e.substr(1));for(var o=e.split(""),d=0,s="",h="",f={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},p=[],g=[],v=[],y=-1;d<o.length;){var b=o[d];if(b=="("&&f.squote==0&&f.dquote==0&&f.braces==0)if(s.length>0&&v.length==0){if((s=s.toUpperCase()).indexOf(":")>-1){var k=s.split(":");h+="luckysheet_getSpecialReference(true,'"+$.trim(k[0]).replace(/'/g,"\\'")+"', luckysheet_function."+k[1]+".f(#lucky#"}else h+="luckysheet_function."+s+".f(";v.push(1),s=""}else v.length==0?(h+="(",v.push(0),s=""):(v.push(0),s+=b);else if(b==")"&&f.squote==0&&f.dquote==0&&f.braces==0)if(v.pop(),v.length==0){var w=this.functionParser(s,n);w.indexOf("#lucky#")>-1&&(w=w.replace(/#lucky#/g,"")+")"),h+=w+")",s=""}else s+=b;else if(b=="{"&&f.squote==0&&f.dquote==0)s+="{",f.braces+=1;else if(b=="}"&&f.squote==0&&f.dquote==0)s+="}",f.braces-=1;else if(b=='"'&&f.squote==0)f.dquote>0?d<o.length-1&&o[d+1]=='"'?(d++,s+=""):(f.dquote-=1,s+='"'):(f.dquote+=1,s+='"');else if(b=="'"&&f.dquote==0)if(s+="'",f.squote>0){if(y==d-1)return"";if(d<o.length-1&&o[d+1]=="'")d++,s+="'";else{if(o[d-1]=="'")return"";f.squote-=1}}else f.squote+=1,y=d;else if(b==","&&f.squote==0&&f.dquote==0&&f.braces==0)if(v.length<=1){var _=this.functionParser(s,n);_.indexOf("#lucky#")>-1&&(_=_.replace(/#lucky#/g,"")+")"),h+=_+",",s=""}else s+=",";else if(b in this.operatorjson&&f.squote==0&&f.dquote==0&&f.braces==0){var C="",A=this.operatorPriority;if(d+1<o.length&&(C=o[d+1]),b+C in this.operatorjson){if(v.length==0){if($.trim(s).length>0?g.unshift(this.functionParser($.trim(s),n)):$.trim(h).length>0&&g.unshift($.trim(h)),p[0]in this.operatorjson)for(var I=A[p[0]];p.length>0&&I!=null;)g.unshift(p.shift()),I=A[p[0]];p.unshift(b+C),h="",s=""}else s+=b+C;d++}else if(v.length==0){if($.trim(s).length>0?g.unshift(this.functionParser($.trim(s),n)):$.trim(h).length>0&&g.unshift($.trim(h)),p[0]in this.operatorjson){var S=A[p[0]];S=S??1e3;var E=A[b];for(E=E??1e3;p.length>0&&E>=S;)g.unshift(p.shift()),S=(S=A[p[0]])==null?1e3:S}p.unshift(b),h="",s=""}else s+=b}else f.dquote==0&&f.squote,s+=b;if(d==o.length-1){var R="",F=$.trim(s).replace(/'/g,"\\'");if(this.iscelldata(F)&&F.substr(0,1)!=":")R="luckysheet_getcelldata('"+F+"')",typeof n=="function"&&n(F);else if(F.substr(0,1)==":")F=F.substr(1),this.iscelldata(F)&&(R="luckysheet_getSpecialReference(false,"+h+",'"+F+"')");else{s=$.trim(s);var N=/{.*?}/;if(N.test(s)&&s.substr(0,1)!='"'&&s.substr(s.length-1,1)!='"'){var z=N.exec(s)[0],P=s.search(N);P>0&&(R+=s.substr(0,P)),R+="luckysheet_getarraydata('"+z+"')",P+z.length<s.length&&(R+=s.substr(P+z.length,s.length))}else R=s}if(R.length>0&&g.unshift(R),p.length>0)for(h.length>0&&(g.unshift(h),h="");p.length>0;)g.unshift(p.shift());g.length>0?h=this.calPostfixExpression(g):h+=R}d++}return h},insertUpdateDynamicArray:function(e){var n=e.r,t=e.c,a=e.index;a==null&&(a=u.currentSheetIndex);var l=an()[je(a)].dynamicArray;l==null&&(l=[]);for(var o=0;o<l.length;o++){var d=l[o];if(d.r==n&&d.c==t&&d.index==a)return d.data=e.data,d.f=e.f,l}return l.push(e),l},addFunctionGroup:function(e,n,t,a){a==null&&(a=u.currentSheetIndex);var l=an(),o=l[je(a)];o.calcChain==null&&(o.calcChain=[]);var d={r:e,c:n,index:a,func:t};o.calcChain.push(d),nt.saveParam("fc",a,JSON.stringify(d),{op:"add",pos:o.calcChain.length-1}),oc(l)},getAllFunctionGroup:function(){for(var e=an(),n=[],t=0;t<e.length;t++){var a=e[t],l=a.calcChain;l&&function(){var h=[];l.forEach(function(f,p){typeof f=="string"?h.push(JSON.parse(f)):h.push(f)}),l=a.calcChain=h}();var o=a.dynamicArray_compute;l==null&&(l=[]),o==null&&(o=[]),n=n.concat(l);for(var d=0;d<o.length;d++){var s=o[0];n.push({r:s.r,c:s.c,index:s.index})}}return n},getFunctionGroup:function(e){e==null&&(e=u.currentSheetIndex);var n=an()[je(e)];return n.calcChain==null?[]:n.calcChain},updateFunctionGroup:function(e,n,t){t==null&&(t=u.currentSheetIndex);var a=an(),l=a[je(t)].calcChain;if(l!=null)for(var o=0;o<l.length;o++){var d=l[o];if(d.r==e&&d.c==n&&d.index==t){nt.saveParam("fc",t,JSON.stringify(d),{op:"update",pos:o});break}}oc(a)},insertUpdateFunctionGroup:function(e,n,t){t==null&&(t=u.currentSheetIndex);var a=an(),l=a[je(t)],o=l.calcChain;o==null&&(o=[]);for(var d=0;d<o.length;d++){var s=o[d];if(s.r==e&&s.c==n&&s.index==t)return void nt.saveParam("fc",t,JSON.stringify(s),{op:"update",pos:d})}var h={r:e,c:n,index:t};o.push(h),l.calcChain=o,nt.saveParam("fc",t,JSON.stringify(h),{op:"add",pos:l.calcChain.length-1}),oc(a)},isFunctionRangeSave:!1,isFunctionRangeSimple:function(e,n,t,a,l){if(e!=null&&e.length!=0){var o=e.split(/==|!=|<>|<=|>=|[,()=+-\/*%&^><]/g);if(o.length>0)for(var d=0;d<o.length;d++){var s=o[d];s.length<=1||s.substr(0,1)=='"'&&s.substr(s.length-1,1)=='"'||this.isFunctionRangeSaveChange(s,n,t,a,l)}}},isFunctionRangeSimple1:function(e,n,t,a,l){if(this.operatorjson==null){for(var o=this.operator.split("|"),d={},s=0;s<o.length;s++)d[o[s].toString()]=1;this.operatorjson=d}e.substr(0,1)=="="&&(e=e.substr(1));var h=e.split(""),f=0,p="",g="",v={bracket:0,comma:0,squote:0,dquote:0};for(an();f<h.length;){var y=h[f];if(y=="("&&v.dquote==0)v.bracket+=1,p.length>0?g+="luckysheet_function."+p.toUpperCase()+".f(":g+="(",p="";else if(y==")"&&v.dquote==0)v.bracket-=1,g+=this.isFunctionRangeSimple(p,n,t,a,l)+")",p="";else if(y==","&&v.dquote==0)g+=this.isFunctionRangeSimple(p,n,t,a,l)+",",p="";else if(y in this.operatorjson&&v.dquote==0){var b="";f+1<h.length&&(b=h[f+1]),y+b in this.operatorjson?(p.length>0?(g+=this.isFunctionRangeSimple(p,n,t,a,l)+y+b,p=""):g+=y+b,f++):p.length>0?(g+=this.isFunctionRangeSimple(p,n,t,a,l)+y,p=""):g+=y}else p+=y;f==h.length-1&&this.iscelldata($.trim(p))&&this.isFunctionRangeSaveChange(p,n,t,a,l),f++}return g},isFunctionRangeSelect:function(e,n,t,a,l){if(e!=null&&e!=""){a==null&&(a=u.currentSheetIndex),l==null&&(l={});var o=this,d=e.toUpperCase(),s=d.indexOf("INDIRECT(")>-1||d.indexOf("OFFSET(")>-1||d.indexOf("INDEX(")>-1;if(e in this.formulaContainCellList){var h=this.formulaContainCellList[e];if(s)if(h.__LuckyisOff__==1)for(var f in h)f!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(f,n,t,a,l);else this.isFunctionRange(e,n,t,a,l,function(g){o.addToCellList(e,g)}),h.__LuckyisOff__=!0;else for(var p in h)p!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(p,n,t,a,l)}else s?this.isFunctionRange(e,n,t,a,l):this.isFunctionRangeSimple(e,n,t,a,l)}},isFunctionRange:function(e,n,t,a,l,o){if(this.operatorjson==null){for(var d=this.operator.split("|"),s={},h=0;h<d.length;h++)s[d[h].toString()]=1;this.operatorjson=s}e.substr(0,1)=="="&&(e=e.substr(1));for(var f=e.split(""),p=0,g="",v="",y={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},b=[],k=[],w=[];p<f.length;){var _=f[p];if(_=="("&&y.squote==0&&y.dquote==0&&y.braces==0)if(g.length>0&&w.length==0){if((g=g.toUpperCase()).indexOf(":")>-1){var C=g.split(":");v+="luckysheet_getSpecialReference(true,'"+$.trim(C[0]).replace(/'/g,"\\'")+"', luckysheet_function."+C[1]+".f(#lucky#"}else v+="luckysheet_function."+g+".f(";w.push(1),g=""}else w.length==0?(v+="(",w.push(0),g=""):(w.push(0),g+=_);else if(_==")"&&y.squote==0&&y.dquote==0&&y.braces==0)if(w.pop(),w.length==0){var A=this.isFunctionRange(g,n,t,a,l,o);A.indexOf("#lucky#")>-1&&(A=A.replace(/#lucky#/g,"")+")"),v+=A+")",g=""}else g+=_;else if(_=="{"&&y.squote==0&&y.dquote==0)g+="{",y.braces+=1;else if(_=="}"&&y.squote==0&&y.dquote==0)g+="}",y.braces-=1;else if(_=='"'&&y.squote==0)y.dquote>0?p<f.length-1&&f[p+1]=='"'?(p++,g+=""):(y.dquote-=1,g+='"'):(y.dquote+=1,g+='"');else if(_=="'"&&y.dquote==0)g+="'",y.squote>0?p<f.length-1&&f[p+1]=="'"?(p++,g+="'"):y.squote-=1:y.squote+=1;else if(_==","&&y.squote==0&&y.dquote==0&&y.braces==0)if(w.length<=1){var I=this.isFunctionRange(g,n,t,a,l,o);I.indexOf("#lucky#")>-1&&(I=I.replace(/#lucky#/g,"")+")"),v+=I+",",g=""}else g+=",";else if(_ in this.operatorjson&&y.squote==0&&y.dquote==0&&y.braces==0){var S="",E=this.operatorPriority;if(p+1<f.length&&(S=f[p+1]),_+S in this.operatorjson){if(w.length==0){if($.trim(g).length>0?k.unshift(this.isFunctionRange($.trim(g),n,t,a,l,o)):$.trim(v).length>0&&k.unshift($.trim(v)),b[0]in this.operatorjson)for(var R=E[b[0]];b.length>0&&R!=null;)k.unshift(b.shift()),R=E[b[0]];b.unshift(_+S),v="",g=""}else g+=_+S;p++}else if(w.length==0){if($.trim(g).length>0?k.unshift(this.isFunctionRange($.trim(g),n,t,a,l,o)):$.trim(v).length>0&&k.unshift($.trim(v)),b[0]in this.operatorjson){var F=E[b[0]];F=F??1e3;var N=E[_];for(N=N??1e3;b.length>0&&N>=F;)k.unshift(b.shift()),F=(F=E[b[0]])==null?1e3:F}b.unshift(_),v="",g=""}else g+=_}else y.dquote==0&&y.squote==0?g+=$.trim(_):g+=_;if(p==f.length-1){var z="",P=$.trim(g).replace(/'/g,"\\'");if(this.iscelldata(P)&&P.substr(0,1)!=":")z="luckysheet_getcelldata('"+P+"')",this.isFunctionRangeSaveChange(g,n,t,a,l);else if(P.substr(0,1)==":")P=P.substr(1),this.iscelldata(P)&&(z="luckysheet_getSpecialReference(false,"+v+",'"+P+"')");else{g=$.trim(g);var q=/{.*?}/;if(q.test(g)&&g.substr(0,1)!='"'&&g.substr(g.length-1,1)!='"'){var V=q.exec(g)[0],x=g.search(q);x>0&&(z+=g.substr(0,x)),z+="luckysheet_getarraydata('"+V+"')",x+V.length<g.length&&(z+=g.substr(x+V.length,g.length))}else z=g}if(z.length>0&&k.unshift(z),b.length>0)for(v.length>0&&(k.unshift(v),v="");b.length>0;)k.unshift(b.shift());k.length>0?v=this.calPostfixExpression(k):v+=z}p++}return this.checkSpecialFunctionRange(v,n,t,a,l,o),v},isFunctionRangeSaveChange:function(e,n,t,a,l){if(n!=null&&t!=null){var o=this.getcellrange($.trim(e),a);if(o==null)return;var d=o.row,s=o.column,h=o.sheetIndex;if(!(n+"_"+t in l)||a!=h&&a!=null)n>=d[0]&&n<=d[1]&&t>=s[0]&&t<=s[1]&&(a==h||a==null)?this.isFunctionRangeSave=this.isFunctionRangeSave||!0:this.isFunctionRangeSave=this.isFunctionRangeSave||!1;else{for(var f=!1,p=d[0];p<=d[1];p++)for(var g=s[0];g<=s[1];g++)p+"_"+g in l&&l[p+"_"+g].r==n&&l[p+"_"+g].c==t&&(f=!0);this.isFunctionRangeSave=f?this.isFunctionRangeSave||!0:this.isFunctionRangeSave||!1}}else this.isFunctionRangeSave=this.isFunctionRangeSave||!1},checkSpecialFunctionRange:function(e,n,t,a,l,o){if(e.substr(0,30)=="luckysheet_getSpecialReference"||e.substr(0,20)=="luckysheet_function."){if(e.substr(0,20)=="luckysheet_function."){var d=e.split(".")[1];if(d!=null&&(d=d.toUpperCase())!="INDIRECT"&&d!="OFFSET"&&d!="INDEX")return}try{u.calculateSheetIndex=a;var s=new Function("return "+e)();s instanceof Object&&s.startCell!=null&&(s=s.startCell);var h=$.trim(s);this.iscelldata(h)&&typeof o=="function"&&o(h)}catch{}}},execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},addToCellList:function(e,n){e!=null&&e.length!=0&&n!=null&&n.length!=0&&(this.formulaContainCellList==null&&(this.formulaContainCellList={}),this.formulaContainCellList[e]==null&&(this.formulaContainCellList[e]={}),this.formulaContainCellList[e][n]=1)},addToCellIndexList:function(e,n){e!=null&&e.length!=0&&n!=null&&(this.cellTextToIndexList==null&&(this.cellTextToIndexList={}),e.indexOf("!")>-1?(e=e.replace(/\\'/g,"'").replace(/''/g,"'"),this.cellTextToIndexList[e]=n):this.cellTextToIndexList[e+"_"+n.sheetIndex]=n)},addToSheetIndexList:function(e,n,t){e!=null&&e.length!=0&&(n!=null&&n.length!=0||(n=u.currentSheetIndex),t!=null&&t.length!=0||(t=""),this.formulaContainSheetList==null&&(this.formulaContainSheetList={}),this.formulaContainSheetList[e]==null&&(this.formulaContainSheetList[e]={}),this.formulaContainSheetList[e][n]=t)},execFunctionGlobalData:{},execFunctionGroupForce:function(e){e?this.execFunctionGroup(void 0,void 0,void 0,void 0,void 0,!0):this.execFunctionGroup()},execFunctionGroup:function(e,n,t,a,l){var o=this,d=arguments.length>5&&arguments[5]!==void 0&&arguments[5],s=this;if(l==null&&(l=u.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=Ac,window.luckysheet_getarraydata=fg,window.luckysheet_getcelldata=no,window.luckysheet_parseData=fd,window.luckysheet_getValue=Bs,window.luckysheet_indirect_check=pg,window.luckysheet_indirect_check_return=gg,window.luckysheet_offset_check=vg,window.luckysheet_calcADPMM=Xa,window.luckysheet_getSpecialReference=yg),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={}),a==null&&(a=u.currentSheetIndex),t!=null){var h=[[{v:null}]];Ln(0,0,h,t),s.execFunctionGlobalData[e+"_"+n+"_"+a]=h[0][0]}for(var f=s.getAllFunctionGroup(),p={},g=an(),v={},y=0;y<g.length;y++){var b=g[y];v[b.index]=b.data}var k={},w=[];if(s.execFunctionExist==null){var _="r"+e+"c"+n+"i"+a;k[_]=1}else for(var C=0;C<s.execFunctionExist.length;C++){var A=s.execFunctionExist[C],I="r"+A.r+"c"+A.c+"i"+A.i;k[I]=1}for(var S={},E=function(ae,de,ve,U){for(var B=0;B<ae.length;B++){var le=ae[B],Te="r"+le.row[0]+le.row[1]+"c"+le.column[0]+le.column[1]+"index"+le.sheetIndex;if(Te in S)S[Te].forEach(function(Re){U(Re.key,Re.r,Re.c,Re.sheetIndex)});else{for(var ue=[],be=le.row[0];be<=le.row[1];be++)for(var ye=le.column[0];ye<=le.column[1];ye++){var ce="r"+be+"c"+ye+"i"+le.sheetIndex;U(ce,be,ye,le.sheetIndex),(de&&ce in de||ve&&ce in ve)&&ue.push({key:ce,r:be,c:ye,sheetIndex:le.sheetIndex})}(de||ve)&&(S[Te]=ue)}}},R=function(ae){var de=f[ae],ve="r"+de.r+"c"+de.c+"i"+de.index,U=pi(de.r,de.c,de.index);if(U==null)return"continue";var B=U.toUpperCase(),le=B.indexOf("INDIRECT(")>-1||B.indexOf("OFFSET(")>-1||B.indexOf("INDEX(")>-1,Te=[];if(le)o.isFunctionRange(U,null,null,de.index,null,function(mt){var St=s.getcellrange($.trim(mt),de.index);St!=null&&Te.push(St)});else if(U.substr(0,2)!='="'||U.substr(U.length-1,1)!='"'){for(var ue=0,be=-1,ye=-1,ce=[],Re=[],pe=U.length,me=0;me<pe;me++){var re=U.charAt(me);re=="'"&&ye==-1&&(be==-1?(ue!=me&&ce.push.apply(ce,Ei(U.substring(ue,me).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/))),be=me,ue=me):me<pe-1&&U.charAt(me+1)=="'"?me++:(ue=me+1,ce.push(U.substring(be,ue)),Re.push(ce.length-1),be=-1)),re=='"'&&be==-1&&(ye==-1?(ue!=me&&ce.push.apply(ce,Ei(U.substring(ue,me).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/))),ye=me,ue=me):me<pe-1&&U.charAt(me+1)=='"'?me++:(ue=me+1,ce.push(U.substring(ye,ue)),ye=-1))}ue!=pe&&ce.push.apply(ce,Ei(U.substring(ue,pe).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)));for(var _e=Re.length-1;_e>=0;_e--)Re[_e]!=ce.length-1&&(ce[Re[_e]]=ce[Re[_e]]+ce[Re[_e]+1],ce.splice(Re[_e]+1,1));for(var Ze=0;Ze<ce.length;Ze++){var We=ce[Ze];if(!(We.length<=1)&&(We.substr(0,1)!='"'||We.substr(We.length-1,1)!='"'||s.iscelldata(We))){var Xe=s.getcellrange($.trim(We),de.index);Xe!=null&&Te.push(Xe)}}}var Ue={formulaArray:Te,calc_funcStr:U,key:ve,r:de.r,c:de.c,index:de.index,parents:{},chidren:{},color:"w"};p[ve]=Ue},F=0;F<f.length;F++)R(F);Object.keys(p).forEach(function(ae){var de=p[ae];E(de.formulaArray,p,k,function(ve){if(ve in p){var U=p[ve];de.chidren[ve]=1,U.parents[ae]=1}!d&&ve in k&&w.push(de)}),d&&w.push(de)});for(var N=[],z=w,P={},q=function(){var ae=z.pop();if(ae==null||ae.key in P)return"continue";if(ae.color=="b")return N.push(ae),P[ae.key]=1,"continue";var de=[];Object.keys(ae.parents).forEach(function(ve){var U=p[ve];U!=null&&de.push(U)}),de.length==0?(N.push(ae),P[ae.key]=1):(ae.color="b",z.push(ae),z=z.concat(de))};z.length>0;)q();N.reverse();for(var V=0;V<N.length;V++){var x=N[V];if(x.level!=Math.max){window.luckysheet_getcelldata_cache=null;var ee=x.calc_funcStr,ne=s.execfunction(ee,x.r,x.c,x.index);s.groupValuesRefreshData.push({r:x.r,c:x.c,v:ne[1],f:ne[2],spe:ne[3],index:x.index}),s.execFunctionGlobalData[x.r+"_"+x.c+"_"+x.index]={v:ne[1],f:ne[2]}}}s.execFunctionExist=null},execFunctionGroup1:function(e,n,t,a,l){var o=arguments.length>5&&arguments[5]!==void 0&&arguments[5],d=this;l==null&&(l=u.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=Ac,window.luckysheet_getarraydata=fg,window.luckysheet_getcelldata=no,window.luckysheet_parseData=fd,window.luckysheet_getValue=Bs,window.luckysheet_indirect_check=pg,window.luckysheet_indirect_check_return=gg,window.luckysheet_offset_check=vg,window.luckysheet_calcADPMM=Xa,window.luckysheet_getSpecialReference=yg),d.execFunctionGlobalData==null&&(d.execFunctionGlobalData={});var s=an(),h=s[je(u.currentSheetIndex)].dynamicArray_compute==null?{}:s[je(u.currentSheetIndex)].dynamicArray_compute;if(a==null&&(a=u.currentSheetIndex),t!=null){var f=[[{v:null}]];Ln(0,0,f,t),d.execFunctionGlobalData[e+"_"+n+"_"+a]=f[0][0]}var p=d.getAllFunctionGroup(),g={},v=[],y=0;if(d.execvertex={},d.execFunctionExist==null)for(var b=0;b<p.length;b++){var k=p[b],w=s[je(k.index)];if(w!=null){var _=w.data[k.r][k.c],C=pi(k.r,k.c,k.index);_!=null&&_.f!=null&&_.f==C&&(k instanceof Object||(k=new Function("return "+k)()),k.color="w",k.parent=null,k.chidren={},k.times=0,g["r"+k.r+"c"+k.c+"i"+k.index]=k,d.isFunctionRangeSave=!1,o?d.isFunctionRangeSave=!0:e!=null&&n!=null&&d.isFunctionRangeSelect(C,e,n,a,h),d.isFunctionRangeSave&&(v.push(k),d.execvertex["r"+k.r+"c"+k.c+"i"+k.index]=k,y++))}}else for(var A=0;A<d.execFunctionExist.length;A++){var I=d.execFunctionExist[A];if(!("r"+I.r+"c"+I.c+"i"+I.i in g))for(var S=0;S<p.length;S++){var E=p[S],R=pi(E.r,E.c,E.index);E.color="w",E.parent=null,E.chidren={},E.times=0,g["r"+E.r+"c"+E.c+"i"+E.index]=E,d.isFunctionRangeSave=!1,o?d.isFunctionRangeSave=!0:d.isFunctionRangeSelect(R,I.r,I.c,I.i,h),d.isFunctionRangeSave&&(v.push(E),d.execvertex["r"+E.r+"c"+E.c+"i"+E.index]=E,y++)}}for(;v.length>0;){var F=v.shift(),N={};for(var z in d.getChildrenVertex(F,g,N),g){var P=g[z];if(P!=null){var q="r"+F.r+"c"+F.c+"i"+F.index;if(!(z in N)){d.isFunctionRangeSave=!1;var V=pi(P.r,P.c,P.index);d.isFunctionRangeSelect(V,F.r,F.c,F.index,h),d.isFunctionRangeSave&&(z in d.execvertex||(v.push(P),d.execvertex[z]=P),y++,d.execvertex[z].chidren[q]=1)}}}}d.groupValuesRefreshData=[];for(var x=0;x<y;)for(var ee in d.execvertex){var ne=d.execvertex[ee];ne.color=="w"?d.functionDFS(ne):ne.color=="b"&&x++}d.execFunctionExist=null},getChildrenVertex:function(e,n,t){if(t["r"+e.r+"c"+e.c+"i"+e.index]=1,e.chidren!=null)for(var a in e.chidren)n[a]&&!(a in t)&&this.getChildrenVertex(n[a],n,t)},functionDFS:function(e){for(var n in e.color="g",e.times+=1,e.chidren){var t=this.execvertex[n];t.color=="w"&&(t.parent="r"+e.r.toString()+"c"+e.c.toString()+"i"+e.index,this.functionDFS(t))}e.color="b",window.luckysheet_getcelldata_cache=null;var a=pi(e.r,e.c,e.index),l=this.execfunction(a,e.r,e.c,e.index);this.groupValuesRefreshData.push({r:e.r,c:e.c,v:l[1],f:l[2],spe:l[3],index:e.index}),this.execFunctionGlobalData[e.r+"_"+e.c+"_"+e.index]={v:l[1],f:l[2]}},groupValuesRefreshData:[],groupValuesRefresh:function(){var e=an();if(this.groupValuesRefreshData.length>0){for(var n=0;n<this.groupValuesRefreshData.length;n++){var t=this.groupValuesRefreshData[n],a=e[je(t.index)],l=a.data;if(l!=null){var o={};t.spe!=null&&(t.spe.type=="sparklines"?o.spl=t.spe.data:t.spe.type=="dynamicArrayItem"&&(a.dynamicArray=this.insertUpdateDynamicArray(t.spe.data))),o.v=t.v,o.f=t.f,Ln(t.r,t.c,l,o),nt.saveParam("v",t.index,t.v,{r:t.r,c:t.c})}}vr.webWorkerFlowDataCache(u.flowdata),this.groupValuesRefreshData=[]}},delFunctionGroup:function(e,n,t){t==null&&(t=u.currentSheetIndex);var a=an(),l=a[je(t)],o=l.calcChain;if(o!=null)for(var d=0;d<o.length;d++){var s=o[d];if(s.r==e&&s.c==n&&s.index==t){o.splice(d,1),nt.saveParam("fc",t,null,{op:"del",pos:d});break}}var h=l.dynamicArray;if(h!=null)for(var f=0;f<h.length;f++){var p=h[f];if(p.r==e&&p.c==n&&(p.index==null||p.index==t)){h.splice(f,1),nt.saveParam("ac",t,null,{op:"del",pos:f});break}}oc(a)},execfunction:function(e,n,t,a,l,o){var d=st().formulaMore;if(e.indexOf(this.error.r)>-1)return[!1,this.error.r,e];this.checkBracketNum(e)||(e+=")"),a==null&&(a=u.currentSheetIndex),u.calculateSheetIndex=a;var s=$.trim(this.functionParserExe(e));if(s.substr(0,20)!="luckysheet_function."&&s.substr(0,22)!="luckysheet_compareWith"||(this.functionHTMLIndex=0),!this.testFunction(e,s)||s=="")return Ee.info("",d.execfunctionError),[!1,this.error.n,e];var h=null;window.luckysheetCurrentRow=n,window.luckysheetCurrentColumn=t,window.luckysheetCurrentIndex=a,window.luckysheetCurrentFunction=e;var f=null;try{if(s.indexOf("luckysheet_getcelldata")>-1)for(var p=s.split("luckysheet_getcelldata('"),g=1;g<p.length;g++){var v=p[g].split("')")[0],y=this.getcellrange(v);if(y.row[0]<0||y.column[0]<0)return[!0,this.error.r,e];if(y.sheetIndex==u.calculateSheetIndex&&n>=y.row[0]&&n<=y.row[1]&&t>=y.column[0]&&t<=y.column[1])return Rt()?alert(d.execfunctionSelfError):Ee.info("",d.execfunctionSelfErrorResult),[!1,0,e]}typeof(h=new Function("return "+s)())=="string"&&(h=h.replace(/\x7F/g,'"')),s.indexOf("SPLINES")>-1&&(f=h,h="")}catch(_){var b=_;console.log(_,s),b=this.errorInfo(b),h=[this.error.n,b]}D(h)=="object"&&h.startCell!=null&&(h=D(h.data)=="array"?this.error.v:D(h.data)!="object"||$t(h.data.v)?$t(h.data)?0:h.cell>1||h.rowl>1?h.data:0:h.data.v);var k=null;if(D(h)=="array"){var w=!1;D(h[0])!="array"&&h.length==2&&(w=j(h[0])),w?h=h[0]:D(h[0])=="array"&&h.length==1&&h[0].length==1?h=h[0][0]:(k={r:n,c:t,f:e,index:a,data:h},h="")}return window.luckysheetCurrentRow=null,window.luckysheetCurrentColumn=null,window.luckysheetCurrentIndex=null,window.luckysheetCurrentFunction=null,n!=null&&t!=null&&(l&&this.execFunctionGroup(n,t,h,a),o||this.insertUpdateFunctionGroup(n,t,a)),f?[!0,h,e,{type:"sparklines",data:f}]:k?[!0,h,e,{type:"dynamicArrayItem",data:k}]:[!0,h,e]},testFunction:function(e,n){return e.substr(0,1)=="="},execstringformula:function(e,n,t,a){return this.execfunction(e,n,t,a)},functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0};function Ra(){if($("#luckysheet-cell-selected-boxs").show(),$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").siblings(".luckysheet-cell-selected").remove(),u.luckysheet_select_save.length>0){for(var e=0;e<u.luckysheet_select_save.length;e++){var n=u.luckysheet_select_save[e].row[0],t=u.luckysheet_select_save[e].row[1],a=u.luckysheet_select_save[e].column[0],l=u.luckysheet_select_save[e].column[1],o=void 0,d=void 0;o=u.luckysheet_select_save[e].row_focus==null?n:u.luckysheet_select_save[e].row_focus,d=u.luckysheet_select_save[e].column_focus==null?a:u.luckysheet_select_save[e].column_focus;var s=u.visibledatarow[t],h=n-1==-1?0:u.visibledatarow[n-1],f=u.visibledatacolumn[l],p=a-1==-1?0:u.visibledatacolumn[a-1],g=u.visibledatarow[o],v=o-1==-1?0:u.visibledatarow[o-1],y=u.visibledatacolumn[d],b=d-1==-1?0:u.visibledatacolumn[d-1],k=dr.mergeborer(u.flowdata,o,d);k&&(g=k.row[1],v=k.row[0],y=k.column[1],b=k.column[0]),u.luckysheet_select_save[e].row=[n,t],u.luckysheet_select_save[e].column=[a,l],u.luckysheet_select_save[e].row_focus=o,u.luckysheet_select_save[e].column_focus=d,u.luckysheet_select_save[e].left=b,u.luckysheet_select_save[e].width=y-b-1,u.luckysheet_select_save[e].top=v,u.luckysheet_select_save[e].height=g-v-1,u.luckysheet_select_save[e].left_move=p,u.luckysheet_select_save[e].width_move=f-p-1,u.luckysheet_select_save[e].top_move=h,u.luckysheet_select_save[e].height_move=s-h-1,e==0?u.luckysheet_select_save.length==1?Ko.mobilecheck()?$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:u.luckysheet_select_save[e].left_move,width:u.luckysheet_select_save[e].width_move,top:u.luckysheet_select_save[e].top_move,height:u.luckysheet_select_save[e].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","none").end().find(".luckysheet-cs-touchhandle").css("display","block"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:u.luckysheet_select_save[e].left_move,width:u.luckysheet_select_save[e].width_move,top:u.luckysheet_select_save[e].top_move,height:u.luckysheet_select_save[e].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","block").end().find(".luckysheet-cs-touchhandle").css("display","none"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:u.luckysheet_select_save[e].left_move,width:u.luckysheet_select_save[e].width_move,top:u.luckysheet_select_save[e].top_move,height:u.luckysheet_select_save[e].height_move,display:"block",border:"1px solid rgba(1, 136, 251, 0.15)"}).find(".luckysheet-cs-draghandle").css("display","none").end().find(".luckysheet-cs-fillhandle").css("display","none"):$("#luckysheet-cell-selected-boxs").append('<div class="luckysheet-cell-selected" style="left: '+u.luckysheet_select_save[e].left_move+"px; width: "+u.luckysheet_select_save[e].width_move+"px; top: "+u.luckysheet_select_save[e].top_move+"px; height: "+u.luckysheet_select_save[e].height_move+'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;"></div>'),e==u.luckysheet_select_save.length-1&&($("#luckysheet-cell-selected-focus").css({left:u.luckysheet_select_save[e].left,width:u.luckysheet_select_save[e].width,top:u.luckysheet_select_save[e].top,height:u.luckysheet_select_save[e].height,display:"block"}),lo(u.luckysheet_select_save[e].left_move,u.luckysheet_select_save[e].top_move,u.luckysheet_select_save[e].width_move,u.luckysheet_select_save[e].height_move,[n,t],[a,l]),m.fucntionboxshow(o,d),aa.cellFocus(o,d))}(function(_){for(var C=$.extend(!0,[],_),A={},I={},S=0;S<C.length;S++){var E=C[S].row[0],R=C[S].row[1],F=C[S].column[0],N=C[S].column[1];A=$g(A,E,R),I=$g(I,F,N)}$("#luckysheet-rows-h-selected").empty();for(var z=Dg(A),P=0;P<z.length;P++){var q=z[P][0],V=ol(z[P][z[P].length-1])[1],x=ol(q)[0];$("#luckysheet-rows-h-selected").append('<div class="luckysheet-rows-h-selected" style="top: '+x+"px; height: "+(V-x-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}$("#luckysheet-cols-h-selected").empty();for(var ee=Dg(I),ne=0;ne<ee.length;ne++){var ae=ee[ne][0],de=En(ee[ne][ee[ne].length-1])[1],ve=En(ae)[0];$("#luckysheet-cols-h-selected").append('<div class="luckysheet-cols-h-selected" style="left: '+ve+"px; width: "+(de-ve-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}})(u.luckysheet_select_save),lm(),u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]&&function(_,C){var A=u.luckysheetfile[je(u.currentSheetIndex)].dynamicArray==null?[]:u.luckysheetfile[je(u.currentSheetIndex)].dynamicArray,I=Sh(A);if(_+"_"+C in I&&I[_+"_"+C].v!="#SPILL!"){for(var S,E,R=I[_+"_"+C].r,F=I[_+"_"+C].c,N=u.flowdata[R][F].f,z=0;z<A.length;z++)A[z].f==N&&(S=A[z].data.length,E=D(A[z].data[0])=="array"?A[z].data[0].length:1);var P=R+S-1,q=F+E-1,V=u.visibledatarow[P],x=R-1==-1?0:u.visibledatarow[R-1],ee=u.visibledatacolumn[q],ne=F-1==-1?0:u.visibledatacolumn[F-1];$("#luckysheet-dynamicArray-hightShow").css({left:ne,width:ee-ne-1,top:x,height:V-x-1,display:"block"})}else $("#luckysheet-dynamicArray-hightShow").hide()}(u.luckysheet_select_save[0].row[0],u.luckysheet_select_save[0].column[0])}u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_select_save=u.luckysheet_select_save;var w=JSON.stringify(u.luckysheet_select_save);u.luckysheet_select_save_previous==null|u.luckysheet_select_save_previous!==w&&Ya.createHookFunction("rangeSelect",u.luckysheetfile[je(u.currentSheetIndex)],u.luckysheet_select_save),u.luckysheet_select_save_previous=w}function $g(e,n,t){for(var a=$.extend(!0,{},e),l=n;l<=t;l++)l in a||(a[l]=0);return a}function Dg(e){var n=[];for(var t in e)n.push(t);n.sort(function(d,s){return d-s});var a=[],l=[];if(n.length>1)for(var o=1;o<n.length;o++)n[o]-n[o-1]==1?(l.push(n[o-1]),o==n.length-1&&(l.push(n[o]),a.push(l))):o==1?o==n.length-1?(l.push(n[o-1]),a.push(l),a.push([n[o]])):a.push(n[0]):o==n.length-1?(l.push(n[o-1]),a.push(l),a.push([n[o]])):(l.push(n[o-1]),a.push(l),l=[]);else a.push([n[0]]);return a}function Vs(e){e==null&&(e=u.luckysheet_select_save);for(var n=!1,t={},a=0;a<e.length;a++)for(var l=e[a].row[0],o=e[a].row[1],d=e[a].column[0],s=e[a].column[1],h=l;h<=o;h++)for(var f=d;f<=s;f++){if(h+"_"+f in t){n=!0;break}t[h+"_"+f]=0}return n}function Sc(){var e=u.visibledatacolumn,n=u.visibledatarow;u.cooperativeEdit.changeCollaborationSize.forEach(function(t){if(t.i==u.currentSheetIndex){var a=t.v.column,l=e[a[0]]-1;t.v.column[0]!==0&&(l=e[a[1]]-e[a[0]-1]-(a[1]-a[0]+1));var o=t.v.row,d=n[o[0]]-1;t.v.row[0]!==0&&(d=n[o[1]]-n[o[0]-1]-(o[1]-o[0]+1));var s=u.cooperativeEdit.merge_range,h=e[t.v.column[0]-1]-1,f=n[t.v.row[0]-1]-1;if(u.config.columnlen!==null){for(var p in u.config.columnlen)if(t.v.column[0]<=p&&p<=t.v.column[1]){u.luckysheet_cols_change_size_start[1]=p-0;break}}if(u.config.rowlen!==null){for(var g in u.config.rowlen)if(t.v.row[0]<=g&&g<=t.v.row[1]){u.luckysheet_rows_change_size_start[1]=g-0;break}}if(t.v.column[0]<=u.luckysheet_cols_change_size_start[1]&&u.luckysheet_cols_change_size_start[1]<=t.v.column[1])if(u.luckysheet_cols_change_size_start[1]==0)l=e[0]-1;else{var v=t.v.column;l=e[v[1]]-e[v[0]-1]-(v[1]-v[0]+1)}if(t.v.row[0]<=u.luckysheet_rows_change_size_start[1]&&u.luckysheet_rows_change_size_start[1]<=t.v.row[1])if(u.luckysheet_rows_change_size_start[1]==0)d=n[0]-1;else{var y=t.v.row;d=n[y[1]]-n[y[0]-1]-(y[1]-y[0]+1)}if(Object.keys(s).length>0){var b=!1;if(s.v.length>1&&(b=Object.keys(s.v[1][0]).length>0),s.v[0].length>1&&(b=Object.keys(s.v[0][1]).length>0),b){var k=s.column[0]<=t.v.column[0]&&s.column[1]>=t.v.column[1];if(h=e[s.column[0]-1]-1,f=n[s.row[0]-1]-1,l=e[s.column[1]]-1,d=n[s.row[1]]-1,k){if(s.column[0]!==0){var w=s.column;l=e[w[1]]-e[w[0]-1]-(w[1]-w[0]+1)}else h=0;t.v.column=s.column}if(s.row[0]<=t.v.row[0]&&s.row[1]>=t.v.row[1]){if(s.row[0]!==0){var _=s.row;d=n[_[1]]-n[_[0]-1]-(_[1]-_[0]+1)}else f=0;t.v.row=s.row}}else l=e[a[0]]-e[a[0]-1]-1,a[0]===0&&(l=e[a[0]]-1),d=n[o[0]]-n[o[0]-1]-1,o[0]===0&&(d=n[o[0]]-1)}$("#luckysheet-multipleRange-show-"+t.id).css({height:d,width:l,top:f+"px",left:h+"px"});var C=$("#luckysheet-multipleRange-show-"+t.id)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+t.id+">.username").css({bottom:C+"px"})}})}function pn(e){if($("#luckysheet-selection-copy").empty(),e==null&&(e=u.luckysheet_selection_range),e.length>0)for(var n=0;n<e.length;n++){var t=e[n].row[0],a=e[n].row[1],l=e[n].column[0],o=e[n].column[1],d=u.visibledatarow[a],s=t-1==-1?0:u.visibledatarow[t-1],h=u.visibledatacolumn[o],f=l-1==-1?0:u.visibledatacolumn[l-1],p='<div class="luckysheet-selection-copy" style="display: block; left: '+f+"px; width: "+(h-f-1)+"px; top: "+s+"px; height: "+(d-s-1)+'px;"><div class="luckysheet-selection-copy-top luckysheet-copy"></div><div class="luckysheet-selection-copy-right luckysheet-copy"></div><div class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div></div>';$("#luckysheet-selection-copy").append(p)}}function lo(e,n,t,a,l,o){var d=l[1]-l[0]+1,s=o[1]-o[0]+1,h=u.luckysheetTableContentHW[0],f=u.luckysheetTableContentHW[1],p=$("#luckysheet-cell-main").scrollLeft(),g=$("#luckysheet-cell-main").scrollTop(),v=st().info;if(d>=4){var y=e-25;y<0&&(y=e+5),y<p&&(y=p+10);var b=n+a/2;a>f&&(b=g+f/2),$("#luckysheet-row-count-show").css({left:y,top:b,display:"block",width:"11px"}).html("<div>"+d.toString().split("").join("</div><div>")+"</div><div>"+v.row+"</div>")}else $("#luckysheet-row-count-show").hide();if(s>=4){var k=n-25;k<0&&(k=n+5),k<g&&(k=g+10);var w=e+t/2;t>h&&(w=p+h/2),$("#luckysheet-column-count-show").css({left:w,top:k,display:"block"}).text(s+v.column)}else $("#luckysheet-column-count-show").hide()}function lm(){var e=u.luckysheet_select_save[u.luckysheet_select_save.length-1],n=e.row_focus,t=e.column_focus;u.config.merge!=null&&n+"_"+t in u.config.merge?$("#luckysheet-helpbox-cell").text(wn(u.currentSheetIndex,{column:[t,t],row:[n,n]})):$("#luckysheet-helpbox-cell").text(wn(u.currentSheetIndex,e))}var Fg={moneyFmtList:[{name:"",pos:"before",value:""},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"Lek"},{name:"",pos:"before",value:"din"},{name:"",pos:"after",value:"Af"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"dh"},{name:"",pos:"before",value:"Afl"},{name:"",pos:"before",value:"Rial"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"Birr"},{name:"",pos:"before",value:"Kz"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"MOP"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"PGK"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"Rs"},{name:"",pos:"after",value:"Gs"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"B/"},{name:"",pos:"before",value:"R$"},{name:"",pos:"after",value:""},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"lev"},{name:"",pos:"before",value:"kr"},{name:"",pos:"before",value:"KM"},{name:"",pos:"after",value:"z?"},{name:"",pos:"before",value:"Bs"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"P"},{name:"",pos:"before",value:"Nu"},{name:"",pos:"before",value:"FBu"},{name:"",pos:"before",value:"?KP"},{name:"",pos:"after",value:"kr"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"RD$"},{name:"",pos:"after",value:"?"},{name:"",pos:"before",value:"Nfk"},{name:"",pos:"before",value:"CFA"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"CVE"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"GMD"},{name:"",pos:"before",value:"FrCD"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"HTG"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"NAf."},{name:"",pos:"before",value:"L"},{name:"",pos:"before",value:"Fdj"},{name:"",pos:"before",value:"KGS"},{name:"",pos:"before",value:"FG"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"GHS"},{name:"",pos:"before",value:"Riel"},{name:"",pos:"after",value:"K?"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"Rial"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"CF"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"kn"},{name:"",pos:"before",value:"Ksh"},{name:"",pos:"before",value:"LSL"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"L"},{name:"",pos:"before",value:"Lt"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"RF"},{name:"",pos:"before",value:"RON"},{name:"",pos:"before",value:"Ar"},{name:"",pos:"before",value:"Rf"},{name:"",pos:"before",value:"MWK"},{name:"",pos:"before",value:"RM"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"MURs"},{name:"",pos:"before",value:"MRO"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"S/"},{name:"",pos:"before",value:"K"},{name:"",pos:"before",value:"MDL"},{name:"",pos:"before",value:"dh"},{name:"",pos:"before",value:"MTn"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"R"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"C$"},{name:"",pos:"before",value:"Rs"},{name:"",pos:"before",value:"?"},{name:"",pos:"after",value:"kr"},{name:"",pos:"before",value:"GEL"},{name:"",pos:"before",value:""},{name:"",pos:"after",value:"kr"},{name:"",pos:"before",value:"CHF"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"SLL"},{name:"",pos:"before",value:"SCR"},{name:"",pos:"before",value:"Rial"},{name:"",pos:"before",value:"Db"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"Rs"},{name:"",pos:"before",value:"SZL"},{name:"",pos:"before",value:"SDG"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"SOS"},{name:"",pos:"before",value:"Som"},{name:"",pos:"after",value:"FCFP"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"TSh"},{name:"",pos:"before",value:"T$"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"VUV"},{name:"",pos:"before",value:"Q"},{name:"",pos:"before",value:"Bs"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"UGX"},{name:"",pos:"before",value:"."},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"so?m"},{name:"",pos:"before",value:"WST"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"NT$"},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"Ft"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"Dram"},{name:"",pos:"before",value:"Rial"},{name:"",pos:"before",value:"din"},{name:"",pos:"before",value:"Rial"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"?"},{name:"",pos:"before",value:"Rp"},{name:"",pos:"before",value:"din"},{name:"",pos:"after",value:"?"},{name:"",pos:"before",value:"ZMW"},{name:"",pos:"before",value:""},{name:"",pos:"before",value:"$"},{name:"",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"193085",value:'yyyy""M""d""'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"85",value:'M""d""'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"01:30",value:"/ hh:mm"},{name:"1:30",value:"/ h:mm"},{name:"1:30:30",value:"/ h:mm:ss"},{name:"08-05 01:30",value:"MM-dd / hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){var n=st().currencyDetail,t=st().format,a=st().button;this.moneyFmtList=[{name:n.RMB,pos:"before",value:""},{name:n.USdollar,pos:"before",value:"$"},{name:n.EUR,pos:"before",value:""},{name:n.GBP,pos:"before",value:""},{name:n.HK,pos:"before",value:"$"},{name:n.JPY,pos:"before",value:""},{name:n.AlbanianLek,pos:"before",value:"Lek"},{name:n.AlgerianDinar,pos:"before",value:"din"},{name:n.Afghani,pos:"after",value:"Af"},{name:n.ArgentinePeso,pos:"before",value:"$"},{name:n.UnitedArabEmiratesDirham,pos:"before",value:"dh"},{name:n.ArubanFlorin,pos:"before",value:"Afl"},{name:n.OmaniRial,pos:"before",value:"Rial"},{name:n.Azerbaijanimanat,pos:"before",value:"?"},{name:n.EgyptianPound,pos:"before",value:""},{name:n.EthiopianBirr,pos:"before",value:"Birr"},{name:n.AngolaKwanza,pos:"before",value:"Kz"},{name:n.AustralianDollar,pos:"before",value:"$"},{name:n.Patacas,pos:"before",value:"MOP"},{name:n.BarbadosDollar,pos:"before",value:"$"},{name:n.PapuaNewGuineaKina,pos:"before",value:"PGK"},{name:n.BahamianDollar,pos:"before",value:"$"},{name:n.PakistanRupee,pos:"before",value:"Rs"},{name:n.ParaguayanGuarani,pos:"after",value:"Gs"},{name:n.BahrainiDinar,pos:"before",value:"din"},{name:n.PanamanianBalboa,pos:"before",value:"B/"},{name:n.Brazilianreal,pos:"before",value:"R$"},{name:n.Belarusianruble,pos:"after",value:""},{name:n.BermudianDollar,pos:"before",value:"$"},{name:n.BulgarianLev,pos:"before",value:"lev"},{name:n.IcelandKrona,pos:"before",value:"kr"},{name:n.BosniaHerzegovinaConvertibleMark,pos:"before",value:"KM"},{name:n.PolishZloty,pos:"after",value:"z?"},{name:n.Boliviano,pos:"before",value:"Bs"},{name:n.BelizeDollar,pos:"before",value:"$"},{name:n.BotswanaPula,pos:"before",value:"P"},{name:n.NotDannuzhamu,pos:"before",value:"Nu"},{name:n.BurundiFranc,pos:"before",value:"FBu"},{name:n.NorthKoreanWon,pos:"before",value:"?KP"},{name:n.DanishKrone,pos:"after",value:"kr"},{name:n.EastCaribbeanDollar,pos:"before",value:"$"},{name:n.DominicaPeso,pos:"before",value:"RD$"},{name:n.RussianRuble,pos:"after",value:"?"},{name:n.EritreanNakfa,pos:"before",value:"Nfk"},{name:n.CFAfranc,pos:"before",value:"CFA"},{name:n.PhilippinePeso,pos:"before",value:"?"},{name:n.FijiDollar,pos:"before",value:"$"},{name:n.CapeVerdeEscudo,pos:"before",value:"CVE"},{name:n.FalklandIslandsPound,pos:"before",value:""},{name:n.GambianDalasi,pos:"before",value:"GMD"},{name:n.Congolesefranc,pos:"before",value:"FrCD"},{name:n.ColombianPeso,pos:"before",value:"$"},{name:n.CostaRicanColon,pos:"before",value:"?"},{name:n.CubanPeso,pos:"before",value:"$"},{name:n.Cubanconvertiblepeso,pos:"before",value:"$"},{name:n.GuyanaDollar,pos:"before",value:"$"},{name:n.KazakhstanTenge,pos:"before",value:"?"},{name:n.Haitiangourde,pos:"before",value:"HTG"},{name:n.won,pos:"before",value:"?"},{name:n.NetherlandsAntillesGuilder,pos:"before",value:"NAf."},{name:n.Honduraslempiras,pos:"before",value:"L"},{name:n.DjiboutiFranc,pos:"before",value:"Fdj"},{name:n.KyrgyzstanSom,pos:"before",value:"KGS"},{name:n.GuineaFranc,pos:"before",value:"FG"},{name:n.CanadianDollar,pos:"before",value:"$"},{name:n.GhanaianCedi,pos:"before",value:"GHS"},{name:n.Cambodianriel,pos:"before",value:"Riel"},{name:n.CzechKoruna,pos:"after",value:"K?"},{name:n.ZimbabweDollar,pos:"before",value:"$"},{name:n.QatariRiyal,pos:"before",value:"Rial"},{name:n.CaymanIslandsDollar,pos:"before",value:"$"},{name:n.Comorianfranc,pos:"before",value:"CF"},{name:n.KuwaitiDinar,pos:"before",value:"din"},{name:n.CroatianKuna,pos:"before",value:"kn"},{name:n.KenyanShilling,pos:"before",value:"Ksh"},{name:n.LesothoLoti,pos:"before",value:"LSL"},{name:n.LaoKip,pos:"before",value:"?"},{name:n.LebanesePound,pos:"before",value:"L"},{name:n.Lithuanianlitas,pos:"before",value:"Lt"},{name:n.LibyanDinar,pos:"before",value:"din"},{name:n.LiberianDollar,pos:"before",value:"$"},{name:n.RwandaFranc,pos:"before",value:"RF"},{name:n.RomanianLeu,pos:"before",value:"RON"},{name:n.MalagasyAriary,pos:"before",value:"Ar"},{name:n.MaldivianRufiyaa,pos:"before",value:"Rf"},{name:n.MalawiKwacha,pos:"before",value:"MWK"},{name:n.MalaysianRinggit,pos:"before",value:"RM"},{name:n.MacedoniawearingDinar,pos:"before",value:"din"},{name:n.MauritiusRupee,pos:"before",value:"MURs"},{name:n.MauritanianOuguiya,pos:"before",value:"MRO"},{name:n.MongolianTugrik,pos:"before",value:"?"},{name:n.BangladeshiTaka,pos:"before",value:"?"},{name:n.PeruvianNuevoSol,pos:"before",value:"S/"},{name:n.MyanmarKyat,pos:"before",value:"K"},{name:n.MoldovanLeu,pos:"before",value:"MDL"},{name:n.MoroccanDirham,pos:"before",value:"dh"},{name:n.MozambiqueMetical,pos:"before",value:"MTn"},{name:n.MexicanPeso,pos:"before",value:"$"},{name:n.NamibianDollar,pos:"before",value:"$"},{name:n.SouthAfricanRand,pos:"before",value:"R"},{name:n.SouthSudanesePound,pos:"before",value:""},{name:n.NicaraguaCordoba,pos:"before",value:"C$"},{name:n.NepaleseRupee,pos:"before",value:"Rs"},{name:n.NigerianNaira,pos:"before",value:"?"},{name:n.NorwegianKrone,pos:"after",value:"kr"},{name:n.GeorgianLari,pos:"before",value:"GEL"},{name:n.RenminbiOffshore,pos:"before",value:""},{name:n.SwedishKrona,pos:"after",value:"kr"},{name:n.SwissFranc,pos:"before",value:"CHF"},{name:n.SerbianDinar,pos:"before",value:"din"},{name:n.SierraLeone,pos:"before",value:"SLL"},{name:n.SeychellesRupee,pos:"before",value:"SCR"},{name:n.SaudiRiyal,pos:"before",value:"Rial"},{name:n.SaoTomeDobra,pos:"before",value:"Db"},{name:n.SaintHelenapound,pos:"before",value:""},{name:n.SriLankaRupee,pos:"before",value:"Rs"},{name:n.SwazilandLilangeni,pos:"before",value:"SZL"},{name:n.SudanesePound,pos:"before",value:"SDG"},{name:n.Surinamesedollar,pos:"before",value:"$"},{name:n.SolomonIslandsDollar,pos:"before",value:"$"},{name:n.SomaliShilling,pos:"before",value:"SOS"},{name:n.TajikistanSomoni,pos:"before",value:"Som"},{name:n.PacificFranc,pos:"after",value:"FCFP"},{name:n.ThaiBaht,pos:"before",value:"?"},{name:n.TanzanianShilling,pos:"before",value:"TSh"},{name:n.TonganPaanga,pos:"before",value:"T$"},{name:n.TrinidadandTobagoDollar,pos:"before",value:"$"},{name:n.TunisianDinar,pos:"before",value:"din"},{name:n.TurkishLira,pos:"before",value:"?"},{name:n.VanuatuVatu,pos:"before",value:"VUV"},{name:n.GuatemalanQuetzal,pos:"before",value:"Q"},{name:n.CommissionBolivar,pos:"before",value:"Bs"},{name:n.BruneiDollar,pos:"before",value:"$"},{name:n.UgandanShilling,pos:"before",value:"UGX"},{name:n.UkrainianHryvnia,pos:"before",value:"."},{name:n.UruguayanPeso,pos:"before",value:"$"},{name:n.Uzbekistansom,pos:"before",value:"so?m"},{name:n.WesternSamoaTala,pos:"before",value:"WST"},{name:n.SingaporeDollar,pos:"before",value:"$"},{name:n.NT,pos:"before",value:"NT$"},{name:n.NewZealandDollar,pos:"before",value:"$"},{name:n.HungarianForint,pos:"before",value:"Ft"},{name:n.SyrianPound,pos:"before",value:""},{name:n.JamaicanDollar,pos:"before",value:"$"},{name:n.ArmenianDram,pos:"before",value:"Dram"},{name:n.YemeniRial,pos:"before",value:"Rial"},{name:n.IraqiDinar,pos:"before",value:"din"},{name:n.IranianRial,pos:"before",value:"Rial"},{name:n.NewIsraeliShekel,pos:"before",value:"?"},{name:n.IndianRupee,pos:"before",value:"?"},{name:n.IndonesianRupiah,pos:"before",value:"Rp"},{name:n.JordanianDinar,pos:"before",value:"din"},{name:n.VND,pos:"after",value:"?"},{name:n.ZambianKwacha,pos:"before",value:"ZMW"},{name:n.GibraltarPound,pos:"before",value:""},{name:n.ChileanPeso,pos:"before",value:"$"},{name:n.CFAFrancBEAC,pos:"before",value:"FCFA"}],this.dateFmtList=st().dateFmtList,this.numFmtList=[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-moreFormat-dialog").remove();var l="",o="";if(e=="morecurrency"){l=t.titleCurrency;for(var d="",s=0;s<this.moneyFmtList.length;s++){var h=this.moneyFmtList[s].name,f=this.moneyFmtList[s].pos;d+='<div class="listItem"><div class="name">'+h+'</div><div class="value">'+this.moneyFmtList[s].value+'</div><input type="hidden" value="'+f+'"/></div>'}o='<div class="box" id="morecurrency"><div class="decimal"><label>'+t.decimalPlaces+'</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+d+"</div></div>"}else if(e=="moredatetime"){l=t.titleDateTime;for(var p="",g=0;g<this.dateFmtList.length;g++)p+='<div class="listItem"><div class="name">'+this.dateFmtList[g].name+'</div><div class="value">'+this.dateFmtList[g].value+"</div></div>";o='<div class="box" id="moredatetime"><div class="listbox">'+p+"</div></div>"}else if(e=="moredigit"){l=t.titleNumber;for(var v="",y=0;y<this.numFmtList.length;y++)v+='<div class="listItem"><div class="name">'+this.numFmtList[y].name+'</div><div class="value">'+this.numFmtList[y].value+"</div></div>";o='<div class="box" id="moredigit"><div class="listbox">'+v+"</div></div>"}$("body").append(br(Ga,{id:"luckysheet-moreFormat-dialog",addclass:"luckysheet-moreFormat-dialog",title:l,content:o,botton:'<button id="luckysheet-moreFormat-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));var b=$("#luckysheet-moreFormat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),k=b.outerHeight(),w=b.outerWidth(),_=$(window).width(),C=$(window).height(),A=$(document).scrollLeft(),I=$(document).scrollTop();$("#luckysheet-moreFormat-dialog").css({left:(_+A-w)/2,top:(C+I-k)/3}).show(),$("#luckysheet-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){$(document).on("click","#luckysheet-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#luckysheet-moreFormat-dialog #luckysheet-moreFormat-dialog-confirm",function(){$("#luckysheet-moreFormat-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide();var e=vr.deepCopyFlowData(u.flowdata),n=$("#luckysheet-moreFormat-dialog .listbox .listItem.on .value").text(),t=$(this).parents("#luckysheet-moreFormat-dialog").find(".box").attr("id");if(t=="morecurrency"){if(n.indexOf("?")!=-1)return;var a=parseInt($("#luckysheet-moreFormat-dialog .decimal input").val().trim());if(a.toString()=="NaN"||a<0||a>9)return void(Rt()?alert("0-9"):Ee.info("0-9",""));var l="";if(a>0){for(var o=1;o<=a;o++)l+="0";l="0."+l}else l="#";var d=$("#luckysheet-moreFormat-dialog .listbox .listItem.on input:hidden").val();d=="before"?l='"'+n+'" '+l:d=="after"&&(l=l+' "'+n+'"'),dr.updateFormat(e,"ct",l)}else(t=="moredatetime"||t=="moredigit")&&dr.updateFormat(e,"ct",n)})}},Us={createDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-replace").remove();var n=st(),t=n.findAndReplace,a=n.button,l='<div class="tabBox"><span id="searchTab">'+t.find+'</span><span id="replaceTab">'+t.replace+'</span></div><div class="ctBox"><div class="inputBox"><div class="textboxs" id="searchInput">'+t.findTextbox+'<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="textboxs" id="replaceInput">'+t.replaceTextbox+'<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="checkboxs"><div id="regCheck"><input type="checkbox"/><span>'+t.regexTextbox+'</span></div><div id="wordCheck"><input type="checkbox"/><span>'+t.wholeTextbox+'</span></div><div id="caseCheck"><input type="checkbox"/><span>'+t.distinguishTextbox+'</span></div></div></div><div class="btnBox"><button id="replaceAllBtn" class="btn btn-default">'+t.allReplaceBtn+'</button><button id="replaceBtn" class="btn btn-default">'+t.replaceBtn+'</button><button id="searchAllBtn" class="btn btn-default">'+t.allFindBtn+'</button><button id="searchNextBtn" class="btn btn-default">'+t.findBtn+"</button></div></div>";$("body").append(br(Ga,{id:"luckysheet-search-replace",addclass:"luckysheet-search-replace",title:"",content:l,botton:'<button class="btn btn-default luckysheet-model-close-btn">'+a.close+"</button>",style:"z-index:100003",close:a.close}));var o=$("#luckysheet-search-replace").find(".luckysheet-modal-dialog-content").css("min-width",500).end(),d=o.outerHeight(),s=o.outerWidth(),h=$(window).width(),f=$(window).height(),p=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-search-replace").css({left:(h+p-s)/2,top:(f+g-d)/3}).show(),e=="0"?($("#luckysheet-search-replace #searchTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide()):e=="1"&&($("#luckysheet-search-replace #replaceTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show())},init:function(){var e=this;$(document).off("click.SRtabBoxspan").on("click.SRtabBoxspan","#luckysheet-search-replace .tabBox span",function(){$(this).addClass("on").siblings().removeClass("on");var n=$(this).attr("id");n=="searchTab"?($("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide(),$("#luckysheet-search-replace #searchInput input").focus()):n=="replaceTab"&&($("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show(),$("#luckysheet-search-replace #replaceInput input").focus())}),$(document).off("keyup.SRsearchInput").on("keyup.SRsearchInput","#luckysheet-search-replace #searchInput input",function(n){n.keyCode==Yi&&e.searchNext()}),$(document).off("click.SRsearchNextBtn").on("click.SRsearchNextBtn","#luckysheet-search-replace #searchNextBtn",function(){e.searchNext()}),$(document).off("click.SRsearchAllBtn").on("click.SRsearchAllBtn","#luckysheet-search-replace #searchAllBtn",function(){e.searchAll()}),$(document).off("click.SRsearchAllboxItem").on("click.SRsearchAllboxItem","#luckysheet-search-replace #searchAllbox .boxItem",function(){$(this).addClass("on").siblings().removeClass("on");var n=$(this).attr("data-row"),t=$(this).attr("data-col"),a=$(this).attr("data-sheetIndex");a!=u.currentSheetIndex&&ir.changeSheetExec(a),u.luckysheet_select_save=[{row:[n,n],column:[t,t]}],Ra();var l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").height(),s=$("#luckysheet-cell-main").width(),h=u.visibledatarow[n],f=n-1==-1?0:u.visibledatarow[n-1],p=u.visibledatacolumn[t],g=t-1==-1?0:u.visibledatacolumn[t-1];p-l-s+20>0?$("#luckysheet-scrollbar-x").scrollLeft(p-s+20):g-l-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(g-20),h-o-d+20>0?$("#luckysheet-scrollbar-y").scrollTop(h-d+20):f-o-20<0&&$("#luckysheet-scrollbar-y").scrollTop(f-20)}),$(document).off("click.SRreplaceBtn").on("click.SRreplaceBtn","#luckysheet-search-replace #replaceBtn",function(){e.replace()}),$(document).off("click.SRreplaceAllBtn").on("click.SRreplaceAllBtn","#luckysheet-search-replace #replaceAllBtn",function(){e.replaceAll()})},searchNext:function(){var e=$("#luckysheet-search-replace #searchInput input").val();if(e!=""&&e!=null){var n,t=st().findAndReplace;n=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save);var a=this.getSearchIndexArr(e,n);if(a.length!=0){var l=0;if(u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]){if(u.luckysheet_select_save.length==0)l=0;else for(var o=0;o<a.length;o++)if(a[o].r==u.luckysheet_select_save[0].row[0]&&a[o].c==u.luckysheet_select_save[0].column[0]){l=o==a.length-1?0:o+1;break}u.luckysheet_select_save=[{row:[a[l].r,a[l].r],column:[a[l].c,a[l].c]}]}else{for(var d=n[n.length-1].row_focus,s=n[n.length-1].column_focus,h=0;h<a.length;h++)if(a[h].r==d&&a[h].c==s){l=h==a.length-1?0:h+1;break}for(var f=0;f<n.length;f++){var p=n[f].row[0],g=n[f].row[1],v=n[f].column[0],y=n[f].column[1];if(a[l].r>=p&&a[l].r<=g&&a[l].c>=v&&a[l].c<=y){var b=n[f];b.row_focus=a[l].r,b.column_focus=a[l].c,n.splice(f,1),n.push(b);break}}u.luckysheet_select_save=n}Ra();var k=$("#luckysheet-cell-main").scrollLeft(),w=$("#luckysheet-cell-main").scrollTop(),_=$("#luckysheet-cell-main").height(),C=$("#luckysheet-cell-main").width(),A=u.visibledatarow[a[l].r],I=a[l].r-1==-1?0:u.visibledatarow[a[l].r-1],S=u.visibledatacolumn[a[l].c],E=a[l].c-1==-1?0:u.visibledatacolumn[a[l].c-1];S-k-C+20>0?$("#luckysheet-scrollbar-x").scrollLeft(S-C+20):E-k-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(E-20),A-w-_+20>0?$("#luckysheet-scrollbar-y").scrollTop(A-_+20):I-w-20<0&&$("#luckysheet-scrollbar-y").scrollTop(I-20),$("#searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox .boxItem").removeClass("on")}else Rt()?alert(t.noFindTip):Ee.info(t.noFindTip,"")}},searchAll:function(){var e=st().findAndReplace;$("#luckysheet-search-replace #searchAllbox").remove();var n=$("#luckysheet-search-replace #searchInput input").val();if(n!=""&&n!=null){var t;t=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save);var a=this.getSearchIndexArr(n,t);if(a.length!=0){for(var l="",o=0;o<a.length;o++){var d=uu(a[o].r,a[o].c,u.flowdata).toString();d.indexOf("</")>-1&&d.indexOf(">")>-1?l+='<div class="boxItem" data-row="'+a[o].r+'" data-col="'+a[o].c+'" data-sheetIndex="'+u.currentSheetIndex+'"><span>'+u.luckysheetfile[je(u.currentSheetIndex)].name+"</span><span>"+ya(a[o].c)+(a[o].r+1)+"</span><span>"+d+"</span></div>":l+='<div class="boxItem" data-row="'+a[o].r+'" data-col="'+a[o].c+'" data-sheetIndex="'+u.currentSheetIndex+'"><span>'+u.luckysheetfile[je(u.currentSheetIndex)].name+"</span><span>"+ya(a[o].c)+(a[o].r+1)+'</span><span title="'+d+'">'+d+"</span></div>"}$('<div id="searchAllbox"><div class="boxTitle"><span>'+e.searchTargetSheet+"</span><span>"+e.searchTargetCell+"</span><span>"+e.searchTargetValue+'</span></div><div class="boxMain">'+l+"</div></div>").appendTo($("#luckysheet-search-replace")),$("#luckysheet-search-replace #searchAllbox .boxItem").eq(0).addClass("on").siblings().removeClass("on"),u.luckysheet_select_save=[{row:[a[0].r,a[0].r],column:[a[0].c,a[0].c]}],Ra()}else Rt()?alert(e.noFindTip):Ee.info(e.noFindTip,"")}},getSearchIndexArr:function(e,n){var t=[],a={},l=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(l=!0);var o=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(o=!0);var d=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(d=!0);for(var s=0;s<n.length;s++)for(var h=n[s].row[0],f=n[s].row[1],p=n[s].column[0],g=n[s].column[1],v=h;v<=f;v++)for(var y=p;y<=g;y++)if(u.flowdata[v][y]!=null){var b=uu(v,y,u.flowdata);b==0&&(b=b.toString()),b!=null&&b!=""&&(b=b.toString(),o?d?e==b&&(v+"_"+y in a||(a[v+"_"+y]=0,t.push({r:v,c:y}))):e.toLowerCase()==b.toLowerCase()&&(v+"_"+y in a||(a[v+"_"+y]=0,t.push({r:v,c:y}))):l?(d?new RegExp(T.getRegExpStr(e),"g"):new RegExp(T.getRegExpStr(e),"ig")).test(b)&&(v+"_"+y in a||(a[v+"_"+y]=0,t.push({r:v,c:y}))):d?new RegExp(T.getRegExpStr(e),"g").test(b)&&(v+"_"+y in a||(a[v+"_"+y]=0,t.push({r:v,c:y}))):new RegExp(T.getRegExpStr(e),"ig").test(b)&&(v+"_"+y in a||(a[v+"_"+y]=0,t.push({r:v,c:y}))))}return t},replace:function(){var e=st().findAndReplace;if(u.allowEdit){var n=$("#luckysheet-search-replace #searchInput input").val();if(n!=""&&n!=null){var t;t=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save);var a=this.getSearchIndexArr(n,t);if(a.length!=0){for(var l=null,o=u.luckysheet_select_save[u.luckysheet_select_save.length-1],d=o.row_focus,s=o.column_focus,h=0;h<a.length;h++)if(a[h].r==d&&a[h].c==s){l=h;break}if(l==null){if(a.length==0)return void(Rt()?alert(e.noMatchTip):Ee.info(e.noMatchTip,""));l=0}$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked");var f=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(f=!0);var p=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(p=!0);var g,v,y,b=$("#luckysheet-search-replace #replaceInput input").val(),k=vr.deepCopyFlowData(u.flowdata);f?Ln(g=a[l].r,v=a[l].c,k,b):(y=p?new RegExp(T.getRegExpStr(n),"g"):new RegExp(T.getRegExpStr(n),"ig"),Ln(g=a[l].r,v=a[l].c,k,uu(g,v,k).toString().replace(y,b))),u.luckysheet_select_save=[{row:[g,g],column:[v,v]}],$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),wa(k,u.luckysheet_select_save),Ra();var w=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop(),C=$("#luckysheet-cell-main").height(),A=$("#luckysheet-cell-main").width(),I=u.visibledatarow[g],S=g-1==-1?0:u.visibledatarow[g-1],E=u.visibledatacolumn[v],R=v-1==-1?0:u.visibledatacolumn[v-1];E-w-A+20>0?$("#luckysheet-scrollbar-x").scrollLeft(E-A+20):R-w-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(R-20),I-_-C+20>0?$("#luckysheet-scrollbar-y").scrollTop(I-C+20):S-_-20<0&&$("#luckysheet-scrollbar-y").scrollTop(S-20)}else Rt()?alert(e.noReplceTip):Ee.info(e.noReplceTip,"")}else Rt()?alert(e.searchInputTip):Ee.info(e.searchInputTip,"")}else Ee.info(e.modeTip,"")},replaceAll:function(){var e=st().findAndReplace;if(u.allowEdit){var n=$("#luckysheet-search-replace #searchInput input").val();if(n!=""&&n!=null){var t;t=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save);var a=this.getSearchIndexArr(n,t);if(a.length!=0){$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked");var l=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(l=!0);var o=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(o=!0);var d=$("#luckysheet-search-replace #replaceInput input").val(),s=vr.deepCopyFlowData(u.flowdata);if(l)for(var h=0;h<a.length;h++){var f=a[h].r,p=a[h].c;Ln(f,p,s,d),t.push({row:[f,f],column:[p,p]})}else{var g;g=o?new RegExp(T.getRegExpStr(n),"g"):new RegExp(T.getRegExpStr(n),"ig");for(var v=0;v<a.length;v++){var y=a[v].r,b=a[v].c;Ln(y,b,s,uu(y,b,s).toString().replace(g,d)),t.push({row:[y,y],column:[b,b]})}}$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),wa(s,t),u.luckysheet_select_save=$.extend(!0,[],t),Ra();var k=br(e.successTip,{xlength:a.length});Rt()?alert(k):Ee.info(k,"")}else Rt()?alert(e.noReplceTip):Ee.info(e.noReplceTip,"")}else Rt()?alert(e.searchInputTip):Ee.info(e.searchInputTip,"")}else Ee.info(e.modeTip,"")}},io={createDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-locationCell-dialog").remove();var e=st(),n=e.findAndReplace,t=e.button,a='<div class="listbox"><div class="listItem"><input type="radio" name="locationType" checked="checked" id="locationConstant"><label for="locationConstant">'+n.locationConstant+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationConstantDate"><label for="locationConstantDate">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationConstantNumber"><label for="locationConstantNumber">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationConstantString"><label for="locationConstantString">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationConstantBoolean"><label for="locationConstantBoolean">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationConstantError"><label for="locationConstantError">'+n.locationBool+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationFormula"><label for="locationFormula">'+n.locationFormula+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationFormulaDate" disabled="true"><label for="locationFormulaDate" style="color: #666">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationFormulaNumber" disabled="true"><label for="locationFormulaNumber" style="color: #666">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationFormulaString" disabled="true"><label for="locationFormulaString" style="color: #666">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationFormulaBoolean" disabled="true"><label for="locationFormulaBoolean" style="color: #666">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationFormulaError" disabled="true"><label for="locationFormulaError" style="color: #666">'+n.locationError+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationNull"><label for="locationNull">'+n.locationNull+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationCF"><label for="locationCF">'+n.locationCondition+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepRow"><label for="locationStepRow">'+n.locationRowSpan+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepColumn"><label for="locationStepColumn">'+n.locationColumnSpan+"</label></div></div>";$("body").append(br(Ga,{id:"luckysheet-locationCell-dialog",addclass:"luckysheet-locationCell-dialog",title:n.location,content:a,botton:'<button id="luckysheet-locationCell-dialog-confirm" class="btn btn-primary">'+t.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+t.cancel+"</button>",style:"z-index:100003"}));var l=$("#luckysheet-locationCell-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-locationCell-dialog").css({left:(s+f-d)/2,top:(h+p-o)/3}).show()},init:function(){var e=this,n=st().findAndReplace;$(document).on("click","#luckysheet-locationCell-dialog .listItem input:radio",function(t){$("#luckysheet-locationCell-dialog .listItem input:checkbox").prop("disabled",!0),$("#luckysheet-locationCell-dialog .listItem .subbox label").css("color","#666"),$(this).siblings(".subbox").find("input:checkbox").removeAttr("disabled"),$(this).siblings(".subbox").find("label").css("color","#000")}),$(document).off("click.locationCellConfirm").on("click.locationCellConfirm","#luckysheet-locationCell-dialog #luckysheet-locationCell-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-locationCell-dialog").hide();var t=$("#luckysheet-locationCell-dialog .listItem input:radio:checked"),a=t.attr("id");if(a=="locationConstant"||a=="locationFormula"){var l,o,d=t.siblings(".subbox").find("input:checkbox:checked");if(d.length==0)return;if(d.length==5)l="all";else{for(var s=[],h=0;h<d.length;h++)$(d[h]).hasClass("date")?s.push("d"):$(d[h]).hasClass("number")?s.push("n"):$(d[h]).hasClass("string")?s.push("s,g"):$(d[h]).hasClass("boolean")?s.push("b"):$(d[h]).hasClass("error")&&s.push("e");l=s.join(",")}o=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save),e.apply(o,a,l)}else if(a=="locationStepRow"){if(u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1])return void(Rt()?alert(n.locationTiplessTwoRow):Ee.info("",n.locationTiplessTwoRow));var f=$.extend(!0,[],u.luckysheet_select_save);e.apply(f,"locationStepRow")}else if(a=="locationStepColumn"){if(u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1])return void(Rt()?alert(n.locationTiplessTwoColumn):Ee.info("",n.locationTiplessTwoColumn));var p=$.extend(!0,[],u.luckysheet_select_save);e.apply(p,"locationStepColumn")}else{var g;g=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1]&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save),e.apply(g,a)}})},apply:function(e,n,t){var a=st().findAndReplace,l=[];if(n=="locationFormula"||n=="locationConstant"||n=="locationNull"){for(var o=null,d=null,s=null,h=null,f={},p=0;p<e.length;p++){var g=e[p].row[0],v=e[p].row[1],y=e[p].column[0],b=e[p].column[1];(o==null||o<g)&&(o=g),(d==null||d>v)&&(d=v),(s==null||s<y)&&(s=y),(h==null||h>b)&&(h=b);for(var k=g;k<=v;k++)for(var w=y;w<=b;w++){var _=u.flowdata[k][w];_!=null&&_.mc!=null&&(_=u.flowdata[_.mc.r][_.mc.c]),n=="locationFormula"&&_!=null&&!$t(_.v)&&_.f!=null&&(t=="all"||_.ct!=null&&t.indexOf(_.ct.t)>-1)||n=="locationConstant"&&_!=null&&!$t(_.v)&&(t=="all"||_.ct!=null&&t.indexOf(_.ct.t)>-1)?f[k+"_"+w]=0:n!="locationNull"||_!=null&&!$t(_.v)||(f[k+"_"+w]=0)}}l=this.getRangeArr(o,d,s,h,f,l)}else if(n=="locationCF"){var C=je(u.currentSheetIndex),A=u.luckysheetfile[C].luckysheet_conditionformat_save,I=u.luckysheetfile[C].data;if(A==null||A.length==0||(computeMap=kr.compute(A,I),Object.keys(computeMap).length==0))return void(Rt()?alert(a.locationTipNotFindCell):Ee.info("",a.locationTipNotFindCell));for(var S=null,E=null,R=null,F=null,N={},z=0;z<e.length;z++){var P=e[z].row[0],q=e[z].row[1],V=e[z].column[0],x=e[z].column[1];(S==null||S<P)&&(S=P),(E==null||E>q)&&(E=q),(R==null||R<V)&&(R=V),(F==null||F>x)&&(F=x);for(var ee=P;ee<=q;ee++)for(var ne=V;ne<=x;ne++)ee+"_"+ne in computeMap&&(N[ee+"_"+ne]=0)}l=this.getRangeArr(S,E,R,F,N,l)}else if(n=="locationStepRow"){for(var ae=0;ae<e.length;ae++)if(e[ae].row[0]!=e[ae].row[1])for(var de=e[ae].row[0],ve=e[ae].row[1],U=e[ae].column[0],B=e[ae].column[1],le=de;le<=ve;le++)(le-de)%2==0&&l.push({row:[le,le],column:[U,B]})}else if(n=="locationStepColumn"){for(var Te=0;Te<e.length;Te++)if(e[Te].column[0]!=e[Te].column[1])for(var ue=e[Te].row[0],be=e[Te].row[1],ye=e[Te].column[0],ce=e[Te].column[1],Re=ye;Re<=ce;Re++)(Re-ye)%2==0&&l.push({row:[ue,be],column:[Re,Re]})}if(l.length==0)Rt()?alert(a.locationTipNotFindCell):Ee.info("",a.locationTipNotFindCell);else{u.luckysheet_select_save=l,Ra();var pe=$("#luckysheet-cell-main").scrollLeft(),me=$("#luckysheet-cell-main").scrollTop(),re=$("#luckysheet-cell-main").height(),_e=$("#luckysheet-cell-main").width(),Ze=u.luckysheet_select_save[0].row[0],We=u.luckysheet_select_save[0].row[1],Xe=u.luckysheet_select_save[0].column[0],Ue=u.luckysheet_select_save[0].column[1],mt=u.visibledatarow[We],St=Ze-1==-1?0:u.visibledatarow[Ze-1],at=u.visibledatacolumn[Ue],dt=Xe-1==-1?0:u.visibledatacolumn[Xe-1];at-pe-_e+20>0?$("#luckysheet-scrollbar-x").scrollLeft(at-_e+20):dt-pe-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(dt-20),mt-me-re+20>0?$("#luckysheet-scrollbar-y").scrollTop(mt-re+20):St-me-20<0&&$("#luckysheet-scrollbar-y").scrollTop(St-20)}},getRangeArr:function(e,n,t,a,l,o){if(Object.keys(l).length==0)return o;for(var d=null,s=null,h=null,f=null,p=e;p<=n;p++)for(var g=t;g<=a;g++){var v=u.flowdata[p][g];if(p+"_"+g in l){if(v!=null&&v.mc!=null){if(h==null){var y={row:[v.mc.r,v.mc.r+v.mc.rs-1],column:[v.mc.c,v.mc.c+v.mc.cs-1]};return o.push(y),l=this.deleteCellInSave(l,y),this.getRangeArr(e,n,t,a,l,o)}if(g<f){var b={row:[d,s],column:[h,f]};return o.push(b),l=this.deleteCellInSave(l,b),this.getRangeArr(e,n,t,a,l,o)}break}h==null?(h=g,f=g,d=p,s=p):g>f&&(f=g)}else if(h!=null){if(v!=null&&v.mc!=null)break;if(!(g<h)){if(g<=f){var k={row:[d,s],column:[h,f]};return o.push(k),l=this.deleteCellInSave(l,k),this.getRangeArr(e,n,t,a,l,o)}s=p}}}if(h!=null){var w={row:[d,s],column:[h,f]};return o.push(w),l=this.deleteCellInSave(l,w),this.getRangeArr(e,n,t,a,l,o)}},deleteCellInSave:function(e,n){for(var t=n.row[0];t<=n.row[1];t++)for(var a=n.column[0];a<=n.column[1];a++)delete e[t+"_"+a];return e}},Bb=function(e){if(th(e))throw TypeError("The method doesn't accept regular expressions");return e},Vb=bn("match");Ce({target:"String",proto:!0,forced:!function(e){var n=/./;try{"/./"[e](n)}catch{try{return n[Vb]=!1,"/./"[e](n)}catch{}}return!1}("includes")},{includes:function(e){return!!~String(ke(this)).indexOf(Bb(e),arguments.length>1?arguments[1]:void 0)}});var qg=Fe(function(e,n){/* flatpickr v4.6.6, @license MIT */e.exports=function(){/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.

	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.

	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */var t=function(){return(t=Object.assign||function(q){for(var V,x=1,ee=arguments.length;x<ee;x++)for(var ne in V=arguments[x])Object.prototype.hasOwnProperty.call(V,ne)&&(q[ne]=V[ne]);return q}).apply(this,arguments)};function a(){for(var q=0,V=0,x=arguments.length;V<x;V++)q+=arguments[V].length;var ee=Array(q),ne=0;for(V=0;V<x;V++)for(var ae=arguments[V],de=0,ve=ae.length;de<ve;de++,ne++)ee[ne]=ae[de];return ee}var l=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],o={_disable:[],_enable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enable:[],enableSeconds:!1,enableTime:!1,errorHandler:function(q){return typeof console<"u"&&console.warn(q)},getWeek:function(q){var V=new Date(q.getTime());V.setHours(0,0,0,0),V.setDate(V.getDate()+3-(V.getDay()+6)%7);var x=new Date(V.getFullYear(),0,4);return 1+Math.round(((V.getTime()-x.getTime())/864e5-3+(x.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},d={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(q){var V=q%100;if(V>3&&V<21)return"th";switch(V%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},s=function(q,V){return V===void 0&&(V=2),("000"+q).slice(-1*V)},h=function(q){return q===!0?1:0};function f(q,V,x){var ee;return x===void 0&&(x=!1),function(){var ne=this,ae=arguments;ee!==null&&clearTimeout(ee),ee=window.setTimeout(function(){ee=null,x||q.apply(ne,ae)},V),x&&!ee&&q.apply(ne,ae)}}var p=function(q){return q instanceof Array?q:[q]};function g(q,V,x){if(x===!0)return q.classList.add(V);q.classList.remove(V)}function v(q,V,x){var ee=window.document.createElement(q);return V=V||"",x=x||"",ee.className=V,x!==void 0&&(ee.textContent=x),ee}function y(q){for(;q.firstChild;)q.removeChild(q.firstChild)}function b(q,V){var x=v("div","numInputWrapper"),ee=v("input","numInput "+q),ne=v("span","arrowUp"),ae=v("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?ee.type="number":(ee.type="text",ee.pattern="\\d*"),V!==void 0)for(var de in V)ee.setAttribute(de,V[de]);return x.appendChild(ee),x.appendChild(ne),x.appendChild(ae),x}function k(q){try{return typeof q.composedPath=="function"?q.composedPath()[0]:q.target}catch{return q.target}}var w=function(){},_=function(q,V,x){return x.months[V?"shorthand":"longhand"][q]},C={D:w,F:function(q,V,x){q.setMonth(x.months.longhand.indexOf(V))},G:function(q,V){q.setHours(parseFloat(V))},H:function(q,V){q.setHours(parseFloat(V))},J:function(q,V){q.setDate(parseFloat(V))},K:function(q,V,x){q.setHours(q.getHours()%12+12*h(new RegExp(x.amPM[1],"i").test(V)))},M:function(q,V,x){q.setMonth(x.months.shorthand.indexOf(V))},S:function(q,V){q.setSeconds(parseFloat(V))},U:function(q,V){return new Date(1e3*parseFloat(V))},W:function(q,V,x){var ee=parseInt(V),ne=new Date(q.getFullYear(),0,2+7*(ee-1),0,0,0,0);return ne.setDate(ne.getDate()-ne.getDay()+x.firstDayOfWeek),ne},Y:function(q,V){q.setFullYear(parseFloat(V))},Z:function(q,V){return new Date(V)},d:function(q,V){q.setDate(parseFloat(V))},h:function(q,V){q.setHours(parseFloat(V))},i:function(q,V){q.setMinutes(parseFloat(V))},j:function(q,V){q.setDate(parseFloat(V))},l:w,m:function(q,V){q.setMonth(parseFloat(V)-1)},n:function(q,V){q.setMonth(parseFloat(V)-1)},s:function(q,V){q.setSeconds(parseFloat(V))},u:function(q,V){return new Date(parseFloat(V))},w,y:function(q,V){q.setFullYear(2e3+parseFloat(V))}},A={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},I={Z:function(q){return q.toISOString()},D:function(q,V,x){return V.weekdays.shorthand[I.w(q,V,x)]},F:function(q,V,x){return _(I.n(q,V,x)-1,!1,V)},G:function(q,V,x){return s(I.h(q,V,x))},H:function(q){return s(q.getHours())},J:function(q,V){return V.ordinal!==void 0?q.getDate()+V.ordinal(q.getDate()):q.getDate()},K:function(q,V){return V.amPM[h(q.getHours()>11)]},M:function(q,V){return _(q.getMonth(),!0,V)},S:function(q){return s(q.getSeconds())},U:function(q){return q.getTime()/1e3},W:function(q,V,x){return x.getWeek(q)},Y:function(q){return s(q.getFullYear(),4)},d:function(q){return s(q.getDate())},h:function(q){return q.getHours()%12?q.getHours()%12:12},i:function(q){return s(q.getMinutes())},j:function(q){return q.getDate()},l:function(q,V){return V.weekdays.longhand[q.getDay()]},m:function(q){return s(q.getMonth()+1)},n:function(q){return q.getMonth()+1},s:function(q){return q.getSeconds()},u:function(q){return q.getTime()},w:function(q){return q.getDay()},y:function(q){return String(q.getFullYear()).substring(2)}},S=function(q){var V=q.config,x=V===void 0?o:V,ee=q.l10n,ne=ee===void 0?d:ee,ae=q.isMobile,de=ae!==void 0&&ae;return function(ve,U,B){var le=B||ne;return x.formatDate===void 0||de?U.split("").map(function(Te,ue,be){return I[Te]&&be[ue-1]!=="\\"?I[Te](ve,le,x):Te!=="\\"?Te:""}).join(""):x.formatDate(ve,U,le)}},E=function(q){var V=q.config,x=V===void 0?o:V,ee=q.l10n,ne=ee===void 0?d:ee;return function(ae,de,ve,U){if(ae===0||ae){var B,le=U||ne,Te=ae;if(ae instanceof Date)B=new Date(ae.getTime());else if(typeof ae!="string"&&ae.toFixed!==void 0)B=new Date(ae);else if(typeof ae=="string"){var ue=de||(x||o).dateFormat,be=String(ae).trim();if(be==="today")B=new Date,ve=!0;else if(/Z$/.test(be)||/GMT$/.test(be))B=new Date(ae);else if(x&&x.parseDate)B=x.parseDate(ae,ue);else{B=x&&x.noCalendar?new Date(new Date().setHours(0,0,0,0)):new Date(new Date().getFullYear(),0,1,0,0,0,0);for(var ye=void 0,ce=[],Re=0,pe=0,me="";Re<ue.length;Re++){var re=ue[Re],_e=re==="\\",Ze=ue[Re-1]==="\\"||_e;if(A[re]&&!Ze){me+=A[re];var We=new RegExp(me).exec(ae);We&&(ye=!0)&&ce[re!=="Y"?"push":"unshift"]({fn:C[re],val:We[++pe]})}else _e||(me+=".");ce.forEach(function(Xe){var Ue=Xe.fn,mt=Xe.val;return B=Ue(B,mt,le)||B})}B=ye?B:void 0}}if(B instanceof Date&&!isNaN(B.getTime()))return ve===!0&&B.setHours(0,0,0,0),B;x.errorHandler(new Error("Invalid date provided: "+Te))}}};function R(q,V,x){return x===void 0&&(x=!0),x!==!1?new Date(q.getTime()).setHours(0,0,0,0)-new Date(V.getTime()).setHours(0,0,0,0):q.getTime()-V.getTime()}var F=864e5;function N(q,V){var x={config:t(t({},o),P.defaultConfig),l10n:d};function ee(ze){return ze.bind(x)}function ne(){var ze=x.config;ze.weekNumbers===!1&&ze.showMonths===1||ze.noCalendar!==!0&&window.requestAnimationFrame(function(){if(x.calendarContainer!==void 0&&(x.calendarContainer.style.visibility="hidden",x.calendarContainer.style.display="block"),x.daysContainer!==void 0){var Ae=(x.days.offsetWidth+1)*ze.showMonths;x.daysContainer.style.width=Ae+"px",x.calendarContainer.style.width=Ae+(x.weekWrapper!==void 0?x.weekWrapper.offsetWidth:0)+"px",x.calendarContainer.style.removeProperty("visibility"),x.calendarContainer.style.removeProperty("display")}})}function ae(ze){if(x.selectedDates.length===0){var Ae=x.config.minDate!==void 0?new Date(x.config.minDate.getTime()):new Date,Ve=U(),gt=Ve.hours,vt=Ve.minutes,pt=Ve.seconds;Ae.setHours(gt,vt,pt,0),x.setDate(Ae,!1)}ze!==void 0&&ze.type!=="blur"&&function(Ot){Ot.preventDefault();var It=Ot.type==="keydown",Lt=k(Ot),At=Lt;x.amPM!==void 0&&Lt===x.amPM&&(x.amPM.textContent=x.l10n.amPM[h(x.amPM.textContent===x.l10n.amPM[0])]);var or=parseFloat(At.getAttribute("min")),Cr=parseFloat(At.getAttribute("max")),Ar=parseFloat(At.getAttribute("step")),Rr=parseInt(At.value,10),Zr=Ot.delta||(It?Ot.which===38?1:-1:0),Tr=Rr+Ar*Zr;if(At.value!==void 0&&At.value.length===2){var jr=At===x.hourElement,ta=At===x.minuteElement;Tr<or?(Tr=Cr+Tr+h(!jr)+(h(jr)&&h(!x.amPM)),ta&&ce(void 0,-1,x.hourElement)):Tr>Cr&&(Tr=At===x.hourElement?Tr-Cr-h(!x.amPM):or,ta&&ce(void 0,1,x.hourElement)),x.amPM&&jr&&(Ar===1?Tr+Rr===23:Math.abs(Tr-Rr)>Ar)&&(x.amPM.textContent=x.l10n.amPM[h(x.amPM.textContent===x.l10n.amPM[0])]),At.value=s(Tr)}}(ze);var Tt=x._input.value;de(),fr(),x._input.value!==Tt&&x._debouncedChange()}function de(){if(x.hourElement!==void 0&&x.minuteElement!==void 0){var ze,Ae,Ve=(parseInt(x.hourElement.value.slice(-2),10)||0)%24,gt=(parseInt(x.minuteElement.value,10)||0)%60,vt=x.secondElement!==void 0?(parseInt(x.secondElement.value,10)||0)%60:0;x.amPM!==void 0&&(ze=Ve,Ae=x.amPM.textContent,Ve=ze%12+12*h(Ae===x.l10n.amPM[1]));var pt=x.config.minTime!==void 0||x.config.minDate&&x.minDateHasTime&&x.latestSelectedDateObj&&R(x.latestSelectedDateObj,x.config.minDate,!0)===0;if(x.config.maxTime!==void 0||x.config.maxDate&&x.maxDateHasTime&&x.latestSelectedDateObj&&R(x.latestSelectedDateObj,x.config.maxDate,!0)===0){var Tt=x.config.maxTime!==void 0?x.config.maxTime:x.config.maxDate;(Ve=Math.min(Ve,Tt.getHours()))===Tt.getHours()&&(gt=Math.min(gt,Tt.getMinutes())),gt===Tt.getMinutes()&&(vt=Math.min(vt,Tt.getSeconds()))}if(pt){var Ot=x.config.minTime!==void 0?x.config.minTime:x.config.minDate;(Ve=Math.max(Ve,Ot.getHours()))===Ot.getHours()&&(gt=Math.max(gt,Ot.getMinutes())),gt===Ot.getMinutes()&&(vt=Math.max(vt,Ot.getSeconds()))}B(Ve,gt,vt)}}function ve(ze){var Ae=ze||x.latestSelectedDateObj;Ae&&B(Ae.getHours(),Ae.getMinutes(),Ae.getSeconds())}function U(){var ze=x.config.defaultHour,Ae=x.config.defaultMinute,Ve=x.config.defaultSeconds;if(x.config.minDate!==void 0){var gt=x.config.minDate.getHours(),vt=x.config.minDate.getMinutes();(ze=Math.max(ze,gt))===gt&&(Ae=Math.max(vt,Ae)),ze===gt&&Ae===vt&&(Ve=x.config.minDate.getSeconds())}if(x.config.maxDate!==void 0){var pt=x.config.maxDate.getHours(),Tt=x.config.maxDate.getMinutes();(ze=Math.min(ze,pt))===pt&&(Ae=Math.min(Tt,Ae)),ze===pt&&Ae===Tt&&(Ve=x.config.maxDate.getSeconds())}return{hours:ze,minutes:Ae,seconds:Ve}}function B(ze,Ae,Ve){x.latestSelectedDateObj!==void 0&&x.latestSelectedDateObj.setHours(ze%24,Ae,Ve||0,0),x.hourElement&&x.minuteElement&&!x.isMobile&&(x.hourElement.value=s(x.config.time_24hr?ze:(12+ze)%12+12*h(ze%12==0)),x.minuteElement.value=s(Ae),x.amPM!==void 0&&(x.amPM.textContent=x.l10n.amPM[h(ze>=12)]),x.secondElement!==void 0&&(x.secondElement.value=s(Ve)))}function le(ze){var Ae=k(ze),Ve=parseInt(Ae.value)+(ze.delta||0);(Ve/1e3>1||ze.key==="Enter"&&!/[^\d]/.test(Ve.toString()))&&ct(Ve)}function Te(ze,Ae,Ve,gt){return Ae instanceof Array?Ae.forEach(function(vt){return Te(ze,vt,Ve,gt)}):ze instanceof Array?ze.forEach(function(vt){return Te(vt,Ae,Ve,gt)}):(ze.addEventListener(Ae,Ve,gt),void x._handlers.push({element:ze,event:Ae,handler:Ve,options:gt}))}function ue(){Qt("onChange")}function be(ze,Ae){var Ve=ze!==void 0?x.parseDate(ze):x.latestSelectedDateObj||(x.config.minDate&&x.config.minDate>x.now?x.config.minDate:x.config.maxDate&&x.config.maxDate<x.now?x.config.maxDate:x.now),gt=x.currentYear,vt=x.currentMonth;try{Ve!==void 0&&(x.currentYear=Ve.getFullYear(),x.currentMonth=Ve.getMonth())}catch(pt){pt.message="Invalid date supplied: "+Ve,x.config.errorHandler(pt)}Ae&&x.currentYear!==gt&&(Qt("onYearChange"),We()),!Ae||x.currentYear===gt&&x.currentMonth===vt||Qt("onMonthChange"),x.redraw()}function ye(ze){var Ae=k(ze);~Ae.className.indexOf("arrow")&&ce(ze,Ae.classList.contains("arrowUp")?1:-1)}function ce(ze,Ae,Ve){var gt=ze&&k(ze),vt=Ve||gt&&gt.parentNode&&gt.parentNode.firstChild,pt=_t("increment");pt.delta=Ae,vt&&vt.dispatchEvent(pt)}function Re(ze,Ae,Ve,gt){var vt=bt(Ae,!0),pt=v("span","flatpickr-day "+ze,Ae.getDate().toString());return pt.dateObj=Ae,pt.$i=gt,pt.setAttribute("aria-label",x.formatDate(Ae,x.config.ariaDateFormat)),ze.indexOf("hidden")===-1&&R(Ae,x.now)===0&&(x.todayDateElem=pt,pt.classList.add("today"),pt.setAttribute("aria-current","date")),vt?(pt.tabIndex=-1,er(Ae)&&(pt.classList.add("selected"),x.selectedDateElem=pt,x.config.mode==="range"&&(g(pt,"startRange",x.selectedDates[0]&&R(Ae,x.selectedDates[0],!0)===0),g(pt,"endRange",x.selectedDates[1]&&R(Ae,x.selectedDates[1],!0)===0),ze==="nextMonthDay"&&pt.classList.add("inRange")))):pt.classList.add("flatpickr-disabled"),x.config.mode==="range"&&function(Tt){return!(x.config.mode!=="range"||x.selectedDates.length<2)&&R(Tt,x.selectedDates[0])>=0&&R(Tt,x.selectedDates[1])<=0}(Ae)&&!er(Ae)&&pt.classList.add("inRange"),x.weekNumbers&&x.config.showMonths===1&&ze!=="prevMonthDay"&&Ve%7==1&&x.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+x.config.getWeek(Ae)+"</span>"),Qt("onDayCreate",pt),pt}function pe(ze){ze.focus(),x.config.mode==="range"&&et(ze)}function me(ze){for(var Ae=ze>0?0:x.config.showMonths-1,Ve=ze>0?x.config.showMonths:-1,gt=Ae;gt!=Ve;gt+=ze)for(var vt=x.daysContainer.children[gt],pt=ze>0?0:vt.children.length-1,Tt=ze>0?vt.children.length:-1,Ot=pt;Ot!=Tt;Ot+=ze){var It=vt.children[Ot];if(It.className.indexOf("hidden")===-1&&bt(It.dateObj))return It}}function re(ze,Ae){var Ve=De(document.activeElement||document.body),gt=ze!==void 0?ze:Ve?document.activeElement:x.selectedDateElem!==void 0&&De(x.selectedDateElem)?x.selectedDateElem:x.todayDateElem!==void 0&&De(x.todayDateElem)?x.todayDateElem:me(Ae>0?1:-1);gt===void 0?x._input.focus():Ve?function(vt,pt){for(var Tt=vt.className.indexOf("Month")===-1?vt.dateObj.getMonth():x.currentMonth,Ot=pt>0?x.config.showMonths:-1,It=pt>0?1:-1,Lt=Tt-x.currentMonth;Lt!=Ot;Lt+=It)for(var At=x.daysContainer.children[Lt],or=Tt-x.currentMonth===Lt?vt.$i+pt:pt<0?At.children.length-1:0,Cr=At.children.length,Ar=or;Ar>=0&&Ar<Cr&&Ar!=(pt>0?Cr:-1);Ar+=It){var Rr=At.children[Ar];if(Rr.className.indexOf("hidden")===-1&&bt(Rr.dateObj)&&Math.abs(vt.$i-Ar)>=Math.abs(pt))return pe(Rr)}x.changeMonth(It),re(me(It),0)}(gt,Ae):pe(gt)}function _e(ze,Ae){for(var Ve=(new Date(ze,Ae,1).getDay()-x.l10n.firstDayOfWeek+7)%7,gt=x.utils.getDaysInMonth((Ae-1+12)%12,ze),vt=x.utils.getDaysInMonth(Ae,ze),pt=window.document.createDocumentFragment(),Tt=x.config.showMonths>1,Ot=Tt?"prevMonthDay hidden":"prevMonthDay",It=Tt?"nextMonthDay hidden":"nextMonthDay",Lt=gt+1-Ve,At=0;Lt<=gt;Lt++,At++)pt.appendChild(Re(Ot,new Date(ze,Ae-1,Lt),Lt,At));for(Lt=1;Lt<=vt;Lt++,At++)pt.appendChild(Re("",new Date(ze,Ae,Lt),Lt,At));for(var or=vt+1;or<=42-Ve&&(x.config.showMonths===1||At%7!=0);or++,At++)pt.appendChild(Re(It,new Date(ze,Ae+1,or%vt),or,At));var Cr=v("div","dayContainer");return Cr.appendChild(pt),Cr}function Ze(){if(x.daysContainer!==void 0){y(x.daysContainer),x.weekNumbers&&y(x.weekNumbers);for(var ze=document.createDocumentFragment(),Ae=0;Ae<x.config.showMonths;Ae++){var Ve=new Date(x.currentYear,x.currentMonth,1);Ve.setMonth(x.currentMonth+Ae),ze.appendChild(_e(Ve.getFullYear(),Ve.getMonth()))}x.daysContainer.appendChild(ze),x.days=x.daysContainer.firstChild,x.config.mode==="range"&&x.selectedDates.length===1&&et()}}function We(){if(!(x.config.showMonths>1||x.config.monthSelectorType!=="dropdown")){var ze=function(gt){return!(x.config.minDate!==void 0&&x.currentYear===x.config.minDate.getFullYear()&&gt<x.config.minDate.getMonth()||x.config.maxDate!==void 0&&x.currentYear===x.config.maxDate.getFullYear()&&gt>x.config.maxDate.getMonth())};x.monthsDropdownContainer.tabIndex=-1,x.monthsDropdownContainer.innerHTML="";for(var Ae=0;Ae<12;Ae++)if(ze(Ae)){var Ve=v("option","flatpickr-monthDropdown-month");Ve.value=new Date(x.currentYear,Ae).getMonth().toString(),Ve.textContent=_(Ae,x.config.shorthandCurrentMonth,x.l10n),Ve.tabIndex=-1,x.currentMonth===Ae&&(Ve.selected=!0),x.monthsDropdownContainer.appendChild(Ve)}}}function Xe(){var ze,Ae=v("div","flatpickr-month"),Ve=window.document.createDocumentFragment();x.config.showMonths>1||x.config.monthSelectorType==="static"?ze=v("span","cur-month"):(x.monthsDropdownContainer=v("select","flatpickr-monthDropdown-months"),x.monthsDropdownContainer.setAttribute("aria-label",x.l10n.monthAriaLabel),Te(x.monthsDropdownContainer,"change",function(Tt){var Ot=k(Tt),It=parseInt(Ot.value,10);x.changeMonth(It-x.currentMonth),Qt("onMonthChange")}),We(),ze=x.monthsDropdownContainer);var gt=b("cur-year",{tabindex:"-1"}),vt=gt.getElementsByTagName("input")[0];vt.setAttribute("aria-label",x.l10n.yearAriaLabel),x.config.minDate&&vt.setAttribute("min",x.config.minDate.getFullYear().toString()),x.config.maxDate&&(vt.setAttribute("max",x.config.maxDate.getFullYear().toString()),vt.disabled=!!x.config.minDate&&x.config.minDate.getFullYear()===x.config.maxDate.getFullYear());var pt=v("div","flatpickr-current-month");return pt.appendChild(ze),pt.appendChild(gt),Ve.appendChild(pt),Ae.appendChild(Ve),{container:Ae,yearElement:vt,monthElement:ze}}function Ue(){y(x.monthNav),x.monthNav.appendChild(x.prevMonthNav),x.config.showMonths&&(x.yearElements=[],x.monthElements=[]);for(var ze=x.config.showMonths;ze--;){var Ae=Xe();x.yearElements.push(Ae.yearElement),x.monthElements.push(Ae.monthElement),x.monthNav.appendChild(Ae.container)}x.monthNav.appendChild(x.nextMonthNav)}function mt(){x.weekdayContainer?y(x.weekdayContainer):x.weekdayContainer=v("div","flatpickr-weekdays");for(var ze=x.config.showMonths;ze--;){var Ae=v("div","flatpickr-weekdaycontainer");x.weekdayContainer.appendChild(Ae)}return St(),x.weekdayContainer}function St(){if(x.weekdayContainer){var ze=x.l10n.firstDayOfWeek,Ae=a(x.l10n.weekdays.shorthand);ze>0&&ze<Ae.length&&(Ae=a(Ae.splice(ze,Ae.length),Ae.splice(0,ze)));for(var Ve=x.config.showMonths;Ve--;)x.weekdayContainer.children[Ve].innerHTML=`
      <span class='flatpickr-weekday'>
        `+Ae.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function at(ze,Ae){Ae===void 0&&(Ae=!0);var Ve=Ae?ze:ze-x.currentMonth;Ve<0&&x._hidePrevMonthArrow===!0||Ve>0&&x._hideNextMonthArrow===!0||(x.currentMonth+=Ve,(x.currentMonth<0||x.currentMonth>11)&&(x.currentYear+=x.currentMonth>11?1:-1,x.currentMonth=(x.currentMonth+12)%12,Qt("onYearChange"),We()),Ze(),Qt("onMonthChange"),Kt())}function dt(ze){return!(!x.config.appendTo||!x.config.appendTo.contains(ze))||x.calendarContainer.contains(ze)}function wt(ze){if(x.isOpen&&!x.config.inline){var Ae=k(ze),Ve=dt(Ae),gt=Ae===x.input||Ae===x.altInput||x.element.contains(Ae)||ze.path&&ze.path.indexOf&&(~ze.path.indexOf(x.input)||~ze.path.indexOf(x.altInput)),vt=ze.type==="blur"?gt&&ze.relatedTarget&&!dt(ze.relatedTarget):!gt&&!Ve&&!dt(ze.relatedTarget),pt=!x.config.ignoredFocusElements.some(function(Tt){return Tt.contains(Ae)});vt&&pt&&(x.timeContainer!==void 0&&x.minuteElement!==void 0&&x.hourElement!==void 0&&x.input.value!==""&&x.input.value!==void 0&&ae(),x.close(),x.config&&x.config.mode==="range"&&x.selectedDates.length===1&&(x.clear(!1),x.redraw()))}}function ct(ze){if(!(!ze||x.config.minDate&&ze<x.config.minDate.getFullYear()||x.config.maxDate&&ze>x.config.maxDate.getFullYear())){var Ae=ze,Ve=x.currentYear!==Ae;x.currentYear=Ae||x.currentYear,x.config.maxDate&&x.currentYear===x.config.maxDate.getFullYear()?x.currentMonth=Math.min(x.config.maxDate.getMonth(),x.currentMonth):x.config.minDate&&x.currentYear===x.config.minDate.getFullYear()&&(x.currentMonth=Math.max(x.config.minDate.getMonth(),x.currentMonth)),Ve&&(x.redraw(),Qt("onYearChange"),We())}}function bt(ze,Ae){Ae===void 0&&(Ae=!0);var Ve=x.parseDate(ze,void 0,Ae);if(x.config.minDate&&Ve&&R(Ve,x.config.minDate,Ae!==void 0?Ae:!x.minDateHasTime)<0||x.config.maxDate&&Ve&&R(Ve,x.config.maxDate,Ae!==void 0?Ae:!x.maxDateHasTime)>0)return!1;if(x.config.enable.length===0&&x.config.disable.length===0)return!0;if(Ve===void 0)return!1;for(var gt=x.config.enable.length>0,vt=gt?x.config.enable:x.config.disable,pt=0,Tt=void 0;pt<vt.length;pt++){if(typeof(Tt=vt[pt])=="function"&&Tt(Ve)||Tt instanceof Date&&Ve!==void 0&&Tt.getTime()===Ve.getTime())return gt;if(typeof Tt=="string"&&Ve!==void 0){var Ot=x.parseDate(Tt,void 0,!0);return Ot&&Ot.getTime()===Ve.getTime()?gt:!gt}if(typeof Tt=="object"&&Ve!==void 0&&Tt.from&&Tt.to&&Ve.getTime()>=Tt.from.getTime()&&Ve.getTime()<=Tt.to.getTime())return gt}return!gt}function De(ze){return x.daysContainer!==void 0&&ze.className.indexOf("hidden")===-1&&ze.className.indexOf("flatpickr-disabled")===-1&&x.daysContainer.contains(ze)}function He(ze){ze.target!==x._input||ze.relatedTarget&&dt(ze.relatedTarget)||x.setDate(x._input.value,!0,ze.target===x.altInput?x.config.altFormat:x.config.dateFormat)}function Dt(ze){var Ae=k(ze),Ve=x.config.wrap?q.contains(Ae):Ae===x._input,gt=x.config.allowInput,vt=x.isOpen&&(!gt||!Ve),pt=x.config.inline&&Ve&&!gt;if(ze.keyCode===13&&Ve){if(gt)return x.setDate(x._input.value,!0,Ae===x.altInput?x.config.altFormat:x.config.dateFormat),Ae.blur();x.open()}else if(dt(Ae)||vt||pt){var Tt=!!x.timeContainer&&x.timeContainer.contains(Ae);switch(ze.keyCode){case 13:Tt?(ze.preventDefault(),ae(),rr()):nr(ze);break;case 27:ze.preventDefault(),rr();break;case 8:case 46:Ve&&!x.config.allowInput&&(ze.preventDefault(),x.clear());break;case 37:case 39:if(Tt||Ve)x.hourElement&&x.hourElement.focus();else if(ze.preventDefault(),x.daysContainer!==void 0&&(gt===!1||document.activeElement&&De(document.activeElement))){var Ot=ze.keyCode===39?1:-1;ze.ctrlKey?(ze.stopPropagation(),at(Ot),re(me(1),0)):re(void 0,Ot)}break;case 38:case 40:ze.preventDefault();var It=ze.keyCode===40?1:-1;x.daysContainer&&Ae.$i!==void 0||Ae===x.input||Ae===x.altInput?ze.ctrlKey?(ze.stopPropagation(),ct(x.currentYear-It),re(me(1),0)):Tt||re(void 0,7*It):Ae===x.currentYearElement?ct(x.currentYear-It):x.config.enableTime&&(!Tt&&x.hourElement&&x.hourElement.focus(),ae(ze),x._debouncedChange());break;case 9:if(Tt){var Lt=[x.hourElement,x.minuteElement,x.secondElement,x.amPM].concat(x.pluginElements).filter(function(Cr){return Cr}),At=Lt.indexOf(Ae);if(At!==-1){var or=Lt[At+(ze.shiftKey?-1:1)];ze.preventDefault(),(or||x._input).focus()}}else!x.config.noCalendar&&x.daysContainer&&x.daysContainer.contains(Ae)&&ze.shiftKey&&(ze.preventDefault(),x._input.focus())}}if(x.amPM!==void 0&&Ae===x.amPM)switch(ze.key){case x.l10n.amPM[0].charAt(0):case x.l10n.amPM[0].charAt(0).toLowerCase():x.amPM.textContent=x.l10n.amPM[0],de(),fr();break;case x.l10n.amPM[1].charAt(0):case x.l10n.amPM[1].charAt(0).toLowerCase():x.amPM.textContent=x.l10n.amPM[1],de(),fr()}(Ve||dt(Ae))&&Qt("onKeyDown",ze)}function et(ze){if(x.selectedDates.length===1&&(!ze||ze.classList.contains("flatpickr-day")&&!ze.classList.contains("flatpickr-disabled"))){for(var Ae=ze?ze.dateObj.getTime():x.days.firstElementChild.dateObj.getTime(),Ve=x.parseDate(x.selectedDates[0],void 0,!0).getTime(),gt=Math.min(Ae,x.selectedDates[0].getTime()),vt=Math.max(Ae,x.selectedDates[0].getTime()),pt=!1,Tt=0,Ot=0,It=gt;It<vt;It+=F)bt(new Date(It),!0)||(pt=pt||It>gt&&It<vt,It<Ve&&(!Tt||It>Tt)?Tt=It:It>Ve&&(!Ot||It<Ot)&&(Ot=It));for(var Lt=0;Lt<x.config.showMonths;Lt++)for(var At=x.daysContainer.children[Lt],or=function(Rr,Zr){var Tr,jr,ta,ia=At.children[Rr],Jr=ia.dateObj.getTime(),ba=Tt>0&&Jr<Tt||Ot>0&&Jr>Ot;return ba?(ia.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(Wr){ia.classList.remove(Wr)}),"continue"):pt&&!ba?"continue":(["startRange","inRange","endRange","notAllowed"].forEach(function(Wr){ia.classList.remove(Wr)}),void(ze!==void 0&&(ze.classList.add(Ae<=x.selectedDates[0].getTime()?"startRange":"endRange"),Ve<Ae&&Jr===Ve?ia.classList.add("startRange"):Ve>Ae&&Jr===Ve&&ia.classList.add("endRange"),Jr>=Tt&&(Ot===0||Jr<=Ot)&&(jr=Ve,ta=Ae,(Tr=Jr)>Math.min(jr,ta)&&Tr<Math.max(jr,ta))&&ia.classList.add("inRange"))))},Cr=0,Ar=At.children.length;Cr<Ar;Cr++)or(Cr)}}function ur(){!x.isOpen||x.config.static||x.config.inline||tr()}function Xt(ze){return function(Ae){var Ve=x.config["_"+ze+"Date"]=x.parseDate(Ae,x.config.dateFormat),gt=x.config["_"+(ze==="min"?"max":"min")+"Date"];Ve!==void 0&&(x[ze==="min"?"minDateHasTime":"maxDateHasTime"]=Ve.getHours()>0||Ve.getMinutes()>0||Ve.getSeconds()>0),x.selectedDates&&(x.selectedDates=x.selectedDates.filter(function(vt){return bt(vt)}),x.selectedDates.length||ze!=="min"||ve(Ve),fr()),x.daysContainer&&(xr(),Ve!==void 0?x.currentYearElement[ze]=Ve.getFullYear().toString():x.currentYearElement.removeAttribute(ze),x.currentYearElement.disabled=!!gt&&Ve!==void 0&&gt.getFullYear()===Ve.getFullYear())}}function jt(){return x.config.wrap?q.querySelector("[data-input]"):q}function lr(){typeof x.config.locale!="object"&&P.l10ns[x.config.locale]===void 0&&x.config.errorHandler(new Error("flatpickr: invalid locale "+x.config.locale)),x.l10n=t(t({},P.l10ns.default),typeof x.config.locale=="object"?x.config.locale:x.config.locale!=="default"?P.l10ns[x.config.locale]:void 0),A.K="("+x.l10n.amPM[0]+"|"+x.l10n.amPM[1]+"|"+x.l10n.amPM[0].toLowerCase()+"|"+x.l10n.amPM[1].toLowerCase()+")",t(t({},V),JSON.parse(JSON.stringify(q.dataset||{}))).time_24hr===void 0&&P.defaultConfig.time_24hr===void 0&&(x.config.time_24hr=x.l10n.time_24hr),x.formatDate=S(x),x.parseDate=E({config:x.config,l10n:x.l10n})}function tr(ze){if(x.calendarContainer!==void 0){Qt("onPreCalendarPosition");var Ae=ze||x._positionElement,Ve=Array.prototype.reduce.call(x.calendarContainer.children,function(Wr,Fr){return Wr+Fr.offsetHeight},0),gt=x.calendarContainer.offsetWidth,vt=x.config.position.split(" "),pt=vt[0],Tt=vt.length>1?vt[1]:null,Ot=Ae.getBoundingClientRect(),It=window.innerHeight-Ot.bottom,Lt=pt==="above"||pt!=="below"&&It<Ve&&Ot.top>Ve,At=window.pageYOffset+Ot.top+(Lt?-Ve-2:Ae.offsetHeight+2);if(g(x.calendarContainer,"arrowTop",!Lt),g(x.calendarContainer,"arrowBottom",Lt),!x.config.inline){var or=window.pageXOffset+Ot.left,Cr=!1,Ar=!1;Tt==="center"?(or-=(gt-Ot.width)/2,Cr=!0):Tt==="right"&&(or-=gt-Ot.width,Ar=!0),g(x.calendarContainer,"arrowLeft",!Cr&&!Ar),g(x.calendarContainer,"arrowCenter",Cr),g(x.calendarContainer,"arrowRight",Ar);var Rr=window.document.body.offsetWidth-(window.pageXOffset+Ot.right),Zr=or+gt>window.document.body.offsetWidth,Tr=Rr+gt>window.document.body.offsetWidth;if(g(x.calendarContainer,"rightMost",Zr),!x.config.static)if(x.calendarContainer.style.top=At+"px",Zr)if(Tr){var jr=function(){for(var Wr=null,Fr=0;Fr<document.styleSheets.length;Fr++){var oa=document.styleSheets[Fr];try{oa.cssRules}catch{continue}Wr=oa;break}return Wr??(Fa=document.createElement("style"),document.head.appendChild(Fa),Fa.sheet);var Fa}();if(jr===void 0)return;var ta=window.document.body.offsetWidth,ia=Math.max(0,ta/2-gt/2),Jr=jr.cssRules.length,ba="{left:"+Ot.left+"px;right:auto;}";g(x.calendarContainer,"rightMost",!1),g(x.calendarContainer,"centerMost",!0),jr.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+ba,Jr),x.calendarContainer.style.left=ia+"px",x.calendarContainer.style.right="auto"}else x.calendarContainer.style.left="auto",x.calendarContainer.style.right=Rr+"px";else x.calendarContainer.style.left=or+"px",x.calendarContainer.style.right="auto"}}}function xr(){x.config.noCalendar||x.isMobile||(We(),Kt(),Ze())}function rr(){x._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(x.close,0):x.close()}function nr(ze){ze.preventDefault(),ze.stopPropagation();var Ae=function Lt(At,or){return or(At)?At:At.parentNode?Lt(At.parentNode,or):void 0}(k(ze),function(Lt){return Lt.classList&&Lt.classList.contains("flatpickr-day")&&!Lt.classList.contains("flatpickr-disabled")&&!Lt.classList.contains("notAllowed")});if(Ae!==void 0){var Ve=Ae,gt=x.latestSelectedDateObj=new Date(Ve.dateObj.getTime()),vt=(gt.getMonth()<x.currentMonth||gt.getMonth()>x.currentMonth+x.config.showMonths-1)&&x.config.mode!=="range";if(x.selectedDateElem=Ve,x.config.mode==="single")x.selectedDates=[gt];else if(x.config.mode==="multiple"){var pt=er(gt);pt?x.selectedDates.splice(parseInt(pt),1):x.selectedDates.push(gt)}else x.config.mode==="range"&&(x.selectedDates.length===2&&x.clear(!1,!1),x.latestSelectedDateObj=gt,x.selectedDates.push(gt),R(gt,x.selectedDates[0],!0)!==0&&x.selectedDates.sort(function(Lt,At){return Lt.getTime()-At.getTime()}));if(de(),vt){var Tt=x.currentYear!==gt.getFullYear();x.currentYear=gt.getFullYear(),x.currentMonth=gt.getMonth(),Tt&&(Qt("onYearChange"),We()),Qt("onMonthChange")}if(Kt(),Ze(),fr(),vt||x.config.mode==="range"||x.config.showMonths!==1?x.selectedDateElem!==void 0&&x.hourElement===void 0&&x.selectedDateElem&&x.selectedDateElem.focus():pe(Ve),x.hourElement!==void 0&&x.hourElement!==void 0&&x.hourElement.focus(),x.config.closeOnSelect){var Ot=x.config.mode==="single"&&!x.config.enableTime,It=x.config.mode==="range"&&x.selectedDates.length===2&&!x.config.enableTime;(Ot||It)&&rr()}ue()}}x.parseDate=E({config:x.config,l10n:x.l10n}),x._handlers=[],x.pluginElements=[],x.loadedPlugins=[],x._bind=Te,x._setHoursFromDate=ve,x._positionCalendar=tr,x.changeMonth=at,x.changeYear=ct,x.clear=function(ze,Ae){if(ze===void 0&&(ze=!0),Ae===void 0&&(Ae=!0),x.input.value="",x.altInput!==void 0&&(x.altInput.value=""),x.mobileInput!==void 0&&(x.mobileInput.value=""),x.selectedDates=[],x.latestSelectedDateObj=void 0,Ae===!0&&(x.currentYear=x._initialDate.getFullYear(),x.currentMonth=x._initialDate.getMonth()),x.config.enableTime===!0){var Ve=U(),gt=Ve.hours,vt=Ve.minutes,pt=Ve.seconds;B(gt,vt,pt)}x.redraw(),ze&&Qt("onChange")},x.close=function(){x.isOpen=!1,x.isMobile||(x.calendarContainer!==void 0&&x.calendarContainer.classList.remove("open"),x._input!==void 0&&x._input.classList.remove("active")),Qt("onClose")},x._createElement=v,x.destroy=function(){x.config!==void 0&&Qt("onDestroy");for(var ze=x._handlers.length;ze--;){var Ae=x._handlers[ze];Ae.element.removeEventListener(Ae.event,Ae.handler,Ae.options)}if(x._handlers=[],x.mobileInput)x.mobileInput.parentNode&&x.mobileInput.parentNode.removeChild(x.mobileInput),x.mobileInput=void 0;else if(x.calendarContainer&&x.calendarContainer.parentNode)if(x.config.static&&x.calendarContainer.parentNode){var Ve=x.calendarContainer.parentNode;if(Ve.lastChild&&Ve.removeChild(Ve.lastChild),Ve.parentNode){for(;Ve.firstChild;)Ve.parentNode.insertBefore(Ve.firstChild,Ve);Ve.parentNode.removeChild(Ve)}}else x.calendarContainer.parentNode.removeChild(x.calendarContainer);x.altInput&&(x.input.type="text",x.altInput.parentNode&&x.altInput.parentNode.removeChild(x.altInput),delete x.altInput),x.input&&(x.input.type=x.input._type,x.input.classList.remove("flatpickr-input"),x.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(gt){try{delete x[gt]}catch{}})},x.isEnabled=bt,x.jumpToDate=be,x.open=function(ze,Ae){if(Ae===void 0&&(Ae=x._positionElement),x.isMobile===!0){if(ze){ze.preventDefault();var Ve=k(ze);Ve&&Ve.blur()}return x.mobileInput!==void 0&&(x.mobileInput.focus(),x.mobileInput.click()),void Qt("onOpen")}if(!x._input.disabled&&!x.config.inline){var gt=x.isOpen;x.isOpen=!0,gt||(x.calendarContainer.classList.add("open"),x._input.classList.add("active"),Qt("onOpen"),tr(Ae)),x.config.enableTime===!0&&x.config.noCalendar===!0&&(x.config.allowInput!==!1||ze!==void 0&&x.timeContainer.contains(ze.relatedTarget)||setTimeout(function(){return x.hourElement.select()},50))}},x.redraw=xr,x.set=function(ze,Ae){if(ze!==null&&typeof ze=="object")for(var Ve in Object.assign(x.config,ze),ze)Ut[Ve]!==void 0&&Ut[Ve].forEach(function(gt){return gt()});else x.config[ze]=Ae,Ut[ze]!==void 0?Ut[ze].forEach(function(gt){return gt()}):l.indexOf(ze)>-1&&(x.config[ze]=p(Ae));x.redraw(),fr(!0)},x.setDate=function(ze,Ae,Ve){if(Ae===void 0&&(Ae=!1),Ve===void 0&&(Ve=x.config.dateFormat),ze!==0&&!ze||ze instanceof Array&&ze.length===0)return x.clear(Ae);ar(ze,Ve),x.latestSelectedDateObj=x.selectedDates[x.selectedDates.length-1],x.redraw(),be(void 0,Ae),ve(),x.selectedDates.length===0&&x.clear(!1),fr(Ae),Ae&&Qt("onChange")},x.toggle=function(ze){if(x.isOpen===!0)return x.close();x.open(ze)};var Ut={locale:[lr,St],showMonths:[Ue,ne,mt],minDate:[be],maxDate:[be]};function ar(ze,Ae){var Ve=[];if(ze instanceof Array)Ve=ze.map(function(gt){return x.parseDate(gt,Ae)});else if(ze instanceof Date||typeof ze=="number")Ve=[x.parseDate(ze,Ae)];else if(typeof ze=="string")switch(x.config.mode){case"single":case"time":Ve=[x.parseDate(ze,Ae)];break;case"multiple":Ve=ze.split(x.config.conjunction).map(function(gt){return x.parseDate(gt,Ae)});break;case"range":Ve=ze.split(x.l10n.rangeSeparator).map(function(gt){return x.parseDate(gt,Ae)})}else x.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(ze)));x.selectedDates=x.config.allowInvalidPreload?Ve:Ve.filter(function(gt){return gt instanceof Date&&bt(gt,!1)}),x.config.mode==="range"&&x.selectedDates.sort(function(gt,vt){return gt.getTime()-vt.getTime()})}function Jt(ze){return ze.slice().map(function(Ae){return typeof Ae=="string"||typeof Ae=="number"||Ae instanceof Date?x.parseDate(Ae,void 0,!0):Ae&&typeof Ae=="object"&&Ae.from&&Ae.to?{from:x.parseDate(Ae.from,void 0),to:x.parseDate(Ae.to,void 0)}:Ae}).filter(function(Ae){return Ae})}function Qt(ze,Ae){if(x.config!==void 0){var Ve=x.config[ze];if(Ve!==void 0&&Ve.length>0)for(var gt=0;Ve[gt]&&gt<Ve.length;gt++)Ve[gt](x.selectedDates,x.input.value,x,Ae);ze==="onChange"&&(x.input.dispatchEvent(_t("change")),x.input.dispatchEvent(_t("input")))}}function _t(ze){var Ae=document.createEvent("Event");return Ae.initEvent(ze,!0,!0),Ae}function er(ze){for(var Ae=0;Ae<x.selectedDates.length;Ae++)if(R(x.selectedDates[Ae],ze)===0)return""+Ae;return!1}function Kt(){x.config.noCalendar||x.isMobile||!x.monthNav||(x.yearElements.forEach(function(ze,Ae){var Ve=new Date(x.currentYear,x.currentMonth,1);Ve.setMonth(x.currentMonth+Ae),x.config.showMonths>1||x.config.monthSelectorType==="static"?x.monthElements[Ae].textContent=_(Ve.getMonth(),x.config.shorthandCurrentMonth,x.l10n)+" ":x.monthsDropdownContainer.value=Ve.getMonth().toString(),ze.value=Ve.getFullYear().toString()}),x._hidePrevMonthArrow=x.config.minDate!==void 0&&(x.currentYear===x.config.minDate.getFullYear()?x.currentMonth<=x.config.minDate.getMonth():x.currentYear<x.config.minDate.getFullYear()),x._hideNextMonthArrow=x.config.maxDate!==void 0&&(x.currentYear===x.config.maxDate.getFullYear()?x.currentMonth+1>x.config.maxDate.getMonth():x.currentYear>x.config.maxDate.getFullYear()))}function mr(ze){return x.selectedDates.map(function(Ae){return x.formatDate(Ae,ze)}).filter(function(Ae,Ve,gt){return x.config.mode!=="range"||x.config.enableTime||gt.indexOf(Ae)===Ve}).join(x.config.mode!=="range"?x.config.conjunction:x.l10n.rangeSeparator)}function fr(ze){ze===void 0&&(ze=!0),x.mobileInput!==void 0&&x.mobileFormatStr&&(x.mobileInput.value=x.latestSelectedDateObj!==void 0?x.formatDate(x.latestSelectedDateObj,x.mobileFormatStr):""),x.input.value=mr(x.config.dateFormat),x.altInput!==void 0&&(x.altInput.value=mr(x.config.altFormat)),ze!==!1&&Qt("onValueUpdate")}function Wt(ze){var Ae=k(ze),Ve=x.prevMonthNav.contains(Ae),gt=x.nextMonthNav.contains(Ae);Ve||gt?at(Ve?-1:1):x.yearElements.indexOf(Ae)>=0?Ae.select():Ae.classList.contains("arrowUp")?x.changeYear(x.currentYear+1):Ae.classList.contains("arrowDown")&&x.changeYear(x.currentYear-1)}return function(){x.element=x.input=q,x.isOpen=!1,function(){var Ae=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],Ve=t(t({},JSON.parse(JSON.stringify(q.dataset||{}))),V),gt={};x.config.parseDate=Ve.parseDate,x.config.formatDate=Ve.formatDate,Object.defineProperty(x.config,"enable",{get:function(){return x.config._enable},set:function(or){x.config._enable=Jt(or)}}),Object.defineProperty(x.config,"disable",{get:function(){return x.config._disable},set:function(or){x.config._disable=Jt(or)}});var vt=Ve.mode==="time";if(!Ve.dateFormat&&(Ve.enableTime||vt)){var pt=P.defaultConfig.dateFormat||o.dateFormat;gt.dateFormat=Ve.noCalendar||vt?"H:i"+(Ve.enableSeconds?":S":""):pt+" H:i"+(Ve.enableSeconds?":S":"")}if(Ve.altInput&&(Ve.enableTime||vt)&&!Ve.altFormat){var Tt=P.defaultConfig.altFormat||o.altFormat;gt.altFormat=Ve.noCalendar||vt?"h:i"+(Ve.enableSeconds?":S K":" K"):Tt+" h:i"+(Ve.enableSeconds?":S":"")+" K"}Object.defineProperty(x.config,"minDate",{get:function(){return x.config._minDate},set:Xt("min")}),Object.defineProperty(x.config,"maxDate",{get:function(){return x.config._maxDate},set:Xt("max")});var Ot=function(or){return function(Cr){x.config[or==="min"?"_minTime":"_maxTime"]=x.parseDate(Cr,"H:i:S")}};Object.defineProperty(x.config,"minTime",{get:function(){return x.config._minTime},set:Ot("min")}),Object.defineProperty(x.config,"maxTime",{get:function(){return x.config._maxTime},set:Ot("max")}),Ve.mode==="time"&&(x.config.noCalendar=!0,x.config.enableTime=!0),Object.assign(x.config,gt,Ve);for(var It=0;It<Ae.length;It++)x.config[Ae[It]]=x.config[Ae[It]]===!0||x.config[Ae[It]]==="true";for(l.filter(function(or){return x.config[or]!==void 0}).forEach(function(or){x.config[or]=p(x.config[or]||[]).map(ee)}),x.isMobile=!x.config.disableMobile&&!x.config.inline&&x.config.mode==="single"&&!x.config.disable.length&&!x.config.enable.length&&!x.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),It=0;It<x.config.plugins.length;It++){var Lt=x.config.plugins[It](x)||{};for(var At in Lt)l.indexOf(At)>-1?x.config[At]=p(Lt[At]).map(ee).concat(x.config[At]):Ve[At]===void 0&&(x.config[At]=Lt[At])}Ve.altInputClass||(x.config.altInputClass=jt().className+" "+x.config.altInputClass),Qt("onParseConfig")}(),lr(),x.input=jt(),x.input?(x.input._type=x.input.type,x.input.type="text",x.input.classList.add("flatpickr-input"),x._input=x.input,x.config.altInput&&(x.altInput=v(x.input.nodeName,x.config.altInputClass),x._input=x.altInput,x.altInput.placeholder=x.input.placeholder,x.altInput.disabled=x.input.disabled,x.altInput.required=x.input.required,x.altInput.tabIndex=x.input.tabIndex,x.altInput.type="text",x.input.setAttribute("type","hidden"),!x.config.static&&x.input.parentNode&&x.input.parentNode.insertBefore(x.altInput,x.input.nextSibling)),x.config.allowInput||x._input.setAttribute("readonly","readonly"),x._positionElement=x.config.positionElement||x._input):x.config.errorHandler(new Error("Invalid input element specified")),function(){x.selectedDates=[],x.now=x.parseDate(x.config.now)||new Date;var Ae=x.config.defaultDate||(x.input.nodeName!=="INPUT"&&x.input.nodeName!=="TEXTAREA"||!x.input.placeholder||x.input.value!==x.input.placeholder?x.input.value:null);Ae&&ar(Ae,x.config.dateFormat),x._initialDate=x.selectedDates.length>0?x.selectedDates[0]:x.config.minDate&&x.config.minDate.getTime()>x.now.getTime()?x.config.minDate:x.config.maxDate&&x.config.maxDate.getTime()<x.now.getTime()?x.config.maxDate:x.now,x.currentYear=x._initialDate.getFullYear(),x.currentMonth=x._initialDate.getMonth(),x.selectedDates.length>0&&(x.latestSelectedDateObj=x.selectedDates[0]),x.config.minTime!==void 0&&(x.config.minTime=x.parseDate(x.config.minTime,"H:i")),x.config.maxTime!==void 0&&(x.config.maxTime=x.parseDate(x.config.maxTime,"H:i")),x.minDateHasTime=!!x.config.minDate&&(x.config.minDate.getHours()>0||x.config.minDate.getMinutes()>0||x.config.minDate.getSeconds()>0),x.maxDateHasTime=!!x.config.maxDate&&(x.config.maxDate.getHours()>0||x.config.maxDate.getMinutes()>0||x.config.maxDate.getSeconds()>0)}(),x.utils={getDaysInMonth:function(Ae,Ve){return Ae===void 0&&(Ae=x.currentMonth),Ve===void 0&&(Ve=x.currentYear),Ae===1&&(Ve%4==0&&Ve%100!=0||Ve%400==0)?29:x.l10n.daysInMonth[Ae]}},x.isMobile||function(){var Ae=window.document.createDocumentFragment();if(x.calendarContainer=v("div","flatpickr-calendar"),x.calendarContainer.tabIndex=-1,!x.config.noCalendar){if(Ae.appendChild((x.monthNav=v("div","flatpickr-months"),x.yearElements=[],x.monthElements=[],x.prevMonthNav=v("span","flatpickr-prev-month"),x.prevMonthNav.innerHTML=x.config.prevArrow,x.nextMonthNav=v("span","flatpickr-next-month"),x.nextMonthNav.innerHTML=x.config.nextArrow,Ue(),Object.defineProperty(x,"_hidePrevMonthArrow",{get:function(){return x.__hidePrevMonthArrow},set:function(Ot){x.__hidePrevMonthArrow!==Ot&&(g(x.prevMonthNav,"flatpickr-disabled",Ot),x.__hidePrevMonthArrow=Ot)}}),Object.defineProperty(x,"_hideNextMonthArrow",{get:function(){return x.__hideNextMonthArrow},set:function(Ot){x.__hideNextMonthArrow!==Ot&&(g(x.nextMonthNav,"flatpickr-disabled",Ot),x.__hideNextMonthArrow=Ot)}}),x.currentYearElement=x.yearElements[0],Kt(),x.monthNav)),x.innerContainer=v("div","flatpickr-innerContainer"),x.config.weekNumbers){var Ve=function(){x.calendarContainer.classList.add("hasWeeks");var Ot=v("div","flatpickr-weekwrapper");Ot.appendChild(v("span","flatpickr-weekday",x.l10n.weekAbbreviation));var It=v("div","flatpickr-weeks");return Ot.appendChild(It),{weekWrapper:Ot,weekNumbers:It}}(),gt=Ve.weekWrapper,vt=Ve.weekNumbers;x.innerContainer.appendChild(gt),x.weekNumbers=vt,x.weekWrapper=gt}x.rContainer=v("div","flatpickr-rContainer"),x.rContainer.appendChild(mt()),x.daysContainer||(x.daysContainer=v("div","flatpickr-days"),x.daysContainer.tabIndex=-1),Ze(),x.rContainer.appendChild(x.daysContainer),x.innerContainer.appendChild(x.rContainer),Ae.appendChild(x.innerContainer)}x.config.enableTime&&Ae.appendChild(function(){x.calendarContainer.classList.add("hasTime"),x.config.noCalendar&&x.calendarContainer.classList.add("noCalendar"),x.timeContainer=v("div","flatpickr-time"),x.timeContainer.tabIndex=-1;var Ot=v("span","flatpickr-time-separator",":"),It=b("flatpickr-hour",{"aria-label":x.l10n.hourAriaLabel});x.hourElement=It.getElementsByTagName("input")[0];var Lt=b("flatpickr-minute",{"aria-label":x.l10n.minuteAriaLabel});if(x.minuteElement=Lt.getElementsByTagName("input")[0],x.hourElement.tabIndex=x.minuteElement.tabIndex=-1,x.hourElement.value=s(x.latestSelectedDateObj?x.latestSelectedDateObj.getHours():x.config.time_24hr?x.config.defaultHour:function(or){switch(or%24){case 0:case 12:return 12;default:return or%12}}(x.config.defaultHour)),x.minuteElement.value=s(x.latestSelectedDateObj?x.latestSelectedDateObj.getMinutes():x.config.defaultMinute),x.hourElement.setAttribute("step",x.config.hourIncrement.toString()),x.minuteElement.setAttribute("step",x.config.minuteIncrement.toString()),x.hourElement.setAttribute("min",x.config.time_24hr?"0":"1"),x.hourElement.setAttribute("max",x.config.time_24hr?"23":"12"),x.minuteElement.setAttribute("min","0"),x.minuteElement.setAttribute("max","59"),x.timeContainer.appendChild(It),x.timeContainer.appendChild(Ot),x.timeContainer.appendChild(Lt),x.config.time_24hr&&x.timeContainer.classList.add("time24hr"),x.config.enableSeconds){x.timeContainer.classList.add("hasSeconds");var At=b("flatpickr-second");x.secondElement=At.getElementsByTagName("input")[0],x.secondElement.value=s(x.latestSelectedDateObj?x.latestSelectedDateObj.getSeconds():x.config.defaultSeconds),x.secondElement.setAttribute("step",x.minuteElement.getAttribute("step")),x.secondElement.setAttribute("min","0"),x.secondElement.setAttribute("max","59"),x.timeContainer.appendChild(v("span","flatpickr-time-separator",":")),x.timeContainer.appendChild(At)}return x.config.time_24hr||(x.amPM=v("span","flatpickr-am-pm",x.l10n.amPM[h((x.latestSelectedDateObj?x.hourElement.value:x.config.defaultHour)>11)]),x.amPM.title=x.l10n.toggleTitle,x.amPM.tabIndex=-1,x.timeContainer.appendChild(x.amPM)),x.timeContainer}()),g(x.calendarContainer,"rangeMode",x.config.mode==="range"),g(x.calendarContainer,"animate",x.config.animate===!0),g(x.calendarContainer,"multiMonth",x.config.showMonths>1),x.calendarContainer.appendChild(Ae);var pt=x.config.appendTo!==void 0&&x.config.appendTo.nodeType!==void 0;if((x.config.inline||x.config.static)&&(x.calendarContainer.classList.add(x.config.inline?"inline":"static"),x.config.inline&&(!pt&&x.element.parentNode?x.element.parentNode.insertBefore(x.calendarContainer,x._input.nextSibling):x.config.appendTo!==void 0&&x.config.appendTo.appendChild(x.calendarContainer)),x.config.static)){var Tt=v("div","flatpickr-wrapper");x.element.parentNode&&x.element.parentNode.insertBefore(Tt,x.element),Tt.appendChild(x.element),x.altInput&&Tt.appendChild(x.altInput),Tt.appendChild(x.calendarContainer)}x.config.static||x.config.inline||(x.config.appendTo!==void 0?x.config.appendTo:window.document.body).appendChild(x.calendarContainer)}(),function(){if(x.config.wrap&&["open","close","toggle","clear"].forEach(function(Ve){Array.prototype.forEach.call(x.element.querySelectorAll("[data-"+Ve+"]"),function(gt){return Te(gt,"click",x[Ve])})}),x.isMobile)(function(){var Ve=x.config.enableTime?x.config.noCalendar?"time":"datetime-local":"date";x.mobileInput=v("input",x.input.className+" flatpickr-mobile"),x.mobileInput.tabIndex=1,x.mobileInput.type=Ve,x.mobileInput.disabled=x.input.disabled,x.mobileInput.required=x.input.required,x.mobileInput.placeholder=x.input.placeholder,x.mobileFormatStr=Ve==="datetime-local"?"Y-m-d\\TH:i:S":Ve==="date"?"Y-m-d":"H:i:S",x.selectedDates.length>0&&(x.mobileInput.defaultValue=x.mobileInput.value=x.formatDate(x.selectedDates[0],x.mobileFormatStr)),x.config.minDate&&(x.mobileInput.min=x.formatDate(x.config.minDate,"Y-m-d")),x.config.maxDate&&(x.mobileInput.max=x.formatDate(x.config.maxDate,"Y-m-d")),x.input.getAttribute("step")&&(x.mobileInput.step=String(x.input.getAttribute("step"))),x.input.type="hidden",x.altInput!==void 0&&(x.altInput.type="hidden");try{x.input.parentNode&&x.input.parentNode.insertBefore(x.mobileInput,x.input.nextSibling)}catch{}Te(x.mobileInput,"change",function(gt){x.setDate(k(gt).value,!1,x.mobileFormatStr),Qt("onChange"),Qt("onClose")})})();else{var Ae=f(ur,50);x._debouncedChange=f(ue,300),x.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&Te(x.daysContainer,"mouseover",function(Ve){x.config.mode==="range"&&et(k(Ve))}),Te(window.document.body,"keydown",Dt),x.config.inline||x.config.static||Te(window,"resize",Ae),window.ontouchstart!==void 0?Te(window.document,"touchstart",wt):Te(window.document,"click",wt),Te(window.document,"focus",wt,{capture:!0}),x.config.clickOpens===!0&&(Te(x._input,"focus",x.open),Te(x._input,"click",x.open)),x.daysContainer!==void 0&&(Te(x.monthNav,"click",Wt),Te(x.monthNav,["keyup","increment"],le),Te(x.daysContainer,"click",nr)),x.timeContainer!==void 0&&x.minuteElement!==void 0&&x.hourElement!==void 0&&(Te(x.timeContainer,["increment"],ae),Te(x.timeContainer,"blur",ae,{capture:!0}),Te(x.timeContainer,"click",ye),Te([x.hourElement,x.minuteElement],["focus","click"],function(Ve){return k(Ve).select()}),x.secondElement!==void 0&&Te(x.secondElement,"focus",function(){return x.secondElement&&x.secondElement.select()}),x.amPM!==void 0&&Te(x.amPM,"click",function(Ve){ae(Ve),ue()})),x.config.allowInput&&Te(x._input,"blur",He)}}(),(x.selectedDates.length||x.config.noCalendar)&&(x.config.enableTime&&ve(x.config.noCalendar?x.latestSelectedDateObj||x.config.minDate:void 0),fr(!1)),ne();var ze=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!x.isMobile&&ze&&tr(),Qt("onReady")}(),x}function z(q,V){for(var x=Array.prototype.slice.call(q).filter(function(de){return de instanceof HTMLElement}),ee=[],ne=0;ne<x.length;ne++){var ae=x[ne];try{if(ae.getAttribute("data-fp-omit")!==null)continue;ae._flatpickr!==void 0&&(ae._flatpickr.destroy(),ae._flatpickr=void 0),ae._flatpickr=N(ae,V||{}),ee.push(ae._flatpickr)}catch(de){console.error(de)}}return ee.length===1?ee[0]:ee}typeof Object.assign!="function"&&(Object.assign=function(q){for(var V=[],x=1;x<arguments.length;x++)V[x-1]=arguments[x];if(!q)throw TypeError("Cannot convert undefined or null to object");for(var ee=function(ve){ve&&Object.keys(ve).forEach(function(U){return q[U]=ve[U]})},ne=0,ae=V;ne<ae.length;ne++){var de=ae[ne];ee(de)}return q}),typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(q){return z(this,q)},HTMLElement.prototype.flatpickr=function(q){return z([this],q)});var P=function(q,V){return typeof q=="string"?z(window.document.querySelectorAll(q),V):q instanceof Node?z([q],V):z(q,V)};return P.defaultConfig={},P.l10ns={en:t({},d),default:t({},d)},P.localize=function(q){P.l10ns.default=t(t({},P.l10ns.default),q)},P.setDefaults=function(q){P.defaultConfig=t(t({},P.defaultConfig),q)},P.parseDate=E({}),P.formatDate=S({}),P.compareDates=R,typeof jQuery<"u"&&jQuery.fn!==void 0&&(jQuery.fn.flatpickr=function(q){return z(this,q)}),Date.prototype.fp_incr=function(q){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof q=="string"?parseInt(q,10):q))},typeof window<"u"&&(window.flatpickr=P),P}()}),Ub=Math.sign||function(e){return(e=+e)==0||e!=e?e:e<0?-1:1},Hb=Math.abs,jb=Math.pow;function gd(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"redo";if(e!=null){var t=e.data;n=="undo"&&(t=e.curdata);for(var a=0;a<e.range.length;a++)for(var l=e.range[a].row[0],o=e.range[a].row[1],d=e.range[a].column[0],s=e.range[a].column[1],h=l;h<o+1;h++)for(var f=d;f<s+1&&!(h>t.length-1);f++)t[h][f]==null||t[h][f].f==null||t[h][f].f==""?m.delFunctionGroup(h,f,e.sheetIndex):t[h][f]!=null&&t[h][f].f!=null&&t[h][f].f.length>0&&m.insertUpdateFunctionGroup(h,f,e.sheetIndex)}}Ce({target:"Math",stat:!0},{cbrt:function(e){return Ub(e=+e)*jb(Hb(e),1/3)}});var im=function(e){if(u.jfredo.length!=0){var n=u.jfredo.pop();if(u.jfundo.push(n),u.clearjfundo=!1,ir.hasSheet(n.sheetIndex)&&u.currentSheetIndex!=n.sheetIndex&&ir.changeSheetExec(n.sheetIndex),n.type=="datachange"){gd(n);var t={cfg:n.config,RowlChange:n.RowlChange,cdformat:n.cdformat,dataVerification:n.dataVerification,dynamicArray:n.dynamicArray};wa(n.data,n.range,t)}else if(n.type=="pasteCut")rm({sheetIndex:n.source.sheetIndex,data:n.source.curData,curData:n.source.data,config:n.source.curConfig,curConfig:n.source.config,cdformat:n.source.curCdformat,curCdformat:n.source.cdformat,dataVerification:n.source.curDataVerification,curDataVerification:n.source.dataVerification,range:n.source.range},{sheetIndex:n.target.sheetIndex,data:n.target.curData,curData:n.target.data,config:n.target.curConfig,curConfig:n.target.config,cdformat:n.target.curCdformat,curCdformat:n.target.cdformat,dataVerification:n.target.curDataVerification,curDataVerification:n.target.dataVerification,range:n.target.range},n.RowlChange);else if(n.type=="rangechange")gd(n),md(n.data,n.range,n.cdformat);else if(n.type=="resize"){u.config=n.config,u.luckysheetfile[je(n.sheetIndex)].config=u.config,n.ctrlType=="resizeR"?nt.saveParam("cg",n.sheetIndex,n.config.rowlen,{k:"rowlen"}):n.ctrlType=="resizeC"&&nt.saveParam("cg",n.sheetIndex,n.config.columnlen,{k:"columnlen"});var a=$.extend(!0,{},n.images);u.luckysheetfile[je(n.sheetIndex)].images=a,nt.saveParam("all",n.sheetIndex,a,{k:"images"}),_r.images=a,_r.allImagesShow(),ln(u.flowdata.length,u.flowdata[0].length)}else if(n.type=="cellRowChange")Ni(n.data[0].length,n.data.length,n.data,n.config,n.range,n.ctrlType,n.ctrlValue,n.cdformat);else if(n.type=="extend")Ni(n.data[0].length,n.data.length,n.data,n.config,n.range,"dele",n.ctrlValue);else if(n.type=="dele"){var l=$.extend(!0,{},n.ctrlValue);l.restore=!0,Ni(n.data[0].length,n.data.length,n.data,n.config,n.range,"extend",l)}else if(n.type=="addRC"){var o=$.extend(!0,{},n.ctrlValue);o.direction=="rightbottom"&&(o.index=o.index+1),wu(n.data,n.config,"delRC",o,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="delRC"){var d=$.extend(!0,{},n.ctrlValue);d.restore=!0,d.direction="lefttop",wu(n.data,n.config,"addRC",d,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="deleteCell")tm(n.data,n.config,n.ctrl,n.calc,n.filterObj,n.cf,n.dataVerification,n.hyperlink);else if(n.type=="showHidRows")u.config=n.config,u.luckysheetfile[je(n.sheetIndex)].config=n.config,nt.saveParam("cg",n.sheetIndex,n.config.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length);else if(n.type=="showHidCols")u.config=n.config,u.luckysheetfile[je(n.sheetIndex)].config=n.config,nt.saveParam("cg",n.sheetIndex,n.config.colhidden,{k:"colhidden"}),ln(u.flowdata.length,u.flowdata[0].length);else if(n.type=="datachangeAll")m.execFunctionGroup(),Ni(n.data[0].length,n.data.length,n.data,null,n.range,"datachangeAll",n.ctrlValue);else if(n.type=="datachangeAll_filter_clear")gi(n.filter_save),$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").each(function(z){var P=$(this),q=n.optiongroups[z];pu(P,q.optionstate,q.rowhidden,q.caljs,!1,q.st_r,q.ed_r,q.cindex,q.st_c,q.ed_c)}),nt.saveParam("fsr",u.currentSheetIndex,{filter:n.optiongroups,filter_select:n.filter_save}),u.config=n.config,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,u.config.rowhidden==null&&(u.config.rowhidden={}),nt.saveParam("cg",u.currentSheetIndex,u.config.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(n.type=="datachangeAll_filter"){var s=$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").eq(n.optionsindex),h=s.data("str"),f=s.data("edr"),p=s.data("cindex"),g=s.data("stc"),v=s.data("edc");pu(s,fu.hasKey(n.rowhidenPre),n.rowhidenPre,n.caljs,!0,h,f,p,g,v),u.config=n.config,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,u.config.rowhidden==null&&(u.config.rowhidden={}),nt.saveParam("cg",u.currentSheetIndex,u.config.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(n.type=="filtershow")$("#luckysheet-filter-selected-sheet"+n.sheetIndex+", #luckysheet-filter-options-sheet"+n.sheetIndex).remove(),nt.allowUpdate&&nt.saveParam("all",n.sheetIndex,null,{k:"filter_select"});else if(n.type=="pivotTable_change")u.luckysheetfile[je(n.sheetIndex)].pivotTable=n.pivotTable,Pr.getCellData(n.sheetIndex),Pr.initialPivotManage(!0),Pr.refreshPivotTable();else if(n.type=="addSheet")ir.deleteSheet(n.index),ir.changeSheetExec(n.currentSheetIndex),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(n.type=="copySheet")ir.deleteSheet(n.index),ir.changeSheetExec(n.copyindex);else if(n.type=="deleteSheet"){for(var y=!1,b=0;b<u.luckysheetfile.length;b++)u.luckysheetfile[b].name==n.name&&(y=!0);y||(ir.createSheetbydata(n,"isrenew"),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}else if(n.type=="sheetName")u.luckysheetfile[je(n.sheetIndex)].name=n.oldtxt,$("#luckysheet-sheets-item"+n.sheetIndex).find(".luckysheet-sheets-item-name").html(n.oldtxt),nt.saveParam("all",n.sheetIndex,n.oldtxt,{k:"name"});else if(n.type=="sheetColor"){u.luckysheetfile[je(n.sheetIndex)].color=n.oldcolor;var k=$("#luckysheet-sheets-item"+n.sheetIndex);k.find(".luckysheet-sheets-item-color").remove(),n.oldcolor!=null&&k.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+n.oldcolor+';"></div>'),nt.saveParam("all",n.sheetIndex,n.oldcolor,{k:"color"})}else if(n.type=="mergeChange"){var w={cfg:n.config};wa(n.data,n.range,w)}else if(n.type=="updateDataVerification")aa.ref(n.currentDataVerification,n.historyDataVerification,n.sheetIndex);else if(n.type=="updateDataVerificationOfCheckbox")aa.refOfCheckbox(n.currentDataVerification,n.historyDataVerification,n.sheetIndex,n.data,n.range);else if(n.type=="updateHyperlink")Jl.ref(n.currentHyperlink,n.historyHyperlink,n.sheetIndex,n.data,n.range);else if(n.type=="updateCF"){for(var _=n.data.historyRules,C=0;C<_.length;C++){var A=_[C].sheetIndex;u.luckysheetfile[je(A)].luckysheet_conditionformat_save=_[C].luckysheet_conditionformat_save,nt.allowUpdate&&nt.saveParam("all",A,_[C].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}kr.ref()}else if(n.type=="updateAF"){var I=n.data.historyRules,S=je(n.sheetIndex);u.luckysheetfile[S].luckysheet_alternateformat_save=$.extend(!0,[],I),setTimeout(function(){Kr()},1)}else if(n.type=="borderChange")n.config.borderInfo==null?nt.saveParam("cg",n.sheetIndex,[],{k:"borderInfo"}):nt.saveParam("cg",n.sheetIndex,n.config.borderInfo,{k:"borderInfo"}),u.config=n.config,u.luckysheetfile[je(n.sheetIndex)].config=u.config,setTimeout(function(){Kr()},1);else if(n.type=="postil"){Lr.ref(n.data,n.rc);for(var E=0;E<n.rc.length;E++){var R=n.rc[E].split("_")[0],F=n.rc[E].split("_")[1];n.data[R][F]!=null&&n.data[R][F].ps!=null?Lr.buildPs(R,F,n.data[R][F].ps):Lr.buildPs(R,F,null)}}else n.type=="imageCtrl"?(_r.images=$.extend(!0,{},n.images),_r.allImagesShow(),_r.ref()):n.type=="zoomChange"&&(u.zoomRatio=n.zoomRatio,nt.saveParam("all",n.currentSheetIndex,n.zoomRatio,{k:"zoomRatio"}),Co(),pd());bl(e),n.range&&(u.luckysheet_select_save=n.range,Ra()),u.clearjfundo=!0,mm();var N=Dr(Dr({},n),{data:n.curdata,curdata:n.data});Ya.createHookFunction("updated",N)}},om=function(){if(u.jfundo.length!=0){var e=u.jfundo.pop();if(u.jfredo.push(e),u.clearjfundo=!1,ir.hasSheet(e.sheetIndex)&&u.currentSheetIndex!=e.sheetIndex&&ir.changeSheetExec(e.sheetIndex),e.type=="datachange"){m.execFunctionGroup();var n={cfg:e.curConfig,RowlChange:e.RowlChange,cdformat:e.curCdformat,dataVerification:e.curDataVerification,dynamicArray:e.curDynamicArray};gd(e,"undo"),wa(e.curdata,e.range,n)}else if(e.type=="pasteCut")rm(e.source,e.target,e.RowlChange);else if(e.type=="rangechange")gd(e,"undo"),md(e.curdata,e.range,e.curCdformat);else if(e.type=="resize"){u.config=e.curconfig,u.luckysheetfile[je(e.sheetIndex)].config=u.config,e.ctrlType=="resizeR"?nt.saveParam("cg",e.sheetIndex,e.curconfig.rowlen,{k:"rowlen"}):e.ctrlType=="resizeC"&&nt.saveParam("cg",e.sheetIndex,e.curconfig.columnlen,{k:"columnlen"});var t=$.extend(!0,{},e.curImages);u.luckysheetfile[je(e.sheetIndex)].images=t,nt.saveParam("all",e.sheetIndex,t,{k:"images"}),_r.images=t,_r.allImagesShow(),ln(u.flowdata.length,u.flowdata[0].length)}else if(e.type=="cellRowChange")Ni(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue,e.curCdformat);else if(e.type=="extend")Ni(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue);else if(e.type=="dele")$.extend(!0,{},e.ctrlValue).restore=!0,Ni(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue);else if(e.type=="addRC")wu(e.curData,e.curConfig,"addRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="delRC")wu(e.curData,e.curConfig,"delRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="deleteCell")tm(e.curData,e.curConfig,e.ctrl,e.curCalc,e.curFilterObj,e.curCf,e.curDataVerification,e.curHyperlink);else if(e.type=="showHidRows")u.config=e.curconfig,u.luckysheetfile[je(e.sheetIndex)].config=e.curconfig,nt.saveParam("cg",e.sheetIndex,e.curconfig.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length);else if(e.type=="showHidCols")u.config=e.curconfig,u.luckysheetfile[je(e.sheetIndex)].config=e.curconfig,nt.saveParam("cg",e.sheetIndex,e.curconfig.colhidden,{k:"colhidden"}),ln(u.flowdata.length,u.flowdata[0].length);else if(e.type=="datachangeAll")m.execFunctionGroup(),Ni(e.curdata[0].length,e.curdata.length,e.curdata,null,e.currange,"datachangeAll",e.ctrlValue);else if(e.type=="datachangeAll_filter_clear")nt.saveParam("fsc",u.currentSheetIndex,null),u.config=e.curconfig,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,{},{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(""),$("#luckysheet-filter-selected-sheet"+u.currentSheetIndex+", #luckysheet-filter-options-sheet"+u.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(e.type=="datachangeAll_filter"){var a=$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").eq(e.optionsindex),l=a.data("str"),o=a.data("edr"),d=a.data("cindex"),s=a.data("stc"),h=a.data("edc");pu(a,fu.hasKey(e.rowhidden),e.rowhidden,e.caljs,!0,l,o,d,s,h),u.config=e.curconfig,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,u.config.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(e.type=="filtershow")u.luckysheet_select_save=[e.filter_save],u.filterchage=!1,Bh(),u.filterchage=!0,nt.saveParam("all",e.sheetIndex,e.filter_save,{k:"filter_select"});else if(e.type=="pivotTable_change")u.luckysheetfile[je(e.sheetIndex)].pivotTable=e.pivotTablecur,Pr.getCellData(e.sheetIndex),Pr.initialPivotManage(!0),Pr.refreshPivotTable();else if(e.type=="addSheet")ir.createSheetbydata(e.sheetconfig),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="copySheet")ir.copySheet(e.copyindex);else if(e.type=="deleteSheet")ir.deleteSheet(e.index),e.order==0?ir.changeSheetExec(u.luckysheetfile[0].index):ir.changeSheetExec(u.luckysheetfile[e.order-1].index),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="sheetName")u.luckysheetfile[je(e.sheetIndex)].name=e.txt,$("#luckysheet-sheets-item"+e.sheetIndex).find(".luckysheet-sheets-item-name").html(e.txt),nt.saveParam("all",e.sheetIndex,e.txt,{k:"name"});else if(e.type=="sheetColor"){u.luckysheetfile[je(e.sheetIndex)].color=e.color;var f=$("#luckysheet-sheets-item"+e.sheetIndex);f.find(".luckysheet-sheets-item-color").remove(),e.color!=null&&f.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),nt.saveParam("all",e.sheetIndex,e.color,{k:"color"})}else if(e.type=="mergeChange"){var p={cfg:e.curConfig};wa(e.curData,e.range,p)}else if(e.type=="updateDataVerification")aa.ref(e.historyDataVerification,e.currentDataVerification,e.sheetIndex);else if(e.type=="updateDataVerificationOfCheckbox")aa.refOfCheckbox(e.historyDataVerification,e.currentDataVerification,e.sheetIndex,e.curData,e.range);else if(e.type=="updateHyperlink")Jl.ref(e.historyHyperlink,e.currentHyperlink,e.sheetIndex,e.curData,e.range);else if(e.type=="updateCF"){for(var g=e.data.currentRules,v=0;v<g.length;v++){var y=g[v].sheetIndex;u.luckysheetfile[je(y)].luckysheet_conditionformat_save=g[v].luckysheet_conditionformat_save,nt.allowUpdate&&nt.saveParam("all",y,g[v].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}kr.ref()}else if(e.type=="updateAF"){var b=e.data.currentRules,k=je(e.sheetIndex);u.luckysheetfile[k].luckysheet_alternateformat_save=$.extend(!0,[],b),setTimeout(function(){Kr()},1)}else if(e.type=="borderChange")nt.saveParam("cg",e.sheetIndex,e.curconfig.borderInfo,{k:"borderInfo"}),u.config=e.curconfig,u.luckysheetfile[je(e.sheetIndex)].config=u.config,setTimeout(function(){Kr()},1);else if(e.type=="postil"){Lr.ref(e.curdata,e.rc);for(var w=0;w<e.rc.length;w++){var _=e.rc[w].split("_")[0],C=e.rc[w].split("_")[1];e.curdata[_][C]!=null&&e.curdata[_][C].ps!=null?Lr.buildPs(_,C,e.curdata[_][C].ps):Lr.buildPs(_,C,null)}}else e.type=="imageCtrl"?(_r.images=$.extend(!0,{},e.curImages),_r.allImagesShow(),_r.ref()):e.type=="zoomChange"&&(u.zoomRatio=e.curZoomRatio,nt.saveParam("all",e.currentSheetIndex,e.curZoomRatio,{k:"zoomRatio"}),Co(),pd());e.range&&(u.luckysheet_select_save=e.range,Ra()),u.clearjfundo=!0,mm()}};function Ic(e,n,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=u.flowdata[e][n],o=JSON.stringify(l);if(!M(e)||!M(n))return Ee.info("The row or column parameter is invalid.","");var d=Dr({},a),s=d.order,h=s===void 0?je(u.currentSheetIndex):s,f=d.isRefresh,p=f===void 0||f,g=d.success,v=u.luckysheetfile[h];if(v==null)return Ee.info("The order parameter is invalid.","");if(Ya.createHookFunction("cellUpdateBefore",e,n,t,p)){var y=v.data;p&&(y=$.extend(!0,[],v.data)),y.length==0&&(y=ir.buildGridData(v));var b={bg:1,ff:1,fc:1,bl:1,it:1,fs:1,cl:1,un:1,vt:1,ht:1,mc:1,tr:1,tb:1,rt:1,qp:1};if(t==null||t.toString().length==0)m.delFunctionGroup(e,n),Ln(e,n,y,t);else if(t instanceof Object){var k={},w=y[e][n];for(var _ in $t(w)&&(w={}),t.f!=null&&t.v==null?(k.f=t.f,t.ct!=null&&(k.ct=t.ct),y=m.updatecell(e,n,k,!1).data):(t.ct!=null&&(k.ct=t.ct),t.f!=null&&(k.f=t.f),t.v!=null?k.v=t.v:k.v=w.v,t.m!=null&&(k.m=t.m),m.delFunctionGroup(e,n),Ln(e,n,y,k)),t){var C=t[_];_ in b?dr.updateFormatCell(y,_,C,e,e,n,n):w[_]=C}y[e][n]=w}else t.toString().substr(0,1)=="="||t.toString().substr(0,5)=="<span"?y=m.updatecell(e,n,t,!1).data:(m.delFunctionGroup(e,n),Ln(e,n,y,t));setTimeout(function(){Ya.createHookFunction("cellUpdated",e,n,JSON.parse(o),u.flowdata[e][n],p)},0),v.index==u.currentSheetIndex&&p?wa(y,[{row:[e,e],column:[n,n]}]):v.data=y,g&&typeof g=="function"&&g(y)}}function Mg(e,n,t,a){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};if(!M(e)||!M(n))return Ee.info("Arguments row or column cannot be null or undefined.","");if(!t)return Ee.info("Arguments attr cannot be null or undefined.","");var o=je(u.currentSheetIndex),d=Dr({},l),s=d.order,h=s===void 0?o:s,f=d.success,p=u.luckysheetfile[h];if(p==null)return Ee.info("The order parameter is invalid.","");var g=$.extend(!0,[],p.data);g.length==0&&(g=ir.buildGridData(p));var v=g[e][n]||{},y=$.extend(!0,{},p.config);if(!(t!="ct"||a&&a.hasOwnProperty("fa")&&a.hasOwnProperty("t")))return new TypeError("While set attribute 'ct' to cell, the value must have property 'fa' and 't'");if(t=="bd"){y.borderInfo==null&&(y.borderInfo=[]);var b=Dr({rangeType:"range",borderType:"border-all",color:"#000",style:"1",range:[{column:[n,n],row:[e,e]}]},a);y.borderInfo.push(b)}else v[t]=a;g[e][n]=v,p.index==u.currentSheetIndex?(p.config=y,u.config=y,wa(g,[{row:[e,e],column:[n,n]}])):(p.config=y,p.data=g),f&&typeof f=="function"&&f(v)}function Ng(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e&&e!=0)return Ee.info("Search content cannot be null or empty","");for(var t=je(u.currentSheetIndex),a=Dr({},n),l=a.isRegularExpression,o=l!==void 0&&l,d=a.isWholeWord,s=d!==void 0&&d,h=a.isCaseSensitive,f=h!==void 0&&h,p=a.order,g=p===void 0?t:p,v=a.type,y=v===void 0?"m":v,b=u.luckysheetfile[g].data,k=[],w=0;w<b.length;w++)for(var _=b[w],C=0;C<_.length;C++){var A=_[C];if(A)if(A.row=w,A.column=C,s)f?e.toString()==A[y]&&k.push(A):A[y]&&e.toString().toLowerCase()==A[y].toLowerCase()&&k.push(A);else if(o)(f?new RegExp(T.getRegExpStr(e),"g"):new RegExp(T.getRegExpStr(e),"ig")).test(A[y])&&k.push(A);else if(f){var I=new RegExp(T.getRegExpStr(e),"g");I.test(A[y])&&k.push(A)}else{var S=new RegExp(T.getRegExpStr(e),"ig");S.test(A[y])&&k.push(A)}}return k}function Lg(e){if(Ne.saveFrozen("freezenRow",e),!e||e==je(u.currentSheetIndex)){var n=$("#luckysheet-cell-main").scrollTop(),t=fa(u.visibledatarow,n);t==-1&&(t=0);var a=u.visibledatarow[t]-2-n+u.columnHeaderHeight,l=[u.visibledatarow[t],t+1,n,Ne.cutVolumn(u.visibledatarow,t+1),a];Ne.saveFreezen(l,a,null,null),Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenHorizontal(l,a),Ne.createAssistCanvas(),Kr()}}function Pg(e){if(Ne.saveFrozen("freezenColumn",e),!e||e==je(u.currentSheetIndex)){var n=$("#luckysheet-cell-main").scrollLeft(),t=fa(u.visibledatacolumn,n);t==-1&&(t=0);var a=u.visibledatacolumn[t]-2-n+u.rowHeaderWidth,l=[u.visibledatacolumn[t],t+1,n,Ne.cutVolumn(u.visibledatacolumn,t+1),a];Ne.saveFreezen(null,null,l,a),Ne.freezenhorizontaldata!=null&&(Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenVertical(l,a),Ne.createAssistCanvas(),Kr()}}function Og(e,n){var t=st().freezen;if(e&&(e.hasOwnProperty("row_focus")||m.iscelldata(e))){if(typeof e=="string"&&m.iscelldata(e)&&(e={row_focus:(e=m.getcellrange(e)).row[0],column_focus:e.column[0]}),Ne.saveFrozen("freezenRowRange",n,e),!n||n==je(u.currentSheetIndex)){var a=$("#luckysheet-cell-main").scrollTop(),l=fa(u.visibledatarow,a),o=e.row_focus;o>l&&(l=o),l==-1&&(l=0);var d=u.visibledatarow[l]-2-a+u.columnHeaderHeight,s=[u.visibledatarow[l],l+1,a,Ne.cutVolumn(u.visibledatarow,l+1),d];Ne.saveFreezen(s,d,null,null),Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenHorizontal(s,d),Ne.createAssistCanvas(),Kr()}}else Rt()?alert(t.noSeletionError):Ee.info(t.noSeletionError,"")}function zg(e,n){var t=st().freezen,a=typeof e=="string"&&m.iscelldata(e);if(e&&(e.hasOwnProperty("column_focus")||a)){if(a&&(e={row_focus:(e=m.getcellrange(e)).row[0],column_focus:e.column[0]}),Ne.saveFrozen("freezenColumnRange",n,e),!n||n==je(u.currentSheetIndex)){var l=$("#luckysheet-cell-main").scrollLeft(),o=fa(u.visibledatacolumn,l),d=e.column_focus;d>o&&(o=d),o==-1&&(o=0);var s=u.visibledatacolumn[o]-2-l+u.rowHeaderWidth,h=[u.visibledatacolumn[o],o+1,l,Ne.cutVolumn(u.visibledatacolumn,o+1),s];Ne.saveFreezen(null,null,h,s),Ne.freezenhorizontaldata!=null&&(Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenVertical(h,s),Ne.createAssistCanvas(),Kr()}}else Rt()?alert(t.noSeletionError):Ee.info(t.noSeletionError,"")}function vd(e){Ne.saveFrozen("freezenCancel",e),e&&e!=je(u.currentSheetIndex)||(Ne.freezenverticaldata!=null&&Ne.cancelFreezenVertical(),Ne.freezenhorizontaldata!=null&&Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr())}function sm(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!M(n))return Ee.info("The index parameter is invalid.","");var a,l=je(u.currentSheetIndex),o=Dr({},t),d=o.number,s=d===void 0?1:d,h=o.order,f=h===void 0?l:h,p=o.success,g=st(),v=g.info;M(s)?(s=parseInt(s))<1||s>100?Rt()?alert(v.tipInputNumberLimit):Ee.info(v.tipInputNumberLimit,""):(f&&u.luckysheetfile[f]&&(a=u.luckysheetfile[f].index),Ls(e,n,s,"lefttop",a),p&&typeof p=="function"&&p()):Rt()?alert(v.tipInputNumber):Ee.info(v.tipInputNumber,"")}function um(e,n,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!M(n)||!M(t))return Ee.info("Please enter the index for deleting rows or columns correctly.","");var l,o=je(u.currentSheetIndex),d=Dr({},a),s=d.order,h=s===void 0?o:s,f=d.success;h&&u.luckysheetfile[h]&&(l=u.luckysheetfile[h].index),kc(e,n,t,l),f&&typeof f=="function"&&f()}function cm(e,n,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!M(n)||!M(t))return Ee.info("Please enter the index for deleting rows or columns correctly.","");var l=je(u.currentSheetIndex),o=Dr({},a),d=o.order,s=d===void 0?l:d,h=o.success,f=u.luckysheetfile[s],p=e==="row"?"rowhidden":"colhidden",g=$.extend(!0,{},f.config);g[p]==null&&(g[p]={});for(var v=n;v<=t;v++)g[p][v]=0;if(u.clearjfundo){var y={};y.type=e==="row"?"showHidRows":"showHidCols",y.sheetIndex=f.index,y.config=$.extend(!0,{},f.config),y.curconfig=g,u.jfundo.length=0,u.jfredo.push(y)}u.luckysheetfile[s].config=g,nt.saveParam("cg",f.index,g[p],{k:p}),s==l&&(u.config=g,ln(u.flowdata.length,u.flowdata[0].length)),h&&typeof h=="function"&&h()}function dm(e,n,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!M(n)||!M(t))return Ee.info("Please enter the index for deleting rows or columns correctly.","");var l=je(u.currentSheetIndex),o=Dr({},a),d=o.order,s=d===void 0?l:d,h=o.success,f=u.luckysheetfile[s],p=e==="row"?"rowhidden":"colhidden",g=$.extend(!0,{},f.config);if(g[p]!=null){for(var v=n;v<=t;v++)delete g[p][v];if(u.clearjfundo){var y={};y.type=e==="row"?"showHidRows":"showHidCols",y.sheetIndex=f.index,y.config=$.extend(!0,{},f.config),y.curconfig=g,u.jfundo.length=0,u.jfredo.push(y)}u.luckysheetfile[s].config=u.config,nt.saveParam("cg",f.index,g[p],{k:p}),s===l&&(u.config=g,ln(u.flowdata.length,u.flowdata[0].length)),h&&typeof h=="function"&&h()}}function Bg(){for(var e=u.luckysheet_select_save,n=[],t=0;t<e.length;t++){var a=e[t],l={row:a.row,column:a.column};n.push(l)}return n}function Vg(e){e=e||Bg();var n=[];return e.forEach(function(t){for(var a=t.row,l=t.column,o=a[0];o<=a[1];o++)for(var d=l[0];d<=l[1];d++)n.push({r:o,c:d})}),n}function Ug(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=je(u.currentSheetIndex),l=u.luckysheet_select_save[u.luckysheet_select_save.length-1],o=Dr({},t),d=o.range,s=d===void 0?l:d,h=o.order,f=h===void 0?a:h;if(!e)return Ee.info("Arguments attr cannot be null or undefined.",""),"error";if(s instanceof Array)return Ee.info("setRangeValue only supports a single selection.",""),"error";if(D(s)=="string"){if(!m.iscelldata(s))return Ee.info("The range parameter is invalid.",""),"error";s=m.getcellrange(s)}if(D(s)!="object"||s.row==null||s.column==null)return Ee.info("The range parameter is invalid.",""),"error";for(var p=s.row[0];p<=s.row[1];p++)for(var g=s.column[0];g<=s.column[1];g++)console.log("r",p),console.log("c",g),Ic(p,g,Yr({},e,n),{order:f,isRefresh:!1})}function Hg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=u.luckysheet_select_save,t=je(u.currentSheetIndex),a=Dr({},e),l=a.range,o=l===void 0?n:l,d=a.order,s=d===void 0?t:d,h=(a.success,u.luckysheetfile[s]),f=$.extend(!0,{},h.config),p=$.extend(!0,[],h.data);if(p.length==0&&(p=$.extend(!0,[],ir.buildGridData(h))),D(o)=="string"){if(!m.iscelldata(o))return Ee.info("Incorrect selection format","");var g=m.getcellrange(o);o=[{row:g.row,column:g.column}]}else if(D(o)=="object"){if(!o.hasOwnProperty("row")||!o.hasOwnProperty("column"))return Ee.info("Incorrect selection format","");o=[{row:o.row,column:o.column}]}if(Vs(o))return Ee.info("Cannot merge overlapping range","");if(f.merge!=null){for(var v=!1,y=0;y<o.length;y++){var b=o[y].row[0],k=o[y].row[1],w=o[y].column[0],_=o[y].column[1];if(v=mn(f,b,k,w,_))break}if(v)return Ee.info("Cannot perform this operation on partially merged cells","")}for(var C=0;C<o.length;C++){var A=o[C].row[0],I=o[C].row[1],S=o[C].column[0],E=o[C].column[1];if(A!=I||S!=E)for(var R={},F=A;F<=I;F++)for(var N=S;N<=E;N++){var z=p[F][N];if(z!=null&&z.mc!=null){var P=z.mc.r,q=z.mc.c;if("rs"in z.mc)delete z.mc,delete f.merge[P+"_"+q],R[P+"_"+q]=$.extend(!0,{},z);else{var V=JSON.parse(JSON.stringify(R[P+"_"+q]));delete V.v,delete V.m,delete V.ct,delete V.f,delete V.spl,p[F][N]=V}}}}s==t?(u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"mergeChange",sheetIndex:h.index,data:$.extend(!0,[],h.data),curData:p,range:o,config:$.extend(!0,{},h.config),curConfig:f})),u.clearjfundo=!1,wa(p,o,{cfg:f}),u.clearjfundo=!0):(h.data=p,h.config=f)}function jg(){var e=$.extend(!0,[],u.luckysheetfile);return e.forEach(function(n,t,a){n.data!=null&&n.data.length>0&&(n.celldata=ir.getGridData(n.data)),delete n.load,delete n.freezen}),e}function hm(){var e=u.toJsonOptions;return e.title=$("#luckysheet_info_detail_input").val(),e.data=jg(),an().forEach(function(n,t){n.data!=null&&(e.data[t].row=D(n.data)==="array"?n.data.length:0,e.data[t].column=D(n.data[0])==="array"?n.data[0].length:0)}),e}function Gg(e){$("#luckysheet-bottom-pager").remove(),$("#luckysheet-sheet-area").append('<div id="luckysheet-bottom-pager" style="font-size: 14px; margin-left: 10px; display: inline-block;"></div>'),$("#luckysheet-bottom-pager").sPage({page:e.pageIndex,total:e.total,selectOption:e.selectOption,pageSize:e.pageSize,showTotal:!0,showSkip:e.showSkip||!0,showPN:e.showPN||!0,backFun:function(n){n.pageIndex=n.page,Ya.createHookFunction("onTogglePager",n)}})}function mm(e,n,t,a){if(e=e||u.flowdata,n==null&&t==null){var l=u.luckysheet_select_save[u.luckysheet_select_save.length-1];n=l.row_focus||l.row[0],t=l.column_focus||l.column[0]}dr.menuButtonFocus(e,n,t),setTimeout(function(){a&&typeof a=="function"&&a()})}var Gb=Object.freeze({__proto__:null,getCellValue:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!M(e)||!M(n))return Ee.info("Arguments row or column cannot be null or undefined.","");var a,l=je(u.currentSheetIndex),o=Dr({},t),d=o.type,s=d===void 0?"v":d,h=o.order,f=h===void 0?l:h,p=u.luckysheetfile[f].data,g=p[e][n];return D(g)=="object"&&(a=g[s],s=="f"&&a!=null?a=m.functionHTMLGenerate(a):s=="f"?a=g.v:g&&g.ct&&g.ct.fa=="yyyy-MM-dd"&&(a=g.m)),a==null&&(a=null),a},setCellValue:Ic,clearCell:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!M(e)||!M(n))return Ee.info("Arguments row and column cannot be null or undefined.","");var a=je(u.currentSheetIndex),l=Dr({},t),o=l.order,d=o===void 0?a:o,s=l.success,h=$.extend(!0,[],u.luckysheetfile[d].data),f=h[e][n];D(f)=="object"?(delete f.m,delete f.v,f.f!=null&&(delete f.f,m.delFunctionGroup(e,n,d),delete f.spl)):f=null,d===a?wa(h,[{row:[e,e],column:[n,n]}]):u.luckysheetfile[d].data=h,s&&typeof s=="function"&&s(f)},deleteCell:function(e,n,t){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=["left","up"];if(!e||l.indexOf(e)<0)return Ee.info("Arguments move cannot be null or undefined and its value must be 'left' or 'up'","");if(!M(n)||!M(t))return Ee.info("Arguments row and column cannot be null or undefined.","");var o,d=je(u.currentSheetIndex),s=Dr({},a),h=s.order,f=h===void 0?d:h,p=s.success,g="move"+e.replace(e[0],e[0].toUpperCase());f&&u.luckysheetfile[f]&&(o=u.luckysheetfile[f].index),xc(g,n,n,t,t,o),p&&typeof p=="function"&&p()},setCellFormat:Mg,find:Ng,replace:function(e,n){var t,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=Ng(e,a),o=je(u.currentSheetIndex),d=Dr({},a),s=d.order,h=s===void 0?o:s,f=u.luckysheetfile[h];if(f==null)return Ee.info("The order parameter is invalid.","");var p=$.extend(!0,[],f.data);l.forEach(function(v){v.m=n,Ic(v.row,v.column,n,{order:h,isRefresh:!1})});var g=$.extend(!0,[],f.data);return f.data.length=0,(t=f.data).push.apply(t,Ei(p)),f.index==u.currentSheetIndex&&wa(g,void 0,void 0,!0,!1),Kr(),a.success&&typeof a.success=="function"&&a.success(l),l},exitEditMode:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};parseInt($("#luckysheet-input-box").css("top"))>0&&($("#luckysheet-formula-search-c").is(":visible")&&m.searchFunctionCell!=null?m.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),u.luckysheet_select_save=[{row:[u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[0]],column:[u.luckysheetCellUpdate[1],u.luckysheetCellUpdate[1]],row_focus:u.luckysheetCellUpdate[0],column_focus:u.luckysheetCellUpdate[1]}]),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide()),e.success&&typeof e.success=="function"&&e.success()},enterEditMode:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!$("#luckysheet-conditionformat-dialog").is(":visible")){if($("#luckysheet-cell-selected").is(":visible")){var n=u.luckysheet_select_save[u.luckysheet_select_save.length-1],t=n.row_focus,a=n.column_focus;ri(t,a,u.flowdata)}e.success&&typeof e.success=="function"&&e.success()}},frozenFirstRow:Lg,frozenFirstColumn:Pg,frozenRowRange:Og,frozenColumnRange:zg,cancelFrozen:vd,setHorizontalFrozen:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=je(u.currentSheetIndex),a=Dr({},n),l=a.range,o=a.order,d=o===void 0?t:o,s=a.success;vd(d),e?Og(l,d):Lg(d),s&&typeof s=="function"&&s()},setVerticalFrozen:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=je(u.currentSheetIndex),a=Dr({},n),l=a.range,o=a.order,d=o===void 0?t:o,s=a.success;vd(d),e?zg(l,d):Pg(d),s&&typeof s=="function"&&s()},setBothFrozen:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=je(u.currentSheetIndex),a=Dr({},n),l=a.range,o=a.order,d=o===void 0?t:o,s=(a.success,!d||d==je(u.currentSheetIndex)),h=st().freezen;if(vd(d),e){Ne.saveFrozen("freezenRCRange",d,l);var f=typeof l=="string"&&m.iscelldata(l);if(s){if(!(l&&l.hasOwnProperty("column_focus")&&l.hasOwnProperty("row_focus")||f))return void(Rt()?alert(h.noSeletionError):Ee.info(h.noSeletionError,""));f&&(l={row_focus:(l=m.getcellrange(l)).row[0],column_focus:l.column[0]});var p=$("#luckysheet-cell-main").scrollTop(),g=fa(u.visibledatarow,p),v=l.row_focus;v>g&&(g=v),g==-1&&(g=0);var y=u.visibledatarow[g]-2-p+u.columnHeaderHeight,b=[u.visibledatarow[g],g+1,p,Ne.cutVolumn(u.visibledatarow,g+1),y];Ne.saveFreezen(b,y,null,null),Ne.createFreezenHorizontal(b,y);var k=$("#luckysheet-cell-main").scrollLeft(),w=fa(u.visibledatacolumn,k),_=l.column_focus;_>w&&(w=_),w==-1&&(w=0);var C=u.visibledatacolumn[w]-2-k+u.rowHeaderWidth,A=[u.visibledatacolumn[w],w+1,k,Ne.cutVolumn(u.visibledatacolumn,w+1),C];Ne.saveFreezen(null,null,A,C),Ne.createFreezenVertical(A,C),Ne.createAssistCanvas(),Kr()}}else if(Ne.saveFrozen("freezenRC",d),s){var I=$("#luckysheet-cell-main").scrollTop(),S=fa(u.visibledatarow,I);S==-1&&(S=0);var E=u.visibledatarow[S]-2-I+u.columnHeaderHeight,R=[u.visibledatarow[S],S+1,I,Ne.cutVolumn(u.visibledatarow,S+1),E];Ne.saveFreezen(R,E,null,null),Ne.createFreezenHorizontal(R,E);var F=$("#luckysheet-cell-main").scrollLeft(),N=fa(u.visibledatacolumn,F);N==-1&&(N=0);var z=u.visibledatacolumn[N]-2-F+u.rowHeaderWidth,P=[u.visibledatacolumn[N],N+1,F,Ne.cutVolumn(u.visibledatacolumn,N+1),z];Ne.saveFreezen(null,null,P,z),Ne.createFreezenVertical(P,z),Ne.createAssistCanvas(),Kr()}},insertRowOrColumn:sm,insertRow:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sm("row",e,n)},insertColumn:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sm("column",e,n)},deleteRowOrColumn:um,deleteRow:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};um("row",e,n,t)},deleteColumn:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};um("column",e,n,t)},hideRowOrColumn:cm,showRowOrColumn:dm,hideRow:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};cm("row",e,n,t)},showRow:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};dm("row",e,n,t)},hideColumn:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};cm("column",e,n,t)},showColumn:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};dm("column",e,n,t)},setRowHeight:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="object")return Ee.info("The rowInfo parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=$.extend(!0,{},d.config);for(var h in s.rowlen==null&&(s.rowlen={}),e)if(parseInt(h)>=0){var f=e[h];Number(f)>=0&&(s.rowlen[parseInt(h)]=Number(f))}d.config=s,nt.saveParam("cg",d.index,s.rowlen,{k:"rowlen"}),d.index==u.currentSheetIndex&&(u.config=s,ln(u.flowdata.length,u.flowdata[0].length)),o&&typeof o=="function"&&o()},setColumnWidth:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="object")return Ee.info("The columnInfo parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=$.extend(!0,{},d.config);for(var h in s.columnlen==null&&(s.columnlen={}),e)if(parseInt(h)>=0){var f=e[h];Number(f)>=0&&(s.columnlen[parseInt(h)]=Number(f))}d.config=s,nt.saveParam("cg",d.index,s.columnlen,{k:"columnlen"}),d.index==u.currentSheetIndex&&(u.config=s,ln(u.flowdata.length,u.flowdata[0].length)),o&&typeof o=="function"&&o()},getRowHeight:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="array"||e.length==0)return Ee.info("The rowInfo parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=$.extend(!0,{},d.config),h=s.rowlen||{},f={};return e.forEach(function(p){if(parseInt(p)>=0){var g=h[parseInt(p)]||u.defaultrowlen;f[parseInt(p)]=g}}),setTimeout(function(){o&&typeof o=="function"&&o()},1),f},getColumnWidth:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="array"||e.length==0)return Ee.info("The columnInfo parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=$.extend(!0,{},d.config),h=s.columnlen||{},f={};return e.forEach(function(p){if(parseInt(p)>=0){var g=h[parseInt(p)]||u.defaultcollen;f[parseInt(p)]=g}}),setTimeout(function(){o&&typeof o=="function"&&o()},1),f},getDefaultRowHeight:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success;return setTimeout(function(){l&&typeof l=="function"&&l()},1),u.luckysheetfile[a].defaultRowHeight},getDefaultColWidth:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success;return setTimeout(function(){l&&typeof l=="function"&&l()},1),u.luckysheetfile[a].defaultColWidth},getRange:Bg,getRangeWithFlatten:Vg,getRangeValuesWithFlatte:function(e){e=e||Vg();var n=[];return e.forEach(function(t){n.push(u.flowdata[t.r][t.c])}),n},getRangeAxis:function(){var e=[],n=u.luckysheet_select_save,t=u.currentSheetIndex;return n.forEach(function(a){var l=wn(t,{column:a.column,row:a.row});e.push(l)}),e},getRangeValue:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=je(u.currentSheetIndex),t=Dr({},e),a=t.range,l=t.order,o=l===void 0?n:l,d=u.luckysheetfile[o];if(!a||ul(a)==="object")return nn(a,d.index);if(typeof a=="string"){if(m.iscelldata(a))return nn(m.getcellrange(a),d.index);Ee.info("The range is invalid, please check range parameter.","")}},getRangeHtml:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.range,a=t===void 0?u.luckysheet_select_save:t,l=n.order,o=l===void 0?je(u.currentSheetIndex):l;if(n.success,D(a)=="string"){if(!m.iscelldata(a))return Ee.info("The range parameter is invalid.","");var d=m.getcellrange(a);a=[{row:d.row,column:d.column}]}else if(D(a)=="object"){if(a.row==null||a.column==null)return Ee.info("The range parameter is invalid.","");a=[{row:a.row,column:a.column}]}if(D(a)!="array")return Ee.info("The range parameter is invalid.","");var s=u.luckysheetfile[o];if(s==null)return Ee.info("The order parameter is invalid.","");var h=$.extend(!0,{},s.config);if(h.merge!=null){for(var f=!1,p=0;p<a.length;p++){var g=a[p].row[0],v=a[p].row[1],y=a[p].column[0],b=a[p].column[1];if(f=mn(h,g,v,y,b))break}if(f)return Ee.info("Cannot perform this operation on partially merged cells","")}var k=$.extend(!0,[],s.luckysheet_conditionformat_save);if(a.length>1&&k.length>0){for(var w=!1,_=kr.getComputeMap(s.index),C=0;C<a.length;C++){for(var A=a[C].row[0],I=a[C].row[1],S=a[C].column[0],E=a[C].column[1],R=A;R<=I;R++){for(var F=S;F<=E;F++)if(kr.checksCF(R,F,_)!=null){w=!0;break}if(w)break}if(w)break}if(w)return Ee.info("Cannot perform this operation on multiple selection areas, please select a single area","")}if(a.length>1){for(var N=!0,z=a[0].row[0],P=a[0].row[1],q=!0,V=a[0].column[0],x=a[0].column[1],ee=1;ee<a.length;ee++)a[ee].row[0]==z&&a[ee].row[1]==P||(N=!1),a[ee].column[0]==V&&a[ee].column[1]==x||(q=!1);if(!N&&!q||Vs(a))return Ee.info("Cannot perform this operation on multiple selection areas, please select a single area","")}for(var ne,ae=[],de=[],ve=0;ve<a.length;ve++)for(var U=a[ve].row[0],B=a[ve].row[1],le=a[ve].column[0],Te=a[ve].column[1],ue=U;ue<=B;ue++)if(h.rowhidden==null||h.rowhidden[ue]==null){ae.includes(ue)||ae.push(ue);for(var be=le;be<=Te;be++)h.colhidden!=null&&h.colhidden[be]!=null||de.includes(be)||de.push(be)}h.borderInfo&&h.borderInfo.length>0&&(ne=Ps(s.index));var ye=s.data;ye!=null&&ye.length!=0||(ye=ir.buildGridData(s));var ce="",Re="";ae=ae.sort(),de=de.sort();for(var pe=0;pe<ae.length;pe++){var me=ae[pe];if(h.rowhidden==null||h.rowhidden[me]==null){ce+="<tr>";for(var re=0;re<de.length;re++){var _e=de[re];if(h.colhidden==null||h.colhidden[_e]==null){var Ze='<td ${span} style="${style}">';if(ye[me]!=null&&ye[me][_e]!=null){var We="",Xe="";me==ae[0]&&(h.columnlen==null||h.columnlen[_e.toString()]==null?Re+='<colgroup width="72px"></colgroup>':Re+='<colgroup width="'+h.columnlen[_e.toString()]+'px"></colgroup>'),_e==de[0]&&(h.rowlen==null||h.rowlen[me.toString()]==null?We+="height:19px;":We+="height:"+h.rowlen[me.toString()]+"px;");var Ue=/^(w|W)((0?)|(0\.0+))$/,mt=void 0;if(mt=ye[me][_e].ct!=null&&ye[me][_e].ct.fa!=null&&ye[me][_e].ct.fa.match(Ue)?Hr(me,_e,ye):Hr(me,_e,ye,"m"),We+=dr.getStyleByCell(ye,me,_e),D(ye[me][_e])=="object"&&"mc"in ye[me][_e]){if(!("rs"in ye[me][_e].mc))continue;if(Xe='rowspan="'+ye[me][_e].mc.rs+'" colspan="'+ye[me][_e].mc.cs+'"',ne&&ne[me+"_"+_e]){for(var St={color:{},style:{}},at={color:{},style:{}},dt={color:{},style:{}},wt={color:{},style:{}},ct=me;ct<me+ye[me][_e].mc.rs;ct++)for(var bt=_e;bt<_e+ye[me][_e].mc.cs;bt++){if(ct==me&&ne[ct+"_"+bt]&&ne[ct+"_"+bt].t){var De=ne[ct+"_"+bt].t.style,He=ne[ct+"_"+bt].t.color;dt.style[De]==null?dt.style[De]=1:dt.style[De]=dt.style[De]+1,dt.color[He]==null?dt.color[He]=1:dt.color[He]=dt.color[He]+1}if(ct==me+ye[me][_e].mc.rs-1&&ne[ct+"_"+bt]&&ne[ct+"_"+bt].b){var Dt=ne[ct+"_"+bt].b.style,et=ne[ct+"_"+bt].b.color;wt.style[Dt]==null?wt.style[Dt]=1:wt.style[Dt]=wt.style[Dt]+1,wt.color[et]==null?wt.color[et]=1:wt.color[et]=wt.color[et]+1}if(bt==_e&&ne[ct+"_"+bt]&&ne[ct+"_"+bt].l){var ur=ne[me+"_"+_e].l.style,Xt=ne[ct+"_"+bt].l.color;St.style[ur]==null?St.style[ur]=1:St.style[ur]=St.style[ur]+1,St.color[Xt]==null?St.color[Xt]=1:St.color[Xt]=St.color[Xt]+1}if(bt==_e+ye[me][_e].mc.cs-1&&ne[ct+"_"+bt]&&ne[ct+"_"+bt].r){var jt=ne[ct+"_"+bt].r.style,lr=ne[ct+"_"+bt].r.color;at.style[jt]==null?at.style[jt]=1:at.style[jt]=at.style[jt]+1,at.color[lr]==null?at.color[lr]=1:at.color[lr]=at.color[lr]+1}}var tr=ye[me][_e].mc.rs,xr=ye[me][_e].mc.cs;if(JSON.stringify(St).length>23){var rr=null,nr=null;for(var Ut in St.color)St.color[Ut]>=tr/2&&(rr=Ut);for(var ar in St.style)St.style[ar]>=tr/2&&(nr=ar);rr!=null&&nr!=null&&(We+="border-left:"+Ba.getHtmlBorderStyle(nr,rr))}if(JSON.stringify(at).length>23){var Jt=null,Qt=null;for(var _t in at.color)at.color[_t]>=tr/2&&(Jt=_t);for(var er in at.style)at.style[er]>=tr/2&&(Qt=er);Jt!=null&&Qt!=null&&(We+="border-right:"+Ba.getHtmlBorderStyle(Qt,Jt))}if(JSON.stringify(dt).length>23){var Kt=null,mr=null;for(var fr in dt.color)dt.color[fr]>=xr/2&&(Kt=fr);for(var Wt in dt.style)dt.style[Wt]>=xr/2&&(mr=Wt);Kt!=null&&mr!=null&&(We+="border-top:"+Ba.getHtmlBorderStyle(mr,Kt))}if(JSON.stringify(wt).length>23){var ze=null,Ae=null;for(var Ve in wt.color)wt.color[Ve]>=xr/2&&(ze=Ve);for(var gt in wt.style)wt.style[gt]>=xr/2&&(Ae=gt);ze!=null&&Ae!=null&&(We+="border-bottom:"+Ba.getHtmlBorderStyle(Ae,ze))}}}else if(ne&&ne[me+"_"+_e]){if(ne[me+"_"+_e].l){var vt=ne[me+"_"+_e].l.style,pt=ne[me+"_"+_e].l.color;We+="border-left:"+Ba.getHtmlBorderStyle(vt,pt)}if(ne[me+"_"+_e].r){var Tt=ne[me+"_"+_e].r.style,Ot=ne[me+"_"+_e].r.color;We+="border-right:"+Ba.getHtmlBorderStyle(Tt,Ot)}if(ne[me+"_"+_e].b){var It=ne[me+"_"+_e].b.style,Lt=ne[me+"_"+_e].b.color;We+="border-bottom:"+Ba.getHtmlBorderStyle(It,Lt)}if(ne[me+"_"+_e].t){var At=ne[me+"_"+_e].t.style,or=ne[me+"_"+_e].t.color;We+="border-top:"+Ba.getHtmlBorderStyle(At,or)}}Ze=br(Ze,{style:We,span:Xe}),mt==null&&(mt=Hr(me,_e,ye)),mt==null&&(mt=" "),Ze+=mt}else{var Cr="";if(ne&&ne[me+"_"+_e]){if(ne[me+"_"+_e].l){var Ar=ne[me+"_"+_e].l.style,Rr=ne[me+"_"+_e].l.color;Cr+="border-left:"+Ba.getHtmlBorderStyle(Ar,Rr)}if(ne[me+"_"+_e].r){var Zr=ne[me+"_"+_e].r.style,Tr=ne[me+"_"+_e].r.color;Cr+="border-right:"+Ba.getHtmlBorderStyle(Zr,Tr)}if(ne[me+"_"+_e].b){var jr=ne[me+"_"+_e].b.style,ta=ne[me+"_"+_e].b.color;Cr+="border-bottom:"+Ba.getHtmlBorderStyle(jr,ta)}if(ne[me+"_"+_e].t){var ia=ne[me+"_"+_e].t.style,Jr=ne[me+"_"+_e].t.color;Cr+="border-top:"+Ba.getHtmlBorderStyle(ia,Jr)}}Ze+="",me==ae[0]&&(h.columnlen==null||h.columnlen[_e.toString()]==null?Re+='<colgroup width="72px"></colgroup>':Re+='<colgroup width="'+h.columnlen[_e.toString()]+'px"></colgroup>'),_e==de[0]&&(h.rowlen==null||h.rowlen[me.toString()]==null?Cr+="height:19px;":Cr+="height:"+h.rowlen[me.toString()]+"px;"),Ze=br(Ze,{style:Cr,span:""}),Ze+=" "}ce+=Ze+="</td>"}}ce+="</tr>"}}return ce='<table data-type="luckysheet_copy_action_table">'+Re+ce+"</table>"},getRangeArray:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["oneDimensional","twoDimensional"];if(!t.includes(e))return Ee.info("The dimensional parameter is invalid.","");var a=Dr({},n),l=a.range,o=l===void 0?u.luckysheet_select_save[u.luckysheet_select_save.length-1]:l,d=a.order,s=d===void 0?je(u.currentSheetIndex):d,h=u.luckysheetfile[s];if(h==null)return Ee.info("The order parameter is invalid.","");if(D(o)=="string"){if(!m.iscelldata(o))return Ee.info("The range parameter is invalid.","");o=m.getcellrange(o)}if(D(o)!="object"||o.row==null||o.column==null)return Ee.info("The range parameter is invalid.","");var f=o.row[0],p=o.row[1],g=o.column[0],v=o.column[1],y=$.extend(!0,{},h.config);if(y.merge!=null){var b=mn(y,f,p,g,v);if(b)return Ee.info("Cannot perform this operation on partially merged cells","")}var k=h.data;k!=null&&k.length!=0||(k=ir.buildGridData(h));var w=[];if(e=="oneDimensional")for(var _=f;_<=p;_++)for(var C=g;C<=v;C++){var A=k[_][C];A==null||A.v==null?w.push(null):w.push(A.v)}else if(e=="twoDimensional")for(var I=f;I<=p;I++){for(var S=[],E=g;E<=v;E++){var R=k[I][E];R==null||R.v==null?S.push(null):S.push(R.v)}w.push(S)}return w},getRangeJson:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=u.luckysheet_select_save[0],a=je(u.currentSheetIndex),l=Dr({},n),o=l.range,d=o===void 0?t:o,s=l.order,h=s===void 0?a:s,f=u.luckysheetfile[h],p=f.config;if(d&&typeof d=="string"&&m.iscelldata(d)&&(d=m.getcellrange(d)),!d||d.length>1)Rt()?alert(locale_drag.noMulti):Ee.info(locale_drag.noMulti,"");else{if(p.merge!=null){var g=d.row[0],v=d.row[1],y=d.column[0],b=d.column[1];if(mn(p,g,v,y,b))return void(Rt()?alert(st().drag.noPartMerge):Ee.info(st().drag.noPartMerge,""))}var k=nn(d,f.index),w=[];if(k.length!==0){if(e)if(k.length===1){for(var _={},C=0;C<k[0].length;C++)_[Hr(0,C,k)]="";w.push(_)}else for(var A=1;A<k.length;A++){for(var I={},S=0;S<k[0].length;S++)Hr(0,S,k)==null?I[""]=Hr(A,S,k):I[Hr(0,S,k)]=Hr(A,S,k);w.push(I)}else for(var E=d.column[0],R=0;R<k.length;R++){for(var F={},N=0;N<k[0].length;N++)F[ya(N+E)]=Hr(R,N,k);w.push(F)}return w}}},getRangeDiagonal:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["normal","anti","offset"];if(t.indexOf(e)<0)return Ee.info("The type parameter must be included in ['normal', 'anti', 'offset']","");var a=je(u.currentSheetIndex),l=u.luckysheet_select_save,o=Dr({},n),d=o.column,s=d===void 0?1:d,h=o.range,f=h===void 0?l:h,p=o.order,g=p===void 0?a:p,v=u.luckysheetfile[g],y=v.config;if(f&&typeof f=="string"&&m.iscelldata(f)&&(f=m.getcellrange(f)),!f||f.length>1)Rt()?alert(st().drag.noMulti):Ee.info(st().drag.noMulti,"");else{if(y.merge!=null){var b=f[0].row[0],k=f[0].row[1],w=f[0].column[0],_=f[0].column[1];if(mn(y,b,k,w,_))return void(Rt()?alert(st().drag.noPartMerge):Ee.info(st().drag.noPartMerge,""))}var C=nn(f,g),A=[];if(C.length!==0){var I=C[0].length;switch(e){case"normal":for(var S=0;S<C.length&&!(S>=I);S++)A.push(C[S][S]);break;case"anti":for(var E=0;E<C.length&&!(E>=I);E++)A.push(C[E][I-E-1]);break;case"offset":if(s.toString()=="NaN")return void(Rt()?alert(st().drag.inputCorrect):Ee.info(st().drag.inputCorrect,""));if(s<0)return void(Rt()?alert(st().drag.offsetColumnLessZero):Ee.info(st().drag.offsetColumnLessZero,""));for(var R=0;R<C.length&&!(R+s>=I);R++)A.push(C[R][R+s])}Ba.copybyformat(new Event,JSON.stringify(A))}}},getRangeBoolean:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=je(u.currentSheetIndex),t=u.luckysheet_select_save,a=Dr({},e),l=a.range,o=l===void 0?t:l,d=a.order,s=d===void 0?n:d,h=u.luckysheetfile[s],f=h.config;if(o&&typeof o=="string"&&m.iscelldata(o)&&(o=m.getcellrange(o)),!o||o.length>1)Rt()?alert(st().drag.noMulti):Ee.info(st().drag.noMulti,"");else{if(f.merge!=null){var p=o[0].row[0],g=o[0].row[1],v=o[0].column[0],y=o[0].column[1];if(mn(f,p,g,v,y))return void(Rt()?alert(st().drag.noPartMerge):Ee.info(st().drag.noPartMerge,""))}var b=nn(o,s),k=[];if(b.length!==0){for(var w=0;w<b.length;w++){for(var _=[],C=0;C<b[0].length;C++){var A=!1,I=void 0;A=(I=D(b[w][C])=="object"?b[w][C].v:b[w][C])!=null&&I!=""&&((I=parseInt(I))==null||I>0),_.push(A)}k.push(_)}Ba.copybyformat(event,JSON.stringify(k))}}},setRangeShow:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)=="string"){if(!m.iscelldata(e))return Ee.info("The range parameter is invalid.","");var t=m.getcellrange(e);e=[{row:t.row,column:t.column}]}else if(D(e)=="object"){if(e.row==null||e.column==null)return Ee.info("The range parameter is invalid.","");e=[{row:e.row,column:e.column}]}if(D(e)=="array"){for(var a=0;a<e.length;a++)if(D(e[a])==="string"){if(!m.iscelldata(e[a]))return Ee.info("The range parameter is invalid.","");var l=m.getcellrange(e[a]);e[a]={row:l.row,column:l.column}}else if(D(e)=="object"){if(e.row==null||e.column==null)return Ee.info("The range parameter is invalid.","");e={row:e.row,column:e.column}}}if(D(e)!="array")return Ee.info("The range parameter is invalid.","");var o=Dr({},n),d=o.show,s=d===void 0||d,h=o.order,f=h===void 0?je(u.currentSheetIndex):h,p=o.success,g=u.luckysheetfile[f];if(g==null)return Ee.info("The order parameter is invalid.","");for(var v=0;v<e.length;v++){var y=dr.mergeMoveMain(e[v].column,e[v].row,e[v]);y&&(e[v]={row:y[1],column:y[0]})}g.luckysheet_select_save=e,g.index==u.currentSheetIndex&&(u.luckysheet_select_save=e,Ra(),s||($("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty())),p&&typeof p=="function"&&p()},setRangeValue:function(e){var n,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=je(u.currentSheetIndex),l=u.luckysheet_select_save[u.luckysheet_select_save.length-1],o=Dr({},t),d=o.range,s=d===void 0?l:d,h=o.isRefresh,f=h===void 0||h,p=o.order,g=p===void 0?a:p,v=o.success;if(e==null)return Ee.info("The data which will be set to range cannot be null.","");if(s instanceof Array)return Ee.info("setRangeValue only supports a single selection.","");typeof s=="string"&&m.iscelldata(s)&&(s=m.getcellrange(s));var y=s.row[1]-s.row[0]+1,b=s.column[1]-s.column[0]+1;if(e.length!==y||e[0].length!==b)return Ee.info("The data to be set does not match the selection.","");var k=u.luckysheetfile[g];if(k==null)return Ee.info("The order parameter is invalid.","");for(var w=$.extend(!0,[],k.data),_=0;_<y;_++)for(var C=0;C<b;C++){var A=s.row[0]+_,I=s.column[0]+C;Ic(A,I,e[_][C],{order:g,isRefresh:!1})}var S=$.extend(!0,[],k.data);k.data.length=0,(n=k.data).push.apply(n,Ei(w)),k.index==u.currentSheetIndex&&wa(S,[{row:s.row,column:s.column}],void 0,!0,!1),f&&Kr(),v&&typeof v=="function"&&v()},setSingleRangeFormat:Ug,setRangeFormat:function(e,n){var t,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=je(u.currentSheetIndex),o=u.luckysheet_select_save,d=Dr({},a),s=d.range,h=s===void 0?o:s,f=d.order,p=f===void 0?l:f,g=d.success;if(D(h)=="string"){if(!m.iscelldata(h))return Ee.info("The range parameter is invalid.","");var v=m.getcellrange(h);h=[{row:v.row,column:v.column}]}else if(D(h)=="object"){if(h.row==null||h.column==null)return Ee.info("The range parameter is invalid.","");h=[{row:h.row,column:h.column}]}if(D(h)!="array")return Ee.info("The range parameter is invalid.","");var y=u.luckysheetfile[p];if(y==null)return Ee.info("The order parameter is invalid.","");for(var b,k=$.extend(!0,[],y.data),w=[],_=0;_<h.length;_++)w.push(Ug(e,n,{range:h[_],order:p}));if(w.some(function(A){return A==="error"}))return y.data.length=0,(b=y.data).push.apply(b,Ei(k)),!1;var C=$.extend(!0,[],y.data);y.data.length=0,(t=y.data).push.apply(t,Ei(k)),y.index==u.currentSheetIndex&&wa(C,void 0,void 0,!0,!1),Kr(),g&&typeof g=="function"&&g()},setRangeFilter:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["open","close"];if(!t.includes(e))return Ee.info("The type parameter is invalid.","");var a=Dr({},n),l=a.range,o=l===void 0?u.luckysheet_select_save[u.luckysheet_select_save.length-1]:l,d=a.order,s=d===void 0?je(u.currentSheetIndex):d,h=a.success,f=u.luckysheetfile[s];if(f==null)return Ee.info("The order parameter is invalid.","");if(D(o)=="string"){if(!m.iscelldata(o))return Ee.info("The range parameter is invalid.","");o=m.getcellrange(o)}if(D(o)!="object"||o.row==null||o.column==null)return Ee.info("The range parameter is invalid.","");if(setTimeout(function(){h&&typeof h=="function"&&h()},1),e=="open")return f.filter_select=o,f.index==u.currentSheetIndex&&gi(o,f.filter),{row:o.row,column:o.column};if(e=="close"){var p=$.extend(!0,{},f.filter_select);return f.filter_select=null,$("#luckysheet-filter-selected-sheet"+f.index).remove(),$("#luckysheet-filter-options-sheet"+f.index).remove(),{row:p.row,column:p.column}}},setRangeMerge:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["all","horizontal","vertical"];if(t.indexOf(e)<0)return Ee.info("The type parameter must be included in ['all', 'horizontal', 'vertical']","");var a=je(u.currentSheetIndex),l=u.luckysheet_select_save,o=Dr({},n),d=o.range,s=d===void 0?l:d,h=o.order,f=h===void 0?a:h,p=o.success,g=u.luckysheetfile[f],v=$.extend(!0,{},g.config),y=$.extend(!0,[],g.data);if(y.length==0&&(y=$.extend(!0,[],ir.buildGridData(g))),D(s)=="string"){if(!m.iscelldata(s))return Ee.info("Incorrect selection format","");var b=m.getcellrange(s);s=[{row:b.row,column:b.column}]}else if(D(s)=="object"){if(!s.hasOwnProperty("row")||!s.hasOwnProperty("column"))return Ee.info("Incorrect selection format","");s=[{row:s.row,column:s.column}]}if(Vs(s))return Ee.info("Cannot merge overlapping range","");if(v.merge!=null){for(var k=!1,w=0;w<s.length;w++){var _=s[w].row[0],C=s[w].row[1],A=s[w].column[0],I=s[w].column[1];if(k=mn(v,_,C,A,I))break}if(k)return Ee.info("Cannot perform this operation on partially merged cells","")}for(var S=!1,E=0;E<s.length;E++)for(var R=s[E].row[0],F=s[E].row[1],N=s[E].column[0],z=s[E].column[1],P=R;P<=F;P++){for(var q=N;q<=z;q++){var V=y[P][q];if(D(V)=="object"&&"mc"in V){S=!0;break}}if(S)break}if(S)Hg({range:s,order:f});else{for(var x=0;x<s.length;x++){var ee=s[x].row[0],ne=s[x].row[1],ae=s[x].column[0],de=s[x].column[1];if(ee!=ne||ae!=de){if(e=="all"){for(var ve={},U=!1,B=ee;B<=ne;B++)for(var le=ae;le<=de;le++){var Te=y[B][le];Te==null||$t(Te.v)&&Te.f==null||U||(ve=$.extend(!0,{},Te),U=!0),y[B][le]={mc:{r:ee,c:ae}}}y[ee][ae]=ve,y[ee][ae].mc={r:ee,c:ae,rs:ne-ee+1,cs:de-ae+1},v.merge[ee+"_"+ae]={r:ee,c:ae,rs:ne-ee+1,cs:de-ae+1}}else if(e=="vertical")for(var ue=ae;ue<=de;ue++){for(var be={},ye=!1,ce=ee;ce<=ne;ce++){var Re=y[ce][ue];Re==null||$t(Re.v)&&Re.f==null||ye||(be=$.extend(!0,{},Re),ye=!0),y[ce][ue]={mc:{r:ee,c:ue}}}y[ee][ue]=be,y[ee][ue].mc={r:ee,c:ue,rs:ne-ee+1,cs:1},v.merge[ee+"_"+ue]={r:ee,c:ue,rs:ne-ee+1,cs:1}}else if(e=="horizontal")for(var pe=ee;pe<=ne;pe++){for(var me={},re=!1,_e=ae;_e<=de;_e++){var Ze=y[pe][_e];Ze==null||$t(Ze.v)&&Ze.f==null||re||(me=$.extend(!0,{},Ze),re=!0),y[pe][_e]={mc:{r:pe,c:ae}}}y[pe][ae]=me,y[pe][ae].mc={r:pe,c:ae,rs:1,cs:de-ae+1},v.merge[pe+"_"+ae]={r:pe,c:ae,rs:1,cs:de-ae+1}}}}f==a?(u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"mergeChange",sheetIndex:g.index,data:$.extend(!0,[],g.data),curData:y,range:s,config:$.extend(!0,{},g.config),curConfig:v})),u.clearjfundo=!1,wa(y,s,{cfg:v}),u.clearjfundo=!0):(g.data=y,g.config=v)}p&&typeof p=="function"&&p()},cancelRangeMerge:Hg,setRangeSort:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["asc","desc"];if(t.indexOf(e)<0)return Ee.info("The type parameter must be included in ['asc', 'desc'","");var a=je(u.currentSheetIndex),l=u.luckysheet_select_save[0],o=Dr({},n),d=o.range,s=d===void 0?l:d,h=o.order,f=h===void 0?a:h,p=o.success,g=u.luckysheetfile[f],v=$.extend(!0,{},g.config),y=$.extend(!0,[],g.data);if(y.length==0&&(y=$.extend(!0,[],ir.buildGridData(g))),s instanceof Array&&s.length>1)Ee.info(st().sort.noRangeError,"");else{s&&typeof s=="string"&&m.iscelldata(s)&&(s=m.getcellrange(s));for(var b=s.row[0],k=s.row[1],w=s.column[0],_=s.column[1],C=!1,A=[],I=b;I<=k;I++){for(var S=[],E=w;E<=_;E++){if(y[I][E]!=null&&y[I][E].mc!=null){C=!0;break}S.push(y[I][E])}A.push(S)}if(C)Ee.info(st().sort.mergeError,"");else{A=zs([].concat(A),0,e==="asc");for(var R=b;R<=k;R++)for(var F=w;F<=_;F++)y[R][F]=A[R-b][F-w];var N={};v.rowlen!=null&&(N={cfg:v=Yl(y,b,k,v),RowlChange:!0}),g.index==u.currentSheetIndex?wa(y,[{row:[b,k],column:[w,_]}],N):(g.data=y,g.config=v),p&&typeof p=="function"&&p()}}},setRangeSortMulti:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(n&&n instanceof Array))return Ee.info("The sort parameter is invalid.","");var a=je(u.currentSheetIndex),l=u.luckysheet_select_save[0],o=Dr({},t),d=o.range,s=d===void 0?l:d,h=o.order,f=h===void 0?a:h,p=o.success,g=u.luckysheetfile[f],v=$.extend(!0,{},g.config),y=$.extend(!0,[],g.data);if(y.length==0&&(y=$.extend(!0,[],ir.buildGridData(g))),s instanceof Array&&s.length>1)Ee.info(st().sort.noRangeError,"");else{s&&typeof s=="string"&&m.iscelldata(s)&&(s=m.getcellrange(s));for(var b,k=s.row[0],w=s.row[1],_=s.column[0],C=s.column[1],A=!1,I=[],S=b=e?k+1:k;S<=w;S++){for(var E=[],R=_;R<=C;R++){if(y[S][R]!=null&&y[S][R].mc!=null){A=!0;break}E.push(y[S][R])}I.push(E)}if(A)Ee.info(st().sort.mergeError,"");else{n.forEach(function(P){var q=P.i;q-=_,I=zs([].concat(I),q,P.sort==="asc")});for(var F=b;F<=w;F++)for(var N=_;N<=C;N++)y[F][N]=I[F-b][N-_];var z={};v.rowlen!=null&&(z={cfg:v=Yl(y,b,w,v),RowlChange:!0}),g.index===u.currentSheetIndex?wa(y,[{row:[b,w],column:[_,C]}],z):(g.data=y,g.config=v),p&&typeof p=="function"&&p()}}},setRangeConditionalFormatDefault:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=["greaterThan","lessThan","betweenness","equal","textContains","occurrenceDate","duplicateValue","top10","top10%","last10","last10%","AboveAverage","SubAverage"];if(!e||!a.includes(e))return Ee.info("The conditionName parameter is invalid.","");if(D(n)!="array"||n.length==0)return Ee.info("The conditionValue parameter is invalid.","");var l=Dr({},t),o=l.format,d=o===void 0?{textColor:"#000000",cellColor:"#ff0000"}:o,s=l.cellrange,h=s===void 0?u.luckysheet_select_save:s,f=l.order,p=f===void 0?je(u.currentSheetIndex):f,g=l.success,v=u.luckysheetfile[p],y=v.data;if(y!=null&&y.length!=0||(y=ir.buildGridData(v)),v==null)return Ee.info("Incorrect worksheet index","");var b=st().conditionformat,k=[],w=[];if(e=="betweenness"){var _=n[0],C=n[1],A=kr.getRangeByTxt(_);if(A.length>1)return void kr.infoDialog(b.onlySingleCell,"");if(A.length==1){var I=A[0].row[0],S=A[0].row[1],E=A[0].column[0],R=A[0].column[1];if(I!=S||E!=R)return void kr.infoDialog(b.onlySingleCell,"");_=Hr(I,E,y),k.push({row:A[0].row,column:A[0].column}),w.push(_)}else if(A.length==0){if(isNaN(_)||_=="")return void kr.infoDialog(b.conditionValueCanOnly,"");w.push(_)}var F=kr.getRangeByTxt(C);if(F.length>1)return void kr.infoDialog(b.onlySingleCell,"");if(F.length==1){var N=F[0].row[0],z=F[0].row[1],P=F[0].column[0],q=F[0].column[1];if(N!=z||P!=q)return void kr.infoDialog(b.onlySingleCell,"");C=Hr(N,P,y),k.push({row:F[0].row,column:F[0].column}),w.push(C)}else if(F.length==0){if(isNaN(C)||C=="")return void kr.infoDialog(b.conditionValueCanOnly,"");w.push(C)}}else if(e=="greaterThan"||e=="lessThan"||e=="equal"){var V=n[0],x=kr.getRangeByTxt(V);if(x.length>1)return void kr.infoDialog(b.onlySingleCell,"");if(x.length==1){var ee=x[0].row[0],ne=x[0].row[1],ae=x[0].column[0],de=x[0].column[1];if(ee!=ne||ae!=de)return void kr.infoDialog(b.onlySingleCell,"");V=Hr(ee,ae,y),k.push({row:x[0].row,column:x[0].column}),w.push(V)}else if(x.length==0){if(isNaN(V)||V=="")return void kr.infoDialog(b.conditionValueCanOnly,"");w.push(V)}}else if(e=="textContains"){var ve=n[0],U=kr.getRangeByTxt(ve);if(U.length>1)return void kr.infoDialog(b.onlySingleCell,"");if(U.length==1){var B=U[0].row[0],le=U[0].row[1],Te=U[0].column[0],ue=U[0].column[1];if(B!=le||Te!=ue)return void kr.infoDialog(b.onlySingleCell,"");ve=Hr(B,Te,y),k.push({row:U[0].row,column:U[0].column}),w.push(ve)}else if(U.length==0){if(ve=="")return void kr.infoDialog(b.conditionValueCanOnly,"");w.push(ve)}}else if(e=="occurrenceDate"){var be,ye=n[0],ce=n[1];if(!un(ye)||!un(ce))return Ee.info("The conditionValue parameter is invalid.","");be=il(ye,ce)>0?Q(ce).format("YYYY/MM/DD")+"-"+Q(ye).format("YYYY/MM/DD"):Q(ye).format("YYYY/MM/DD")+"-"+Q(ce).format("YYYY/MM/DD"),w.push(be)}else if(e=="duplicateValue"){var Re=n[0];if(Re!="0"||Re!="1")return Ee.info("The conditionValue parameter is invalid.","");w.push(Re)}else if(e=="top10"||e=="top10%"||e=="last10"||e=="last10%"){var pe=n[0];if(parseInt(pe)!=pe||parseInt(pe)<1||parseInt(pe)>1e3)return void kr.infoDialog(b.pleaseEnterInteger,"");w.push(parseInt(pe))}else e!="AboveAverage"&&e!="SubAverage"||w.push(e);if(!d.hasOwnProperty("textColor")||!d.hasOwnProperty("cellColor"))return Ee.info("The format parameter is invalid.","");if(D(h)=="string"?h=kr.getRangeByTxt(h):D(h)=="object"&&(h=[h]),D(h)!="array")return Ee.info("The cellrange parameter is invalid.","");var me={type:"default",cellrange:h,format:d,conditionName:e,conditionRange:k,conditionValue:w},re=$.extend(!0,[],u.luckysheetfile),_e=kr.getHistoryRules(re),Ze=v.luckysheet_conditionformat_save||[];Ze.push(me),v.luckysheet_conditionformat_save=Ze;var We=$.extend(!0,[],u.luckysheetfile),Xe=kr.getCurrentRules(We);kr.ref(_e,Xe),nt.allowUpdate&&nt.saveParam("all",v.index,Ze,{k:"luckysheet_conditionformat_save"}),g&&typeof g=="function"&&g()},setRangeConditionalFormat:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["dataBar","colorGradation","icons"];if(!e||!t.includes(e))return Ee.info("The type parameter is invalid.","");var a=Dr({},n),l=a.format,o=a.cellrange,d=o===void 0?u.luckysheet_select_save:o,s=a.order,h=s===void 0?je(u.currentSheetIndex):s,f=a.success,p=u.luckysheetfile[h];if(p==null)return Ee.info("Incorrect worksheet index","");if(e=="dataBar"){if(l==null&&(l=["#638ec6","#ffffff"]),D(l)!="array"||l.length<1||l.length>2)return Ee.info("The format parameter is invalid.","")}else if(e=="colorGradation"){if(l==null&&(l=["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]),D(l)!="array"||l.length<2||l.length>3)return Ee.info("The format parameter is invalid.","")}else if(e=="icons"){l==null&&(l="threeWayArrowMultiColor");var g=["threeWayArrowMultiColor","threeTriangles","fourWayArrowMultiColor","fiveWayArrowMultiColor","threeWayArrowGrayColor","fourWayArrowGrayColor","fiveWayArrowGrayColor","threeColorTrafficLightRimless","threeSigns","greenRedBlackGradient","threeColorTrafficLightBordered","fourColorTrafficLight","threeSymbolsCircled","tricolorFlag","threeSymbolsnoCircle","threeStars","fiveQuadrantDiagram","fiveBoxes","grade4","grade5"];if(D(l)!="string"||!g.includes(l))return Ee.info("The format parameter is invalid.","");switch(l){case"threeWayArrowMultiColor":l={len:3,leftMin:0,top:0};break;case"threeTriangles":l={len:3,leftMin:0,top:1};break;case"fourWayArrowMultiColor":l={len:4,leftMin:0,top:2};break;case"fiveWayArrowMultiColor":l={len:5,leftMin:0,top:3};break;case"threeWayArrowGrayColor":l={len:3,leftMin:5,top:0};break;case"fourWayArrowGrayColor":l={len:4,leftMin:5,top:1};break;case"fiveWayArrowGrayColor":l={len:5,leftMin:5,top:2};break;case"threeColorTrafficLightRimless":l={len:3,leftMin:0,top:4};break;case"threeSigns":l={len:3,leftMin:0,top:5};break;case"greenRedBlackGradient":l={len:4,leftMin:0,top:6};break;case"threeColorTrafficLightBordered":l={len:3,leftMin:5,top:4};break;case"fourColorTrafficLight":l={len:4,leftMin:5,top:5};break;case"threeSymbolsCircled":l={len:3,leftMin:0,top:7};break;case"tricolorFlag":l={len:3,leftMin:0,top:8};break;case"threeSymbolsnoCircle":l={len:3,leftMin:5,top:7};break;case"threeStars":l={len:3,leftMin:0,top:9};break;case"fiveQuadrantDiagram":l={len:5,leftMin:0,top:10};break;case"fiveBoxes":l={len:5,leftMin:0,top:11};break;case"grade4":l={len:4,leftMin:5,top:9};break;case"grade5":l={len:5,leftMin:5,top:10}}}if(D(d)=="string"?d=kr.getRangeByTxt(d):D(d)=="object"&&(d=[d]),D(d)!="array")return Ee.info("The cellrange parameter is invalid.","");var v={type:e,cellrange:d,format:l},y=$.extend(!0,[],u.luckysheetfile),b=kr.getHistoryRules(y),k=p.luckysheet_conditionformat_save||[];k.push(v),p.luckysheet_conditionformat_save=k;var w=$.extend(!0,[],u.luckysheetfile),_=kr.getCurrentRules(w);kr.ref(b,_),nt.allowUpdate&&nt.saveParam("all",p.index,k,{k:"luckysheet_conditionformat_save"}),f&&typeof f=="function"&&f()},deleteRangeConditionalFormat:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!M(e))return Ee.info("The itemIndex parameter is invalid.","");e=Number(e);var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=$.extend(!0,[],d.luckysheet_conditionformat_save);if(s.length==0)return Ee.info("This worksheet has no conditional format to delete","");if(s[e]==null)return Ee.info("The conditional format of the index cannot be found","");var h=s.splice(e,1),f=$.extend(!0,[],u.luckysheetfile),p=kr.getHistoryRules(f);d.luckysheet_conditionformat_save=s;var g=$.extend(!0,[],u.luckysheetfile),v=kr.getCurrentRules(g);return kr.ref(p,v),nt.allowUpdate&&nt.saveParam("all",d.index,ruleArr,{k:"luckysheet_conditionformat_save"}),setTimeout(function(){o&&typeof o=="function"&&o()},1),h},clearRange:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.range,a=t===void 0?u.luckysheet_select_save:t,l=n.order,o=l===void 0?je(u.currentSheetIndex):l,d=n.success;if(D(a)=="string"){if(!m.iscelldata(a))return Ee.info("The range parameter is invalid.","");var s=m.getcellrange(a);a=[{row:s.row,column:s.column}]}else if(D(a)=="object"){if(a.row==null||a.column==null)return Ee.info("The range parameter is invalid.","");a=[{row:a.row,column:a.column}]}if(D(a)!="array")return Ee.info("The range parameter is invalid.","");var h=u.luckysheetfile[o];if(h==null)return Ee.info("The order parameter is invalid.","");for(var f=$.extend(!0,{},h.config),p=!1,g=0;g<a.length;g++){var v=a[g].row[0],y=a[g].row[1],b=a[g].column[0],k=a[g].column[1];if(p=mn(f,v,y,b,k))break}if(p)return Ee.info("Cannot perform this operation on partially merged cells","");var w=$.extend(!0,[],h.data);w.length==0&&(w=$.extend(!0,[],ir.buildGridData(h)));for(var _=0;_<a.length;_++)for(var C=a[_].row[0],A=a[_].row[1],I=a[_].column[0],S=a[_].column[1],E=C;E<=A;E++)for(var R=I;R<=S;R++){var F=w[E][R];D(F)=="object"?(delete F.m,delete F.v,F.f!=null&&(delete F.f,m.delFunctionGroup(E,R,h.index),delete F.spl),F.ct!=null&&F.ct.t=="inlineStr"&&delete F.ct):w[E][R]=null}h.index==u.currentSheetIndex?wa(w,a):h.data=w,d&&typeof d=="function"&&d()},deleteRange:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["left","up"];if(!t.includes(e))return Ee.info("The move parameter is invalid.","");var a=Dr({},n),l=a.range,o=l===void 0?u.luckysheet_select_save[u.luckysheet_select_save.length-1]:l,d=a.order,s=d===void 0?je(u.currentSheetIndex):d,h=a.success;if(D(o)=="string"){if(!m.iscelldata(o))return Ee.info("The range parameter is invalid.","");var f=m.getcellrange(o);o={row:f.row,column:f.column}}if(D(o)!="object"||o.row==null||o.column==null)return Ee.info("The range parameter is invalid.","");var p=u.luckysheetfile[s];if(p==null)return Ee.info("The order parameter is invalid.","");var g=o.row[0],v=o.row[1],y=o.column[0],b=o.column[1];e=="left"?xc("moveLeft",g,v,y,b,s):e=="up"&&xc("moveUp",g,v,y,b,s),h&&typeof h=="function"&&h()},matrixOperation:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=["flipUpDown","flipLeftRight","flipClockwise","flipCounterClockwise","transpose","deleteZeroByRow","deleteZeroByColumn","removeDuplicateByRow","removeDuplicateByColumn","newMatrix"];if(!e||t.indexOf(e)<0)return Ee.info("The type parameter is invalid.","");var a=u.luckysheet_select_save[0],l=Dr({},n),o=l.range,d=o===void 0?a:o,s=l.success;if(d instanceof Array&&d.length>1)Ee.info(st().drag.noMulti,"");else{d&&typeof d=="string"&&m.iscelldata(d)&&(d=m.getcellrange(d));var h=nn(d),f=[];if(h.length!==0){var p,g,v;switch(e){case"flipUpDown":for(var y=h.length-1;y>=0;y--){for(var b=[],k=0;k<h[0].length;k++){var w="";h[y]!=null&&h[y][k]!=null&&(w=h[y][k]),b.push(w)}f.push(b)}break;case"flipLeftRight":for(var _=0;_<h.length;_++){for(var C=[],A=h[0].length-1;A>=0;A--){var I="";h[_]!=null&&h[_][A]!=null&&(I=h[_][A]),C.push(I)}f.push(C)}break;case"flipClockwise":for(var S=0;S<h[0].length;S++){for(var E=[],R=h.length-1;R>=0;R--){var F="";h[R]!=null&&h[R][S]!=null&&(F=h[R][S]),E.push(F)}f.push(E)}break;case"flipCounterClockwise":for(var N=h[0].length-1;N>=0;N--){for(var z=[],P=0;P<h.length;P++){var q="";h[P]!=null&&h[P][N]!=null&&(q=h[P][N]),z.push(q)}f.push(z)}break;case"transpose":for(var V=0;V<h[0].length;V++){for(var x=[],ee=0;ee<h.length;ee++){var ne="";h[ee]!=null&&h[ee][V]!=null&&(ne=h[ee][V]),x.push(ne)}f.push(x)}break;case"deleteZeroByRow":p=h[0].length;for(var ae=0;ae<h.length;ae++){for(var de=[],ve=!0,U=!0,B=0;B<p;B++){var le="";if(h[ae]!=null&&h[ae][B]!=null){if(((le=h[ae][B]).v=="0"||le.v==0)&&ve)continue;ve=!1}de.push(le)}var Te=[];if(de.length==p)Te=de;else{for(var ue=de.length-1;ue>=0;ue--){var be="";if(de[ue]!=null){if(((be=de[ue]).v=="0"||be.v==0)&&U)continue;U=!1}Te.unshift(be)}for(var ye=p-Te.length,ce=0;ce<ye;ce++)Te.push("")}f.push(Te)}break;case"deleteZeroByColumn":p=h.length,g=h[0].length;for(var Re=0;Re<g;Re++){for(var pe=[],me=!0,re=!0,_e=0;_e<p;_e++){var Ze="";if(h[_e]!=null&&h[_e][Re]!=null){if(((Ze=h[_e][Re]).v=="0"||Ze.v==0)&&me)continue;me=!1}pe.push(Ze)}var We=[];if(pe.length==p)We=pe;else{for(var Xe=pe.length-1;Xe>=0;Xe--){var Ue="";if(pe[Xe]!=null){if(((Ue=pe[Xe]).v=="0"||Ue.v==0)&&re)continue;re=!1}We.unshift(Ue)}for(var mt=p-We.length,St=0;St<mt;St++)We.push("")}f.push(We)}v=[];for(var at=0;at<f[0].length;at++){for(var dt=[],wt=0;wt<f.length;wt++){var ct="";f[wt]!=null&&f[wt][at]!=null&&(ct=f[wt][at]),dt.push(ct)}v.push(dt)}break;case"removeDuplicateByRow":p=h[0].length;for(var bt=0;bt<h.length;bt++){for(var De=[],He={},Dt=0;Dt<p;Dt++){var et=null;h[bt]!=null&&h[bt][Dt]!=null&&((et=h[bt][Dt]).v in He||(He[et.v]=[]),He[et.v].push(et))}for(var ur=0;ur<p;ur++){var Xt=null;h[bt]!=null&&h[bt][ur]!=null&&He[(Xt=h[bt][ur]).v].length==1&&De.push(Xt)}for(var jt=p-De.length,lr=0;lr<jt;lr++)De.push(null);f.push(De)}break;case"removeDuplicateByColumn":g=h[0].length,p=h.length;for(var tr=0;tr<g;tr++){for(var xr=[],rr={},nr=0;nr<p;nr++){var Ut=null;h[nr]!=null&&h[nr][tr]!=null&&((Ut=h[nr][tr]).v in rr||(rr[Ut.v]=[]),rr[Ut.v].push(Ut))}for(var ar=0;ar<p;ar++){var Jt=null;h[ar]!=null&&h[ar][tr]!=null&&rr[(Jt=h[ar][tr]).v].length==1&&xr.push(Jt)}a1=xr;for(var Qt=p-a1.length,_t=0;_t<Qt;_t++)a1.push(null);f.push(a1)}v=[];for(var er=0;er<f[0].length;er++){for(var Kt=[],mr=0;mr<f.length;mr++){var fr=null;f[mr]!=null&&f[mr][er]!=null&&(fr=f[mr][er]),Kt.push(fr)}v.push(Kt)}break;case"newMatrix":console.log("TODO")}vr.controlHandler(f,d),s&&typeof s=="function"&&s()}}},matrixCalculation:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=["plus","minus","multiply","divided","power","root","log"];if(!e||a.indexOf(e)<0)return Ee.info("The type parameter is invalid.","");if(!M(n))return Ee.info("The number parameter is invalid.","");var l=u.luckysheet_select_save[0],o=Dr({},t),d=o.range,s=d===void 0?l:d,h=o.success;if(s instanceof Array&&s.length>1)Ee.info(st().drag.noMulti,"");else{s&&typeof s=="string"&&m.iscelldata(s)&&(s=m.getcellrange(s));var f=nn(s);if(f.length!=0){for(var p=[],g=0;g<f.length;g++){for(var v=[],y=0;y<f[0].length;y++){var b="";f[g]!=null&&f[g][y]!=null&&(b=f[g][y],parseInt(b)!=null&&f[g][y].ct!=null&&f[g][y].ct.t=="n"&&(e=="minus"?b.v=b.v-n:e=="multiply"?b.v=b.v*n:e=="divided"?b.v=numFormat(b.v/n,4):e=="power"?b.v=Math.pow(b.v,n):e=="root"?n==2?b.v=numFormat(Math.sqrt(b.v),4):n==3&&Math.cbrt?b.v=numFormat(Math.cbrt(b.v),4):b.v=numFormat(jfnqrt(b.v,n),4):b.v=e=="log"?numFormat(1e4*Math.log(b.v)/Math.log(Math.abs(n)),4):b.v+n,b.v==null?b.m="":b.m=b.v.toString())),v.push(b)}p.push(v)}vr.controlHandler(p,s),h&&typeof h=="function"&&h()}}},setSheetAdd:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=u.luckysheetfile.length-1,t=Dr({},e),a=t.sheetObject,l=a===void 0?{}:a,o=t.order,d=o===void 0?n:o,s=t.success;if(!M(d))return Ee.info("Parameter is not a table index","");d=Number(d);var h=ir.generateRandomSheetIndex();l.calcChain&&l.calcChain.length>0&&l.calcChain.forEach(function(A){A.index=h});var f=ir.generateRandomSheetName(u.luckysheetfile,!1);if(l.name){for(var p=!1,g=0;g<u.luckysheetfile.length;g++)if(u.luckysheetfile[g].name==l.name){p=!0;break}p||(f=l.name)}$("#luckysheet-sheet-container-c").append(br($i,{index:h,active:"",name:f,style:"",colorset:""}));var v={name:"",color:"",status:"0",order:"",index:"",celldata:[],row:u.defaultrowNum,column:u.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!1};if((v=$.extend(!0,v,l)).index=h,v.name=f,v.order=d,d<=0){var y=u.luckysheetfile[0].index,b=$("#luckysheet-sheets-item"+y);$("#luckysheet-sheets-item"+h).insertBefore(b),u.luckysheetfile.splice(0,0,v)}else{d>u.luckysheetfile.length&&(d=u.luckysheetfile.length);var k=u.luckysheetfile[d-1].index,w=$("#luckysheet-sheets-item"+k);$("#luckysheet-sheets-item"+h).insertAfter(w),u.luckysheetfile.splice(d,0,v)}var _={};if(u.luckysheetfile.forEach(function(A,I,S){S[I].order=I,_[A.index.toString()]=I}),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+h).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+h+'" class="luckysheet-datavisual-selection-set"></div>'),bl(!0),nt.saveParam("sha",null,$.extend(!0,{},v)),nt.saveParam("shr",null,_),u.clearjfundo){u.jfundo.length=0;var C={type:"addSheet"};C.sheetconfig=$.extend(!0,{},v),C.index=h,C.currentSheetIndex=u.currentSheetIndex,u.jfredo.push(C)}ir.changeSheetExec(h,!1,!0),s&&typeof s=="function"&&s()},setSheetDelete:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success,o=u.luckysheetfile[a];return o==null?Ee.info("The order parameter is invalid.",""):u.luckysheetfile.length===1?Ee.info(st().sheetconfig.noMoreSheet,""):(ir.deleteSheet(o.index),setTimeout(function(){l&&typeof l=="function"&&l()},1),o)},setSheetCopy:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.targetOrder,a=n.order,l=a===void 0?je(u.currentSheetIndex):a,o=n.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");if(t==null&&(t=l+1),!M(t))return Ee.info("The targetOrder parameter is invalid.","");var s=d.index,h=ir.generateRandomSheetIndex(),f=$.extend(!0,{},d);f.order=u.luckysheetfile.length,f.index=h,f.name=ir.generateCopySheetName(u.luckysheetfile,f.name);var p="";f.color!=null&&(p='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+f.color+';"></div>');var g=$("#luckysheet-sheets-item"+s);if(M(t)&&(g=$("#luckysheet-sheets-item"+u.luckysheetfile[t-1].index)),$("#luckysheet-sheet-container-c").append(br($i,{index:f.index,active:"",name:f.name,order:f.order,style:"",colorset:p})),$("#luckysheet-sheets-item"+f.index).insertAfter(g),u.luckysheetfile.splice(t,0,f),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+h).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+h+'" class="luckysheet-datavisual-selection-set"></div>'),bl(!0),nt.saveParam("shc",h,{copyindex:s,name:f.name}),ir.changeSheetExec(h),ir.reOrderAllSheet(),u.clearjfundo)u.jfredo.push({type:"copySheet",copyindex:s,index:f.index,sheetIndex:f.index});else if(u.jfredo.length>0){var v=u.jfredo[u.jfredo.length-1];v.type=="copySheet"&&(v.index=f.index,v.sheetIndex=f.index)}return setTimeout(function(){o&&typeof o=="function"&&o()},1),f},setSheetHide:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success,o=u.luckysheetfile[a];return o==null?Ee.info("The order parameter is invalid.",""):(ir.setSheetHide(o.index),setTimeout(function(){l&&typeof l=="function"&&l()},1),o)},setSheetShow:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success,o=u.luckysheetfile[a];return o==null?Ee.info("The order parameter is invalid.",""):(ir.setSheetShow(o.index),setTimeout(function(){l&&typeof l=="function"&&l()},1),o)},setSheetActive:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||!M(e)||u.luckysheetfile[e]==null)return Ee.info("The order parameter is invalid.","");var t=u.luckysheetfile[e],a=Dr({},n),l=a.success;return $("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+t.index).addClass("luckysheet-sheets-item-active"),ir.changeSheet(t.index),setTimeout(function(){l&&typeof l=="function"&&l()},1),nt.multipleRangeShow(),t},setSheetName:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="string"||e.toString().length==0)return Ee.info("The name parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=d.name;if(d.name=e,$("#luckysheet-sheets-item"+d.index+" .luckysheet-sheets-item-name").text(e),nt.saveParam("all",d.index,e,{k:"name"}),u.clearjfundo){var h={type:"sheetName"};h.sheetIndex=d.index,h.oldtxt=s,h.txt=e,u.jfundo.length=0,u.jfredo.push(h)}o&&typeof o=="function"&&o()},setSheetColor:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="string"||e.toString().length==0)return Ee.info("The color parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");var s=d.color;if(d.color=e,$("#luckysheet-sheets-item"+d.index).find(".luckysheet-sheets-item-color").remove(),$("#luckysheet-sheets-item"+d.index).append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e+';"></div>'),nt.saveParam("all",d.index,e,{k:"color"}),u.clearjfundo){var h={type:"sheetColor"};h.sheetIndex=d.index,h.oldcolor=s,h.color=e,u.jfundo.length=0,u.jfredo.push(h)}o&&typeof o=="function"&&o()},setSheetMove:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!="left"&&e!="right"&&!M(e))return Ee.info("Type parameter not available","");M(e)&&(e=parseInt(e));var t=je(u.currentSheetIndex),a=Dr({},n),l=a.order,o=l===void 0?t:l,d=a.success,s=u.luckysheetfile[o];if(s==null)return Ee.info("ncorrect worksheet index","");var h=s.index;if(e=="left"){if(o==0)return;var f=u.luckysheetfile[o-1].index;$("#luckysheet-sheets-item"+h).insertBefore($("#luckysheet-sheets-item"+f)),u.luckysheetfile.splice(o,1),u.luckysheetfile.splice(o-1,0,s)}else if(e=="right"){if(o==u.luckysheetfile.length-1)return;var p=u.luckysheetfile[o+1].index;$("#luckysheet-sheets-item"+h).insertAfter($("#luckysheet-sheets-item"+p)),u.luckysheetfile.splice(o,1),u.luckysheetfile.splice(o+1,0,s)}else{if(e<0&&(e=0),e>u.luckysheetfile.length-1&&(e=u.luckysheetfile.length-1),e==o)return;if(e<o){var g=u.luckysheetfile[e].index;$("#luckysheet-sheets-item"+h).insertBefore($("#luckysheet-sheets-item"+g))}else{var v=u.luckysheetfile[e].index;$("#luckysheet-sheets-item"+h).insertAfter($("#luckysheet-sheets-item"+v))}u.luckysheetfile.splice(o,1),u.luckysheetfile.splice(e,0,s)}var y={};u.luckysheetfile.forEach(function(b,k,w){w[k].order=k,y[b.index.toString()]=k}),nt.saveParam("shr",null,y),d&&typeof d=="function"&&d()},setSheetOrder:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||e.length==0)return Ee.info("Type orderList not available","");var t={};e.forEach(function(d){t[d.index.toString()]=d.order}),u.luckysheetfile.sort(function(d,s){var h=t[d.index.toString()],f=t[s.index.toString()];return h!=null&&f!=null?h-f:h!=null?-1:1});var a={};u.luckysheetfile.forEach(function(d,s,h){if(h[s].order=s,a[d.index.toString()]=s,s>0){var f=h[s-1].index;$("#luckysheet-sheets-item"+d.index).insertAfter($("#luckysheet-sheets-item"+f))}}),nt.saveParam("shr",null,a);var l=Dr({},n),o=l.success;o&&typeof o=="function"&&o()},setSheetZoom:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!M(e)||e<.1||e>4)return Ee.info("The zoom parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");d.zoomRatio=e,nt.saveParam("all",d.index,e,{k:"zoomRatio"}),d.index==u.currentSheetIndex&&(u.zoomRatio=e,Co(),pd()),o&&typeof o=="function"&&o()},showGridLines:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success,o=u.luckysheetfile[a];return o==null?Ee.info("The order parameter is invalid.",""):(o.showGridLines=!0,o.index==u.currentSheetIndex&&(u.showGridLines=!0,setTimeout(function(){Kr()},1)),setTimeout(function(){l&&typeof l=="function"&&l()},1),o)},hideGridLines:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success,o=u.luckysheetfile[a];return o==null?Ee.info("The order parameter is invalid.",""):(o.showGridLines=!1,o.index==u.currentSheetIndex&&(u.showGridLines=!1,setTimeout(function(){Kr()},1)),setTimeout(function(){l&&typeof l=="function"&&l()},1),o)},refresh:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wa();var n=Dr({},e),t=n.success;t&&typeof t=="function"&&t()},scroll:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.scrollLeft,a=n.scrollTop,l=n.targetRow,o=n.targetColumn,d=n.success;if(t!=null){if(!M(t))return Ee.info("The scrollLeft parameter is invalid.","");$("#luckysheet-scrollbar-x").scrollLeft(t)}else if(o!=null){if(!M(o))return Ee.info("The targetColumn parameter is invalid.","");u.visibledatacolumn[o];var s=o<=0?0:u.visibledatacolumn[o-1];$("#luckysheet-scrollbar-x").scrollLeft(s)}if(a!=null){if(!M(a))return Ee.info("The scrollTop parameter is invalid.","");$("#luckysheet-scrollbar-y").scrollTop(a)}else if(l!=null){if(!M(l))return Ee.info("The targetRow parameter is invalid.","");u.visibledatarow[l];var h=l<=0?0:u.visibledatarow[l-1];$("#luckysheet-scrollbar-y").scrollTop(h)}d&&typeof d=="function"&&d()},resize:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rn();var n=Dr({},e),t=n.success;t&&typeof t=="function"&&t()},getScreenshot:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.range,a=t===void 0?u.luckysheet_select_save[u.luckysheet_select_save.length-1]:t;if(D(a)=="string"){if(!m.iscelldata(a))return Ee.info("The range parameter is invalid.","");var l=m.getcellrange(a);a={row:l.row,column:l.column}}if(D(a)!="object"||a.row==null||a.column==null)return Ee.info("The range parameter is invalid.","");var o=a.row[0],d=a.row[1],s=a.column[0],h=a.column[1],f=mn(u.config,o,d,s,h);if(f)return Ee.info("Cannot perform this operation on partially merged cells","");var p,g,v,y,b=u.visibledatarow,k=u.visibledatacolumn;o-1<0?(p=0,g=b[d]):(p=b[o-1],g=b[d]-b[o-1]),s-1<0?(v=0,y=k[h]):(v=k[s-1],y=k[h]-k[s-1]);var w=$("<canvas>").attr({width:Math.ceil(y*u.devicePixelRatio),height:Math.ceil(g*u.devicePixelRatio)}).css({width:y,height:g});Mi(v,p,y,g,1,1,null,null,w);var _=w.get(0).getContext("2d");_.beginPath(),_.moveTo(0,0),_.lineTo(0,u.devicePixelRatio*g),_.lineWidth=2*u.devicePixelRatio,_.strokeStyle=Fi,_.stroke(),_.closePath(),_.beginPath(),_.moveTo(0,0),_.lineTo(u.devicePixelRatio*y,0),_.lineWidth=2*u.devicePixelRatio,_.strokeStyle=Fi,_.stroke(),_.closePath();var C=w.get(0).toDataURL("image/png");return C},setWorkbookName:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||e.toString().length==0)return Ee.info("The name parameter is invalid.","");$("#luckysheet_info_detail_input").val(e);var t=Dr({},n),a=t.success;a&&typeof a=="function"&&a()},getWorkbookName:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n="",t=$("#luckysheet_info_detail_input");if(t.length==0)return Ee.info("Failed to get workbook name, label loading failed!"),n;n=$.trim(t.val());var a=Dr({},e),l=a.success;return setTimeout(function(){l&&typeof l=="function"&&l()},1),n},undo:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=$.extend(!0,{},u.jfredo[u.jfredo.length-1]);im(new Event("custom")),To();var t=Dr({},e),a=t.success;return setTimeout(function(){a&&typeof a=="function"&&a()},1),n},redo:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=$.extend(!0,{},u.jfundo[u.jfundo.length-1]);om(new Event("custom")),To();var t=Dr({},e),a=t.success;return setTimeout(function(){a&&typeof a=="function"&&a()},1),n},getAllSheets:jg,getSheet:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.index,a=n.order,l=n.name;return t!=null?ir.getSheetByIndex(t):a!=null?u.luckysheetfile[a]:l!=null?ir.getSheetByName(l):ir.getSheetByIndex()},getSheetData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=u.luckysheetfile[a];if(l==null)return Ee.info("The order parameter is invalid.","");var o=$.extend(!0,[],l.data);return o!=null&&o.length!=0||(o=$.extend(!0,[],ir.buildGridData(l))),o},getConfig:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=u.luckysheetfile[a];if(l==null)return Ee.info("The order parameter is invalid.","");var o=$.extend(!0,{},l.config);return o},setConfig:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="object")return Ee.info("The cfg parameter is invalid.","");var t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.success,d=u.luckysheetfile[l];if(d==null)return Ee.info("The order parameter is invalid.","");d.config=e,d.index==u.currentSheetIndex&&(u.config=e,("rowhidden"in e||"colhidden"in e||"rowlen"in e||"columnlen"in e)&&ln(u.flowdata.length,u.flowdata[0].length),setTimeout(function(){Kr()},1)),o&&typeof o=="function"&&o()},getLuckysheetfile:function(){return an()},setDataVerification:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(e)!="object")return Ee.info("The optionItem parameter is invalid.","");var t=Dr({},e),a=t.type,l=t.type2,o=l===void 0?null:l,d=t.value1,s=d===void 0?"":d,h=t.value2,f=h===void 0?"":h,p=t.remote,g=p!==void 0&&p,v=t.prohibitInput,y=v!==void 0&&v,b=t.hintShow,k=b!==void 0&&b,w=t.hintText,_=w===void 0?"":w,C=t.checked,A=C!==void 0&&C,I=["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"],S=["bw","nb","eq","ne","gt","lt","gte","lte"],E=["include","exclude","equal"],R=["bw","nb","eq","ne","bf","nbf","af","naf"],F=["card","phone"];if(!I.includes(a))return Ee.info("The optionItem.type parameter is invalid.","");var N=st().dataVerification;if(a=="dropdown"){if(s.length==0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo1)}else if(a=="checkbox"){if(s.length==0||f.length==0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo2)}else if(a=="number"||a=="number_integer"||a=="number_decimal"){if(!S.includes(o))return Ee.info("The optionItem.type2 parameter is invalid.","");if(!M(s))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo3);if(o=="bw"||o=="nb"){if(!M(f))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo3);if(Number(f)<Number(s))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo4)}}else if(a=="text_content"){if(!E.includes(o))return Ee.info("The optionItem.type2 parameter is invalid.","");if(s.length==0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo5)}else if(a=="text_length"){if(!S.includes(o))return Ee.info("The optionItem.type2 parameter is invalid.","");if(!M(s))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo3);if(o=="bw"||o=="nb"){if(!M(f))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo3);if(Number(f)<Number(s))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo4)}}else if(a=="date"){if(!R.includes(o))return Ee.info("The optionItem.type2 parameter is invalid.","");if(!un(s))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo6);if(o=="bw"||o=="nb"){if(!un(f))return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo6);if(il(s,f)>0)return void Ee.info('<i class="fa fa-exclamation-triangle"></i>',N.tooltipInfo7)}}else if(a=="validity"&&!F.includes(o))return Ee.info("The optionItem.type2 parameter is invalid.","");if(D(g)!="boolean")return Ee.info("The optionItem.remote parameter is invalid.","");if(D(y)!="boolean")return Ee.info("The optionItem.prohibitInput parameter is invalid.","");if(D(k)!="boolean")return Ee.info("The optionItem.hintShow parameter is invalid.","");var z=Dr({},n),P=z.range,q=P===void 0?u.luckysheet_select_save[u.luckysheet_select_save.length-1]:P,V=z.order,x=V===void 0?je(u.currentSheetIndex):V,ee=z.success;if(D(q)=="string"){if(!m.iscelldata(q))return Ee.info("The range parameter is invalid.","");var ne=m.getcellrange(q);q={row:ne.row,column:ne.column}}if(D(q)!="object"||q.row==null||q.column==null)return Ee.info("The range parameter is invalid.","");var ae=u.luckysheetfile[x];if(ae==null)return Ee.info("The order parameter is invalid.","");var de={type:a,type2:o,value1:s,value2:f,checked:A,remote:g,prohibitInput:y,hintShow:k,hintText:_},ve=$.extend(!0,{},ae.dataVerification),U=$.extend(!0,[],ae.data);U.length==0&&(U=ir.buildGridData(ae));for(var B=q.row[0],le=q.row[1],Te=q.column[0],ue=q.column[1],be=B;be<=le;be++)for(var ye=Te;ye<=ue;ye++)ve[be+"_"+ye]=de,a=="checkbox"&&(de.checked?Ln(be,ye,U,de.value1):Ln(be,ye,U,de.value2));if(ae.index==u.currentSheetIndex){var ce=$.extend(!0,{},ae.dataVerification);a=="checkbox"?aa.refOfCheckbox(ce,ve,u.currentSheetIndex,U,q):aa.ref(ce,ve,u.currentSheetIndex)}else ae.dataVerification=ve,ae.data=U;ee&&typeof ee=="function"&&ee()},deleteDataVerification:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.range,a=t===void 0?u.luckysheet_select_save[u.luckysheet_select_save.length-1]:t,l=n.order,o=l===void 0?je(u.currentSheetIndex):l,d=n.success;if(D(a)=="string"){if(!m.iscelldata(a))return Ee.info("The range parameter is invalid.","");var s=m.getcellrange(a);a={row:s.row,column:s.column}}if(D(a)!="object"||a.row==null||a.column==null)return Ee.info("The range parameter is invalid.","");var h=u.luckysheetfile[o];if(h==null)return Ee.info("The order parameter is invalid.","");for(var f=$.extend(!0,{},h.dataVerification),p=a.row[0],g=a.row[1],v=a.column[0],y=a.column[1],b=p;b<=g;b++)for(var k=v;k<=y;k++)delete f[b+"_"+k];if(h.index==u.currentSheetIndex){var w=$.extend(!0,{},h.dataVerification);aa.ref(w,f,u.currentSheetIndex)}else h.dataVerification=f;d&&typeof d=="function"&&d()},insertImage:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=Dr({},n),a=t.order,l=a===void 0?je(u.currentSheetIndex):a,o=t.rowIndex,d=t.colIndex,s=t.success,h=u.luckysheetfile[l];if(h==null)return Ee.info("The order parameter is invalid.","");if(h.index==u.currentSheetIndex){var f=u.luckysheet_select_save[u.luckysheet_select_save.length-1];o==null&&(o=f.row_focus||0),o<0&&(o=0),o>u.visibledatarow.length&&(o=u.visibledatarow.length),d==null&&(d=f.column_focus||0),d<0&&(d=0),d>u.visibledatacolumn.length&&(d=u.visibledatacolumn.length);var p=d==0?0:u.visibledatacolumn[d-1],g=o==0?0:u.visibledatarow[o-1],v=new Image;v.onload=function(){var V=v.width,x=v.height,ee={src:e,left:p,top:g,originWidth:V,originHeight:x};_r.addImgItem(ee),s&&typeof s=="function"&&s()},v.src=e}else{var y=h.images||{},b=h.config,k=h.zoomRatio||1,w=h.row,_=h.visibledatarow||[];if(_.length===0)for(var C=0,A=0;A<w;A++){var I=u.defaultrowlen;b.rowlen!=null&&b.rowlen[A]!=null&&(I=b.rowlen[A]),(b.rowhidden==null||b.rowhidden[A]==null)&&(C+=Math.round((I+1)*k)),_.push(C)}var S=h.column,E=h.visibledatacolumn||[];if(E.length===0)for(var R=0,F=0;F<S;F++){var N=u.defaultcollen;b.columnlen!=null&&b.columnlen[F]!=null&&(N=b.columnlen[F]),(b.colhidden==null||b.colhidden[F]==null)&&(R+=Math.round((N+1)*k)),E.push(R)}o==null&&(o=0),o<0&&(o=0),o>_.length&&(o=_.length),d==null&&(d=0),d<0&&(d=0),d>E.length&&(d=E.length);var z=d==0?0:E[d-1],P=o==0?0:_[o-1],q=new Image;q.onload=function(){var V,x,ee={src:e,left:z,top:P,originWidth:q.width,originHeight:q.height};ee.originHeight<ee.originWidth?(x=Math.round(ee.originHeight*(400/ee.originWidth)),V=400):(V=Math.round(ee.originWidth*(400/ee.originHeight)),x=400);var ne=$.extend(!0,{},_r.imgItem);ne.src=ee.src,ne.originWidth=ee.originWidth,ne.originHeight=ee.originHeight,ne.default.width=V,ne.default.height=x,ne.default.left=ee.left,ne.default.top=ee.top,ne.crop.width=V,ne.crop.height=x;var ae=_r.generateRandomId();y[ae]=ne,h.images=y,s&&typeof s=="function"&&s()},q.src=e}},deleteImage:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.idList,o=l===void 0?"all":l,d=n.success,s=u.luckysheetfile[a];if(s==null)return Ee.info("The order parameter is invalid.","");var h=s.images;return h==null?Ee.info("The worksheet has no pictures to delete.",""):o!="all"&&D(o)!="array"?Ee.info("The idList parameter is invalid.",""):(D(o)=="array"?o.forEach(function(f){delete h[f]}):h=null,s.images=h,s.index==u.currentSheetIndex&&(_r.currentImgId==null||o!="all"&&!o.includes(_r.currentImgId)||($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide()),_r.images=h,_r.allImagesShow(),_r.init()),void(d&&typeof d=="function"&&d()))},getImageOption:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Dr({},e),t=n.order,a=t===void 0?je(u.currentSheetIndex):t,l=n.success,o=u.luckysheetfile[a];return o==null?Ee.info("The order parameter is invalid.",""):(setTimeout(function(){l&&typeof l=="function"&&l()},1),o.images)},transToCellData:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=Dr({},n),a=t.success;return setTimeout(function(){a&&typeof a=="function"&&a()},0),ir.getGridData(e)},transToData:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=Dr({},n),a=t.success;return setTimeout(function(){a&&typeof a=="function"&&a()},0),ir.buildGridData({celldata:e})},toJson:hm,changLang:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"zh";if(!["zh","en","es"].includes(e))return Ee.info("The lang parameter is invalid.","");var n=hm();n.lang=e,luckysheet.create(n)},closeWebsocket:function(){nt.websocket!=null&&nt.websocket.close(1e3)},getRangeByTxt:function(e){if(e==null)return{column:u.luckysheet_select_save[u.luckysheet_select_save.length-1].column,row:u.luckysheet_select_save[u.luckysheet_select_save.length-1].row};var n=kr.getRangeByTxt(e);return{column:n[0].column,row:n[0].row}},getTxtByRange:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u.luckysheet_select_save;return D(e)==="object"&&(e=[e]),kr.getTxtByRange(e)},pagerInit:Gg,refreshFormula:function(e){m.execFunctionGroupForce(!0),Kr(),setTimeout(function(){e&&typeof e=="function"&&e()})},refreshMenuButtonFocus:mm}),Wb=function(e,n,t){var a=u.visibledatarow[e],l=e==0?0:u.visibledatarow[e-1],o=u.visibledatacolumn[n],d=n==0?0:u.visibledatacolumn[n-1],s=dr.mergeborer(u.flowdata,e,n),h=t.ct.fa||"YYYY-MM-DD",f=za("yyyy-MM-dd hh:mm:ss",t.v),p=function(_){var C=_.replace(/y/g,"Y");return(C=(C=(C=(C=(C=(C=(C=(C=(C=C.replace(/d/g,"D")).replace(/h/g,"H")).replace(/\//g,"A")).replace(//g,"A")).replace(//g,"A")).replace(/AM\/PM/g,"A")).replace(/AM/g,"A")).replace(/PM/g,"A")).replace(/\"/g,"")).includes("A")&&(C=C.replace(/H/g,"h")),C}(h),g=!1,v=!1,y=!1,b=!0,k=!1;s&&(a=s.row[1],l=s.row[0],o=s.column[1],d=s.column[0]),$(".cell-date-picker").show().css({width:o-d+1,height:a-l+1,left:d,top:l}),/[]/.test(h)&&(k=!0),/[Hhms]/.test(p)&&(g=!0),/[YMD]/.test(p)||(v=!0),/s/.test(p)&&(y=!0),/A/.test(p)&&(b=!1);var w=qg("#luckysheet-input-box",{allowInput:!1,noCalendar:v,enableSeconds:y,enableTime:g,dateFormat:p,time_24hr:b,defaultDate:f,onClose:function(){setTimeout(function(){w.destroy()},0)},parseDate:function(_,C){return Q(_).toDate()},formatDate:function(_,C,A){return k?Q(_).format(C).replace("AM","").replace("PM",""):Q(_).format(C)},onChange:function(_,C){var A=xp(new Date(_));$("#luckysheet-rich-text-editor").html(C),Ic(e,n,A,{isRefresh:!1}),Mg(e,n,"ct",t.ct),g||m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1])}});$("#luckysheet-input-box").click()};function ri(e,n,t,a,l){if(Up(e,n,u.currentSheetIndex)){if(!Rt()&&u.allowEdit!==!1){if(Ya.createHookFunction("cellEditBefore",u.luckysheet_select_save),nt.saveParam("mv",u.currentSheetIndex,{op:"enterEdit",range:u.luckysheet_select_save}),aa.dataVerification!=null&&aa.dataVerification[e+"_"+n]!=null){var o=aa.dataVerification[e+"_"+n];if(o.type=="dropdown")aa.dropdownListShow();else if(o.type=="checkbox")return}var d=Wg(e,n,t),s=d.row,h=d.row_pre,f=d.col,p=d.col_pre,g=d.row_index,v=d.col_index;$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove();var y=$(window).height(),b=$(window).width(),k=$("#"+u.container).offset(),w=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop();if(!Pr.isPivotRange(g,v)){var C=p+k.left+u.rowHeaderWidth-w-2;Ne.freezenverticaldata!=null&&n<=Ne.freezenverticaldata[1]&&(C=p+k.left+u.rowHeaderWidth-2);var A=h+k.top+u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight-_-2;Ne.freezenhorizontaldata!=null&&e<=Ne.freezenhorizontaldata[1]&&(A=h+k.top+u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight-2);var I={"min-width":f-p+1-8,"min-height":s-h+1-4,"max-width":b+w-p-20-u.rowHeaderWidth,"max-height":y+_-h-20-15-u.toolbarHeight-u.infobarHeight-u.calculatebarHeight-u.sheetBarHeight-u.statisticBarHeight,left:C,top:A},S={transform:"scale("+u.zoomRatio+")","transform-origin":"left top",width:100/u.zoomRatio+"%",height:100/u.zoomRatio+"%"};u.luckysheetCellUpdate=[g,v],l||$("#luckysheet-rich-text-editor").focus().select(),$("#luckysheet-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px",right:"auto","overflow-y":"auto","box-sizing":"initial",display:"flex"}),Ne.freezenverticaldata==null&&Ne.freezenhorizontaldata==null||$("#luckysheet-input-box").css("z-index",10002),$("#luckysheet-input-box-index").html(ya(v)+(g+1)).hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").addClass("luckysheet-wa-calculate-active");var E="",R=!1;if(t[g]!=null&&t[g][v]!=null){var F=t[g][v],N=F.ht,z="left",P="top";N=="0"?(I={"min-width":f-p+1-8,"min-height":s-h+1-4,"max-width":2*b/3,"max-height":y+_-h-20-15-u.toolbarHeight-u.infobarHeight-u.calculatebarHeight-u.sheetBarHeight-u.statisticBarHeight,left:p+k.left+u.rowHeaderWidth-w-2,top:h+k.top+u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight-_-2},u.zoomRatio<1&&(z="center"),R=!0):N=="2"&&(I={"min-width":f-p+1-8,"min-height":s-h+1-4,"max-width":f+k.left-w-8,"max-height":y+_-h-20-15-u.toolbarHeight-u.infobarHeight-u.calculatebarHeight-u.sheetBarHeight-u.statisticBarHeight,right:b-(k.left+(u.rowHeaderWidth-1)-w)-f,top:h+k.top+u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight-_-2},u.zoomRatio<1&&(z="right")),F.vt=="0"?P="center":F.vt=="2"&&(P="bottom"),S["transform-origin"]=z+" "+P,a||(qi(F)?E=function(ve,U,B){var le=Hr(ve,U,B,"ct");if(B==null&&(B=u.flowdata),B[ve][U],Ih(le)){for(var Te=le.s,ue="",be=0;be<Te.length;be++){var ye=Te[be];ye.v!=null&&(ue+="<span index='"+be+"' style='"+od(ye)+"'>"+ye.v+"</span>")}return ue}return""}(g,v,t):F.f!=null?E=Hr(g,v,t,"f"):(E=uu(g,v,t),F.qp=="1"&&(E="'"+E)));var q=dr.getStyleByCell(t,g,v);q=$("#luckysheet-input-box").get(0).style.cssText+q,$("#luckysheet-input-box").get(0).style.cssText=q,$("#luckysheet-input-box").get(0).style.backgroundColor=="rgba(0, 0, 0, 0)"&&($("#luckysheet-input-box").get(0).style.background="rgb(255,255,255)")}else{var V=Un.getComputeMap(),x=Un.checksAF(g,v,V),ee=kr.getComputeMap(),ne=kr.checksCF(g,v,ee);ne!=null&&ne.cellColor!=null?$("#luckysheet-input-box").get(0).style.background=ne.cellColor:x!=null&&($("#luckysheet-input-box").get(0).style.background=x[1])}if(I["min-height"]>I["max-height"]&&(I["min-height"]=I["max-height"]),I["min-width"]>I["max-width"]&&(I["min-width"]=I["max-width"]),E!=null&&E.toString()!=""||a||(E="<br/>"),!Hp(g,v,u.currentSheetIndex)&&E.length>0&&E.substr(0,63)=='<span dir="auto" class="luckysheet-formula-text-color">=</span>'?$("#luckysheet-rich-text-editor").html(""):($("#luckysheet-rich-text-editor").html(E),l||rs($("#luckysheet-rich-text-editor")[0])),R){var ae=$("#luckysheet-input-box").width();ae>I["max-width"]&&(ae=I["max-width"]),ae<I["min-width"]&&(ae=I["min-width"]);var de=I.left-ae/2+(f-p)/2;de<2&&(de=2),I.left=de-2}$("#luckysheet-input-box").css(I),$("#luckysheet-rich-text-editor").css(S),t[e][n]&&t[e][n].ct&&t[e][n].ct.t=="d"&&Wb(e,n,t[e][n]),m.rangetosheet=u.currentSheetIndex,m.createRangeHightlight(),m.rangeResizeTo=$("#luckysheet-rich-text-editor"),bl()}}}else $("#luckysheet-functionbox-cell").blur()}function Wg(e,n,t){var a=u.visibledatarow[e],l=e-1==-1?0:u.visibledatarow[e-1],o=u.visibledatacolumn[n],d=n-1==-1?0:u.visibledatacolumn[n-1];t==null&&(t=u.flowdata);var s=dr.mergeborer(t,e,n);return s&&(a=s.row[1],l=s.row[0],e=s.row[2],o=s.column[1],d=s.column[0],n=s.column[2]),{row:a,row_pre:l,row_index:e,col:o,col_pre:d,col_index:n}}var yd={singleRangeFocus:!1,init:function(){var e=this,n=st(),t=n.formula;n.button,$(document).off("focus.IFcompareValue").on("focus.IFcompareValue","#luckysheet-ifFormulaGenerator-dialog #compareValue",function(){$("#luckysheet-modal-dialog-mask").hide(),e.singleRangeFocus=!0}),$(document).off("click.IFsingRange").on("click.IFsingRange","#luckysheet-ifFormulaGenerator-dialog .singRange",function(){var a=$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val().trim();m.iscelldata(a)?e.singleRangeDialog(a):e.singleRangeDialog()}),$(document).off("click.IFsingRangeConfirm").on("click.IFsingRangeConfirm","#luckysheet-ifFormulaGenerator-singleRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();var a=$(this).parents("#luckysheet-ifFormulaGenerator-singleRange-dialog").find("input").val().trim();$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val(a),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeCancel").on("click.IFsingRangeCancel","#luckysheet-ifFormulaGenerator-singleRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeClose").on("click.IFsingRangeClose","#luckysheet-ifFormulaGenerator-singleRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRange").on("click.IFmultiRange","#luckysheet-ifFormulaGenerator-dialog .multiRange",function(){e.multiRangeDialog(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRangeConfirm").on("click.IFmultiRangeConfirm","#luckysheet-ifFormulaGenerator-multiRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();for(var a=$(this).parents("#luckysheet-ifFormulaGenerator-multiRange-dialog").find("input").val().trim(),l=m.getcellrange(a),o=l.row[0],d=l.row[1],s=l.column[0],h=l.column[1],f=vr.deepCopyFlowData(u.flowdata),p=[],g=o;g<=d;g++)for(var v=s;v<=h;v++)f[g]!=null&&f[g][v]!=null&&f[g][v].ct!=null&&f[g][v].ct.t=="n"&&p.push(f[g][v].v);for(var y=0;y<p.length;y++)for(var b=0;b<p.length-1-y;b++)if(p[b]<p[b+1]){var k=p[b];p[b]=p[b+1],p[b+1]=k}var w=p[0],_=p[p.length-1];$("#luckysheet-ifFormulaGenerator-dialog #smallRange").val(_),$("#luckysheet-ifFormulaGenerator-dialog #largeRange").val(w)}),$(document).off("click.IFmultiRangeCancel").on("click.IFmultiRangeCancel","#luckysheet-ifFormulaGenerator-multiRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).off("click.IFmultiRangeClose").on("click.IFmultiRangeClose","#luckysheet-ifFormulaGenerator-multiRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).on("change","#DivisionMethod",function(){$(this).find("option:selected").val()=="2"?$("#DivisionMethodVal").hide():$("#DivisionMethodVal").show(),$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty()}),$(document).off("click.IFcreateBtn").on("click.IFcreateBtn","#luckysheet-ifFormulaGenerator-dialog #createBtn",function(){var a=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#compareValue").val().trim();if(a!=""){var l=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethod option:selected").val();if(l=="2"){var o='<div class="item"><input type="number" class="smallNum formulaInputFocus"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+a+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus"/><span>'+t.ifGenTipLableTitile+'</span><input type="text" class="markText formulaInputFocus" value=""><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(o)}else{var d=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#smallRange").val().trim(),s=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#largeRange").val().trim(),h=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethodVal").val().trim();if(d==""||s=="")return void e.info(t.ifGenTipRangeNotforNull);if(h=="")return void e.info(t.ifGenTipCutValueNotforNull);e.getIfList(a,d,s,l,h)}}else e.info(t.ifGenTipNotNullValue)}),$(document).on("click","#luckysheet-ifFormulaGenerator-dialog .item .fa-remove",function(){$(this).parents(".item").remove()}),$(document).off("click.IFconfirmBtn").on("click.IFconfirmBtn","#luckysheet-ifFormulaGenerator-dialog-confirm",function(){var a=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find(".ifList .item"),l="";if($(a.toArray().reverse()).each(function(d,s){var h,f,p,g=$(s).find(".smallNum").val().trim(),v=$(s).find(".largeNum").val().trim(),y=$(s).find(".operator option:selected").val(),b=$(s).find(".operator2 option:selected").val(),k=$(s).find(".compareValue").text(),w=$(s).find(".markText").val().trim();if(w==""&&(w=t.ifGenTipLableTitile+(d+1)),g==""&&v=="")return!0;h=y=="0"?k+">="+g:k+">"+g,f=b=="0"?k+"<="+v:k+"<"+v,p=d==0&&v==""?h:d==a.length-1&&g==""?f:"and("+h+","+f+")",l=d==0?"if("+p+',"'+w+'")':"if("+p+',"'+w+'",'+l+")"}),l.length!=0){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide();var o=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(o.row_focus,o.column_focus,u.flowdata),$("#luckysheet-rich-text-editor").html("="+l),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),$("#luckysheet-wa-functionbox-confirm").click()}else e.info(t.ifGenTipNotGenCondition)}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-model-close-btn",function(){$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-modal-dialog-mask").show()})},ifFormulaDialog:function(e){var n=st(),t=n.formula,a=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").remove();var l="",o="";if(e)for(var d=e.split("if("),s=1;s<d.length;s++){var h=d[s].replace("and(","").replace(/\)/g,"").replace(/\"/g,"").split(",");h=this.clearArr(h),l=this.splitTxt(h[0])[0];var f=void 0,p=void 0,g=void 0;h.length==3?(f=this.splitTxt(h[0])[1],p=this.splitTxt(h[1])[2],g=h[2]):(f=this.splitTxt(h[0])[1],p=this.splitTxt(h[0])[2],g=h[1]),o+='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+f+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+l+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+p+'"/><span>'+t.ifGenTipLableTitile+'</span><input type="text" class="markText formulaInputFocus" value="'+g+'"><i class="fa fa-remove" aria-hidden="true"></i></div>'}var v='<div class="ifAttr"><div class="attrBox"><label for="compareValue"> '+t.ifGenCompareValueTitle+' </label><div class="inpBox"><input id="compareValue" class="formulaInputFocus" value="'+l+'"/><i class="singRange fa fa-table" aria-hidden="true" title="'+t.ifGenSelectCellTitle+'"></i></div></div><div class="attrBox"><label for="smallRange"> '+t.ifGenRangeTitle+' </label><input type="number" id="smallRange" class="formulaInputFocus"/><span class="text"> '+t.ifGenRangeTo+' </span><input type="number" id="largeRange" class="formulaInputFocus"/><div id="rangeAssess"><span> '+t.ifGenRangeEvaluate+' </span><i class="multiRange fa fa-table" aria-hidden="true" title="'+t.ifGenSelectRangeTitle+'"></i></div></div><div class="attrBox"><label for="DivisionMethod"> '+t.ifGenCutWay+' </label><select id="DivisionMethod"><option value="0"> '+t.ifGenCutSame+' </option><option value="1"> '+t.ifGenCutNpiece+' </option><option value="2"> '+t.ifGenCutCustom+' </option></select><input id="DivisionMethodVal" class="formulaInputFocus"/><div id="createBtn"> '+t.ifGenCutSame+' </div></div></div><div class="ifList">'+o+"</div>";$("body").append(br(Ga,{id:"luckysheet-ifFormulaGenerator-dialog",addclass:"luckysheet-ifFormulaGenerator-dialog",title:t.ifGenerate,content:v,botton:'<button id="luckysheet-ifFormulaGenerator-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));var y=$("#luckysheet-ifFormulaGenerator-dialog").find(".luckysheet-modal-dialog-content").css("min-width",590).end(),b=y.outerHeight(),k=y.outerWidth(),w=$(window).width(),_=$(window).height(),C=$(document).scrollLeft(),A=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-dialog").css({left:(w+C-k)/2,top:(_+A-b)/3}).show()},clearArr:function(e){for(var n=0;n<e.length;n++)e[n]!=""&&e[n]!=null&&e[n]!=null||e.splice(n,1);return e},splitTxt:function(e){var n,t;return e.indexOf(">=")!=-1?[e.split(">=")[0],n=e.split(">=")[1],t]:e.indexOf(">")!=-1?[e.split(">")[0],n=e.split(">")[1],t]:e.indexOf("<=")!=-1?[e.split("<=")[0],n,t=e.split("<=")[1]]:e.indexOf("<")!=-1?[e.split("<")[0],n,t=e.split("<")[1]]:void 0},singleRangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").remove();var n=st(),t=n.formula,a=n.button;e==null&&(e=""),$("body").append(br(Ga,{id:"luckysheet-ifFormulaGenerator-singleRange-dialog",addclass:"luckysheet-ifFormulaGenerator-singleRange-dialog",title:t.ifGenTipSelectCell,content:'<input readonly="readonly" placeholder="'+t.ifGenTipSelectCellPlace+'" value="'+e+'">',botton:'<button id="luckysheet-ifFormulaGenerator-singleRange-confirm" class="btn btn-primary">'+a.confirm+'</button><button id="luckysheet-ifFormulaGenerator-singleRange-cancel" class="btn btn-default">'+a.cancel+"</button>",style:"z-index:100003"}));var l=$("#luckysheet-ifFormulaGenerator-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-singleRange-dialog").css({left:(s+f-d)/2,top:(h+p-o)/3}).show()},multiRangeDialog:function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").remove();var e=st(),n=e.formula,t=e.button;$("body").append(br(Ga,{id:"luckysheet-ifFormulaGenerator-multiRange-dialog",addclass:"luckysheet-ifFormulaGenerator-multiRange-dialog",title:n.ifGenTipSelectRange,content:'<input readonly="readonly" placeholder="'+n.ifGenTipSelectRangePlace+'" value="">',botton:'<button id="luckysheet-ifFormulaGenerator-multiRange-confirm" class="btn btn-primary">'+t.confirm+'</button><button id="luckysheet-ifFormulaGenerator-multiRange-cancel" class="btn btn-default">'+t.cancel+"</button>",style:"z-index:100003"}));var a=$("#luckysheet-ifFormulaGenerator-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),l=a.outerHeight(),o=a.outerWidth(),d=$(window).width(),s=$(window).height(),h=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-multiRange-dialog").css({left:(d+h-o)/2,top:(s+f-l)/3}).show()},getIfList:function(e,n,t,a,l){var o=st().formula;$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty(),n=parseInt(n),t=parseInt(t),l=parseInt(l);var d=[];if(a=="0")for(var s=Math.ceil((t-n)/l),h=0;h<=s;h++){var f=n+l*h;h==0||f>=t?d.push(""):d.push(f)}else if(a=="1")for(var p=Math.ceil((t-n)/l),g=0;g<=l;g++){var v=n+p*g;g==0||v>=t?d.push(""):d.push(v)}for(var y=0;y<d.length-1;y++){var b=void 0;b=y==0?""+d[y+1]:y==d.length-2?""+d[y]:d[y]+""+d[y+1];var k='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+d[y]+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+d[y+1]+'"/><span>'+o.ifGenTipLableTitile+'</span><input type="text" class="markText formulaInputFocus" value="'+b+'"><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(k)}},info:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-info").remove();var n=st().button;$("body").append(br(Ga,{id:"luckysheet-ifFormulaGenerator-info",addclass:"",title:e,content:"",botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+n.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));var t=$("#luckysheet-ifFormulaGenerator-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=t.outerHeight(),l=t.outerWidth(),o=$(window).width(),d=$(window).height(),s=$(document).scrollLeft(),h=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-info").css({left:(o+s-l)/2,top:(d+h-a)/3}).show()}},is={init:function(){var e=this,n=st(),t=n.formulaMore,a=n.button;$(document).off("keyup.fxSFLI").on("keyup.fxSFLI","#searchFormulaListInput",function(){$("#formulaTypeList").empty();var l=$(this).val().toUpperCase(),o=u.functionlist;if(l=="")e.formulaListByType($("#formulaTypeSelect option:selected").val());else for(var d=0;d<o.length;d++)/^[a-zA-Z]+$/.test(l)?o[d].n.indexOf(l)!="-1"&&$('<div class="listBox" name="'+o[d].n+'"><span>'+o[d].n+"</span><span>"+o[d].a+"</span></div>").appendTo($("#formulaTypeList")):o[d].a.indexOf(l)!="-1"&&$('<div class="listBox" name="'+o[d].n+'"><span>'+o[d].n+"</span><span>"+o[d].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")}),$(document).off("change.fxFormulaTS").on("change.fxFormulaTS","#formulaTypeSelect",function(){var l=$("#formulaTypeSelect option:selected").val();e.formulaListByType(l)}),$(document).off("click.fxListbox").on("click.fxListbox","#formulaTypeList .listBox",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.fxFormulaCf").on("click.fxFormulaCf","#luckysheet-search-formula-confirm",function(){var l=$("#luckysheet-search-formula .listBox.on").attr("name"),o='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+l.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(o),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e.formulaParmDialog(l)}),$(document).off("focus.fxParamInput").on("focus.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){var l=$(this).parents(".parmBox").index();m.data_parm_index=l;var o,d,s=$(this).parents("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),h=u.luckysheet_function[s].p.length;l>=h?(o=u.luckysheet_function[s].p[h-1].detail,d=u.luckysheet_function[s].p[h-1].repeat):(o=u.luckysheet_function[s].p[l].detail,d=u.luckysheet_function[s].p[l].repeat),e.parmTxtShow($(this).val()),e.functionStrCompute(),$("#luckysheet-search-formula-parm .parmDetailsBox").empty();var f=$(this).parents(".parmBox").find(".name").text();if($("<span>"+f+":</span><span>"+o+"</span>").appendTo($("#luckysheet-search-formula-parm .parmDetailsBox")),d=="y"){var p=$("#luckysheet-search-formula-parm .parmBox").length;p<5&&l==p-1&&$('<div class="parmBox"><div class="name">'+t.valueTitle+(p+1)+'</div><div class="txt"><input class="formulaInputFocus" /><i class="fa fa-table" aria-hidden="true" title="'+t.tipSelectDataRange+'"></i></div><div class="val">=</div></div>').appendTo($("#luckysheet-search-formula-parm .parmListBox"))}}),$(document).off("blur.fxParamInput").on("blur.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){var l=$(this).val();m.getfunctionParam(l).fn!=null||m.iscelldata(l)||!M(l)&&l!=""&&l.length<=2&&l.indexOf('"')!=0&&l.lastIndexOf('"')!=0&&(l='"'+l+'"',$(this).val(l),e.parmTxtShow(l),e.functionStrCompute())}),$(document).off("keyup.fxParamInput").on("keyup.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){e.parmTxtShow($(this).val()),e.functionStrCompute()}),$(document).off("click.fxParamI").on("click.fxParamI","#luckysheet-search-formula-parm .parmBox i",function(){m.data_parm_index=$(this).parents(".parmBox").index(),$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm-select").remove(),$(this).parents(".parmBox").find(".txt input").val()==""?$("body").append(br(Ga,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' placeholder='"+t.tipDataRangeTile+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+a.confirm+"</button>",style:"z-index:100003"})):$("body").append(br(Ga,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' value='"+$(this).parents(".parmBox").find(".txt input").val()+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+a.confirm+"</button>",style:"z-index:100003"}));var l=$("#luckysheet-search-formula-parm-select").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),d=l.outerWidth(),s=$(window).width(),h=$(window).height(),f=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-search-formula-parm-select").css({left:(s+f-d)/2,top:(h+p-o)/3}).show(),e.parmTxtShow($(this).parents(".parmBox").find(".txt input").val())}),$(document).off("click.fxParamCf").on("click.fxParamCf","#luckysheet-search-formula-parm-confirm",function(){$("#luckysheet-wa-functionbox-confirm").click()}),$(document).off("click.fxParamSelectCf").on("click.fxParamSelectCf","#luckysheet-search-formula-parm-select-confirm",function(){var l=$("#luckysheet-search-formula-parm-select-input").attr("data_parm_index");$("#luckysheet-search-formula-parm-select").hide(),$("#luckysheet-search-formula-parm").show(),$("#luckysheet-search-formula-parm .parmBox").eq(l).find(".txt input").focus()})},formulaListDialog:function(){var e=st(),n=e.formulaMore,t=e.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-search-formula").remove(),$("body").append(br(Ga,{id:"luckysheet-search-formula",addclass:"luckysheet-search-formula",title:"",content:"<div class='inpbox'><label for='searchFormulaListInput'>"+n.findFunctionTitle+"</label><input class='formulaInputFocus' id='searchFormulaListInput' placeholder='"+n.tipInputFunctionName+"' spellcheck='false'/></div><div class='selbox'><label>"+n.selectCategory+"</label><select id='formulaTypeSelect'><option value='0'>"+n.Math+"</option><option value='1'>"+n.Statistical+"</option><option value='2'>"+n.Lookup+"</option><option value='3'>"+n.luckysheet+"</option><option value='4'>"+n.dataMining+"</option><option value='5'>"+n.Database+"</option><option value='6'>"+n.Date+"</option><option value='7'>"+n.Filter+"</option><option value='8'>"+n.Financial+"</option><option value='9'>"+n.Engineering+"</option><option value='10'>"+n.Logical+"</option><option value='11'>"+n.Operator+"</option><option value='12'>"+n.Text+"</option><option value='13'>"+n.Parser+"</option><option value='14'>"+n.Array+"</option><option value='-1'>"+n.other+"</option></select></div><div class='listbox'><label>"+n.selectFunctionTitle+"</label><div id='formulaTypeList'></div></div>",botton:'<button id="luckysheet-search-formula-confirm" class="btn btn-primary">'+t.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+t.cancel+"</button>",style:"z-index:100003"}));var a=$("#luckysheet-search-formula").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=a.outerHeight(),o=a.outerWidth(),d=$(window).width(),s=$(window).height(),h=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-search-formula").css({left:(d+h-o)/2,top:(s+f-l)/3,"user-select":"none"}).show(),this.formulaListByType("0"),$("#searchFormulaListInput").focus()},formulaListByType:function(e){$("#formulaTypeList").empty();for(var n=u.functionlist,t=0;t<n.length;t++)(e=="-1"&&n[t].t>14||n[t].t==e)&&$('<div class="listBox" name="'+n[t].n+'"><span>'+n[t].n+"</span><span>"+n[t].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")},formulaParmDialog:function(e,n){for(var t="",a="",l="",o=st(),d=o.formulaMore,s=o.button,h=u.functionlist,f=0;f<h.length;f++)if(h[f].n==e.toUpperCase()){t=h[f].n;for(var p=0;p<h[f].p.length;p++)n==null?l+='<div class="parmBox"><div class="name">'+h[f].p[p].name+'</div><div class="txt"><input class="formulaInputFocus" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+d.tipSelectDataRange+'"></i></div><div class="val">=</div></div>':(n[p]==null&&(n[p]=""),l+='<div class="parmBox"><div class="name">'+h[f].p[p].name+'</div><div class="txt"><input class="formulaInputFocus" value="'+n[p]+'" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+d.tipSelectDataRange+'"></i></div><div class="val">=</div></div>');a='<div><div class="parmListBox">'+l+'</div><div class="formulaDetails">'+h[f].d+'</div><div class="parmDetailsBox"></div><div class="result">'+d.calculationResult+" = <span></span></div></div>"}$("#luckysheet-search-formula").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm").remove(),$("body").append(br(Ga,{id:"luckysheet-search-formula-parm",addclass:"luckysheet-search-formula-parm",title:t,content:a,botton:'<button id="luckysheet-search-formula-parm-confirm" class="btn btn-primary">'+s.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+s.cancel+"</button>",style:"z-index:100003"}));var g=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),v=g.outerHeight(),y=g.outerWidth(),b=$(window).width(),k=$(window).height(),w=$(document).scrollLeft(),_=$(document).scrollTop();$("#luckysheet-search-formula-parm").css({left:(b+w-y)/2,top:(k+_-v)/3}).show(),$("#luckysheet-search-formula-parm .parmBox:eq(0) input").focus(),$("#luckysheet-search-formula-parm .parmBox").each(function(C,A){var I=$(A).find(".txt input").val();if(m.getfunctionParam(I).fn==null)if(m.iscelldata(I)){var S=no(I).data;if(D(S)=="array"){for(var E=[],R=0;R<S.length;R++)for(var F=0;F<S[R].length;F++){var N=S[R][F];N==null||$t(N.v)?E.push(null):E.push(N.v)}$("#luckysheet-search-formula-parm .parmBox").eq(C).find(".val").text(" = {"+E.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(C).find(".val").text(" = {"+S.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(C).find(".val").text(" = {"+I+"}");else $("#luckysheet-search-formula-parm .parmBox").eq(C).find(".val").text(" = {"+new Function("return "+$.trim(m.functionParserExe("="+I)))()+"}")}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),m.data_parm_index=0,m.rangestart=!0},parmTxtShow:function(e){if(m.getfunctionParam(e).fn==null)if(m.iscelldata(e)){var n=m.getcellrange(e),t=n.row[0],a=n.row[1],l=n.column[0],o=n.column[1],d=u.visibledatarow[a],s=t-1==-1?0:u.visibledatarow[t-1],h=u.visibledatacolumn[o],f=l-1==-1?0:u.visibledatacolumn[l-1];$("#luckysheet-formula-functionrange-select").css({left:f,width:h-f-1,top:s,height:d-s-1}).show(),$("#luckysheet-formula-help-c").hide(),lo(f,s,h-f-1,d-s-1,n.row,n.column);var p=no(e).data;if(D(p)=="array"){for(var g=[],v=0;v<p.length;v++)for(var y=0;y<p[v].length;y++){var b=p[v][y];b==null||$t(b.v)?g.push(null):g.push(b.v)}$("#luckysheet-search-formula-parm .parmBox").eq(m.data_parm_index).find(".val").text(" = {"+g.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(m.data_parm_index).find(".val").text(" = {"+p.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(m.data_parm_index).find(".val").text(" = {"+e+"}"),$("#luckysheet-formula-functionrange-select").hide();else{for(var k,w=0;w<m.getfunctionParam(e).param.length;w++)if(m.iscelldata(m.getfunctionParam(e).param[w])){k=m.getfunctionParam(e).param[w];break}var _=m.getcellrange(k),C=_.row[0],A=_.row[1],I=_.column[0],S=_.column[1],E=u.visibledatarow[A],R=C-1==-1?0:u.visibledatarow[C-1],F=u.visibledatacolumn[S],N=I-1==-1?0:u.visibledatacolumn[I-1];$("#luckysheet-formula-functionrange-select").css({left:N,width:F-N-1,top:R,height:E-R-1}).show(),$("#luckysheet-formula-help-c").hide(),lo(N,R,F-N-1,E-R-1,_.row,_.column),$("#luckysheet-search-formula-parm .parmBox").eq(m.data_parm_index).find(".val").text(" = {"+new Function("return "+$.trim(m.functionParserExe("="+e)))()+"}")}},functionStrCompute:function(){var e,n=!0,t=[],a=-1,l=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),o=u.luckysheet_function[l].p;if($("#luckysheet-search-formula-parm .parmBox").each(function(p,g){var v,y=$(g).find(".txt input").val();v=p<o.length?o[p].require:o[o.length-1].require,y==""&&v=="m"&&(n=!1),y!=""&&(a=p)}),a==-1)e="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(a==0)e="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(var d=0;d<=a;d++)t.push($("#luckysheet-search-formula-parm .parmBox").eq(d).find(".txt input").val());e="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+t.join(",")+")"}var s=m.functionHTMLGenerate(e);if($("#luckysheet-rich-text-editor").html(s),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),n){var h=$.trim(m.functionParserExe($("#luckysheet-rich-text-editor").text())),f=null;try{f=new Function("return "+h)()}catch{f=m.error.n}$("#luckysheet-search-formula-parm .result span").text(f)}}},dr={menu:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton ${subclass} luckysheet-mousedown-cancel" id="luckysheet-icon-${id}-menuButton">${item}</div>',item:'<div itemvalue="${value}" itemname="${name}" class="luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 0px 3px 1px;"><span style="margin-right:3px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span> ${name} <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel ${iconClass}" style="user-select: none;">${example}</span></div></div>',split:'<div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>',color:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel luckysheet-menuButton ${sub}" id="${id}"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-color-reset"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${resetColor}</div></div> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> ${coloritem}</div>',coloritem:'<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel ${class}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${name}</div></div>',subcolor:'<div id="luckysheet-icon-${id}-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-menuButton-sub luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div></div>',rightclickmenu:null,submenuhide:{},focus:function(e,n){e.attr("id")=="luckysheet-icon-font-family-menuButton"&&vc(n).num&&(n=st().fontarray[parseInt(n)])==null&&(n=this.defualtFont[itemvalue]),e.find(".luckysheet-cols-menuitem").find("span.icon").html(""),n==null?e.find(".luckysheet-cols-menuitem").eq(0).find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'):e.find(".luckysheet-cols-menuitem[itemvalue='"+n+"']").find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')},createButtonMenu:function(e){for(var n="",t=0;t<e.length;t++){var a=e[t];a.value=="split"?n+=this.split:a.example=="more"?n+=br(this.item,{value:a.value,name:a.text,example:"",sub:"luckysheet-cols-submenu",iconClass:"iconfont luckysheet-iconfont-youjiantou"}):n+=br(this.item,{value:a.value,name:a.text,example:a.example,sub:"",iconClass:""})}return n},cancelPaintModel:function(){$("#luckysheet-sheettable_0").removeClass("luckysheetPaintCursor"),u.luckysheet_copy_save.dataSheetIndex==u.currentSheetIndex?(u.luckysheet_selection_range=[],pn()):u.luckysheetfile[je(u.luckysheet_copy_save.dataSheetIndex)].luckysheet_selection_range=[],u.luckysheet_copy_save={},this.luckysheetPaintModelOn=!1,$("#luckysheetpopover").fadeOut(200,function(){$("#luckysheetpopover").remove()})},luckysheetPaintModelOn:!1,luckysheetPaintSingle:!1,initialMenuButton:function(){var e=this;$("#luckysheet-icon-paintformat").click(function(){var t=st().paint;if(u.luckysheet_select_save!=null&&u.luckysheet_select_save.length!=0)if(u.luckysheet_select_save.length>1)Rt()?alert(t.tipNotMulti):Ee.info("",t.tipNotMulti);else{Ee.popover("<i class='fa fa-paint-brush'></i> "+t.start,"topCenter",!0,null,t.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),u.luckysheet_selection_range=[{row:u.luckysheet_select_save[0].row,column:u.luckysheet_select_save[0].column}],pn();for(var a=!1,l=!1,o=u.luckysheet_select_save[0].row[0];o<=u.luckysheet_select_save[0].row[1];o++)if(u.config.rowhidden==null||u.config.rowhidden[o]==null){u.config.rowlen!=null&&o in u.config.rowlen&&(a=!0);for(var d=u.luckysheet_select_save[0].column[0];d<=u.luckysheet_select_save[0].column[1];d++){var s=u.flowdata[o][d];D(s)=="object"&&"mc"in s&&s.mc.rs!=null&&(l=!0)}}u.luckysheet_copy_save={dataSheetIndex:u.currentSheetIndex,copyRange:[{row:u.luckysheet_select_save[0].row,column:u.luckysheet_select_save[0].column}],RowlChange:a,HasMC:l},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!0}else Rt()?alert(t.tipSelectRange):Ee.info("",t.tipSelectRange)}),$("#luckysheet-icon-paintformat").dblclick(function(){var t=st().paint;if(u.luckysheet_select_save!=null&&u.luckysheet_select_save.length!=0)if(u.luckysheet_select_save.length>1)Rt()?alert(t.tipNotMulti):Ee.info("",t.tipNotMulti);else{Ee.popover("<i class='fa fa-paint-brush'></i> "+t.start,"topCenter",!0,null,t.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),u.luckysheet_selection_range=[{row:u.luckysheet_select_save[0].row,column:u.luckysheet_select_save[0].column}],pn();for(var a=!1,l=!1,o=u.luckysheet_select_save[0].row[0];o<=u.luckysheet_select_save[0].row[1];o++)if(u.config.rowhidden==null||u.config.rowhidden[o]==null){u.config.rowlen!=null&&o in u.config.rowlen&&(a=!0);for(var d=u.luckysheet_select_save[0].column[0];d<=u.luckysheet_select_save[0].column[1];d++){var s=u.flowdata[o][d];D(s)=="object"&&"mc"in s&&s.mc.rs!=null&&(l=!0)}}u.luckysheet_copy_save={dataSheetIndex:u.currentSheetIndex,copyRange:[{row:u.luckysheet_select_save[0].row,column:u.luckysheet_select_save[0].column}],RowlChange:a,HasMC:l},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!1}else Rt()?alert(t.tipSelectRange):Ee.info("",t.tipSelectRange)}),$("#luckysheet-icon-currency").click(function(){var t=vr.deepCopyFlowData(u.flowdata);e.updateFormat(t,"ct"," #.00")}),$("#luckysheet-icon-percent").click(function(){var t=vr.deepCopyFlowData(u.flowdata);e.updateFormat(t,"ct","0.00%")}),$("#luckysheet-icon-fmt-decimal-decrease").click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=u.luckysheet_select_save[0].row_focus,l=u.luckysheet_select_save[0].column_focus,o=e.checkstatus(t,a,l,"ct"),d=t[a][l];if(o!=null&&o.t=="n")if(o.fa=="General"&&(o=_a(d.v)[1]),/^(w|W)((0?)|(0\.0+))$/.test(o.fa))o.fa.indexOf(".")>-1?o.fa.substr(-2)==".0"?e.updateFormat(t,"ct",o.fa.split(".")[0]):e.updateFormat(t,"ct",o.fa.substr(0,o.fa.length-1)):e.updateFormat(t,"ct",o.fa);else{var s="",h="";if(o.fa.indexOf(".")>-1){s=(f=o.fa.split("."))[0];for(var f=(h=f[1]).split(""),p="",g=f.length-1;g>=0;g--){var v=f[g];if(v=="#"||v=="0"||v==","||!isNaN(parseInt(v)))break;p=v+p}var y="";if(o.fa.indexOf(".")>-1){var b=h;p.length>0&&(b=h.replace(p,""));var k=b.replace(/#/g,"0");y=(k=k.substr(0,k.length-1))==""?s+p:s+"."+k+p}e.updateFormat(t,"ct",y)}}}),$("#luckysheet-icon-fmt-decimal-increase").click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=u.luckysheet_select_save[0].row_focus,l=u.luckysheet_select_save[0].column_focus,o=e.checkstatus(t,a,l,"ct"),d=t[a][l];if(o!=null&&o.t=="n")if(o.fa=="General"&&(o=_a(d.v)[1]),o.fa!="General")if(/^(w|W)((0?)|(0\.0+))$/.test(o.fa))o.fa.indexOf(".")>-1?e.updateFormat(t,"ct",o.fa+"0"):o.fa.substr(-1)=="0"?e.updateFormat(t,"ct",o.fa+".0"):e.updateFormat(t,"ct",o.fa+"0.0");else{var s="",h="";o.fa.indexOf(".")>-1?(s=(f=o.fa.split("."))[0],h=f[1]):h=o.fa;for(var f=h.split(""),p="",g=f.length-1;g>=0;g--){var v=f[g];if(v=="#"||v=="0"||v==","||!isNaN(parseInt(v)))break;p=v+p}var y="";if(o.fa.indexOf(".")>-1){var b=h;p.length>0&&(b=h.replace(p,""));var k=b.replace(/#/g,"0");y=s+"."+(k+="0")+p}else y=p.length>0?h.replace(p,"")+".0"+p:h+".0"+p;e.updateFormat(t,"ct",y)}else e.updateFormat(t,"ct","#.0")}),$("#luckysheet-icon-fmt-other").click(function(){var t=st(),a=t.format,l=t.defaultFmt,o=$(this).attr("id")+"-menuButton",d=$("#"+o);if(d.length==0){var s=l,h=e.createButtonMenu(s),f=br(e.menu,{id:"fmt-other",item:h,subclass:"",sub:""}),p=[{text:a.moreCurrency+"...",value:"morecurrency",example:""},{text:a.moreDateTime+"...",value:"moredatetime",example:""},{text:a.moreNumber+"...",value:"moredigit",example:""}],g=e.createButtonMenu(p),v=br(e.menu,{id:"fmtOtherSelf",item:g,subclass:"luckysheet-menuButton-sub"});$("body").append(f+v),d=$("#"+o).width(250),e.focus(d),d.find(".luckysheet-cols-menuitem").click(function(){d.hide(),la();var C=$(this),A=C.attr("itemvalue"),I=C.attr("itemname");if($("#luckysheet-icon-fmt-other").find(".luckysheet-toolbar-menu-button-caption").html(" "+I+" "),A!="fmtOtherSelf"){var S=vr.deepCopyFlowData(u.flowdata);e.focus(d,A),e.updateFormat(S,"ct",A)}}),$("#luckysheet-icon-fmtOtherSelf-menuButton").find(".luckysheet-cols-menuitem").click(function(){d.hide(),$("#luckysheet-icon-fmtOtherSelf-menuButton").hide(),la();var C=$(this).attr("itemvalue");Fg.createDialog(C),Fg.init()})}else{var y=$(this).find(".luckysheet-toolbar-menu-button-caption").text().trim(),b=l.find(function(C){return C.text===y});b&&e.focus(d,b.value)}var k=$(this).outerWidth(),w=d.outerWidth(),_=$(this).offset().left;w>k&&w+_>$("#"+u.container).width()&&(_=_-w+k),al(d,_,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-font-family").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=e.createButtonMenu(e.fontSelectList),o=br(e.menu,{id:"font-family",item:l,subclass:"",sub:""});$("body").append(o),a=$("#"+t).width(200),e.focus(a),a.on("click",".luckysheet-cols-menuitem",function(){a.hide(),la();var f=$(this),p=f.attr("itemvalue"),g=f.attr("itemname");e.focus(a,p),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+g+" ");var v=vr.deepCopyFlowData(u.flowdata);e.updateFormat(v,"ff",p)})}var d=$(this).outerWidth(),s=a.outerWidth(),h=$(this).offset().left;s>d&&s+h>$("#"+u.container).width()&&(h=h-s+d),al(a,h,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-text-color").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=$(this).attr("color");a==null&&(a="#000000"),e.updateFormat(t,"fc",a)}),$("#luckysheet-icon-text-color-menu").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st(),o=l.toolbar,d=l.button,s=l.alternatingColors,h=[{name:o.alternatingColors+"...",id:"luckysheet-color-alternate",example:""}],f=(e.createButtonMenu(h),br(e.coloritem,{class:"luckysheet-icon-alternateformat",name:o.alternatingColors+"..."})),p=br(e.color,{id:t,coloritem:f,colorself:"text-color-self",sub:"",resetColor:o.resetColor});$("body").append(p),a=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:d.cancel,chooseText:d.confirm,togglePaletteMoreText:o.customColor,togglePaletteLessText:o.collapse,togglePaletteOnly:!0,clearText:o.clearText,color:Nt.defaultTextColor,noColorSelectedText:o.noColorSelectedText,localStorageKey:"spectrum.textcolor"+nt.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(k){k=k!=null?k.toHexString():"#000",$("#luckysheet-icon-text-color .text-color-bar").css("background-color",k),$("#luckysheet-icon-text-color").attr("color",k);var w=vr.deepCopyFlowData(u.flowdata);e.updateFormat(w,"fc",k),a.hide(),la(),$("#luckysheet-input-box").css("color",k)}}),a.find(".luckysheet-color-reset").click(function(){a.hide(),la();var k=$("#"+t).find(".luckysheet-color-selected");k.val("#000000"),$("#luckysheet-icon-text-color").attr("color",null),k.spectrum("set","#000000"),$("#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#000000");var w=vr.deepCopyFlowData(u.flowdata);e.updateFormat(w,"fc",null)}),a.find(".luckysheet-icon-alternateformat").click(function(){if(a.hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(s.errorInfo):Ee.info(s.errorInfo,"");else{var k=$.extend(!0,{},u.luckysheet_select_save[0]);Un.rangeIsExists(k)[0]||(Un.modelfocusIndex=0,Un.new(k)),Un.init(),Un.perfect()}})}var g=$(this).outerWidth(),v=a.outerWidth(),y=$(this).offset().left;v>g&&v+y>$("#"+u.container).width()&&(y=y-v+g);var b=$(this).offset().top+26;setTimeout(function(){var k=$("#"+t).find(".luckysheet-color-selected");k.spectrum("set",k.val()),al(a,y-28,b,"lefttop")},1)}),$("#luckysheet-icon-cell-color").click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=$(this).attr("color");a==null&&(a="#ffffff"),e.updateFormat(t,"bg",a)}),$("#luckysheet-icon-cell-color-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st(),o=l.toolbar,d=l.button,s=l.alternatingColors,h=br(e.coloritem,{class:"luckysheet-icon-alternateformat",name:o.alternatingColors+"..."}),f=br(e.color,{id:t,coloritem:h,colorself:"cell-color-self",sub:"",resetColor:o.resetColor});$("body").append(f),a=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:Nt.defaultCellColor,cancelText:d.cancel,chooseText:d.confirm,togglePaletteMoreText:o.customColor,togglePaletteLessText:o.collapse,togglePaletteOnly:!0,clearText:o.clearText,noColorSelectedText:o.noColorSelectedText,localStorageKey:"spectrum.bgcolor"+nt.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(b){b=b!=null?b.toHexString():"#fff",$("#luckysheet-icon-cell-color .text-color-bar").css("background-color",b),$("#luckysheet-icon-cell-color").attr("color",b);var k=vr.deepCopyFlowData(u.flowdata);e.updateFormat(k,"bg",b),a.hide(),la()}}),a.find(".luckysheet-color-reset").click(function(){a.hide(),la();var b=$("#"+t).find(".luckysheet-color-selected");b.val("#ffffff"),$("#luckysheet-icon-cell-color").attr("color",null),b.spectrum("set","#ffffff"),$("#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#ffffff");var k=vr.deepCopyFlowData(u.flowdata);e.updateFormat(k,"bg",null)}),a.find(".luckysheet-icon-alternateformat").click(function(){if(a.hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(s.errorInfo):Ee.info(s.errorInfo,"");else{var b=$.extend(!0,{},u.luckysheet_select_save[0]);Un.rangeIsExists(b)[0]||(Un.modelfocusIndex=0,Un.new(b)),Un.init(),Un.perfect()}}),$("#"+t).find(".luckysheet-color-selected").val("#fff")}var p=$(this).outerWidth(),g=a.outerWidth(),v=$(this).offset().left;g>p&&g+v>$("#"+u.container).width()&&(v=v-g+p);var y=$(this).offset().top+26;setTimeout(function(){var b=$("#"+t).find(".luckysheet-color-selected");b.spectrum("set",b.val()),al(a,v-28,y,"lefttop")},1)});var n=null;$("#luckysheet-icon-font-size").mousedown(function(t){if(parseInt($("#luckysheet-input-box").css("top"))>0){var a=window.getSelection();if(a.type!="None"){var l=a.getRangeAt(0);l.collapsed||(u.inlineStringEditRange=l.cloneRange())}}Ji(t),t.stopPropagation()}).click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=e.createButtonMenu([{text:"9",value:"9",example:""},{text:"10",value:"10",example:""},{text:"11",value:"11",example:""},{text:"12",value:"12",example:""},{text:"14",value:"14",example:""},{text:"16",value:"16",example:""},{text:"18",value:"18",example:""},{text:"20",value:"20",example:""},{text:"22",value:"22",example:""},{text:"24",value:"24",example:""},{text:"26",value:"26",example:""},{text:"28",value:"28",example:""},{text:"36",value:"36",example:""},{text:"48",value:"48",example:""},{text:"72",value:"72",example:""}]),o=br(e.menu,{id:"font-size",item:l,subclass:"",sub:""});$("body").append(o),a=$("#"+t).width(150),e.focus(a,10),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var p=$(this).attr("itemvalue"),g=$("#luckysheet-icon-font-size input");$("#luckysheet-icon-font-size").attr("itemvalue",p),e.focus(a,p),g.val(p);var v=vr.deepCopyFlowData(u.flowdata);e.updateFormat(v,"fs",p),clearTimeout(n)})}var d=$(this).outerWidth(),s=a.outerWidth(),h=$("#luckysheet-icon-font-size").attr("itemvalue");h==null&&(h=10),e.focus(a,h);var f=$(this).offset().left;s>d&&s+f>$("#"+u.container).width()&&(f=f-s+d),al(a,f,$(this).offset().top+25,"lefttop")}).find("input.luckysheet-toolbar-textinput").keydown(function(t){Ji(t),t.stopPropagation()}).keyup(function(t){if(t.keyCode==13){var a=$(this),l=parseInt(a.val()),o=$("#luckysheet-icon-font-size-menuButton");e.focus(o,l);var d=vr.deepCopyFlowData(u.flowdata);e.updateFormat(d,"fs",l),n=setTimeout(function(){o.hide(),a.blur()},200)}}),$("#luckysheet-icon-border-all").click(function(){if(ro(u.currentSheetIndex)){vr.deepCopyFlowData(u.flowdata);var t=$(this).attr("type");t==null&&(t="border-all");var a=$("#luckysheet-icon-borderColor-menuButton").find(".luckysheet-color-selected").val(),l=$("#luckysheetborderSizepreview").attr("itemvalue");a!=null&&a!=""||(a="#000"),l!=null&&l!=""||(l="1");var o=$.extend(!0,{},u.config);o.borderInfo==null&&(o.borderInfo=[]);var d={rangeType:"range",borderType:t,color:a,style:l,range:$.extend(!0,[],u.luckysheet_select_save)};if(o.borderInfo.push(d),u.clearjfundo){u.jfundo.length=0;var s=[];s.type="borderChange",s.config=$.extend(!0,{},u.config),s.curconfig=$.extend(!0,{},o),s.sheetIndex=u.currentSheetIndex,u.jfredo.push(s)}nt.saveParam("cg",u.currentSheetIndex,o.borderInfo,{k:"borderInfo"}),u.config=o,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,setTimeout(function(){Kr()},1)}}),$("#luckysheet-icon-border-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st(),o=l.border,d=l.toolbar,s=l.button,h=[{text:o.borderTop,value:"border-top",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-top iconfont luckysheet-iconfont-shangbiankuang" style="user-select: none;"> </div> </div>'},{text:o.borderBottom,value:"border-bottom",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-bottom iconfont luckysheet-iconfont-xiabiankuang" style="user-select: none;"> </div> </div>'},{text:o.borderLeft,value:"border-left",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-left iconfont luckysheet-iconfont-zuobiankuang" style="user-select: none;"> </div> </div>'},{text:o.borderRight,value:"border-right",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-right iconfont luckysheet-iconfont-youbiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:o.borderNone,value:"border-none",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-none iconfont luckysheet-iconfont-wubiankuang" style="user-select: none;"> </div> </div>'},{text:o.borderAll,value:"border-all",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang" style="user-select: none;"> </div> </div>'},{text:o.borderOutside,value:"border-outside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-outside iconfont luckysheet-iconfont-sizhoujiabiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:o.borderInside,value:"border-inside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-inside iconfont luckysheet-iconfont-neikuangxian" style="user-select: none;"> </div> </div>'},{text:o.borderHorizontal,value:"border-horizontal",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-horizontal iconfont luckysheet-iconfont-neikuanghengxian" style="user-select: none;"> </div> </div>'},{text:o.borderVertical,value:"border-vertical",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-vertical iconfont luckysheet-iconfont-neikuangshuxian" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"<span id='luckysheet-icon-borderColor-linecolor' class='luckysheet-mousedown-cancel' style='border-bottom:3px solid #000;'>"+o.borderColor+"</span>",value:"borderColor",example:"more"},{text:o.borderSize+"<img id='luckysheetborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>",value:"borderSize",example:"more"}],f=o1,p=e.createButtonMenu(h),g=br(e.menu,{id:"border-menu",item:p,subclass:"",sub:""}),v=[{text:o.borderNone,value:"0",example:""},{text:"<canvas type='Thin' class='border-Thin' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"1",example:""},{text:"<canvas type='Hair' class='border-Hair' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"2",example:""},{text:"<canvas type='Dotted' class='border-Dotted' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"3",example:""},{text:"<canvas type='Dashed' class='border-Dashed' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"4",example:""},{text:"<canvas type='DashDot' class='border-DashDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"5",example:""},{text:"<canvas type='DashDotDot' class='border-DashDotDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"6",example:""},{text:"<canvas type='Medium' class='border-Medium' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"8",example:""},{text:"<canvas type='MediumDashed' class='border-MediumDashed' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"9",example:""},{text:"<canvas type='MediumDashDot' class='border-MediumDashDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"10",example:""},{text:"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"11",example:""},{text:"<canvas type='Thick' class='border-Thick' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"13",example:""}],y=e.createButtonMenu(v),b=br(e.menu,{id:"borderSize",item:y,subclass:"luckysheet-menuButton-sub"}),k="luckysheet-icon-borderSize-menuButton",w="luckysheet-icon-borderColor-menuButton",_=br(e.color,{id:w,coloritem:"",colorself:"",sub:"luckysheet-menuButton-sub",resetColor:d.resetColor});$("body").append(g+_+b),a=$("#"+t).width(170),e.focus(a,"border-all"),$("#"+k+" canvas").each(function(S){$(this).attr("type");var E=$(this).closest(".luckysheet-cols-menuitem").attr("itemvalue"),R=$(this).addClass("luckysheet-mousedown-cancel").get(0).getContext("2d");R.translate(.5,.5),e.setLineDash(R,E,"h",0,5,100,5),R.strokeStyle="#000000",R.stroke(),R.closePath()}),$("#"+k+" .luckysheet-cols-menuitem").click(function(){$("#"+k).hide();var S=$(this),E=S.attr("itemvalue");if(E==0)$("#luckysheetborderSizepreview").attr("src","data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==").attr("itemvalue",null);else{var R=S.find("canvas").get(0).toDataURL("image/png");$("#luckysheetborderSizepreview").attr("src",R).attr("itemvalue",E)}e.focus($("#"+k),E)}),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var S=$(this).attr("itemvalue");if(S!="borderColor"&&S!="borderSize"&&ro(u.currentSheetIndex)){vr.deepCopyFlowData(u.flowdata);var E=$("#"+w).find(".luckysheet-color-selected").val(),R=$("#luckysheetborderSizepreview").attr("itemvalue");E!=null&&E!=""||(E="#000"),R!=null&&R!=""||(R="1");var F=$.extend(!0,{},u.config);F.borderInfo==null&&(F.borderInfo=[]);var N={rangeType:"range",borderType:S,color:E,style:R,range:$.extend(!0,[],u.luckysheet_select_save)};if(F.borderInfo.push(N),u.clearjfundo){u.jfundo.length=0;var z=[];z.type="borderChange",z.config=$.extend(!0,{},u.config),z.curconfig=$.extend(!0,{},F),z.sheetIndex=u.currentSheetIndex,u.jfredo.push(z)}nt.saveParam("cg",u.currentSheetIndex,F.borderInfo,{k:"borderInfo"}),u.config=F,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,setTimeout(function(){Kr()},1),$("#luckysheet-icon-border-all").attr("type",S),$("#luckysheet-icon-border-all").find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-"+S+f[S]),e.focus(a,S)}}),$("#"+w).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#000",cancelText:s.cancel,chooseText:s.confirm,togglePaletteMoreText:d.customColor,togglePaletteLessText:d.collapse,togglePaletteOnly:!0,clearText:d.clearText,noColorSelectedText:d.noColorSelectedText,localStorageKey:"spectrum.bordercolor"+nt.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(S){$(this),S=S!=null?S.toHexString():"#000",$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color",S),$("#"+w).find(".luckysheet-color-selected").val(S)}}),$("#"+w).find(".luckysheet-color-reset").click(function(){var S=$("#"+w).find(".luckysheet-color-selected");S.val("#000"),$("#luckysheet-icon-cell-color").attr("color",null),S.spectrum("set","#000"),$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color","#000")})}var C=$(this).outerWidth(),A=a.outerWidth(),I=$(this).offset().left;A>C&&A+I>$("#"+u.container).width()&&(I=I-A+C),al(a,I-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-merge-button").click(function(){if(Os(u.currentSheetIndex))if(Vs())Rt()?alert(""):Ee.info("","");else{if(u.config.merge!=null){for(var t=!1,a=0;a<u.luckysheet_select_save.length;a++){var l=u.luckysheet_select_save[a].row[0],o=u.luckysheet_select_save[a].row[1],d=u.luckysheet_select_save[a].column[0],s=u.luckysheet_select_save[a].column[1];if(t=mn(u.config,l,o,d,s))break}if(t)return void(Rt()?alert(""):Ee.info("",""))}var h=vr.deepCopyFlowData(u.flowdata);e.updateFormat_mc(h,"mergeAll")}}),$("#luckysheet-icon-merge-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st().merge,o=[{text:l.mergeAll,value:"mergeAll",example:""},{text:l.mergeV,value:"mergeV",example:""},{text:l.mergeH,value:"mergeH",example:""},{text:l.mergeCancel,value:"mergeCancel",example:""}],d=e.createButtonMenu(o),s=br(e.menu,{id:"merge-menu",item:d,subclass:"",sub:""});$("body").append(s),a=$("#"+t).width(110),e.focus(a),a.find(".luckysheet-cols-menuitem").click(function(){if(a.hide(),la(),Vs())Rt()?alert(l.overlappingError):Ee.info(l.overlappingError,"");else{if(u.config.merge!=null){for(var g=!1,v=0;v<u.luckysheet_select_save.length;v++){var y=u.luckysheet_select_save[v].row[0],b=u.luckysheet_select_save[v].row[1],k=u.luckysheet_select_save[v].column[0],w=u.luckysheet_select_save[v].column[1];if(g=mn(u.config,y,b,k,w))break}if(g)return void(Rt()?alert(l.partiallyError):Ee.info(l.partiallyError,""))}var _=$(this).attr("itemvalue");e.focus(a,_);var C=vr.deepCopyFlowData(u.flowdata);e.updateFormat_mc(C,_)}})}var h=$(this).outerWidth(),f=a.outerWidth(),p=$(this).offset().left;f>h&&f+p>$("#"+u.container).width()&&(p=p-f+h),al(a,p-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-align").click(function(){var t=$("#luckysheet-icon-align").attr("type");t==null&&(t="left");var a=vr.deepCopyFlowData(u.flowdata);e.updateFormat(a,"ht",t)}),$("#luckysheet-icon-align-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st().align,o=[{text:l.left,value:"left",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi" style="user-select: none;"> </div> </div>'},{text:l.center,value:"center",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-center iconfont luckysheet-iconfont-wenbenjuzhongduiqi" style="user-select: none;"> </div> </div>'},{text:l.right,value:"right",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-right iconfont luckysheet-iconfont-wenbenyouduiqi" style="user-select: none;"> </div> </div>'}],d=rd,s=e.createButtonMenu(o),h=br(e.menu,{id:"align-menu",item:s,subclass:"",sub:""});$("body").append(h),a=$("#"+t).width(120),e.focus(a),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var v=$(this).attr("itemvalue");e.focus(a,v),$("#luckysheet-icon-align").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+v+d[v]);var y=vr.deepCopyFlowData(u.flowdata);e.updateFormat(y,"ht",v)})}var f=$(this).outerWidth(),p=a.outerWidth(),g=$(this).offset().left;p>f&&p+g>$("#"+u.container).width()&&(g=g-p+f),al(a,g-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-valign").click(function(){var t=$("#luckysheet-icon-valign").attr("type");t==null&&(t="bottom");var a=vr.deepCopyFlowData(u.flowdata);e.updateFormat(a,"vt",t)}),$("#luckysheet-icon-valign-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t),l=st().align;if(a.length==0){var o=[{text:l.top,value:"top",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-top iconfont luckysheet-iconfont-dingbuduiqi" style="user-select: none;"> </div> </div>'},{text:l.middle,value:"middle",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-middle iconfont luckysheet-iconfont-shuipingduiqi" style="user-select: none;"> </div> </div>'},{text:l.bottom,value:"bottom",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi" style="user-select: none;"> </div> </div>'}],d=rd,s=e.createButtonMenu(o),h=br(e.menu,{id:"valign-menu",item:s,subclass:"",sub:""});$("body").append(h),a=$("#"+t).width(120),e.focus(a,"bottom"),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var v=$(this).attr("itemvalue");e.focus(a,v),$("#luckysheet-icon-valign").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+v+d[v]);var y=vr.deepCopyFlowData(u.flowdata);e.updateFormat(y,"vt",v)})}var f=$(this).outerWidth(),p=a.outerWidth(),g=$(this).offset().left;p>f&&p+g>$("#"+u.container).width()&&(g=g-p+f),al(a,g-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-textwrap-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st().textWrap,o=[{text:l.overflow,value:"overflow",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow iconfont luckysheet-iconfont-yichu1" style="user-select: none;"> </div> </div>'},{text:l.wrap,value:"wrap",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-wrap iconfont luckysheet-iconfont-zidonghuanhang" style="user-select: none;"> </div> </div>'},{text:l.clip,value:"clip",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan" style="user-select: none;"> </div> </div>'}],d=Af,s=e.createButtonMenu(o),h=br(e.menu,{id:"textwrap-menu",item:s,subclass:"",sub:""});$("body").append(h),a=$("#"+t).width(120),e.focus(a,"clip"),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var v=$(this).attr("itemvalue");e.focus(a,v),$("#luckysheet-icon-textwrap").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+v+d[v]);var y=vr.deepCopyFlowData(u.flowdata);e.updateFormat(y,"tb",v)})}var f=$(this).outerWidth(),p=a.outerWidth(),g=$(this).offset().left;p>f&&p+g>$("#"+u.container).width()&&(g=g-p+f),al(a,g-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-rotation-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st().rotation,o=[{text:l.none,value:"none",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang" style="user-select: none;"> </div> </div>'},{text:l.angleup,value:"angleup",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angleup iconfont luckysheet-iconfont-xiangshangqingxie" style="user-select: none;"> </div> </div>'},{text:l.angledown,value:"angledown",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angledown iconfont luckysheet-iconfont-xiangxiaqingxie" style="user-select: none;"> </div> </div>'},{text:l.vertical,value:"vertical",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-vertical iconfont luckysheet-iconfont-shupaiwenzi" style="user-select: none;"> </div> </div>'},{text:l.rotationUp,value:"rotation-up",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-up iconfont luckysheet-iconfont-wenbenxiangshang" style="user-select: none;"> </div> </div>'},{text:l.rotationDown,value:"rotation-down",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-down iconfont luckysheet-iconfont-xiangxia90" style="user-select: none;"> </div> </div>'}],d=Sf,s=e.createButtonMenu(o),h=br(e.menu,{id:"rotation-menu",item:s,subclass:"",sub:""});$("body").append(h),a=$("#"+t).width(160),e.focus(a),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var v=$(this).attr("itemvalue");e.focus(a,v),$("#luckysheet-icon-rotation").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+v+d[v]);var y=vr.deepCopyFlowData(u.flowdata);e.updateFormat(y,"tr",v)})}var f=$(this).outerWidth(),p=a.outerWidth(),g=$(this).offset().left;p>f&&p+g>$("#"+u.container).width()&&(g=g-p+f),al(a,g-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-freezen-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st().freezen,o=[{text:l.freezenRow,value:"freezenRow",example:""},{text:l.freezenColumn,value:"freezenColumn",example:""},{text:l.freezenRC,value:"freezenRC",example:""},{text:"",value:"split",example:""},{text:l.freezenRowRange,value:"freezenRowRange",example:""},{text:l.freezenColumnRange,value:"freezenColumnRange",example:""},{text:l.freezenRCRange,value:"freezenRCRange",example:""},{text:"",value:"split",example:""},{text:l.freezenCancel,value:"freezenCancel",example:""}],d=e.createButtonMenu(o),s=br(e.menu,{id:"freezen-menu",item:d,subclass:"",sub:""});$("body").append(s),(a=$("#"+t).width(170)).find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var g=$(this).attr("itemvalue");if(e.focus(a,g),Ne.saveFrozen(g),g=="freezenRow"){var v=$("#luckysheet-cell-main").scrollTop(),y=fa(u.visibledatarow,v);y==-1&&(y=0);var b=u.visibledatarow[y]-2-v+u.columnHeaderHeight,k=[u.visibledatarow[y],y+1,v,Ne.cutVolumn(u.visibledatarow,y+1),b];Ne.saveFreezen(k,b,null,null),Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenHorizontal(k,b),Ne.createAssistCanvas(),Kr()}else if(g=="freezenColumn"){var w=$("#luckysheet-cell-main").scrollLeft(),_=fa(u.visibledatacolumn,w);_==-1&&(_=0);var C=u.visibledatacolumn[_]-2-w+u.rowHeaderWidth,A=[u.visibledatacolumn[_],_+1,w,Ne.cutVolumn(u.visibledatacolumn,_+1),C];Ne.saveFreezen(null,null,A,C),Ne.freezenhorizontaldata!=null&&(Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenVertical(A,C),Ne.createAssistCanvas(),Kr()}else if(g=="freezenRC"){var I=$("#luckysheet-cell-main").scrollTop(),S=fa(u.visibledatarow,I);S==-1&&(S=0);var E=u.visibledatarow[S]-2-I+u.columnHeaderHeight,R=[u.visibledatarow[S],S+1,I,Ne.cutVolumn(u.visibledatarow,S+1),E];Ne.saveFreezen(R,E,null,null),Ne.createFreezenHorizontal(R,E);var F=$("#luckysheet-cell-main").scrollLeft(),N=fa(u.visibledatacolumn,F);N==-1&&(N=0);var z=u.visibledatacolumn[N]-2-F+u.rowHeaderWidth,P=[u.visibledatacolumn[N],N+1,F,Ne.cutVolumn(u.visibledatacolumn,N+1),z];Ne.saveFreezen(null,null,P,z),Ne.createFreezenVertical(P,z),Ne.createAssistCanvas(),Kr()}else if(g=="freezenRowRange"){if(u.luckysheet_select_save==null||u.luckysheet_select_save.length==0)return void(Rt()?alert(l.noSeletionError):Ee.info(l.noSeletionError,""));var q=$("#luckysheet-cell-main").scrollTop(),V=fa(u.visibledatarow,q),x=u.luckysheet_select_save[u.luckysheet_select_save.length-1],ee=x.row_focus==null?x.row[0]:x.row_focus;ee>V&&(V=ee),V==-1&&(V=0);var ne=u.visibledatarow[V]-2-q+u.columnHeaderHeight,ae=[u.visibledatarow[V],V+1,q,Ne.cutVolumn(u.visibledatarow,V+1),ne];Ne.saveFreezen(ae,ne,null,null),Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenHorizontal(ae,ne),Ne.createAssistCanvas(),Kr()}else if(g=="freezenColumnRange"){if(u.luckysheet_select_save==null||u.luckysheet_select_save.length==0)return void(Rt()?alert(l.noSeletionError):Ee.info(l.noSeletionError,""));var de=$("#luckysheet-cell-main").scrollLeft(),ve=fa(u.visibledatacolumn,de),U=u.luckysheet_select_save[u.luckysheet_select_save.length-1],B=U.column_focus==null?U.column[0]:U.column_focus;B>ve&&(ve=B),ve==-1&&(ve=0);var le=u.visibledatacolumn[ve]-2-de+u.rowHeaderWidth,Te=[u.visibledatacolumn[ve],ve+1,de,Ne.cutVolumn(u.visibledatacolumn,ve+1),le];Ne.saveFreezen(null,null,Te,le),Ne.freezenhorizontaldata!=null&&(Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.createFreezenVertical(Te,le),Ne.createAssistCanvas(),Kr()}else if(g=="freezenRCRange"){if(u.luckysheet_select_save==null||u.luckysheet_select_save.length==0)return void(Rt()?alert(l.noSeletionError):Ee.info(l.noSeletionError,""));var ue=$("#luckysheet-cell-main").scrollTop(),be=fa(u.visibledatarow,ue),ye=u.luckysheet_select_save[u.luckysheet_select_save.length-1],ce=ye.row_focus==null?ye.row[0]:ye.row_focus;ce>be&&(be=ce),be==-1&&(be=0);var Re=u.visibledatarow[be]-2-ue+u.columnHeaderHeight,pe=[u.visibledatarow[be],be+1,ue,Ne.cutVolumn(u.visibledatarow,be+1),Re];Ne.saveFreezen(pe,Re,null,null),Ne.createFreezenHorizontal(pe,Re);var me=$("#luckysheet-cell-main").scrollLeft(),re=fa(u.visibledatacolumn,me),_e=ye.column_focus==null?ye.column[0]:ye.column_focus;_e>re&&(re=_e),re==-1&&(re=0);var Ze=u.visibledatacolumn[re]-2-me+u.rowHeaderWidth,We=[u.visibledatacolumn[re],re+1,me,Ne.cutVolumn(u.visibledatacolumn,re+1),Ze];Ne.saveFreezen(null,null,We,Ze),Ne.createFreezenVertical(We,Ze),Ne.createAssistCanvas(),Kr()}else g=="freezenCancel"&&(Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.freezenhorizontaldata!=null&&(Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.scrollAdapt());setTimeout(function(){Rn()},0)})}var h=$(this).outerWidth(),f=a.outerWidth(),p=$(this).offset().left;f>h&&f+p>$("#"+u.container).width()&&(p=p-f+h),al(a,p-68,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-autofilter").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t);if(a.length==0){var l=st(),o=l.sort,d=l.filter,s=[{text:o.asc,value:"asc",example:'<i class="iconfont luckysheet-iconfont-shengxu" aria-hidden="true"></i>'},{text:o.desc,value:"desc",example:'<i class="iconfont luckysheet-iconfont-jiangxu" aria-hidden="true"></i>'},{text:o.custom+"...",value:"diysort",example:'<i class="iconfont luckysheet-iconfont-zidingyipaixu" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:d.filter,value:"filter",example:'<i class="iconfont luckysheet-iconfont-shaixuan2" aria-hidden="true"></i>'},{text:d.clearFilter,value:"clearfilter",example:'<i class="iconfont luckysheet-iconfont-qingchushaixuan" aria-hidden="true"></i>'}],h=e.createButtonMenu(s),f=br(e.menu,{id:"autofilter",item:h,subclass:"",sub:""});$("body").append(f),(a=$("#"+t).width(150)).find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var y=$(this).attr("itemvalue");y=="diysort"?$("#luckysheetorderby").click():y=="asc"?Wp(!0):y=="desc"?Wp(!1):y=="filter"?$("#luckysheet-filter-options-sheet"+u.currentSheetIndex).length>0?$("#luckysheet-filter-initial").click():Bh():y=="clearfilter"&&$("#luckysheet-filter-initial").click()})}var p=$(this).outerWidth(),g=a.outerWidth(),v=$(this).offset().left;g>p&&g+v>$("#"+u.container).width()&&(v=v-g+p),al(a,v,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-seachmore").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t),l=st().findAndReplace;if(a.length==0){var o=[{text:l.find+" ...",value:"search",example:'<i class="iconfont luckysheet-iconfont-sousuo" aria-hidden="true"></i>'},{text:l.replace+" ...",value:"replace",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:l.location+" ...",value:"location",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'},{text:l.formula,value:"locationFormula",example:l.locationExample},{text:l.date,value:"locationConstantDate",example:l.locationExample},{text:l.number,value:"locationConstantNumber",example:l.locationExample},{text:l.string,value:"locationConstantString",example:l.locationExample},{text:l.error,value:"locationConstantError",example:l.locationExample},{text:l.condition,value:"locationCF",example:l.locationExample},{text:l.rowSpan,value:"locationStepRow",example:l.locationExample},{text:l.columnSpan,value:"locationStepColumn",example:l.locationExample}],d=e.createButtonMenu(o),s=br(e.menu,{id:"seachmore",item:d,subclass:"",sub:""});$("body").append(s),(a=$("#"+t).width(180)).find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var g=$(this).attr("itemvalue");if(g=="search"||g=="replace")g=="search"?Us.createDialog(0):g=="replace"&&Us.createDialog(1),Us.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(g=="location")io.createDialog(),io.init();else if(g=="locationFormula"||g=="locationConstantDate"||g=="locationConstantNumber"||g=="locationConstantString"||g=="locationConstantError"||g=="locationCF"){var v,y=u.luckysheet_select_save[0];v=u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&y.row[0]==y.row[1]&&y.column[0]==y.column[1]?[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1]}]:$.extend(!0,[],u.luckysheet_select_save),g=="locationFormula"?io.apply(v,"locationFormula","all"):g=="locationConstantDate"?io.apply(v,"locationConstant","d"):g=="locationConstantNumber"?io.apply(v,"locationConstant","n"):g=="locationConstantString"?io.apply(v,"locationConstant","s,g"):g=="locationConstantError"?io.apply(v,"locationConstant","e"):g=="locationCF"&&io.apply(v,"locationCF")}else if(g=="locationStepRow"){if(u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].row[0]==u.luckysheet_select_save[0].row[1])return void(Rt()?alert(l.lessTwoRowTip):Ee.info("",l.lessTwoRowTip));var b=$.extend(!0,[],u.luckysheet_select_save);io.apply(b,"locationStepRow")}else if(g=="locationStepColumn"){if(u.luckysheet_select_save.length==0||u.luckysheet_select_save.length==1&&u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1])return void(Rt()?alert(l.lessTwoColumnTip):Ee.info("",l.lessTwoColumnTip));var k=$.extend(!0,[],u.luckysheet_select_save);io.apply(k,"locationStepColumn")}})}var h=$(this).outerWidth(),f=a.outerWidth(),p=$(this).offset().left;f>h&&f+p>$("#"+u.container).width()&&(p=p-f+h),al(a,p,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-function").click(function(){e.autoSelectionFormula("SUM")}),$("#luckysheet-icon-function-menu").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t),l=st().formula;if(a.length==0){var o=[{text:l.sum,value:"SUM",example:"SUM"},{text:l.average,value:"AVERAGE",example:"AVERAGE"},{text:l.count,value:"COUNT",example:"COUNT"},{text:l.max,value:"MAX",example:"MAX"},{text:l.min,value:"MIN",example:"MIN"},{text:"",value:"split",example:""},{text:l.ifGenerate,value:"if",example:"IF"},{text:l.find+" ...",value:"formula",example:""}],d=e.createButtonMenu(o),s=br(e.menu,{id:"function-menu",item:d,subclass:"",sub:""});$("body").append(s),(a=$("#"+t).width(180)).find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var g=$(this).attr("itemvalue");if(g=="if"){var v=u.luckysheet_select_save[u.luckysheet_select_save.length-1],y=v.row_focus==null?v.row[0]:v.row_focus,b=v.column_focus==null?v.column[0]:v.column_focus;if(u.flowdata[y]&&u.flowdata[y][b]&&u.flowdata[y][b].f){var k=u.flowdata[y][b].f.toString();if(k.indexOf("=if(")==-1)return void(Rt()?alert(l.tipNotBelongToIf):Ee.info(l.tipNotBelongToIf,""));yd.ifFormulaDialog(k)}else yd.ifFormulaDialog();yd.init()}else if(g=="formula"){if(u.luckysheet_select_save.length==0)return void(Rt()?alert(l.tipSelectCell):Ee.info(l.tipSelectCell,""));var w=u.luckysheet_select_save[u.luckysheet_select_save.length-1],_=w.row_focus,C=w.column_focus;ri(_,C,u.flowdata);var A=u.flowdata[_][C];if(A!=null&&A.f!=null){var I=m.getfunctionParam(A.f);I.fn!=null?is.formulaParmDialog(I.fn,I.param):is.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),is.formulaListDialog();is.init()}else e.autoSelectionFormula(g)})}var h=$(this).outerWidth(),f=a.outerWidth(),p=$(this).offset().left;f>h&&f+p>$("#"+u.container).width()&&(p=p-f+h),al(a,p-48,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-bold").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(t){var a=vr.deepCopyFlowData(u.flowdata),l=u.luckysheet_select_save[0].row_focus,o=u.luckysheet_select_save[0].column_focus,d=e.checkstatus(a,l,o,"bl");d=d==1?0:1,e.updateFormat(a,"bl",d),e.menuButtonFocus(a,l,o)}),$("#luckysheet-icon-italic").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=u.luckysheet_select_save[0].row_focus,l=u.luckysheet_select_save[0].column_focus,o=e.checkstatus(t,a,l,"it");o=o==1?0:1,e.updateFormat(t,"it",o),e.menuButtonFocus(t,a,l)}),$("#luckysheet-icon-strikethrough").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=u.luckysheet_select_save[0].row_focus,l=u.luckysheet_select_save[0].column_focus,o=e.checkstatus(t,a,l,"cl");o=o==1?0:1,e.updateFormat(t,"cl",o),e.menuButtonFocus(t,a,l)}),$("#luckysheet-icon-underline").mousedown(function(t){Ji(t),t.stopPropagation()}).click(function(){var t=vr.deepCopyFlowData(u.flowdata),a=u.luckysheet_select_save[0].row_focus,l=u.luckysheet_select_save[0].column_focus,o=e.checkstatus(t,a,l,"un");o=o==1?0:1,e.updateFormat(t,"un",o),e.menuButtonFocus(t,a,l)}),$("#luckysheet-icon-conditionformat").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t),l=st().conditionformat;if(a.length==0){var o=[{text:l.highlightCellRules,value:"highlightCellRule",example:"more"},{text:l.itemSelectionRules,value:"projectSelectRule",example:"more"},{text:l.dataBar,value:"dataBar",example:"more"},{text:l.colorGradation,value:"colorGradation",example:"more"},{text:l.icons,value:"icons",example:""},{text:"",value:"split",example:""},{text:l.newRule,value:"newRule",example:""},{text:l.deleteRule,value:"deleteRule",example:"more"},{text:l.manageRules,value:"administerRule",example:""}],d=e.createButtonMenu(o),s=br(e.menu,{id:"conditionformat",item:d,subclass:"",sub:""}),h=[{text:l.greaterThan,value:"greaterThan",example:">"},{text:l.lessThan,value:"lessThan",example:"<"},{text:l.between,value:"betweenness",example:"[]"},{text:l.equal,value:"equal",example:"="},{text:l.textContains,value:"textContains",example:"()"},{text:l.occurrence,value:"occurrenceDate",example:l.yesterday},{text:l.duplicateValue,value:"duplicateValue",example:"##"}],f=e.createButtonMenu(h),p=br(e.menu,{id:"highlightCellRule",item:f,subclass:"luckysheet-menuButton-sub"}),g=[{text:l.top10,value:"top10",example:l.top10},{text:l.top10_percent,value:"top10%",example:l.top10_percent},{text:l.last10,value:"last10",example:l.last10},{text:l.last10_percent,value:"last10%",example:l.last10_percent},{text:l.aboveAverage,value:"AboveAverage",example:l.above},{text:l.belowAverage,value:"SubAverage",example:l.below}],v=e.createButtonMenu(g),y=br(e.menu,{id:"projectSelectRule",item:v,subclass:"luckysheet-menuButton-sub"}),b=`<div id="luckysheet-icon-dataBar-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="`.concat(l.gradientDataBar_1,`"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="`).concat(l.gradientDataBar_2,`"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="`).concat(l.gradientDataBar_3,`"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="`).concat(l.gradientDataBar_4,`"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="`).concat(l.gradientDataBar_5,`"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="`).concat(l.gradientDataBar_6,`"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="`).concat(l.solidColorDataBar_1,`"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="`).concat(l.solidColorDataBar_2,`"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="`).concat(l.solidColorDataBar_3,`"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -108px;" title="`).concat(l.solidColorDataBar_4,`"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -108px;" title="`).concat(l.solidColorDataBar_5,`"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -108px;" title="`).concat(l.solidColorDataBar_6,`"></div>
                                    </div>
                                </div>`),k=`<div id="luckysheet-icon-colorGradation-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="`.concat(l.colorGradation_1,`"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="`).concat(l.colorGradation_2,`"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="`).concat(l.colorGradation_3,`"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px 0;" title="`).concat(l.colorGradation_4,`"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="`).concat(l.colorGradation_5,`"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="`).concat(l.colorGradation_6,`"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="`).concat(l.colorGradation_7,`"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -36px;" title="`).concat(l.colorGradation_8,`"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="`).concat(l.colorGradation_9,`"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="`).concat(l.colorGradation_10,`"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="`).concat(l.colorGradation_11,`"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -72px;" title="`).concat(l.colorGradation_12,`"></div>
                                    </div>
                                </div>`),w=[{text:l.deleteSheetRule,value:"delSheet",example:""}],_=e.createButtonMenu(w),C=br(e.menu,{id:"deleteRule",item:_,subclass:"luckysheet-menuButton-sub"});$("body").append(s+p+y+b+k+C),a=$("#"+t).width(190),$("#luckysheet-icon-highlightCellRule-menuButton").width(160),$("#luckysheet-icon-projectSelectRule-menuButton").width(180),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var E=$(this).attr("itemvalue");if(E=="icons"){if(u.luckysheet_select_save.length==0)return void(Rt()?alert(l.pleaseSelectRange):Ee.info(l.pleaseSelectRange,""));kr.CFiconsDialog(),kr.init()}else if(E=="newRule"){if(u.luckysheet_select_save.length==0)return void(Rt()?alert(l.pleaseSelectRange):Ee.info(l.pleaseSelectRange,""));kr.newConditionRuleDialog(0),kr.init()}else if(E=="administerRule"){var R=nt.loadSheetUrl,F=an();if(R!=""&&R!=null){for(var N=[],z=0;z<F.length;z++)N.push(F[z].index);$.post(R,{gridKey:nt.gridKey,index:N.join(",")},function(P){var q=new Function("return "+P)();for(var V in setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),q)if(V!=u.currentSheetIndex){var x=F[je(V)];x.celldata=q[V.toString()],x.data=ir.buildGridData(x)}oc(F),kr.fileClone=$.extend(!0,[],F),kr.administerRuleDialog(),kr.init()})}else kr.fileClone=$.extend(!0,[],F),kr.administerRuleDialog(),kr.init()}}),$(document).off("click.CFhighlightCellRule").on("click.CFhighlightCellRule","#luckysheet-icon-highlightCellRule-menuButton .luckysheet-cols-menuitem",function(){a.hide(),$("#luckysheet-icon-highlightCellRule-menuButton").hide(),la();var E=$(this).attr("itemvalue");if(u.luckysheet_select_save.length!=0){var R,F,N=kr.textCellColorHtml();switch(E){case"greaterThan":R=l.conditionformat_greaterThan,F=`<div class="box" data-itemvalue="greaterThan">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_greaterThan_title,`</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(l.selectCell,`"></i>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div> 
                                                `).concat(N,` 
                                            </div>`);break;case"lessThan":R=l.conditionformat_lessThan,F=`<div class="box" data-itemvalue="lessThan">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_lessThan_title,`</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(l.selectCell,`"></i>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"betweenness":R=l.conditionformat_betweenness,F=`<div class="box" data-itemvalue="betweenness">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_betweenness_title,`</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="`).concat(l.selectCell,`"></i>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.to,`</div>
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal2" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="`).concat(l.selectCell,`"></i>
                                                    </div>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"equal":R=l.conditionformat_equal,F=`<div class="box" data-itemvalue="equal">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_equal_title,`</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(l.selectCell,`"></i>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"textContains":R=l.conditionformat_textContains,F=`<div class="box" data-itemvalue="textContains">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_textContains_title,`</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="`).concat(l.selectCell,`"></i>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"occurrenceDate":R=l.conditionformat_occurrenceDate,F=`<div class="box" data-itemvalue="occurrenceDate">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_occurrenceDate_title,`</div>
                                                <div class="inpbox">
                                                    <input id="daterange-btn" class="formulaInputFocus" readonly="readonly" placeholder="`).concat(l.pleaseSelectADate,`"/>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"duplicateValue":R=l.conditionformat_duplicateValue,F=`<div class="box" data-itemvalue="duplicateValue">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_duplicateValue_title,`</div>
                                                <select id="conditionVal" class="selectbox">
                                                    <option value="0">`).concat(l.duplicateValue,`</option>
                                                    <option value="1">`).concat(l.uniqueValue,`</option>
                                                </select>
                                                <div style="margin:5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`)}kr.conditionformatDialog(R,F)}else Rt()?alert(l.pleaseSelectRange):Ee.info(l.pleaseSelectRange,"")}),$(document).off("click.CFprojectSelectRule").on("click.CFprojectSelectRule","#luckysheet-icon-projectSelectRule-menuButton .luckysheet-cols-menuitem",function(){a.hide(),$("#luckysheet-icon-projectSelectRule-menuButton").hide(),la();var E=$(this).attr("itemvalue");if(u.luckysheet_select_save.length!=0){var R,F,N=kr.textCellColorHtml();switch(E){case"top10":R=l.conditionformat_top10,F=`<div class="box" data-itemvalue="top10">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_top10_title,`</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.top,`</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.oneself,`</div>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"top10%":R=l.conditionformat_top10_percent,F=`<div class="box" data-itemvalue="top10%">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_top10_title,`</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.top,`</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"last10":R=l.conditionformat_last10,F=`<div class="box" data-itemvalue="last10">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_last10_title,`</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.last,`</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.oneself,`</div>
                                                </div>
                                                <div style="margin: 5px 0;">`).concat(l.setAs,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"last10%":R=l.conditionformat_last10_percent,F=`<div class="box" data-itemvalue="last10%">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_last10_title,`</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">`).concat(l.last,`</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin:5px 0;"></div>
                                                `).concat(N,`
                                            </div>`);break;case"AboveAverage":R=l.conditionformat_AboveAverage,F=`<div class="box" data-itemvalue="AboveAverage">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_AboveAverage_title,`</div>
                                                <div style="margin: 5px 0;">`).concat(l.setAsByArea,`</div>
                                                `).concat(N,`
                                            </div>`);break;case"SubAverage":R=l.conditionformat_SubAverage,F=`<div class="box" data-itemvalue="SubAverage">
                                                <div class="boxTitleOne">`.concat(l.conditionformat_SubAverage_title,`</div>
                                                <div style="margin: 5px 0;">`).concat(l.setAsByArea,`</div>
                                                `).concat(N,`
                                            </div>`)}kr.conditionformatDialog(R,F)}else Rt()?alert(l.pleaseSelectRange):Ee.info(l.pleaseSelectRange,"")}),$(document).off("click.CFdataBar").on("click.CFdataBar","#luckysheet-icon-dataBar-menuButton .luckysheet-cols-menuitem",function(){a.hide(),$("#luckysheet-icon-dataBar-menuButton").hide(),la();var E=$(this).attr("itemvalue");if(u.luckysheet_select_save.length>0){var R=$.extend(!0,[],u.luckysheet_select_save),F=kr.dataBarList[E].format;kr.updateItem("dataBar",R,F)}}),$(document).off("click.CFcolorGradation").on("click.CFcolorGradation","#luckysheet-icon-colorGradation-menuButton .luckysheet-cols-menuitem",function(){a.hide(),$("#luckysheet-icon-colorGradation-menuButton").hide(),la();var E=$(this).attr("itemvalue");if(u.luckysheet_select_save.length>0){var R=$.extend(!0,[],u.luckysheet_select_save),F=kr.colorGradationList[E].format;kr.updateItem("colorGradation",R,F)}}),$(document).off("click.CFdeleteRule").on("click.CFdeleteRule","#luckysheet-icon-deleteRule-menuButton .luckysheet-cols-menuitem",function(){a.hide(),$("#luckysheet-icon-deleteRule-menuButton").hide(),la(),$(this).attr("itemvalue")=="delSheet"&&kr.updateItem("delSheet")})}var A=$(this).outerWidth(),I=a.outerWidth(),S=$(this).offset().left;I>A&&I+S>$("#"+u.container).width()&&(S=S-I+A),al(a,S,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-postil").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t),l=st().comment;a.remove(),Lr.removeActivePs();var o=u.luckysheet_select_save[u.luckysheet_select_save.length-1],d=o.row_focus;d==null&&(d=o.row[0]);var s,h=o.column_focus;h==null&&(h=o.column[0]),s=u.flowdata[d][h]!=null&&u.flowdata[d][h].ps!=null?[{text:l.edit,value:"editPs",example:""},{text:l.delete,value:"delPs",example:""},{text:"",value:"split",example:""},{text:l.showOne,value:"showHidePs",example:""},{text:l.showAll,value:"showHideAllPs",example:""}]:[{text:l.insert,value:"newPs",example:""},{text:"",value:"split",example:""},{text:l.showAll,value:"showHideAllPs",example:""}];var f=e.createButtonMenu(s),p=br(e.menu,{id:"postil",item:f,subclass:"",sub:""});$("body").append(p),(a=$("#"+t).width(150)).find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var b=$(this).attr("itemvalue");b=="newPs"?Lr.newPs(d,h):b=="editPs"?Lr.editPs(d,h):b=="delPs"?Lr.delPs(d,h):b=="showHidePs"?Lr.showHidePs(d,h):b=="showHideAllPs"&&Lr.showHideAllPs()});var g=$(this).outerWidth(),v=a.outerWidth(),y=$(this).offset().left;v>g&&v+y>$("#"+u.container).width()&&(y=y-v+g),al(a,y,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-protection").click(function(){db(ir.getSheetByIndex())}),$("#luckysheet-icon-print").click(function(){var t=$(this).attr("id")+"-menuButton",a=$("#"+t),l=st().print;if(a.length==0){var o=[{text:l.menuItemPrint,value:"print",example:'<i class="iconfont luckysheet-iconfont-dayin" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:l.menuItemAreas,value:"areas",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:l.menuItemRows,value:"rows",example:'<i class="iconfont luckysheet-iconfont-zhuandao1" aria-hidden="true"></i>'},{text:l.menuItemColumns,value:"columns",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'}],d=e.createButtonMenu(o),s=br(e.menu,{id:"print",item:d,subclass:"",sub:""});$("body").append(s),(a=$("#"+t).width(180)).find(".luckysheet-cols-menuitem").click(function(){a.hide(),la();var g=$(this).attr("itemvalue");g=="print"?alert("print"):g!="areas"&&g!="rows"&&g!="columns"||alert("areas")})}var h=$(this).outerWidth(),f=a.outerWidth(),p=$(this).offset().left;f>h&&f+p>$("#"+u.container).width()&&(p=p-f+h),al(a,p,$(this).offset().top+25,"lefttop")}),$("body").on("mouseover mouseleave",".luckysheet-menuButton .luckysheet-cols-submenu",function(t){var a=$(this),l=a.attr("itemvalue"),o=$("#luckysheet-icon-"+l+"-menuButton");if(t.type==="mouseover"){var d=a.parent(),s=$(window).width(),h=$(window).height(),f=d.width(),p=o.height()+25,g=o.width()+5,v=a.offset(),y=v.top,b=v.left+f;b+g>s&&(b=v.left-g),y+p>h&&(y=h-p),o.css({top:y,left:b}).show(),e.rightclickmenu=a}else clearTimeout(e.submenuhide[o.attr("id")]),e.submenuhide[o.attr("id")]=setTimeout(function(){o.hide()},200)}).on("mouseover mouseleave",".luckysheet-menuButton-sub",function(t){t.type==="mouseover"?(e.rightclickmenu.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(e.submenuhide[$(this).attr("id")])):(e.rightclickmenu.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide())})},getQKBorder:function(e,n,t){var a="";e.indexOf("pt")>-1?(e=parseFloat(e))<1||(a=e<1.5?"Medium":"Thick"):(e=parseFloat(e))<2||(a=e<3?"Medium":"Thick");var l=0;return(n=n.toLowerCase())=="double"?l=2:n=="dotted"?l=a=="Medium"||a=="Thick"?3:10:n=="dashed"?l=a=="Medium"||a=="Thick"?4:9:n=="solid"&&(l=a=="Medium"?8:a=="Thick"?13:1),[l,t]},updateFormatCell:function(e,n,t,a,l,o,d){var s,h;if(e!=null&&n!=null)if(n=="ct"){for(var f=a;f<=l;f++)if(u.config.rowhidden==null||u.config.rowhidden[f]==null)for(var p=o;p<=d;p++){var g=e[f][p],v=null;v=D(g)=="object"?e[f][p].v:e[f][p],t!="@"&&M(v)&&(v=parseFloat(v));var y=za(t,v),b="n";s=t,h=void 0,tl.is_date(s,h)||t===14||t===15||t===16||t===17||t===18||t===19||t===20||t===21||t===22||t===45||t===46||t===47?b="d":t=="@"||t===49?b="s":t!="General"&&t!==0||(b="g"),D(g)=="object"?(e[f][p].m=y,e[f][p].ct==null&&(e[f][p].ct={}),e[f][p].ct.fa=t,e[f][p].ct.t=b):e[f][p]={ct:{fa:t,t:b},v,m:y}}}else{n=="ht"?t=="left"?t="1":t=="center"?t="0":t=="right"&&(t="2"):n=="vt"?t=="top"?t="1":t=="middle"?t="0":t=="bottom"&&(t="2"):n=="tb"?t=="overflow"?t="1":t=="clip"?t="0":t=="wrap"&&(t="2"):n=="tr"&&(t=="none"?t="0":t=="angleup"?t="1":t=="angledown"?t="2":t=="vertical"?t="3":t=="rotation-up"?t="4":t=="rotation-down"&&(t="5"));for(var k=a;k<=l;k++)if(u.config.rowhidden==null||u.config.rowhidden[k]==null)for(var w=o;w<=d;w++){var _=e[k][w];D(_)=="object"?(X1(_,n,t),e[k][w][n]=t):(e[k][w]={v:_},e[k][w][n]=t)}}},updateFormat:function(e,n,t){if(ro(u.currentSheetIndex)&&u.allowEdit!==!1){document.createElement("canvas").getContext("2d"),n in G1&&parseInt($("#luckysheet-input-box").css("top"))>0&&$("#luckysheet-input-box").text().substr(0,1)!="="&&(e[u.luckysheetCellUpdate[0]][u.luckysheetCellUpdate[1]],W1(0,n,t));var a=$.extend(!0,{},u.config);a.rowlen==null&&(a.rowlen={});for(var l=0;l<u.luckysheet_select_save.length;l++){var o=u.luckysheet_select_save[l].row[0],d=u.luckysheet_select_save[l].row[1],s=u.luckysheet_select_save[l].column[0],h=u.luckysheet_select_save[l].column[1];this.updateFormatCell(e,n,t,o,d,s,h),n!="tb"&&n!="tr"&&n!="fs"||(a=Yl(e,o,d,a))}var f={};n!="tb"&&n!="tr"&&n!="fs"||(f={cfg:a,RowlChange:!0}),wa(e,u.luckysheet_select_save,f,!1)}},updateFormat_mc:function(e,n){var t=$.extend(!0,{},u.config);if(t.merge==null&&(t.merge={}),Os(u.currentSheetIndex)){if(n=="mergeCancel")for(var a=0;a<u.luckysheet_select_save.length;a++){var l=u.luckysheet_select_save[a],o=l.row[0],d=l.row[1],s=l.column[0],h=l.column[1];if(o!=d||s!=h)for(var f={},p=o;p<=d;p++)for(var g=s;g<=h;g++){var v=e[p][g];if(v!=null&&v.mc!=null){var y=v.mc.r,b=v.mc.c;if("rs"in v.mc)delete v.mc,delete t.merge[y+"_"+b],f[y+"_"+b]=$.extend(!0,{},v);else{var k=JSON.parse(JSON.stringify(f[y+"_"+b]));delete k.v,delete k.m,delete k.ct,delete k.f,delete k.spl,e[p][g]=k}}}}else{for(var w=!1,_=0;_<u.luckysheet_select_save.length;_++)for(var C=u.luckysheet_select_save[_],A=C.row[0],I=C.row[1],S=C.column[0],E=C.column[1],R=A;R<=I;R++)for(var F=S;F<=E;F++){var N=e[R][F];if(D(N)=="object"&&"mc"in N){w=!0;break}}if(w)for(var z=0;z<u.luckysheet_select_save.length;z++){var P=u.luckysheet_select_save[z],q=P.row[0],V=P.row[1],x=P.column[0],ee=P.column[1];if(q!=V||x!=ee)for(var ne={},ae=q;ae<=V;ae++)for(var de=x;de<=ee;de++){var ve=e[ae][de];if(ve!=null&&ve.mc!=null){var U=ve.mc.r,B=ve.mc.c;if("rs"in ve.mc)delete ve.mc,delete t.merge[U+"_"+B],ne[U+"_"+B]=$.extend(!0,{},ve);else{var le=JSON.parse(JSON.stringify(ne[U+"_"+B]));delete le.v,delete le.m,delete le.ct,delete le.f,delete le.spl,e[ae][de]=le}}}}else for(var Te=0;Te<u.luckysheet_select_save.length;Te++){var ue=u.luckysheet_select_save[Te],be=ue.row[0],ye=ue.row[1],ce=ue.column[0],Re=ue.column[1];if(be!=ye||ce!=Re){if(n=="mergeAll"){for(var pe={},me=!1,re=be;re<=ye;re++)for(var _e=ce;_e<=Re;_e++){var Ze=e[re][_e];Ze==null||$t(Ze.v)&&Ze.f==null||me||(pe=$.extend(!0,{},Ze),me=!0),e[re][_e]={mc:{r:be,c:ce}}}e[be][ce]=pe,e[be][ce].mc={r:be,c:ce,rs:ye-be+1,cs:Re-ce+1},t.merge[be+"_"+ce]={r:be,c:ce,rs:ye-be+1,cs:Re-ce+1}}else if(n=="mergeV")for(var We=ce;We<=Re;We++){for(var Xe={},Ue=!1,mt=be;mt<=ye;mt++){var St=e[mt][We];St==null||$t(St.v)&&St.f==null||Ue||(Xe=$.extend(!0,{},St),Ue=!0),e[mt][We]={mc:{r:be,c:We}}}e[be][We]=Xe,e[be][We].mc={r:be,c:We,rs:ye-be+1,cs:1},t.merge[be+"_"+We]={r:be,c:We,rs:ye-be+1,cs:1}}else if(n=="mergeH")for(var at=be;at<=ye;at++){for(var dt={},wt=!1,ct=ce;ct<=Re;ct++){var bt=e[at][ct];bt==null||$t(bt.v)&&bt.f==null||wt||(dt=$.extend(!0,{},bt),wt=!0),e[at][ct]={mc:{r:at,c:ce}}}e[at][ce]=dt,e[at][ce].mc={r:at,c:ce,rs:1,cs:Re-ce+1},t.merge[at+"_"+ce]={r:at,c:ce,rs:1,cs:Re-ce+1}}}}}u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"mergeChange",sheetIndex:u.currentSheetIndex,data:u.flowdata,curData:e,range:$.extend(!0,[],u.luckysheet_select_save),config:$.extend(!0,{},u.config),curConfig:t})),u.clearjfundo=!1,wa(e,u.luckysheet_select_save,{cfg:t}),u.clearjfundo=!0}},borderfix:function(e,n,t){return e[n][t]==null||e[n][t].bg==null||e[n][t].bg==""?[-1,0,0,-1]:[-2,-1,1,0]},changeMenuButtonDom:function(e,n,t){t==null&&(t=st());var a=t.fontarray;if(t.fontjson,e=="bl")n!="0"?$("#luckysheet-icon-bold").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-bold").removeClass("luckysheet-toolbar-button-hover");else if(e=="it")n!="0"?$("#luckysheet-icon-italic").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-italic").removeClass("luckysheet-toolbar-button-hover");else if(e=="cl")n!="0"?$("#luckysheet-icon-strikethrough").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-strikethrough").removeClass("luckysheet-toolbar-button-hover");else if(e=="un")n!="0"?$("#luckysheet-icon-underline").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-underline").removeClass("luckysheet-toolbar-button-hover");else if(e=="ff"){var l=$("#luckysheet-icon-font-family-menuButton"),o=a[0],d=0;n!=null&&(vc(n).num?(o=a[d=parseInt(n)])==null&&(o=d=this.defualtFont[d],d!=null&&this.addFontTolist(d)):(d=n=n.replace(/"/g,"").replace(/'/g,""),o=n,this.addFontTolist(d))),this.focus(l,d),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+o+" ")}else if(e=="fs"){var s=$("#luckysheet-icon-font-size-menuButton"),h=n,f=$("#luckysheet-icon-font-size input");this.focus(s,h),$("#luckysheet-icon-font-size").attr("itemvalue",h),f.val(h)}else if(e=="ht"){var p=$("#luckysheet-icon-align-menu-menuButton"),g=($("luckysheet-icon-align"),"left");n=="0"?g="center":n=="2"&&(g="right"),this.focus(p,g);var v=rd;$("#luckysheet-icon-align").attr("type",g).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+g+v[g]),p.hide()}else if(e=="vt"){var y=$("#luckysheet-icon-valign-menu-menuButton"),b=($("luckysheet-icon-valign"),"bottom");n=="1"?b="top":n=="0"&&(b="middle"),this.focus(y,b);var k=rd;$("#luckysheet-icon-valign").attr("type",b).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+b+k[b]),y.hide()}else if(e=="tb"){var w=$("#luckysheet-icon-textwrap-menu-menuButton"),_=($("luckysheet-icon-textwrap"),"clip");n=="1"?_="overflow":n=="2"&&(_="wrap"),this.focus(w,_);var C=Af;$("#luckysheet-icon-textwrap").attr("type",_).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+_+C[_]),w.hide()}else if(e=="tr"){var A=$("#luckysheet-icon-rotation-menu-menuButton"),I=($("luckysheet-icon-rotation"),"none");n=="1"?I="angleup":n=="2"?I="angledown":n=="3"?I="vertical":n=="4"?I="rotation-up":n=="5"&&(I="rotation-down"),this.focus(A,I);var S=Sf;$("#luckysheet-icon-rotation").attr("type",I).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+I+S[I]),A.hide()}else if(e=="ct"){var E=$("#luckysheet-icon-fmt-other"),R=st().defaultFmt;if(!n)return void E.find(".luckysheet-toolbar-menu-button-caption").html(" "+R[0].text+" ");var F=n.fa,N=R.find(function(P){return P.value===F});if(N)E.find(".luckysheet-toolbar-menu-button-caption").html(" "+N.text+" ");else{var z=R.find(function(P){return P.value==="fmtOtherSelf"});E.find(".luckysheet-toolbar-menu-button-caption").html(" "+z.text+" ")}}},inputMenuButtonFocus:function(e){var n=window.getSelection().getRangeAt(0).startContainer;u.inlineStringEditRange=null;var t=st();if(n.parentNode.tagName=="SPAN"){var a=gp(n.parentNode.style.cssText);for(var l in a)this.changeMenuButtonDom(l,a[l],t)}},menuButtonFocus:function(e,n,t){for(var a=["bl","it","cl","ff","ht","vt","fs","tb","tr","ct","un"],l=st(),o=0;o<a.length;o++){var d=a[o],s=this.checkstatus(e,n,t,d);this.changeMenuButtonDom(d,s,l)}},checkstatus:function(e,n,t,a){return e==null||e[n]==null?(console.warn("It's incorrect data",n,t),null):Qi(e[n][t],a)},setLineDash:function(e,n,t,a,l,o,d){n={0:"none",1:"Thin",2:"Hair",3:"Dotted",4:"Dashed",5:"DashDot",6:"DashDotDot",7:"Double",8:"Medium",9:"MediumDashed",10:"MediumDashDot",11:"MediumDashDotDot",12:"SlantedDashDot",13:"Thick"}[n.toString()];try{n=="Hair"?e.setLineDash([1,2]):n.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):n.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):n.indexOf("Dotted")>-1?e.setLineDash([2]):n.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(s){console.log(s)}e.beginPath(),n.indexOf("Medium")>-1?(t=="h"?(e.moveTo(a,l-.5),e.lineTo(o,d-.5)):(e.moveTo(a-.5,l),e.lineTo(o-.5,d)),e.lineWidth=2):n=="Thick"?(e.moveTo(a,l),e.lineTo(o,d),e.lineWidth=3):(e.moveTo(a,l),e.lineTo(o,d),e.lineWidth=1)},moveMergeData:function(e,n,t){if($t(e))return e;for(var a=[],l=[],o=!1,d=0;d<e.length;d++)for(var s=0;s<e[0].length;s++){var h=e[d][s];D(h)=="object"&&"mc"in h&&(h.mc.rs!=null&&(a.push({rs:h.mc.rs,cs:h.mc.cs,r:h.mc.r,c:h.mc.c}),l.push({rs:h.mc.rs,cs:h.mc.cs,r:h.mc.r+n,c:h.mc.c+t}),o=!0),e[d][s].mc.r+=n,e[d][s].mc.c+=t)}return{deleMC:a,insertMC:l,hasMC:o}},getRangeInMerge:function(e,n,t,a,l){var o=[],d=null;if((d=l!=null?$.extend(!0,{},this.getSheetConfig()):$.extend(!0,{},u.config))!=null&&d.merge!=null)for(var s in d.merge){var h=d.merge[s];e+n-1<h.r||e>h.r+h.rs-1||t+a-1<h.c||t>h.c+h.cs-1||o.push(h)}return o},mergeborer:function(e,n,t){if(e==null||e[n]==null)return console.warn("Merge info is null",n,t),null;var a=e[n][t];if(D(a)=="object"&&"mc"in a){var l=a.mc;if(l==null)return console.warn("Merge info is null",n,t),null;if(t=l.c,e[n=l.r][t]==null)return console.warn("Main merge Cell info is null",n,t),null;for(var o,d,s,h,f,p,g,v,y=e[n][t].mc.cs,b=e[n][t].mc.rs,k=e[n][t].mc,w=n;w<k.rs+n;w++)o=w==0?-1:u.visibledatarow[w-1]-1,d=u.visibledatarow[w],h==null?(h=o,s=d):s+=d-o-1;for(var _=t;_<k.cs+t;_++)f=_==0?0:u.visibledatacolumn[_-1],p=u.visibledatacolumn[_],v==null?(v=f,g=p):g+=p-f;return{row:[h,s,n,n+b-1],column:[v,g,t,t+y-1]}}return null},mergeMoveData:{},mergeMoveMain:function(e,n,t,a,l,o,d){var s=ir.getSheetMerge();if(s!=null){var h=[];for(var f in s)h.push(f);n[0]>n[1]&&(n[1]=n[0]),e[0]>e[1]&&(e[1]=e[0]);var p=!0;for(this.mergeMoveData={};p;){p=!1;for(var g=0;g<h.length;g++){var v=h[g],y=s[v];if(!(v in this.mergeMoveData)){var b=this.mergeMove(y,e,n,t,a,l,o,d);b!=null?(this.mergeMoveData[v]=y,e=b[0],n=b[1],a=b[2],l=b[3],o=b[4],d=b[5],p=!0):delete this.mergeMoveData[v]}}}return[e,n,a,l,o,d]}},mergeMove:function(e,n,t,a,l,o,d,s){var h=e.r,f=e.r+e.rs-1,p=e.c,g=e.c+e.cs-1,v=!1;if(n[1]<n[0]&&(n[0]=n[1]),t[1]<t[0]&&(t[0]=t[1]),n[0]<=p&&n[1]>=g&&t[0]<=h&&t[1]>=f||!(n[1]<p||n[0]>g)&&!(t[1]<h||t[0]>f)){var y=this.mergeborer(u.flowdata,e.r,e.c);if(y){var b=y.row[1],k=y.row[0],w=(y.row[2],y.column[1]),_=y.column[0];y.column[2],n[1]<p||n[0]>g||(t[0]<=f&&t[0]>=h&&(o+=l-k,l=k,t[0]=h),t[1]>=h&&t[1]<=f&&(o=(a.row_focus>=h&&a.row_focus,b-l),t[1]=f)),t[1]<h||t[0]>f||(n[0]<=g&&n[0]>=p&&(s+=d-_,d=_,n[0]=p),n[1]>=p&&n[1]<=g&&(s=(a.column_focus>=p&&a.column_focus,w-d),n[1]=g)),v=!0}}return v?[n,t,l,o,d,s]:null},getCellRealSize:function(e,n,t){var a=u.defaultcollen,l=u.defaultrowlen,o=e[n][t];if(o&&o.mc!=null){var d=o.mc,s=this.mergeborer(e,d.r,d.c);if(s){var h=s.row[1],f=s.row[0],p=(s.row[2],s.row[3],s.column[1]),g=s.column[0];s.column[2],s.column[3],a=p-g-1,l=h-f-1}}else{var v=an()[je(u.currentSheetIndex)].config;v.columnlen!=null&&v.columnlen[t]!=null&&(a=v.columnlen[t]),v.rowlen!=null&&v.rowlen[n]!=null&&(l=v.rowlen[n])}return[a,l]},getTextHeightCache:{},getTextSize:function(e,n){var t=st().fontarray,a=n||"10pt "+t[0];if(a in this.getTextHeightCache)return this.getTextHeightCache[a];$("#luckysheetTextSizeTest").length==0&&$('<span id="luckysheetTextSizeTest" style="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;">'+e+"</span>").appendTo($("body"));var l=$("#luckysheetTextSizeTest").text(e).css({font:a}),o=l.innerWidth(),d=l.innerHeight();return this.getTextHeightCache[a]=[o,d],[o,d]},activeFormulaInput:function(e,n,t,a,l,o){if(o==null&&(o=!1),ri(e,n,u.flowdata,!0),o){var d='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+l.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(d),window.getSelection();var s=$("#luckysheet-rich-text-editor").find("span");m.setCaretPosition(s.get(s.length-2),0,1)}else{var h=ol(t[0])[0],f=ol(t[1])[1],p=En(a[0])[0],g=En(a[1])[1],v='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+l.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span class="luckysheet-formula-functionrange-cell" rangeindex="0" dir="auto" style="color:'+Di[0]+';">'+wn(u.currentSheetIndex,{row:t,column:a},u.currentSheetIndex)+'</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(v),m.israngeseleciton(),m.rangestart=!0,m.rangedrag_column_start=!1,m.rangedrag_row_start=!1,m.rangechangeindex=0,m.rangeSetValue({row:t,column:a}),m.func_selectedrange={left:p,width:g-p-1,top:h,height:f-h-1,left_move:p,width_move:g-p-1,top_move:h,height_move:f-h-1,row:[e,e],column:[n,n]},$("#luckysheet-formula-functionrange-select").css({left:p,width:g-p-1,top:h,height:f-h-1}).show(),$("#luckysheet-formula-help-c").hide()}},backFormulaInput:function(e,n,t,a,l,o){var d="="+o.toUpperCase()+"("+wn(u.currentSheetIndex,{row:a,column:l},u.currentSheetIndex)+")",s=m.execfunction(d,n,t);Ln(n,t,e,{v:s[1],f:s[2]}),m.execFunctionExist.push({r:n,c:t,i:u.currentSheetIndex}),nt.historyParam(e,u.currentSheetIndex,{row:[n,n],column:[t,t]})},checkNoNullValue:function(e){var n=e;return D(n)=="object"&&(n=n.v),!($t(n)||!vc(n).num||e.ct!=null&&e.ct.t!=null&&e.ct.t!="n"&&e.ct.t!="g")},checkNoNullValueAll:function(e){var n=e;return D(n)=="object"&&(n=n.v),!$t(n)},getNoNullValue:function(e,n,t,a){for(var l=null,o=0,d=0,s=t-1;s>=0;s--){var h=void 0;if(h=a=="c"?e[n][s]:e[s][n],this.checkNoNullValue(h))l=s;else{if(h!=null&&h.v!=null&&h.v!="")break;if(++o>=40){if(!(d<=0))break;d=1}}}return l},singleFormulaInput:function(e,n,t,a,l,o,d,s,h){d==null&&(d="r"),s==null&&(s=!0),h==null&&(h=!0);for(var f=!0,p=!1,g=a;g<=l;g++){var v=null;v=d=="c"?e[g][t]:e[t][g],this.checkNoNullValue(v)?(f=!1,p=!0):this.checkNoNullValueAll(v)&&(f=!1)}if(f&&h)if(this.getNoNullValue(e,n,t,d)==null)d=="c"?this.activeFormulaInput(n,t,null,null,o,!0):this.activeFormulaInput(t,n,null,null,o,!0);else if(n==a)for(var y=a;y<=l;y++){var b=this.getNoNullValue(e,y,t,d);if(b==null)break;d=="c"?this.backFormulaInput(e,y,t,[y,y],[b,t-1],o):this.backFormulaInput(e,t,y,[b,t-1],[y,y],o)}else for(var k=l;k>=a;k--){var w=this.getNoNullValue(e,k,t,d);if(w==null)break;d=="c"?this.backFormulaInput(e,k,t,[k,k],[w,t-1],o):this.backFormulaInput(e,t,k,[w,t-1],[k,k],o)}else{if(!p||!s)return!0;var _=null;if((_=d=="c"?e[l][t]:e[t][l])!=null&&_.v!=null&&_.v.toString().length>0){var C=l;for(_=d=="c"?e[l][t]:e[t][l];_!=null&&_.v!=null&&_.v.toString().length>0;){if(++C>=(d=="c"?e.length:e[0].length))return;_=d=="c"?e[C][t]:e[t][C]}d=="c"?this.backFormulaInput(e,C,t,[a,l],[t,t],o):this.backFormulaInput(e,t,C,[t,t],[a,l],o)}else d=="c"?this.backFormulaInput(e,l,t,[a,l],[t,t],o):this.backFormulaInput(e,t,l,[t,t],[a,l],o)}},autoSelectionFormula:function(e){var n=this,t=vr.deepCopyFlowData(u.flowdata),a=!0;m.execFunctionExist=[];for(var l=function(_,C,A,I,S,E){var R=n.getNoNullValue(_,C,S,"c");R==null?n.activeFormulaInput(C,I,null,null,E,!0):n.activeFormulaInput(C,I,[C,A],[R,S-1],E)},o=function(_,C,A,I,S,E){var R=n.getNoNullValue(_,I,A,"r");R==null?l(_,C,A,I,S,E):n.activeFormulaInput(C,I,[R,A-1],[I,S],E)},d=0;d<u.luckysheet_select_save.length;d++){var s=u.luckysheet_select_save[d].row[0],h=u.luckysheet_select_save[d].row[1],f=u.luckysheet_select_save[d].column[0],p=u.luckysheet_select_save[d].column[1],g=u.luckysheet_select_save[d].row_focus,v=u.luckysheet_select_save[d].column_focus;if(s==h&&f==p){if(h-1<0&&p-1<0)return void n.activeFormulaInput(s,f,null,null,e,!0);h-1>=0&&n.checkNoNullValue(t[h-1][f])?o(t,s,h,f,p,e):p-1>=0&&n.checkNoNullValue(t[s][p-1])?l(t,s,h,f,p,e):o(t,s,h,f,p,e)}else if(s==h)a=n.singleFormulaInput(t,v,s,f,p,e,"r");else if(f==p)a=n.singleFormulaInput(t,g,f,s,h,e,"c");else{for(var y=!0,b=s;b<=h;b++)y=n.singleFormulaInput(t,v,b,f,p,e,"r",!0,!1)&&y;for(var k=!0,w=f;w<=p;w++)k=n.singleFormulaInput(t,g,w,s,h,e,"c",!0,!1)&&k;a=!!y&&!!k}a=a&&a}a||(m.execFunctionExist.reverse(),m.execFunctionGroup(null,null,null,null,t),wa(t,u.luckysheet_select_save),clearTimeout(u.jfcountfuncTimeout),u.jfcountfuncTimeout=setTimeout(function(){ql()},500))},getStyleByCell:function(e,n,t){var a="",l=Un.getComputeMap(),o=Un.checksAF(n,t,l),d=kr.getComputeMap(),s=kr.checksCF(n,t,d),h=(st().fontarray,e[n][t]),f=(h.ct,!1);for(var p in qi(h)&&(f=!0),h){var g=this.checkstatus(e,n,t,p);(o!=null||s!=null&&s.cellColor!=null)&&(s!=null&&s.cellColor!=null?a+="background: "+s.cellColor+";":o!=null&&(a+="background: "+o[1]+";")),D(g)!="object"&&((p=="bg"||o!=null||s!=null&&s.cellColor!=null)&&(s!=null&&s.cellColor!=null?a+="background: "+s.cellColor+";":a+=o!=null?"background: "+o[1]+";":"background: "+g+";"),p=="ht"&&g!="1"&&(g=="0"?a+="text-align: center;":g=="2"&&(a+="text-align: right;")),p=="vt"&&g!="1"&&(g=="0"?a+="align-items: center;":g=="2"&&(a+="align-items: flex-end;")))}return f||(a+=od(h,o,s)),a},fontSelectList:[],defualtFont:["Times New Roman","Arial","Tahoma","Verdana","","","","","","","","",""],addFontTolist:function(e){e=e.replace(/"/g,"").replace(/'/g,"");for(var n=!0,t=0;t<this.fontSelectList.length;t++)if(this.fontSelectList[t].value==e){n=!1;break}if(e in st().fontjson&&(n=!1),n){var a={};a.value=e,a.index=this.fontSelectList.length,a.type="userDefined",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+e+"'>"+e+"</span>",a.example="",this.fontSelectList.push(a);var l=$("#luckysheet-icon-font-family-menuButton"),o=this.createButtonMenu(this.fontSelectList);l.html(o)}},fontInitial:function(e){for(var n=[],t=st().fontarray,a=0;a<t.length;a++){var l=t[a],o={};o.value=l,o.index=a,o.type="inner",o.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+l+"'>"+l+"</span>",o.example="",n.push(o)}if(e!=null){for(var d=0;d<e.length;d++){var s=e[d],h={};if(h.value=s.fontName,h.index=d,h.type="userDefined",h.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+s.fontName+"'>"+s.fontName+"</span>",h.example="",n.push(h),document.fonts&&!document.fonts.check("12px "+s.fontName)&&s.url){var f=new FontFace(s.fontName,"url(".concat(s.url,")"));document.fonts.add(f),f.load()}}document.fonts&&document.fonts.ready.then(function(){})}this.fontSelectList=n}};function Yg(e,n){var t={};for(var a in e)t[a]=e[a];for(var l in n)n[l]!=null&&(t[l]=n[l]);return t}function br(e,n){return e.replace(/\$\{([\w]+)\}/g,function(t,a){var l=n[a];return l!==void 0?l:t})}function D(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}function fm(e){var n=new Date,t=n.getFullYear(),a=n.getMonth(),l=n.getDate(),o=(n.getDay(),n.getHours()),d=n.getMinutes(),s=n.getSeconds();(a+=1)<10&&(a="0"+a),l<10&&(l="0"+l),o<10&&(o="0"+o),d<10&&(d="0"+d),s<10&&(s="0"+s);var h="";return e==1?h=t+"-"+a+"-"+l:e==2&&(h=t+"-"+a+"-"+l+" "+o+":"+d+":"+s),h}function Tu(e){var n;return n=e.indexOf("rgba")>-1?e.replace("rgba(","").replace(")","").split(","):e.replace("rgb(","").replace(")","").split(","),"#"+((1<<24)+(parseInt(n[0])<<16)+(parseInt(n[1])<<8)+parseInt(n[2])).toString(16).slice(1)}function rl(e){if(e==null||e.length==0)return NaN;for(var n=e.toLowerCase().split(""),t=n.length,a=0,l=0;l<t;l++)a+=(n[l].charCodeAt()-96)*Math.pow(26,t-l-1);return a==0?NaN:a-1}function ya(e){for(var n=97,t=122-n+1,a="";e>=0;)a=String.fromCharCode(e%t+n)+a,e=Math.floor(e/t)-1;return a.toUpperCase()}function Rc(e,n){if(n===0)return"";if(e==null)return 0;for(var t=0,a=0;a<e.length;a++)if(e.charAt(a).match(/[^\x00-\xff]/gi)!=null?t+=2:t+=1,M(n)&&t===~~n)return e.substring(0,a);return t}function Xg(e){var n=[],t={};if(e.length>0)for(var a=0;a<e.length;a++){var l=e[a];t[l]||(n.push(l),t[l]=1)}return n}function bd(e){var n=st().fontarray;if(D(e)=="object"){var t="";if(e.it=="0"||e.it==null?t+="normal ":t+="italic ",t+="normal ",e.bl=="0"||e.bl==null?t+="normal ":t+="bold ",e.fs?t+=Math.ceil(e.fs)+"pt ":t+=u.defaultFontSize+"pt ",e.ff){var a=null;st().fontjson,vc(e.ff).num?a=n[parseInt(e.ff)]:((a=(a=e.ff).replace(/"/g,"").replace(/'/g,"")).indexOf(" ")>-1&&(a='"'+a+'"'),a!=null&&document.fonts&&!document.fonts.check("12px "+a)&&dr.addFontTolist(a)),a==null&&(a=n[0]),t+=a+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'}else t+=n[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';return t}return lc()}function Au(e,n,t){var a=$(window).height(),l=$(window).width(),o=e.width(),d=e.height(),s=t,h=n;n+o>l&&(h=n-o),t+d>a&&(s=t-d),s<0&&(s=0),e.css({top:s,left:h}).show()}function To(){u.fullscreenmode&&setTimeout(function(){$("#luckysheet-rich-text-editor").focus().select()},50)}function la(){$("#"+u.container).attr("tabindex",0).focus()}function Bl(e,n){if(e==null||isNaN(parseFloat(e))||Ku(e)||e==-1/0||e==1/0)return null;var t=6,a=!1;n==null||n=="auto"?t=e<1?6:1:ko(n)=="num"?(t=parseInt(n),a=!0):t=6;for(var l="",o=0;o<t;o++)l+="0";return a||(l="["+l+"]"),e>=1e21?parseFloat(cn(e).value()):parseFloat(cn(e).format("0."+l))}function Zg(e){if(e==null||isNaN(parseFloat(e))||Ku(e))return null;var n=cn(e).value().toString().split(".");return n=n.length==1?0:n[1].length}function al(e,n,t,a){var l=$(window).height(),o=($(window).width(),e.width());e.height(),a==null&&(a="lefttop"),a=="lefttop"?e.css({top:t,left:n}).show():a=="righttop"?e.css({top:t,left:n-o}).show():a=="leftbottom"?e.css({bottom:l-t-12,left:n}).show():a=="rightbottom"&&e.css({bottom:l-t-12,left:n-o}).show()}function na(e,n){var t=(n=n||document).querySelectorAll(e);return t.length==1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function Kg(e,n,t){ul(e)!=="object"&&(e=[e]);var a=document.getElementsByTagName("head")[0]||document.documentElement,l=[],o=e.length-1;(function d(s){if(l[s]=document.createElement("script"),l[s].setAttribute("type","text/javascript"),l[s].onload=l[s].onreadystatechange=function(){this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),s!==o?d(s+1):typeof t=="function"&&t()},l[s].setAttribute("src",e[s]),ul(n)==="object")for(var h in n)l[s].setAttribute(h,n[h]);a.appendChild(l[s])})(0)}function Jg(e){ul(e)!=="object"&&(e=[e]),e.length&&e.forEach(function(n){(function(t){var a=document,l=a.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",t);var o=a.getElementsByTagName("head");o.length?o[0].appendChild(l):a.documentElement.appendChild(l)})(n)})}function Ec(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],t=$("#"+e).find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=t.outerHeight(),l=t.outerWidth(),o=$(window).width(),d=$(window).height(),s=$(document).scrollLeft(),h=$(document).scrollTop();t.css({left:(o+s-l)/2,top:(d+h-a)/3}).show(),n&&$("#luckysheet-modal-dialog-mask").show()}var Qg=function(e,n,t){e.hasOwnProperty(n)?D(e)==="object"&&(D(e[n])==="object"||D(e[n])==="array"?function(a,l,o,d){a[l]=new Proxy(o,{set:function(s,h,f,p){return setTimeout(function(){d(s,h,f,p)},0),Reflect.set(s,h,f,p)}})}(e,n,e[n],t):function(a,l,o,d){Object.defineProperty(a,l,{enumerable:!0,configurable:!1,get:function(){return o},set:function(s){o!==s&&(console.log(" ".concat(l,"  ").concat(o," -> ").concat(s)),setTimeout(function(){d(o,s)},0),o=s)}})}(e,n,e[n],t)):console.info("No %s in data",n)};function ev(e,n){e.some(function(t,a,l){if(t===n)return l.splice(a,1),t===n})}var ai,tv=typeof ArrayBuffer<"u"&&typeof DataView<"u",Yb=Be.f,$c=K.Int8Array,pm=$c&&$c.prototype,rv=K.Uint8ClampedArray,av=rv&&rv.prototype,Ao=$c&&Wi($c),Li=pm&&Wi(pm),nv=Object.prototype,lv=nv.isPrototypeOf,iv=bn("toStringTag"),gm=Ht("TYPED_ARRAY_TAG"),So=tv&&!!Qa&&As(K.opera)!=="Opera",ov=!1,Pi={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},sv=function(e){return O(e)&&$e(Pi,As(e))};for(ai in Pi)K[ai]||(So=!1);if((!So||typeof Ao!="function"||Ao===Function.prototype)&&(Ao=function(){throw TypeError("Incorrect invocation")},So))for(ai in Pi)K[ai]&&Qa(K[ai],Ao);if((!So||!Li||Li===nv)&&(Li=Ao.prototype,So))for(ai in Pi)K[ai]&&Qa(K[ai].prototype,Li);if(So&&Wi(av)!==Li&&Qa(av,Li),H&&!$e(Li,iv))for(ai in ov=!0,Yb(Li,iv,{get:function(){return O(this)?this[gm]:void 0}}),Pi)K[ai]&&Qe(K[ai],gm,ai);var ga={NATIVE_ARRAY_BUFFER_VIEWS:So,TYPED_ARRAY_TAG:ov&&gm,aTypedArray:function(e){if(sv(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(Qa){if(lv.call(Ao,e))return e}else for(var n in Pi)if($e(Pi,ai)){var t=K[n];if(t&&(e===t||lv.call(t,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,n,t){if(H){if(t)for(var a in Pi){var l=K[a];l&&$e(l.prototype,e)&&delete l.prototype[e]}Li[e]&&!t||$r(Li,e,t?n:So&&pm[e]||n)}},exportTypedArrayStaticMethod:function(e,n,t){var a,l;if(H){if(Qa){if(t)for(a in Pi)(l=K[a])&&$e(l,e)&&delete l[e];if(Ao[e]&&!t)return;try{return $r(Ao,e,t?n:So&&$c[e]||n)}catch{}}for(a in Pi)!(l=K[a])||l[e]&&!t||$r(l,e,n)}},isView:function(e){var n=As(e);return n==="DataView"||$e(Pi,n)},isTypedArray:sv,TypedArray:Ao,TypedArrayPrototype:Li},Xb=ga.NATIVE_ARRAY_BUFFER_VIEWS,Zb=K.ArrayBuffer,Hs=K.Int8Array,Kb=!Xb||!we(function(){Hs(1)})||!we(function(){new Hs(-1)})||!sg(function(e){new Hs,new Hs(null),new Hs(1.5),new Hs(e)},!0)||we(function(){return new Hs(new Zb(2),1,void 0).length!==1}),Su=function(e){if(e===void 0)return 0;var n=ut(e),t=Zt(n);if(n!==t)throw RangeError("Wrong length or index");return t},Jb=Math.abs,Io=Math.pow,Qb=Math.floor,ek=Math.log,tk=Math.LN2,rk=function(e,n,t){var a,l,o,d=new Array(t),s=8*t-n-1,h=(1<<s)-1,f=h>>1,p=n===23?Io(2,-24)-Io(2,-77):0,g=e<0||e===0&&1/e<0?1:0,v=0;for((e=Jb(e))!=e||e===1/0?(l=e!=e?1:0,a=h):(a=Qb(ek(e)/tk),e*(o=Io(2,-a))<1&&(a--,o*=2),(e+=a+f>=1?p/o:p*Io(2,1-f))*o>=2&&(a++,o/=2),a+f>=h?(l=0,a=h):a+f>=1?(l=(e*o-1)*Io(2,n),a+=f):(l=e*Io(2,f-1)*Io(2,n),a=0));n>=8;d[v++]=255&l,l/=256,n-=8);for(a=a<<n|l,s+=n;s>0;d[v++]=255&a,a/=256,s-=8);return d[--v]|=128*g,d},ak=function(e,n){var t,a=e.length,l=8*a-n-1,o=(1<<l)-1,d=o>>1,s=l-7,h=a-1,f=e[h--],p=127&f;for(f>>=7;s>0;p=256*p+e[h],h--,s-=8);for(t=p&(1<<-s)-1,p>>=-s,s+=n;s>0;t=256*t+e[h],h--,s-=8);if(p===0)p=1-d;else{if(p===o)return t?NaN:f?-1/0:1/0;t+=Io(2,n),p-=d}return(f?-1:1)*t*Io(2,p-n)},nk=Pe.f,lk=Be.f,Iu=Vt.get,uv=Vt.set,Oi=K.ArrayBuffer,yi=Oi,zi=K.DataView,kd=zi&&zi.prototype,cv=Object.prototype,xd=K.RangeError,dv=rk,hv=ak,mv=function(e){return[255&e]},fv=function(e){return[255&e,e>>8&255]},pv=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},gv=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},ik=function(e){return dv(e,23,4)},ok=function(e){return dv(e,52,8)},wd=function(e,n){lk(e.prototype,n,{get:function(){return Iu(this)[n]}})},os=function(e,n,t,a){var l=Su(t),o=Iu(e);if(l+n>o.byteLength)throw xd("Wrong index");var d=Iu(o.buffer).bytes,s=l+o.byteOffset,h=d.slice(s,s+n);return a?h:h.reverse()},ss=function(e,n,t,a,l,o){var d=Su(t),s=Iu(e);if(d+n>s.byteLength)throw xd("Wrong index");for(var h=Iu(s.buffer).bytes,f=d+s.byteOffset,p=a(+l),g=0;g<n;g++)h[f+g]=p[o?g:n-g-1]};if(tv){if(!we(function(){Oi(1)})||!we(function(){new Oi(-1)})||we(function(){return new Oi,new Oi(1.5),new Oi(NaN),Oi.name!="ArrayBuffer"})){for(var vm,sk=(yi=function(e){return ao(this,yi),new Oi(Su(e))}).prototype=Oi.prototype,vv=nk(Oi),yv=0;vv.length>yv;)(vm=vv[yv++])in yi||Qe(yi,vm,Oi[vm]);sk.constructor=yi}Qa&&Wi(kd)!==cv&&Qa(kd,cv);var _d=new zi(new yi(2)),bv=kd.setInt8;_d.setInt8(0,2147483648),_d.setInt8(1,2147483649),!_d.getInt8(0)&&_d.getInt8(1)||Tc(kd,{setInt8:function(e,n){bv.call(this,e,n<<24>>24)},setUint8:function(e,n){bv.call(this,e,n<<24>>24)}},{unsafe:!0})}else yi=function(e){ao(this,yi,"ArrayBuffer");var n=Su(e);uv(this,{bytes:qh.call(new Array(n),0),byteLength:n}),H||(this.byteLength=n)},zi=function(e,n,t){ao(this,zi,"DataView"),ao(e,yi,"DataView");var a=Iu(e).byteLength,l=ut(n);if(l<0||l>a)throw xd("Wrong offset");if(l+(t=t===void 0?a-l:Zt(t))>a)throw xd("Wrong length");uv(this,{buffer:e,byteLength:t,byteOffset:l}),H||(this.buffer=e,this.byteLength=t,this.byteOffset=l)},H&&(wd(yi,"byteLength"),wd(zi,"buffer"),wd(zi,"byteLength"),wd(zi,"byteOffset")),Tc(zi.prototype,{getInt8:function(e){return os(this,1,e)[0]<<24>>24},getUint8:function(e){return os(this,1,e)[0]},getInt16:function(e){var n=os(this,2,e,arguments.length>1?arguments[1]:void 0);return(n[1]<<8|n[0])<<16>>16},getUint16:function(e){var n=os(this,2,e,arguments.length>1?arguments[1]:void 0);return n[1]<<8|n[0]},getInt32:function(e){return gv(os(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return gv(os(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return hv(os(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return hv(os(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,n){ss(this,1,e,mv,n)},setUint8:function(e,n){ss(this,1,e,mv,n)},setInt16:function(e,n){ss(this,2,e,fv,n,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,n){ss(this,2,e,fv,n,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,n){ss(this,4,e,pv,n,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,n){ss(this,4,e,pv,n,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,n){ss(this,4,e,ik,n,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,n){ss(this,8,e,ok,n,arguments.length>2?arguments[2]:void 0)}});Ms(yi,"ArrayBuffer"),Ms(zi,"DataView");var kv={ArrayBuffer:yi,DataView:zi},Cd=function(e,n){var t=function(a){var l=ut(a);if(l<0)throw RangeError("The argument can't be less than 0");return l}(e);if(t%n)throw RangeError("Wrong offset");return t},uk=ga.aTypedArrayConstructor,xv=function(e){var n,t,a,l,o,d,s=Dl(e),h=arguments.length,f=h>1?arguments[1]:void 0,p=f!==void 0,g=Cc(s);if(g!=null&&!am(g))for(d=(o=g.call(s)).next,s=[];!(l=d.call(o)).done;)s.push(l.value);for(p&&h>2&&(f=ru(f,arguments[2],2)),t=Zt(s.length),a=new(uk(this))(t),n=0;t>n;n++)a[n]=p?f(s[n],n):s[n];return a};Fe(function(e){var n=Pe.f,t=zl.forEach,a=Vt.get,l=Vt.set,o=Be.f,d=qe.f,s=Math.round,h=K.RangeError,f=kv.ArrayBuffer,p=kv.DataView,g=ga.NATIVE_ARRAY_BUFFER_VIEWS,v=ga.TYPED_ARRAY_TAG,y=ga.TypedArray,b=ga.TypedArrayPrototype,k=ga.aTypedArrayConstructor,w=ga.isTypedArray,_=function(R,F){for(var N=0,z=F.length,P=new(k(R))(z);z>N;)P[N]=F[N++];return P},C=function(R,F){o(R,F,{get:function(){return a(this)[F]}})},A=function(R){var F;return R instanceof f||(F=As(R))=="ArrayBuffer"||F=="SharedArrayBuffer"},I=function(R,F){return w(R)&&typeof F!="symbol"&&F in R&&String(+F)==String(F)},S=function(R,F){return I(R,F=Z(F,!0))?X(2,R[F]):d(R,F)},E=function(R,F,N){return!(I(R,F=Z(F,!0))&&O(N)&&$e(N,"value"))||$e(N,"get")||$e(N,"set")||N.configurable||$e(N,"writable")&&!N.writable||$e(N,"enumerable")&&!N.enumerable?o(R,F,N):(R[F]=N.value,R)};H?(g||(qe.f=S,Be.f=E,C(b,"buffer"),C(b,"byteOffset"),C(b,"byteLength"),C(b,"length")),Ce({target:"Object",stat:!0,forced:!g},{getOwnPropertyDescriptor:S,defineProperty:E}),e.exports=function(R,F,N){var z=R.match(/\d+$/)[0]/8,P=R+(N?"Clamped":"")+"Array",q="get"+R,V="set"+R,x=K[P],ee=x,ne=ee&&ee.prototype,ae={},de=function(ve,U){o(ve,U,{get:function(){return function(B,le){var Te=a(B);return Te.view[q](le*z+Te.byteOffset,!0)}(this,U)},set:function(B){return function(le,Te,ue){var be=a(le);N&&(ue=(ue=s(ue))<0?0:ue>255?255:255&ue),be.view[V](Te*z+be.byteOffset,ue,!0)}(this,U,B)},enumerable:!0})};g?Kb&&(ee=F(function(ve,U,B,le){return ao(ve,ee,P),ti(O(U)?A(U)?le!==void 0?new x(U,Cd(B,z),le):B!==void 0?new x(U,Cd(B,z)):new x(U):w(U)?_(ee,U):xv.call(ee,U):new x(Su(U)),ve,ee)}),Qa&&Qa(ee,y),t(n(x),function(ve){ve in ee||Qe(ee,ve,x[ve])}),ee.prototype=ne):(ee=F(function(ve,U,B,le){ao(ve,ee,P);var Te,ue,be,ye=0,ce=0;if(O(U)){if(!A(U))return w(U)?_(ee,U):xv.call(ee,U);Te=U,ce=Cd(B,z);var Re=U.byteLength;if(le===void 0){if(Re%z||(ue=Re-ce)<0)throw h("Wrong length")}else if((ue=Zt(le)*z)+ce>Re)throw h("Wrong length");be=ue/z}else be=Su(U),Te=new f(ue=be*z);for(l(ve,{buffer:Te,byteOffset:ce,byteLength:ue,length:be,view:new p(Te)});ye<be;)de(ve,ye++)}),Qa&&Qa(ee,y),ne=ee.prototype=gl(b)),ne.constructor!==ee&&Qe(ne,"constructor",ee),v&&Qe(ne,v,P),ae[P]=ee,Ce({global:!0,forced:ee!=x,sham:!g},ae),"BYTES_PER_ELEMENT"in ee||Qe(ee,"BYTES_PER_ELEMENT",z),"BYTES_PER_ELEMENT"in ne||Qe(ne,"BYTES_PER_ELEMENT",z),sh(P)}):e.exports=function(){}})("Uint8",function(e){return function(n,t,a){return e(this,n,t,a)}});var ck=Math.min,dk=[].copyWithin||function(e,n){var t=Dl(this),a=Zt(t.length),l=Ur(e,a),o=Ur(n,a),d=arguments.length>2?arguments[2]:void 0,s=ck((d===void 0?a:Ur(d,a))-o,a-l),h=1;for(o<l&&l<o+s&&(h=-1,o+=s-1,l+=s-1);s-- >0;)o in t?t[l]=t[o]:delete t[l],l+=h,o+=h;return t},hk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("copyWithin",function(e,n){return dk.call(hk(this),e,n,arguments.length>2?arguments[2]:void 0)});var mk=zl.every,fk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("every",function(e){return mk(fk(this),e,arguments.length>1?arguments[1]:void 0)});var pk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("fill",function(e){return qh.apply(pk(this),arguments)});var gk=zl.filter,vk=ga.aTypedArray,yk=ga.aTypedArrayConstructor;(0,ga.exportTypedArrayMethod)("filter",function(e){for(var n=gk(vk(this),e,arguments.length>1?arguments[1]:void 0),t=ac(this,this.constructor),a=0,l=n.length,o=new(yk(t))(l);l>a;)o[a]=n[a++];return o});var bk=zl.find,kk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("find",function(e){return bk(kk(this),e,arguments.length>1?arguments[1]:void 0)});var xk=zl.findIndex,wk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("findIndex",function(e){return xk(wk(this),e,arguments.length>1?arguments[1]:void 0)});var _k=zl.forEach,Ck=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("forEach",function(e){_k(Ck(this),e,arguments.length>1?arguments[1]:void 0)});var Tk=ha.includes,Ak=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("includes",function(e){return Tk(Ak(this),e,arguments.length>1?arguments[1]:void 0)});var Sk=ha.indexOf,Ik=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("indexOf",function(e){return Sk(Ik(this),e,arguments.length>1?arguments[1]:void 0)});var wv=bn("iterator"),_v=K.Uint8Array,Rk=as.values,Ek=as.keys,$k=as.entries,ym=ga.aTypedArray,Td=ga.exportTypedArrayMethod,bm=_v&&_v.prototype[wv],Cv=!!bm&&(bm.name=="values"||bm.name==null),Tv=function(){return Rk.call(ym(this))};Td("entries",function(){return $k.call(ym(this))}),Td("keys",function(){return Ek.call(ym(this))}),Td("values",Tv,!Cv),Td(wv,Tv,!Cv);var Dk=ga.aTypedArray,Fk=[].join;(0,ga.exportTypedArrayMethod)("join",function(e){return Fk.apply(Dk(this),arguments)});var qk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("lastIndexOf",function(e){return Fh.apply(qk(this),arguments)});var Mk=zl.map,Nk=ga.aTypedArray,Lk=ga.aTypedArrayConstructor;(0,ga.exportTypedArrayMethod)("map",function(e){return Mk(Nk(this),e,arguments.length>1?arguments[1]:void 0,function(n,t){return new(Lk(ac(n,n.constructor)))(t)})});var Av=function(e){return function(n,t,a,l){tc(t);var o=Dl(n),d=Se(o),s=Zt(o.length),h=e?s-1:0,f=e?-1:1;if(a<2)for(;;){if(h in d){l=d[h],h+=f;break}if(h+=f,e?h<0:s<=h)throw TypeError("Reduce of empty array with no initial value")}for(;e?h>=0:s>h;h+=f)h in d&&(l=t(l,d[h],h,o));return l}},Sv={left:Av(!1),right:Av(!0)},Pk=Sv.left,Ok=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("reduce",function(e){return Pk(Ok(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)});var zk=Sv.right,Bk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("reduceRight",function(e){return zk(Bk(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)});var Vk=ga.aTypedArray,Uk=ga.exportTypedArrayMethod,Hk=Math.floor;Uk("reverse",function(){for(var e,n=Vk(this).length,t=Hk(n/2),a=0;a<t;)e=this[a],this[a++]=this[--n],this[n]=e;return this});var jk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("set",function(e){jk(this);var n=Cd(arguments.length>1?arguments[1]:void 0,1),t=this.length,a=Dl(e),l=Zt(a.length),o=0;if(l+n>t)throw RangeError("Wrong length");for(;o<l;)this[n+o]=a[o++]},we(function(){new Int8Array(1).set({})}));var Gk=ga.aTypedArray,Wk=ga.aTypedArrayConstructor,Yk=[].slice;(0,ga.exportTypedArrayMethod)("slice",function(e,n){for(var t=Yk.call(Gk(this),e,n),a=ac(this,this.constructor),l=0,o=t.length,d=new(Wk(a))(o);o>l;)d[l]=t[l++];return d},we(function(){new Int8Array(1).slice()}));var Xk=zl.some,Zk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("some",function(e){return Xk(Zk(this),e,arguments.length>1?arguments[1]:void 0)});var Kk=ga.aTypedArray,Jk=[].sort;(0,ga.exportTypedArrayMethod)("sort",function(e){return Jk.call(Kk(this),e)});var Qk=ga.aTypedArray;(0,ga.exportTypedArrayMethod)("subarray",function(e,n){var t=Qk(this),a=t.length,l=Ur(e,a);return new(ac(t,t.constructor))(t.buffer,t.byteOffset+l*t.BYTES_PER_ELEMENT,Zt((n===void 0?a:Ur(n,a))-l))});var Ad=K.Int8Array,Iv=ga.aTypedArray,ex=ga.exportTypedArrayMethod,Rv=[].toLocaleString,tx=[].slice,rx=!!Ad&&we(function(){Rv.call(new Ad(1))});ex("toLocaleString",function(){return Rv.apply(rx?tx.call(Iv(this)):Iv(this),arguments)},we(function(){return[1,2].toLocaleString()!=new Ad([1,2]).toLocaleString()})||!we(function(){Ad.prototype.toLocaleString.call([1,2])}));var ax=ga.exportTypedArrayMethod,Ev=K.Uint8Array,nx=Ev&&Ev.prototype||{},Sd=[].toString,lx=[].join;we(function(){Sd.call({})})&&(Sd=function(){return lx.call(this)});var ix=nx.toString!=Sd;ax("toString",Sd,ix);var ox=bn("iterator"),km=!we(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),n=e.searchParams,t="";return e.pathname="c%20d",n.forEach(function(a,l){n.delete("b"),t+=l+a}),!n.sort||e.href!=="http://a/c%20d?a=1&c=3"||n.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!n[ox]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||t!=="a1c3"||new URL("http://x",void 0).host!=="x"}),Ru=function(e){var n,t,a,l,o,d,s=Dl(e),h=typeof this=="function"?this:Array,f=arguments.length,p=f>1?arguments[1]:void 0,g=p!==void 0,v=Cc(s),y=0;if(g&&(p=ru(p,f>2?arguments[2]:void 0,2)),v==null||h==Array&&am(v))for(t=new h(n=Zt(s.length));n>y;y++)d=g?p(s[y],y):s[y],tu(t,y,d);else for(o=(l=v.call(s)).next,t=new h;!(a=o.call(l)).done;y++)d=g?ag(l,p,[a.value,y],!0):a.value,tu(t,y,d);return t.length=y,t},sx=/[^\0-\u007E]/,ux=/[.\u3002\uFF0E\uFF61]/g,$v="Overflow: input needs wider integers to process",Eu=Math.floor,xm=String.fromCharCode,Dv=function(e){return e+22+75*(e<26)},cx=function(e,n,t){var a=0;for(e=t?Eu(e/700):e>>1,e+=Eu(e/n);e>455;a+=36)e=Eu(e/35);return Eu(a+36*e/(e+38))},dx=function(e){var n,t,a=[],l=(e=function(_){for(var C=[],A=0,I=_.length;A<I;){var S=_.charCodeAt(A++);if(S>=55296&&S<=56319&&A<I){var E=_.charCodeAt(A++);(64512&E)==56320?C.push(((1023&S)<<10)+(1023&E)+65536):(C.push(S),A--)}else C.push(S)}return C}(e)).length,o=128,d=0,s=72;for(n=0;n<e.length;n++)(t=e[n])<128&&a.push(xm(t));var h=a.length,f=h;for(h&&a.push("-");f<l;){var p=2147483647;for(n=0;n<e.length;n++)(t=e[n])>=o&&t<p&&(p=t);var g=f+1;if(p-o>Eu((2147483647-d)/g))throw RangeError($v);for(d+=(p-o)*g,o=p,n=0;n<e.length;n++){if((t=e[n])<o&&++d>2147483647)throw RangeError($v);if(t==o){for(var v=d,y=36;;y+=36){var b=y<=s?1:y>=s+26?26:y-s;if(v<b)break;var k=v-b,w=36-b;a.push(xm(Dv(b+k%w))),v=Eu(k/w)}a.push(xm(Dv(v))),s=cx(d,g,f==h),d=0,++f}}++d,++o}return a.join("")},Fv=function(e){var n=Cc(e);if(typeof n!="function")throw TypeError(String(e)+" is not iterable");return Et(n.call(e))},qv=oe("fetch"),wm=oe("Headers"),hx=bn("iterator"),Mv=Vt.set,Bi=Vt.getterFor("URLSearchParams"),mx=Vt.getterFor("URLSearchParamsIterator"),fx=/\+/g,Nv=Array(4),px=function(e){return Nv[e-1]||(Nv[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},gx=function(e){try{return decodeURIComponent(e)}catch{return e}},Lv=function(e){var n=e.replace(fx," "),t=4;try{return decodeURIComponent(n)}catch{for(;t;)n=n.replace(px(t--),gx);return n}},vx=/[!'()~]|%20/g,yx={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},bx=function(e){return yx[e]},Pv=function(e){return encodeURIComponent(e).replace(vx,bx)},Ov=function(e,n){if(n)for(var t,a,l=n.split("&"),o=0;o<l.length;)(t=l[o++]).length&&(a=t.split("="),e.push({key:Lv(a.shift()),value:Lv(a.join("="))}))},kx=function(e){this.entries.length=0,Ov(this.entries,e)},$u=function(e,n){if(e<n)throw TypeError("Not enough arguments")},_m=Ip(function(e,n){Mv(this,{type:"URLSearchParamsIterator",iterator:Fv(Bi(e).entries),kind:n})},"Iterator",function(){var e=mx(this),n=e.kind,t=e.iterator.next(),a=t.value;return t.done||(t.value=n==="keys"?a.key:n==="values"?a.value:[a.key,a.value]),t}),Dc=function(){ao(this,Dc,"URLSearchParams");var e,n,t,a,l,o,d,s,h,f=arguments.length>0?arguments[0]:void 0,p=this,g=[];if(Mv(p,{type:"URLSearchParams",entries:g,updateURL:function(){},updateSearchParams:kx}),f!==void 0)if(O(f))if(typeof(e=Cc(f))=="function")for(t=(n=e.call(f)).next;!(a=t.call(n)).done;){if((d=(o=(l=Fv(Et(a.value))).next).call(l)).done||(s=o.call(l)).done||!o.call(l).done)throw TypeError("Expected sequence with length 2");g.push({key:d.value+"",value:s.value+""})}else for(h in f)$e(f,h)&&g.push({key:h,value:f[h]+""});else Ov(g,typeof f=="string"?f.charAt(0)==="?"?f.slice(1):f:f+"")},Id=Dc.prototype;Tc(Id,{append:function(e,n){$u(arguments.length,2);var t=Bi(this);t.entries.push({key:e+"",value:n+""}),t.updateURL()},delete:function(e){$u(arguments.length,1);for(var n=Bi(this),t=n.entries,a=e+"",l=0;l<t.length;)t[l].key===a?t.splice(l,1):l++;n.updateURL()},get:function(e){$u(arguments.length,1);for(var n=Bi(this).entries,t=e+"",a=0;a<n.length;a++)if(n[a].key===t)return n[a].value;return null},getAll:function(e){$u(arguments.length,1);for(var n=Bi(this).entries,t=e+"",a=[],l=0;l<n.length;l++)n[l].key===t&&a.push(n[l].value);return a},has:function(e){$u(arguments.length,1);for(var n=Bi(this).entries,t=e+"",a=0;a<n.length;)if(n[a++].key===t)return!0;return!1},set:function(e,n){$u(arguments.length,1);for(var t,a=Bi(this),l=a.entries,o=!1,d=e+"",s=n+"",h=0;h<l.length;h++)(t=l[h]).key===d&&(o?l.splice(h--,1):(o=!0,t.value=s));o||l.push({key:d,value:s}),a.updateURL()},sort:function(){var e,n,t,a=Bi(this),l=a.entries,o=l.slice();for(l.length=0,t=0;t<o.length;t++){for(e=o[t],n=0;n<t;n++)if(l[n].key>e.key){l.splice(n,0,e);break}n===t&&l.push(e)}a.updateURL()},forEach:function(e){for(var n,t=Bi(this).entries,a=ru(e,arguments.length>1?arguments[1]:void 0,3),l=0;l<t.length;)a((n=t[l++]).value,n.key,this)},keys:function(){return new _m(this,"keys")},values:function(){return new _m(this,"values")},entries:function(){return new _m(this,"entries")}},{enumerable:!0}),$r(Id,hx,Id.entries),$r(Id,"toString",function(){for(var e,n=Bi(this).entries,t=[],a=0;a<n.length;)e=n[a++],t.push(Pv(e.key)+"="+Pv(e.value));return t.join("&")},{enumerable:!0}),Ms(Dc,"URLSearchParams"),Ce({global:!0,forced:!km},{URLSearchParams:Dc}),km||typeof qv!="function"||typeof wm!="function"||Ce({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var n,t,a,l=[e];return arguments.length>1&&(O(n=arguments[1])&&(t=n.body,As(t)==="URLSearchParams"&&((a=n.headers?new wm(n.headers):new wm).has("content-type")||a.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),n=gl(n,{body:X(0,String(t)),headers:X(0,a)}))),l.push(n)),qv.apply(this,l)}});var bi,zv={URLSearchParams:Dc,getState:Bi},xx=Wd.codeAt,Fc=K.URL,wx=zv.URLSearchParams,Cm=zv.getState,_x=Vt.set,Gn=Vt.getterFor("URL"),Cx=Math.floor,Bv=Math.pow,Vv=/[A-Za-z]/,Tx=/[\d+-.A-Za-z]/,Tm=/\d/,Ax=/^(0x|0X)/,Sx=/^[0-7]+$/,Ix=/^\d+$/,Uv=/^[\dA-Fa-f]+$/,Rx=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,Ex=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,$x=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,Dx=/[\u0009\u000A\u000D]/g,Am=function(e,n){var t,a,l;if(n.charAt(0)=="["){if(n.charAt(n.length-1)!="]"||!(t=qx(n.slice(1,-1))))return"Invalid host";e.host=t}else if(kl(e)){if(n=function(o){var d,s,h=[],f=o.toLowerCase().replace(ux,".").split(".");for(d=0;d<f.length;d++)s=f[d],h.push(sx.test(s)?"xn--"+dx(s):s);return h.join(".")}(n),Rx.test(n)||(t=Fx(n))===null)return"Invalid host";e.host=t}else{if(Ex.test(n))return"Invalid host";for(t="",a=Ru(n),l=0;l<a.length;l++)t+=us(a[l],Rd);e.host=t}},Fx=function(e){var n,t,a,l,o,d,s,h=e.split(".");if(h.length&&h[h.length-1]==""&&h.pop(),(n=h.length)>4)return e;for(t=[],a=0;a<n;a++){if((l=h[a])=="")return e;if(o=10,l.length>1&&l.charAt(0)=="0"&&(o=Ax.test(l)?16:8,l=l.slice(o==8?1:2)),l==="")d=0;else{if(!(o==10?Ix:o==8?Sx:Uv).test(l))return e;d=parseInt(l,o)}t.push(d)}for(a=0;a<n;a++)if(d=t[a],a==n-1){if(d>=Bv(256,5-n))return null}else if(d>255)return null;for(s=t.pop(),a=0;a<t.length;a++)s+=t[a]*Bv(256,3-a);return s},qx=function(e){var n,t,a,l,o,d,s,h=[0,0,0,0,0,0,0,0],f=0,p=null,g=0,v=function(){return e.charAt(g)};if(v()==":"){if(e.charAt(1)!=":")return;g+=2,p=++f}for(;v();){if(f==8)return;if(v()!=":"){for(n=t=0;t<4&&Uv.test(v());)n=16*n+parseInt(v(),16),g++,t++;if(v()=="."){if(t==0||(g-=t,f>6))return;for(a=0;v();){if(l=null,a>0){if(!(v()=="."&&a<4))return;g++}if(!Tm.test(v()))return;for(;Tm.test(v());){if(o=parseInt(v(),10),l===null)l=o;else{if(l==0)return;l=10*l+o}if(l>255)return;g++}h[f]=256*h[f]+l,++a!=2&&a!=4||f++}if(a!=4)return;break}if(v()==":"){if(g++,!v())return}else if(v())return;h[f++]=n}else{if(p!==null)return;g++,p=++f}}if(p!==null)for(d=f-p,f=7;f!=0&&d>0;)s=h[f],h[f--]=h[p+d-1],h[p+--d]=s;else if(f!=8)return;return h},qc=function(e){var n,t,a,l;if(typeof e=="number"){for(n=[],t=0;t<4;t++)n.unshift(e%256),e=Cx(e/256);return n.join(".")}if(typeof e=="object"){for(n="",a=function(o){for(var d=null,s=1,h=null,f=0,p=0;p<8;p++)o[p]!==0?(f>s&&(d=h,s=f),h=null,f=0):(h===null&&(h=p),++f);return f>s&&(d=h,s=f),d}(e),t=0;t<8;t++)l&&e[t]===0||(l&&(l=!1),a===t?(n+=t?":":"::",l=!0):(n+=e[t].toString(16),t<7&&(n+=":")));return"["+n+"]"}return e},Rd={},Hv=nc({},Rd,{" ":1,'"':1,"<":1,">":1,"`":1}),jv=nc({},Hv,{"#":1,"?":1,"{":1,"}":1}),Sm=nc({},jv,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),us=function(e,n){var t=xx(e,0);return t>32&&t<127&&!$e(n,e)?e:encodeURIComponent(e)},Ed={ftp:21,file:null,http:80,https:443,ws:80,wss:443},kl=function(e){return $e(Ed,e.scheme)},Im=function(e){return e.username!=""||e.password!=""},Rm=function(e){return!e.host||e.cannotBeABaseURL||e.scheme=="file"},Mc=function(e,n){var t;return e.length==2&&Vv.test(e.charAt(0))&&((t=e.charAt(1))==":"||!n&&t=="|")},Gv=function(e){var n;return e.length>1&&Mc(e.slice(0,2))&&(e.length==2||(n=e.charAt(2))==="/"||n==="\\"||n==="?"||n==="#")},Wv=function(e){var n=e.path,t=n.length;!t||e.scheme=="file"&&t==1&&Mc(n[0],!0)||n.pop()},Mx=function(e){return e==="."||e.toLowerCase()==="%2e"},Em={},Yv={},$m={},Xv={},Zv={},Dm={},Kv={},Jv={},$d={},Dd={},Fm={},qm={},Mm={},Nm={},Qv={},Lm={},Du={},oo={},ey={},js={},Ro={},so=function(e,n,t,a){var l,o,d,s,h,f=t||Em,p=0,g="",v=!1,y=!1,b=!1;for(t||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,n=n.replace($x,"")),n=n.replace(Dx,""),l=Ru(n);p<=l.length;){switch(o=l[p],f){case Em:if(!o||!Vv.test(o)){if(t)return"Invalid scheme";f=$m;continue}g+=o.toLowerCase(),f=Yv;break;case Yv:if(o&&(Tx.test(o)||o=="+"||o=="-"||o=="."))g+=o.toLowerCase();else{if(o!=":"){if(t)return"Invalid scheme";g="",f=$m,p=0;continue}if(t&&(kl(e)!=$e(Ed,g)||g=="file"&&(Im(e)||e.port!==null)||e.scheme=="file"&&!e.host))return;if(e.scheme=g,t)return void(kl(e)&&Ed[e.scheme]==e.port&&(e.port=null));g="",e.scheme=="file"?f=Nm:kl(e)&&a&&a.scheme==e.scheme?f=Xv:kl(e)?f=Jv:l[p+1]=="/"?(f=Zv,p++):(e.cannotBeABaseURL=!0,e.path.push(""),f=ey)}break;case $m:if(!a||a.cannotBeABaseURL&&o!="#")return"Invalid scheme";if(a.cannotBeABaseURL&&o=="#"){e.scheme=a.scheme,e.path=a.path.slice(),e.query=a.query,e.fragment="",e.cannotBeABaseURL=!0,f=Ro;break}f=a.scheme=="file"?Nm:Dm;continue;case Xv:if(o!="/"||l[p+1]!="/"){f=Dm;continue}f=$d,p++;break;case Zv:if(o=="/"){f=Dd;break}f=oo;continue;case Dm:if(e.scheme=a.scheme,o==bi)e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query=a.query;else if(o=="/"||o=="\\"&&kl(e))f=Kv;else if(o=="?")e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query="",f=js;else{if(o!="#"){e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.path.pop(),f=oo;continue}e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query=a.query,e.fragment="",f=Ro}break;case Kv:if(!kl(e)||o!="/"&&o!="\\"){if(o!="/"){e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,f=oo;continue}f=Dd}else f=$d;break;case Jv:if(f=$d,o!="/"||g.charAt(p+1)!="/")continue;p++;break;case $d:if(o!="/"&&o!="\\"){f=Dd;continue}break;case Dd:if(o=="@"){v&&(g="%40"+g),v=!0,d=Ru(g);for(var k=0;k<d.length;k++){var w=d[k];if(w!=":"||b){var _=us(w,Sm);b?e.password+=_:e.username+=_}else b=!0}g=""}else if(o==bi||o=="/"||o=="?"||o=="#"||o=="\\"&&kl(e)){if(v&&g=="")return"Invalid authority";p-=Ru(g).length+1,g="",f=Fm}else g+=o;break;case Fm:case qm:if(t&&e.scheme=="file"){f=Lm;continue}if(o!=":"||y){if(o==bi||o=="/"||o=="?"||o=="#"||o=="\\"&&kl(e)){if(kl(e)&&g=="")return"Invalid host";if(t&&g==""&&(Im(e)||e.port!==null))return;if(s=Am(e,g))return s;if(g="",f=Du,t)return;continue}o=="["?y=!0:o=="]"&&(y=!1),g+=o}else{if(g=="")return"Invalid host";if(s=Am(e,g))return s;if(g="",f=Mm,t==qm)return}break;case Mm:if(!Tm.test(o)){if(o==bi||o=="/"||o=="?"||o=="#"||o=="\\"&&kl(e)||t){if(g!=""){var C=parseInt(g,10);if(C>65535)return"Invalid port";e.port=kl(e)&&C===Ed[e.scheme]?null:C,g=""}if(t)return;f=Du;continue}return"Invalid port"}g+=o;break;case Nm:if(e.scheme="file",o=="/"||o=="\\")f=Qv;else{if(!a||a.scheme!="file"){f=oo;continue}if(o==bi)e.host=a.host,e.path=a.path.slice(),e.query=a.query;else if(o=="?")e.host=a.host,e.path=a.path.slice(),e.query="",f=js;else{if(o!="#"){Gv(l.slice(p).join(""))||(e.host=a.host,e.path=a.path.slice(),Wv(e)),f=oo;continue}e.host=a.host,e.path=a.path.slice(),e.query=a.query,e.fragment="",f=Ro}}break;case Qv:if(o=="/"||o=="\\"){f=Lm;break}a&&a.scheme=="file"&&!Gv(l.slice(p).join(""))&&(Mc(a.path[0],!0)?e.path.push(a.path[0]):e.host=a.host),f=oo;continue;case Lm:if(o==bi||o=="/"||o=="\\"||o=="?"||o=="#"){if(!t&&Mc(g))f=oo;else if(g==""){if(e.host="",t)return;f=Du}else{if(s=Am(e,g))return s;if(e.host=="localhost"&&(e.host=""),t)return;g="",f=Du}continue}g+=o;break;case Du:if(kl(e)){if(f=oo,o!="/"&&o!="\\")continue}else if(t||o!="?")if(t||o!="#"){if(o!=bi&&(f=oo,o!="/"))continue}else e.fragment="",f=Ro;else e.query="",f=js;break;case oo:if(o==bi||o=="/"||o=="\\"&&kl(e)||!t&&(o=="?"||o=="#")){if((h=(h=g).toLowerCase())===".."||h==="%2e."||h===".%2e"||h==="%2e%2e"?(Wv(e),o=="/"||o=="\\"&&kl(e)||e.path.push("")):Mx(g)?o=="/"||o=="\\"&&kl(e)||e.path.push(""):(e.scheme=="file"&&!e.path.length&&Mc(g)&&(e.host&&(e.host=""),g=g.charAt(0)+":"),e.path.push(g)),g="",e.scheme=="file"&&(o==bi||o=="?"||o=="#"))for(;e.path.length>1&&e.path[0]==="";)e.path.shift();o=="?"?(e.query="",f=js):o=="#"&&(e.fragment="",f=Ro)}else g+=us(o,jv);break;case ey:o=="?"?(e.query="",f=js):o=="#"?(e.fragment="",f=Ro):o!=bi&&(e.path[0]+=us(o,Rd));break;case js:t||o!="#"?o!=bi&&(o=="'"&&kl(e)?e.query+="%27":e.query+=o=="#"?"%23":us(o,Rd)):(e.fragment="",f=Ro);break;case Ro:o!=bi&&(e.fragment+=us(o,Hv))}p++}},Gs=function(e){var n,t,a=ao(this,Gs,"URL"),l=arguments.length>1?arguments[1]:void 0,o=String(e),d=_x(a,{type:"URL"});if(l!==void 0){if(l instanceof Gs)n=Gn(l);else if(t=so(n={},String(l)))throw TypeError(t)}if(t=so(d,o,null,n))throw TypeError(t);var s=d.searchParams=new wx,h=Cm(s);h.updateSearchParams(d.query),h.updateURL=function(){d.query=String(s)||null},H||(a.href=Fd.call(a),a.origin=ty.call(a),a.protocol=ry.call(a),a.username=ay.call(a),a.password=ny.call(a),a.host=ly.call(a),a.hostname=iy.call(a),a.port=oy.call(a),a.pathname=sy.call(a),a.search=uy.call(a),a.searchParams=cy.call(a),a.hash=dy.call(a))},Pm=Gs.prototype,Fd=function(){var e=Gn(this),n=e.scheme,t=e.username,a=e.password,l=e.host,o=e.port,d=e.path,s=e.query,h=e.fragment,f=n+":";return l!==null?(f+="//",Im(e)&&(f+=t+(a?":"+a:"")+"@"),f+=qc(l),o!==null&&(f+=":"+o)):n=="file"&&(f+="//"),f+=e.cannotBeABaseURL?d[0]:d.length?"/"+d.join("/"):"",s!==null&&(f+="?"+s),h!==null&&(f+="#"+h),f},ty=function(){var e=Gn(this),n=e.scheme,t=e.port;if(n=="blob")try{return new URL(n.path[0]).origin}catch{return"null"}return n!="file"&&kl(e)?n+"://"+qc(e.host)+(t!==null?":"+t:""):"null"},ry=function(){return Gn(this).scheme+":"},ay=function(){return Gn(this).username},ny=function(){return Gn(this).password},ly=function(){var e=Gn(this),n=e.host,t=e.port;return n===null?"":t===null?qc(n):qc(n)+":"+t},iy=function(){var e=Gn(this).host;return e===null?"":qc(e)},oy=function(){var e=Gn(this).port;return e===null?"":String(e)},sy=function(){var e=Gn(this),n=e.path;return e.cannotBeABaseURL?n[0]:n.length?"/"+n.join("/"):""},uy=function(){var e=Gn(this).query;return e?"?"+e:""},cy=function(){return Gn(this).searchParams},dy=function(){var e=Gn(this).fragment;return e?"#"+e:""},ki=function(e,n){return{get:e,set:n,configurable:!0,enumerable:!0}};if(H&&yn(Pm,{href:ki(Fd,function(e){var n=Gn(this),t=String(e),a=so(n,t);if(a)throw TypeError(a);Cm(n.searchParams).updateSearchParams(n.query)}),origin:ki(ty),protocol:ki(ry,function(e){var n=Gn(this);so(n,String(e)+":",Em)}),username:ki(ay,function(e){var n=Gn(this),t=Ru(String(e));if(!Rm(n)){n.username="";for(var a=0;a<t.length;a++)n.username+=us(t[a],Sm)}}),password:ki(ny,function(e){var n=Gn(this),t=Ru(String(e));if(!Rm(n)){n.password="";for(var a=0;a<t.length;a++)n.password+=us(t[a],Sm)}}),host:ki(ly,function(e){var n=Gn(this);n.cannotBeABaseURL||so(n,String(e),Fm)}),hostname:ki(iy,function(e){var n=Gn(this);n.cannotBeABaseURL||so(n,String(e),qm)}),port:ki(oy,function(e){var n=Gn(this);Rm(n)||((e=String(e))==""?n.port=null:so(n,e,Mm))}),pathname:ki(sy,function(e){var n=Gn(this);n.cannotBeABaseURL||(n.path=[],so(n,e+"",Du))}),search:ki(uy,function(e){var n=Gn(this);(e=String(e))==""?n.query=null:(e.charAt(0)=="?"&&(e=e.slice(1)),n.query="",so(n,e,js)),Cm(n.searchParams).updateSearchParams(n.query)}),searchParams:ki(cy),hash:ki(dy,function(e){var n=Gn(this);(e=String(e))!=""?(e.charAt(0)=="#"&&(e=e.slice(1)),n.fragment="",so(n,e,Ro)):n.fragment=null})}),$r(Pm,"toJSON",function(){return Fd.call(this)},{enumerable:!0}),$r(Pm,"toString",function(){return Fd.call(this)},{enumerable:!0}),Fc){var hy=Fc.createObjectURL,my=Fc.revokeObjectURL;hy&&$r(Gs,"createObjectURL",function(e){return hy.apply(Fc,arguments)}),my&&$r(Gs,"revokeObjectURL",function(e){return my.apply(Fc,arguments)})}Ms(Gs,"URL"),Ce({global:!0,forced:!km,sham:!H},{URL:Gs});var fy={createDialog:function(){var e=st(),n=e.splitText,t=e.punctuation,a=e.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-splitColumn-dialog").remove();var l='<div class="box"><div class="boxTitle">'+n.splitDelimiters+'</div><div class="boxMain"><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_01" type="checkbox"/><label for="splitColumn_type_01">'+t.tab+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_02" type="checkbox"/><label for="splitColumn_type_02">'+t.semicolon+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_03" type="checkbox"/><label for="splitColumn_type_03">'+t.comma+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_04" type="checkbox"/><label for="splitColumn_type_04">'+t.space+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_05" type="checkbox"/><label for="splitColumn_type_05">'+n.splitOther+'</label><input type="text" class="formulaInputFocus" maxlength="1"/></div></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_06" type="checkbox"/><label for="splitColumn_type_06">'+n.splitContinueSymbol+'</label></div><div class="boxTitle" style="margin-top: 10px;">'+n.splitDataPreview+'</div><div class="boxMain" id="splitColumnData"></div></div>';$("body").append(br(Ga,{id:"luckysheet-splitColumn-dialog",addclass:"luckysheet-splitColumn-dialog",title:n.splitTextTitle,content:l,botton:'<button id="luckysheet-splitColumn-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));var o=$("#luckysheet-splitColumn-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),d=o.outerHeight(),s=o.outerWidth(),h=$(window).width(),f=$(window).height(),p=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-splitColumn-dialog").css({left:(h+p-s)/2,top:(f+g-d)/3}).show();var v=this.getDataArr();this.dataPreview(v)},init:function(){var e=this,n=st().splitText;$(document).off("change.SPCinpcheckbox").on("change.SPCcheckbox","#luckysheet-splitColumn-dialog .box input[type='checkbox']",function(){var t=e.getRegStr(),a=e.getDataArr(t);e.dataPreview(a)}),$(document).off("keyup.SPCinptext").on("keyup.SPCinptext","#luckysheet-splitColumn-dialog .box input[type='text']",function(){if($(this).siblings("input[type='checkbox']").is(":checked")){var t=e.getRegStr(),a=e.getDataArr(t);e.dataPreview(a)}}),$(document).off("click.SPCconfirm").on("click.SPCconfirm","#luckysheet-splitColumn-dialog #luckysheet-splitColumn-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-splitColumn-dialog").hide();var t=e.getRegStr(),a=e.getDataArr(t),l=u.luckysheet_select_save[0].row[0],o=u.luckysheet_select_save[0].column[0];if(a[0].length!=1){for(var d=!1,s=0;s<a.length;s++)for(var h=1;h<a[0].length;h++){var f=u.flowdata[l+s][o+h];if(f!=null&&f.v!=null){d=!0;break}}d?Ee.confirm("",n.splitConfirmToExe,function(){e.update(l,o,a)}):e.update(l,o,a)}})},update:function(e,n,t){for(var a=vr.deepCopyFlowData(u.flowdata),l=0;l<t.length;l++)for(var o=0;o<t[0].length;o++)Ln(e+l,n+o,a,t[l][o]);var d=u.luckysheet_select_save[0].row[0],s=u.luckysheet_select_save[0].column[0];wa(a,[{row:[d,d+t.length-1],column:[s,s+t[0].length-1]}]),Ra()},dataPreview:function(e){$("#luckysheet-splitColumn-dialog #splitColumnData").empty();for(var n="",t=0;t<e.length;t++){for(var a="",l=0;l<e[0].length;l++)a+="<td>"+e[t][l]+"</td>";n+="<tr>"+a+"</tr>"}var o="<table>"+n+"</table>";$("#luckysheet-splitColumn-dialog #splitColumnData").append(o)},getRegStr:function(){var e="",n=0;return $("#luckysheet-splitColumn-dialog .box input[type='checkbox']:checked").each(function(t,a){var l=$(a).attr("id");if(l=="splitColumn_type_01")e+="\\t",n++;else if(l=="splitColumn_type_02")n>0&&(e+="|"),e+=";",n++;else if(l=="splitColumn_type_03")n>0&&(e+="|"),e+=",",n++;else if(l=="splitColumn_type_04")n>0&&(e+="|"),e+="\\s",n++;else if(l=="splitColumn_type_05"){var o=$(a).siblings("input[type='text']").val().trim();o!=""&&(n>0&&(e+="|"),e+=o)}else l=="splitColumn_type_06"&&(e="["+e+"]+")}),e},getDataArr:function(e){var n=[],t=u.luckysheet_select_save[0].row[0],a=u.luckysheet_select_save[0].row[1],l=u.luckysheet_select_save[0].column[0];if(e!=null&&e!=""){for(var o=new RegExp(e,"g"),d=[],s=t;s<=a;s++){var h,f=u.flowdata[s][l],p=void 0;(p=f!=null&&f.m!=null?f.m:Hr(s,l,u.flowdata))==null&&(p=""),h=p.toString().split(o),d.push(h)}for(var g=d.length,v=0,y=0;y<g;y++)d[y].length>v&&(v=d[y].length);n=this.getNullData(g,v);for(var b=0;b<n.length;b++)for(var k=0;k<n[0].length;k++)d[b][k]!=null&&(n[b][k]=d[b][k])}else for(var w=t;w<=a;w++){var _=[],C=u.flowdata[w][l],A=void 0;(A=C!=null&&C.m!=null?C.m:Hr(w,l,u.flowdata))==null&&(A=""),_.push(A),n.push(_)}return n},getNullData:function(e,n){for(var t=[],a=0;a<e;a++){for(var l=[],o=0;o<n;o++)l.push("");t.push(l)}return t}},py=!1;function gy(e,n){if(u.luckysheet_select_save!=null&&u.luckysheet_select_save.length>0){var t=ir.getSheetByIndex().data;if(t!=null)for(var a=0;a<u.luckysheet_select_save.length;a++)for(var l=u.luckysheet_select_save[a],o=l.row,d=l.column,s=o[0];s<=o[1];s++)for(var h=d[0];h<=d[1];h++){var f=void 0,p=dr.mergeborer(t,s,h);if(p){var g=p.row[2],v=p.column[2];f=t[g][v]}else f=t[s][h];e(f,s,h,t)}else n();return t}}function Nx(){if(!py){py=!0;var e=st(),n=e.cellFormat,t=e.button;$("body").append(br(Ga,{id:"luckysheet-cellFormat-config",addclass:"luckysheet-cellFormat-config",title:n.cellFormatTitle,content:`
            <div class="luckysheet-cellFormat-menu-c">
                <div class="luckysheet-cellFormat-menu luckysheet-cellFormat-menu-active" id="luckysheet-cellFormat-protection">
                    `.concat(n.protection,`
                </div>
            </div>
            <div id="luckysheet-cellFormat-protection-content" class="luckysheet-cellFormat-content">
                <div class="luckysheet-cellFormat-protection">
                    <p>
                        `).concat(n.protectionTips,`
                    </p>
                    <label for="luckysheet-protection-check-locked"><input id="luckysheet-protection-check-locked" name="luckysheet-protection-check-locked" type="checkbox">`).concat(n.locked,`</label><span></span>
                    <br/>
                    <label for="luckysheet-protection-check-hidden"><input id="luckysheet-protection-check-hidden" name="luckysheet-protection-check-hidden" type="checkbox">`).concat(n.hidden,`</label><span></span>
                </div>
            </div>
        `),botton:'<button id="luckysheet-cellFormat-confirm" class="btn btn-primary">'.concat(t.confirm,`</button>
                    <button class="btn btn-default luckysheet-model-close-btn">`).concat(t.cancel,"</button>"),style:"z-index:100003"})),function(){var a=st().cellFormat;$("#luckysheet-cellFormat-confirm").click(function(){var l=$("#luckysheet-protection-check-locked").is(":checked"),o=$("#luckysheet-protection-check-hidden").is(":checked");l=l==1?1:0,o=o==1?1:0,wa(gy(function(d,s,h,f){d==null?Ln(s,h,f,{lo:l,hi:o}):(d.lo=l,d.hi=o)},function(){alert(a.sheetDataIsNullAlert)}),void 0,void 0,!1),$("#luckysheet-cellFormat-config").hide(),$("#luckysheet-modal-dialog-mask").hide()})}()}}function vy(e){var n=$("#luckysheet-cell-main"),t=$("#luckysheet-scrollbar-x").scrollLeft(),a=$("#luckysheet-scrollbar-y").scrollTop(),l=$("#luckysheetTableContent").height();return Ne.freezenhorizontaldata!=null&&a<Ne.freezenhorizontaldata[2]?(a=Ne.freezenhorizontaldata[2],void $("#luckysheet-scrollbar-y").scrollTop(a)):Ne.freezenverticaldata!=null&&t<Ne.freezenverticaldata[2]?(t=Ne.freezenverticaldata[2],void $("#luckysheet-scrollbar-x").scrollLeft(t)):($("#luckysheet-cols-h-c").scrollLeft(t),$("#luckysheet-rows-h").scrollTop(a),n.scrollLeft(t).scrollTop(a),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")}).show(),Kr(t,a),$("#luckysheet-bottom-controll-row").css("left",t),Ne.freezenhorizontaldata==null&&Ne.freezenverticaldata==null||Ne.scrollAdapt(),void Ya.createHookFunction("scroll",{scrollLeft:t,scrollTop:a,canvasHeight:l}))}function Lx(){Ko.detectOS(),Ko.mobilecheck()&&function(){u.cellMainSrollBarSize=0;var l=!1,o={},d=!1,s=null;$(document).on("touchstart","#luckysheet-grid-window-1",function(h){clearInterval(s),l=!0;var f=h.originalEvent.targetTouches[0];o={x:f.pageX,y:f.pageY,vy:0,moveType:"y"}}),$(document).on("touchmove","#luckysheet-grid-window-1",function(h){if(!(h.originalEvent.targetTouches.length>1||h.scale&&h.scale!==1)){var f=h.originalEvent.targetTouches[0];if(l){var p=f.pageX-o.x,g=f.pageY-o.y;o.x=f.pageX,o.y=f.pageY;var v=$("#luckysheet-scrollbar-x").scrollLeft(),y=$("#luckysheet-scrollbar-y").scrollTop();(v-=p)<0&&(v=0),(y-=g)<0&&(y=0),$("#luckysheet-scrollbar-y").scrollTop(y),o.vy_y=g,o.scrollTop=y,$("#luckysheet-scrollbar-x").scrollLeft(v),o.vy_x=p,o.scrollLeft=v}else if(d){var b=pa(f.pageX,f.pageY),k=b[0]+$("#luckysheet-cell-main").scrollLeft(),w=Wa(b[1]+$("#luckysheet-cell-main").scrollTop()),_=w[1],C=w[0],A=w[2],I=ja(k),S=I[1],E=I[0],R=I[2],F=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),N=0,z=0,P=[];F.top>C?(N=C,z=F.top+F.height-C,F.row[1]>F.row_focus&&(F.row[1]=F.row_focus),P=[A,F.row[1]]):F.top==C?(N=C,z=F.top+F.height-C,P=[A,F.row[0]]):(N=F.top,z=_-F.top-1,F.row[0]<F.row_focus&&(F.row[0]=F.row_focus),P=[F.row[0],A]);var q=0,V=0,x=[];F.left>E?(q=E,V=F.left+F.width-E,F.column[1]>F.column_focus&&(F.column[1]=F.column_focus),x=[R,F.column[1]]):F.left==E?(q=E,V=F.left+F.width-E,x=[R,F.column[0]]):(q=F.left,V=S-F.left-1,F.column[0]<F.column_focus&&(F.column[0]=F.column_focus),x=[F.column[0],R]);var ee=dr.mergeMoveMain(x,P,F,N,z,q,V);ee!=null&&(x=ee[0],P=ee[1],N=ee[2],z=ee[3],q=ee[4],V=ee[5]),F.row=P,F.column=x,F.left_move=q,F.width_move=V,F.top_move=N,F.height_move=z,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=F,Ra(),Ne.scrollFreezen()}h.stopPropagation()}}),$(document).on("touchend",function(h){if(l){var f=Math.abs(o.vy_x),p=.25*(2*(f>>31)+1),g=Math.abs(o.vy_y),v=.25*(2*(g>>31)+1);(f>0||g>0)&&(s=setInterval(function(){(f-=p)<=0&&(f=0),(g-=v)<=0&&(g=0),o.vy_y>0?o.scrollTop-=g:o.scrollTop+=g,$("#luckysheet-scrollbar-y").scrollTop(o.scrollTop),o.vy_x>0?o.scrollLeft-=f:o.scrollLeft+=f,$("#luckysheet-scrollbar-x").scrollLeft(o.scrollLeft),f<=0&&g<=0&&clearInterval(s)},20))}l=!1,d=!1}),$(document).on("touchstart",".luckysheet-cs-touchhandle",function(h){d=!0,l=!1,h.stopPropagation()}),document.addEventListener("touchmove",function(h){h.preventDefault()},{passive:!1})}(),Date.now||(Date.now=function(){return new Date().getTime()}),function(){for(var l=["webkit","moz"],o=0;o<l.length&&!window.requestAnimationFrame;++o){var d=l[o];window.requestAnimationFrame=window[d+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d+"CancelAnimationFrame"]||window[d+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var s=0;window.requestAnimationFrame=function(h){var f=Date.now(),p=Math.max(s+16,f);return setTimeout(function(){h(s=p)},p-f)},window.cancelAnimationFrame=clearTimeout}}(),$("#luckysheet-sheet-container-c").mousewheel(function(l,o){var d=l.deltaFactor<40?1:l.deltaFactor<80?2:3,s=$(this).scrollLeft();l.deltaY!=0?l.deltaY<0?s+=10*d:s-=10*d:l.deltaX!=0&&(l.deltaX>0?s+=10*d:s-=10*d),$(this).scrollLeft(s),l.preventDefault()}),$("#luckysheet-cell-main").scroll(function(){}).mousewheel(function(l,o){l.preventDefault()});var e,n=st(),t=n.drag,a=n.info;$("#luckysheet-grid-window-1").mousewheel(function(l,o){var d=$("#luckysheet-scrollbar-x").scrollLeft(),s=$("#luckysheet-scrollbar-y").scrollTop(),h=u.visibledatacolumn,f=u.visibledatarow;Ne.freezenhorizontaldata!=null&&(f=Ne.freezenhorizontaldata[3]),Ne.freezenverticaldata!=null&&(h=Ne.freezenverticaldata[3]),clearTimeout(e),u.visibledatacolumn_unique!=null?h=u.visibledatacolumn_unique:(h=Xg(h),u.visibledatacolumn_unique=h),u.visibledatarow_unique!=null?f=u.visibledatarow_unique:(f=Xg(f),u.visibledatarow_unique=f),fa(h,d);var p=fa(f,s);Ne.freezenhorizontaldata!=null&&(p=fa(f,s+Ne.freezenhorizontaldata[0]));var g=0,v=l.deltaFactor<40?1:l.deltaFactor<80?2:3;if(l.deltaY!=0){var y,b=Math.round(v/u.zoomRatio);b=b<1?1:b,l.deltaY<0?(y=p+b)>=f.length&&(y=f.length-1):(y=p-b)<0&&(y=0),g=y==0?0:f[y-1],Ne.freezenhorizontaldata!=null&&(g-=Ne.freezenhorizontaldata[0]),$("#luckysheet-scrollbar-y").scrollTop(g)}else l.deltaX!=0&&(l.deltaX>0?d+=20*u.zoomRatio:d-=20*u.zoomRatio,$("#luckysheet-scrollbar-x").scrollLeft(d));e=setTimeout(function(){u.visibledatacolumn_unique=null,u.visibledatarow_unique=null},500)}),$("#luckysheet-scrollbar-x").scroll(function(){vy()}).mousewheel(function(l,o){l.preventDefault()}),$("#luckysheet-scrollbar-y").scroll(function(){vy()}).mousewheel(function(l,o){l.preventDefault()}),$(window).resize(function(){document.getElementById(u.container)&&Rn()}),$("#luckysheet-rich-text-editor").mouseup(function(l){dr.inputMenuButtonFocus(l.target)}),$("#luckysheet-cell-main, #luckysheetTableContent").mousedown(function(l){if(!$(l.target).hasClass("luckysheet-mousedown-cancel")){(function(){var nr=na(".luckysheet-multipleRange-show");nr.length===void 0&&(nr=[nr]),nr.forEach(function(Ut){var ar=Ut.id.replace("luckysheet-multipleRange-show-","");u.cooperativeEdit.usernameTimeout["user"+ar]===null&&(na(".username",Ut).style.display="none")})})(),$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","default").end().find(".luckysheet-cs-draghandle").css("cursor","default"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),Lr.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&_r.cancelActiveImgItem();var o=pa(l.pageX,l.pageY);if(!(o[0]>=u.cellmainWidth-u.cellMainSrollBarSize||o[1]>=u.cellmainHeight-u.cellMainSrollBarSize)){var d=o[0]+$("#luckysheet-cell-main").scrollLeft(),s=o[1]+$("#luckysheet-cell-main").scrollTop();Ne.freezenverticaldata!=null&&o[0]<Ne.freezenverticaldata[0]-Ne.freezenverticaldata[2]&&(d=o[0]+Ne.freezenverticaldata[2]),Ne.freezenhorizontaldata!=null&&o[1]<Ne.freezenhorizontaldata[0]-Ne.freezenhorizontaldata[2]&&(s=o[1]+Ne.freezenhorizontaldata[2]);var h=ir.getSheetByIndex(),f=$("#luckysheetTableContent").get(0).getContext("2d"),p=Wa(s),g=p[1],v=p[0],y=p[2],b=ja(d),k=b[1],w=b[0],_=b[2],C=y,A=_,I=dr.mergeborer(u.flowdata,y,_);if(I&&(g=I.row[1],v=I.row[0],y=I.row[2],C=I.row[3],k=I.column[1],w=I.column[0],_=I.column[2],A=I.column[3]),Ya.createHookFunction("cellMousedownBefore",u.flowdata[y][_],{r:y,c:_,start_r:v,start_c:w,end_r:g,end_c:k},h,f)){if(aa.cellFocus(y,_,!0),w<$("#luckysheet-cell-main").scrollLeft()&&$("#luckysheet-scrollbar-x").scrollLeft(w),v<$("#luckysheet-cell-main").scrollTop()&&$("#luckysheet-scrollbar-y").scrollTop(v),l.which=="3"){$("#luckysheet-dataVerification-showHintBox").hide();for(var S=!1,E=0;E<u.luckysheet_select_save.length;E++)if(u.luckysheet_select_save[E].row!=null&&y>=u.luckysheet_select_save[E].row[0]&&y<=u.luckysheet_select_save[E].row[1]&&_>=u.luckysheet_select_save[E].column[0]&&_<=u.luckysheet_select_save[E].column[1]){S=!0;break}if(S)return}if(u.flowdata[y]==null||u.flowdata[y][_]==null||u.flowdata[y][_].dd==null||Nt.fireMousedown==null||D(Nt.fireMousedown)!="function")if(Jl.hyperlink&&Jl.hyperlink[y+"_"+_]&&l.which!="3")Jl.cellFocus(y,_);else{u.luckysheet_scroll_status=!0;var R=$("#luckysheet-input-box");if(parseInt(R.css("top"))>0){if(m.rangestart||m.rangedrag_column_start||m.rangedrag_row_start||m.israngeseleciton()){var F=[y,C],N=[_,A],z=w,P=k-w-1,q=v,V=g-v-1;if(l.shiftKey){var x=m.func_selectedrange,ee=0,ne=0,ae=[];x.top>v?(ee=v,ne=x.top+x.height-v,x.row[1]>x.row_focus&&(x.row[1]=x.row_focus),ae=[y,x.row[1]]):x.top==v?(ee=v,ne=x.top+x.height-v,ae=[y,x.row[0]]):(ee=x.top,ne=g-x.top-1,x.row[0]<x.row_focus&&(x.row[0]=x.row_focus),ae=[x.row[0],y]);var de=0,ve=0,U=[];x.left>w?(de=w,ve=x.left+x.width-w,x.column[1]>x.column_focus&&(x.column[1]=x.column_focus),U=[_,x.column[1]]):x.left==w?(de=w,ve=x.left+x.width-w,U=[_,x.column[0]]):(de=x.left,ve=k-x.left-1,x.column[0]<x.column_focus&&(x.column[0]=x.column_focus),U=[x.column[0],_]);var B=dr.mergeMoveMain(U,ae,x,ee,ne,de,ve);B!=null&&(U=B[0],ae=B[1],ee=B[2],ne=B[3],de=B[4],ve=B[5]),lo(de,ee,ve,ne,ae,U),x.row=ae,x.column=U,x.left_move=de,x.width_move=ve,x.top_move=ee,x.height_move=ne,m.func_selectedrange=x}else if(l.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){var le=$("#luckysheet-rich-text-editor").text();if(le.length>0){var Te=le.substr(le.length-1,1);Te!=","&&Te!="="&&Te!="("&&(le+=",")}if(le.length>0&&le.substr(0,1)=="="){if(le=m.functionHTMLGenerate(le),window.getSelection){var ue=window.getSelection();m.functionRangeIndex=[$(ue.anchorNode).parent().index(),ue.anchorOffset]}else{var be=document.selection.createRange();m.functionRangeIndex=be}$("#luckysheet-rich-text-editor").html(le),m.canceFunctionrangeSelected(),m.createRangeHightlight()}m.rangestart=!1,m.rangedrag_column_start=!1,m.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(le),m.rangeHightlightselected($("#luckysheet-rich-text-editor")),m.israngeseleciton(),m.func_selectedrange={left:z,width:P,top:q,height:V,left_move:z,width_move:P,top_move:q,height_move:V,row:F,column:N,row_focus:y,column_focus:_}}else m.func_selectedrange={left:z,width:P,top:q,height:V,left_move:z,width_move:P,top_move:q,height_move:V,row:F,column:N,row_focus:y,column_focus:_};return m.rangeSetValue({row:F,column:N}),m.rangestart=!0,m.rangedrag_column_start=!1,m.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:z,width:P,top:q,height:V}).show(),$("#luckysheet-formula-help-c").hide(),lo(z,q,P,V,F,N),void setTimeout(function(){var nr,Ut=window.getSelection().anchorNode;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(nr=$("#luckysheet-rich-text-editor"),m.rangechangeindex=m.data_parm_index):nr=$(Ut).closest("div");var ar=nr.find("span[rangeindex='"+m.rangechangeindex+"']");m.setCaretPosition(ar.get(0),0,ar.html().length)},1)}m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),u.luckysheet_select_status=!0,$("#luckysheet-info").is(":visible")&&(u.luckysheet_select_status=!1)}else jp(y,_,u.currentSheetIndex)&&(u.luckysheet_select_status=!0);if($("#luckysheet-multiRange-dialog").is(":visible")){if(kr.selectStatus=!0,u.luckysheet_select_status=!1,l.shiftKey){var ye=kr.selectRange[kr.selectRange.length-1],ce=0,Re=0,pe=[];ye.top>v?(ce=v,Re=ye.top+ye.height-v,ye.row[1]>ye.row_focus&&(ye.row[1]=ye.row_focus),pe=[y,ye.row[1]]):ye.top==v?(ce=v,Re=ye.top+ye.height-v,pe=[y,ye.row[0]]):(ce=ye.top,Re=g-ye.top-1,ye.row[0]<ye.row_focus&&(ye.row[0]=ye.row_focus),pe=[ye.row[0],y]);var me=0,re=0,_e=[];ye.left>w?(me=w,re=ye.left+ye.width-w,ye.column[1]>ye.column_focus&&(ye.column[1]=ye.column_focus),_e=[_,ye.column[1]]):ye.left==w?(me=w,re=ye.left+ye.width-w,_e=[_,ye.column[0]]):(me=ye.left,re=k-ye.left-1,ye.column[0]<ye.column_focus&&(ye.column[0]=ye.column_focus),_e=[ye.column[0],_]);var Ze=dr.mergeMoveMain(_e,pe,ye,ce,Re,me,re);Ze!=null&&(_e=Ze[0],pe=Ze[1],ce=Ze[2],Re=Ze[3],me=Ze[4],re=Ze[5]),ye.row=pe,ye.column=_e,ye.left_move=me,ye.width_move=re,ye.top_move=ce,ye.height_move=Re,kr.selectRange[kr.selectRange.length-1]=ye}else l.ctrlKey||(kr.selectRange=[]),kr.selectRange.push({left:w,width:k-w-1,top:v,height:g-v-1,left_move:w,width_move:k-w-1,top_move:v,height_move:g-v-1,row:[y,C],column:[_,A],row_focus:y,column_focus:_});pn(kr.selectRange);var We=kr.getTxtByRange(kr.selectRange);$("#luckysheet-multiRange-dialog input").val(We)}else if(kr.selectStatus=!1,kr.selectRange=[],$("#luckysheet-singleRange-dialog").is(":visible")){u.luckysheet_select_status=!1,pn([{row:[y,y],column:[_,_]}]);var Xe=wn(u.currentSheetIndex,{row:[y,y],column:[_,_]},u.currentSheetIndex);$("#luckysheet-singleRange-dialog input").val(Xe)}else{if($("#luckysheet-dataVerificationRange-dialog").is(":visible")){if(aa.selectStatus=!0,u.luckysheet_select_status=!1,l.shiftKey){var Ue=aa.selectRange[aa.selectRange.length-1],mt=0,St=0,at=[];Ue.top>v?(mt=v,St=Ue.top+Ue.height-v,Ue.row[1]>Ue.row_focus&&(Ue.row[1]=Ue.row_focus),at=[y,Ue.row[1]]):Ue.top==v?(mt=v,St=Ue.top+Ue.height-v,at=[y,Ue.row[0]]):(mt=Ue.top,St=g-Ue.top-1,Ue.row[0]<Ue.row_focus&&(Ue.row[0]=Ue.row_focus),at=[Ue.row[0],y]);var dt=0,wt=0,ct=[];Ue.left>w?(dt=w,wt=Ue.left+Ue.width-w,Ue.column[1]>Ue.column_focus&&(Ue.column[1]=Ue.column_focus),ct=[_,Ue.column[1]]):Ue.left==w?(dt=w,wt=Ue.left+Ue.width-w,ct=[_,Ue.column[0]]):(dt=Ue.left,wt=k-Ue.left-1,Ue.column[0]<Ue.column_focus&&(Ue.column[0]=Ue.column_focus),ct=[Ue.column[0],_]);var bt=dr.mergeMoveMain(ct,at,Ue,mt,St,dt,wt);bt!=null&&(ct=bt[0],at=bt[1],mt=bt[2],St=bt[3],dt=bt[4],wt=bt[5]),Ue.row=at,Ue.column=ct,Ue.left_move=dt,Ue.width_move=wt,Ue.top_move=mt,Ue.height_move=St,aa.selectRange[aa.selectRange.length-1]=Ue}else aa.selectRange=[],aa.selectRange.push({left:w,width:k-w-1,top:v,height:g-v-1,left_move:w,width_move:k-w-1,top_move:v,height_move:g-v-1,row:[y,C],column:[_,A],row_focus:y,column_focus:_});pn(aa.selectRange);var De=aa.getTxtByRange(aa.selectRange);return m.rangetosheet!=u.currentSheetIndex&&(De=u.luckysheetfile[je(u.currentSheetIndex)].name+"!"+De),void $("#luckysheet-dataVerificationRange-dialog input").val(De)}if(aa.selectStatus=!1,aa.selectRange=[],yd.singleRangeFocus&&$("#luckysheet-ifFormulaGenerator-dialog .singRange").click(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").is(":visible")){u.luckysheet_select_status=!1,m.rangestart=!1,$("#luckysheet-formula-functionrange-select").css({left:w,width:k-w-1,top:v,height:g-v-1}).show(),$("#luckysheet-formula-help-c").hide();var He=wn(u.currentSheetIndex,{row:[y,y],column:[_,_]},u.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-singleRange-dialog input").val(He)}else{if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){u.luckysheet_select_status=!1,m.func_selectedrange={left:w,width:k-w-1,top:v,height:g-v-1,left_move:w,width_move:k-w-1,top_move:v,height_move:g-v-1,row:[y,y],column:[_,_],row_focus:y,column_focus:_},m.rangestart=!0,$("#luckysheet-formula-functionrange-select").css({left:w,width:k-w-1,top:v,height:g-v-1}).show(),$("#luckysheet-formula-help-c").hide();var Dt=wn(u.currentSheetIndex,{row:[y,y],column:[_,_]},u.currentSheetIndex);return $("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(Dt),$("#luckysheet-row-count-show").hide(),void $("#luckysheet-column-count-show").hide()}if(u.luckysheet_select_status){if(l.shiftKey){var et=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),ur=0,Xt=0,jt=[];et.top>v?(ur=v,Xt=et.top+et.height-v,et.row[1]>et.row_focus&&(et.row[1]=et.row_focus),jt=[y,et.row[1]]):et.top==v?(ur=v,Xt=et.top+et.height-v,jt=[y,et.row[0]]):(ur=et.top,Xt=g-et.top-1,et.row[0]<et.row_focus&&(et.row[0]=et.row_focus),jt=[et.row[0],y]);var lr=0,tr=0,xr=[];et.left>w?(lr=w,tr=et.left+et.width-w,et.column[1]>et.column_focus&&(et.column[1]=et.column_focus),xr=[_,et.column[1]]):et.left==w?(lr=w,tr=et.left+et.width-w,xr=[_,et.column[0]]):(lr=et.left,tr=k-et.left-1,et.column[0]<et.column_focus&&(et.column[0]=et.column_focus),xr=[et.column[0],_]);var rr=dr.mergeMoveMain(xr,jt,et,ur,Xt,lr,tr);rr!=null&&(xr=rr[0],jt=rr[1],ur=rr[2],Xt=rr[3],lr=rr[4],tr=rr[5]),et.row=jt,et.column=xr,et.left_move=lr,et.width_move=tr,et.top_move=ur,et.height_move=Xt,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=et,$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(wn(u.currentSheetIndex,u.luckysheet_select_save)),Pr.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(u.luckysheetfile[je(u.currentSheetIndex)].name+"!"+ya(u.luckysheet_select_save[0].column[0])+(u.luckysheet_select_save[0].row[0]+1)+":"+ya(u.luckysheet_select_save[0].column[1])+(u.luckysheet_select_save[0].row[1]+1))}else l.ctrlKey?u.luckysheet_select_save.push({left:w,width:k-w-1,top:v,height:g-v-1,left_move:w,width_move:k-w-1,top_move:v,height_move:g-v-1,row:[y,C],column:[_,A],row_focus:y,column_focus:_}):(u.luckysheet_select_save.length=0,u.luckysheet_select_save.push({left:w,width:k-w-1,top:v,height:g-v-1,left_move:w,width_move:k-w-1,top_move:v,height_move:g-v-1,row:[y,C],column:[_,A],row_focus:y,column_focus:_}),dr.menuButtonFocus(u.flowdata,y,_),m.fucntionboxshow(y,_));Ra(),Ne.freezenhorizontaldata==null&&Ne.freezenverticaldata==null||Ne.scrollAdaptOfselect(),Ko.mobilecheck()||To(),nt.saveParam("mv",u.currentSheetIndex,u.luckysheet_select_save)}Un.rangefocus&&(Un.rangefocus=!1,$("#luckysheet-alternateformat-range .fa-table").click()),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),Rt()||Cg(),Pr.pivotclick(y,_,u.currentSheetIndex),la(),Ya.createHookFunction("cellMousedown",u.flowdata[y][_],{r:y,c:_,start_r:v,start_c:w,end_r:g,end_c:k},h,f)}}}else Nt.fireMousedown(u.flowdata[y][_].dd)}}}}).mouseup(function(l){if(l.which=="3"){if(!u.allowEdit||Rt())return;var o=l.pageX,d=l.pageY,s=u.luckysheet_select_save[0],h=Nt.cellRightClickConfig;if($("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-handleincell").show(),$("#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift").hide(),na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block",na("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="block",s.row!=null&&s.row[0]==0&&s.row[1]==u.flowdata.length-1){if(!(h.copy||h.copyAs||h.paste||h.insertColumn||h.deleteColumn||h.hideColumn||h.columnWidth||h.clear||h.matrix||h.sort||h.filter||h.chart||h.image||h.link||h.data||h.cellFormat))return;u.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(st().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(st().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(st().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(st().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),u.luckysheet_cols_menu_status=!0,na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",na("#luckysheet-top-left-add-selected").style.display=h.insertColumn?"block":"none",na("#luckysheet-bottom-right-add-selected").style.display=h.insertColumn?"block":"none",na("#luckysheet-del-selected").style.display=h.deleteColumn?"block":"none",na("#luckysheet-hide-selected").style.display=h.hideColumn?"block":"none",na("#luckysheet-show-selected").style.display=h.hideColumn?"block":"none",na("#luckysheet-column-row-width-selected").style.display=h.columnWidth?"block":"none",h.copy||h.copyAs||h.paste||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",h.insertColumn||h.deleteColumn||h.hideColumn||h.columnWidth||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),h.insertColumn||h.deleteColumn||h.hideColumn||h.columnWidth||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");var f=$.extend(!0,{},u.config);f.columnlen==null&&(f.columnlen={});for(var p=f.columnlen[u.luckysheet_select_save[0].column[0]]==null?u.defaultcollen:f.columnlen[u.luckysheet_select_save[0].column[0]],g=!0,v=0;v<u.luckysheet_select_save.length;v++)for(var y=u.luckysheet_select_save[v],b=y.column[0],k=y.column[1],w=b;w<=k;w++)if((f.columnlen[w]==null?u.defaultcollen:f.columnlen[w])!=p){g=!1;break}g?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(p):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else if(s.column!=null&&s.column[0]==0&&s.column[1]==u.flowdata[0].length-1){if(!(h.copy||h.copyAs||h.paste||h.insertRow||h.deleteRow||h.hideRow||h.rowHeight||h.clear||h.matrix||h.sort||h.filter||h.chart||h.image||h.link||h.data||h.cellFormat))return;u.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(st().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(st().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(st().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(st().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),u.luckysheet_cols_menu_status=!0,na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",na("#luckysheet-top-left-add-selected").style.display=h.insertRow?"block":"none",na("#luckysheet-bottom-right-add-selected").style.display=h.insertRow?"block":"none",na("#luckysheet-del-selected").style.display=h.deleteRow?"block":"none",na("#luckysheet-hide-selected").style.display=h.hideRow?"block":"none",na("#luckysheet-show-selected").style.display=h.hideRow?"block":"none",na("#luckysheet-column-row-width-selected").style.display=h.rowHeight?"block":"none",h.copy||h.copyAs||h.paste||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",h.insertRow||h.deleteRow||h.hideRow||h.rowHeight||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),h.insertRow||h.deleteRow||h.hideRow||h.rowHeight||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");var _=$.extend(!0,{},u.config);_.rowlen==null&&(_.rowlen={});for(var C=_.rowlen[u.luckysheet_select_save[0].row[0]]==null?u.defaultrowlen:_.rowlen[u.luckysheet_select_save[0].row[0]],A=!0,I=0;I<u.luckysheet_select_save.length;I++)for(var S=u.luckysheet_select_save[I],E=S.row[0],R=S.row[1],F=E;F<=R;F++)if((_.rowlen[F]==null?u.defaultrowlen:_.rowlen[F])!=C){A=!1;break}A?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(C):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else{if(!(h.copy||h.copyAs||h.paste||h.insertRow||h.insertColumn||h.deleteRow||h.deleteColumn||h.deleteCell||h.clear||h.matrix||h.sort||h.filter||h.chart||h.image||h.link||h.data||h.cellFormat))return;h.copy||h.copyAs||h.paste||(na("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none",h.insertRow||h.insertColumn||h.deleteRow||h.deleteColumn||h.deleteCell||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),h.insertRow||h.insertColumn||h.deleteRow||h.deleteColumn||h.deleteCell||(na("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none")}h.clear||h.matrix||h.sort||h.filter||h.chart||h.image||h.link||h.data||h.cellFormat||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),Au($("#luckysheet-rightclick-menu"),o,d)}nt.saveParam("mv",u.currentSheetIndex,u.luckysheet_select_save)}).dblclick(function(l){if(!$(l.target).hasClass("luckysheet-mousedown-cancel")&&u.allowEdit&&!(parseInt($("#luckysheet-input-box").css("top"))>0)){var o=pa(l.pageX,l.pageY);if(!(o[0]>=u.cellmainWidth-u.cellMainSrollBarSize||o[1]>=u.cellmainHeight-u.cellMainSrollBarSize)){var d=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),h=o[0]+d,f=o[1]+s;Ne.freezenverticaldata!=null&&o[0]<Ne.freezenverticaldata[0]-Ne.freezenverticaldata[2]&&(h=o[0]+Ne.freezenverticaldata[2]),Ne.freezenhorizontaldata!=null&&o[1]<Ne.freezenhorizontaldata[0]-Ne.freezenhorizontaldata[2]&&(f=o[1]+Ne.freezenhorizontaldata[2]);var p=Wa(f)[2],g=ja(h)[2],v=dr.mergeborer(u.flowdata,p,g);if(v&&(p=v.row[2],g=v.column[2]),Pr.isPivotRange(p,g)){if(!(Pr.filter!=null&&Pr.filter.length!=0||Pr.row!=null&&Pr.row.length!=0||Pr.column!=null&&Pr.column.length!=0||Pr.values!=null&&Pr.values.length!=0)||Pr.values==null||Pr.values.length==0||p==0||g==0)return;if(Pr.column!=null&&Pr.column.length>0){if(Pr.values.length>=2&&Pr.showType=="column"){if(p<=Pr.column.length||g>=Pr.pivotDatas[0].length-Pr.values.length)return}else if(p<=Pr.column.length-1||g>=Pr.pivotDatas[0].length-1)return}if(Pr.row!=null&&Pr.row.length>0){if(Pr.values.length>=2&&Pr.showType=="row"){if(g<=Pr.row.length||p>=Pr.pivotDatas.length-Pr.values.length)return}else if(g<=Pr.row.length-1||p>=Pr.pivotDatas.length-1)return}return ir.addNewSheet(l),void Pr.drillDown(p,g)}if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible"))$("#luckysheet-cell-selected").hide();else{if($("#luckysheet-conditionformat-dialog").is(":visible")||$("#luckysheet-administerRule-dialog").is(":visible")||$("#luckysheet-newConditionRule-dialog").is(":visible")||$("#luckysheet-editorConditionRule-dialog").is(":visible")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible")||$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")||$("#luckysheet-alternateformat-rangeDialog").is(":visible"))return;dr.luckysheetPaintModelOn&&dr.cancelPaintModel();var y=u.luckysheet_select_save[0].column_focus,b=u.luckysheet_select_save[0].row_focus;y===g&&b===p||(p=b,g=y),ri(p,g,u.flowdata),Ra()}}}}),document.getElementById("luckysheet-cell-main").addEventListener("drop",function(l){l.preventDefault(),l.stopPropagation();var o=l.dataTransfer.files;if(o.length==1&&o[0].type.indexOf("image")>-1){if(!dn(u.currentSheetIndex,"editObjects"))return;var d=new FileReader;d.readAsDataURL(o[0]),d.onload=function(s){var h=s.target.result;_r.inserImg(h)}}(function(s){if(Nt&&Nt.hook&&Nt.hook.cellDragStop){var h=pa(s.pageX,s.pageY),f=h[0]+$("#luckysheet-cell-main").scrollLeft(),p=Wa(h[1]+$("#luckysheet-cell-main").scrollTop()),g=p[1],v=p[0],y=p[2],b=ja(f),k=b[1],w=b[0],_=b[2],C=dr.mergeborer(u.flowdata,y,_);C&&(g=C.row[1],v=C.row[0],y=C.row[2],k=C.column[1],w=C.column[0],_=C.column[2]);var A=ir.getSheetByIndex(),I=$("#luckysheetTableContent").get(0).getContext("2d");Ya.createHookFunction("cellDragStop",u.flowdata[y][_],{r:y,c:_,start_r:v,start_c:w,end_r:g,end_c:k},A,I,s)}})(l)},!1),document.getElementById("luckysheet-cell-main").addEventListener("dragover",function(l){l.preventDefault(),l.stopPropagation()},!1),$(document).on("mousemove.luckysheetEvent",function(l){if(Lr.overshow(l),Jl.overshow(l),window.cancelAnimationFrame(u.jfautoscrollTimeout),Nt&&Nt.hook&&Nt.hook.sheetMousemove){var o=pa(l.pageX,l.pageY),d=o[0]+$("#luckysheet-cell-main").scrollLeft(),s=Wa(o[1]+$("#luckysheet-cell-main").scrollTop()),h=s[1],f=s[0],p=s[2],g=ja(d),v=g[1],y=g[0],b=g[2],k=dr.mergeborer(u.flowdata,p,b);k&&(h=k.row[1],f=k.row[0],p=k.row[2],v=k.column[1],y=k.column[0],b=k.column[2]);var w=ir.getSheetByIndex(),_={functionResizeStatus:m.functionResizeStatus,horizontalmoveState:!!Ne.horizontalmovestate,verticalmoveState:!!Ne.verticalmovestate,pivotTableMoveState:!!Pr&&Pr.movestate,sheetMoveStatus:u.luckysheet_sheet_move_status,scrollStatus:!!u.luckysheet_scroll_status,selectStatus:!!u.luckysheet_select_status,rowsSelectedStatus:!!u.luckysheet_rows_selected_status,colsSelectedStatus:!!u.luckysheet_cols_selected_status,cellSelectedMove:!!u.luckysheet_cell_selected_move,cellSelectedExtend:!!u.luckysheet_cell_selected_extend,colsChangeSize:!!u.luckysheet_cols_change_size,rowsChangeSize:!!u.luckysheet_rows_change_size,chartMove:!!u.chartparam.luckysheetCurrentChartMove,chartResize:!!u.chartparam.luckysheetCurrentChartResize,rangeResize:!!m.rangeResize,rangeMove:!!m.rangeMove},C=$("#luckysheetTableContent").get(0).getContext("2d");u.flowdata&&u.flowdata[p]&&Ya.createHookFunction("sheetMousemove",u.flowdata[p][b],{r:p,c:b,start_r:f,start_c:y,end_r:h,end_c:v},w,_,C)}if(m.functionResizeStatus){var A=l.pageY-m.functionResizeData.y,I=m.functionResizeData.calculatebarHeight+A,S=Math.round($(window).height()/2);if(I<=28){if(I<=20)return;I=28}else if(I>=S){if(I>=S+8)return;I=S}u.calculatebarHeight=I,$("#luckysheet-wa-calculate").css("height",u.calculatebarHeight-2),$("#luckysheet-wa-calculate-size").css({background:"#5e5e5e",cursor:"ns-resize"}),clearTimeout(m.functionResizeTimeout),m.functionResizeTimeout=setTimeout(function(){Rn()},15)}else if(Ne.horizontalmovestate){var E=pa(l.pageX,l.pageY);$("#luckysheet-cell-main").scrollLeft();var R=$("#luckysheet-cell-main").scrollTop(),F=(E[0],Wa(E[1]+R)),N=F[1],z=F[0],P=F[2],q=E[1]+u.columnHeaderHeight;q<u.columnHeaderHeight&&(q=u.columnHeaderHeight),q>Ne.windowHeight-4&&(q=Ne.windowHeight-4),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({top:q}),q+R-u.columnHeaderHeight>=z+(N-z)/2?(q=N-2-R+u.columnHeaderHeight,Ne.freezenhorizontaldata=[N,P+1,R,Ne.cutVolumn(u.visibledatarow,P+1),q]):(q=z-2-R+u.columnHeaderHeight,Ne.freezenhorizontaldata=[z,P,R,Ne.cutVolumn(u.visibledatarow,P),q]),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").css({top:q}),Ne.saveFreezen(Ne.freezenhorizontaldata,q,null,null)}else if(Ne.verticalmovestate){var V=pa(l.pageX,l.pageY),x=$("#luckysheet-cell-main").scrollLeft();$("#luckysheet-cell-main").scrollTop();var ee=V[0]+x,ne=(V[1],ja(ee)),ae=ne[1],de=ne[0],ve=ne[2],U=V[0]+u.rowHeaderWidth;U<u.rowHeaderWidth&&(U=u.rowHeaderWidth),U>Ne.windowWidth-4&&(U=Ne.windowWidth-4),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({left:U}),U+x-u.rowHeaderWidth>=de+(ae-de)/2?(U=ae-2-x+u.rowHeaderWidth,Ne.freezenverticaldata=[ae,ve+1,x,Ne.cutVolumn(u.visibledatacolumn,ve+1),U]):(U=de-2-x+u.rowHeaderWidth,Ne.freezenverticaldata=[de,ve,x,Ne.cutVolumn(u.visibledatacolumn,ve),U]),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").css({left:U}),Ne.saveFreezen(null,null,Ne.freezenverticaldata,U),Rn()}else if(Pr&&Pr.movestate){var B=l.pageX,le=l.pageY;$("#luckysheet-modal-dialog-slider-pivot-move").css({left:B-Pr.movesave.width/2,top:le-Pr.movesave.height})}else if(u.luckysheet_sheet_move_status){var Te=$("#luckysheet-sheet-container-c").scrollLeft(),ue=l.pageX+Te;if(Math.abs(l.pageX-u.luckysheet_sheet_move_data.pageX)<3)return;var be=$("#luckysheet-sheet-container").width(),ye=ue-u.luckysheet_sheet_move_data.curleft-$("#luckysheet-sheet-container").offset().left;u.luckysheet_sheet_move_data.activeobject.css({left:ye});var ce=fa(u.luckysheet_sheet_move_data.widthlist,ye+u.luckysheet_sheet_move_data.curleft);u.luckysheet_sheet_move_data.cursorobject.css({cursor:"move"}),ye-Te<=6&&$("#luckysheet-sheets-leftscroll").click(),ye-Te>=be-40&&$("#luckysheet-sheets-rightscroll").click(),ce!=u.luckysheet_sheet_move_data.curindex&&(ce==-1&&ye>0?(ce=u.luckysheet_sheet_move_data.widthlist.length-1,$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(ce))):ce==-1&&ye<=0?$("#luckysheet-sheets-item-clone").insertBefore($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(0)):$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(ce)),u.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(St){St==0?u.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):u.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+u.luckysheet_sheet_move_data.widthlist[St-1])}),u.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").index($("#luckysheet-sheets-item-clone")))}else if(u.luckysheet_model_move_state){var Re=$(document).scrollTop(),pe=$(document).scrollLeft(),me=l.pageY+Re,re=l.pageX+pe,_e=$(window).height(),Ze=$(window).width(),We=u.luckysheet_model_move_obj.height(),Xe=u.luckysheet_model_move_obj.width(),Ue=me-u.luckysheet_model_xy[1],mt=re-u.luckysheet_model_xy[0];Ue<0&&(Ue=0),Ue+We+62>_e&&(Ue=_e-We-62),mt<0&&(mt=0),mt+Xe+86>Ze&&(mt=Ze-Xe-86),u.luckysheet_model_move_obj.css({top:Ue,left:mt}),l.preventDefault()}else(u.luckysheet_scroll_status||u.luckysheet_select_status||u.luckysheet_rows_selected_status||u.luckysheet_cols_selected_status||u.luckysheet_cell_selected_move||u.luckysheet_cell_selected_extend||u.luckysheet_cols_change_size||u.luckysheet_rows_change_size||u.chartparam.luckysheetCurrentChartMove||u.chartparam.luckysheetCurrentChartResize||m.rangeResize||m.rangeMove)&&(u.luckysheet_select_status&&(clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500)),u.jfautoscrollTimeout=window.requestAnimationFrame(function St(){if(u.luckysheet_scroll_status&&!u.luckysheet_cols_change_size&&!u.luckysheet_rows_change_size){var at,dt,wt=pa(l.pageX,l.pageY),ct=$("#luckysheet-scrollbar-x").scrollLeft(),bt=$("#luckysheet-scrollbar-y").scrollTop(),De=wt[0],He=wt[1],Dt=$("#luckysheet-cell-main").height()-20*u.zoomRatio,et=$("#luckysheet-cell-main").width()-60*u.zoomRatio;(He<0||He>Dt)&&(at=He<0?bt+He/2:bt+(He-Dt)/2,$("#luckysheet-scrollbar-y").scrollTop(at)),(De<0||De>et)&&(dt=De<0?ct+De/2:ct+(De-et)/2,$("#luckysheet-scrollbar-x").scrollLeft(dt))}if(u.luckysheet_select_status){var ur=pa(l.pageX,l.pageY),Xt=ur[0]+$("#luckysheet-cell-main").scrollLeft(),jt=Wa(ur[1]+$("#luckysheet-cell-main").scrollTop()),lr=jt[1],tr=jt[0],xr=jt[2],rr=ja(Xt),nr=rr[1],Ut=rr[0],ar=rr[2];if(!jp(xr,ar,u.currentSheetIndex))return;var Jt=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),Qt=0,_t=0,er=[];Jt.top>tr?(Qt=tr,_t=Jt.top+Jt.height-tr,Jt.row[1]>Jt.row_focus&&(Jt.row[1]=Jt.row_focus),er=[xr,Jt.row[1]]):Jt.top==tr?(Qt=tr,_t=Jt.top+Jt.height-tr,er=[xr,Jt.row[0]]):(Qt=Jt.top,_t=lr-Jt.top-1,Jt.row[0]<Jt.row_focus&&(Jt.row[0]=Jt.row_focus),er=[Jt.row[0],xr]);var Kt=0,mr=0,fr=[];Jt.left>Ut?(Kt=Ut,mr=Jt.left+Jt.width-Ut,Jt.column[1]>Jt.column_focus&&(Jt.column[1]=Jt.column_focus),fr=[ar,Jt.column[1]]):Jt.left==Ut?(Kt=Ut,mr=Jt.left+Jt.width-Ut,fr=[ar,Jt.column[0]]):(Kt=Jt.left,mr=nr-Jt.left-1,Jt.column[0]<Jt.column_focus&&(Jt.column[0]=Jt.column_focus),fr=[Jt.column[0],ar]);var Wt=dr.mergeMoveMain(fr,er,Jt,Qt,_t,Kt,mr);Wt!=null&&(fr=Wt[0],er=Wt[1],Qt=Wt[2],_t=Wt[3],Kt=Wt[4],mr=Wt[5]),Jt.row=er,Jt.column=fr,Jt.left_move=Kt,Jt.width_move=mr,Jt.top_move=Qt,Jt.height_move=_t,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=Jt,Ra(),Ne.scrollFreezen(),$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(wn(u.currentSheetIndex,u.luckysheet_select_save[u.luckysheet_select_save.length-1])),Pr.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(u.luckysheetfile[je(u.currentSheetIndex)].name+"!"+ya(u.luckysheet_select_save[0].column[0])+(u.luckysheet_select_save[0].row[0]+1)+":"+ya(u.luckysheet_select_save[0].column[1])+(u.luckysheet_select_save[0].row[1]+1))}else if(kr.selectStatus){var ze=pa(l.pageX,l.pageY),Ae=ze[0]+$("#luckysheet-cell-main").scrollLeft(),Ve=Wa(ze[1]+$("#luckysheet-cell-main").scrollTop()),gt=Ve[1],vt=Ve[0],pt=Ve[2],Tt=ja(Ae),Ot=Tt[1],It=Tt[0],Lt=Tt[2],At=kr.selectRange[kr.selectRange.length-1],or=0,Cr=0,Ar=[];At.top>vt?(or=vt,Cr=At.top+At.height-vt,At.row[1]>At.row_focus&&(At.row[1]=At.row_focus),Ar=[pt,At.row[1]]):At.top==vt?(or=vt,Cr=At.top+At.height-vt,Ar=[pt,At.row[0]]):(or=At.top,Cr=gt-At.top-1,At.row[0]<At.row_focus&&(At.row[0]=At.row_focus),Ar=[At.row[0],pt]);var Rr=0,Zr=0,Tr=[];At.left>It?(Rr=It,Zr=At.left+At.width-It,At.column[1]>At.column_focus&&(At.column[1]=At.column_focus),Tr=[Lt,At.column[1]]):At.left==It?(Rr=It,Zr=At.left+At.width-It,Tr=[Lt,At.column[0]]):(Rr=At.left,Zr=Ot-At.left-1,At.column[0]<At.column_focus&&(At.column[0]=At.column_focus),Tr=[At.column[0],Lt]);var jr=dr.mergeMoveMain(Tr,Ar,At,or,Cr,Rr,Zr);jr!=null&&(Tr=jr[0],Ar=jr[1],or=jr[2],Cr=jr[3],Rr=jr[4],Zr=jr[5]),At.row=Ar,At.column=Tr,At.left_move=Rr,At.width_move=Zr,At.top_move=or,At.height_move=Cr,kr.selectRange[kr.selectRange.length-1]=At,pn(kr.selectRange);var ta=kr.getTxtByRange(kr.selectRange);$("#luckysheet-multiRange-dialog input").val(ta)}else if(aa.selectStatus){var ia=pa(l.pageX,l.pageY),Jr=ia[0]+$("#luckysheet-cell-main").scrollLeft(),ba=Wa(ia[1]+$("#luckysheet-cell-main").scrollTop()),Wr=ba[1],Fr=ba[0],oa=ba[2],Fa=ja(Jr),Da=Fa[1],va=Fa[0],Ha=Fa[2],qr=aa.selectRange[aa.selectRange.length-1],Ca=0,La=0,Ea=[];qr.top>Fr?(Ca=Fr,La=qr.top+qr.height-Fr,qr.row[1]>qr.row_focus&&(qr.row[1]=qr.row_focus),Ea=[oa,qr.row[1]]):qr.top==Fr?(Ca=Fr,La=qr.top+qr.height-Fr,Ea=[oa,qr.row[0]]):(Ca=qr.top,La=Wr-qr.top-1,qr.row[0]<qr.row_focus&&(qr.row[0]=qr.row_focus),Ea=[qr.row[0],oa]);var Za=0,gn=0,Ka=[];qr.left>va?(Za=va,gn=qr.left+qr.width-va,qr.column[1]>qr.column_focus&&(qr.column[1]=qr.column_focus),Ka=[Ha,qr.column[1]]):qr.left==va?(Za=va,gn=qr.left+qr.width-va,Ka=[Ha,qr.column[0]]):(Za=qr.left,gn=Da-qr.left-1,qr.column[0]<qr.column_focus&&(qr.column[0]=qr.column_focus),Ka=[qr.column[0],Ha]);var ka=dr.mergeMoveMain(Ka,Ea,qr,Ca,La,Za,gn);ka!=null&&(Ka=ka[0],Ea=ka[1],Ca=ka[2],La=ka[3],Za=ka[4],gn=ka[5]),qr.row=Ea,qr.column=Ka,qr.left_move=Za,qr.width_move=gn,qr.top_move=Ca,qr.height_move=La,aa.selectRange[aa.selectRange.length-1]=qr,pn(aa.selectRange);var Pa=aa.getTxtByRange(aa.selectRange);m.rangetosheet!=u.currentSheetIndex&&(Pa=u.luckysheetfile[je(u.currentSheetIndex)].name+"!"+Pa),$("#luckysheet-dataVerificationRange-dialog input").val(Pa)}else if(m.rangestart)m.rangedrag(l);else if(m.rangedrag_row_start)m.rangedrag_row(l);else if(m.rangedrag_column_start)m.rangedrag_column(l);else if(u.luckysheet_rows_selected_status){var $a=pa(l.pageX,l.pageY)[1]+$("#luckysheet-rows-h").scrollTop();if($a<0)return!1;var on=Wa($a),Dn=on[1],Fn=on[0],_n=on[2],dl=u.visibledatacolumn.length-1,Or=(u.visibledatacolumn[dl],$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1])),en=0,hn=0,tn=[];Or.top>Fn?(en=Fn,hn=Or.top+Or.height-Fn,Or.row[1]>Or.row_focus&&(Or.row[1]=Or.row_focus),tn=[_n,Or.row[1]]):Or.top==Fn?(en=Fn,hn=Or.top+Or.height-Fn,tn=[_n,Or.row[0]]):(en=Or.top,hn=Dn-Or.top-1,Or.row[0]<Or.row_focus&&(Or.row[0]=Or.row_focus),tn=[Or.row[0],_n]),Or.row=tn,Or.top_move=en,Or.height_move=hn,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=Or,Ra(),clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500)}else if(u.luckysheet_cols_selected_status){var Sn=pa(l.pageX,l.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft();if(Sn<0)return!1;var vn=u.visibledatarow.length-1,Kn=(u.visibledatarow[vn],ja(Sn)),ni=Kn[1],Jn=Kn[0],li=Kn[2],Ma=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),nl=0,Pn=0,Mr=[];Ma.left>Jn?(nl=Jn,Pn=Ma.left+Ma.width-Jn,Ma.column[1]>Ma.column_focus&&(Ma.column[1]=Ma.column_focus),Mr=[li,Ma.column[1]]):Ma.left==Jn?(nl=Jn,Pn=Ma.left+Ma.width-Jn,Mr=[li,Ma.column[0]]):(nl=Ma.left,Pn=ni-Ma.left-1,Ma.column[0]<Ma.column_focus&&(Ma.column[0]=Ma.column_focus),Mr=[Ma.column[0],li]),Ma.column=Mr,Ma.left_move=nl,Ma.width_move=Pn,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=Ma,Ra(),clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500)}else if(u.luckysheet_cell_selected_move){var Qn=pa(l.pageX,l.pageY),Ja=$("#luckysheet-cell-main").scrollLeft(),ii=$("#luckysheet-cell-main").scrollTop(),On=Qn[0]+Ja,Eo=Qn[1]+ii,Vi=$(window).height()+ii-u.sheetBarHeight-u.statisticBarHeight,cs=$(window).width()+Ja,oi=Wa(Eo),ds=oi[1],wl=oi[0],Al=oi[2],sl=ja(On),Vl=sl[1],_l=sl[0],$o=sl[2],uo=u.luckysheet_cell_selected_move_index[0],hl=u.luckysheet_cell_selected_move_index[1],xi=u.luckysheet_select_save[0].row[0]-uo+Al,ll=u.luckysheet_select_save[0].row[1]-uo+Al,Wn=u.luckysheet_select_save[0].column[0]-hl+$o,jn=u.luckysheet_select_save[0].column[1]-hl+$o;(xi<0||Eo<0)&&(xi=0,ll=u.luckysheet_select_save[0].row[1]-u.luckysheet_select_save[0].row[0]),(Wn<0||On<0)&&(Wn=0,jn=u.luckysheet_select_save[0].column[1]-u.luckysheet_select_save[0].column[0]),(ll>=u.visibledatarow[u.visibledatarow.length-1]||Eo>Vi)&&(xi=u.visibledatarow.length-1-u.luckysheet_select_save[0].row[1]+u.luckysheet_select_save[0].row[0],ll=u.visibledatarow.length-1),(jn>=u.visibledatacolumn[u.visibledatacolumn.length-1]||On>cs)&&(Wn=u.visibledatacolumn.length-1-u.luckysheet_select_save[0].column[1]+u.luckysheet_select_save[0].column[0],jn=u.visibledatacolumn.length-1),_l=Wn-1==-1?0:u.visibledatacolumn[Wn-1],Vl=u.visibledatacolumn[jn],wl=xi-1==-1?0:u.visibledatarow[xi-1],ds=u.visibledatarow[ll],$("#luckysheet-cell-selected-move").css({left:_l,width:Vl-_l-2,top:wl,height:ds-wl-2,display:"block"})}else if(u.luckysheet_cell_selected_extend){var Ul=pa(l.pageX,l.pageY),Ll=$("#luckysheet-cell-main").scrollLeft()-5,ml=$("#luckysheet-cell-main").scrollTop()-5,si=Ul[0]+Ll,Hl=Ul[1]+ml,Sl=$(window).height()+ml-u.sheetBarHeight-u.statisticBarHeight,hs=$(window).width()+Ll,Do=Wa(Hl),Ui=Do[1],ui=Do[0],wi=Do[2],Ql=ja(si),Fo=Ql[1],ms=Ql[0],fs=Ql[2],Fu=u.luckysheet_cell_selected_extend_index[0],Md=u.luckysheet_cell_selected_extend_index[1],qo=u.luckysheet_select_save[0].row[0],Mo=u.luckysheet_select_save[0].row[1],ps=u.luckysheet_select_save[0].column[0],No=u.luckysheet_select_save[0].column[1];(qo<0||Hl<0)&&(qo=0,Mo=u.luckysheet_select_save[0].row[1]-u.luckysheet_select_save[0].row[0]),(ps<0||si<0)&&(ps=0,No=u.luckysheet_select_save[0].column[1]-u.luckysheet_select_save[0].column[0]),(Mo>=u.visibledatarow[u.visibledatarow.length-1]||Hl>Sl)&&(qo=u.visibledatarow.length-1-u.luckysheet_select_save[0].row[1]+u.luckysheet_select_save[0].row[0],Mo=u.visibledatarow.length-1),(No>=u.visibledatacolumn[u.visibledatacolumn.length-1]||si>hs)&&(ps=u.visibledatacolumn.length-1-u.luckysheet_select_save[0].column[1]+u.luckysheet_select_save[0].column[0],No=u.visibledatacolumn.length-1);var qu=u.luckysheet_select_save[0].top_move,Ws=u.luckysheet_select_save[0].height_move,Ys=u.luckysheet_select_save[0].left_move,Xs=u.luckysheet_select_save[0].width_move;Math.abs(Fu-wi)>Math.abs(Md-fs)?wi>=qo&&wi<=Mo||(u.luckysheet_select_save[0].top_move>=ui?(qu=ui,Ws=u.luckysheet_select_save[0].top_move+u.luckysheet_select_save[0].height_move-ui):(qu=u.luckysheet_select_save[0].top_move,Ws=Ui-u.luckysheet_select_save[0].top_move-1)):fs>=ps&&fs<=No||(u.luckysheet_select_save[0].left_move>=ms?(Ys=ms,Xs=u.luckysheet_select_save[0].left_move+u.luckysheet_select_save[0].width_move-ms):(Ys=u.luckysheet_select_save[0].left_move,Xs=Fo-u.luckysheet_select_save[0].left_move-1)),$("#luckysheet-cell-selected-extend").css({left:Ys,width:Xs,top:qu,height:Ws,display:"block"})}else if(u.luckysheet_cols_change_size){var Mu=pa(l.pageX,l.pageY),Nc=$("#luckysheet-cols-h-c").scrollLeft(),Lo=Mu[0]+Nc,Lc=$(window).width(),Zs=u.visibledatarow.length-1,jl=(u.visibledatarow[Zs],ja(Lo));jl[1],jl[0],jl[2],Lo+3-u.luckysheet_cols_change_size_start[0]>30&&Lo<Lc+Nc-100&&($("#luckysheet-change-size-line").css({left:Lo}),$("#luckysheet-cols-change-size").css({left:Lo-2}))}else if(u.luckysheet_rows_change_size){var Nd=pa(l.pageX,l.pageY),ci=$("#luckysheet-rows-h").scrollTop(),gs=Nd[1]+ci,Po=$(window).height(),Nu=Wa(gs);Nu[1],Nu[0],Nu[2],gs+3-u.luckysheet_rows_change_size_start[0]>19&&gs<Po+ci-200&&($("#luckysheet-change-size-line").css({top:gs}),$("#luckysheet-rows-change-size").css({top:gs}))}else if(u.chartparam.luckysheetCurrentChartMove){var di=pa(l.pageX,l.pageY),Ld=di[0]+$("#luckysheet-cell-main").scrollLeft(),Oo=di[1]+$("#luckysheet-cell-main").scrollTop(),Pc=u.chartparam.luckysheetCurrentChartMoveObj.height(),hi=u.chartparam.luckysheetCurrentChartMoveObj.width(),vs=Oo-u.chartparam.luckysheetCurrentChartMoveXy[1],Pl=Ld-u.chartparam.luckysheetCurrentChartMoveXy[0];if(vs<0&&(vs=0),vs+Pc+42+6>u.chartparam.luckysheetCurrentChartMoveWinH&&(vs=u.chartparam.luckysheetCurrentChartMoveWinH-Pc-42-6),Pl<0&&(Pl=0),Pl+hi+22+36>u.chartparam.luckysheetCurrentChartMoveWinW&&(Pl=u.chartparam.luckysheetCurrentChartMoveWinW-hi-22-36),u.chartparam.luckysheetCurrentChartMoveObj.css({top:vs,left:Pl}),Ne.freezenhorizontaldata!=null||Ne.freezenverticaldata!=null){Ne.scrollAdapt();var Oc=u.chartparam.luckysheetCurrentChartMoveObj.offset(),Lu=u.chartparam.luckysheetCurrentChartMoveObj.position();u.chartparam.luckysheetCurrentChartMoveXy=[l.pageX-Oc.left,l.pageY-Oc.top,Lu.left,Lu.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()]}}else if(u.chartparam.luckysheetCurrentChartResize){var zo=$("#luckysheet-cell-main").scrollTop(),Pd=$("#luckysheet-cell-main").scrollLeft(),Bo=pa(l.pageX,l.pageY),Pu=Bo[0]+Pd,co=Bo[1]+zo;if(Pu<0||co<0)return!1;u.chartparam.luckysheetCurrentChartResizeObj.height(),u.chartparam.luckysheetCurrentChartResizeObj.width();var zc=co-u.chartparam.luckysheetCurrentChartResizeXy[1],Ou=Pu-u.chartparam.luckysheetCurrentChartResizeXy[0],ei=u.chartparam.luckysheetCurrentChartResizeXy[5],Hi=u.chartparam.luckysheetCurrentChartResizeXy[3],mi=u.chartparam.luckysheetCurrentChartResizeXy[4],ji=u.chartparam.luckysheetCurrentChartResizeXy[2];u.chartparam.luckysheetCurrentChartResize!="lm"&&u.chartparam.luckysheetCurrentChartResize!="lt"&&u.chartparam.luckysheetCurrentChartResize!="lb"||(mi=Pu,ji=u.chartparam.luckysheetCurrentChartResizeXy[2]-Ou,mi>u.chartparam.luckysheetCurrentChartResizeXy[2]+u.chartparam.luckysheetCurrentChartResizeXy[4]-60?(mi=u.chartparam.luckysheetCurrentChartResizeXy[2]+u.chartparam.luckysheetCurrentChartResizeXy[4]-60,ji=u.chartparam.luckysheetCurrentChartResizeXy[2]-(u.chartparam.luckysheetCurrentChartResizeXy[2]+u.chartparam.luckysheetCurrentChartResizeXy[4]-60-u.chartparam.luckysheetCurrentChartResizeXy[0])):mi<=0&&(mi=0,ji=u.chartparam.luckysheetCurrentChartResizeXy[2]+u.chartparam.luckysheetCurrentChartResizeXy[0])),u.chartparam.luckysheetCurrentChartResize!="rm"&&u.chartparam.luckysheetCurrentChartResize!="rt"&&u.chartparam.luckysheetCurrentChartResize!="rb"||((ji=u.chartparam.luckysheetCurrentChartResizeXy[2]+Ou)<60?ji=60:ji>=u.chartparam.luckysheetCurrentChartResizeWinW-u.chartparam.luckysheetCurrentChartResizeXy[4]-22-36&&(ji=u.chartparam.luckysheetCurrentChartResizeWinW-u.chartparam.luckysheetCurrentChartResizeXy[4]-22-36)),u.chartparam.luckysheetCurrentChartResize!="mt"&&u.chartparam.luckysheetCurrentChartResize!="lt"&&u.chartparam.luckysheetCurrentChartResize!="rt"||(ei=co,Hi=u.chartparam.luckysheetCurrentChartResizeXy[3]-zc,ei>u.chartparam.luckysheetCurrentChartResizeXy[3]+u.chartparam.luckysheetCurrentChartResizeXy[5]-60?(ei=u.chartparam.luckysheetCurrentChartResizeXy[3]+u.chartparam.luckysheetCurrentChartResizeXy[5]-60,Hi=u.chartparam.luckysheetCurrentChartResizeXy[3]-(u.chartparam.luckysheetCurrentChartResizeXy[3]+u.chartparam.luckysheetCurrentChartResizeXy[5]-60-u.chartparam.luckysheetCurrentChartResizeXy[1])):ei<=0&&(ei=0,Hi=u.chartparam.luckysheetCurrentChartResizeXy[3]+u.chartparam.luckysheetCurrentChartResizeXy[1])),u.chartparam.luckysheetCurrentChartResize!="mb"&&u.chartparam.luckysheetCurrentChartResize!="lb"&&u.chartparam.luckysheetCurrentChartResize!="rb"||((Hi=u.chartparam.luckysheetCurrentChartResizeXy[3]+zc)<60?Hi=60:Hi>=u.chartparam.luckysheetCurrentChartResizeWinH-u.chartparam.luckysheetCurrentChartResizeXy[5]-42-6&&(Hi=u.chartparam.luckysheetCurrentChartResizeWinH-u.chartparam.luckysheetCurrentChartResizeXy[5]-42-6));var ys={top:ei,left:mi,height:Hi,width:ji};u.chartparam.luckysheetCurrentChartResizeObj.css(ys),u.resizeChart(u.chartparam.luckysheetCurrentChart)}else if(_r.move){var Bc=pa(l.pageX,l.pageY),Cl=Bc[0]+$("#luckysheet-cell-main").scrollLeft(),Vo=Bc[1]+$("#luckysheet-cell-main").scrollTop(),_i=_r.images[_r.currentImgId];_i.isFixedPos&&(Cl=l.pageX,Vo=l.pageY);var Cy=$("#luckysheet-modal-dialog-activeImage").height(),Ty=$("#luckysheet-modal-dialog-activeImage").width(),Vc=Vo-_r.moveXY[1],Uc=Cl-_r.moveXY[0],zm=0,Bm=_r.currentWinH-Cy-42-6,Vm=0,Um=_r.currentWinW-Ty-22-36;_i.isFixedPos&&(Bm=(zm=u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight)+u.cellmainHeight-u.cellMainSrollBarSize-Cy,Um=(Vm=u.rowHeaderWidth)+u.cellmainWidth-u.cellMainSrollBarSize-Ty),Vc<zm&&(Vc=zm),Vc>Bm&&(Vc=Bm),Uc<Vm&&(Uc=Vm),Uc>Um&&(Uc=Um),$("#luckysheet-modal-dialog-activeImage").css({left:Uc,top:Vc})}else if(_r.resize){var Ay=pa(l.pageX,l.pageY),Kx=$("#luckysheet-cell-main").scrollLeft(),Jx=$("#luckysheet-cell-main").scrollTop(),Hc=Ay[0]+Kx,Hm=Ay[1]+Jx;if(Hc<0||Hm<0)return!1;var tt=_r.resizeXY,Od=Hm-tt[1],Ci=Hc-tt[0],qa=tt[5],ea=tt[3],Aa=tt[4],Xr=tt[2],Ol=_r.resize,Ks=_r.images[_r.currentImgId];if(Ks.isFixedPos){var Ti=u.infobarHeight+u.toolbarHeight+u.calculatebarHeight+u.columnHeaderHeight,Ai=u.rowHeaderWidth;Ol=="lt"?((Aa=tt[4]-tt[6]+Ci)<Ai&&(Aa=Ai),Aa>tt[4]-tt[6]+tt[2]-1&&(Aa=tt[4]-tt[6]+tt[2]-1),Xr=tt[4]-tt[6]+tt[2]-Aa,ea=Math.round(Xr*(tt[3]/tt[2])),(qa=tt[5]-tt[7]+tt[3]-ea)<Ti&&(qa=Ti,ea=tt[5]-tt[7]+tt[3]-qa,Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[4]-tt[6]+tt[2]-Xr),qa>tt[5]-tt[7]+tt[3]-1&&(qa=tt[5]-tt[7]+tt[3]-1,ea=tt[5]-tt[7]+tt[3]-qa,Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[4]-tt[6]+tt[2]-Xr)):Ol=="lm"?((Aa=tt[4]-tt[6]+Ci)<Ai&&(Aa=Ai),Aa>tt[4]-tt[6]+tt[2]-1&&(Aa=tt[4]-tt[6]+tt[2]-1),Xr=tt[4]-tt[6]+tt[2]-Aa,qa=tt[5]-tt[7],ea=tt[3]):Ol=="lb"?((Aa=tt[4]-tt[6]+Ci)<Ai&&(Aa=Ai),Aa>tt[4]-tt[6]+tt[2]-1&&(Aa=tt[4]-tt[6]+tt[2]-1),Xr=tt[4]-tt[6]+tt[2]-Aa,ea=Math.round(Xr*(tt[3]/tt[2])),qa=tt[5]-tt[7],ea<1&&(ea=1,Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[4]-tt[6]+tt[2]-Xr),ea>Ti+u.cellmainHeight-u.cellMainSrollBarSize-qa&&(ea=Ti+u.cellmainHeight-u.cellMainSrollBarSize-qa,Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[4]-tt[6]+tt[2]-Xr)):Ol=="rt"?(Aa=tt[4]-tt[6],(Xr=tt[2]+Ci)<1&&(Xr=1),Xr>Ai+u.cellmainWidth-u.cellMainSrollBarSize-Aa&&(Xr=Ai+u.cellmainWidth-u.cellMainSrollBarSize-Aa),ea=Math.round(Xr*(tt[3]/tt[2])),(qa=tt[5]-tt[7]+tt[3]-ea)<Ti&&(qa=Ti,ea=tt[5]-tt[7]+tt[3]-qa,Xr=Math.round(ea*(tt[2]/tt[3]))),qa>tt[5]-tt[7]+tt[3]-1&&(qa=tt[5]-tt[7]+tt[3]-1,ea=tt[5]-tt[7]+tt[3]-qa,Xr=Math.round(ea*(tt[2]/tt[3])))):Ol=="rm"?(Aa=tt[4]-tt[6],(Xr=tt[2]+Ci)<1&&(Xr=1),Xr>Ai+u.cellmainWidth-u.cellMainSrollBarSize-Aa&&(Xr=Ai+u.cellmainWidth-u.cellMainSrollBarSize-Aa),qa=tt[5]-tt[7],ea=tt[3]):Ol=="rb"?(Aa=tt[4]-tt[6],(Xr=tt[2]+Ci)<1&&(Xr=1),Xr>Ai+u.cellmainWidth-u.cellMainSrollBarSize-Aa&&(Xr=Ai+u.cellmainWidth-u.cellMainSrollBarSize-Aa),ea=Math.round(Xr*(tt[3]/tt[2])),qa=tt[5]-tt[7],ea<1&&(ea=1,Xr=Math.round(ea*(tt[2]/tt[3]))),ea>Ti+u.cellmainHeight-u.cellMainSrollBarSize-qa&&(ea=Ti+u.cellmainHeight-u.cellMainSrollBarSize-qa,Xr=Math.round(ea*(tt[2]/tt[3])))):Ol=="mt"?(Aa=tt[4]-tt[6],Xr=tt[2],(qa=tt[5]-tt[7]+Od)<Ti&&(qa=Ti),qa>tt[5]-tt[7]+tt[3]-1&&(qa=tt[5]-tt[7]+tt[3]-1),ea=tt[5]-tt[7]+tt[3]-qa):Ol=="mb"&&(Aa=tt[4]-tt[6],Xr=tt[2],qa=tt[5]-tt[7],(ea=tt[3]+Od)<1&&(ea=1),ea>Ti+u.cellmainHeight-u.cellMainSrollBarSize-qa&&(ea=Ti+u.cellmainHeight-u.cellMainSrollBarSize-qa))}else Ol=="lt"?(Aa=Hc,Xr=tt[2]-Ci,Aa>tt[2]+tt[4]-1?(Aa=tt[2]+tt[4]-1,Xr=tt[2]+tt[0]-(tt[2]+tt[4]-1)):Aa<=0&&(Aa=0,Xr=tt[2]+tt[0]),ea=Math.round(Xr*(tt[3]/tt[2])),(qa=tt[3]+tt[1]-ea)>tt[3]+tt[5]-1?(qa=tt[3]+tt[5]-1,ea=tt[3]+tt[1]-(tt[3]+tt[5]-1),Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[2]+tt[0]-Xr):qa<=0&&(qa=0,ea=tt[3]+tt[1],Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[2]+tt[0]-Xr)):Ol=="lm"?(Aa=Hc,Xr=tt[2]-Ci,Aa>tt[2]+tt[4]-1?(Aa=tt[2]+tt[4]-1,Xr=tt[2]+tt[0]-(tt[2]+tt[4]-1)):Aa<=0&&(Aa=0,Xr=tt[2]+tt[0])):Ol=="lb"?(Aa=Hc,Xr=tt[2]-Ci,Aa>tt[2]+tt[4]-1?(Aa=tt[2]+tt[4]-1,Xr=tt[2]+tt[0]-(tt[2]+tt[4]-1)):Aa<=0&&(Aa=0,Xr=tt[2]+tt[0]),(ea=Math.round(Xr*(tt[3]/tt[2])))<1?(ea=1,Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[2]+tt[0]-Xr):ea>=_r.currentWinH-tt[5]-42-6&&(ea=_r.currentWinH-tt[5]-42-6,Xr=Math.round(ea*(tt[2]/tt[3])),Aa=tt[2]+tt[0]-Xr)):Ol=="rt"?((Xr=tt[2]+Ci)<1?Xr=1:Xr>=_r.currentWinW-tt[4]-22-36&&(Xr=_r.currentWinW-tt[4]-22-36),ea=Math.round(Xr*(tt[3]/tt[2])),(qa=tt[3]+tt[1]-ea)>tt[3]+tt[5]-1?(qa=tt[3]+tt[5]-1,ea=tt[3]+tt[1]-(tt[3]+tt[5]-1),Xr=Math.round(ea*(tt[2]/tt[3]))):qa<=0&&(qa=0,ea=tt[3]+tt[1],Xr=Math.round(ea*(tt[2]/tt[3])))):Ol=="rm"?(Xr=tt[2]+Ci)<1?Xr=1:Xr>=_r.currentWinW-tt[4]-22-36&&(Xr=_r.currentWinW-tt[4]-22-36):Ol=="rb"?((Xr=tt[2]+Ci)<1?Xr=1:Xr>=_r.currentWinW-tt[4]-22-36&&(Xr=_r.currentWinW-tt[4]-22-36),(ea=Math.round(Xr*(tt[3]/tt[2])))<1?(ea=1,Xr=Math.round(ea*(tt[2]/tt[3]))):ea>=_r.currentWinH-tt[5]-42-6&&(ea=_r.currentWinH-tt[5]-42-6,Xr=Math.round(ea*(tt[2]/tt[3])))):Ol=="mt"?(qa=Hm,ea=tt[3]-Od,qa>tt[3]+tt[5]-1?(qa=tt[3]+tt[5]-1,ea=tt[3]+tt[1]-(tt[3]+tt[5]-1)):qa<=0&&(qa=0,ea=tt[3]+tt[1])):Ol=="mb"&&((ea=tt[3]+Od)<1?ea=1:ea>=_r.currentWinH-tt[5]-42-6&&(ea=_r.currentWinH-tt[5]-42-6));$("#luckysheet-modal-dialog-activeImage").css({width:Xr,height:ea,left:Aa,top:qa});var Sy=Xr/Ks.crop.width,Iy=ea/Ks.crop.height,Qx=Math.round(Ks.default.width*Sy),ew=Math.round(Ks.default.height*Iy),tw=Math.round(Ks.crop.offsetLeft*Sy),rw=Math.round(Ks.crop.offsetTop*Iy);$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-size":Qx+"px "+ew+"px","background-position":-tw+"px "+-rw+"px"})}else if(_r.cropChange){var Ry=pa(l.pageX,l.pageY),Ey=Ry[0]+$("#luckysheet-cell-main").scrollLeft(),$y=Ry[1]+$("#luckysheet-cell-main").scrollTop();if(Ey<0||$y<0)return!1;var fl,pl,Cn,Tn,Dy=_r.cropChangeXY,zu=$y-Dy[1],Bu=Ey-Dy[0],Ir=_r.images[_r.currentImgId],bs=_r.cropChange;bs=="lt"?((Cn=Ir.crop.offsetLeft+Bu)<0&&(Cn=0),Cn>Ir.crop.width+Ir.crop.offsetLeft-1&&(Cn=Ir.crop.width+Ir.crop.offsetLeft-1),fl=Ir.crop.width+Ir.crop.offsetLeft-Cn,(Tn=Ir.crop.offsetTop+zu)<0&&(Tn=0),Tn>Ir.crop.height+Ir.crop.offsetTop-1&&(Tn=Ir.crop.height+Ir.crop.offsetTop-1),pl=Ir.crop.height+Ir.crop.offsetTop-Tn):bs=="lm"?((Cn=Ir.crop.offsetLeft+Bu)<0&&(Cn=0),Cn>Ir.crop.width+Ir.crop.offsetLeft-1&&(Cn=Ir.crop.width+Ir.crop.offsetLeft-1),fl=Ir.crop.width+Ir.crop.offsetLeft-Cn,Tn=Ir.crop.offsetTop,pl=Ir.crop.height):bs=="lb"?((Cn=Ir.crop.offsetLeft+Bu)<0&&(Cn=0),Cn>Ir.crop.width+Ir.crop.offsetLeft-1&&(Cn=Ir.crop.width+Ir.crop.offsetLeft-1),fl=Ir.crop.width+Ir.crop.offsetLeft-Cn,Tn=Ir.crop.offsetTop,(pl=Ir.crop.height+zu)<1&&(pl=1),pl>Ir.default.height-Tn&&(pl=Ir.default.height-Tn)):bs=="rt"?(Cn=Ir.crop.offsetLeft,(fl=Ir.crop.width+Bu)<1&&(fl=1),fl>Ir.default.width-Cn&&(fl=Ir.default.width-Cn),(Tn=Ir.crop.offsetTop+zu)<0&&(Tn=0),Tn>Ir.crop.height+Ir.crop.offsetTop-1&&(Tn=Ir.crop.height+Ir.crop.offsetTop-1),pl=Ir.crop.height+Ir.crop.offsetTop-Tn):bs=="rm"?(Cn=Ir.crop.offsetLeft,(fl=Ir.crop.width+Bu)<1&&(fl=1),fl>Ir.default.width-Cn&&(fl=Ir.default.width-Cn),Tn=Ir.crop.offsetTop,pl=Ir.crop.height):bs=="rb"?(Cn=Ir.crop.offsetLeft,(fl=Ir.crop.width+Bu)<1&&(fl=1),fl>Ir.default.width-Cn&&(fl=Ir.default.width-Cn),Tn=Ir.crop.offsetTop,(pl=Ir.crop.height+zu)<1&&(pl=1),pl>Ir.default.height-Tn&&(pl=Ir.default.height-Tn)):bs=="mt"?(Cn=Ir.crop.offsetLeft,fl=Ir.crop.width,(Tn=Ir.crop.offsetTop+zu)<0&&(Tn=0),Tn>Ir.crop.height+Ir.crop.offsetTop-1&&(Tn=Ir.crop.height+Ir.crop.offsetTop-1),pl=Ir.crop.height+Ir.crop.offsetTop-Tn):bs=="mb"&&(Cn=Ir.crop.offsetLeft,fl=Ir.crop.width,Tn=Ir.crop.offsetTop,(pl=Ir.crop.height+zu)<1&&(pl=1),pl>Ir.default.height-Tn&&(pl=Ir.default.height-Tn));var Fy=Ir.default.left+Cn,qy=Ir.default.top+Tn;Ir.isFixedPos&&(Fy=Ir.fixedLeft+Cn,qy=Ir.fixedTop+Tn),$("#luckysheet-modal-dialog-cropping").show().css({width:fl,height:pl,left:Fy,top:qy}),$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:Ir.default.width,height:Ir.default.height,"background-image":"url("+Ir.src+")",left:-Cn,top:-Tn}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+Ir.src+")","background-size":Ir.default.width+"px "+Ir.default.height+"px","background-position":-Cn+"px "+-Tn+"px"}),_r.cropChangeObj={width:fl,height:pl,offsetLeft:Cn,offsetTop:Tn}}else if(Lr.move){var My=pa(l.pageX,l.pageY),aw=My[0]+$("#luckysheet-cell-main").scrollLeft(),nw=My[1]+$("#luckysheet-cell-main").scrollTop(),Ny=Lr.currentObj.outerHeight(),Ly=Lr.currentObj.outerWidth(),jc=nw-Lr.moveXY[1],Gc=aw-Lr.moveXY[0];jc<0&&(jc=0),jc+Ny+42+6>Lr.currentWinH&&(jc=Lr.currentWinH-Ny-42-6),Gc<0&&(Gc=0),Gc+Ly+22+36>Lr.currentWinW&&(Gc=Lr.currentWinW-Ly-22-36),Lr.currentObj.css({left:Gc,top:jc})}else if(Lr.resize){var Py=pa(l.pageX,l.pageY),jm=Py[0]+$("#luckysheet-cell-main").scrollLeft(),Gm=Py[1]+$("#luckysheet-cell-main").scrollTop();if(jm<0||Gm<0)return!1;var sn=Lr.resizeXY,Oy=Gm-sn[1],zy=jm-sn[0],Vu=sn[5],ks=sn[3],Uu=sn[4],xs=sn[2],Si=Lr.resize;Si!="lm"&&Si!="lt"&&Si!="lb"||(Uu=jm,xs=sn[2]-zy,Uu>sn[2]+sn[4]-60?(Uu=sn[2]+sn[4]-60,xs=sn[2]-(sn[2]+sn[4]-60-sn[0])):Uu<=0&&(Uu=0,xs=sn[2]+sn[0])),Si!="rm"&&Si!="rt"&&Si!="rb"||((xs=sn[2]+zy)<60?xs=60:xs>=Lr.currentWinW-sn[4]-22-36&&(xs=Lr.currentWinW-sn[4]-22-36)),Si!="mt"&&Si!="lt"&&Si!="rt"||(Vu=Gm,ks=sn[3]-Oy,Vu>sn[3]+sn[5]-60?(Vu=sn[3]+sn[5]-60,ks=sn[3]-(sn[3]+sn[5]-60-sn[1])):Vu<=0&&(Vu=0,ks=sn[3]+sn[1])),Si!="mb"&&Si!="lb"&&Si!="rb"||((ks=sn[3]+Oy)<60?ks=60:ks>=Lr.currentWinH-sn[5]-42-6&&(ks=Lr.currentWinH-sn[5]-42-6)),Lr.currentObj.css({width:xs,height:ks,left:Uu,top:Vu})}else m.rangeResize?m.rangeResizeDraging(l,m.rangeResizeObj,m.rangeResizexy,m.rangeResize,m.rangeResizeWinW,m.rangeResizeWinH,u.ch_width,u.rh_height):m.rangeMove?m.rangeMoveDraging(l,m.rangeMovexy,m.rangeMoveObj.data("range"),m.rangeMoveObj,u.sheetBarHeight,u.statisticBarHeight):u.chart_selection.rangeResize?u.chart_selection.rangeResizeDraging(l,u.sheetBarHeight,u.statisticBarHeight):u.chart_selection.rangeMove&&u.chart_selection.rangeMoveDraging(l,u.sheetBarHeight,u.statisticBarHeight);u.jfautoscrollTimeout=window.requestAnimationFrame(St)}))}),$(document).on("mouseup.luckysheetEvent",function(l){if(Nt&&Nt.hook&&Nt.hook.sheetMouseup){var o=pa(l.pageX,l.pageY),d=o[0]+$("#luckysheet-cell-main").scrollLeft(),s=Wa(o[1]+$("#luckysheet-cell-main").scrollTop()),h=s[1],f=s[0],p=s[2],g=ja(d),v=g[1],y=g[0],b=g[2],k=dr.mergeborer(u.flowdata,p,b);k&&(h=k.row[1],f=k.row[0],p=k.row[2],v=k.column[1],y=k.column[0],b=k.column[2]);var w=ir.getSheetByIndex(),_={functionResizeStatus:m.functionResizeStatus,horizontalmoveState:!!Ne.horizontalmovestate,verticalmoveState:!!Ne.verticalmovestate,pivotTableMoveState:!!Pr&&Pr.movestate,sheetMoveStatus:u.luckysheet_sheet_move_status,scrollStatus:!!u.luckysheet_scroll_status,selectStatus:!!u.luckysheet_select_status,rowsSelectedStatus:!!u.luckysheet_rows_selected_status,colsSelectedStatus:!!u.luckysheet_cols_selected_status,cellSelectedMove:!!u.luckysheet_cell_selected_move,cellSelectedExtend:!!u.luckysheet_cell_selected_extend,colsChangeSize:!!u.luckysheet_cols_change_size,rowsChangeSize:!!u.luckysheet_rows_change_size,chartMove:!!u.chartparam.luckysheetCurrentChartMove,chartResize:!!u.chartparam.luckysheetCurrentChartResize,rangeResize:!!m.rangeResize,rangeMove:!!m.rangeMove},C=$("#luckysheetTableContent").get(0).getContext("2d");Ya.createHookFunction("sheetMouseup",u.flowdata[p][b],{r:p,c:b,start_r:f,start_c:y,end_r:h,end_c:v},w,_,C)}if(u.luckysheet_select_status&&(clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},0),dr.luckysheetPaintModelOn&&(Ba.pasteHandlerOfPaintModel(u.luckysheet_copy_save),dr.luckysheetPaintSingle&&dr.cancelPaintModel())),u.luckysheet_select_status=!1,window.cancelAnimationFrame(u.jfautoscrollTimeout),u.luckysheet_scroll_status=!1,$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),u.luckysheet_rows_selected_status=!1,u.luckysheet_cols_selected_status=!1,u.luckysheet_model_move_state=!1,m.functionResizeStatus&&(m.functionResizeStatus=!1,$("#luckysheet-wa-calculate-size").removeAttr("style")),Ne.horizontalmovestate&&(Ne.horizontalmovestate=!1,$("#luckysheet-freezebar-horizontal").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grab"),Ne.freezenhorizontaldata[4]<=u.columnHeaderHeight&&Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.verticalmovestate&&(Ne.verticalmovestate=!1,$("#luckysheet-freezebar-vertical").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grab"),Ne.freezenverticaldata[4]<=u.rowHeaderWidth&&Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Pr&&Pr.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").remove(),Pr.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),Pr.movesave.containerid!="luckysheet-modal-dialog-pivotTable-list"&&$(l.target).closest(".luckysheet-modal-dialog-slider-config-list").length==0&&(Pr.movesave.containerid=="luckysheet-modal-dialog-config-value"&&Pr.resetOrderby(Pr.movesave.obj),Pr.movesave.obj.remove(),Pr.showvaluecolrow(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){var Mr=$(this).data("index");$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){var Qn=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==Mr&&Qn.find("i").length==0&&Qn.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')})}),Pr.refreshPivotTable())),u.luckysheet_sheet_move_status&&(u.luckysheet_sheet_move_status=!1,u.luckysheet_sheet_move_data.activeobject.insertBefore($("#luckysheet-sheets-item-clone")),u.luckysheet_sheet_move_data.activeobject.removeAttr("style"),$("#luckysheet-sheets-item-clone").remove(),u.luckysheet_sheet_move_data.cursorobject.css({cursor:"pointer"}),u.luckysheet_sheet_move_data={},ir.reOrderAllSheet()),clearTimeout(u.chartparam.luckysheetCurrentChartMoveTimeout),u.chartparam.luckysheetCurrentChartMove&&(u.chartparam.luckysheetCurrentChartMove=!1,u.chartparam.luckysheetInsertChartTosheetChange)){var A=u.chartparam.luckysheetCurrentChartMoveObj.css("top"),I=u.chartparam.luckysheetCurrentChartMoveObj.css("left"),S=$("#luckysheet-cell-main").scrollLeft(),E=$("#luckysheet-cell-main").scrollTop(),R=u.chartparam.luckysheetCurrentChartMoveXy[2],F=u.chartparam.luckysheetCurrentChartMoveXy[3],N=u.chartparam.luckysheetCurrentChartMoveXy[4],z=u.chartparam.luckysheetCurrentChartMoveXy[5],P=u.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id");u.jfredo.push({type:"moveChart",chart_id:P,sheetIndex:u.currentSheetIndex,myTop:A,myLeft:I,scrollTop:E,scrollLeft:S,x:R,y:F,scrollTop1:z,scrollLeft1:N})}if(u.chartparam.luckysheetCurrentChartResize&&(u.chartparam.luckysheetCurrentChartResize=null,u.chartparam.luckysheetInsertChartTosheetChange)){var q=u.chartparam.luckysheetCurrentChartResizeObj.height(),V=u.chartparam.luckysheetCurrentChartResizeObj.width(),x=(S=$("#luckysheet-cell-main").scrollLeft(),E=$("#luckysheet-cell-main").scrollTop(),A=u.chartparam.luckysheetCurrentChartMoveObj.css("top"),I=u.chartparam.luckysheetCurrentChartMoveObj.css("left"),P=u.chartparam.luckysheetCurrentChartResizeObj.find(".luckysheet-modal-dialog-content").attr("id"),u.chartparam.luckysheetCurrentChartResizeXy[2]),ee=u.chartparam.luckysheetCurrentChartResizeXy[3];R=u.chartparam.luckysheetCurrentChartResizeXy[4],F=u.chartparam.luckysheetCurrentChartResizeXy[5],N=u.chartparam.luckysheetCurrentChartResizeXy[6],z=u.chartparam.luckysheetCurrentChartResizeXy[7],u.jfredo.push({type:"resizeChart",chart_id:P,sheetIndex:u.currentSheetIndex,myTop:A,myLeft:I,myHeight:q,myWidth:V,scrollTop:E,scrollLeft:S,x:R,y:F,myWidth1:x,myHeight1:ee,scrollTop1:z,scrollLeft1:N})}if(m.rangeResize&&m.rangeResizeDragged(l,m.rangeResizeObj,m.rangeResize,m.rangeResizexy,m.rangeResizeWinW,m.rangeResizeWinH),_r.move&&_r.moveImgItem(),_r.resize&&_r.resizeImgItem(),_r.cropChange&&_r.cropChangeImgItem(),Lr.move){Lr.move=!1;var ne=Lr.currentObj.closest(".luckysheet-postil-show").attr("id"),ae=ne.split("luckysheet-postil-show_")[1].split("_")[0],de=ne.split("luckysheet-postil-show_")[1].split("_")[1],ve=vr.deepCopyFlowData(u.flowdata),U=[];ve[ae][de].ps.left=Lr.currentObj.position().left,ve[ae][de].ps.top=Lr.currentObj.position().top,ve[ae][de].ps.value=Lr.currentObj.find(".formulaInputFocus").text(),U.push(ae+"_"+de),Lr.ref(ve,U),$("#"+ne).remove(),ve[ae][de].ps.isshow?(Lr.buildPs(ae,de,ve[ae][de].ps),$("#"+ne).addClass("luckysheet-postil-show-active"),$("#"+ne).find(".luckysheet-postil-dialog-resize").show()):Lr.editPs(ae,de)}if(Lr.resize){Lr.resize=null;var B=Lr.currentObj.closest(".luckysheet-postil-show").attr("id"),le=B.split("luckysheet-postil-show_")[1].split("_")[0],Te=B.split("luckysheet-postil-show_")[1].split("_")[1],ue=vr.deepCopyFlowData(u.flowdata),be=[];ue[le][Te].ps.left=Lr.currentObj.position().left,ue[le][Te].ps.top=Lr.currentObj.position().top,ue[le][Te].ps.width=Lr.currentObj.outerWidth(),ue[le][Te].ps.height=Lr.currentObj.outerHeight(),ue[le][Te].ps.value=Lr.currentObj.find(".formulaInputFocus").text(),be.push(le+"_"+Te),Lr.ref(ue,be),$("#"+B).remove(),ue[le][Te].ps.isshow?(Lr.buildPs(le,Te,ue[le][Te].ps),$("#"+B).addClass("luckysheet-postil-show-active"),$("#"+B).find(".luckysheet-postil-dialog-resize").show()):Lr.editPs(le,Te)}if(u.luckysheet_rows_change_size){u.luckysheet_rows_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-rows-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","default");var ye=pa(l.pageX,l.pageY),ce=$("#luckysheet-rows-h").scrollTop(),Re=ye[1]+ce,pe=$(window).height(),me=Wa(Re),re=(me[1],me[0],me[2],Re+3-u.luckysheet_rows_change_size_start[0]);Re+3-u.luckysheet_rows_change_size_start[0]<19&&(re=19),Re>=pe-200+ce&&(re=pe-200-u.luckysheet_rows_change_size_start[0]+ce);var _e=$.extend(!0,{},u.config);_e.rowlen==null&&(_e.rowlen={}),_e.customHeight==null&&(_e.customHeight={}),_e.customHeight[u.luckysheet_rows_change_size_start[1]]=1;var Ze=u.luckysheet_rows_change_size_start[1],We=!1;u.luckysheet_select_save.length>0&&u.luckysheet_select_save.filter(function(Mr){return Mr.row_select}).some(function(Mr){return Ze>=Mr.row[0]&&Ze<=Mr.row[1]&&(We=!0),We}),We?u.luckysheet_select_save.filter(function(Mr){return Mr.row_select}).forEach(function(Mr){for(var Qn=Mr.row[0];Qn<=Mr.row[1];Qn++)_e.rowlen[Qn]=Math.ceil(re/u.zoomRatio)}):_e.rowlen[u.luckysheet_rows_change_size_start[1]]=Math.ceil(re/u.zoomRatio);var Xe=_r.moveChangeSize("row",u.luckysheet_rows_change_size_start[1],re);u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"resize",ctrlType:"resizeR",sheetIndex:u.currentSheetIndex,config:$.extend(!0,{},u.config),curconfig:$.extend(!0,{},_e),images:$.extend(!0,{},_r.images),curImages:$.extend(!0,{},Xe)})),u.config=_e,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,_e.rowlen,{k:"rowlen"}),u.luckysheetfile[je(u.currentSheetIndex)].images=Xe,nt.saveParam("all",u.currentSheetIndex,Xe,{k:"images"}),_r.images=Xe,_r.allImagesShow(),ln(u.flowdata.length,null)}if(u.luckysheet_cols_change_size){u.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");var Ue=pa(l.pageX,l.pageY),mt=$("#luckysheet-cols-h-c").scrollLeft(),St=Ue[0]+mt,at=$(window).width(),dt=u.visibledatarow.length-1,wt=(u.visibledatarow[dt],ja(St)),ct=(wt[1],wt[0],wt[2],St+3-u.luckysheet_cols_change_size_start[0]),bt=u.defaultcollen;if(u.config.columnlen!=null&&u.config.columnlen[u.luckysheet_cols_change_size_start[1]]!=null&&(bt=u.config.columnlen[u.luckysheet_cols_change_size_start[1]]),Math.abs(ct-bt)<3)return;St+3-u.luckysheet_cols_change_size_start[0]<30&&(ct=30),St>=at-100+mt&&(ct=at-100-u.luckysheet_cols_change_size_start[0]+mt);var De=$.extend(!0,{},u.config);De.columnlen==null&&(De.columnlen={}),De.customWidth==null&&(De.customWidth={}),De.customWidth[u.luckysheet_cols_change_size_start[1]]=1;var He=u.luckysheet_cols_change_size_start[1],Dt=!1;u.luckysheet_select_save.length>0&&u.luckysheet_select_save.filter(function(Mr){return Mr.column_select}).some(function(Mr){return He>=Mr.column[0]&&He<=Mr.column[1]&&(Dt=!0),Dt}),Dt?u.luckysheet_select_save.filter(function(Mr){return Mr.column_select}).forEach(function(Mr){for(var Qn=Mr.column[0];Qn<=Mr.column[1];Qn++)De.columnlen[Qn]=Math.ceil(ct/u.zoomRatio)}):De.columnlen[u.luckysheet_cols_change_size_start[1]]=Math.ceil(ct/u.zoomRatio);var et=_r.moveChangeSize("column",u.luckysheet_cols_change_size_start[1],ct);u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"resize",ctrlType:"resizeC",sheetIndex:u.currentSheetIndex,config:$.extend(!0,{},u.config),curconfig:$.extend(!0,{},De),images:$.extend(!0,{},_r.images),curImages:$.extend(!0,{},et)})),u.config=De,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,De.columnlen,{k:"columnlen"}),u.luckysheetfile[je(u.currentSheetIndex)].images=et,nt.saveParam("all",u.currentSheetIndex,et,{k:"images"}),_r.images=et,_r.allImagesShow(),ln(null,u.flowdata[0].length),setTimeout(function(){Kr()},1)}if(m.rangeMove&&m.rangeMoveDragged(m.rangeMoveObj),u.luckysheet_cell_selected_move){$("#luckysheet-cell-selected-move").hide(),u.luckysheet_cell_selected_move=!1;var ur=pa(l.pageX,l.pageY);if(!wo(u.luckysheet_select_save,u.currentSheetIndex))return;var Xt=$("#luckysheet-cell-main").scrollLeft(),jt=$("#luckysheet-cell-main").scrollTop(),lr=ur[0]+Xt,tr=ur[1]+jt,xr=$(window).height()+jt-u.sheetBarHeight-u.statisticBarHeight,rr=$(window).width()+Xt,nr=Wa(tr)[2],Ut=ja(lr)[2],ar=u.luckysheet_cell_selected_move_index[0],Jt=u.luckysheet_cell_selected_move_index[1];if(nr==ar&&Ut==Jt)return;var Qt=vr.deepCopyFlowData(u.flowdata),_t=u.luckysheet_select_save[u.luckysheet_select_save.length-1],er=nn(_t),Kt=$.extend(!0,{},u.config);if(Kt.merge==null&&(Kt.merge={}),Kt.rowlen==null&&(Kt.rowlen={}),mn(Kt,_t.row[0],_t.row[1],_t.column[0],_t.column[1]))return void(Rt()?alert(t.noMerge):Ee.info('<i class="fa fa-exclamation-triangle"></i>',t.noMerge));var mr=_t.row[0]-ar+nr,fr=_t.row[1]-ar+nr,Wt=_t.column[0]-Jt+Ut,ze=_t.column[1]-Jt+Ut;if(!wo([{row:[mr,fr],column:[Wt,ze]}],u.currentSheetIndex))return;if((mr<0||tr<0)&&(mr=0,fr=_t.row[1]-_t.row[0]),(Wt<0||lr<0)&&(Wt=0,ze=_t.column[1]-_t.column[0]),(fr>=u.visibledatarow[u.visibledatarow.length-1]||tr>xr)&&(mr=u.visibledatarow.length-1-_t.row[1]+_t.row[0],fr=u.visibledatarow.length-1),(ze>=u.visibledatacolumn[u.visibledatacolumn.length-1]||lr>rr)&&(Wt=u.visibledatacolumn.length-1-_t.column[1]+_t.column[0],ze=u.visibledatacolumn.length-1),mn(Kt,mr,fr,Wt,ze))return void(Rt()?alert(t.noMerge):Ee.info('<i class="fa fa-exclamation-triangle"></i>',t.noMerge));for(var Ae=Ps(u.currentSheetIndex),Ve=null,gt=_t.row[0];gt<=_t.row[1];gt++){gt in Kt.rowlen&&(Ve=!0);for(var vt=_t.column[0];vt<=_t.column[1];vt++){var pt=Qt[gt][vt];D(pt)=="object"&&"mc"in pt&&pt.mc.r+"_"+pt.mc.c in Kt.merge&&delete Kt.merge[pt.mc.r+"_"+pt.mc.c],Qt[gt][vt]=null}}if(Kt.borderInfo&&Kt.borderInfo.length>0){for(var Tt=[],Ot=0;Ot<Kt.borderInfo.length;Ot++){var It=Kt.borderInfo[Ot].rangeType;if(It=="range"){for(var Lt=Kt.borderInfo[Ot].range,At=[],or=0;or<Lt.length;or++)At=At.concat(kr.CFSplitRange(Lt[or],{row:_t.row,column:_t.column},{row:[mr,fr],column:[Wt,ze]},"restPart"));Kt.borderInfo[Ot].range=At,Tt.push(Kt.borderInfo[Ot])}else if(It=="cell"){var Cr=Kt.borderInfo[Ot].value.row_index,Ar=Kt.borderInfo[Ot].value.col_index;Cr>=_t.row[0]&&Cr<=_t.row[1]&&Ar>=_t.column[0]&&Ar<=_t.column[1]||Tt.push(Kt.borderInfo[Ot])}}Kt.borderInfo=Tt}for(var Rr={},Zr=0;Zr<er.length;Zr++)for(var Tr=0;Tr<er[0].length;Tr++){if(Ae[Zr+_t.row[0]+"_"+(Tr+_t.column[0])]){var jr={rangeType:"cell",value:{row_index:Zr+mr,col_index:Tr+Wt,l:Ae[Zr+_t.row[0]+"_"+(Tr+_t.column[0])].l,r:Ae[Zr+_t.row[0]+"_"+(Tr+_t.column[0])].r,t:Ae[Zr+_t.row[0]+"_"+(Tr+_t.column[0])].t,b:Ae[Zr+_t.row[0]+"_"+(Tr+_t.column[0])].b}};Kt.borderInfo==null&&(Kt.borderInfo=[]),Kt.borderInfo.push(jr)}var ta="";if(er[Zr]!=null&&er[Zr][Tr]!=null&&(ta=er[Zr][Tr]),D(ta)=="object"&&"mc"in ta){var ia=$.extend(!0,{},ta.mc);"rs"in ta.mc?(Rr[ia.r+"_"+ia.c]=[Zr+mr,Tr+Wt],ta.mc.r=Zr+mr,ta.mc.c=Tr+Wt,Kt.merge[Zr+mr+"_"+(Tr+Wt)]=ta.mc):(ta.mc.r=Rr[ia.r+"_"+ia.c][0],ta.mc.c=Rr[ia.r+"_"+ia.c][1])}Qt[Zr+mr][Tr+Wt]=ta}Ve&&(Kt=Yl(Qt,_t.row[0],_t.row[1],Kt),Kt=Yl(Qt,mr,fr,Kt));var Jr,ba,Wr=$.extend(!0,[],u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save);if(Wr!=null&&Wr.length>0)for(var Fr=0;Fr<Wr.length;Fr++){for(var oa=Wr[Fr].cellrange,Fa=[],Da=0;Da<oa.length;Da++){var va=kr.CFSplitRange(oa[Da],{row:_t.row,column:_t.column},{row:[mr,fr],column:[Wt,ze]},"allPart");Fa=Fa.concat(va)}Wr[Fr].cellrange=Fa}Jr=u.luckysheet_select_save[0].row_focus==u.luckysheet_select_save[0].row[0]?mr:fr,ba=u.luckysheet_select_save[0].column_focus==u.luckysheet_select_save[0].column[0]?Wt:ze;var Ha=[];Ha.push({row:_t.row,column:_t.column}),Ha.push({row:[mr,fr],column:[Wt,ze]}),_t.row=[mr,fr],_t.column=[Wt,ze],_t.row_focus=Jr,_t.column_focus=ba,wa(Qt,Ha,{cfg:Kt,RowlChange:Ve,cdformat:Wr}),Ra(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500)}if(u.chart_selection.rangeMove&&u.chart_selection.rangeMoveDragged(),u.chart_selection.rangeResize&&u.chart_selection.rangeResizeDragged(),u.luckysheet_cell_selected_extend){if(u.luckysheet_cell_selected_extend=!1,$("#luckysheet-cell-selected-extend").hide(),!wo(u.luckysheet_select_save,u.currentSheetIndex))return;var qr=pa(l.pageX,l.pageY),Ca=$("#luckysheet-cell-main").scrollLeft(),La=$("#luckysheet-cell-main").scrollTop(),Ea=qr[0]+Ca-5,Za=qr[1]+La-5,gn=$(window).height()+La-u.sheetBarHeight-u.statisticBarHeight,Ka=$(window).width()+Ca,ka=Wa(Za),Pa=(ka[1],ka[0]),$a=ka[2],on=ja(Ea),Dn=(on[1],on[0]),Fn=on[2],_n=u.luckysheet_cell_selected_extend_index[0],dl=u.luckysheet_cell_selected_extend_index[1],Or=u.luckysheet_select_save[u.luckysheet_select_save.length-1],en=Or.row[0],hn=Or.row[1],tn=Or.column[0],Sn=Or.column[1];(en<0||Za<0)&&(en=0,hn=Or.row[1]-Or.row[0]),(tn<0||Ea<0)&&(tn=0,Sn=Or.column[1]-Or.column[0]),(hn>=u.visibledatarow[u.visibledatarow.length-1]||Za>gn)&&(en=u.visibledatarow.length-1-Or.row[1]+Or.row[0],hn=u.visibledatarow.length-1),(Sn>=u.visibledatacolumn[u.visibledatacolumn.length-1]||Ea>Ka)&&(tn=u.visibledatacolumn.length-1-Or.column[1]+Or.column[0],Sn=u.visibledatacolumn.length-1),Mn.copyRange={row:$.extend(!0,[],Or.row),column:$.extend(!0,[],Or.column)};var vn=Mn.typeItemHide();if(vn[0]||vn[1]||vn[2]||vn[3]||vn[4]||vn[5]||vn[6]?Mn.applyType="1":Mn.applyType="0",Math.abs(_n-$a)>Math.abs(dl-Fn)){if($a>=en&&$a<=hn)return;if(u.luckysheet_select_save[0].top_move>=Pa){if(Mn.applyRange={row:[$a,Or.row[0]-1],column:Or.column},Mn.direction="up",en-=Or.row[0]-$a,Pr.isPivotRange(en,Sn))return void Ee.info(t.affectPivot,"")}else if(Mn.applyRange={row:[Or.row[1]+1,$a],column:Or.column},Mn.direction="down",hn+=$a-Or.row[1],Pr.isPivotRange(hn,Sn))return void Ee.info(t.affectPivot,"")}else{if(Fn>=tn&&Fn<=Sn)return;if(u.luckysheet_select_save[0].left_move>=Dn){if(Mn.applyRange={row:Or.row,column:[Fn,Or.column[0]-1]},Mn.direction="left",tn-=Or.column[0]-Fn,Pr.isPivotRange(hn,tn))return void Ee.info(t.affectPivot,"")}else if(Mn.applyRange={row:Or.row,column:[Or.column[1]+1,Fn]},Mn.direction="right",Sn+=Fn-Or.column[1],Pr.isPivotRange(hn,Sn))return void Ee.info(t.affectPivot,"")}if(u.config.merge!=null){for(var Kn=!1,ni=Or.row[0];ni<=Or.row[1];ni++)for(var Jn=Or.column[0];Jn<=Or.column[1];Jn++){var li=u.flowdata[ni][Jn];if(li!=null&&li.mc!=null){Kn=!0;break}}if(Kn)return void(Rt()?alert(t.noMerge):Ee.info(t.noMerge,""));for(var Ma=en;Ma<=hn;Ma++)for(var nl=tn;nl<=Sn;nl++){var Pn=u.flowdata[Ma][nl];if(Pn!=null&&Pn.mc!=null){Kn=!0;break}}if(Kn)return void(Rt()?alert(t.noMerge):Ee.info(t.noMerge,""))}Or.row=[en,hn],Or.column=[tn,Sn],Mn.update(),Mn.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500)}}),$(".luckysheet-grid-container, #luckysheet-rightclick-menu").on("contextmenu",function(l){l.preventDefault()}),$("#luckysheet-cell-main div.luckysheet-cs-draghandle").mousedown(function(l){if(!Rt()&&u.allowEdit!==!1){$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","move").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","move"),u.luckysheet_cell_selected_move=!0,u.luckysheet_scroll_status=!0;var o=pa(l.pageX,l.pageY),d=o[0]+$("#luckysheet-cell-main").scrollLeft(),s=Wa(o[1]+$("#luckysheet-cell-main").scrollTop()),h=s[0],f=s[1],p=s[2],g=ja(d),v=g[0],y=g[1],b=g[2];u.luckysheet_cell_selected_move_index=[p,b],$("#luckysheet-cell-selected-move").css({left:v,width:y-v-1,top:h,height:f-h-1,display:"block"}),l.stopPropagation()}}),$("#luckysheet-cell-main div.luckysheet-cs-fillhandle").mousedown(function(l){Rt()||u.allowEdit===!1||($("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","crosshair"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","crosshair"),u.luckysheet_cell_selected_extend_time=setTimeout(function(){u.luckysheet_cell_selected_extend=!0,u.luckysheet_scroll_status=!0;var o=pa(l.pageX,l.pageY),d=o[0]+$("#luckysheet-cell-main").scrollLeft()-5,s=Wa(o[1]+$("#luckysheet-cell-main").scrollTop()-5),h=s[0],f=s[1],p=s[2],g=ja(d),v=g[0],y=g[1],b=g[2];u.luckysheet_cell_selected_extend_index=[p,b],$("#luckysheet-cell-selected-extend").css({left:v,width:y-v-1,top:h,height:f-h-1,display:"block"})},100),l.stopPropagation())}).click(function(){clearTimeout(u.luckysheet_cell_selected_extend_time),event.stopPropagation()}).dblclick(function(){var l=u.luckysheet_select_save[0],o=l.row[0],d=l.row[1],s=l.column[0],h=l.column[1];if(!Pr.isPivotRange(o,s)){for(var f=!1,p=0,g=d+1;g<u.flowdata.length;g++)if(s-1>=0&&h+1<u.flowdata[0].length){var v=u.flowdata[g][s-1],y=u.flowdata[g][h+1];if(g==d+1){if((v==null||$t(v.v))&&(y==null||$t(y.v))){f=!1;break}f=!0,p++}else{if((v==null||$t(v.v))&&(y==null||$t(y.v)))break;p++}}else if(s-1>=0){var b=u.flowdata[g][s-1];if(g==d+1){if(b==null||$t(b.v)){f=!1;break}f=!0,p++}else{if(b==null||$t(b.v))break;p++}}else if(h+1<u.flowdata[0].length){var k=u.flowdata[g][h+1];if(g==d+1){if(k==null||$t(k.v)){f=!1;break}f=!0,p++}else{if(k==null||$t(k.v))break;p++}}if(f&&p!=0){Mn.copyRange={row:[o,d],column:[s,h]};var w=Mn.typeItemHide();w[0]||w[1]||w[2]||w[3]||w[4]||w[5]||w[6]?Mn.applyType="1":Mn.applyType="0",Mn.applyRange={row:[d+1,d+p],column:[s,h]},Mn.direction="down",u.luckysheet_select_save=[{row:[o,d+p],column:[s,h]}],Mn.update(),Mn.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500),event.stopPropagation()}else event.stopPropagation()}}),$("#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top").on("mousedown dblclick mouseup",function(l){l.stopPropagation()}),$("#luckysheet-bottom-add-row").on("click",function(l){$("#luckysheet-rightclick-menu").hide(),la(),$(this);var o=$("#luckysheet-bottom-add-row-input").val();o==""&&(o=100),isNaN(parseInt(o))?Rt()?alert(a.tipInputNumber):Ee.info("error",a.tipInputNumber):(o=parseInt(o))<1||o>100?Rt()?alert(a.tipInputNumberLimit):Ee.info("error",a.tipInputNumberLimit):Ls("row",u.flowdata.length-1,o)}),$("#luckysheet-bottom-return-top").on("click",function(l){$("#luckysheet-scrollbar-y").scrollTop(0)}),$("#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title").click(function(l){if($(this).parent().hide(),u.config.merge!=null){for(var o=!1,d=0;d<u.luckysheet_select_save.length;d++){var s=u.luckysheet_select_save[d].row[0],h=u.luckysheet_select_save[d].row[1],f=u.luckysheet_select_save[d].column[0],p=u.luckysheet_select_save[d].column[1];if(o=mn(u.config,s,h,f,p))break}if(o)return void(Rt()?alert(t.noPartMerge):Ee.info(t.noPartMerge,""))}var g=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save;if(u.luckysheet_select_save.length>1&&g!=null&&g.length>0){var v=!1,y=kr.getComputeMap();e:for(var b=0;b<u.luckysheet_select_save.length&&!v;b++)for(var k=u.luckysheet_select_save[b].row[0],w=u.luckysheet_select_save[b].row[1],_=u.luckysheet_select_save[b].column[0],C=u.luckysheet_select_save[b].column[1],A=k;A<=w;A++)for(var I=_;I<=C;I++)if(kr.checksCF(A,I,y)!=null){v=!0;continue e}if(v)return void(Rt()?alert(t.noMulti):Ee.info(t.noMulti,""))}if(u.luckysheet_select_save.length>1){for(var S=!0,E=u.luckysheet_select_save[0].row[0],R=u.luckysheet_select_save[0].row[1],F=!0,N=u.luckysheet_select_save[0].column[0],z=u.luckysheet_select_save[0].column[1],P=1;P<u.luckysheet_select_save.length;P++)u.luckysheet_select_save[P].row[0]==E&&u.luckysheet_select_save[P].row[1]==R||(S=!1),u.luckysheet_select_save[P].column[0]==N&&u.luckysheet_select_save[P].column[1]==z||(F=!1);if(!S&&!F||Vs())return void(Rt()?alert(t.noMulti):Ee.info(t.noMulti,""))}Ba.copy(l)}),$("#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title").click(function(l){Ba.paste(l,"btn"),$(this).parent().hide()}),$("#luckysheet-chart-btn-title").click(function(){xg()}),$("#luckysheetdatavisual").click(function(){xg(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-pivot-btn-title").click(function(l){dn(u.currentSheetIndex,"usePivotTablereports")&&Pr.createPivotTable(l)}),$("#luckysheet-chart-btn-screenshot").click(function(){var l=n.screenshot;if(u.luckysheet_select_save.length!=0)if(u.luckysheet_select_save.length>1)Rt()?alert(l.screenshotTipHasMulti):Ee.info(l.screenshotTipTitle,l.screenshotTipHasMulti);else{if(u.config.merge!=null){for(var o=!1,d=0;d<u.luckysheet_select_save.length;d++){var s=u.luckysheet_select_save[d].row[0],h=u.luckysheet_select_save[d].row[1],f=u.luckysheet_select_save[d].column[0],p=u.luckysheet_select_save[d].column[1];if(o=mn(u.config,s,h,f,p))break}if(o)return void(Rt()?alert(l.screenshotTipHasMerge):Ee.info(l.screenshotTipTitle,l.screenshotTipHasMerge))}var g,v,y,b,k=u.luckysheet_select_save[0].row[0],w=u.luckysheet_select_save[0].row[1],_=u.luckysheet_select_save[0].column[0],C=u.luckysheet_select_save[0].column[1];k-1<0?(g=0,v=u.visibledatarow[w]):(g=u.visibledatarow[k-1],v=u.visibledatarow[w]-u.visibledatarow[k-1]),_-1<0?(y=0,b=u.visibledatacolumn[C]):(y=u.visibledatacolumn[_-1],b=u.visibledatacolumn[C]-u.visibledatacolumn[_-1]);var A=$("<canvas>").attr({width:Math.ceil(b*devicePixelRatio),height:Math.ceil(v*devicePixelRatio)}).css({width:b,height:v});Mi(y,g,b,v,1,1,null,null,A);var I=A.get(0).getContext("2d");I.beginPath(),I.moveTo(0,0),I.lineTo(0,u.devicePixelRatio*v),I.lineWidth=2*u.devicePixelRatio,I.strokeStyle=Fi,I.stroke(),I.closePath(),I.beginPath(),I.moveTo(0,0),I.lineTo(u.devicePixelRatio*b,0),I.lineWidth=2*u.devicePixelRatio,I.strokeStyle=Fi,I.stroke(),I.closePath();var S=new Image,E=A.get(0).toDataURL("image/png");S.src=E,b>v?S.style.width="100%":S.style.height="100%";var R=$(window).height()-200;Ee.screenshot(l.screenshotTipSuccess,'<div id="luckysheet-confirm-screenshot-save" style="height:'+R+'px;overflow:auto;"></div>',E),$("#luckysheet-confirm-screenshot-save").append(S),A.remove()}else Rt()?alert(l.screenshotTipNoSelection):Ee.info(l.screenshotTipTitle,l.screenshotTipNoSelection)}),$(document).on("click.luckysheetEvent","a.download",function(){for(var l=$("#luckysheet-confirm-screenshot-save img").attr("src"),o=n.screenshot,d=atob(l.split(",")[1]),s=d.length,h=new Uint8Array(s),f=0;f<s;f++)h[f]=d.charCodeAt(f);var p,g=new Blob([h]),v=document.createElement("a");v.setAttribute("href",URL.createObjectURL(g)),v.setAttribute("download",o.screenshotImageName+".png"),v.style.display="none",document.body.appendChild(v),v.click(),v.addEventListener("click",p=function(){requestAnimationFrame(function(){URL.revokeObjectURL(v.href)}),v.removeAttribute("href"),v.removeEventListener("click",p)}),document.body.removeChild(v)}),$("#luckysheet-splitColumn-btn-title").click(function(){if(Os(u.currentSheetIndex)&&u.luckysheet_select_save!=null&&u.luckysheet_select_save.length!=0){var l=n.splitText;u.luckysheet_select_save.length>1?Ee.info(l.tipNoMulti,""):u.luckysheet_select_save[0].column[0]==u.luckysheet_select_save[0].column[1]?(fy.createDialog(),fy.init()):Ee.info(l.tipNoMultiColumn,"")}}),$("#luckysheet-insertImg-btn-title").click(function(){dn(u.currentSheetIndex,"editObjects")&&$("#luckysheet-imgUpload").click()}),$("#luckysheetInsertImage").click(function(){dn(u.currentSheetIndex,"editObjects")&&($("#luckysheet-imgUpload").click(),$("#luckysheet-rightclick-menu").hide())}),$("#luckysheet-imgUpload").click(function(l){l.stopPropagation()}),$("#luckysheet-imgUpload").on("change",function(l){if(dn(u.currentSheetIndex,"editObjects",!1)){var o=l.currentTarget.files[0],d=new FileReader;d.readAsDataURL(o),d.onload=function(s){var h=s.target.result;_r.inserImg(h),$("#luckysheet-imgUpload").val("")}}}),$("#luckysheet-insertLink-btn-title").click(function(){Os(u.currentSheetIndex)&&u.luckysheet_select_save!=null&&u.luckysheet_select_save.length!=0&&(Jl.createDialog(),Jl.init())}),$("#luckysheetInsertLink").click(function(){$("#luckysheet-insertLink-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-dataVerification-btn-title").click(function(){Os(u.currentSheetIndex)&&u.luckysheet_select_save!=null&&u.luckysheet_select_save.length!=0&&(aa.createDialog(),aa.init())}),$("#luckysheetDataVerification").click(function(){$("#luckysheet-dataVerification-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheetCellFormatRightClickMenu").click(function(){(function(){Nx();var l=st(),o=l.cellFormat;if(l.button,$("#luckysheet-rightclick-menu").hide(),Os(u.currentSheetIndex)){var d=!1,s=!1,h=0,f=0,p=0;if(u.luckysheet_select_save!=null&&u.luckysheet_select_save.length>0){gy(function(y){y!=null&&y.lo!=null&&y.lo!=1||(d=!0,h++),y!=null&&y.hi==1&&(s=!0,f++),p++},function(){d=!0});var g="",v="";d&&(g=h==p?o.tipsAll:o.tipsPart),s&&(v=f==p?o.tipsAll:o.tipsPart),$("#luckysheet-protection-check-locked").prop("checked",d).parent().next().html(g),$("#luckysheet-protection-check-hidden").prop("checked",s).parent().next().html(v),Ec("luckysheet-cellFormat-config")}else alert(o.selectionIsNullAlert)}})()}),$("#luckysheet-freezen-btn-horizontal").click(function(){$.trim($(this).text())==st().freezen.freezenCancel?(Ne.saveFrozen("freezenCancel"),Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.freezenhorizontaldata!=null&&(Ne.cancelFreezenHorizontal(),Ne.createAssistCanvas(),Kr()),Ne.scrollAdapt()):(Ne.saveFrozen("freezenRow"),Ne.freezenverticaldata!=null&&(Ne.cancelFreezenVertical(),Ne.createAssistCanvas(),Kr()),Ne.freezenhorizontaldata==null&&(Ne.createFreezenHorizontal(),Ne.createAssistCanvas()))}),$("#luckysheet-freezen-btn-vertical").click(function(){Ne.freezenverticaldata!=null?(Ne.saveFrozen("freezenCancel"),Ne.cancelFreezenVertical(),Kr()):(Ne.saveFrozen("freezenColumn"),Ne.createFreezenVertical()),Ne.createAssistCanvas()}),$("#luckysheet-rightclick-menu input").on("keydown",function(l){l.stopPropagation()}),$("#luckysheet-modal-dialog-mask").on("click dbclick mousedown mousemove mouseup",function(l){l.stopPropagation(),l.preventDefault()}),$(document).on("visibilitychange.luckysheetEvent webkitvisibilitychange.luckysheetEvent msvisibilitychange.luckysheetEvent",function(){(document.hidden||document.webkitHidden||document.msHidden)&&(u.iscopyself=!1)}).on("mouseleave.luckysheetEvent",function(){u.iscopyself=!1}).on("mousedown.luckysheetEvent",function(l){Lr.removeActivePs(),Ji(l),$(l.target).closest("#luckysheet-wa-editor").length>0&&parseInt($("#luckysheet-input-box").css("top"))>0&&(console.log(l),m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("down",0,"rangeOfSelect"))}),$("#luckysheet-left-top").click(function(l){Yh(u.currentSheetIndex)&&($("#luckysheet-wa-functionbox-confirm").click(),u.luckysheet_select_status=!1,u.luckysheet_select_save=[{row:[0,u.flowdata.length-1],column:[0,u.flowdata[0].length-1],row_focus:0,column_focus:0,row_select:!0,column_select:!0}],Ra(),clearTimeout(u.countfuncTimeout),u.countfuncTimeout=setTimeout(function(){ql()},500),nt.saveParam("mv",u.currentSheetIndex,u.luckysheet_select_save),l.stopPropagation())}),$("#luckysheet-icon-undo").click(function(l){im(l)}),$("#luckysheet-icon-redo").click(function(l){om()}),$(document).on("mousedown.luckysheetEvent","div.luckysheet-modal-dialog",function(l){if($(l.target).is(".luckysheet-modal-dialog")){u.luckysheet_model_move_state=!0,u.luckysheet_model_move_obj=$(l.currentTarget);var o=u.luckysheet_model_move_obj.offset();u.luckysheet_model_xy=[l.pageX-o.left,l.pageY-o.top]}}),$(document).on("click.luckysheetEvent",".luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn",function(l){($("#textcolorselect").is(":visible")||$("#cellcolorselect").is(":visible"))&&$("#luckysheet-conditionformat-dialog").show(),$(l.currentTarget).parents(".luckysheet-modal-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide(),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula")&&(m.dontupdate(),Vn("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm")&&(m.dontupdate(),Vn("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm-select")&&(m.dontupdate(),Vn("down",0,"rangeOfSelect")),la()}),$("#luckysheet_info_detail_title").click(function(){window.open(Nt.myFolderUrl,"_self")}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowMove",".luckysheet-chart-rangeShow-move",function(l){u.chart_selection.rangeMove=!0,u.luckysheet_scroll_status=!0,u.chart_selection.rangeMoveObj=$(this).parent();var o=u.currentChart,d=$(this).parent().attr("id");if(d=="luckysheet-chart-rangeShow-content"){var s=o.rangeArray[0].row[0]+o.rangeSplitArray.content.row[0],h=o.rangeArray[0].column[0]+o.rangeSplitArray.content.column[0];u.chart_selection.rangeMoveIndex=[s,h]}else if(d=="luckysheet-chart-rangeShow-rowtitle"){var f=o.rangeArray[0].row[0]+o.rangeSplitArray.rowtitle.row[0],p=o.rangeArray[0].column[0]+o.rangeSplitArray.rowtitle.column[0];u.chart_selection.rangeMoveIndex=[f,p]}else if(d=="luckysheet-chart-rangeShow-coltitle"){var g=o.rangeArray[0].row[0]+o.rangeSplitArray.coltitle.row[0],v=o.rangeArray[0].column[0]+o.rangeSplitArray.coltitle.column[0];u.chart_selection.rangeMoveIndex=[g,v]}var y=pa(l.pageX,l.pageY),b=y[0]+$("#luckysheet-cell-main").scrollLeft(),k=y[1]+$("#luckysheet-cell-main").scrollTop(),w=$(this).data("type");w=="top"?k+=3:w=="right"?b-=3:w=="bottom"?k-=3:w=="left"&&(b+=3);var _=Wa(k)[2],C=ja(b)[2];u.chart_selection.rangeMovexy=[_,C],l.stopPropagation()}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowResize",".luckysheet-chart-rangeShow-resize",function(l){u.chart_selection.rangeResize=$(this).data("type"),u.luckysheet_scroll_status=!0,u.chart_selection.rangeResizeObj=$(this).parent();var o,d,s,h,f=u.currentChart,p=$(this).parent().attr("id");if(p=="luckysheet-chart-rangeShow-content")f.rangeRowCheck.exits?(o=f.rangeArray[0].row[0]+f.rangeSplitArray.content.row[0],d=f.rangeArray[0].row[0]+f.rangeSplitArray.content.row[1]):(o=f.rangeSplitArray.content.row[0],d=f.rangeSplitArray.content.row[0]),f.rangeColCheck.exits?(s=f.rangeArray[0].column[0]+f.rangeSplitArray.content.column[0],h=f.rangeArray[0].column[0]+f.rangeSplitArray.content.column[1]):(s=f.rangeSplitArray.content.column[0],h=f.rangeSplitArray.content.column[1]),u.chart_selection.rangeResizeIndex={row:[o,d],column:[s,h]};else if(p=="luckysheet-chart-rangeShow-rowtitle"){var g=f.rangeArray[0].row[0]+f.rangeSplitArray.rowtitle.row[0],v=f.rangeArray[0].row[0]+f.rangeSplitArray.rowtitle.row[1],y=f.rangeArray[0].column[0]+f.rangeSplitArray.rowtitle.column[0],b=f.rangeArray[0].column[0]+f.rangeSplitArray.rowtitle.column[1];u.chart_selection.rangeResizeIndex={row:[g,v],column:[y,b]}}else if(p=="luckysheet-chart-rangeShow-coltitle"){var k=f.rangeArray[0].row[0]+f.rangeSplitArray.coltitle.row[0],w=f.rangeArray[0].row[0]+f.rangeSplitArray.coltitle.row[1],_=f.rangeArray[0].column[0]+f.rangeSplitArray.coltitle.column[0],C=f.rangeArray[0].column[0]+f.rangeSplitArray.coltitle.column[1];u.chart_selection.rangeResizeIndex={row:[k,w],column:[_,C]}}var A=pa(l.pageX,l.pageY),I=A[0]+$("#luckysheet-cell-main").scrollLeft(),S=A[1]+$("#luckysheet-cell-main").scrollTop();u.chart_selection.rangeResize=="lt"?(I+=3,S+=3):u.chart_selection.rangeResize=="lb"?(I+=3,S-=3):u.chart_selection.rangeResize=="rt"?(I-=3,S+=3):u.chart_selection.rangeResize=="rb"&&(I-=3,S-=3);var E=Wa(S)[2],R=ja(I)[2];u.chart_selection.rangeResizexy=[E,R],l.stopPropagation()}),$("#luckysheet-wa-calculate-size").mousedown(function(l){var o=l.pageY;m.functionResizeData.y=o,m.functionResizeStatus=!0,m.functionResizeData.calculatebarHeight=u.calculatebarHeight,m.rangetosheet!=null&&m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1])}),dr.initialMenuButton(),document.getElementById("testdpidiv").offsetWidth,u.devicePixelRatio,document.getElementById("testdpidiv").offsetHeight,u.devicePixelRatio,$(document).on("paste.luckysheetEvent",function(l){if(!Rt()){if(Ba.isPasteAction){$("#luckysheet-rich-text-editor").blur(),Ba.isPasteAction=!1;var o=window.clipboardData;o||(o=l.originalEvent.clipboardData);var d=o.getData("text/html")||o.getData("text/plain"),s=!0;if(d.indexOf("luckysheet_copy_action_table")>-1&&u.luckysheet_copy_save.copyRange!=null&&u.luckysheet_copy_save.copyRange.length>0){for(var h=[],f=new RegExp("<tr.*?>(.*?)</tr>","g"),p=new RegExp("<td.*?>(.*?)</td>","g"),g=d.match(f),v=0;v<g.length;v++){var y=[],b=g[v].match(p);if(b!=null)for(var k=0;k<b.length;k++){var w=b[k].replace(/<td.*?>/g,"").replace(/<\/td>/g,"");y.push(w)}h.push(y)}var _,C=u.luckysheet_copy_save.copyRange[0].row[0],A=u.luckysheet_copy_save.copyRange[0].row[1],I=u.luckysheet_copy_save.copyRange[0].column[0],S=u.luckysheet_copy_save.copyRange[0].column[1],E=u.luckysheet_copy_save.dataSheetIndex;_=E==u.currentSheetIndex?vr.deepCopyFlowData(u.flowdata):u.luckysheetfile[je(E)].data;for(var R=C;R<=A&&!(R-C>h.length-1);R++)for(var F=I;F<=S;F++){var N=_[R][F];if(N==null||N.mc==null||N.mc.rs!=null){var z=void 0;if((z=N!=null?N.ct!=null&&N.ct.fa.indexOf("w")>-1?_[R][F].v:_[R][F].m:"")==null&&(z=""),h[R-C][F-I]!=z){s=!1;break}}}}var P=st().fontjson;if(!Ya.createHookFunction("rangePasteBefore",u.luckysheet_select_save,d))return;if(d.indexOf("luckysheet_copy_action_table")>-1&&u.luckysheet_copy_save.copyRange!=null&&u.luckysheet_copy_save.copyRange.length>0&&s)u.luckysheet_paste_iscut?(u.luckysheet_paste_iscut=!1,Ba.pasteHandlerOfCutPaste(u.luckysheet_copy_save),Ba.clearcopy(l)):Ba.pasteHandlerOfCopyPaste(u.luckysheet_copy_save);else if(d.indexOf("luckysheet_copy_action_image")>-1)_r.pasteImgItem();else if(d.indexOf("table")>-1){$("#luckysheet-copy-content").html(d);var q=new Array($("#luckysheet-copy-content").find("table tr").length),V=0;$("#luckysheet-copy-content").find("table tr").eq(0).find("td").each(function(){var U=parseInt($(this).attr("colspan"));isNaN(U)&&(U=1),V+=U});for(var x=0;x<q.length;x++)q[x]=new Array(V);var ee=0,ne={};$("#luckysheet-copy-content").find("table tr").each(function(){var U=$(this),B=0;U.find("td").each(function(){var le=$(this),Te={},ue=le.text();if($.trim(ue).length==0)Te.v=null,Te.m="";else{var be=_a(le.text());Te.v=be[2],Te.ct=be[1],Te.m=be[0]}var ye=le.css("background-color");ye=="rgba(0, 0, 0, 0)"&&(ye=null),Te.bg=ye;var ce=le.css("font-weight");Te.bl=ce==400||ce=="normal"?0:1;var Re=le.css("font-style");Te.it=Re=="normal"?0:1;for(var pe=le.css("font-family").split(","),me=0;me<pe.length;me++){var re=$.trim(pe[me].toLowerCase());if((re=P[re])!=null){Te.ff=re;break}Te.ff=0}var _e=Math.floor(72*parseInt(le.css("font-size"))/96)+1;Te.fs=_e;var Ze=le.css("color");Te.fc=Ze;var We=le.css("text-align");Te.ht=We=="center"?0:We=="right"?2:1;var Xe=le.css("vertical-align");for(Te.vt=Xe=="middle"?0:Xe=="top"||Xe=="text-top"?1:2;B<V&&q[ee][B]!=null;)B++;if(B==V)return!0;if(q[ee][B]==null){q[ee][B]=Te;var Ue=parseInt(le.attr("rowspan")),mt=parseInt(le.attr("colspan"));isNaN(Ue)&&(Ue=1),isNaN(mt)&&(mt=1);for(var St=u.luckysheet_select_save[0].row[0]+ee,at=u.luckysheet_select_save[0].column[0]+B,dt=0;dt<Ue;dt++)for(var wt=0;wt<mt;wt++){if(dt==0){var ct=le.css("border-top");if(ct!=null&&ct.length>0&&ct.substr(0,3).toLowerCase()!="0px"){var bt=le.css("border-top-width"),De=le.css("border-top-style"),He=le.css("border-top-color"),Dt=dr.getQKBorder(bt,De,He);ne[ee+dt+"_"+(B+wt)]==null&&(ne[ee+dt+"_"+(B+wt)]={}),ne[ee+dt+"_"+(B+wt)].t={style:Dt[0],color:Dt[1]}}}if(dt==Ue-1){var et=le.css("border-bottom");if(et!=null&&et.length>0&&et.substr(0,3).toLowerCase()!="0px"){var ur=le.css("border-bottom-width"),Xt=le.css("border-bottom-style"),jt=le.css("border-bottom-color"),lr=dr.getQKBorder(ur,Xt,jt);ne[ee+dt+"_"+(B+wt)]==null&&(ne[ee+dt+"_"+(B+wt)]={}),ne[ee+dt+"_"+(B+wt)].b={style:lr[0],color:lr[1]}}}if(wt==0){var tr=le.css("border-left");if(tr!=null&&tr.length>0&&tr.substr(0,3).toLowerCase()!="0px"){var xr=le.css("border-left-width"),rr=le.css("border-left-style"),nr=le.css("border-left-color"),Ut=dr.getQKBorder(xr,rr,nr);ne[ee+dt+"_"+(B+wt)]==null&&(ne[ee+dt+"_"+(B+wt)]={}),ne[ee+dt+"_"+(B+wt)].l={style:Ut[0],color:Ut[1]}}}if(wt==mt-1){var ar=le.css("border-right");if(ar!=null&&ar.length>0&&ar.substr(0,3).toLowerCase()!="0px"){var Jt=le.css("border-right-width"),Qt=le.css("border-right-style"),_t=le.css("border-right-color"),er=dr.getQKBorder(Jt,Qt,_t);ne[ee+dt+"_"+(B+wt)]==null&&(ne[ee+dt+"_"+(B+wt)]={}),ne[ee+dt+"_"+(B+wt)].r={style:er[0],color:er[1]}}}dt==0&&wt==0||(q[ee+dt][B+wt]={mc:{r:St,c:at}})}if(Ue>1||mt>1){var Kt={rs:Ue,cs:mt,r:St,c:at};q[ee][B].mc=Kt}}return++B==V||void 0}),ee++}),u.luckysheet_selection_range=[],Ba.pasteHandler(q,ne),$("#luckysheet-copy-content").empty()}else{if(o.files.length==1&&o.files[0].type.indexOf("image")>-1){var ae=new FileReader;return ae.readAsDataURL(o.files[0]),void(ae.onload=function(U){var B=U.target.result;_r.inserImg(B)})}d=o.getData("text/plain"),Ba.pasteHandler(d)}}else if($(l.target).closest("#luckysheet-rich-text-editor").length>0){l.preventDefault();var de=window.clipboardData;de||(de=l.originalEvent.clipboardData);var ve=de.getData("text/plain");document.execCommand("insertText",!1,ve)}}}),Nt.enablePage&&$("#luckysheet-bottom-page-next").click(function(){var l=Nt.pageInfo.queryExps,o=Nt.pageInfo.reportId,d=Nt.pageInfo.fields,s=Nt.pageInfo.mobile,h=Nt.pageInfo.frezon,f=Nt.pageInfo.currentPage,p=(Nt.pageInfo.totalPage,Nt.pageInfo.pageUrl);Ya.addDataAjax({queryExps:l,reportId:o,fields:d,mobile:s,frezon:h,pageIndex:f,currentPage:f},u.currentSheetIndex,p,function(){if(Nt.pageInfo.currentPage++,Nt.pageInfo.totalPage==Nt.pageInfo.currentPage){$("#luckysheet-bottom-page-next").hide();var g=br(a.pageInfoFull,{total:Nt.total,totalPage:Nt.pageInfo.totalPage});$("#luckysheet-bottom-page-info").html(g)}else{var v=br(a.pageInfo,{total:Nt.total,totalPage:Nt.pageInfo.totalPage,currentPage:Nt.pageInfo.currentPage});$("#luckysheet-bottom-page-info").html(v)}})}).mousedown(function(l){l.stopPropagation()}),$("#luckysheet-bottom-bottom-top").click(function(){$("#luckysheet-scrollbar-y").scrollTop(0)}).mousedown(function(l){l.stopPropagation()})}var yy=!1,Zn=null,by=null,Om="";function ky(){if(!yy){yy=!0;var e=st(),n=e.toolbar;$("#luckysheetsheetconfigcolorur").spectrum({showPalette:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!1,showSelectionPalette:!0,maxPaletteSize:10,cancelText:e.sheetconfig.cancelText,chooseText:e.sheetconfig.chooseText,togglePaletteMoreText:n.toolMore,togglePaletteLessText:n.toolLess,clearText:n.clearText,noColorSelectedText:n.noColorSelectedText,palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"]],change:function(l){$(this),l=l!=null?l.toHexString():"rgb(0, 0, 0)";var o=null;Zn.find(".luckysheet-sheets-item-color").length>0&&(o=Zn.find(".luckysheet-sheets-item-color").css("background-color")),Zn.find(".luckysheet-sheets-item-color").remove(),Zn.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l+';"></div>');var d=je(u.currentSheetIndex);if(u.luckysheetfile[d].color=l,nt.saveParam("all",u.currentSheetIndex,l,{k:"color"}),u.clearjfundo){var s={type:"sheetColor"};s.sheetIndex=u.currentSheetIndex,s.oldcolor=o,s.color=l,u.jfundo.length=0,u.jfredo.push(s)}}}),$("#luckysheetsheetconfigcolorreset").click(function(){var l=null;Zn.find(".luckysheet-sheets-item-color").length>0&&(l=Zn.find(".luckysheet-sheets-item-color").css("background-color")),Zn.find(".luckysheet-sheets-item-color").remove();var o=je(u.currentSheetIndex);if(u.luckysheetfile[o].color=null,nt.saveParam("all",u.currentSheetIndex,null,{k:"color"}),u.clearjfundo){var d={type:"sheetColor"};d.sheetIndex=u.currentSheetIndex,d.oldcolor=l,d.color=null,u.jfundo.length=0,u.jfredo.push(d)}})}var t=je(u.currentSheetIndex);u.luckysheetfile[t].color!=null&&u.luckysheetfile[t].color.length>0&&$("#luckysheetsheetconfigcolorur").spectrum("set",u.luckysheetfile[t].color),$("#luckysheetsheetconfigcolorur").parent().find("span, div, button, input, a").addClass("luckysheet-mousedown-cancel");var a=Nt.sheetRightClickConfig;Object.values(a).every(function(l){return!l})||setTimeout(function(){al($("#luckysheet-rightclick-sheet-menu"),Zn.offset().left+Zn.width(),Zn.offset().top-18,"leftbottom")},1)}var xy=function(e,n,t){clearTimeout(by),n.hasClass("luckysheet-sheets-item-name")&&n.attr("contenteditable")=="true"||(m.rangestart||m.rangedrag_column_start||m.rangedrag_row_start||m.israngeseleciton()?setTimeout(function(){m.setCaretPosition(m.rangeSetValueTo.get(0),0,m.rangeSetValueTo.text().length),m.createRangeHightlight(),$("#luckysheet-input-box-index").find(".luckysheet-input-box-index-sheettxt").remove().end().prepend("<span class='luckysheet-input-box-index-sheettxt'>"+ir.getSheetName(m.rangetosheet)+"!</span>").show(),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")})},1):(parseInt($("#luckysheet-input-box").css("top"))>0&&m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove()),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),e.addClass("luckysheet-sheets-item-active"),bl(t),ir.changeSheet(e.data("index")),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),(n.hasClass("luckysheet-sheets-item-menu")||n.hasClass("fa-sort-desc")||t.which=="3")&&(Zn=n.closest(".luckysheet-sheets-item"),ky()))};function Px(){var e=st().sheetconfig;$("#luckysheet-sheet-area").on("mousedown","div.luckysheet-sheets-item",function(s){if(!Rt()){var h=$(this),f=$(s.target),p=f.closest(".luckysheet-sheets-item");if(s.which=="3")return xy(h,f,s),Zn=p,void ky();p.hasClass("luckysheet-sheets-item-active")&&p.find(".luckysheet-sheets-item-name").attr("contenteditable")=="false"&&(by=setTimeout(function(){u.luckysheet_sheet_move_status=!0,u.luckysheet_sheet_move_data={},u.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(y){y==0?u.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):u.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+u.luckysheet_sheet_move_data.widthlist[y-1])}),u.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item").index(p);var g=s.pageX;u.luckysheet_sheet_move_data.curleft=g-p.offset().left,u.luckysheet_sheet_move_data.pageX=g,u.luckysheet_sheet_move_data.activeobject=p,u.luckysheet_sheet_move_data.cursorobject=f;var v=p.clone().css("visibility","hidden").attr("id","luckysheet-sheets-item-clone");p.after(v),p.css({position:"absolute",opacity:.8,cursor:"move",transition:"initial","z-index":10})},200))}}).on("click","div.luckysheet-sheets-item",function(s){if(!Rt()){var h=$(this),f=$(s.target);xy(h,f,s),nt.keepHighLightBox()}});var n=function(s){u.allowEdit!==!1&&(s.attr("contenteditable","true").addClass("luckysheet-mousedown-cancel").data("oldtxt",s.text()),setTimeout(function(){(function(h){if(window.getSelection){var f=document.createRange();f.selectNodeContents(h),f.startContainer&&id(f.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(f))}else if(document.selection){var p=document.body.createTextRange();p.moveToElementText(h),p.select()}})(s.get(0))},1))};$("#luckysheet-sheet-area").on("dblclick","span.luckysheet-sheets-item-name",function(s){n($(this))});var t=!0;$("#luckysheet-sheet-area").on("compositionstart","span.luckysheet-sheets-item-name",function(){return t=!1}),$("#luckysheet-sheet-area").on("compositionend","span.luckysheet-sheets-item-name",function(){return t=!0}),$("#luckysheet-sheet-area").on("input","span.luckysheet-sheets-item-name",function(){var s=this;if(u.allowEdit!==!1&&u.limitSheetNameLength!==!1){var h=u.defaultSheetNameMaxLength;h!==0&&setTimeout(function(){t&&$(s).text().length>=h&&setTimeout(function(){$(s).text($(s).text().substring(0,h));var f=window.getSelection();f.selectAllChildren(s),f.collapseToEnd()},0)},0)}}),$("#luckysheet-sheet-area").on("blur","span.luckysheet-sheets-item-name",function(s){var h=this;if(u.allowEdit!==!1){if($(this).text().length===0)return alert(e.sheetNamecannotIsEmptyError),void setTimeout(function(){$(h).text(Om),n($(h)),$(h).focus()},1);var f=$(this),p=f.text(),g=f.data("oldtxt");if(p.length>31||p.charAt(0)=="'"||p.charAt(p.length-1)=="'"||/[\:\\\/\?\*\[\]]+/.test(p))return alert(e.sheetNameSpecCharError),void setTimeout(function(){n($(h)),$(h).focus()},1);for(var v=je(u.currentSheetIndex),y=0;y<u.luckysheetfile.length;y++)if(v!=y&&u.luckysheetfile[y].name==p)return Rt()?alert(e.tipNameRepeat):Ee.info("",e.tipNameRepeat),void f.text(g).attr("contenteditable","false");if(ir.sheetArrowShowAndHide(),u.luckysheetfile[v].name=p,nt.saveParam("all",u.currentSheetIndex,p,{k:"name"}),f.attr("contenteditable","false").removeClass("luckysheet-mousedown-cancel"),u.clearjfundo){var b={type:"sheetName"};b.sheetIndex=u.currentSheetIndex,b.oldtxt=g,b.txt=p,u.jfundo.length=0,u.jfredo.push(b)}}}),$("#luckysheet-sheet-area").on("keydown","span.luckysheet-sheets-item-name",function(s){if(u.allowEdit!==!1){var h=s.keyCode,f=$(this);if(h==Yi){var p=je(u.currentSheetIndex);Om=u.luckysheetfile[p].name||Om,u.luckysheetfile[p].name=f.text(),f.attr("contenteditable","false")}}}),$("#luckysheetsheetconfigrename").click(function(){n(Zn.find("span.luckysheet-sheets-item-name")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigshow").click(function(){$("#luckysheet-sheets-m").click(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveleft").click(function(){Zn.prevAll(":visible").length>0&&(Zn.insertBefore(Zn.prevAll(":visible").eq(0)),ir.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveright").click(function(){Zn.nextAll(":visible").length>0&&(Zn.insertAfter(Zn.nextAll(":visible").eq(0)),ir.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigdelete").click(function(s){if($("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-sheet-container-c .luckysheet-sheets-item:visible").length<=1)Rt()?alert(e.noMoreSheet):Ee.info(e.noMoreSheet,"");else{var h=je(u.currentSheetIndex);Ee.confirm(e.confirmDelete+""+u.luckysheetfile[h].name+"","<span style='color:#9e9e9e;font-size:12px;'>"+e.redoDelete+"</span>",function(){ir.deleteSheet(Zn.data("index"))},null),$("#luckysheet-input-box").removeAttr("style")}}),$("#luckysheetsheetconfigcopy").click(function(s){ir.copySheet(Zn.data("index"),s),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfighide").click(function(){$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").length!=1?(ir.setSheetHide(Zn.data("index")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()):Rt()?alert(e.noHide):Ee.info("",e.noHide)}),$("#luckysheet-sheets-add").click(function(s){parseInt($("#luckysheet-input-box").css("top"))>0&&m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),ir.addNewSheet(s),ir.locationSheet(),$("#luckysheet-input-box").removeAttr("style")});var a=null,l=0,o=0;$("#luckysheet-sheets-leftscroll").click(function(){var s=$("#luckysheet-sheet-container-c");l=s.scrollLeft(),(o=s.scrollLeft()-150)<=0&&$("#luckysheet-sheet-container .docs-sheet-fade-left").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-right").show(),clearInterval(a),a=setInterval(function(){l-=4,s.scrollLeft(l),l<=o&&clearInterval(a)},1)}),$("#luckysheet-sheets-rightscroll").click(function(){var s=$("#luckysheet-sheet-container-c");l=s.scrollLeft(),o=s.scrollLeft()+150,l>0&&$("#luckysheet-sheet-container .docs-sheet-fade-right").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),clearInterval(a),a=setInterval(function(){l+=4,s.scrollLeft(l),l>=o&&clearInterval(a)},1)});var d=!0;$("#luckysheet-sheets-m").click(function(s){parseInt($("#luckysheet-input-box").css("top"))>0&&m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),$("#luckysheet-sheet-list").html("");for(var h="",f=0;f<u.luckysheetfile.length;f++){var p=u.luckysheetfile[f],g="",v="";p.status==1&&(g='<i class="fa fa-check" aria-hidden="true"></i>'),p.hide==1&&(g='<i class="fa fa-low-vision" aria-hidden="true"></i>',v+="color:#BBBBBB;"),p.color!=null&&p.color.length>0&&(v+="border-right:4px solid "+p.color+";"),h+=br('<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"  id="luckysheet-sheet-btn${index}" data-index="${index}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="${style}" ><span class="icon luckysheet-mousedown-cancel">${icon}</span>${name}</div></div>',{index:p.index,name:p.name,icon:g,style:v})}d?($("#"+u.container).append(br('<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-sheet-list">${item}</div>',{item:h})),$("#luckysheet-sheet-list").on("click",".luckysheet-cols-menuitem",function(w){if(Rt())alert(e.chartEditNoOpt);else{var _=$(this),C=_.data("index");_.data("index")!=u.currentSheetIndex&&(ir.setSheetShow(C),ir.locationSheet()),nt.keepHighLightBox()}}),d=!1):$("#luckysheet-sheet-list").html(h);var y=$("#luckysheet-sheet-list"),b=$(this).offset().left-$("#"+u.container).offset().left,k=$(this).height()+$("#luckysheet-sta-content").height()+12;y.css({left:b+"px",bottom:k+"px"}).show(),$("#luckysheet-input-box").removeAttr("style")}),Nt.pager&&Gg(Nt.pager)}function Ox(){$("#luckysheet-rows-h").mousedown(function(e){if(Yh(u.currentSheetIndex)){Lr.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&_r.cancelActiveImgItem();var n=Wa(pa(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop()),t=n[1],a=n[0],l=n[2],o=u.visibledatacolumn.length-1,d=u.visibledatacolumn[o];if($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),e.which=="3"){for(var s=!1,h=0;h<u.luckysheet_select_save.length;h++){var f=u.luckysheet_select_save[h];if(f.row!=null&&l>=f.row[0]&&l<=f.row[1]&&f.column[0]==0&&f.column[1]==u.flowdata[0].length-1){s=!0;break}}if(s)return}var p=a,g=t-a-1,v=[l,l];u.luckysheet_scroll_status=!0;var y=$("#luckysheet-input-box");if(parseInt(y.css("top"))>0){if(m.rangestart||m.rangedrag_column_start||m.rangedrag_row_start||m.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var b=dr.mergeMoveMain([0,o],v,{row_focus:l,column_focus:0},p,g,0,d);if(b!=null&&(v=b[1],p=b[2],g=b[3]),e.shiftKey){var k=m.func_selectedrange,w=0,_=0,C=[];k.top>a?(w=a,_=k.top+k.height-a,k.row[1]>k.row_focus&&(k.row[1]=k.row_focus),C=[l,k.row[1]]):k.top==a?(w=a,_=k.top+k.height-a,C=[l,k.row[0]]):(w=k.top,_=t-k.top-1,k.row[0]<k.row_focus&&(k.row[0]=k.row_focus),C=[k.row[0],l]);var A=dr.mergeMoveMain([0,o],C,{row_focus:l,column_focus:0},w,_,0,d);A!=null&&(C=A[1],w=A[2],_=A[3]),k.row=C,k.top_move=w,k.height_move=_,m.func_selectedrange=k}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){var I=$("#luckysheet-rich-text-editor").text()+",";if(I.length>0&&I.substr(0,1)=="="){if(I=m.functionHTMLGenerate(I),window.getSelection){var S=window.getSelection();m.functionRangeIndex=[$(S.anchorNode).parent().index(),S.anchorOffset]}else{var E=document.selection.createRange();m.functionRangeIndex=E}$("#luckysheet-rich-text-editor").html(I),m.canceFunctionrangeSelected(),m.createRangeHightlight()}m.rangestart=!1,m.rangedrag_column_start=!1,m.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(I),m.rangeHightlightselected($("#luckysheet-rich-text-editor")),m.israngeseleciton(),m.func_selectedrange={left:En(0)[0],width:En(0)[1]-En(0)[0]-1,top:p,height:g,left_move:0,width_move:d-0-1,top_move:p,height_move:g,row:v,column:[0,o],row_focus:l,column_focus:0}}else m.func_selectedrange={left:En(0)[0],width:En(0)[1]-En(0)[0]-1,top:p,height:g,left_move:0,width_move:d-0-1,top_move:p,height_move:g,row:v,column:[0,o],row_focus:l,column_focus:0};if(m.rangestart||m.rangedrag_column_start||m.rangedrag_row_start||m.israngeseleciton())m.rangeSetValue({row:v,column:[null,null]});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var R=wn(u.currentSheetIndex,{row:v,column:[0,o]},u.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(R)}return m.rangedrag_row_start=!0,m.rangestart=!1,m.rangedrag_column_start=!1,$("#luckysheet-formula-functionrange-select").css({left:0,width:d-0-1,top:p,height:g}).show(),$("#luckysheet-formula-help-c").hide(),lo(0,p,d-0-1,g,v,[0,o]),void setTimeout(function(){var q,V=window.getSelection().anchorNode;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(q=$("#luckysheet-rich-text-editor"),m.rangechangeindex=m.data_parm_index):q=$(V).closest("div");var x=q.find("span[rangeindex='"+m.rangechangeindex+"']");m.setCaretPosition(x.get(0),0,x.html().length)},1)}m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),u.luckysheet_rows_selected_status=!0}else u.luckysheet_rows_selected_status=!0;if(u.luckysheet_rows_selected_status){if(e.shiftKey){var F=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),N=0,z=0,P=[];F.top>a?(N=a,z=F.top+F.height-a,F.row[1]>F.row_focus&&(F.row[1]=F.row_focus),P=[l,F.row[1]]):F.top==a?(N=a,z=F.top+F.height-a,P=[l,F.row[0]]):(N=F.top,z=t-F.top-1,F.row[0]<F.row_focus&&(F.row[0]=F.row_focus),P=[F.row[0],l]),F.row=P,F.top_move=N,F.height_move=z,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=F}else e.ctrlKey||(u.luckysheet_select_save.length=0),u.luckysheet_select_save.push({left:En(0)[0],width:En(0)[1]-En(0)[0]-1,top:p,height:g,left_move:0,width_move:d-0-1,top_move:p,height_move:g,row:v,column:[0,o],row_focus:l,column_focus:0,row_select:!0});Ra(),nt.saveParam("mv",u.currentSheetIndex,u.luckysheet_select_save)}lm(),setTimeout(function(){clearTimeout(u.countfuncTimeout),ql()},101)}}).mousemove(function(e){if(u.luckysheet_rows_selected_status||u.luckysheet_rows_change_size||u.luckysheet_select_status)$("#luckysheet-rows-h-hover").hide();else{var n=pa(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),t=Wa(n),a=t[1],l=t[0];$("#luckysheet-rows-h-hover").css({top:l,height:a-l-1,display:"block"}),n<a-1&&n>=a-5?$("#luckysheet-rows-change-size").css({top:a-3,opacity:0}):$("#luckysheet-rows-change-size").css("opacity",0)}}).mouseleave(function(e){$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-rows-change-size").css("opacity",0)}).mouseup(function(e){if(e.which==3){if(Rt())return;$("#luckysheet-cols-rows-shift").hide(),u.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(st().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(st().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(st().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(st().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";var n=Nt.cellRightClickConfig;if(!(n.copy||n.copyAs||n.paste||n.insertRow||n.deleteRow||n.hideRow||n.rowHeight||n.clear||n.matrix||n.sort||n.filter||n.chart||n.image||n.link||n.data||n.cellFormat))return;na("#luckysheet-top-left-add-selected").style.display=n.insertRow?"block":"none",na("#luckysheet-bottom-right-add-selected").style.display=n.insertRow?"block":"none",na("#luckysheet-del-selected").style.display=n.deleteRow?"block":"none",na("#luckysheet-hide-selected").style.display=n.hideRow?"block":"none",na("#luckysheet-show-selected").style.display=n.hideRow?"block":"none",na("#luckysheet-column-row-width-selected").style.display=n.rowHeight?"block":"none",n.copy||n.copyAs||n.paste||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",n.insertRow||n.deleteRow||n.hideRow||n.rowHeight||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),n.insertRow||n.deleteRow||n.hideRow||n.rowHeight||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),n.clear||n.matrix||n.sort||n.filter||n.chart||n.image||n.link||n.data||n.cellFormat||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),Au($("#luckysheet-rightclick-menu"),$(this).offset().left+46,e.pageY),u.luckysheet_cols_menu_status=!0;var t=$.extend(!0,{},u.config);t.rowlen==null&&(t.rowlen={});for(var a=t.rowlen[u.luckysheet_select_save[0].row[0]]==null?u.defaultrowlen:t.rowlen[u.luckysheet_select_save[0].row[0]],l=!0,o=0;o<u.luckysheet_select_save.length;o++)for(var d=u.luckysheet_select_save[o],s=d.row[0],h=d.row[1],f=s;f<=h;f++)if((t.rowlen[f]==null?u.defaultrowlen:t.rowlen[f])!=a){l=!1;break}l?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(a):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-cols-h-c").mousedown(function(e){if(Yh(u.currentSheetIndex)){Lr.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&_r.cancelActiveImgItem();var n=pa(e.pageX,e.pageY)[0]+$(this).scrollLeft(),t=u.visibledatarow.length-1,a=u.visibledatarow[t],l=ja(n),o=l[1],d=l[0],s=l[2];if(u.orderbyindex=s,$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),e.which=="3"){for(var h=!1,f=0;f<u.luckysheet_select_save.length;f++){var p=u.luckysheet_select_save[f];if(p.column!=null&&s>=p.column[0]&&s<=p.column[1]&&p.row[0]==0&&p.row[1]==u.flowdata.length-1){h=!0;break}}if(h)return}var g=d,v=o-d-1,y=[s,s];u.luckysheet_scroll_status=!0;var b=$("#luckysheet-input-box");if(parseInt(b.css("top"))>0){if(m.rangestart||m.rangedrag_column_start||m.rangedrag_row_start||m.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var k=dr.mergeMoveMain(y,[0,t],{row_focus:0,column_focus:s},0,a,g,v);if(k!=null&&(y=k[0],g=k[4],v=k[5]),e.shiftKey){var w=m.func_selectedrange,_=0,C=0,A=[];w.left>d?(_=d,C=w.left+w.width-d,w.column[1]>w.column_focus&&(w.column[1]=w.column_focus),A=[s,w.column[1]]):w.left==d?(_=d,C=w.left+w.width-d,A=[s,w.column[0]]):(_=w.left,C=o-w.left-1,w.column[0]<w.column_focus&&(w.column[0]=w.column_focus),A=[w.column[0],s]);var I=dr.mergeMoveMain(A,[0,t],{row_focus:0,column_focus:s},0,a,_,C);I!=null&&(A=I[0],_=I[4],C=I[5]),w.column=A,w.left_move=_,w.width_move=C,m.func_selectedrange=w}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){var S=$("#luckysheet-rich-text-editor").text()+",";if(S.length>0&&S.substr(0,1)=="="){if(S=m.functionHTMLGenerate(S),window.getSelection){var E=window.getSelection();m.functionRangeIndex=[$(E.anchorNode).parent().index(),E.anchorOffset]}else{var R=document.selection.createRange();m.functionRangeIndex=R}$("#luckysheet-rich-text-editor").html(S),m.canceFunctionrangeSelected(),m.createRangeHightlight()}m.rangestart=!1,m.rangedrag_column_start=!1,m.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(S),m.rangeHightlightselected($("#luckysheet-rich-text-editor")),m.israngeseleciton(),m.func_selectedrange={left:g,width:v,top:ol(0)[0],height:ol(0)[1]-ol(0)[0]-1,left_move:g,width_move:v,top_move:0,height_move:a-0-1,row:[0,t],column:y,row_focus:0,column_focus:s}}else m.func_selectedrange={left:g,width:v,top:ol(0)[0],height:ol(0)[1]-ol(0)[0]-1,left_move:g,width_move:v,top_move:0,height_move:a-0-1,row:[0,t],column:y,row_focus:0,column_focus:s};if(m.rangestart||m.rangedrag_column_start||m.rangedrag_row_start||m.israngeseleciton())m.rangeSetValue({row:[null,null],column:y});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var F=wn(u.currentSheetIndex,{row:[0,t],column:y},u.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(F)}return m.rangedrag_column_start=!0,m.rangestart=!1,m.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:g,width:v,top:0,height:a-0-1}).show(),$("#luckysheet-formula-help-c").hide(),void lo(g,0,v,a-0-1,[0,t],y)}m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),u.luckysheet_cols_selected_status=!0}else u.luckysheet_cols_selected_status=!0;if(u.luckysheet_cols_selected_status){if(e.shiftKey){var N=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),z=0,P=0,q=[];N.left>d?(z=d,P=N.left+N.width-d,N.column[1]>N.column_focus&&(N.column[1]=N.column_focus),q=[s,N.column[1]]):N.left==d?(z=d,P=N.left+N.width-d,q=[s,N.column[0]]):(z=N.left,P=o-N.left-1,N.column[0]<N.column_focus&&(N.column[0]=N.column_focus),q=[N.column[0],s]),N.column=q,N.left_move=z,N.width_move=P,u.luckysheet_select_save[u.luckysheet_select_save.length-1]=N}else e.ctrlKey||(u.luckysheet_select_save.length=0),u.luckysheet_select_save.push({left:g,width:v,top:ol(0)[0],height:ol(0)[1]-ol(0)[0]-1,left_move:g,width_move:v,top_move:0,height_move:a-0-1,row:[0,t],column:y,row_focus:0,column_focus:s,column_select:!0});Ra(),nt.saveParam("mv",u.currentSheetIndex,u.luckysheet_select_save)}lm(),setTimeout(function(){clearTimeout(u.countfuncTimeout),ql()},101),u.luckysheet_cols_menu_status&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),u.luckysheet_cols_menu_status=!1),e.stopPropagation()}}).mousemove(function(e){if(u.luckysheet_cols_selected_status||u.luckysheet_select_status)return $("#luckysheet-cols-h-hover").hide(),void $("#luckysheet-cols-menu-btn").hide();if(!u.luckysheet_cols_menu_status&&!u.luckysheet_cols_change_size){var n=pa(e.pageX,e.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft(),t=ja(n),a=t[1],l=t[0];$("#luckysheet-cols-h-hover").css({left:l,width:a-l-1,display:"block"}),$("#luckysheet-cols-menu-btn").css({left:a-19,display:"block"}),$("#luckysheet-cols-change-size").css({left:a-5}),n<a&&n>=a-5?($("#luckysheet-cols-change-size").css({opacity:0}),$("#luckysheet-cols-menu-btn").hide()):($("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}}).mouseleave(function(e){u.luckysheet_cols_menu_status||u.luckysheet_cols_change_size||($("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseup(function(e){if(e.which==3){if(Rt())return;u.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(st().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(st().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(st().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(st().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";var n=Nt.cellRightClickConfig;if(!(n.copy||n.copyAs||n.paste||n.insertColumn||n.deleteColumn||n.hideColumn||n.columnWidth||n.clear||n.matrix||n.sort||n.filter||n.chart||n.image||n.link||n.data||n.cellFormat))return;na("#luckysheet-top-left-add-selected").style.display=n.insertColumn?"block":"none",na("#luckysheet-bottom-right-add-selected").style.display=n.insertColumn?"block":"none",na("#luckysheet-del-selected").style.display=n.deleteColumn?"block":"none",na("#luckysheet-hide-selected").style.display=n.hideColumn?"block":"none",na("#luckysheet-show-selected").style.display=n.hideColumn?"block":"none",na("#luckysheet-column-row-width-selected").style.display=n.columnWidth?"block":"none",n.copy||n.copyAs||n.paste||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",n.insertColumn||n.deleteColumn||n.hideColumn||n.columnWidth||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),n.insertColumn||n.deleteColumn||n.hideColumn||n.columnWidth||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),n.clear||n.matrix||n.sort||n.filter||n.chart||n.image||n.link||n.data||n.cellFormat||(na("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),Au($("#luckysheet-rightclick-menu"),e.pageX,$(this).offset().top+18),u.luckysheet_cols_menu_status=!0;var t=$.extend(!0,{},u.config);t.columnlen==null&&(t.columnlen={});for(var a=t.columnlen[u.luckysheet_select_save[0].column[0]]==null?u.defaultcollen:t.columnlen[u.luckysheet_select_save[0].column[0]],l=!0,o=0;o<u.luckysheet_select_save.length;o++)for(var d=u.luckysheet_select_save[o],s=d.column[0],h=d.column[1],f=s;f<=h;f++)if((t.columnlen[f]==null?u.defaultcollen:t.columnlen[f])!=a){l=!1;break}l?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(a):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-rows-change-size").mousedown(function(e){Lr.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&_r.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-rows-change-size").css({opacity:1});var n=pa(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").width(),l=Wa(n),o=l[1],d=l[0],s=l[2];u.luckysheet_rows_change_size=!0,u.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:"1px","border-width":"0 0px 1px 0",top:o-3,left:0,width:t+a,display:"block",cursor:"ns-resize"}),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","ns-resize"),u.luckysheet_rows_change_size_start=[d,s],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),e.stopPropagation()}),$("#luckysheet-cols-change-size").mousedown(function(e){Lr.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&_r.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-cols-change-size").css({opacity:1});var n=pa(e.pageX,e.pageY),t=$("#luckysheet-cols-h-c").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").height(),o=n[0]+t,d=u.visibledatarow.length-1,s=(u.visibledatarow[d],ja(o)),h=s[1],f=s[0],p=s[2];u.luckysheet_cols_change_size=!0,u.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:l+a,"border-width":"0 1px 0 0",top:0,left:h-3,width:"1px",display:"block",cursor:"ew-resize"}),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","ew-resize"),u.luckysheet_cols_change_size_start=[f,p],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),u.luckysheet_cols_dbclick_times=0,e.stopPropagation()}).dblclick(function(){(function(){u.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");var e=pa(event.pageX,event.pageY),n=$("#luckysheet-cols-h-c").scrollLeft(),t=ja(e[0]+n)[2],a=vr.deepCopyFlowData(u.flowdata),l=$("#luckysheetTableContent").get(0).getContext("2d"),o=$.extend(!0,{},u.config);o.columnlen==null&&(o.columnlen={});var d={},s=$("#luckysheet-cell-main").scrollTop(),h=u.luckysheetTableContentHW[1],f=fa(u.visibledatarow,s),p=fa(u.visibledatarow,s+h);(p+=p-f)>=a.length&&(p=a.length-1);for(var g=0;g<u.luckysheet_select_save.length;g++){var v=u.luckysheet_select_save[g].column[0],y=u.luckysheet_select_save[g].column[1];if(t<v||t>y){if(t in d)continue;for(var b=u.defaultcollen,k=f;k<=p;k++){var w=a[k][t];if(w!=null&&(!$t(w.v)||qi(w))){var _=En(t)[1]-En(t)[0]-2,C=qs(w,l,{r:k,c:t,cellWidth:_}),A=0;C!=null&&(A=C.textWidthAll),A+6>b&&(b=A+6)}}b!=u.defaultcollen&&(o.columnlen[t]=b,o.customWidth&&delete o.customWidth[t]),d[t]=1}else for(var I=v;I<=y;I++)if(!(I in d)){for(var S=u.defaultcollen,E=f;E<=p;E++){var R=a[E][I];if(R!=null&&(!$t(R.v)||qi(R))){var F=En(I)[1]-En(I)[0]-2,N=qs(R,l,{r:E,c:I,cellWidth:F}),z=0;N!=null&&(z=N.textWidthAll),z+6>S&&(S=z+6)}}S!=u.defaultcollen&&(o.columnlen[I]=S,o.customWidth&&delete o.customWidth[I]),d[I]=1}}Ni(u.flowdata[0].length,u.flowdata.length,u.flowdata,o,u.luckysheet_select_save,"resizeC","columnlen")})()}),$("#luckysheet-cols-menu-btn").click(function(e){var n=$("#luckysheet-rightclick-menu"),t=$(this).offset();$("#luckysheet-cols-rows-shift").show(),u.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(st().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(st().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(st().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").hide(),$("#luckysheet-cols-rows-shift").show(),$("#luckysheet-cols-rows-handleincell").hide(),na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",na("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="block";var a=Nt.cellRightClickConfig;(a.copy||a.copyAs||a.paste||a.insertColumn||a.deleteColumn||a.hideColumn||a.columnWidth||a.sort)&&(na("#luckysheet-top-left-add-selected").style.display=a.insertColumn?"block":"none",na("#luckysheet-bottom-right-add-selected").style.display=a.insertColumn?"block":"none",na("#luckysheet-del-selected").style.display=a.deleteColumn?"block":"none",na("#luckysheet-hide-selected").style.display=a.hideColumn?"block":"none",na("#luckysheet-show-selected").style.display=a.hideColumn?"block":"none",na("#luckysheet-column-row-width-selected").style.display=a.columnWidth?"block":"none",a.copy||a.copyAs||a.paste||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",a.insertColumn||a.deleteColumn||a.hideColumn||a.columnWidth||(na("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none")),a.insertColumn||a.deleteColumn||a.hideColumn||a.columnWidth||(na("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),a.sort||(na("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none"),Au(n,t.left,t.top+18),u.luckysheet_cols_menu_status=!0)}),$("#luckysheet-top-left-add-selected").click(function(e){if(e.target.nodeName!=="INPUT"){$("#luckysheet-rightclick-menu").hide(),la();var n=st(),t=n.drag,a=n.info;if(u.luckysheet_select_save.length>1)Rt()?alert(t.noMulti):Ee.info(t.noMulti,"");else{var l=$(this).find("input").val();if(M(l))if((l=parseInt(l))<1||l>100)Rt()?alert(a.tipInputNumberLimit):Ee.info(a.tipInputNumberLimit,"");else{var o=u.luckysheet_select_save[0][u.luckysheetRightHeadClickIs][0];Ls(u.luckysheetRightHeadClickIs,o,l,"lefttop")}else Rt()?alert(a.tipInputNumber):Ee.info(a.tipInputNumber,"")}}}),$("#luckysheetColsRowsHandleAdd_row").click(function(e){$("#luckysheet-rightclick-menu").hide(),la(),u.allowEdit!==!1&&Ls("row",u.luckysheet_select_save[0].row[0],1,"lefttop")}),$("#luckysheetColsRowsHandleAdd_column").click(function(e){$("#luckysheet-rightclick-menu").hide(),la(),u.allowEdit!==!1&&Ls("column",u.luckysheet_select_save[0].column[0],1,"lefttop")}),$("#luckysheet-bottom-right-add-selected").click(function(e){if(e.target.nodeName!=="INPUT"){$("#luckysheet-rightclick-menu").hide(),la();var n=st(),t=n.drag,a=n.info;if(u.luckysheet_select_save.length>1)Rt()?alert(t.noMulti):Ee.info(t.noMulti,"");else{var l=$(this).find("input").val();if(M(l))if((l=parseInt(l))<1||l>100)Rt()?alert(a.tipInputNumberLimit):Ee.info(a.tipInputNumberLimit,"");else{var o=u.luckysheet_select_save[0][u.luckysheetRightHeadClickIs][1];Ls(u.luckysheetRightHeadClickIs,o,l,"rightbottom")}else Rt()?alert(a.tipInputNumber):Ee.info(a.tipInputNumber,"")}}}),$("#luckysheet-del-selected, #luckysheet-del-selected_t").click(function(e){$("#luckysheet-rightclick-menu").hide(),la();var n=st().drag;if(u.luckysheet_select_save.length>1)(u.luckysheetRightHeadClickIs=="row"||u.luckysheetRightHeadClickIs=="column")&&(Rt()?alert(n.noMulti):Ee.info(n.noMulti,""));else{var t=u.luckysheet_select_save[0][u.luckysheetRightHeadClickIs][0],a=u.luckysheet_select_save[0][u.luckysheetRightHeadClickIs][1];kc(u.luckysheetRightHeadClickIs,t,a)}}),$("#luckysheet-delRows").click(function(e){$("#luckysheet-rightclick-menu").hide(),la();var n=st().drag;u.luckysheet_select_save.length>1?(u.luckysheetRightHeadClickIs=="row"||u.luckysheetRightHeadClickIs=="column")&&(Rt()?alert(n.noMulti):Ee.info(n.noMulti,"")):kc("row",u.luckysheet_select_save[0].row[0],u.luckysheet_select_save[0].row[1])}),$("#luckysheet-delCols").click(function(e){$("#luckysheet-rightclick-menu").hide(),la();var n=st().drag;u.luckysheet_select_save.length>1?(u.luckysheetRightHeadClickIs=="row"||u.luckysheetRightHeadClickIs=="column")&&(Rt()?alert(n.noMulti):Ee.info(n.noMulti,"")):kc("column",u.luckysheet_select_save[0].column[0],u.luckysheet_select_save[0].column[1])}),$("#luckysheet-hide-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),la();var n=st().drag;if(u.luckysheet_select_save.length>1)(u.luckysheetRightHeadClickIs=="row"||u.luckysheetRightHeadClickIs=="column")&&(Rt()?alert(n.noMulti):Ee.info(n.noMulti,""));else if(u.luckysheetRightHeadClickIs=="row"){if(!dn(u.currentSheetIndex,"formatRows"))return;var t=$.extend(!0,{},u.config);t.rowhidden==null&&(t.rowhidden={});for(var a=0;a<u.luckysheet_select_save.length;a++)for(var l=u.luckysheet_select_save[a].row[0],o=u.luckysheet_select_save[a].row[1],d=l;d<=o;d++)t.rowhidden[d]=0;if(u.clearjfundo){var s={type:"showHidRows"};s.sheetIndex=u.currentSheetIndex,s.config=$.extend(!0,{},u.config),s.curconfig=t,u.jfundo.length=0,u.jfredo.push(s)}u.config=t,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length)}else if(u.luckysheetRightHeadClickIs=="column"){if(!dn(u.currentSheetIndex,"formatColumns"))return;var h=$.extend(!0,{},u.config);h.colhidden==null&&(h.colhidden={});for(var f=0;f<u.luckysheet_select_save.length;f++)for(var p=u.luckysheet_select_save[f].column[0],g=u.luckysheet_select_save[f].column[1],v=p;v<=g;v++)h.colhidden[v]=0;if(u.clearjfundo){var y={type:"showHidCols"};y.sheetIndex=u.currentSheetIndex,y.config=$.extend(!0,{},u.config),y.curconfig=h,u.jfundo.length=0,u.jfredo.push(y)}u.config=h,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,h.colhidden,{k:"colhidden"}),ln(u.flowdata.length,u.flowdata[0].length)}}),$("#luckysheet-show-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),la();var n=st().drag;if(u.luckysheet_select_save.length>1)(u.luckysheetRightHeadClickIs=="row"||u.luckysheetRightHeadClickIs=="column")&&(Rt()?alert(n.noMulti):Ee.info(n.noMulti,""));else if(u.luckysheetRightHeadClickIs=="row"){if(!dn(u.currentSheetIndex,"formatRows"))return;var t=$.extend(!0,{},u.config);if(t.rowhidden==null)return;for(var a=0;a<u.luckysheet_select_save.length;a++)for(var l=u.luckysheet_select_save[a].row[0],o=u.luckysheet_select_save[a].row[1],d=l;d<=o;d++)delete t.rowhidden[d];if(u.clearjfundo){var s={type:"showHidRows"};s.sheetIndex=u.currentSheetIndex,s.config=$.extend(!0,{},u.config),s.curconfig=t,u.jfundo.length=0,u.jfredo.push(s)}u.config=t,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length)}else if(u.luckysheetRightHeadClickIs=="column"){if(!dn(u.currentSheetIndex,"formatColumns"))return;var h=$.extend(!0,{},u.config);if(h.colhidden==null)return;for(var f=0;f<u.luckysheet_select_save.length;f++)for(var p=u.luckysheet_select_save[f].column[0],g=u.luckysheet_select_save[f].column[1],v=p;v<=g;v++)delete h.colhidden[v];if(u.clearjfundo){var y={type:"showHidCols"};y.sheetIndex=u.currentSheetIndex,y.config=$.extend(!0,{},u.config),y.curconfig=h,u.jfundo.length=0,u.jfredo.push(y)}u.config=h,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,h.colhidden,{k:"colhidden"}),ln(u.flowdata.length,u.flowdata[0].length)}}),$("#luckysheet-delCellsMoveLeft").click(function(e){$("body .luckysheet-cols-menu").hide(),la();var n=st().drag;u.luckysheet_select_save.length>1?Rt()?alert(n.noMulti):Ee.info(n.noMulti,""):xc("moveLeft",u.luckysheet_select_save[0].row[0],u.luckysheet_select_save[0].row[1],u.luckysheet_select_save[0].column[0],u.luckysheet_select_save[0].column[1])}),$("#luckysheet-delCellsMoveUp").click(function(e){$("body .luckysheet-cols-menu").hide(),la();var n=st().drag;u.luckysheet_select_save.length>1?Rt()?alert(n.noMulti):Ee.info(n.noMulti,""):xc("moveUp",u.luckysheet_select_save[0].row[0],u.luckysheet_select_save[0].row[1],u.luckysheet_select_save[0].column[0],u.luckysheet_select_save[0].column[1])}),$("#luckysheet-delete-text").click(function(){if(wo(u.luckysheet_select_save,u.currentSheetIndex)&&($("#luckysheet-rightclick-menu").hide(),la(),u.allowEdit!==!1&&u.luckysheet_select_save.length>0)){for(var e=vr.deepCopyFlowData(u.flowdata),n=!1,t=0;t<u.luckysheet_select_save.length;t++){var a=u.luckysheet_select_save[t].row[0],l=u.luckysheet_select_save[t].row[1],o=u.luckysheet_select_save[t].column[0],d=u.luckysheet_select_save[t].column[1];if(mn(u.config,a,l,o,d)){n=!0;break}}if(n){var s=st().drag;return void(Rt()?alert(s.noPartMerge):Ee.info(s.noPartMerge,""))}for(var h=0;h<u.luckysheet_select_save.length;h++)for(var f=u.luckysheet_select_save[h].row[0],p=u.luckysheet_select_save[h].row[1],g=u.luckysheet_select_save[h].column[0],v=u.luckysheet_select_save[h].column[1],y=f;y<=p;y++)for(var b=g;b<=v;b++)Pr.isPivotRange(y,b)||(D(e[y][b])=="object"?(delete e[y][b].m,delete e[y][b].v,e[y][b].f!=null&&(delete e[y][b].f,m.delFunctionGroup(y,b,u.currentSheetIndex),delete e[y][b].spl),e[y][b].ct!=null&&e[y][b].ct.t=="inlineStr"&&delete e[y][b].ct):e[y][b]=null);wa(e,u.luckysheet_select_save)}}),$("#luckysheet-column-row-width-selected").click(function(e){if(e.target.nodeName!=="INPUT"){$("#luckysheet-rightclick-menu").hide(),la();var n,t=parseInt($(this).closest(".luckysheet-cols-menuitem").find("input[type='number']").val().trim()),a=st().info,l=$.extend(!0,{},u.config),o=null;if(u.luckysheetRightHeadClickIs=="row"){if(!dn(u.currentSheetIndex,"formatRows"))return;if(t<0||t>545)return void(Rt()?alert(a.tipRowHeightLimit):Ee.info(a.tipRowHeightLimit,""));n="resizeR",l.rowlen==null&&(l.rowlen={});for(var d=0;d<u.luckysheet_select_save.length;d++)for(var s=u.luckysheet_select_save[d].row[0],h=u.luckysheet_select_save[d].row[1],f=s;f<=h;f++)l.rowlen[f]=t,o=_r.moveChangeSize("row",f,t)}else if(u.luckysheetRightHeadClickIs=="column"){if(!dn(u.currentSheetIndex,"formatColumns"))return;if(t<0||t>2038)return void(Rt()?alert(a.tipColumnWidthLimit):Ee.info(a.tipColumnWidthLimit,""));n="resizeC",l.columnlen==null&&(l.columnlen={});for(var p=0;p<u.luckysheet_select_save.length;p++)for(var g=u.luckysheet_select_save[p].column[0],v=u.luckysheet_select_save[p].column[1],y=g;y<=v;y++)l.columnlen[y]=t,o=_r.moveChangeSize("column",y,t)}u.clearjfundo&&(u.jfundo.length=0,u.jfredo.push({type:"resize",ctrlType:n,sheetIndex:u.currentSheetIndex,config:$.extend(!0,{},u.config),curconfig:$.extend(!0,{},l),images:$.extend(!0,{},_r.images),curImages:$.extend(!0,{},o)})),u.config=l,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,u.luckysheetfile[je(u.currentSheetIndex)].images=o,nt.saveParam("all",u.currentSheetIndex,o,{k:"images"}),_r.images=o,_r.allImagesShow(),u.luckysheetRightHeadClickIs=="row"?(nt.saveParam("cg",u.currentSheetIndex,l.rowlen,{k:"rowlen"}),ln(u.flowdata.length,null)):u.luckysheetRightHeadClickIs=="column"&&(nt.saveParam("cg",u.currentSheetIndex,l.columnlen,{k:"columnlen"}),ln(null,u.flowdata[0].length))}})}function qd(e,n,t,a){var l;if(!$("#luckysheet-formula-search-c").is(":visible")||e!="up"&&e!="down"){if($("#luckysheet-formula-functionrange-select").is(":visible")){if(n&&t)ns(e,"rangeOfFormula");else if(n)mu(e,"rangeOfFormula");else if(t){var o=e,d=1;e=="up"&&(o="down",d=-1),e=="left"&&(o="right",d=-1),Ns(o,d,"rangeOfFormula")}else{var s=e,h=1;e=="up"&&(s="down",h=-1),e=="left"&&(s="right",h=-1),Vn(s,h,"rangeOfFormula")}a.preventDefault()}else if(m.israngeseleciton()){var f=$(window.getSelection().anchorNode);if(f.parent().next().text()==null||f.parent().next().text()==""){var p=$("#luckysheet-input-box #luckysheet-input-box-index").text(),g=m.getcellrange(p);g==null&&(g=m.getcellrange($("#luckysheet-input-box-index").text()));var v=g.row[0],y=g.row[1],b=g.column[0],k=g.column[1],w=u.visibledatarow[y],_=v-1==-1?0:u.visibledatarow[v-1],C=u.visibledatacolumn[k],A=b-1==-1?0:u.visibledatacolumn[b-1];if(m.func_selectedrange={left:A,width:C-A-1,top:_,height:w-_-1,left_move:A,width_move:C-A-1,top_move:_,height_move:w-_-1,row:[v,y],column:[b,k],row_focus:v,column_focus:b},m.rangeSetValue({row:[v,y],column:[b,k]}),m.rangestart=!0,m.rangedrag_column_start=!1,m.rangedrag_row_start=!1,n&&t)ns(e,"rangeOfFormula");else if(n)mu(e,"rangeOfFormula");else if(t){var I=e,S=1;e=="up"&&(I="down",S=-1),e=="left"&&(I="right",S=-1),Ns(I,S,"rangeOfFormula")}else{var E=e,R=1;e=="up"&&(E="down",R=-1),e=="left"&&(E="right",R=-1),Vn(E,R,"rangeOfFormula")}a.preventDefault()}}else if(!n&&!t){var F=$(window.getSelection().anchorNode),N=window.getSelection().anchorOffset;e=="up"?(F.parent().is("span")&&F.parent().next().length==0&&N>0||F.is("#luckysheet-rich-text-editor")&&F.context.childElementCount==N||F.parent().is("#luckysheet-rich-text-editor")&&F.context.length==N)&&(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("down",-1,"rangeOfSelect"),a.preventDefault()):e=="down"?(F.parent().is("span")&&F.parent().next().length==0&&N>0||F.is("#luckysheet-rich-text-editor")&&F.context.childElementCount==N||F.parent().is("#luckysheet-rich-text-editor")&&F.context.length==N)&&(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("down",1,"rangeOfSelect"),a.preventDefault()):e=="left"?F.parent().is("span")&&F.parent().prev().length==0&&N==0||F.is("#luckysheet-rich-text-editor")&&N==1||F.parent().is("#luckysheet-rich-text-editor")&&N==0?(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("right",-1,"rangeOfSelect"),a.preventDefault()):m.rangeHightlightselected($("#luckysheet-rich-text-editor")):e=="right"&&(F.parent().is("span")&&F.parent().next().length==0&&N>0||F.is("#luckysheet-rich-text-editor")&&F.context.childElementCount==N||F.parent().is("#luckysheet-rich-text-editor")&&F.context.length==N?(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("right",1,"rangeOfSelect"),a.preventDefault()):m.rangeHightlightselected($("#luckysheet-rich-text-editor")))}}else e=="down"?(l=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next()).length==0&&(l=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()):e=="up"&&(l=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev()).length==0&&(l=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),l.addClass("luckysheet-formula-search-item-active"),a.preventDefault()}function zx(){var e=st().drag;$("#luckysheet-input-box").click(function(){m.rangeHightlightselected($("#luckysheet-rich-text-editor"))}).add("#"+u.container).on("keydown",function(n){var t=n.ctrlKey,a=n.altKey,l=n.shiftKey,o=n.keyCode;if($("#luckysheet-modal-dialog-mask").is(":visible")||$(n.target).hasClass("luckysheet-mousedown-cancel")||$(n.target).hasClass("sp-input")||parseInt($("#luckysheet-input-box").css("top"))>0&&$(n.target).closest(".luckysheet-input-box").length>0&&o!=Yi&&o!=nh&&o!=Yo&&o!=Zo&&o!=Wo&&o!=Xo){var d=$(window.getSelection().anchorNode);if((d.parent().is("#luckysheet-helpbox-cell")||d.is("#luckysheet-helpbox-cell"))&&o==Yi){var s=$("#luckysheet-helpbox-cell").text();if(m.iscelldata(s)){var h=m.getcellrange(s);u.luckysheet_select_save=[{row:h.row,column:h.column,row_focus:h.row[0],column_focus:h.column[0]}],Ra(),$("#luckysheet-helpbox-cell").blur();var f=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),g=$("#luckysheet-cell-main").height(),v=$("#luckysheet-cell-main").width(),y=u.visibledatarow[h.row[1]],b=h.row[0]-1==-1?0:u.visibledatarow[h.row[0]-1],k=u.visibledatacolumn[h.column[1]],w=h.column[0]-1==-1?0:u.visibledatacolumn[h.column[0]-1];k-f-v+20>0?$("#luckysheet-scrollbar-x").scrollLeft(k-v+20):w-f-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(w-20),y-p-g+20>0?$("#luckysheet-scrollbar-y").scrollTop(y-g+20):b-p-20<0&&$("#luckysheet-scrollbar-y").scrollTop(b-20)}}}else if(!($("#luckysheet-modal-dialog-mask").is(":visible")||$(n.target).hasClass("luckysheet-mousedown-cancel")||$(n.target).hasClass("formulaInputFocus"))){var _=$("#luckysheet-input-box");if((a||n.metaKey)&&o==Yi&&parseInt(_.css("top"))>0){var C=u.luckysheet_select_save[u.luckysheet_select_save.length-1],A=C.row_focus,I=C.column_focus;Y1(u.flowdata[A][I]),n.preventDefault()}else if(o==Yi&&parseInt(_.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&m.searchFunctionCell!=null?m.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),u.luckysheet_select_save=[{row:[u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[0]],column:[u.luckysheetCellUpdate[1],u.luckysheetCellUpdate[1]],row_focus:u.luckysheetCellUpdate[0],column_focus:u.luckysheetCellUpdate[1]}],Vn("down",1,"rangeOfSelect")),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),n.preventDefault();else if(o==nh){if(parseInt(_.css("top"))>0)return;Vn("right",1,"rangeOfSelect"),n.preventDefault()}else if(o==i1){if(parseInt(_.css("top"))>0)return;var S=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(S.row_focus,S.column_focus,u.flowdata),n.preventDefault()}else if(o==lh&&parseInt(_.css("top"))>0)m.setfreezonFuc(n),n.preventDefault();else if(o==ed&&parseInt(_.css("top"))>0)m.dontupdate(),Vn("down",0,"rangeOfSelect"),n.preventDefault();else if(o==Yi){if($(n.target).hasClass("formulaInputFocus")||$("#luckysheet-conditionformat-dialog").is(":visible"))return;if(String.fromCharCode(o)!=null&&$("#luckysheet-cell-selected").is(":visible")){var E=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(E.row_focus,E.column_focus,u.flowdata),n.preventDefault()}}else{if(t||n.metaKey){if(l){if(u.luckysheet_shiftpositon=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),u.luckysheet_shiftkeydown=!0,o==Yo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ns("up","rangeOfSelect")}else if(o==Zo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ns("down","rangeOfSelect")}else if(o==Wo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ns("left","rangeOfSelect")}else if(o==Xo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ns("right","rangeOfSelect")}else if(o==186||o==222){var R=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(R.row_focus,R.column_focus,u.flowdata,!0);var F=fm(2);$("#luckysheet-rich-text-editor").html(F),rs($("#luckysheet-rich-text-editor")[0]),m.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),o)}}else if(o==66)$("#luckysheet-icon-bold").click();else{if(o==67){if(_r.currentImgId!=null)return void _r.copyImgItem(n);if(dr.luckysheetPaintModelOn&&dr.cancelPaintModel(),u.luckysheet_select_save.length==0)return;if(u.config.merge!=null){for(var N=!1,z=0;z<u.luckysheet_select_save.length;z++){var P=u.luckysheet_select_save[z].row[0],q=u.luckysheet_select_save[z].row[1],V=u.luckysheet_select_save[z].column[0],x=u.luckysheet_select_save[z].column[1];if(N=mn(u.config,P,q,V,x))break}if(N)return void(Rt()?alert(e.noMerge):Ee.info(e.noMerge,""))}var ee=u.luckysheetfile[je(u.currentSheetIndex)].luckysheet_conditionformat_save;if(u.luckysheet_select_save.length>1&&ee!=null&&ee.length>0){var ne=!1,ae=kr.getComputeMap();e:for(var de=0;de<u.luckysheet_select_save.length&&!ne;de++)for(var ve=u.luckysheet_select_save[de].row[0],U=u.luckysheet_select_save[de].row[1],B=u.luckysheet_select_save[de].column[0],le=u.luckysheet_select_save[de].column[1],Te=ve;Te<=U;Te++)for(var ue=B;ue<=le;ue++)if(kr.checksCF(Te,ue,ae)!=null){ne=!0;continue e}if(ne)return void(Rt()?alert(e.noMulti):Ee.info(e.noMulti,""))}if(u.luckysheet_select_save.length>1){for(var be=!0,ye=u.luckysheet_select_save[0].row[0],ce=u.luckysheet_select_save[0].row[1],Re=!0,pe=u.luckysheet_select_save[0].column[0],me=u.luckysheet_select_save[0].column[1],re=1;re<u.luckysheet_select_save.length;re++)u.luckysheet_select_save[re].row[0]==ye&&u.luckysheet_select_save[re].row[1]==ce||(be=!1),u.luckysheet_select_save[re].column[0]==pe&&u.luckysheet_select_save[re].column[1]==me||(Re=!1);if(!be&&!Re||Vs())return void(Rt()?alert(e.noMulti):Ee.info(e.noMulti,""))}return Ba.copy(n),u.luckysheet_paste_iscut=!1,To(),void n.stopPropagation()}if(o==70)Us.createDialog(0),Us.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(o==72)Us.createDialog(1),Us.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(o==73)$("#luckysheet-icon-italic").click();else{if(o==86)return Rt()||$(n.target).hasClass("formulaInputFocus")?void 0:u.luckysheet_select_save.length>1?void(Rt()?alert(e.noPaste):Ee.info(e.noPaste,"")):(Ba.isPasteAction=!0,To(),void n.stopPropagation());if(o==88){if(dr.luckysheetPaintModelOn&&dr.cancelPaintModel(),u.luckysheet_select_save.length==0)return;if(u.config.merge!=null){for(var _e=!1,Ze=0;Ze<u.luckysheet_select_save.length;Ze++){var We=u.luckysheet_select_save[Ze].row[0],Xe=u.luckysheet_select_save[Ze].row[1],Ue=u.luckysheet_select_save[Ze].column[0],mt=u.luckysheet_select_save[Ze].column[1];if(_e=mn(u.config,We,Xe,Ue,mt))break}if(_e)return void(Nt.editMode?alert(_locale_drag.noMerge):Ee.info(_locale_drag.noMerge,""))}return u.luckysheet_select_save.length>1?void(Rt()?alert(e.noMulti):Ee.info(e.noMulti,"")):(Ba.copy(n),u.luckysheet_paste_iscut=!0,To(),void n.stopPropagation())}if(o==90)return im(n),To(),void n.stopPropagation();if(o==89)return om(),To(),void n.stopPropagation();if(o==Yo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;mu("up","rangeOfSelect")}else if(o==Zo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;mu("down","rangeOfSelect")}else if(o==Wo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;mu("left","rangeOfSelect")}else if(o==Xo){if(parseInt(_.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;mu("right","rangeOfSelect")}else if(o==186){var St=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(St.row_focus,St.column_focus,u.flowdata,!0);var at=fm(1);$("#luckysheet-rich-text-editor").html(at),rs($("#luckysheet-rich-text-editor")[0]),m.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),o)}else if(o==222){var dt=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(dt.row_focus,dt.column_focus,u.flowdata,!0);var wt=fm(2);$("#luckysheet-rich-text-editor").html(wt),rs($("#luckysheet-rich-text-editor")[0]),m.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),o)}else String.fromCharCode(o).toLocaleUpperCase()=="A"&&$("#luckysheet-left-top").click()}}return void n.preventDefault()}if(l&&(o==Yo||o==Zo||o==Wo||o==Xo||a&&(o==53||o==101))){if(parseInt(_.css("top"))>0||$(n.target).hasClass("formulaInputFocus"))return;if(u.luckysheet_shiftpositon=$.extend(!0,{},u.luckysheet_select_save[u.luckysheet_select_save.length-1]),u.luckysheet_shiftkeydown=!0,o==Yo){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ns("down",-1,"rangeOfSelect")}else if(o==Zo){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ns("down",1,"rangeOfSelect")}else if(o==Wo){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ns("right",-1,"rangeOfSelect")}else if(o==Xo){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ns("right",1,"rangeOfSelect")}else!a||o!=53&&o!=101||$("#luckysheet-icon-strikethrough").click();n.preventDefault()}else if(o==ed)dr.luckysheetPaintModelOn?dr.cancelPaintModel():(bl(n),n.preventDefault()),Ra();else if(o==r1||o==e1)_r.currentImgId!=null?_r.removeImgItem():$("#luckysheet-delete-text").click(),n.preventDefault();else if(o==8&&_r.currentImgId!=null)_r.removeImgItem(),n.preventDefault();else if(o==Yo){if(parseInt(_.css("top"))>0||u.luckysheet_cell_selected_move||u.luckysheet_cell_selected_extend||$(n.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Vn("down",-1,"rangeOfSelect"),n.preventDefault()}else if(o==Zo){if(parseInt(_.css("top"))>0||u.luckysheet_cell_selected_move||u.luckysheet_cell_selected_extend||$(n.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Vn("down",1,"rangeOfSelect"),n.preventDefault()}else if(o==Wo){if(parseInt(_.css("top"))>0||u.luckysheet_cell_selected_move||u.luckysheet_cell_selected_extend||$(n.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Vn("right",-1,"rangeOfSelect"),n.preventDefault()}else if(o==Xo){if(parseInt(_.css("top"))>0||u.luckysheet_cell_selected_move||u.luckysheet_cell_selected_extend||$(n.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Vn("right",1,"rangeOfSelect"),n.preventDefault()}else if((!(o>=112&&o<=123||o<=46||o==144||o==108||n.ctrlKey||n.altKey||n.shiftKey&&(o==37||o==38||o==39||o==40))||o==8||o==32||o==46||o==0||n.ctrlKey&&o==86)&&String.fromCharCode(o)!=null&&$("#luckysheet-cell-selected").is(":visible")&&o!=t1&&o!=Cf&&o!=18){var ct=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(ct.row_focus,ct.column_focus,u.flowdata,!0),o==8&&$("#luckysheet-rich-text-editor").html("<br/>"),m.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),o)}}To(),n.stopPropagation()}}),$("#"+u.container).add("#luckysheet-input-box").keydown(function(n){if(!($("#luckysheet-modal-dialog-mask").is(":visible")||$(n.target).hasClass("luckysheet-mousedown-cancel")||$(n.target).hasClass("formulaInputFocus"))){var t=n.ctrlKey,a=(n.altKey,n.shiftKey),l=n.keyCode,o=$("#luckysheet-input-box");l==ed&&parseInt($("#luckysheet-input-box").css("top"))>0?(m.dontupdate(),Vn("down",0,"rangeOfSelect"),n.preventDefault()):l==Yi&&parseInt(o.css("top"))>0?$("#luckysheet-formula-search-c").is(":visible")&&m.searchFunctionCell!=null&&(m.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")),n.preventDefault()):l==nh&&parseInt(o.css("top"))>0?($("#luckysheet-formula-search-c").is(":visible")&&m.searchFunctionCell!=null?m.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("right",1,"rangeOfSelect")),n.preventDefault()):l==lh&&parseInt(o.css("top"))>0?(m.setfreezonFuc(n),n.preventDefault()):l==Yo&&parseInt(o.css("top"))>0?qd("up",t,a,n):l==Zo&&parseInt(o.css("top"))>0?qd("down",t,a,n):l==Wo&&parseInt(o.css("top"))>0?qd("left",t,a,n):l==Xo&&parseInt(o.css("top"))>0?qd("right",t,a,n):(!(l>=112&&l<=123||l<=46||l==144||l==108||n.ctrlKey||n.altKey||n.shiftKey&&(l==37||l==38||l==39||l==40||l==Cf||l==n1||l==l1))||l==8||l==32||l==46||n.ctrlKey&&l==86)&&(m.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),l),function(d,s,h){if(d!=null&&s!=null){var f=h[d][s];if(f!=null){var p=f.ht;if(f==null||p=="0"){var g=Wg(d,s,h),v=g.col,y=g.col_pre,b=($(window).height(),$(window).width()),k=$("#"+u.container).offset(),w=$("#luckysheet-cell-main").scrollLeft(),_=($("#luckysheet-cell-main").scrollTop(),{"min-width":v-y+1-8,"max-width":2*b/3,left:y+k.left+u.rowHeaderWidth-w-2}),C=$("#luckysheet-input-box").width();C>_["max-width"]&&(C=_["max-width"]),C<_["min-width"]&&(C=_["min-width"]);var A=_.left-C/2+(v-y)/2;A<2&&(A=2),_.left=A-2,$("#luckysheet-input-box").css(_)}}}}(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1],u.flowdata))}}).keyup(function(n){var t=n.keyCode;n.shiftKey||t!=16||(u.luckysheet_shiftkeydown=!1,u.luckysheet_shiftpositon=null),parseInt($("#luckysheet-input-box").css("top")),n.preventDefault()}),$("#luckysheet_info_detail_input").val(nt.title).css("width",10*Rc(nt.title)).keydown(function(){event.ctrlKey,event.altKey,event.shiftKey;var n=event.keyCode,t=$(this);n==Yi&&t.blur().change()}).bind("input propertychange",function(){var n=10*Rc($(this).val()),t=$("#luckysheet_info_detail_update").outerWidth(),a=$("#luckysheet_info_detail_save").outerWidth(),l=$("#luckysheet_info_detail_user").parent().outerWidth()+60,o=$("#"+u.container).outerWidth()-a-t-l-100;n>o?$("#luckysheet_info_detail_input").css("width",o):$("#luckysheet_info_detail_input").css("width",n)}).change(function(){nt.saveParam("na",null,$(this).val())}),$("#"+u.container).add("input.luckysheet-mousedown-cancel").keydown(function(n){var t=n.target.closest(".luckysheet-cols-menuitem");t!==void 0&&t!=null&&n.keyCode===13&&$(t).trigger("click")})}var Bx=["http://localhost:8080/luckysheetPluginPrint.umd.js"],Vx=["http://localhost:8080/luckysheetPluginPrint.css"],Ux={chart:function(e,n){Jg(Pb),Kg(Lb,null,function(){var t=new Vuex.Store;console.info("chartmix::",chartmix.default),Vue.use(chartmix.default,{store:t});var a=document.getElementsByTagName("body")[0];chartmix.default.initChart(a,u.lang),$(".chartSetting").css({top:"1px",bottom:"1px",position:"absolute",right:"0px",width:"350px",background:"#fff",border:"1px solid #E5E5E5","z-index":1004,"box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-webkit-box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-moz-box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none","padding-left":"30px",display:"none"}),u.createChart=chartmix.default.createChart,u.highlightChart=chartmix.default.highlightChart,u.deleteChart=chartmix.default.deleteChart,u.resizeChart=chartmix.default.resizeChart,u.changeChartRange=chartmix.default.changeChartRange,u.changeChartCellData=chartmix.default.changeChartCellData,u.getChartJson=chartmix.default.getChartJson,u.chart_selection={create:function(){var d=u.currentChart;if(!(d.rangeArray.length>1)){$("#luckysheet-chart-rangeShow").empty(),$("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();var s=d.rangeArray[0].row[0],h=d.rangeArray[0].column[0],f=d.rangeSplitArray;if(d.rangeRowCheck.exits)var p=y("rowtitle",f.rowtitle.row[0]+s,f.rowtitle.row[1]+s,f.rowtitle.column[0]+h,f.rowtitle.column[1]+h);else p="";if(d.rangeColCheck.exits)var g=y("coltitle",f.coltitle.row[0]+s,f.coltitle.row[1]+s,f.coltitle.column[0]+h,f.coltitle.column[1]+h);else g="";var v=y("content",f.content.row[0]+s,f.content.row[1]+s,f.content.column[0]+h,f.content.column[1]+h);$("#luckysheet-chart-rangeShow").append(p+g+v)}function y(b,k,w,_,C){var A=mh(),I=fh(),S=A[w],E=k-1==-1?0:A[k-1],R=I[C],F=_-1==-1?0:I[_-1];if(b=="rowtitle")var N="#C65151";return b=="coltitle"&&(N="#9667C0"),b=="content"&&(N="#4970D1"),'<div id="luckysheet-chart-rangeShow-'+b+'" style="left: '+F+"px;width: "+(R-F-1)+"px;top: "+E+"px;height: "+(S-E-1)+'px;border: none;margin: 0;position: absolute;z-index: 14;"><div class="luckysheet-chart-rangeShow-move" data-type="top" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+N+';position: absolute;left: 0;right: 0;top: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="right" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+N+';position: absolute;top: 0;bottom: 0;right: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="bottom" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+N+';position: absolute;left: 0;right: 0;bottom: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="left" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+N+';position: absolute;top: 0;bottom: 0;left: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div style="border: 2px solid #85c0fc;background: '+N+';position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 15;opacity: 0.1;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+N+';position: absolute;left: -3px;top: -3px;z-index: 19;cursor: se-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+N+';position: absolute;right: -3px;top: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+N+';position: absolute;left: -3px;bottom: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+N+';position: absolute;right: -3px;bottom: -3px;z-index: 19;cursor: se-resize;"></div></div>'}},rangeMove:!1,rangeMovexy:null,rangeMoveIndex:null,rangeMoveObj:null,rangeMoveDraging:function(d,s,h){var f=u.currentChart,p=f.rangeArray[0].row[0],g=f.rangeArray[0].column[0],v=f.rangeRowCheck,y=f.rangeColCheck,b=f.rangeSplitArray,k=pa(d.pageX,d.pageY),w=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop(),C=k[0]+w,A=k[1]+_,I=$(window).height()+_-s-h,S=$(window).width()+w,E=bg(A)[2],R=kg(C)[2],F=mh(),N=fh(),z=u.chart_selection.rangeMoveObj.attr("id");if(z=="luckysheet-chart-rangeShow-content"){var P=u.chart_selection.rangeMoveIndex[0]-u.chart_selection.rangeMovexy[0]+E;v.exits?(P<p+v.range[1]+1||A<0)&&(P=p+v.range[1]+1):(P<0||A<0)&&(P=0),((x=b.content.row[1]-b.content.row[0]+P)>=F.length-1||A>I)&&(P=F.length-1-b.content.row[1]+b.content.row[0],x=F.length-1);var q=u.chart_selection.rangeMoveIndex[1]-u.chart_selection.rangeMovexy[1]+R;y.exits?(q<g+y.range[1]+1||C<0)&&(q=g+y.range[1]+1):(q<0||C<0)&&(q=0),((V=b.content.column[1]-b.content.column[0]+q)>=N.length-1||C>S)&&(q=N.length-1-b.content.column[1]+b.content.column[0],V=N.length-1),v.exits&&y.exits?(f.rangeArray=[{row:[p,x],column:[g,V]}],f.rangeSplitArray.range={row:[p,x],column:[g,V]},f.rangeSplitArray.content={row:[P-p,x-p],column:[q-g,V-g]},f.rangeSplitArray.rowtitle={row:f.rangeSplitArray.rowtitle.row,column:[q-g,V-g]},f.rangeSplitArray.coltitle={row:[P-p,x-p],column:f.rangeSplitArray.coltitle.column}):v.exits?(f.rangeArray=[{row:[p,x],column:[q,V]}],f.rangeSplitArray.range={row:[p,x],column:[q,V]},f.rangeSplitArray.content={row:[P-p,x-p],column:f.rangeSplitArray.content.column}):y.exits?(f.rangeArray=[{row:[P,x],column:[g,V]}],f.rangeSplitArray.range={row:[P,x],column:[g,V]},f.rangeSplitArray.content={row:f.rangeSplitArray.content.row,column:[q-g,V-g]}):(f.rangeArray=[{row:[P,x],column:[q,V]}],f.rangeSplitArray.range={row:[P,x],column:[q,V]})}else if(z=="luckysheet-chart-rangeShow-rowtitle"){var V;q=u.chart_selection.rangeMoveIndex[1]-u.chart_selection.rangeMovexy[1]+R,y.exits?(q<g+y.range[1]+1||C<0)&&(q=g+y.range[1]+1):(q<0||C<0)&&(q=0),((V=b.rowtitle.column[1]-b.rowtitle.column[0]+q)>=N.length-1||C>S)&&(q=N.length-1-b.rowtitle.column[1]+b.rowtitle.column[0],V=N.length-1),y.exits?(f.rangeArray=[{row:f.rangeArray[0].row,column:[g,V]}],f.rangeSplitArray.range={row:f.rangeArray[0].row,column:[g,V]},f.rangeSplitArray.rowtitle={row:f.rangeSplitArray.rowtitle.row,column:[q-g,V-g]},f.rangeSplitArray.content={row:f.rangeSplitArray.content.row,column:[q-g,V-g]}):(f.rangeArray=[{row:f.rangeArray[0].row,column:[q,V]}],f.rangeSplitArray.range={row:f.rangeArray[0].row,column:[q,V]})}else if(z=="luckysheet-chart-rangeShow-coltitle"){var x;P=u.chart_selection.rangeMoveIndex[0]-u.chart_selection.rangeMovexy[0]+E,v.exits?(P<p+v.range[1]+1||A<0)&&(P=p+v.range[1]+1):(P<0||A<0)&&(P=0),((x=b.coltitle.row[1]-b.coltitle.row[0]+P)>=F.length-1||A>I)&&(P=F.length-1-b.coltitle.row[1]+b.coltitle.row[0],x=F.length-1),v.exits?(f.rangeArray=[{row:[p,x],column:f.rangeArray[0].column}],f.rangeSplitArray.range={row:[p,x],column:f.rangeArray[0].column},f.rangeSplitArray.coltitle={row:[P-p,x-p],column:f.rangeSplitArray.coltitle.column},f.rangeSplitArray.content={row:[P-p,x-p],column:f.rangeSplitArray.content.column}):(f.rangeArray=[{row:[P,x],column:f.rangeArray[0].column}],f.rangeSplitArray.range={row:[P,x],column:f.rangeArray[0].column})}u.chart_selection.create()},rangeMoveDragged:function(){u.chart_selection.rangeMove=!1;var d=u.currentChart;d.rangeTxt=wn(u.currentSheetIndex,d.rangeArray[0],u.currentSheetIndex),d.chartData=nn(d.rangeArray[0],u.currentSheetIndex),u.changeChartRange(d.chart_id,d.chartData,d.rangeArray,d.rangeTxt)},rangeResize:!1,rangeResizexy:null,rangeResizeIndex:null,rangeResizeObj:null,rangeResizeDraging:function(d,s,h){var f=u.currentChart,p=f.rangeArray[0].row[0],g=f.rangeArray[0].column[0],v=f.rangeRowCheck,y=f.rangeColCheck,b=(f.rangeSplitArray,pa(d.pageX,d.pageY)),k=$("#luckysheet-cell-main").scrollLeft(),w=$("#luckysheet-cell-main").scrollTop(),_=b[0]+k,C=b[1]+w,A=$(window).height()+w-s-h,I=$(window).width()+k,S=bg(C)[2],E=kg(_)[2],R=mh(),F=fh(),N=u.chart_selection.rangeResizeObj.attr("id");if(N=="luckysheet-chart-rangeShow-content")u.chart_selection.rangeResize=="lt"?(ee=u.chart_selection.rangeResizeIndex.row[0],z=u.chart_selection.rangeResizeIndex.column[0],ne=u.chart_selection.rangeResizeIndex.row[1],P=u.chart_selection.rangeResizeIndex.column[1]):u.chart_selection.rangeResize=="lb"?(ee=u.chart_selection.rangeResizeIndex.row[1],z=u.chart_selection.rangeResizeIndex.column[0],ne=u.chart_selection.rangeResizeIndex.row[0],P=u.chart_selection.rangeResizeIndex.column[1]):u.chart_selection.rangeResize=="rt"?(ee=u.chart_selection.rangeResizeIndex.row[0],z=u.chart_selection.rangeResizeIndex.column[1],ne=u.chart_selection.rangeResizeIndex.row[1],P=u.chart_selection.rangeResizeIndex.column[0]):u.chart_selection.rangeResize=="rb"&&(ee=u.chart_selection.rangeResizeIndex.row[1],z=u.chart_selection.rangeResizeIndex.column[1],ne=u.chart_selection.rangeResizeIndex.row[0],P=u.chart_selection.rangeResizeIndex.column[0]),v.exits?(ae=ee-u.chart_selection.rangeResizexy[0]+S)<p+v.range[1]+1||C<0?ae=p+v.range[1]+1:(ae>=R.length-1||C>A)&&(ae=R.length-1):(ae=p-u.chart_selection.rangeResizexy[0]+S)<0||C<0?ae=0:(ae>=R.length-1||C>A)&&(ae=R.length-1),y.exits?(q=z-u.chart_selection.rangeResizexy[1]+E)<g+y.range[1]+1||_<0?q=g+y.range[1]+1:(q>=F.length-1||_>I)&&(q=F.length-1):(q=g-u.chart_selection.rangeResizexy[1]+E)<0||_<0?q=0:(q>=F.length-1||_>I)&&(q=F.length-1),ae>ne?(de=ne,ve=ae):(de=ae,ve=ne),q>P?(V=P,x=q):(V=q,x=P),v.exits||y.exits?(f.rangeArray=[{row:[p,ve],column:[g,x]}],f.rangeSplitArray.range={row:[p,ve],column:[g,x]},f.rangeSplitArray.content={row:[de-p,ve-p],column:[V-g,x-g]},v.exits&&(f.rangeSplitArray.rowtitle={row:f.rangeSplitArray.rowtitle.row,column:[V-g,x-g]}),y.exits&&(f.rangeSplitArray.coltitle={row:[de-p,ve-p],column:f.rangeSplitArray.coltitle.column})):(f.rangeArray=[{row:[de,ve],column:[V,x]}],f.rangeSplitArray.range={row:[de,ve],column:[V,x]});else if(N=="luckysheet-chart-rangeShow-rowtitle"){var z,P,q,V,x;u.chart_selection.rangeResize=="lt"||u.chart_selection.rangeResize=="lb"?(z=u.chart_selection.rangeResizeIndex.column[0],P=u.chart_selection.rangeResizeIndex.column[1]):u.chart_selection.rangeResize!="rt"&&u.chart_selection.rangeResize!="rb"||(z=u.chart_selection.rangeResizeIndex.column[1],P=u.chart_selection.rangeResizeIndex.column[0]),y.exits?(q=z-u.chart_selection.rangeResizexy[1]+E)<g+y.range[1]+1||_<0?q=g+y.range[1]+1:(q>=F.length-1||_>I)&&(q=F.length-1):(q=g-u.chart_selection.rangeResizexy[1]+E)<0||_<0?q=0:(q>=F.length-1||_>I)&&(q=F.length-1),q>P?(V=P,x=q):(V=q,x=P),y.exits?(f.rangeArray=[{row:f.rangeArray[0].row,column:[g,x]}],f.rangeSplitArray.range={row:f.rangeArray[0].row,column:[g,x]},f.rangeSplitArray.rowtitle={row:f.rangeSplitArray.rowtitle.row,column:[V-g,x-g]},f.rangeSplitArray.content={row:f.rangeSplitArray.content.row,column:[V-g,x-g]}):(f.rangeArray=[{row:f.rangeArray[0].row,column:[V,x]}],f.rangeSplitArray.range={row:f.rangeArray[0].row,column:[V,x]})}else if(N=="luckysheet-chart-rangeShow-coltitle"){var ee,ne,ae,de,ve;u.chart_selection.rangeResize=="lt"||u.chart_selection.rangeResize=="rt"?(ee=u.chart_selection.rangeResizeIndex.row[0],ne=u.chart_selection.rangeResizeIndex.row[1]):u.chart_selection.rangeResize!="lb"&&u.chart_selection.rangeResize!="rb"||(ee=u.chart_selection.rangeResizeIndex.row[1],ne=u.chart_selection.rangeResizeIndex.row[0]),v.exits?(ae=ee-u.chart_selection.rangeResizexy[0]+S)<p+v.range[1]+1||C<0?ae=p+v.range[1]+1:(ae>=R.length-1||C>A)&&(ae=R.length-1):(ae=p-u.chart_selection.rangeResizexy[0]+S)<0||C<0?ae=0:(ae>=R.length-1||C>A)&&(ae=R.length-1),ae>ne?(de=ne,ve=ae):(de=ae,ve=ne),v.exits?(f.rangeArray=[{row:[p,ve],column:f.rangeArray[0].column}],f.rangeSplitArray.range={row:[p,ve],column:f.rangeArray[0].column},f.rangeSplitArray.coltitle={row:[de-p,ve-p],column:f.rangeSplitArray.coltitle.column},f.rangeSplitArray.content={row:[de-p,ve-p],column:f.rangeSplitArray.content.column}):(f.rangeArray=[{row:[de,ve],column:f.rangeArray[0].column}],f.rangeSplitArray.range={row:[de,ve],column:f.rangeArray[0].column})}u.chart_selection.create()},rangeResizeDragged:function(){u.chart_selection.rangeResize=null;var d=u.currentChart;d.rangeTxt=wn(u.currentSheetIndex,d.rangeArray[0],u.currentSheetIndex),d.chartData=nn(d.rangeArray[0],u.currentSheetIndex),u.changeChartRange(d.chart_id,d.chartData,d.rangeArray,d.rangeTxt)}},u.chartparam.jfrefreshchartall=zb,u.chartparam.changeChartCellData=chartmix.default.changeChartCellData,u.chartparam.renderChart=chartmix.default.renderChart,u.chartparam.getChartJson=chartmix.default.getChartJson,u.chartparam.insertToStore=chartmix.default.insertToStore;for(var l=0;l<e.length;l++)Ob(e[l].chart,n);for(var o=0;o<e.length;o++)e[o].status=="1"&&Ig(e[o].index);ev(u.asyncLoad,"chart")})},print:function(e,n){Jg(Vx),Kg(Bx,null,function(){})}},Hx={SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(M(a))t.push(a);else{if(D(a)!="boolean")return m.error.v;a.toString().toLowerCase()=="true"?t.push(1):a.toString().toLowerCase()=="false"&&t.push(0)}}var l=0;if(t.length>0)for(e=0;e<t.length;e++){if(j(t[e]))return t[e];M(t[e])&&(l=luckysheet_calcADPMM(l,"+",t[e]))}return l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else t=t.concat(a);else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!0)):t.push(a)}var l=0,o=0;for(e=0;e<t.length;e++){if(j(t[e]))return t[e];if(!M(t[e]))return m.error.v;l=luckysheet_calcADPMM(l,"+",t[e]),o++}return o==0?m.error.d:luckysheet_calcADPMM(l,"/",o)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else t=t.concat(a);else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!0)):D(a)=="boolean"?a.toString().toLowerCase()=="true"?t.push(1):a.toString().toLowerCase()=="false"&&t.push(0):t.push(a)}var l=0;for(e=0;e<t.length;e++)M(t[e])&&l++;return l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a))}else t=t.concat(a);else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!0)):t.push(a)}return t.length}catch(l){return l=m.errorInfo(l),[m.error.v,l]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else t=t.concat(a);else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}var l=null;for(e=0;e<t.length;e++){if(j(t[e]))return t[e];M(t[e])&&(l==null||parseFloat(t[e])>l)&&(l=parseFloat(t[e]))}return l??0}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else t=t.concat(a);else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}var l=null;for(e=0;e<t.length;e++){if(j(t[e]))return t[e];M(t[e])&&(l==null||parseFloat(t[e])<l)&&(l=parseFloat(t[e]))}return l??0}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return m.error.v;var a=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(j(a))return a;a=Q(a);var l=Q();if(arguments.length==2){if(j(l=T.getFirstValue(arguments[1])))return l;l=Q(l)}var o=l.diff(a,"years");return o<0||o.toString()=="NaN"?m.error.v:o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]).toString();return j(t)?t:window.luckysheet_function.ISIDCARD.f(t)?parseInt(t.substr(16,1))%2==1?"":"":m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]).toString();if(j(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return m.error.v;var a="";t.length==15?a="19"+t.substring(6,8)+"/"+t.substring(8,10)+"/"+t.substring(10,12):t.length==18&&(a=t.substring(6,10)+"/"+t.substring(10,12)+"/"+t.substring(12,14));var l=0;if(arguments[1]!=null&&j(l=T.getFirstValue(arguments[1])))return l;if(!M(l)||(l=parseInt(l))<0||l>2)return m.error.v;if(parseInt(l)==0)return a;if(parseInt(l)==1)return Q(a).format("YYYY-MM-DD");if(parseInt(l)==2)return Q(a).format("YYYYMD")}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]).toString();if(j(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return m.error.v;var a="",l=m.classlist.province;return t.substring(0,2)in l&&(a=l[t.substring(0,2)]),a}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]).toString();if(j(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return m.error.v;var a=cityData.length,l="";for(e=0;e<a;e++)if(t.substring(0,6)==cityData[e].code){l=cityData[e].title;break}return l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return m.error.v;var a=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(j(a))return a;var l=(a=new Date(a)).getMonth(),o=a.getDate(),d=new Date(1999,l,o,0,0,0),s=[];for(s.push(["",new Date(1999,0,1,0,0,0)]),s.push(["",new Date(1999,0,20,0,0,0)]),s.push(["",new Date(1999,1,19,0,0,0)]),s.push(["",new Date(1999,2,21,0,0,0)]),s.push(["",new Date(1999,3,21,0,0,0)]),s.push(["",new Date(1999,4,21,0,0,0)]),s.push(["",new Date(1999,5,22,0,0,0)]),s.push(["",new Date(1999,6,23,0,0,0)]),s.push(["",new Date(1999,7,23,0,0,0)]),s.push(["",new Date(1999,8,23,0,0,0)]),s.push(["",new Date(1999,9,23,0,0,0)]),s.push(["",new Date(1999,10,22,0,0,0)]),s.push(["",new Date(1999,11,22,0,0,0)]),e=s.length-1;e>=0;e--)if(d>=s[e][1])return s[e][0];return""}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return m.error.v;var a=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(j(a))return a;a=new Date(a);var l=new Array("","","","","","","","","","","",""),o=(parseInt(a.getFullYear())+9)%12;return o==null||isNaN(o)?"":l[o]}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return!!a.test(t)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0],"text");if(j(o))return o;var d=0;return arguments[1]!=null&&j(d=T.getFirstValue(arguments[1]))?d:M(d)?(d=parseInt(d))!=0&&d!=1&&d!=2?m.error.v:($.post("/dataqk/tu/api/cutword",{text:o,type:d},function(h){var f=[].concat(u.flowdata);m.execFunctionGroup(t,a,h),f[t][a]={v:h,f:l},wa(f,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0],"text");if(j(o))return o;var d=20;if(arguments[1]!=null&&j(d=T.getFirstValue(arguments[1])))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=0;return arguments[2]!=null&&j(s=T.getFirstValue(arguments[2]))?s:M(s)?(s=parseInt(s),d<0||s!=0&&s!=1&&s!=2?m.error.v:($.post("/dataqk/tu/api/tfidf",{text:o,count:d,set:s},function(f){var p=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,f),p[t][a]={v:f,f:l},wa(p,[{row:[t,t],column:[a,a]}])}),"loading...")):m.error.v}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0],"text");if(j(o))return o;var d=20;if(arguments[1]!=null&&j(d=T.getFirstValue(arguments[1])))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=0;return arguments[2]!=null&&j(s=T.getFirstValue(arguments[2]))?s:M(s)?(s=parseInt(s),d<0||s!=0&&s!=1&&s!=2?m.error.v:($.post("/dataqk/tu/api/tfidf",{text:o,count:d,set:s},function(f){var p=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,f),p[t][a]={v:f,f:l},wa(p,[{row:[t,t],column:[a,a]}])}),"loading...")):m.error.v}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0]);if(j(o))return o;var d=null;if(arguments[1]!=null){var s=arguments[1];if(D(s)=="array")return m.error.v;if(D(s)=="object"&&s.startCell!=null){if(s.data==null||D(s.data)=="array"||s.data.ct==null||s.data.ct.t!="d")return m.error.v;d=za("yyyy-mm-dd",s.data.v)}else d=s;if(!un(d))return[m.error.v,""];d=Q(d).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&j(h=T.getFirstValue(arguments[2]))?h:M(h)?(h=parseInt(h))!=0&&h!=1&&h!=2?m.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:o,date:d,price:h,type:"0"},function(p){var g=vr.deepCopyFlowData(u.flowdata),v=Bl(p);v==null&&(v=p),m.execFunctionGroup(t,a,v),g[t][a]={v,f:l},wa(g,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0]);if(j(o))return o;var d=null;if(arguments[1]!=null){var s=arguments[1];if(D(s)=="array")return m.error.v;if(D(s)=="object"&&s.startCell!=null){if(s.data==null||D(s.data)=="array"||s.data.ct==null||s.data.ct.t!="d")return m.error.v;d=za("yyyy-mm-dd",s.data.v)}else d=s;if(!un(d))return[m.error.v,""];d=Q(d).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&j(h=T.getFirstValue(arguments[2]))?h:M(h)?(h=parseInt(h))!=0&&h!=1&&h!=2?m.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:o,date:d,price:h,type:"1"},function(p){var g=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,p),g[t][a]={v:p,f:l},wa(g,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0]);if(j(o))return o;var d=null;if(arguments[1]!=null){var s=arguments[1];if(D(s)=="array")return m.error.v;if(D(s)=="object"&&s.startCell!=null){if(s.data==null||D(s.data)=="array"||s.data.ct==null||s.data.ct.t!="d")return m.error.v;d=za("yyyy-mm-dd",s.data.v)}else d=s;if(!un(d))return[m.error.v,""];d=Q(d).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&j(h=T.getFirstValue(arguments[2]))?h:M(h)?(h=parseInt(h))!=0&&h!=1&&h!=2?m.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:o,date:d,price:h,type:"2"},function(p){var g=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,p),g[t][a]={v:p,f:l},wa(g,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0]);if(j(o))return o;var d=null;if(arguments[1]!=null){var s=arguments[1];if(D(s)=="array")return m.error.v;if(D(s)=="object"&&s.startCell!=null){if(s.data==null||D(s.data)=="array"||s.data.ct==null||s.data.ct.t!="d")return m.error.v;d=za("yyyy-mm-dd",s.data.v)}else d=s;if(!un(d))return[m.error.v,""];d=Q(d).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&j(h=T.getFirstValue(arguments[2]))?h:M(h)?(h=parseInt(h))!=0&&h!=1&&h!=2?m.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:o,date:d,price:h,type:"3"},function(p){var g=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,p),g[t][a]={v:p,f:l},wa(g,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0]);if(j(o))return o;var d=null;if(arguments[1]!=null){var s=arguments[1];if(D(s)=="array")return m.error.v;if(D(s)=="object"&&s.startCell!=null){if(s.data==null||D(s.data)=="array"||s.data.ct==null||s.data.ct.t!="d")return m.error.v;d=za("yyyy-mm-dd",s.data.v)}else d=s;if(!un(d))return[m.error.v,""];d=Q(d).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&j(h=T.getFirstValue(arguments[2]))?h:M(h)?(h=parseInt(h))!=0&&h!=1&&h!=2?m.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:o,date:d,price:h,type:"4"},function(p){var g=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,p),g[t][a]={v:p,f:l},wa(g,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=T.getFirstValue(arguments[0]);if(j(o))return o;var d=null;if(arguments[1]!=null){var s=arguments[1];if(D(s)=="array")return m.error.v;if(D(s)=="object"&&s.startCell!=null){if(s.data==null||D(s.data)=="array"||s.data.ct==null||s.data.ct.t!="d")return m.error.v;d=za("yyyy-mm-dd",s.data.v)}else d=s;if(!un(d))return[m.error.v,""];d=Q(d).format("YYYY-MM-DD")}var h=0;return arguments[2]!=null&&j(h=T.getFirstValue(arguments[2]))?h:M(h)?(h=parseInt(h))!=0&&h!=1&&h!=2?m.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:o,date:d,price:h,type:"5"},function(p){var g=vr.deepCopyFlowData(u.flowdata);m.execFunctionGroup(t,a,p),g[t][a]={v:p,f:l},wa(g,[{row:[t,t],column:[a,a]}])}),"loading..."):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:un(t)}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=0,a=arguments[0].data,l=arguments[0].rowl,o=arguments[0].coll,d=fd(arguments[1]);if(a=m.getRangeArray(a)[0],arguments[2]){var s=[],h=arguments[2].startCell,f=arguments[2].rowl,p=arguments[2].coll,g=arguments[2].sheetName;if(l==f&&o==p)s=arguments[2].data;else{var v=[],y=[];v[0]=parseInt(h.replace(/[^0-9]/g,""))-1,y[0]=rl(h.replace(/[^A-Za-z]/g,"")),v[1]=v[0]+l-1,y[1]=y[0]+o-1;var b=ya(y[1]),k=v[1]+1;s=no(g+"!"+h+":"+(b+k)).data}for(s=m.getRangeArray(s)[0],e=0;e<a.length;e++)if((w=a[e])&&m.acompareb(w,d)){if(!M(s[e]))continue;t=luckysheet_calcADPMM(t,"+",s[e])}}else for(e=0;e<a.length;e++){var w;if((w=a[e])&&m.acompareb(w,d)){if(!M(w))continue;t=luckysheet_calcADPMM(t,"",w)}}return t}catch(C){var _=C;return _=m.errorInfo(_),[m.error.v,_]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.tan(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=Math.exp(2*t);return(a-1)/(a+1)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseFloat(a))==0?0:t>0&&a<0?m.error.nm:Math.ceil(t/a)*a:m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.atan(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.log(t+Math.sqrt(t*t+1))):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.abs(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<-1||t>1?m.error.nm:Math.acos(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<1?m.error.nm:Math.log(t+Math.sqrt(t*t-1)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}var l=0,o=1;for(e=0;e<t.length;e++){var d=t[e];if(!M(d))return m.error.v;if((d=parseFloat(d))<0)return m.error.nm;l+=d,o*=T.factorial(d)}return T.factorial(l)/o}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<=-1||t>=1?m.error.nm:Math.log((1+t)/(1-t))/2:m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseFloat(a),t==0&&a==0?m.error.d:Math.atan2(a,t)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=0;if(D(t)=="object"&&t.startCell!=null){if(t.data==null)return 1;if(D(t.data)=="array")for(var l=0;l<t.data.length;l++)for(var o=0;o<t.data[l].length;o++)(t.data[l][o]==null||$t(t.data[l][o].v))&&a++;else $t(t.data.v)&&a++}return a}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),(Math.exp(t)+Math.exp(-t))/2):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0];if(D(t)=="array")return D(t[0])=="array"?T.isDyadicArr(t)&&M(t[0][0])?Math.floor(parseFloat(t[0][0])):m.error.v:M(t[0])?Math.floor(parseFloat(t[0])):m.error.v;if(D(t)=="object"&&t.startCell!=null){if(t.coll>1)return m.error.v;if(t.rowl>1){var a=m.getcellrange(t.startCell),l=a.row[0];if(window.luckysheetCurrentRow<l||window.luckysheetCurrentRow>l+t.rowl-1)return m.error.v;var o=t.data[window.luckysheetCurrentRow-l][0]}else o=t.data;return o==null||$t(o.v)?0:M(o.v)?Math.floor(parseFloat(o.v)):m.error.v}if(D(t)=="boolean"){if(t.toString().toLowerCase()=="true")return 1;if(t.toString().toLowerCase()=="false")return 0}return M(t)?Math.floor(parseFloat(t)):m.error.v}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseInt(t),!(1&Math.abs(t))):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseInt(t),!!(1&Math.abs(t))):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a))}else t=t.concat(a);else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}for(var l=0;l<t.length;l++){var o=t[l];if(!M(o))return m.error.v;if((o=parseInt(o))<0)return m.error.nm;t[l]=o}for(var d,s,h,f=1;(s=t.pop())!==void 0;)for(s==0&&(f=0);s>1;){if(s%2){for(e=3,d=Math.floor(Math.sqrt(s));e<=d&&s%e;e+=2);h=e<=d?e:s}else h=2;for(s/=h,f*=h,e=t.length;e;t[--e]%h==0&&(t[e]/=h)==1&&t.splice(e,1));}return f>=Math.pow(2,53)?m.error.nm:f}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<=0?m.error.nm:Math.log(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;if((t=parseFloat(t))<=0)return m.error.nm;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;if((a=parseFloat(a))<=0)return m.error.nm}else var a=10;return Math.log(t)/Math.log(a)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<=0?m.error.nm:Math.log(t)/Math.log(10):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;if((a=parseFloat(a))==0)return m.error.d;var l=Math.abs(t%a);return a>0?l:-l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t*(a=parseFloat(a))<0?m.error.nm:Math.round(t/a)*a:m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=Math.ceil(Math.abs(t));return a=1&a?a:a+1,t>=0?a:-a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}var l=0;if(t.length>0)for(e=0;e<t.length;e++){var o=t[e];if(!M(o))return m.error.v;l+=(o=parseFloat(o))*o}return l}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<0||a<0||t<a?m.error.nm:T.factorial(t)/(T.factorial(a)*T.factorial(t-a))):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let p=function(g){switch(g){case 1:case 101:return window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,d);case 2:case 102:return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,d);case 3:case 103:return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,d);case 4:case 104:return window.luckysheet_function.MAX.f.apply(window.luckysheet_function.MAX,d);case 5:case 105:return window.luckysheet_function.MIN.f.apply(window.luckysheet_function.MIN,d);case 6:case 106:return window.luckysheet_function.PRODUCT.f.apply(window.luckysheet_function.PRODUCT,d);case 7:case 107:return window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,d);case 8:case 108:return window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,d);case 9:case 109:return window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,d);case 10:case 110:return window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,d);case 11:case 111:return window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,d)}};var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;for(t=[],e=0;e<a.length;e++){for(var l=[],o=0;o<a[e].length;o++)l.push(a[e][o]);t.push(l)}}else for(t=[],e=0;e<a.length;e++)t.push(a[e]);else t=D(a)=="object"&&a.startCell!=null?T.getFirstValue(a):a;var d=Array.prototype.slice.apply(arguments);if(d.shift(),D(t)=="array"){var s=[];if(D(t[0])=="array")for(e=0;e<t.length;e++){for(l=[],o=0;o<t[e].length;o++)j(h=t[e][o])?l.push(h):M(h)?(h=parseInt(h))<1||h>111||h>11&&h<101?l.push(m.error.v):l.push(p(h)):l.push(m.error.v);s.push(l)}else for(e=0;e<t.length;e++){var h;j(h=t[e])?s.push(h):M(h)?(h=parseInt(h))<1||h>111||h>11&&h<101?s.push(m.error.v):s.push(p(h)):s.push(m.error.v)}return s}return j(t)?t:M(t)?(t=parseInt(t))<1||t>111||t>11&&t<101?m.error.v:p(t):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<-1||t>1?m.error.nm:Math.asin(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let p=function(g,v){/[<>=!*?]/.test(v)||(v='=="'+v+'"'),v=v.replace("<>","!=");var y=0;if(D(g)=="array"){for(var b=0;b<g.length;b++)for(var k=0;k<g[b].length;k++)if(g[b][k]!=null&&!$t(g[b][k].v)){var w=g[b][k].v;v.indexOf("*")>-1||v.indexOf("?")>-1?m.isWildcard(w,v)&&y++:typeof w!="string"?new Function("return "+w+v)()&&y++:new Function('return "'+w+'"'+v)()&&y++}}else g!=null&&!$t(g.v)&&(w=g.v,v.indexOf("*")>-1||v.indexOf("?")>-1?m.isWildcard(w,v)&&y++:typeof w!="string"?new Function("return "+w+v)()&&y++:new Function('return "'+w+'"'+v)()&&y++);return y};var t,a=arguments[0];if(D(a)!="object"||a.startCell==null)return m.error.v;t=a.data;var l,o=arguments[1];if(D(o)=="array")if(l=[],D(o[0])=="array"){if(!T.isDyadicArr(o))return m.error.v;for(e=0;e<o.length;e++){for(var d=[],s=0;s<o[e].length;s++)d.push(o[e][s]);l.push(d)}}else for(e=0;e<o.length;e++)l.push(o[e]);else if(D(o)=="object"&&o.startCell!=null){if(o.rowl>1||o.coll>1)return 0;l=o.data.v}else l=o;if(D(l)=="array"){var h=[];if(D(l[0])=="array")for(e=0;e<l.length;e++){for(d=[],s=0;s<l[e].length;s++)d.push(p(t,l[e][s]));h.push(d)}else for(e=0;e<l.length;e++)h.push(p(t,l[e]));return h}return p(t,l)}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))*Math.PI/180:m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;try{return Math.floor(1e9*Math.random())/1e9}catch(n){var e=n;return e=m.errorInfo(e),[m.error.v,e]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!0)):t.push(a)}return window.luckysheet_function.UNIQUE.f(t)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?180*(t=parseFloat(t))/Math.PI:m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),jStat.erfc(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=Math.ceil(Math.abs(t));return a=1&a?a+1:a,t>0?a:-a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.exp(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t)){if(D(t)!="boolean")return m.error.v;t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0)}return(t=parseInt(t))<0?m.error.nm:T.factorial(t)}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t)){if(D(t)!="boolean")return m.error.v;t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0)}return(t=parseInt(t))<0?m.error.nm:T.factorialDouble(t)}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;try{return Math.PI}catch(n){var e=n;return e=m.errorInfo(e),[m.error.v,e]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;if((a=parseFloat(a))==0)return m.error.d;if(t>0&&a<0)return m.error.nm;var l=-Math.floor(Math.log(Math.abs(a))/Math.log(10));return t>=0?Math.floor(t/a)*a*Math.pow(10,l)/Math.pow(10,l):-Math.ceil(Math.abs(t)/a)*a*Math.pow(10,l)/Math.pow(10,l)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!1)):t.push(a)}if(!M(t[0]))return m.error.v;var l=parseInt(t[0]);if(l<0||l>=Math.pow(2,53))return m.error.nm;for(e=1;e<t.length;e++){var o=t[e];if(!M(o))return m.error.v;if((o=parseInt(o))<0||o>=Math.pow(2,53))return m.error.nm;for(;l&&o;)l>o?l%=o:o%=l;l+=o}return l}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t>(a=parseInt(a))?m.error.nm:t+Math.ceil((a-t+1)*Math.random())-1:m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=t>0?1:-1;return l*Math.round(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=t>0?1:-1;return l*Math.floor(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=t>0?1:-1;return l*Math.ceil(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=arguments[3],d=[];if(D(o)=="array"){if(D(o[0])=="array"&&!T.isDyadicArr(o))return m.error.v;d=d.concat(T.getDataArr(o,!1))}else D(o)=="object"&&o.startCell!=null?d=d.concat(T.getCellDataArr(o,"number",!1)):d.push(o);if(!M(d[0]))return m.error.v;var s=parseFloat(d[0])*Math.pow(t,a);for(e=1;e<d.length;e++){var h=d[e];if(!M(h))return m.error.v;s+=(h=parseFloat(h))*Math.pow(t,a+e*l)}return s}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;if((t=parseFloat(t))>0)return 1;if(t==0)return 0;if(t<0)return-1}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.sin(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),(Math.exp(t)-Math.exp(-t))/2):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<0?m.error.nm:Math.sqrt(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<0?m.error.nm:Math.sqrt(t*Math.PI):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<=0?m.error.nm:jStat.gammaln(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t),Math.cos(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;if(t=parseFloat(t),arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}else var a=0;var l=t>0?1:-1;return l*Math.floor(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseFloat(a))==0?m.error.d:parseInt(t/a,10):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseFloat(a),t==0&&a==0||t<0&&a.toString().indexOf(".")>-1?m.error.nm:Math.pow(t,a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=0,a=arguments;Bs(a);var l=m.getRangeArray(a[0])[0],o=new Array(l.length);for(e=0;e<o.length;e++)o[e]=!0;for(e=1;e<a.length;e+=2)for(var d=m.getRangeArray(a[e])[0],s=a[e+1],h=0;h<d.length;h++){var f=d[h];o[h]=o[h]&&!!f&&m.acompareb(f,s)}for(e=0;e<l.length;e++)o[e]&&(t=luckysheet_calcADPMM(t,"+",l[e]));return t}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments;Bs(t);var a=new Array(m.getRangeArray(t[0])[0].length);for(e=0;e<a.length;e++)a[e]=!0;for(e=0;e<t.length;e+=2)for(var l=m.getRangeArray(t[e])[0],o=t[e+1],d=0;d<l.length;d++){var s=l[d];a[d]=a[d]&&!!s&&m.acompareb(s,o)}var h=0;for(e=0;e<a.length;e++)a[e]&&h++;return h}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}var l=1;for(e=0;e<t.length;e++){var o=t[e];if(!M(o))return m.error.v;l*=o=parseFloat(o)}return l}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"number",!0)):t.push(a)}var l=0,o=0;for(e=0;e<t.length;e++){var d=t[e];if(!M(d))return m.error.v;if((d=parseFloat(d))<=0)return m.error.nm;l+=1/d,o++}return o/l}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let h=function(p,g,v,y){return T.factorial(v)/(T.factorial(p)*T.factorial(v-p))*(T.factorial(y-v)/(T.factorial(g-p)*T.factorial(y-v-g+p)))/(T.factorial(y)/(T.factorial(g)*T.factorial(y-g)))},f=function(p,g,v,y){for(var b=0,k=0;k<=p;k++)b+=h(k,g,v,y);return b};var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseInt(o);var d=T.getCellBoolen(arguments[4]);return j(d)?d:t<0||t>Math.min(a,l)||t<Math.max(0,a-o+l)||a<=0||a>o||l<=0||l>o||o<=0?m.error.nm:d?f(t,a,l,o):h(t,a,l,o)}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=0,a=arguments[0],l=[];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;l=l.concat(T.getDataArr(a,!1))}else D(a)=="object"&&a.startCell!=null?l=l.concat(T.getCellDataArr(a,"text",!1)):l.push(a);var o=arguments[1],d=[];if(D(o)=="array"){if(D(o[0])=="array"&&!T.isDyadicArr(o))return m.error.v;d=d.concat(T.getDataArr(o,!1))}else D(o)=="object"&&o.startCell!=null?d=d.concat(T.getCellDataArr(o,"text",!1)):d.push(o);if(l.length!=d.length)return m.error.na;var s=[],h=[];for(e=0;e<l.length;e++){var f=l[e],p=d[e];M(f)&&M(p)&&(s.push(parseFloat(f)),h.push(parseFloat(p)))}if(T.variance_s(h)==0)return m.error.d;var g=jStat.mean(h),v=jStat.mean(s),y=h.length,b=0,k=0;for(e=0;e<y;e++)b+=(h[e]-g)*(s[e]-v),k+=Math.pow(h[e]-g,2);var w=b/k,_=v-w*g;return _+w*t}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!0)):t.push(a)}for(var l=[],o=0;o<t.length;o++){var d=t[o];if(!M(d))return m.error.v;d=parseFloat(d),l.push(d)}if(l.length<4||T.standardDeviation_s(l)==0)return m.error.d;var s=jStat.mean(l),h=l.length,f=0;for(e=0;e<h;e++)f+=Math.pow(l[e]-s,4);return h*(h+1)/((h-1)*(h-2)*(h-3))*(f/=Math.pow(jStat.stdev(l,!0),4))-3*(h-1)*(h-1)/((h-2)*(h-3))}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!0))}else D(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(T.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var a=[],l=0;l<t.length;l++){var o=t[l];if(!M(o))return m.error.v;o=parseFloat(o),a.push(o)}if(D(arguments[1])=="array"){if(D(arguments[1][0])=="array"&&!T.isDyadicArr(arguments[1]))return m.error.v;s=T.getDataArr(arguments[1])}else if(D(arguments[1])=="object"&&arguments[1].startCell!=null){if(arguments[1].rowl>1||arguments[1].coll>1)return m.error.v;var d=arguments[1].data;if(d==null||$t(d.v))var s=0;else s=d.v}else s=arguments[1];if(D(s)=="array"){if(a.length==0)return m.error.nm;var h=[];for(e=0;e<s.length;e++)M(s[e])?(s[e]=Math.ceil(parseFloat(s[e])),s[e]<=0||s[e]>a.length?h.push(m.error.nm):h.push(t.sort(function(p,g){return g-p})[s[e]-1])):h.push(m.error.v);return h}return M(s)?(s=Math.ceil(parseFloat(s)),a.length==0||s<=0||s>a.length?m.error.nm:t.sort(function(p,g){return g-p})[s-1]):m.error.v}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!1)):t.push(a)}for(var l=[],o=0;o<t.length;o++){var d=t[o];d=M(d)?parseFloat(d):d.toString().toLowerCase()=="true"?1:0,l.push(d)}return l.length==0?0:l.length==1?m.error.d:T.standardDeviation_s(l)}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?t=t.concat(T.getCellDataArr(a,"text",!0)):t.push(a)}for(var l=[],o=0;o<t.length;o++){var d=t[o];if(!M(d))return m.error.v;d=parseFloat(d),l.push(d)}return l.length==0?0:l.length==1?m.error.d:T.standardDeviation(l)}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"text",!0));else if(D(a)=="boolean")a.toString().toLowerCase()=="true"?t.push(1):a.toString().toLowerCase()=="false"&&t.push(0);else{if(!M(a))return m.error.v;t.push(a)}}for(var l=[],o=0;o<t.length;o++){var d=t[o];if(M(d)){if((d=parseFloat(d))<=0)return m.error.nm;l.push(d)}}return l.length==0?m.error.nm:jStat.geomean(l)}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=arguments[1],l=[];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;l=l.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?l=l.concat(T.getCellDataArr(a,"number",!0)):l.push(a);for(var o=[],d=0;d<l.length;d++){var s=l[d];if(!M(s))return m.error.v;s=parseFloat(s),o.push(s)}if(arguments.length==3){if(j(h=T.getCellBoolen(arguments[2])))return h}else var h=!1;var f=h?function(v,y){return v-y}:function(v,y){return y-v},p=(o=o.sort(f)).indexOf(t);return p==-1?m.error.na:p+1}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=arguments[1],l=[];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;l=l.concat(T.getDataArr(a,!0))}else D(a)=="object"&&a.startCell!=null?l=l.concat(T.getCellDataArr(a,"number",!0)):l.push(a);for(var o=[],d=0;d<l.length;d++){var s=l[d];if(!M(s))return m.error.v;s=parseFloat(s),o.push(s)}if(arguments.length==3){if(j(h=T.getFirstValue(arguments[2])))return h;if(D(h)!="boolean")if(D(h)!="string"||h.toLowerCase()!="true"&&h.toLowerCase()!="false"){if(!M(h))return m.error.v;h=(h=parseFloat(h))!=0}else h.toLowerCase()=="true"&&(h=!0),h.toLowerCase()=="false"&&(h=!1)}else var h=!1;var f=h?function(v,y){return v-y}:function(v,y){return y-v};o=o.sort(f);var p=0;for(e=0;e<o.length;e++)o[e]==t&&p++;return p>1?(2*o.indexOf(t)+p+1)/2:o.indexOf(t)+1}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!0))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!0)):a.push(t);for(var l=[],o=0;o<a.length;o++){var d=a[o];if(!M(d))return m.error.v;d=parseFloat(d),l.push(d)}var s=T.getFirstValue(arguments[1]);if(j(s))return s;if(!M(s))return m.error.v;if(s=parseFloat(s),arguments.length==3){if(j(h=T.getFirstValue(arguments[2])))return h;if(!M(h))return m.error.v;h=parseInt(h)}else var h=3;if(l.length==0||h<1)return m.error.nm;if(l.length==1&&l[0]==s)return 1;l=l.sort(function(w,_){return w-_});var f=window.luckysheet_function.UNIQUE.f(l)[0],p=l.length,g=f.length,v=Math.pow(10,h),y=0,b=!1;for(e=0;!b&&e<g;)s===f[e]?(y=(l.indexOf(f[e])+1)/(p+1),b=!0):s>=f[e]&&(s<f[e+1]||e===g-1)&&(y=(l.lastIndexOf(f[e])+1+(s-f[e])/(f[e+1]-f[e]))/(p+1),b=!0),e++;return isNaN(y)?m.error.na:Math.floor(y*v)/v}catch(w){var k=w;return k=m.errorInfo(k),[m.error.v,k]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!0))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!0)):a.push(t);for(var l=[],o=0;o<a.length;o++){var d=a[o];if(!M(d))return m.error.v;d=parseFloat(d),l.push(d)}var s=T.getFirstValue(arguments[1]);if(j(s))return s;if(!M(s))return m.error.v;if(s=parseFloat(s),arguments.length==3){if(j(h=T.getFirstValue(arguments[2])))return h;if(!M(h))return m.error.v;h=parseInt(h)}else var h=3;if(l.length==0||h<1)return m.error.nm;if(l.length==1&&l[0]==s)return 1;l=l.sort(function(w,_){return w-_});var f=window.luckysheet_function.UNIQUE.f(l)[0],p=l.length,g=f.length,v=Math.pow(10,h),y=0,b=!1;for(e=0;!b&&e<g;)s===f[e]?(y=l.indexOf(f[e])/(p-1),b=!0):s>=f[e]&&(s<f[e+1]||e===g-1)&&(y=(l.lastIndexOf(f[e])+(s-f[e])/(f[e+1]-f[e]))/(p-1),b=!0),e++;return isNaN(y)?m.error.na:Math.floor(y*v)/v}catch(w){var k=w;return k=m.errorInfo(k),[m.error.v,k]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=arguments[1],l=[];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;l=l.concat(T.getDataArr(a,!1))}else D(a)=="object"&&a.startCell!=null?l=l.concat(T.getCellDataArr(a,"text",!1)):l.push(a);var o=arguments[2],d=[];if(D(o)=="array"){if(D(o[0])=="array"&&!T.isDyadicArr(o))return m.error.v;d=d.concat(T.getDataArr(o,!1))}else D(o)=="object"&&o.startCell!=null?d=d.concat(T.getCellDataArr(o,"text",!1)):d.push(o);if(l.length!=d.length)return m.error.na;var s=[],h=[];for(e=0;e<l.length;e++){var f=l[e],p=d[e];M(f)&&M(p)&&(s.push(parseFloat(f)),h.push(parseFloat(p)))}if(T.variance_s(h)==0)return m.error.d;var g=jStat.mean(h),v=jStat.mean(s),y=h.length,b=0,k=0;for(e=0;e<y;e++)b+=(h[e]-g)*(s[e]-v),k+=Math.pow(h[e]-g,2);var w=b/k,_=v-w*g;return _+w*t}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=Math.exp(2*t);return(a-1)/(a+1)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<=-1||t>=1?m.error.nm:Math.log((1+t)/(1-t))/2:m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}var d,s={},h=[],f=0;for(e=0;e<l.length;e++)s[d=l[e]]=s[d]?s[d]+1:1,s[d]>f&&(f=s[d],h=[]),s[d]==f&&(h[h.length]=d);if(f<=1)return m.error.na;for(var p=l.indexOf(h[0]),g=0;g<h.length;g++){var v=l.indexOf(h[g]);v<p&&(p=v)}return l[p]}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getCellBoolen(arguments[3]);return j(o)?o:t<0||a<=0||l<=0?m.error.nm:o?1-Math.exp(-Math.pow(t/l,a)):Math.pow(t,a-1)*Math.exp(-Math.pow(t/l,a))*a/Math.pow(l,a)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}return l.length==0?m.error.nm:jStat.sum(jStat(l).subtract(jStat.mean(l)).abs()[0])/l.length}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(d.toString.toLowerCase()=="true")t.push(1);else if(d.toString.toLowerCase()=="false")t.push(0);else{if(!M(a))return m.error.v;t.push(a)}}var l=0,o=0;for(e=0;e<t.length;e++){var d=t[e];M(d)?l+=parseFloat(d):d.toString().toLowerCase()=="true"?l+=1:l+=0,o++}return o==0?m.error.d:l/o}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getCellBoolen(arguments[3]);return j(o)?o:t<0||t>a||l<0||l>1?m.error.nm:o?jStat.binomial.cdf(t,a,l):jStat.binomial.pdf(t,a,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;if(l=parseFloat(l),t<0||a<0||a>1||l<0||l>1)return m.error.nm;for(var o=0;o<=t;){if(jStat.binomial.cdf(o,t,a)>=l)return o;o++}}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseInt(l),t<=0||t>=1||a<=0||l<1?m.error.nm:jStat.normalci(1,t,a,l)[1]-1):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}return d.length==0||s.length==0||T.standardDeviation(d)==0||T.standardDeviation(s)==0?m.error.d:jStat.corrcoeff(d,s)}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}if(d.length==0||s.length==0)return m.error.d;var p=jStat.mean(d),g=jStat.mean(s),v=0;for(e=0;e<d.length;e++)v+=(d[e]-p)*(s[e]-g);return v/=d.length}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}return d.length==0||s.length==0?m.error.d:jStat.covariance(d,s)}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(M(a))t.push(a);else{if(D(a)!="boolean")return m.error.v;a.toString().toLowerCase()=="true"?t.push(1):a.toString().toLowerCase()=="false"&&t.push(0)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}var d=jStat.mean(l),s=0;for(e=0;e<l.length;e++)s+=Math.pow(l[e]-d,2);return s}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getCellBoolen(arguments[2]);return j(l)?l:t<0||a<0?m.error.nm:l?jStat.exponential.cdf(t,a):jStat.exponential.pdf(t,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=0,a=0,l=arguments[0].data,o=arguments[0].rowl,d=arguments[0].coll,s=fd(arguments[1]),h=[];if(arguments[2]){var f=arguments[2].startCell,p=arguments[2].rowl,g=arguments[2].coll,v=arguments[2].sheetName;if(o==p&&d==g)h=arguments[2].data;else{var y=[],b=[];y[0]=parseInt(f.replace(/[^0-9]/g,""))-1,b[0]=rl(f.replace(/[^A-Za-z]/g,"")),y[1]=y[0]+o-1,b[1]=b[0]+d-1;var k=ya(b[1]),w=y[1]+1;h=no(v+"!"+f+":"+(k+w)).data}h=m.getRangeArray(h)[0]}for(l=m.getRangeArray(l)[0],e=0;e<l.length;e++){var _=l[e];if(_&&m.acompareb(_,s)){var C=h[e]||_;if(!M(C))continue;t+=parseFloat(C),a++}}return t==0||a==0?m.error.d:Bl(t/a)}catch(I){var A=I;return A=m.errorInfo(A),[m.error.v,A]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=0,a=0,l=arguments;Bs(l);var o=m.getRangeArray(l[0])[0],d=new Array(o.length);for(e=0;e<d.length;e++)d[e]=!0;for(e=1;e<l.length;e+=2)for(var s=m.getRangeArray(l[e])[0],h=l[e+1],f=0;f<s.length;f++){var p=s[f];d[f]=d[f]&&!!p&&m.acompareb(p,h)}for(e=0;e<o.length;e++)d[e]&&M(o[e])&&(t+=parseFloat(o[e]),a++);return t==0||a==0?m.error.d:Bl(t/a)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<=0||a<0||t<a?m.error.nm:T.factorial(t)/T.factorial(t-a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let p=function(v,y){return y=y||1,v&&typeof v.slice=="function"?v.slice(y):v},g=function(v,y){return y=y||1,v&&typeof v.slice=="function"?v.slice(0,v.length-y):v};var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!1)):a.push(t);var l=[];for(e=0;e<a.length;e++){var o=a[e];M(o)&&l.push(parseFloat(o))}var d=T.getFirstValue(arguments[1]);if(j(d))return d;if(!M(d))return m.error.v;if(d=parseFloat(d),l.length==0||d<0||d>1)return m.error.nm;l.sort(function(v,y){return v-y});var s=window.luckysheet_function.FLOOR.f(l.length*d,2)/2,h=p(l,s);return h=g(h,s),h=jStat.mean(h)}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!1)):a.push(t);var l=[];for(e=0;e<a.length;e++){var o=a[e];M(o)&&l.push(parseFloat(o))}var d=T.getFirstValue(arguments[1]);if(j(d))return d;if(!M(d))return m.error.v;if(d=parseFloat(d),l.length==0||d<=0||d>=1)return m.error.nm;var s=(l=l.sort(function(g,v){return g-v})).length;if(d<1/(s+1)||d>1-1/(s+1))return m.error.nm;var h=d*(s+1)-1,f=Math.floor(h);return h===f?l[h]:l[f]+(h-f)*(l[f+1]-l[f])}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!1)):a.push(t);var l=[];for(e=0;e<a.length;e++){var o=a[e];M(o)&&l.push(parseFloat(o))}var d=T.getFirstValue(arguments[1]);if(j(d))return d;if(!M(d))return m.error.v;if(d=parseFloat(d),l.length==0||d<0||d>1)return m.error.nm;var s=(l=l.sort(function(g,v){return g-v})).length,h=d*(s-1),f=Math.floor(h);return h===f?l[h]:l[f]+(h-f)*(l[f+1]-l[f])}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}if(s.length==0||d.length==0)return m.error.d;var p=jStat.mean(d),g=jStat.mean(s),v=d.length,y=0,b=0,k=0;for(e=0;e<v;e++)y+=(d[e]-p)*(s[e]-g),b+=Math.pow(d[e]-p,2),k+=Math.pow(s[e]-g,2);return y/Math.sqrt(b*k)}catch(_){var w=_;return w=m.errorInfo(w),[m.error.v,w]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseFloat(t))<=0||t>=1?m.error.nm:jStat.normal.inv(t,0,1):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getCellBoolen(arguments[1]);return j(a)?a:a?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t)){if(D(t)!="boolean")return m.error.v;t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0)}t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a)){if(D(a)!="boolean")return m.error.v;a.toString().toLowerCase()=="true"?a=1:a.toString().toLowerCase()=="false"&&(a=0)}a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l)){if(D(l)!="boolean")return m.error.v;l.toString().toLowerCase()=="true"?l=1:l.toString().toLowerCase()=="false"&&(l=0)}return l=parseFloat(l),t<=0||t>=1||l<=0?m.error.nm:jStat.normal.inv(t,a,l)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t)){if(D(t)!="boolean")return m.error.v;t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0)}t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getCellBoolen(arguments[3]);return j(o)?o:l<=0?m.error.nm:o?jStat.normal.cdf(t,a,l):jStat.normal.pdf(t,a,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getCellBoolen(arguments[3]);return j(o)?o:l<0||l>1||t<0||a<1?m.error.nm:o?jStat.negbin.cdf(t,a,l):jStat.negbin.pdf(t,a,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(o.toString.toLowerCase()=="true")t.push(1);else if(o.toString.toLowerCase()=="false")t.push(0);else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)?l.push(parseFloat(o)):o.toString().toLowerCase()=="true"?l.push(1):l.push(0)}return l.length===0?0:Math.min.apply(Math,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}return jStat.median(l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(o.toString.toLowerCase()=="true")t.push(1);else if(o.toString.toLowerCase()=="false")t.push(0);else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)?l.push(parseFloat(o)):o.toString().toLowerCase()=="true"?l.push(1):l.push(0)}return l.length===0?0:Math.max.apply(Math,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseFloat(l),t<=0||t>=1||l<=0?m.error.nm:jStat.lognormal.inv(t,a,l)):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getCellBoolen(arguments[3]);return j(o)?o:t<=0||l<=0?m.error.nm:o?jStat.lognormal.cdf(t,a,l):jStat.lognormal.pdf(t,a,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!0))}else D(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(T.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var a=[],l=0;l<t.length;l++){var o=t[l];M(o)&&a.push(parseFloat(o))}var d=T.getFirstValue(arguments[1]);if(j(d))return d;if(!M(d))return m.error.v;if(d=parseFloat(d),a.length==0)return m.error.na;var s=T.standardDeviation_s(a);if(arguments.length==3){if(j(s=T.getFirstValue(arguments[2])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}var h=a.length,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,a);return 1-window.luckysheet_function.NORM_S_DIST.f((f-d)/(s/Math.sqrt(h)),"true")}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!1))}else D(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(T.getCellDataArr(arguments[0],"text",!1)):t.push(arguments[0]);var a=[];if(D(arguments[1])=="array"){if(D(arguments[1][0])=="array"&&!T.isDyadicArr(arguments[1]))return m.error.v;a=a.concat(T.getDataArr(arguments[1],!1))}else D(arguments[1])=="object"&&arguments[1].startCell!=null?a=a.concat(T.getCellDataArr(arguments[1],"text",!1)):a.push(arguments[1]);if(t.length!=a.length)return m.error.na;var l=[],o=[],d=0;for(e=0;e<t.length;e++){var s=t[e],h=a[e];if(M(s)&&M(h)&&(l.push(parseFloat(s)),o.push(parseFloat(h)),d+=parseFloat(h),parseFloat(h)<=0||parseFloat(h)>1))return m.error.nm}if(d!=1)return m.error.nm;var f=T.getFirstValue(arguments[2]);if(j(f))return f;if(!M(f))return m.error.v;var p=f=parseFloat(f);if(arguments.length==4){if(j(p=T.getFirstValue(arguments[3])))return p;if(!M(p))return m.error.v;p=parseFloat(p)}var g=0;for(e=0;e<l.length;e++)l[e]>=f&&l[e]<=p&&(g+=o[e]);return g}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!0))}else if(D(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(T.getCellDataArr(arguments[0],"text",!0));else{if(!M(arguments[0]))return m.error.v;t.push(arguments[0])}var a=[];for(e=0;e<t.length;e++){var l=t[e];M(l)&&a.push(parseFloat(l))}var o=T.getFirstValue(arguments[1]);if(j(o))return o;if(!M(o))return m.error.v;if(o=parseInt(o),a.length==0||o<=0||o>=4)return m.error.nm;switch(o){case 1:return window.luckysheet_function.PERCENTILE_EXC.f(a,.25);case 2:return window.luckysheet_function.PERCENTILE_EXC.f(a,.5);case 3:return window.luckysheet_function.PERCENTILE_EXC.f(a,.75)}}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!0))}else if(D(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(T.getCellDataArr(arguments[0],"text",!0));else{if(!M(arguments[0]))return m.error.v;t.push(arguments[0])}var a=[];for(e=0;e<t.length;e++){var l=t[e];M(l)&&a.push(parseFloat(l))}var o=T.getFirstValue(arguments[1]);if(j(o))return o;if(!M(o))return m.error.v;if(o=parseInt(o),a.length==0||o<0||o>4)return m.error.nm;switch(o){case 0:return Math.min.apply(Math,a);case 1:return window.luckysheet_function.PERCENTILE_INC.f(a,.25);case 2:return window.luckysheet_function.PERCENTILE_INC.f(a,.5);case 3:return window.luckysheet_function.PERCENTILE_INC.f(a,.75);case 4:return Math.max.apply(Math,a)}}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getCellBoolen(arguments[2]);return j(l)?l:t<0||a<0?m.error.nm:l?jStat.poisson.cdf(t,a):jStat.poisson.pdf(t,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else if(D(t)=="object"&&t.startCell!=null)a=a.concat(T.getCellDataArr(t,"text",!1));else{if(!M(t))return m.error.v;a.push(t)}var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else if(D(l)=="object"&&l.startCell!=null)o=o.concat(T.getCellDataArr(l,"text",!1));else{if(!M(l))return m.error.v;o.push(l)}if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}return d.length==0||s.length==0?m.error.d:Math.pow(window.luckysheet_function.PEARSON.f(d,s),2)}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getCellBoolen(arguments[2]);return j(l)?l:a<1?m.error.nm:l?jStat.studentt.cdf(t,a):jStat.studentt.pdf(t,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<0||a<1?m.error.nm:2*(1-jStat.studentt.cdf(t,a))):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a))<1?m.error.nm:1-jStat.studentt.cdf(t,a):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<=0||t>1||a<1?m.error.nm:jStat.studentt.inv(t,a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<=0||t>1||a<1?m.error.nm:Math.abs(jStat.studentt.inv(t/2,a))):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!1))}else if(D(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(T.getCellDataArr(arguments[0],"text",!1));else{if(!M(arguments[0]))return m.error.v;t.push(arguments[0])}var a=t,l=[];if(D(arguments[1])=="array"){if(D(arguments[1][0])=="array"&&!T.isDyadicArr(arguments[1]))return m.error.v;l=l.concat(T.getDataArr(arguments[1],!1))}else if(D(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(T.getCellDataArr(arguments[1],"text",!1));else{if(!M(arguments[1]))return m.error.v;l.push(arguments[1])}var o=l,d=T.getFirstValue(arguments[2]);if(j(d))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=T.getFirstValue(arguments[3]);if(j(s))return s;if(!M(s))return m.error.v;if(s=parseInt(s),[1,2].indexOf(d)==-1||[1,2,3].indexOf(s)==-1)return m.error.nm;var h=null,f=null;if(s==1){var p=[];for(e=0;e<a.length;e++)p.push(a[e]-o[e]);var g=Math.abs(jStat.mean(p)),v=T.standardDeviation_s(p);h=g/(v/Math.sqrt(a.length)),f=a.length-1}else{var y=jStat.mean(a),b=jStat.mean(o),k=T.variance_s(a),w=T.variance_s(o);switch(h=Math.abs(y-b)/Math.sqrt(k/a.length+w/o.length),s){case 2:f=a.length+o.length-2;break;case 3:f=Math.pow(k/a.length+w/o.length,2)/(Math.pow(k/a.length,2)/(a.length-1)+Math.pow(w/o.length,2)/(o.length-1))}}if(d==1)var _=window.luckysheet_function.T_DIST_RT.f(h,f);else d==2&&(_=window.luckysheet_function.T_DIST_2T.f(h,f));return _}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o=T.getCellBoolen(arguments[3]);return j(o)?o:t<0||a<1||l<1?m.error.nm:o?jStat.centralF.cdf(t,a,l):jStat.centralF.pdf(t,a,l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseInt(l),t<0||a<1||l<1?m.error.nm:1-jStat.centralF.cdf(t,a,l)):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}if(l.length==0)return m.error.d;var d=l.length,s=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);for(e=0;e<d;e++)s+=Math.pow(l[e]-h,2);return s/d}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}if(l.length==0)return m.error.d;var d=l.length,s=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);for(e=0;e<d;e++)s+=Math.pow(l[e]-h,2);return s/(d-1)}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(o.toString.toLowerCase()=="true")t.push(1);else if(o.toString.toLowerCase()=="false")t.push(0);else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)?l.push(parseFloat(o)):o.toString().toLowerCase()=="true"?l.push(1):l.push(0)}var d=l.length,s=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);for(e=0;e<d;e++)s+=Math.pow(l[e]-h,2);return s/(d-1)}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!1))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else if(o.toString.toLowerCase()=="true")t.push(1);else if(o.toString.toLowerCase()=="false")t.push(0);else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)?l.push(parseFloat(o)):o.toString().toLowerCase()=="true"?l.push(1):l.push(0)}var d=l.length,s=0,h=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);for(e=0;e<d;e++)s+=Math.pow(l[e]-h,2);return s/d}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!1))}else if(D(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(T.getCellDataArr(arguments[0],"text",!1));else{if(!M(arguments[0]))return m.error.v;t.push(arguments[0])}var a=[];if(D(arguments[1])=="array"){if(D(arguments[1][0])=="array"&&!T.isDyadicArr(arguments[1]))return m.error.v;a=a.concat(T.getDataArr(arguments[1],!1))}else if(D(arguments[1])=="object"&&arguments[1].startCell!=null)a=a.concat(T.getCellDataArr(arguments[1],"text",!1));else{if(!M(arguments[1]))return m.error.v;a.push(arguments[1])}if(t.length!=a.length)return m.error.na;var l=[],o=[];for(e=0;e<t.length;e++){var d=t[e],s=a[e];M(d)&&M(s)&&(l.push(parseFloat(d)),o.push(parseFloat(s)))}if(l.length<3||o.length<3)return m.error.d;var h=jStat.mean(o),f=jStat.mean(l),p=o.length,g=0,v=0,y=0;for(e=0;e<p;e++)g+=Math.pow(l[e]-f,2),v+=(o[e]-h)*(l[e]-f),y+=Math.pow(o[e]-h,2);return Math.sqrt((g-v*v/y)/(p-2))}catch(k){var b=k;return b=m.errorInfo(b),[m.error.v,b]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseFloat(l))<=0?m.error.nm:(t-a)/l:m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!0))}else if(D(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(T.getCellDataArr(arguments[0],"number",!0));else{if(!M(arguments[0]))return m.error.v;t.push(arguments[0])}var a=[];for(e=0;e<t.length;e++){var l=t[e];M(l)&&a.push(parseFloat(l))}var o=T.getFirstValue(arguments[1]);return j(o)?o:M(o)?(o=parseInt(o),a.length==0||o<=0||o>a.length?m.error.nm:a.sort(function(s,h){return s-h})[o-1]):m.error.v}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];if(D(arguments[0])=="array"){if(D(arguments[0][0])=="array"&&!T.isDyadicArr(arguments[0]))return m.error.v;t=t.concat(T.getDataArr(arguments[0],!1))}else if(D(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(T.getCellDataArr(arguments[0],"text",!1));else{if(!M(arguments[0]))return m.error.v;t.push(arguments[0])}var a=[];if(D(arguments[1])=="array"){if(D(arguments[1][0])=="array"&&!T.isDyadicArr(arguments[1]))return m.error.v;a=a.concat(T.getDataArr(arguments[1],!1))}else if(D(arguments[1])=="object"&&arguments[1].startCell!=null)a=a.concat(T.getCellDataArr(arguments[1],"text",!1));else{if(!M(arguments[1]))return m.error.v;a.push(arguments[1])}if(t.length!=a.length)return m.error.na;var l=[],o=[];for(e=0;e<t.length;e++){var d=t[e],s=a[e];M(d)&&M(s)&&(l.push(parseFloat(d)),o.push(parseFloat(s)))}if(l.length<3||o.length<3)return m.error.d;var h=jStat.mean(o),f=jStat.mean(l),p=o.length,g=0,v=0;for(e=0;e<p;e++)g+=(o[e]-h)*(l[e]-f),v+=Math.pow(o[e]-h,2);return g/v}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}if(l.length<3||T.standardDeviation_s(l)==0)return m.error.d;var d=jStat.mean(l),s=l.length,h=0;for(e=0;e<s;e++)h+=Math.pow(l[e]-d,3);return s*h/((s-1)*(s-2)*Math.pow(jStat.stdev(l,!0),3))}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[];for(e=0;e<arguments.length;e++){var a=arguments[e];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;t=t.concat(T.getDataArr(a,!0))}else if(D(a)=="object"&&a.startCell!=null)t=t.concat(T.getCellDataArr(a,"number",!0));else{if(!M(a))return m.error.v;t.push(a)}}var l=[];for(e=0;e<t.length;e++){var o=t[e];M(o)&&l.push(parseFloat(o))}if(l.length<3||T.standardDeviation_s(l)==0)return m.error.d;var d=jStat.mean(l),s=l.length,h=0,f=0;for(e=0;e<s;e++)f+=Math.pow(l[e]-d,3),h+=Math.pow(l[e]-d,2);return h/=s,(f/=s)/Math.pow(h,1.5)}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=1;if(arguments.length>=3){if(j(l=T.getFirstValue(arguments[2])))return l;if(!M(l))return m.error.v;l=parseInt(l)}var o,d=!0;if(arguments.length>=4&&j(d=T.getCellBoolen(arguments[3])))return d;if(t<=0||a<=0||[1,2,3,4].indexOf(l)==-1)return m.error.v;if(d)switch(a=ya(a-1),l){case 1:o="$"+a+"$"+t;break;case 2:o=a+"$"+t;break;case 3:o="$"+a+t;break;case 4:o=a+t}else switch(l){case 1:o="R"+t+"C"+a;break;case 2:o="R"+t+"C["+a+"]";break;case 3:o="R["+t+"]C"+a;break;case 4:o="R["+t+"]C["+a+"]"}if(arguments.length==5){var s=T.getFirstValue(arguments[4]);return j(s)?s:s+"!"+o}return o}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;var a=!0;if(arguments.length==2&&j(a=T.getCellBoolen(arguments[1])))return a;var l=an(),o=je(u.calculateSheetIndex),d=l[o],s=d.data;if(m.iscelldata(t)){var h=m.getcellrange(t),f=h.row[0],p=h.column[0];if(f<0||f>=s.length||p<0||p>=s[0].length)return m.error.r;if(s[f][p]==null||$t(s[f][p].v))return 0;var g=s[f][p].v;if(m.execFunctionGlobalData!=null){var v=m.execFunctionGlobalData[f+"_"+p+"_"+u.calculateSheetIndex];v!=null&&(g=v.v)}var y={sheetName:d.name,startCell:t,rowl:f,coll:p,data:g};return y}return m.error.r}catch(k){var b=k;return b=m.errorInfo(b),[m.error.v,b]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{if(arguments.length==1){var t;if(D(arguments[0])=="array")return m.error.v;if(t=D(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].startCell:arguments[0],m.iscelldata(t)){var a=m.getcellrange(t);return a.row[0]+1}return m.error.v}return window.luckysheetCurrentRow+1}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return D(arguments[0])=="array"?D(arguments[0][0])=="array"?arguments[0].length:1:D(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].rowl:1}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{if(arguments.length==1){var t;if(D(arguments[0])=="array")return m.error.v;if(t=D(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].startCell:arguments[0],m.iscelldata(t)){var a=m.getcellrange(t);return a.column[0]+1}return m.error.v}return window.luckysheetCurrentColumn+1}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return D(arguments[0])=="array"?D(arguments[0][0])=="array"?arguments[0][0].length:arguments[0].length:D(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].coll:1}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{if(D(arguments[0])!="object"||arguments[0].startCell==null)return m.error.v;var t=arguments[0].startCell,a=arguments[0].sheetName,l=T.getFirstValue(arguments[1]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o=T.getFirstValue(arguments[2]);if(j(o))return o;if(!M(o))return m.error.v;o=parseInt(o);var d=arguments[0].rowl;if(arguments.length>=4){if(j(d=T.getFirstValue(arguments[3])))return d;if(!M(d))return m.error.v;d=parseInt(d)}var s=arguments[0].coll;if(arguments.length==5){if(j(s=T.getFirstValue(arguments[4])))return s;if(!M(s))return m.error.v;s=parseInt(s)}if(d<1||s<1)return m.error.r;var h=m.getcellrange(t),f=h.row[0],p=h.column[0],g=(f+=l)+d-1,v=(p+=o)+s-1,y=an(),b=je(u.calculateSheetIndex),k=y[b].data;if(f<0||g>=k.length||p<0||v>=k[0].length)return m.error.r;for(var w=[],_=f;_<=g;_++){for(var C=[],A=p;A<=v;A++)if(m.execFunctionGlobalData!=null&&m.execFunctionGlobalData[_+"_"+A+"_"+u.calculateSheetIndex]!=null){var I=m.execFunctionGlobalData[_+"_"+A+"_"+u.calculateSheetIndex];I!=null?C.push(I.v):C.push(0)}else k[_][A]==null||$t(k[_][A].v)?C.push(0):C.push(k[_][A].v);w.push(C)}var S={sheetName:a,startCell:wn(u.calculateSheetIndex,{row:[f,g],column:[p,v]}),rowl:f,coll:p,data:w};return S}catch(R){var E=R;return E=m.errorInfo(E),[m.error.v,E]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=arguments[1],l=[];if(D(a)=="array"){if(D(a[0])=="array")return T.isDyadicArr(a)?m.error.na:m.error.v;for(e=0;e<a.length;e++)l.push(a[e])}else if(D(a)=="object"&&a.startCell!=null){if(a.rowl>1&&a.coll>1)return m.error.na;if(a.data!=null)if(D(a.data)=="array")for(e=0;e<a.data.length;e++)for(var o=0;o<a.data[e].length;o++)a.data[e][o]==null||$t(a.data[e][o].v)||l.push(a.data[e][o].v);else l.push(a.data.v)}var d,s,h=1;if(arguments.length==3){if(j(h=T.getFirstValue(arguments[2])))return h;if(!M(h))return m.error.v;h=Math.ceil(parseFloat(h))}if([-1,0,1].indexOf(h)==-1)return m.error.na;for(var f=0;f<l.length;f++)if(h===1){if(l[f]===t)return f+1;l[f]<t&&(s?l[f]>s&&(d=f+1,s=l[f]):(d=f+1,s=l[f]))}else if(h===0){if(typeof t=="string"){if(t=t.replace(/\?/g,"."),l[f].toLowerCase().match(t.toLowerCase()))return f+1}else if(l[f]===t)return f+1}else if(h===-1){if(l[f]===t)return f+1;l[f]>t&&(s?l[f]<s&&(d=f+1,s=l[f]):(d=f+1,s=l[f]))}return d||m.error.na}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;if(t.toString().replace(/\s/g,"")=="")return m.error.na;var a=arguments[1],l=[];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;for(e=0;e<a.length;e++){for(var o=[],d=0;d<a[e].length;d++)o.push(a[e][d]);l.push(o)}}else{for(o=[],e=0;e<a.length;e++)o.push(a[e]);l.push(o)}else{if(D(a)!="object"||a.startCell==null)return m.error.v;l=T.getCellDataDyadicArr(a,"text")}var s=T.getFirstValue(arguments[2]);if(j(s))return s;if(!M(s))return m.error.v;s=parseInt(s);var h=!0;if(arguments.length==4&&j(h=T.getCellBoolen(arguments[3])))return h;if(s<1)return m.error.v;if(s>l[0].length)return m.error.r;if(!h){var f=null;for(p=0;p<l.length;p++)if(t.toString()==l[p][0].toString()){f=p;break}return f==null?m.error.na:l[f][s-1]}l=zs(l,0,!0);for(var p=0;p<l.length;p++){var g,v=l[p][0];if(un(t)&&un(v)?g=il(t,v):M(t)&&M(v)?g=cn(t).value()-cn(v).value():M(t)||M(v)?M(t)?M(v)||(g=-1):g=1:g=t.localeCompare(v,"zh"),g<0)return p==0?m.error.na:l[p-1][s-1];if(p==l.length-1)return l[p][s-1]}}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{window.luckysheetCurrentRow,window.luckysheetCurrentColumn;var t=arguments[0];ul(t)=="object"&&(D(t=arguments[0].data)=="array"?D(t=t[r])=="array"&&(t=t[s]):t=t.v);var a=arguments[1].data,l=arguments[2],o=!1;if(arguments.length>3&&(o=!!arguments[3]),l>a.rowl)return[m.error.v,""+a[0].length];if(l<1)return[m.error.v,"1"];for(var d=m.error.na,s=0;s<a[0].length;s++){var h=Hr(0,s,a),f=Hr(l-1,s,a);if(o)h.indexOf(t)>-1&&(d=f);else if(m.acompareb(h,t))return d=f}return d}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let v=function(y,b){return b-y};window.luckysheetCurrentRow,window.luckysheetCurrentColumn;var t=arguments[0];ul(t)=="object"&&(D(t=arguments[0].data)=="array"?D(t=t[r])=="array"&&(t=t[c]):t=t.v);var a,l=arguments[1].data,o=m.error.na;if(l=m.getRangeArray(l)[0],arguments[2]&&(a=arguments[2].data,a=m.getRangeArray(a)[0]),typeof t=="string")for(e=0;e<l.length;e++){var d=l[e];arguments[2]?(h=a[e],d==t&&(o=h)):m.acompareb(d,t)&&(o=d)}else if(ko(t)=="num"){var s=[];for(e=0;e<l.length;e++){var h;if(d=l[e],arguments[2]){if(h=a[e],d==t)return o=h;d!=t&&ko(d)=="num"&&s.push(d)}else{if(d==t)return o=d;d!=t&&ko(d)=="num"&&s.push(d)}}if(s.length!=0){s.push(t),s.sort(v);var f=s.indexOf(t);if(f==s.length-1)return[m.error.na,""];var p=s[f+1];o=arguments[2]?a[e=l.indexOf(p)]:p}}return o}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[],l=!1;if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else D(t)=="object"&&t.startCell!=null&&(a=T.getCellDataDyadicArr(t,"number"),l=!0);var o=a.length,d=a[0].length,s=T.getFirstValue(arguments[1]);if(j(s))return s;if(!M(s))return m.error.v;s=parseInt(s);var h=T.getFirstValue(arguments[2]);if(j(h))return h;if(s<0||M(h)&&h<0)return m.error.v;if(s>o||M(h)&&h>d)return m.error.r;if(l){var f=m.getcellrange(t.startCell),p=f.row[0],g=f.column[0],v=a;s==0||h==0?(s==0?(v=a[0],s=1):v=a[s-1],M(h)?h==0?(v=v[0],h=1):v=v[h-1]:h=1):(M(s)||(s=1),M(h)||(h=1),v=a[s-1][h-1]);var y=p+s-1,b=g+h-1,k={sheetName:t.sheetName,startCell:wn(u.calculateSheetIndex,{row:[y,y],column:[b,b]}),rowl:y,coll:b,data:v};return k}return M(h)?(h=parseInt(h),s<=0||h<=0?m.error.v:a[s-1][h-1]):m.error.v}catch(_){var w=_;return w=m.errorInfo(w),[m.error.v,w]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return m.error.v}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t)||(t=parseInt(t))<1||t>arguments.length-1)return m.error.v;var a=arguments[t];if(D(a)=="array")return D(a[0])!="array"||T.isDyadicArr(a)?a:m.error.v;if(D(a)=="object"&&a.startCell!=null){if(a.data==null)return 0;if(D(a.data)=="array"){var l=T.getCellDataDyadicArr(a.data,"number");return l}return $t(a.data.v)?0:a.data.v}return a}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return m.error.v}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;if(l=parseInt(l),t<0||t>32767||(t>24&&(t%=24),a<0||a>32767)||l<0||l>32767)return m.error.nm;var o=Q().set({hour:t,minute:a,second:l});return Q(o).format("h:mm:ss a")}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);return j(t)?t:Q(t).isValid()?(3600*Q(t).get("hour")+60*Q(t).get("minute")+Q(t).get("second"))/86400:m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a)||(a=parseInt(a),!Q(t).isValid()))return m.error.v;var l=Q(t).add(a+1,"months").set("date",1).subtract(1,"days"),o=_a(Q(l).format("YYYY-MM-DD H:mm:ss")),d=o[2];return d}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a)||(a=parseInt(a),!Q(t).isValid()))return m.error.v;var l=Q(t).add(a,"months"),o=_a(Q(l).format("YYYY-MM-DD h:mm:ss")),d=o[2];return d}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=Q(t).seconds();return a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=Q(t).minutes();return a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=Q(t).hours();return a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return Q().format("YYYY-M-D HH:mm")}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]);else t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1);return t}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],a=T.getCellDate(arguments[0]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getCellDate(arguments[1]);if(j(l))return l;if(!Q(l).isValid())return m.error.v;var o=t[1];if(arguments.length>=3&&!(typeof(o=arguments[2])=="string"&&o.length=="7"&&/^[0-1]{7}$/g.test(o))){if(j(o=T.getFirstValue(arguments[2])))return o;if(!M(o))return m.error.v;if((o=parseInt(o))<1||o>7&&o<11||o>17)return m.error.nm;o=t[o]}var d=[];if(arguments.length==4&&j(d=T.getCellrangeDate(arguments[3])))return d;for(e=0;e<d.length;e++)if(!Q(d[e]).isValid())return m.error.v;var s=Q(l).diff(Q(a),"days")+1,h=s,f=Q(a);for(e=0;e<s;e++){var p=Q(f).weekday(),g=!1;D(o)=="array"?p!==o[0]&&p!==o[1]||(g=!0):(p==0&&(p=7),o.charAt(p-1)=="0"&&(g=!0));for(var v=0;v<d.length;v++)if(Q(f).diff(Q(d[v]),"days")===0){g=!0;break}g&&h--,f=Q(f).add(1,"days")}return h}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);return j(t)?t:Q(t).isValid()?Q(t).isoWeeks():m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],a=T.getCellDate(arguments[0]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=1;if(arguments.length==2){if(j(l=T.getFirstValue(arguments[1])))return l;if(!M(l))return m.error.v;l=parseInt(l)}if(l==21)return window.luckysheet_function.ISOWEEKNUM.f(arguments[0]);if([1,2,11,12,13,14,15,16,17].indexOf(l)==-1)return m.error.nm;var o=t[l],d=Q(a).isoWeekday()>=o?1:0,s=Q(a).isoWeeks()+d;return s}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],a=T.getCellDate(arguments[0]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=1;if(arguments.length==2){if(j(l=T.getFirstValue(arguments[1])))return l;if(!M(l))return m.error.v;l=parseInt(l)}if([1,2,3,11,12,13,14,15,16,17].indexOf(l)==-1)return m.error.nm;var o=t[l][Q(a).day()];return o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);return j(t)?t:Q(t).isValid()?Q(t).date():m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=Q(t).diff(Q(a),"days");return l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=!1;if(arguments.length==3&&j(l=T.getCellBoolen(arguments[2])))return l;var o,d,s=Q(t).month(),h=Q(a).month();if(l)o=Q(t).date()===31?30:Q(t).date(),d=Q(a).date()===31?30:Q(a).date();else{var f=Q().set({year:Q(t).year(),month:s+1,date:0}).date(),p=Q().set({year:Q(a).year(),month:h+1,date:0}).date();o=Q(t).date()===f?30:Q(t).date(),Q(a).date()===p?o<30?(h++,d=1):d=30:d=Q(a).date()}var g=360*Q(a).diff(Q(t),"years")+30*(h-s)+(d-o);return g}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;if(l=parseInt(l),t<0||t>=1e4)return m.error.nm;t>=0&&t<=1899&&(t+=1900);var o=Q().set({year:t,month:a-1,date:l});return Q(o).year()<1900?m.error.nm:Q(o).format("YYYY-MM-DD")}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=_a(t=Q(t).format("YYYY-MM-DD"))[2];return a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{for(Bs(arguments),e=0;e<arguments.length-1;e++)if(arguments[e]=moment.fromOADate(arguments[e]).format("l"),!un(arguments[e]))return m.error.v;var t=Q(arguments[0]),a=Q(arguments[1]),l=arguments[2],o=m.error.v;if(window.luckysheet_function.DAYS.f(a,t)<0)return m.error.v;switch(l){case"Y":case"y":o=a.diff(t,"years",!1);break;case"M":case"m":o=a.diff(t,"months",!1);break;case"D":case"d":o=a.diff(t,"days",!1);break;case"MD":case"md":o=a.format("DD")-t.format("DD");break;case"YM":case"ym":o=(d=parseInt(t.format("M")))<=(s=parseInt(a.format("M")))?s-d:s+12-d;break;case"YD":case"yd":var d,s;o=(d=_a(t.format("MM-DD"))[2])<=(s=_a(a.format("MM-DD"))[2])?s-d:s+365-d;break;default:o=m.error.v}return o}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]);else t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1);return t}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],a=T.getCellDate(arguments[0]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[1]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o=t[1];if(arguments.length>=3&&!(typeof(o=arguments[2])=="string"&&o.length=="7"&&/^[0-1]{7}$/g.test(o))){if(j(o=T.getFirstValue(arguments[2])))return o;if(!M(o))return m.error.v;if((o=parseInt(o))<1||o>7&&o<11||o>17)return m.error.nm;o=t[o]}var d=[];if(arguments.length==4&&j(d=T.getCellrangeDate(arguments[3])))return d;for(e=0;e<d.length;e++)if(!Q(d[e]).isValid())return m.error.v;for(var s=0;s<l;){a=Q(a).add(1,"days");var h=Q(a).weekday();if(D(o)){if(h===o[0]||h===o[1])continue}else if(h==0&&(h=7),o.charAt(h-1)=="0")continue;for(var f=0;f<d.length;f++)if(Q(a).diff(Q(d[f]),"days")===0){s--;break}s++}return Q(a).format("YYYY-MM-DD")}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);return j(t)?t:Q(t).isValid()?Q(t).year():m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=0;if(arguments.length==3){if(j(l=T.getFirstValue(arguments[2])))return l;if(!M(l))return m.error.v;l=parseInt(l)}if(l<0||l>4)return m.error.nm;var o,d=Q(t).date(),s=Q(t).month()+1,h=Q(t).year(),f=Q(a).date(),p=Q(a).month()+1,g=Q(a).year();switch(l){case 0:d===31&&f===31?(d=30,f=30):d===31?d=30:d===30&&f===31&&(f=30),o=(f+30*p+360*g-(d+30*s+360*h))/360;break;case 1:var v=365;if(h===g||h+1===g&&(s>p||s===p&&d>=f))return(h===g&&T.isLeapYear(h)||T.feb29Between(t,a)||p===1&&f===29)&&(v=366),Q(a).diff(Q(t),"days")/v;var y=g-h+1,b=(Q().set({year:g+1,month:0,date:1})-Q().set({year:h,month:0,date:1}))/1e3/60/60/24,k=b/y;o=Q(a).diff(Q(t),"days")/k;break;case 2:o=Q(a).diff(Q(t),"days")/360;break;case 3:o=Q(a).diff(Q(t),"days")/365;break;case 4:o=(f+30*p+360*g-(d+30*s+360*h))/360}return o}catch(_){var w=_;return w=m.errorInfo(w),[m.error.v,w]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return Q().format("YYYY-MM-DD")}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);return j(t)?t:Q(t).isValid()?Q(t).month()+1:m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<=0||a<1?m.error.nm:Math.pow(1+t/a,a)-1):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=2;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}for(a>9&&(a=9),e=1;e<=a;e++);var l=t>0?1:-1;return l*Math.floor(Math.abs(t)*Math.pow(10,a))/Math.pow(10,a)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;if((a=parseInt(a))<0)return m.error.nm;if(a==0)return m.error.d;var l=parseInt(t,10);l+=t%1*Math.pow(10,Math.ceil(Math.log(a)/Math.LN10))/a;var o=Math.pow(10,Math.ceil(Math.log(a)/Math.LN2)+1);return l=Math.round(l*o)/o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;if((a=parseInt(a))<0)return m.error.nm;if(a==0)return m.error.d;var l=parseInt(t,10);return l+=t%1*Math.pow(10,-Math.ceil(Math.log(a)/Math.LN10))*a}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseInt(o);var d=12;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(t<0||a<0||l<0||o<0||d<1||d>12||o>l)return m.error.nm;if(a>=t)return 0;var s=(1-Math.pow(a/t,1/l)).toFixed(3),h=t*s*d/12,f=h,p=0,g=o===l?l-1:o;for(e=2;e<=g;e++)f+=p=(t-f)*s;if(o===1)var v=h;else o===l?v=(t-f)*s:v=p;return v}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseInt(o);var d=2;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}if(t<0||a<0||l<0||o<0||d<=0||o>l)return m.error.nm;if(a>=t)return 0;var s=0,h=0;for(e=1;e<=o;e++)s+=h=Math.min(d/l*(t-s),t-a-s);return h}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=0;if(arguments.length>=4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseFloat(o)}var d=0;if(arguments.length>=5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}var s=.1;if(arguments.length==6){if(j(s=T.getFirstValue(arguments[5])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}if(d!=0&&d!=1)return m.error.nm;for(var h=1e-6,f=100,p=0,g=!1,v=s;p<f&&!g;){var y=Math.pow(v+1,t),b=Math.pow(v+1,t-1),k=o+y*l+a*(y-1)*(v*d+1)/v,w=t*b*l-a*(y-1)*(v*d+1)/Math.pow(v,2),_=t*a*b*(v*d+1)/v+a*(y-1)*d/v,C=v-k/(w+_);Math.abs(C-v)<h&&(g=!0),p++,v=C}return g?v:m.error.nm}catch(I){var A=I;return A=m.errorInfo(A),[m.error.v,A]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseInt(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=T.getFirstValue(arguments[5]);if(j(s))return s;if(!M(s))return m.error.v;if(s=parseFloat(s),t<=0||a<=0||l<=0||o<1||d<1||o>d||s!=0&&s!=1)return m.error.nm;var h=window.luckysheet_function.PMT.f(t,a,l,0,s),f=0;for(o===1&&(f=s===0?h+l*t:h,o++),e=o;e<=d;e++)f+=s>0?h-(window.luckysheet_function.FV.f(t,e-2,h,l,1)-h)*t:h-window.luckysheet_function.FV.f(t,e-1,h,l,0)*t;return f}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o=0;if(arguments.length==4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseInt(o)}if(l!=1&&l!=2&&l!=4||o<0||o>4||Q(t)-Q(a)>=0)return m.error.nm;var d,s=Q(t).date(),h=Q(t).month()+1,f=Q(t).year(),p=Q(a).date(),g=Q(a).month()+1,v=Q(a).year();switch(o){case 0:s===31&&p===31?(s=30,p=30):s===31?s=30:s===30&&p===31&&(p=30),d=(p+30*g+360*v-(s+30*h+360*f))/(360/l);break;case 1:var y=365;if(f===v||f+1===v&&(h>g||h===g&&s>=p))return(f===v&&T.isLeapYear(f)||T.feb29Between(t,a)||g===1&&p===29)&&(y=366),Q(a).diff(Q(t),"days")/(y/l);var b=v-f+1,k=(Q().set({year:v+1,month:0,date:1})-Q().set({year:f,month:0,date:1}))/1e3/60/60/24,w=k/b;d=Q(a).diff(Q(t),"days")/(w/l);break;case 2:d=Q(a).diff(Q(t),"days")/(360/l);break;case 3:d=Q(a).diff(Q(t),"days")/(365/l);break;case 4:d=(p+30*g+360*v-(s+30*h+360*f))/(360/l)}return Math.round(d)}catch(C){var _=C;return _=m.errorInfo(_),[m.error.v,_]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);return j(o)?o:M(o)?(o=parseInt(o),l==0||o<1||o>l?m.error.nm:(t-a)*(l-o+1)*2/(l*(l+1))):m.error.v}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseFloat(l))<=0||Q(t)-Q(a)>0||Q(a)-Q(t)>31536e6?m.error.nm:365*l/(360-l*Q(a).diff(Q(t),"days")):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseFloat(l))<=0||Q(t)-Q(a)>=0||Q(a)-Q(t)>31536e6?m.error.nm:(100-l)/l*(360/Q(a).diff(Q(t),"days")):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseFloat(l))<=0||Q(t)-Q(a)>0||Q(a)-Q(t)>31536e6?m.error.nm:100*(1-l*Q(a).diff(Q(t),"days")/360):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=0;if(arguments.length>=4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseFloat(o)}var d=0;if(arguments.length>=5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}if(d!=0&&d!=1)return m.error.nm;if(t===0)var s=-l*a-o;else s=((1-Math.pow(1+t,a))/t*l*(1+t*d)-o)/Math.pow(1+t,a);return s}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getCellDate(arguments[2]);if(j(l))return l;if(!Q(l).isValid())return m.error.v;var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseFloat(d);var s=T.getFirstValue(arguments[5]);if(j(s))return s;if(!M(s))return m.error.v;s=parseInt(s);var h=0;if(arguments.length>=7){if(j(h=T.getFirstValue(arguments[6])))return h;if(!M(h))return m.error.v;h=parseInt(h)}var f,p=!0;if(arguments.length==8&&j(p=T.getCellBoolen(arguments[7])))return p;if(o<=0||d<=0||s!=1&&s!=2&&s!=4||h<0||h>4||Q(t)-Q(l)>=0)return m.error.nm;if(Q(l)-Q(a)>=0&&!p){var g=Q(a).date(),v=Q(a).month()+1,y=Q(a).year(),b=Q(l).date(),k=Q(l).month()+1,w=Q(l).year();switch(h){case 0:g===31&&b===31?(g=30,b=30):g===31?g=30:g===30&&b===31&&(b=30),f=(b+30*k+360*w-(g+30*v+360*y))/360;break;case 1:var _=365;if(y===w||y+1===w&&(v>k||v===k&&g>=b))return(y===w&&T.isLeapYear(y)||T.feb29Between(a,l)||k===1&&b===29)&&(_=366),Q(l).diff(Q(a),"days")/_;var C=w-y+1,A=(Q().set({year:w+1,month:0,date:1})-Q().set({year:y,month:0,date:1}))/1e3/60/60/24/C;f=Q(l).diff(Q(a),"days")/A;break;case 2:f=Q(l).diff(Q(a),"days")/360;break;case 3:f=Q(l).diff(Q(a),"days")/365;break;case 4:f=(b+30*k+360*w-(g+30*v+360*y))/360}}else switch(g=Q(t).date(),v=Q(t).month()+1,y=Q(t).year(),b=Q(l).date(),k=Q(l).month()+1,w=Q(l).year(),h){case 0:g===31&&b===31?(g=30,b=30):g===31?g=30:g===30&&b===31&&(b=30),f=(b+30*k+360*w-(g+30*v+360*y))/360;break;case 1:if(_=365,y===w||y+1===w&&(v>k||v===k&&g>=b))return(y===w&&T.isLeapYear(y)||T.feb29Between(t,l)||k===1&&b===29)&&(_=366),Q(l).diff(Q(t),"days")/_;C=w-y+1,A=(Q().set({year:w+1,month:0,date:1})-Q().set({year:y,month:0,date:1}))/1e3/60/60/24/C,f=Q(l).diff(Q(t),"days")/A;break;case 2:f=Q(l).diff(Q(t),"days")/360;break;case 3:f=Q(l).diff(Q(t),"days")/365;break;case 4:f=(b+30*k+360*w-(g+30*v+360*y))/360}return d*o*f}catch(S){var I=S;return I=m.errorInfo(I),[m.error.v,I]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l<=0||o<=0||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s,h=Q(t).date(),f=Q(t).month()+1,p=Q(t).year(),g=Q(a).date(),v=Q(a).month()+1,y=Q(a).year();switch(d){case 0:h===31&&g===31?(h=30,g=30):h===31?h=30:h===30&&g===31&&(g=30),s=(g+30*v+360*y-(h+30*f+360*p))/360;break;case 1:var b=365;if(p===y||p+1===y&&(f>v||f===v&&h>=g))return(p===y&&T.isLeapYear(p)||T.feb29Between(t,a)||v===1&&g===29)&&(b=366),Q(a).diff(Q(t),"days")/b;var k=y-p+1,w=(Q().set({year:y+1,month:0,date:1})-Q().set({year:p,month:0,date:1}))/1e3/60/60/24,_=w/k;s=Q(a).diff(Q(t),"days")/_;break;case 2:s=Q(a).diff(Q(t),"days")/360;break;case 3:s=Q(a).diff(Q(t),"days")/365;break;case 4:s=(g+30*v+360*y-(h+30*f+360*p))/360}return o*l*s}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o,d=0;if(arguments.length==4){if(j(d=T.getFirstValue(arguments[3])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l!=1&&l!=2&&l!=4||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s,h=Math.ceil(Q(a).diff(Q(t),"months")/(12/l))+1;for(e=1;e<=h;e++){var f=Q(a).subtract(12/l*e,"months");if(f<=Q(t)){o=f;break}}switch(d){case 0:var p=Q(o).date(),g=Q(o).month()+1,v=Q(o).year(),y=Q(t).date(),b=Q(t).month()+1,k=Q(t).year();p===31&&y===31?(p=30,y=30):p===31?p=30:p===30&&y===31&&(y=30),s=y+30*b+360*k-(p+30*g+360*v);break;case 1:case 2:case 3:s=Q(t).diff(Q(o),"days");break;case 4:p=Q(o).date(),g=Q(o).month()+1,v=Q(o).year(),s=(y=Q(t).date())+30*(b=Q(t).month()+1)+360*(k=Q(t).year())-(p+30*g+360*v)}return s}catch(_){var w=_;return w=m.errorInfo(w),[m.error.v,w]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o,d=0;if(arguments.length==4){if(j(d=T.getFirstValue(arguments[3])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l!=1&&l!=2&&l!=4||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;switch(d){case 0:o=360/l;break;case 1:var s=Math.ceil(Q(a).diff(Q(t),"months")/(12/l))+1;for(e=1;e<=s;e++){var h=Q(a).subtract(12/l*e,"months");if(h<=Q(t)){var f=Q(a).subtract(12/l*(e-1),"months");o=Q(f).diff(Q(h),"days");break}}break;case 2:o=360/l;break;case 3:o=365/l;break;case 4:o=360/l}return o}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o,d=0;if(arguments.length==4){if(j(d=T.getFirstValue(arguments[3])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l!=1&&l!=2&&l!=4||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s,h=Math.ceil(Q(a).diff(Q(t),"months")/(12/l))+1;for(e=1;e<=h;e++){var f=Q(a).subtract(12/l*e,"months");if(f<=Q(t)){o=Q(a).subtract(12/l*(e-1),"months");break}}switch(d){case 0:var p=Q(t).date(),g=Q(t).month()+1,v=Q(t).year(),y=Q(o).date(),b=Q(o).month()+1,k=Q(o).year();p===31&&y===31?(p=30,y=30):p===31?p=30:p===30&&y===31&&(y=30),s=y+30*b+360*k-(p+30*g+360*v);break;case 1:case 2:case 3:s=Q(o).diff(Q(t),"days");break;case 4:p=Q(t).date(),g=Q(t).month()+1,v=Q(t).year(),s=(y=Q(o).date())+30*(b=Q(o).month()+1)+360*(k=Q(o).year())-(p+30*g+360*v)}return s}catch(_){var w=_;return w=m.errorInfo(w),[m.error.v,w]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o,d=0;if(arguments.length==4){if(j(d=T.getFirstValue(arguments[3])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l!=1&&l!=2&&l!=4||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s=Math.ceil(Q(a).diff(Q(t),"months")/(12/l))+1;for(e=1;e<=s;e++){var h=Q(a).subtract(12/l*e,"months");if(h<=Q(t)){o=Q(a).subtract(12/l*(e-1),"months");break}}return Q(o).format("YYYY-MM-DD")}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o,d=0;if(arguments.length==4){if(j(d=T.getFirstValue(arguments[3])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l!=1&&l!=2&&l!=4||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s=Math.ceil(Q(a).diff(Q(t),"months")/(12/l))+1;for(e=1;e<=s;e++){var h=Q(a).subtract(12/l*e,"months");if(h<=Q(t)){o=h;break}}return Q(o).format("YYYY-MM-DD")}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=0;if(arguments.length>=4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseFloat(o)}var d,s=0;if(arguments.length>=5){if(j(s=T.getFirstValue(arguments[4])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return m.error.nm;if(t===0)d=o+l*a;else{var h=Math.pow(1+t,a);d=s===1?o*h+l*(1+t)*(h-1)/t:o*h+l*(h-1)/t}return-d}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=arguments[1],l=[];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;l=l.concat(T.getDataArr(a,!1))}else D(a)=="object"&&a.startCell!=null?l=l.concat(T.getCellDataArr(a,"number",!1)):l.push(a);var o=[];for(e=0;e<l.length;e++){var d=l[e];if(!M(d))return m.error.v;o.push(parseFloat(d))}var s=o.length,h=t;for(e=0;e<s;e++)h*=1+o[e];return h}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseFloat(d);var s=T.getFirstValue(arguments[5]);if(j(s))return s;if(!M(s))return m.error.v;s=parseInt(s);var h=0;if(arguments.length==7){if(j(h=T.getFirstValue(arguments[6])))return h;if(!M(h))return m.error.v;h=parseInt(h)}if(l<0||o<=0||d<=0||s!=1&&s!=2&&s!=4||h<0||h>4||Q(t)-Q(a)>=0)return m.error.nm;var f=window.luckysheet_function.COUPNUM.f(t,a,s,h);if(f>1){var p=1,g=0,v=p;for(e=1;e<=100;e++){var y=window.luckysheet_function.PRICE.f(t,a,l,v,d,s,h);if(Math.abs(y-o)<1e-6)break;y>o?g=v:p=v,v=(p+g)/2}var b=v}else{var k=window.luckysheet_function.COUPDAYSNC.f(t,a,s,h),w=window.luckysheet_function.COUPDAYS.f(t,a,s,h),_=window.luckysheet_function.COUPDAYBS.f(t,a,s,h),C=d/100+l/s,A=o/100+_/w*(l/s),I=s*w/k;b=(C-A)/A*I}return b}catch(E){var S=E;return S=m.errorInfo(S),[m.error.v,S]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l<=0||o<=0||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s=window.luckysheet_function.YEARFRAC.f(t,a,d);return(o/l-1)/s}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a),t<=0||a<1?m.error.nm:(Math.pow(t+1,1/a)-1)*a):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!1)):a.push(t);var l=[];for(e=0;e<a.length;e++){var o=a[e];if(!M(o))return m.error.v;l.push(parseFloat(o))}var d=T.getCellrangeDate(arguments[1]);if(j(d))return d;for(e=0;e<d.length;e++)if(!Q(d[e]).isValid())return m.error.v;var s=.1;if(arguments.length==3){if(j(s=T.getFirstValue(arguments[2])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}var h=!1,f=!1;for(e=0;e<l.length&&(l[e]>0&&(h=!0),l[e]<0&&(f=!0),!h||!f);e++);if(!h||!f||l.length!=d.length)return m.error.nm;var p,g,v,y=function(A,I,S){for(var E=S+1,R=A[0],F=1;F<A.length;F++)R+=A[F]/Math.pow(E,window.luckysheet_function.DAYS.f(I[F],I[0])/365);return R},b=function(A,I,S){for(var E=S+1,R=0,F=1;F<A.length;F++){var N=window.luckysheet_function.DAYS.f(I[F],I[0])/365;R-=N*A[F]/Math.pow(E,N+1)}return R},k=s,w=1e-10,_=!0;do p=k-(v=y(l,d,k))/b(l,d,k),g=Math.abs(p-k),k=p,_=g>w&&Math.abs(v)>w;while(_);return k}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!1)):a.push(t);var l=[];for(e=0;e<a.length;e++){var o=a[e];if(!M(o))return m.error.v;l.push(parseFloat(o))}var d=T.getFirstValue(arguments[1]);if(j(d))return d;if(!M(d))return m.error.v;d=parseFloat(d);var s=T.getFirstValue(arguments[2]);if(j(s))return s;if(!M(s))return m.error.v;s=parseFloat(s);var h=l.length,f=[],p=[];for(e=0;e<h;e++)l[e]<0?f.push(l[e]):p.push(l[e]);if(f.length==0||p.length==0)return m.error.d;var g=-window.luckysheet_function.NPV.f(s,p)*Math.pow(1+s,h-1),v=window.luckysheet_function.NPV.f(d,f)*(1+d);return Math.pow(g/v,1/(h-1))-1}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"number",!0)):a.push(t);var l=[];for(e=0;e<a.length;e++){var o=a[e];if(!M(o))return m.error.v;l.push(parseFloat(o))}var d=.1;if(arguments.length==2){if(j(d=T.getFirstValue(arguments[1])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}var s=[],h=!1,f=!1;for(e=0;e<a.length;e++)s[e]=e===0?0:s[e-1]+365,a[e]>0&&(h=!0),a[e]<0&&(f=!0);if(!h||!f)return m.error.nm;var p,g,v,y=function(A,I,S){for(var E=S+1,R=A[0],F=1;F<A.length;F++)R+=A[F]/Math.pow(E,(I[F]-I[0])/365);return R},b=function(A,I,S){for(var E=S+1,R=0,F=1;F<A.length;F++){var N=(I[F]-I[0])/365;R-=N*A[F]/Math.pow(E,N+1)}return R},k=d,w=1e-10,_=!0;do p=k-(v=y(l,s,k))/b(l,s,k),g=Math.abs(p-k),k=p,_=g>w&&Math.abs(v)>w;while(_);return k}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=[];for(e=1;e<arguments.length;e++){var l=arguments[e];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;a=a.concat(T.getDataArr(l,!0))}else D(l)=="object"&&l.startCell!=null?a=a.concat(T.getCellDataArr(l,"number",!0)):a.push(l)}var o=[];for(e=0;e<a.length;e++){var d=a[e];M(d)&&o.push(parseFloat(d))}var s=0;if(o.length>0)for(e=0;e<o.length;e++)s+=o[e]/Math.pow(1+t,e+1);return s}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=arguments[1],l=[];if(D(a)=="array"){if(D(a[0])=="array"&&!T.isDyadicArr(a))return m.error.v;l=l.concat(T.getDataArr(a,!1))}else D(a)=="object"&&a.startCell!=null?l=l.concat(T.getCellDataArr(a,"number",!1)):l.push(a);var o=[];for(e=0;e<l.length;e++){var d=l[e];if(!M(d))return m.error.v;o.push(parseFloat(d))}var s=T.getCellrangeDate(arguments[2]);if(j(s))return s;for(e=0;e<s.length;e++)if(!Q(s[e]).isValid())return m.error.v;if(o.length!=s.length)return m.error.nm;var h=0;for(e=0;e<o.length;e++)h+=o[e]/Math.pow(1+t,window.luckysheet_function.DAYS.f(s[e],s[0])/365);return h}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseInt(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=T.getFirstValue(arguments[5]);if(j(s))return s;if(!M(s))return m.error.v;if(s=parseFloat(s),t<=0||a<=0||l<=0||o<1||d<1||o>d||s!=0&&s!=1)return m.error.nm;var h=window.luckysheet_function.PMT.f(t,a,l,0,s),f=0;for(o===1&&s===0&&(f=-l,o++),e=o;e<=d;e++)f+=s===1?window.luckysheet_function.FV.f(t,e-2,h,l,1)-h:window.luckysheet_function.FV.f(t,e-1,h,l,0);return f*=t}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=0;if(arguments.length>=4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseFloat(o)}var d,s=0;if(arguments.length==5){if(j(s=T.getFirstValue(arguments[4])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return m.error.nm;if(t===0)d=(l+o)/a;else{var h=Math.pow(1+t,a);d=s===1?(o*t/(h-1)+l*t/(1-1/h))/(1+t):o*t/(h-1)+l*t/(1-1/h)}return-d}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length>=5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}var s=0;if(arguments.length>=6){if(j(s=T.getFirstValue(arguments[5])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}if(a<1||a>l||s!=0&&s!=1)return m.error.nm;var h=window.luckysheet_function.PMT.f(t,l,o,d,s),f=(a===1?s===1?0:-o:s===1?window.luckysheet_function.FV.f(t,a-2,h,o,1)-h:window.luckysheet_function.FV.f(t,a-1,h,o,0))*t;return f}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length>=5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}var s=0;if(arguments.length>=6){if(j(s=T.getFirstValue(arguments[5])))return s;if(!M(s))return m.error.v;s=parseFloat(s)}if(a<1||a>l||s!=0&&s!=1)return m.error.nm;var h=window.luckysheet_function.PMT.f(t,l,o,d,s),f=window.luckysheet_function.IPMT.f(t,a,l,o,d,s);return h-f}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l<=0||o<=0||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s,h=Q(t).date(),f=Q(t).month()+1,p=Q(t).year(),g=Q(a).date(),v=Q(a).month()+1,y=Q(a).year();switch(d){case 0:h===31&&g===31?(h=30,g=30):h===31?h=30:h===30&&g===31&&(g=30),s=360/(g+30*v+360*y-(h+30*f+360*p));break;case 1:var b=365;if(p===y||p+1===y&&(f>v||f===v&&h>=g))return(p===y&&T.isLeapYear(p)||T.feb29Between(t,a)||v===1&&g===29)&&(b=366),s=b/Q(a).diff(Q(t),"days"),s*=(o-l)/l;var k=y-p+1,w=(Q().set({year:y+1,month:0,date:1})-Q().set({year:p,month:0,date:1}))/1e3/60/60/24,_=w/k;s=_/Q(a).diff(Q(t),"days");break;case 2:s=360/Q(a).diff(Q(t),"days");break;case 3:s=365/Q(a).diff(Q(t),"days");break;case 4:s=360/(g+30*v+360*y-(h+30*f+360*p))}return s*=(o-l)/l}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseFloat(d);var s=T.getFirstValue(arguments[5]);if(j(s))return s;if(!M(s))return m.error.v;s=parseInt(s);var h=0;if(arguments.length==7){if(j(h=T.getFirstValue(arguments[6])))return h;if(!M(h))return m.error.v;h=parseInt(h)}if(l<0||o<0||d<=0||s!=1&&s!=2&&s!=4||h<0||h>4||Q(t)-Q(a)>=0)return m.error.nm;var f=window.luckysheet_function.COUPDAYSNC.f(t,a,s,h),p=window.luckysheet_function.COUPDAYS.f(t,a,s,h),g=window.luckysheet_function.COUPDAYBS.f(t,a,s,h),v=window.luckysheet_function.COUPNUM.f(t,a,s,h);if(v>1){var y=d/Math.pow(1+o/s,v-1+f/p),b=0;for(e=1;e<=v;e++)b+=100*l/s/Math.pow(1+o/s,e-1+f/p);var k=y+b-l/s*100*(g/p)}else{var w=p-g;k=(y=l/s*100+d)/(b=o/s*(w/p)+1)-l/s*100*(g/p)}return k}catch(C){var _=C;return _=m.errorInfo(_),[m.error.v,_]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseInt(d)}if(l<=0||o<=0||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s,h=Q(t).date(),f=Q(t).month()+1,p=Q(t).year(),g=Q(a).date(),v=Q(a).month()+1,y=Q(a).year();switch(d){case 0:h===31&&g===31?(h=30,g=30):h===31?h=30:h===30&&g===31&&(g=30),s=(g+30*v+360*y-(h+30*f+360*p))/360;break;case 1:var b=365;if(p===y||p+1===y&&(f>v||f===v&&h>=g))return(p===y&&T.isLeapYear(p)||T.feb29Between(t,a)||v===1&&g===29)&&(b=366),s=o-l*o*(s=Q(a).diff(Q(t),"days")/b);var k=y-p+1,w=(Q().set({year:y+1,month:0,date:1})-Q().set({year:p,month:0,date:1}))/1e3/60/60/24,_=w/k;s=Q(a).diff(Q(t),"days")/_;break;case 2:s=Q(a).diff(Q(t),"days")/360;break;case 3:s=Q(a).diff(Q(t),"days")/365;break;case 4:s=(g+30*v+360*y-(h+30*f+360*p))/360}return s=o-l*o*s}catch(A){var C=A;return C=m.errorInfo(C),[m.error.v,C]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getCellDate(arguments[2]);if(j(l))return l;if(!Q(l).isValid())return m.error.v;var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseFloat(d);var s=0;if(arguments.length==6){if(j(s=T.getFirstValue(arguments[5])))return s;if(!M(s))return m.error.v;s=parseInt(s)}if(o<0||d<0||s<0||s>4||Q(t)-Q(a)>=0)return m.error.nm;var h=Q(t).date(),f=Q(t).month()+1,p=Q(t).year(),g=Q(a).date(),v=Q(a).month()+1,y=Q(a).year(),b=Q(l).date(),k=Q(l).month()+1,w=Q(l).year();switch(s){case 0:h==31&&(h=30),g==31&&(g=30),b==31&&(b=30);var _=360,C=g+30*v+360*y-(h+30*f+360*p),A=g+30*v+360*y-(b+30*k+360*w),I=h+30*f+360*p-(b+30*k+360*w);break;case 1:var S=365;if(p===y||p+1===y&&(f>v||f===v&&h>=g))return(p===y&&T.isLeapYear(p)||T.feb29Between(t,a)||v===1&&g===29)&&(S=366),_=S,C=Q(a).diff(Q(t),"days"),(100+(A=Q(t).diff(Q(l),"days"))/_*o*100)/(1+C/_*d)-(I=Q(a).diff(Q(l),"days"))/_*o*100;var E=y-p+1,R=(Q().set({year:y+1,month:0,date:1})-Q().set({year:p,month:0,date:1}))/1e3/60/60/24,F=R/E;_=F,C=Q(a).diff(Q(t),"days"),A=Q(t).diff(Q(l),"days"),I=Q(a).diff(Q(l),"days");break;case 2:_=360,C=Q(a).diff(Q(t),"days"),A=Q(t).diff(Q(l),"days"),I=Q(a).diff(Q(l),"days");break;case 3:_=365,C=Q(a).diff(Q(t),"days"),A=Q(t).diff(Q(l),"days"),I=Q(a).diff(Q(l),"days");break;case 4:_=360,C=g+30*v+360*y-(h+30*f+360*p),A=g+30*v+360*y-(b+30*k+360*w),I=h+30*f+360*p-(b+30*k+360*w)}return(100+A/_*o*100)/(1+C/_*d)-I/_*o*100}catch(z){var N=z;return N=m.errorInfo(N),[m.error.v,N]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}if(l<=0||o<=0||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s=Q(t).date(),h=Q(t).month()+1,f=Q(t).year(),p=Q(a).date(),g=Q(a).month()+1,v=Q(a).year();switch(d){case 0:s==31&&(s=30),p==31&&(p=30);var y=360,b=p+30*g+360*v-(s+30*h+360*f);break;case 1:var k=365;if(f===v||f+1===v&&(h>g||h===g&&s>=p))return(f===v&&T.isLeapYear(f)||T.feb29Between(t,a)||g===1&&p===29)&&(k=366),y=k,l/(1-o*(b=Q(a).diff(Q(t),"days"))/y);var w=v-f+1,_=(Q().set({year:v+1,month:0,date:1})-Q().set({year:f,month:0,date:1}))/1e3/60/60/24,C=_/w;y=C,b=Q(a).diff(Q(t),"days");break;case 2:y=360,b=Q(a).diff(Q(t),"days");break;case 3:y=365,b=Q(a).diff(Q(t),"days");break;case 4:y=360,b=p+30*g+360*v-(s+30*h+360*f)}return l/(1-o*b/y)}catch(I){var A=I;return A=m.errorInfo(A),[m.error.v,A]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=0;if(arguments.length==5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}if(l<=0||o<=0||d<0||d>4||Q(t)-Q(a)>=0)return m.error.nm;var s=Q(t).date(),h=Q(t).month()+1,f=Q(t).year(),p=Q(a).date(),g=Q(a).month()+1,v=Q(a).year();switch(d){case 0:s==31&&(s=30),p==31&&(p=30);var y=360,b=p+30*g+360*v-(s+30*h+360*f);break;case 1:var k=365;if(f===v||f+1===v&&(h>g||h===g&&s>=p))return(f===v&&T.isLeapYear(f)||T.feb29Between(t,a)||g===1&&p===29)&&(k=366),(o-l)/o*((y=k)/(b=Q(a).diff(Q(t),"days")));var w=v-f+1,_=(Q().set({year:v+1,month:0,date:1})-Q().set({year:f,month:0,date:1}))/1e3/60/60/24,C=_/w;y=C,b=Q(a).diff(Q(t),"days");break;case 2:y=360,b=Q(a).diff(Q(t),"days");break;case 3:y=365,b=Q(a).diff(Q(t),"days");break;case 4:y=360,b=p+30*g+360*v-(s+30*h+360*f)}return(o-l)/o*(y/b)}catch(I){var A=I;return A=m.errorInfo(A),[m.error.v,A]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=0;if(arguments.length>=4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseFloat(o)}var d=0;if(arguments.length>=5){if(j(d=T.getFirstValue(arguments[4])))return d;if(!M(d))return m.error.v;d=parseFloat(d)}if(d!=0&&d!=1)return m.error.nm;var s=a*(1+t*d)-o*t,h=l*t+a*(1+t*d);return Math.log(s/h)/Math.log(1+t)}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseFloat(l))==0?m.error.d:(t-a)/l:m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=0;if(arguments.length==6){if(j(s=T.getFirstValue(arguments[5])))return s;if(!M(s))return m.error.v;s=parseInt(s)}if(l<0||o<0||d!=1&&d!=2&&d!=4||s<0||s>4||Q(t)-Q(a)>=0)return m.error.nm;var h=window.luckysheet_function.COUPNUM.f(t,a,d,s),f=0,p=0;for(e=1;e<=h;e++)f+=l/d*100*e/Math.pow(1+o/d,e),p+=l/d*100/Math.pow(1+o/d,e);var g=(f+100*h/Math.pow(1+o/d,h))/(p+100/Math.pow(1+o/d,h));return g/=d}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellDate(arguments[0]);if(j(t))return t;if(!Q(t).isValid())return m.error.v;var a=T.getCellDate(arguments[1]);if(j(a))return a;if(!Q(a).isValid())return m.error.v;var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseFloat(l);var o=T.getFirstValue(arguments[3]);if(j(o))return o;if(!M(o))return m.error.v;o=parseFloat(o);var d=T.getFirstValue(arguments[4]);if(j(d))return d;if(!M(d))return m.error.v;d=parseInt(d);var s=0;if(arguments.length==6){if(j(s=T.getFirstValue(arguments[5])))return s;if(!M(s))return m.error.v;s=parseInt(s)}if(l<0||o<0||d!=1&&d!=2&&d!=4||s<0||s>4||Q(t)-Q(a)>=0)return m.error.nm;var h=window.luckysheet_function.DURATION.f(t,a,l,o,d,s);return h/(1+o/d)}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!/^[01]{1,10}$/g.test(t))return m.error.nm;var a=parseInt(t,2),l=t.toString();return l.length===10&&l.substring(0,1)==="1"?parseInt(l.substring(1),2)-512:a}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^[01]{1,10}$/g.test(t))return m.error.nm;var l=parseInt(t,2).toString(16).toUpperCase();return a==null?l:a<0||a<l.length?m.error.nm:new Array(a-l.length+1).join("0")+l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^[01]{1,10}$/g.test(t))return m.error.nm;var l=t.toString();if(l.length===10&&l.substring(0,1)==="1")return(1073741312+parseInt(l.substring(1),2)).toString(8);var o=parseInt(t,2).toString(8);return a==null?o:a<0||a<o.length?m.error.nm:new Array(a-o.length+1).join("0")+o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return m.error.nm;if(t<0)return"1"+new Array(9-(512+t).toString(2).length).join("0")+(512+t).toString(2);var l=parseInt(t,10).toString(2);return a==null?l:a<0||a<l.length?m.error.nm:new Array(a-l.length+1).join("0")+l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return m.error.nm;if(t<0)return(1099511627776+t).toString(16).toUpperCase();var l=parseInt(t,10).toString(16).toUpperCase();return a==null?l:a<0||a<l.length?m.error.nm:new Array(a-l.length+1).join("0")+l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return m.error.nm;if(t<0)return(1073741824+t).toString(8);var l=parseInt(t,10).toString(8);return a==null?l:a<0||a<l.length?m.error.nm:new Array(a-l.length+1).join("0")+l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return m.error.nm;var l=t.length===10&&t.substring(0,1).toLowerCase()==="f",o=l?parseInt(t,16)-1099511627776:parseInt(t,16);if(o<-512||o>511)return m.error.nm;if(l)return"1"+new Array(9-(512+o).toString(2).length).join("0")+(512+o).toString(2);var d=o.toString(2);return a==null?d:a<0||a<d.length?m.error.nm:new Array(a-d.length+1).join("0")+d}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return m.error.nm;var a=parseInt(t,16);return a>=549755813888?a-1099511627776:a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return m.error.nm;var l=parseInt(t,16);if(l>536870911&&l<0xffe0000000)return m.error.nm;if(l>=0xffe0000000)return(l-0xffc0000000).toString(8);var o=l.toString(8);return a==null?o:a<0||a<o.length?m.error.nm:new Array(a-o.length+1).join("0")+o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^[0-7]{1,10}$/.test(t))return m.error.nm;var l=(t=t.toString()).length===10&&t.substring(0,1)==="7",o=l?parseInt(t,8)-1073741824:parseInt(t,8);if(o<-512||o>511)return yr.num;if(l)return"1"+new Array(9-(512+o).toString(2).length).join("0")+(512+o).toString(2);var d=o.toString(2);return a==null?d:a<0||a<d.length?m.error.nm:new Array(a-d.length+1).join("0")+d}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!/^[0-7]{1,10}$/.test(t))return m.error.nm;var a=parseInt(t,8);return a>=536870912?a-1073741824:a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=null;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(!/^[0-7]{1,10}$/.test(t))return m.error.nm;var l=parseInt(t,8);if(l>=536870912)return"FF"+(l+3221225472).toString(16).toUpperCase();var o=l.toString(16).toUpperCase();return a==null?o:a<0||a<o.length?m.error.nm:new Array(a-o.length+1).join("0")+o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseFloat(a);var l="i";if(arguments.length==3&&(l=arguments[2].toString()),l!="i"&&l!="j")return m.error.v;if(t===0&&a===0)return 0;if(t===0)return a===1?l:a.toString()+l;if(a===0)return t.toString();var o=a>0?"+":"";return t.toString()+o+(a===1?l:a.toString()+l)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if((t=t.toString()).toLowerCase()=="true"||t.toLowerCase()=="false")return m.error.v;if(t=="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var a=t.indexOf("+"),l=t.indexOf("-");a===0&&(a=t.indexOf("+",1)),l===0&&(l=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),d=o==="i"||o==="j";return a>=0||l>=0?d?a>=0?isNaN(t.substring(0,a))||isNaN(t.substring(a+1,t.length-1))?m.error.nm:Number(t.substring(0,a)):isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?m.error.nm:Number(t.substring(0,l)):m.error.nm:d?isNaN(t.substring(0,t.length-1))?m.error.nm:0:isNaN(t)?m.error.nm:t}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if((t=t.toString()).toLowerCase()=="true"||t.toLowerCase()=="false")return m.error.v;if(t=="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;var a=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),l=t.indexOf("-");a===0&&(a=t.indexOf("+",1)),l===0&&(l=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),d=o==="i"||o==="j";return a>=0||l>=0?d?a>=0?isNaN(t.substring(0,a))||isNaN(t.substring(a+1,t.length-1))?m.error.nm:Number(t.substring(a+1,t.length-1)):isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?m.error.nm:-Number(t.substring(l+1,t.length-1)):m.error.nm:d?isNaN(t.substring(0,t.length-1))?m.error.nm:t.substring(0,t.length-1):isNaN(t)?m.error.nm:0}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;t=t.toString();var a=window.luckysheet_function.IMREAL.f(t);if(j(a))return a;var l=window.luckysheet_function.IMAGINARY.f(t);if(j(l))return l;var o=t.substring(t.length-1);return o=o==="i"||o==="j"?o:"i",l!==0?window.luckysheet_function.COMPLEX.f(a,-l,o):t}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(j(t))return t;var a=window.luckysheet_function.IMAGINARY.f(arguments[0]);return j(a)?a:Math.sqrt(Math.pow(t,2)+Math.pow(a,2))}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=0;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseFloat(a)}return t===a?1:0}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(j(t))return t;var a=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(j(a))return a;var l=arguments[0];for(e=1;e<arguments.length;e++){var o=window.luckysheet_function.IMREAL.f(l);if(j(o))return o;var d=window.luckysheet_function.IMAGINARY.f(l);if(j(d))return d;var s=window.luckysheet_function.IMREAL.f(arguments[e]);if(j(s))return s;var h=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(j(h))return h;l=window.luckysheet_function.COMPLEX.f(o+s,d+h)}return l}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if((t=t.toString()).toLowerCase()=="true"||t.toLowerCase()=="false")return m.error.v;var a=window.luckysheet_function.IMREAL.f(t);if(j(a))return a;var l=window.luckysheet_function.IMAGINARY.f(t);if(j(l))return l;var o=T.getFirstValue(arguments[1]);if(j(o))return o;if((o=o.toString()).toLowerCase()=="true"||o.toLowerCase()=="false")return m.error.v;var d=window.luckysheet_function.IMREAL.f(o);if(j(d))return d;var s=window.luckysheet_function.IMAGINARY.f(o);if(j(s))return s;var h=t.substring(t.length-1),f=o.substring(o.length-1),p="i";return(h==="j"||f==="j")&&(p="j"),window.luckysheet_function.COMPLEX.f(a-d,l-s,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(j(t))return t;var a=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(j(a))return a;var l=arguments[0];for(e=1;e<arguments.length;e++){var o=window.luckysheet_function.IMREAL.f(l);if(j(o))return o;var d=window.luckysheet_function.IMAGINARY.f(l);if(j(d))return d;var s=window.luckysheet_function.IMREAL.f(arguments[e]);if(j(s))return s;var h=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(j(h))return h;l=window.luckysheet_function.COMPLEX.f(o*s-d*h,o*h+d*s)}return l}catch(p){var f=p;return f=m.errorInfo(f),[m.error.v,f]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if((t=t.toString()).toLowerCase()=="true"||t.toLowerCase()=="false")return m.error.v;var a=window.luckysheet_function.IMREAL.f(t);if(j(a))return a;var l=window.luckysheet_function.IMAGINARY.f(t);if(j(l))return l;var o=T.getFirstValue(arguments[1]);if(j(o))return o;if((o=o.toString()).toLowerCase()=="true"||o.toLowerCase()=="false")return m.error.v;var d=window.luckysheet_function.IMREAL.f(o);if(j(d))return d;var s=window.luckysheet_function.IMAGINARY.f(o);if(j(s))return s;var h=t.substring(t.length-1),f=o.substring(o.length-1),p="i";if((h==="j"||f==="j")&&(p="j"),d===0&&s===0)return m.error.nm;var g=d*d+s*s;return window.luckysheet_function.COMPLEX.f((a*d+l*s)/g,(l*d-a*s)/g,p)}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellBoolen(arguments[0]);return j(t)?t:!t}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return!0}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return!1}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=!0;for(e=0;e<arguments.length;e++){var a=T.getCellBoolen(arguments[e]);if(j(a))return a;if(!a){t=!1;break}}return t}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[1],"text"),a=T.getFirstValue(arguments[0],"text");return j(a)||D(a)==="string"&&$.trim(a)===""?t:a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getCellBoolen(arguments[0]);if(j(t))return t;var a=T.getFirstValue(arguments[1],"text");if(j(a)&&l!=yr.d)return a;var l="";return arguments.length==3&&j(l=T.getFirstValue(arguments[2],"text"))&&l!=yr.d?l:t?a:l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=!1;for(e=0;e<arguments.length;e++){var a=T.getCellBoolen(arguments[e]);if(j(a))return a;if(a){t=!0;break}}return t}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=T.getFirstValue(arguments[1]);return j(a)?a:t!=a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;var a=T.getFirstValue(arguments[1]);return j(a)?a:t==a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t>(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t>=(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t<(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t<=(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t+(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t-(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?t*(a=parseFloat(a)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseFloat(a))==0?m.error.d:t/a:m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;var a=T.getFirstValue(arguments[1],"text");return j(a)?a:t+""+a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;var a=(t=parseFloat(t))/100;return Math.round(100*a)/100}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t="";for(e=0;e<arguments.length;e++){var a=T.getFirstValue(arguments[e],"text");if(j(a))return a;t=t+""+a}return t}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:t==""?m.error.v:t.charCodeAt(0)}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseInt(t))<1||t>255?m.error.v:String.fromCharCode(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;if(t=t.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return m.error.v;var a=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(o){a+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[o]}),a}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let l=function(o){var d=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]];return d[3][Math.floor(o/1e3)]+d[2][Math.floor(o%1e3/100)]+d[1][Math.floor(o%100/10)]+d[0][o%10]};var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?(t=parseInt(t))==0?"":t<1||t>3999?m.error.v:l(t):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;var l=t.match(new RegExp(a));return l?l[l.length>1?l.length-1:0]:null}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;var l=t.match(new RegExp(a));return!!l}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;var l=T.getFirstValue(arguments[2],"text");return j(l)?l:t.replace(new RegExp(a),l)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)||D(t)=="string"?t:""}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=2;if(arguments.length>=2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}var l=!1;if(arguments.length==3&&j(l=T.getCellBoolen(arguments[2])))return l;if(a>127)return m.error.v;var o=l?"0":"#,##0";return a<=0?t=Math.round(t*Math.pow(10,a))/Math.pow(10,a):a>0&&(o+="."+new Array(a+1).join("0")),za(o,t)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;a=a.toString();var l=1;if(arguments.length==3){if(j(l=T.getFirstValue(arguments[2])))return l;if(!M(l))return m.error.v;l=parseFloat(l)}if(l<0||l>a.length)return m.error.v;if(t=="")return l;if(a.indexOf(t)==-1)return m.error.v;var o=a.indexOf(t,l-1)+1;return o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;a=a.toString();var l=1;if(arguments.length==3){if(j(l=T.getFirstValue(arguments[2])))return l;if(!M(l))return m.error.v;l=parseFloat(l)}if(l<0||l>a.length)return m.error.v;if(t=="")return l;if(a.indexOf(t)==-1)return m.error.v;var o=a.split(""),d=a.indexOf(t,l-1),s=0;for(e=0;e<d;e++)/[^\x00-\xff]/g.test(o[e])?s+=2:s+=1;return s}catch(f){var h=f;return h=m.errorInfo(h),[m.error.v,h]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;var a=[];for(e=1;e<arguments.length;e++){var l=arguments[e];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;a=a.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?a=a.concat(T.getCellDataArr(l,"text",!1)):a.push(l)}return a.join(t)}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=1;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}return a<0?m.error.v:a>=t.length?t:a==0?"":t.substr(0,a)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=1;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}return a<0?m.error.v:a>=t.length?t:a==0?"":t.substr(-a,a)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);return j(l)?l:M(l)?(l=parseInt(l),a<1||l<0?m.error.v:a>t.length?"":a+l>t.length?t.substr(a-1,t.length-a+1):t.substr(a-1,l)):m.error.v}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:(t=t.toString()).length}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:(t=t.toString()).replace(/[^\x00-\xff]/g,"aa").length}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:(t=t.toString())?t.toLowerCase():t}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:(t=t.toString())?t.toUpperCase():t}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1],"text");return j(a)?a:t===(a=a.toString())}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1]);if(j(a))return a;if(!M(a))return m.error.v;a=parseInt(a);var l=T.getFirstValue(arguments[2]);if(j(l))return l;if(!M(l))return m.error.v;l=parseInt(l);var o=T.getFirstValue(arguments[3],"text");return j(o)?o:(o=o.toString(),t.substr(0,a-1)+o+t.substr(a-1+l))}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1]);return j(a)?a:M(a)?(a=parseInt(a))<0?m.error.v:(a>100&&(a=100),new Array(a+1).join(t)):m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;a=a.toString();var l=1;if(arguments.length==3){if(j(l=T.getFirstValue(arguments[2])))return l;if(!M(l))return m.error.v;l=parseInt(l)}if(l<=0||l>a.length)return m.error.v;var o=a.toLowerCase().indexOf(t.toLowerCase(),l-1)+1;return o===0?m.error.v:o}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;a=a.toString();var l=T.getFirstValue(arguments[2],"text");if(j(l))return l;l=l.toString();var o=null;if(arguments.length==4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseInt(o)}var d,s=new RegExp(a,"g");if(o==null)d=t.replace(s,l);else{if(o<=0)return m.error.v;var h=t.match(s);if(h==null||o>h.length)return t;var f=a.length,p=0;for(e=1;e<=o;e++)p=t.indexOf(a,p)+1;d=t.substring(0,p-1)+l+t.substring(p-1+f)}return d}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");if(j(t))return t;t=t.toString();var a=[];for(e=0;e<t.length;e++){var l=t.charCodeAt(e);(/[\u4e00-\u9fa5]/g.test(t.charAt(e))||l>31&&l<127)&&a.push(t.charAt(e))}return a.join("")}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1],"text");return j(a)?a:za(a=a.toString(),t)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:(t=t.toString()).replace(/ +/g," ").trim()}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:_a(t=t.toString())[2]}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:(t=t.toString().toLowerCase()).replace(/[a-zA-Z]+/g,function(l){return l.substring(0,1).toUpperCase()+l.substring(1)})}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseFloat(t);var a=T.getFirstValue(arguments[1],"text");if(j(a))return a;a=a.toString();var l=T.getFirstValue(arguments[2],"text");if(j(l))return l;l=l.toString();var o,d=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},h={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},f=null,p=null,g=a,v=l,y=1,b=1;for(e=0;e<d.length;e++)o=d[e][2]===null?[]:d[e][2],(d[e][1]===g||o.indexOf(g)>=0)&&(f=d[e]),(d[e][1]===v||o.indexOf(v)>=0)&&(p=d[e]);if(f===null){var k=s[a.substring(0,2)],w=h[a.substring(0,1)];a.substring(0,2)==="da"&&(w=["dekao",10,"da"]),k?(y=k[2],g=a.substring(2)):w&&(y=w[1],g=a.substring(w[2].length));for(var _=0;_<d.length;_++)o=d[_][2]===null?[]:d[_][2],(d[_][1]===g||o.indexOf(g)>=0)&&(f=d[_])}if(p===null){var C=s[l.substring(0,2)],A=h[l.substring(0,1)];l.substring(0,2)==="da"&&(A=["dekao",10,"da"]),C?(b=C[2],v=l.substring(2)):A&&(b=A[1],v=l.substring(A[2].length));for(var I=0;I<d.length;I++)o=d[I][2]===null?[]:d[I][2],(d[I][1]===v||o.indexOf(v)>=0)&&(p=d[I])}return f===null||p===null||f[3]!==p[3]?m.error.na:t*f[6]*y/(p[6]*b)}catch(E){var S=E;return S=m.errorInfo(S),[m.error.v,S]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}var p=0;for(e=0;e<d.length;e++)p+=Math.pow(d[e],2)-Math.pow(s[e],2);return p}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}var p=0;for(e=0;e<d.length;e++)p+=Math.pow(d[e],2)+Math.pow(s[e],2);return p}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!1))}else D(t)=="object"&&t.startCell!=null?a=a.concat(T.getCellDataArr(t,"text",!1)):a.push(t);var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=o.concat(T.getDataArr(l,!1))}else D(l)=="object"&&l.startCell!=null?o=o.concat(T.getCellDataArr(l,"text",!1)):o.push(l);if(a.length!=o.length)return m.error.na;var d=[],s=[];for(e=0;e<a.length;e++){var h=a[e],f=o[e];M(h)&&M(f)&&(d.push(parseFloat(h)),s.push(parseFloat(f)))}var p=0;for(e=0;e<d.length;e++)p+=Math.pow(d[e]-s[e],2);return p}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else D(t)=="object"&&t.startCell!=null&&(a=T.getCellDataDyadicArr(t,"number"));return a=a[0].map(function(o,d){return a.map(function(s){return s[d]})})}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let R=function(F,N){for(var z=0,P=0,q=0,V=0,x=0;x<F.length;x++)for(var ee=0;ee<F[x].length;ee++)z+=F[x][ee],P+=N[x][ee],q+=F[x][ee]*N[x][ee],V+=F[x][ee]*F[x][ee];var ne=F.length*F[0].length,ae=z/ne,de=P/ne,ve=(q/ne-ae*de)/(V/ne-ae*ae);return[ve,de-ve*ae]};var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else if(D(t)=="object"&&t.startCell!=null)a=T.getCellDataDyadicArr(t,"text");else{if(!M(t))return m.error.v;(b=[]).push(parseFloat(t)),a.push(b)}var l=a.length,o=a[0].length;for(e=0;e<l;e++)for(var d=0;d<o;d++){if(!M(a[e][d]))return m.error.v;a[e][d]=parseFloat(a[e][d])}var s=[];for(e=1;e<=l;e++)for(d=1;d<=o;d++){var h=(e-1)*o+d;s.push(h)}if(arguments.length>=2){var f=arguments[1];if(s=[],D(f)=="array"){if(D(f[0])=="array"&&!T.isDyadicArr(f))return m.error.v;s=T.getDataDyadicArr(f)}else if(D(f)=="object"&&f.startCell!=null)s=T.getCellDataDyadicArr(f,"text");else{if(!M(f))return m.error.v;(b=[]).push(parseFloat(f)),s.push(b)}for(e=0;e<s.length;e++)for(d=0;d<s[0].length;d++){if(!M(s[e][d]))return m.error.v;s[e][d]=parseFloat(s[e][d])}}var p=s.length,g=s[0].length,v=s;if(arguments.length>=3){var y=arguments[2];if(v=[],D(y)=="array"){if(D(y[0])=="array"&&!T.isDyadicArr(y))return m.error.v;v=T.getDataDyadicArr(y)}else if(D(y)=="object"&&y.startCell!=null)v=T.getCellDataDyadicArr(y,"text");else{if(!M(y))return m.error.v;var b;(b=[]).push(parseFloat(y)),v.push(b)}for(e=0;e<v.length;e++)for(d=0;d<v[0].length;d++){if(!M(v[e][d]))return m.error.v;v[e][d]=parseFloat(v[e][d])}}var k=!0;if(arguments.length==4&&j(k=T.getCellBoolen(arguments[3])))return k;if(l!=p||o!=g)return m.error.r;var w=R(s,a),_=w[0];if(k)var C=w[1];else C=0;var A=[];for(e=0;e<v.length;e++)for(d=0;d<v[e].length;d++){var I=v[e][d],S=_*I+C;A.push(Math.round(1e9*S)/1e9)}return A}catch(R){var E=R;return E=m.errorInfo(E),[m.error.v,E]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=a.concat(T.getDataArr(t,!0))}else if(D(t)=="object"&&t.startCell!=null)a=a.concat(T.getCellDataArr(t,"number",!0));else{if(!M(t))return m.error.v;a.push(t)}var l=[];for(e=0;e<a.length;e++)M(a[e])&&l.push(parseFloat(a[e]));var o=arguments[1],d=[];if(D(o)=="array"){if(D(o[0])=="array"&&!T.isDyadicArr(o))return m.error.v;d=d.concat(T.getDataArr(o,!0))}else if(D(o)=="object"&&o.startCell!=null)d=d.concat(T.getCellDataArr(o,"number",!0));else{if(!M(o))return m.error.v;d.push(o)}var s=[];for(e=0;e<d.length;e++)M(d[e])&&s.push(parseFloat(d[e]));if(l.length==0&&s.length==0)return[[0],[0]];if(l.length==0){var h=[[0]];for(e=0;e<s.length;e++)h.push([0]);return h}if(s.length==0)return[[0],[l.length]];for(s.sort(function(b,k){return b-k}),h=[],e=0;e<s.length;e++)if(e==0){for(var f=0,p=0;p<l.length;p++)l[p]<=s[0]&&f++;h.push([f])}else if(e==s.length-1){var g=0,v=0;for(p=0;p<l.length;p++)l[p]<=s[e]&&l[p]>s[e-1]&&g++,l[p]>s[e]&&v++;h.push([g]),h.push([v])}else{for(f=0,p=0;p<l.length;p++)l[p]<=s[e]&&l[p]>s[e-1]&&f++;h.push([f])}return h}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let R=function(F,N){for(var z=0,P=0,q=0,V=0,x=0;x<F.length;x++)for(var ee=0;ee<F[x].length;ee++)z+=F[x][ee],P+=Math.log(N[x][ee]),q+=F[x][ee]*Math.log(N[x][ee]),V+=F[x][ee]*F[x][ee];var ne=F.length*F[0].length,ae=z/ne,de=P/ne,ve=(q/ne-ae*de)/(V/ne-ae*ae),U=de-ve*ae;return[Math.exp(ve),Math.exp(U)]};var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else if(D(t)=="object"&&t.startCell!=null)a=T.getCellDataDyadicArr(t,"text");else{if(!M(t))return m.error.v;(b=[]).push(parseFloat(t)),a.push(b)}var l=a.length,o=a[0].length;for(e=0;e<l;e++)for(var d=0;d<o;d++){if(!M(a[e][d]))return m.error.v;a[e][d]=parseFloat(a[e][d])}var s=[];for(e=1;e<=l;e++)for(d=1;d<=o;d++){var h=(e-1)*o+d;s.push(h)}if(arguments.length>=2){var f=arguments[1];if(s=[],D(f)=="array"){if(D(f[0])=="array"&&!T.isDyadicArr(f))return m.error.v;s=T.getDataDyadicArr(f)}else if(D(f)=="object"&&f.startCell!=null)s=T.getCellDataDyadicArr(f,"text");else{if(!M(f))return m.error.v;(b=[]).push(parseFloat(f)),s.push(b)}for(e=0;e<s.length;e++)for(d=0;d<s[0].length;d++){if(!M(s[e][d]))return m.error.v;s[e][d]=parseFloat(s[e][d])}}var p=s.length,g=s[0].length,v=s;if(arguments.length>=3){var y=arguments[2];if(v=[],D(y)=="array"){if(D(y[0])=="array"&&!T.isDyadicArr(y))return m.error.v;v=T.getDataDyadicArr(y)}else if(D(y)=="object"&&y.startCell!=null)v=T.getCellDataDyadicArr(y,"text");else{if(!M(y))return m.error.v;var b;(b=[]).push(parseFloat(y)),v.push(b)}for(e=0;e<v.length;e++)for(d=0;d<v[0].length;d++){if(!M(v[e][d]))return m.error.v;v[e][d]=parseFloat(v[e][d])}}var k=!0;if(arguments.length==4&&j(k=T.getCellBoolen(arguments[3])))return k;if(l!=p||o!=g)return m.error.r;var w=R(s,a),_=w[0];if(k)var C=w[1];else C=1;var A=[];for(e=0;e<v.length;e++)for(d=0;d<v[e].length;d++){var I=v[e][d],S=C*Math.pow(_,I);A.push(Math.round(1e9*S)/1e9)}return A}catch(R){var E=R;return E=m.errorInfo(E),[m.error.v,E]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return m.error.v}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return m.error.v}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{let s=function(h,f){var p,g=new Array;if(f==1)return p=h[0][0];if(f==2)return p=h[0][0]*h[1][1]-h[0][1]*h[1][0];if(f==3)return p=h[0][0]*h[1][1]*h[2][2]+h[1][0]*h[2][1]*h[0][2]+h[2][0]*h[0][1]*h[1][2]-h[2][0]*h[1][1]*h[0][2]-h[0][0]*h[2][1]*h[1][2]-h[1][0]*h[0][1]*h[2][2];p=0;for(var v=new Array,y=new Array,b=0;b<f;b++)g[b]=h[b][0]*Math.pow(-1,b+1+1);for(b=0;b<f;b++){y[b]=new Array;for(var k=0;k<f-1;k++)y[b][k]=h[b][k+1]}for(b=0;b<f;b++){for(k=0;k<f;k++){v[k]=new Array;for(var w=0;w<f-1;w++)b>k?v[k][w]=y[k][w]:b<k&&(v[k-1][w]=y[k][w])}p+=g[b]*arguments.callee(v,f-1)}return p};var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else if(D(t)=="object"&&t.startCell!=null)a=T.getCellDataDyadicArr(t,"text");else{var l=[];l.push(t),a.push(l)}for(e=0;e<a.length;e++)for(var o=0;o<a[e].length;o++){if(!M(a[e][o]))return m.error.v;a[e][o]=parseFloat(a[e][o])}return a.length!=a[0].length?m.error.v:s(a,a.length)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else if(D(t)=="object"&&t.startCell!=null)a=T.getCellDataDyadicArr(t,"text");else{var l=[];l.push(t),a.push(l)}for(e=0;e<a.length;e++)for(var o=0;o<a[e].length;o++){if(!M(a[e][o]))return m.error.v;a[e][o]=parseFloat(a[e][o])}return a.length!=a[0].length?m.error.v:mg(a)}catch(s){var d=s;return d=m.errorInfo(d),[m.error.v,d]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++)if(!(y=m.errorParamCheck(this.p,arguments[e],e))[0])return m.error.v;try{var n=arguments[0],t=[];if(D(n)=="array"){if(D(n[0])=="array"&&!T.isDyadicArr(n))return m.error.v;t=T.getDataDyadicArr(n)}else D(n)=="object"&&n.startCell!=null?t=T.getCellDataDyadicArr(n,"text"):((p=[]).push(n),t.push(p));for(e=0;e<t.length;e++)for(var a=0;a<t[e].length;a++){if(!M(t[e][a]))return m.error.v;t[e][a]=parseFloat(t[e][a])}var l=arguments[1],o=[];if(D(l)=="array"){if(D(l[0])=="array"&&!T.isDyadicArr(l))return m.error.v;o=T.getDataDyadicArr(l)}else D(l)=="object"&&l.startCell!=null?o=T.getCellDataDyadicArr(l,"text"):((p=[]).push(l),o.push(p));for(e=0;e<o.length;e++)for(a=0;a<o[e].length;a++){if(!M(o[e][a]))return m.error.v;o[e][a]=parseFloat(o[e][a])}if(t[0].length!=o.length)return m.error.v;for(var d=t.length,s=o[0].length,h=[],f=0;f<d;f++){for(var p=[],g=0;g<s;g++){for(var v=0,y=0;y<t[0].length;y++)v+=t[f][y]*o[y][g];p.push(v)}h.push(p)}return h}catch(k){var b=k;return b=m.errorInfo(b),[m.error.v,b]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else D(t)=="object"&&t.startCell!=null?a=T.getCellDataDyadicArr(t,"text"):((f=[]).push(t),a.push(f));for(e=0;e<a.length;e++)for(var l=0;l<a[e].length;l++)M(a[e][l])?a[e][l]=parseFloat(a[e][l]):a[e][l]=0;var o=a.length,d=a[0].length;if(arguments.length>=2)for(e=1;e<arguments.length;e++){var s=arguments[e],h=[];if(D(s)=="array"){if(D(s[0])=="array"&&!T.isDyadicArr(s))return m.error.v;h=T.getDataDyadicArr(s)}else if(D(s)=="object"&&s.startCell!=null)h=T.getCellDataDyadicArr(s,"text");else{var f;(f=[]).push(s),h.push(f)}if(h.length!=o||h[0].length!=d)return m.error.v;for(var p=0;p<o;p++)for(var g=0;g<d;g++)M(h[p][g])?a[p][g]=a[p][g]*parseFloat(h[p][g]):a[p][g]=0}var v=0;for(p=0;p<o;p++)for(g=0;g<d;g++)v+=a[p][g];return v}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];return D(a)=="object"&&a.startCell!=null?a.data!=null&&(t=D(a.data)=="array"?a.data[0][0]:a.data)!=null&&t.f!=null:m.error.v}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(a.data==null||D(a.data)=="array"||$t(t=a.data.v))return m.error.v}else t=a;var l,o=arguments[1];if(D(o)!="object"||o.startCell==null||(l=o.startCell,["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(t)==-1))return m.error.v;var d,s=an()[je(u.currentSheetIndex)],h=m.getcellrange(l),f=h.row[0],p=h.column[0],g=an(),v=je(u.calculateSheetIndex),y=g[v].data;switch(m.execFunctionGlobalData!=null&&m.execFunctionGlobalData[f+"_"+p+"_"+u.calculateSheetIndex]!=null?d=m.execFunctionGlobalData[f+"_"+p+"_"+u.calculateSheetIndex].v:y[f][p]!=null&&y[f][p].v!=null&&y[f][p].v!=""?(d=y[f][p])instanceof Object&&(d=d.v):d=0,t){case"address":return l;case"col":return p+1;case"color":return 0;case"contents":return d;case"filename":return s.name;case"format":return y[f][p]==null||y[f][p].ct==null?"G":y[f][p].ct.fa;case"parentheses":return y[f][p]==null||y[f][p].v==null||y[f][p].v==""?0:y[f][p].v>0?1:0;case"prefix":return d==0?"":y[f][p].ht==0?"^":y[f][p].ht==1?"'":y[f][p].ht==2?'"':"";case"protect":return 0;case"row":return f+1;case"type":return d==0?"b":"l";case"width":var b=s.config;return b.columnlen!=null&&p in b.columnlen?b.columnlen[p]:u.defaultcollen}}catch(w){var k=w;return k=m.errorInfo(k),[m.error.v,k]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return m.error.na}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(a.data==null)return m.error.na;if(D(a.data)=="array"){if((t=a.data[0][0])==null||$t(t.v))return m.error.na;t=t.v}else{if($t(a.data.v))return m.error.na;t=a.data.v}}else t=a;var l={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return t in l?l[t]:m.error.na}catch(d){var o=d;return o=m.errorInfo(o),[m.error.v,o]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0];return D(t)=="object"&&t.startCell!=null&&t.data==null}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array")return!0;if(a.data==null||$t(a.data.v))return!1;t=a.data.v}else t=a;return["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)>-1}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array")return!0;if(a.data==null||$t(a.data.v))return!1;t=a.data.v}else t=a;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)>-1}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array"||a.data==null||$t(a.data.v))return!1;t=a.data.v}else t=a;return t.toString().toLowerCase()=="true"||t.toString().toLowerCase()=="false"}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array"||a.data==null||$t(a.data.v))return!1;t=a.data.v}else t=a;return t.toString()=="#N/A"}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array"||a.data==null||$t(a.data.v))return!0;t=a.data.v}else t=a;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)>-1||t.toString().toLowerCase()=="true"||t.toString().toLowerCase()=="false"||!!M(t)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array"||a.data==null||$t(a.data.v))return!1;t=a.data.v}else t=a;return!!M(t)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{return D(arguments[0])=="object"&&arguments[0].startCell!=null}catch(a){var t=a;return t=m.errorInfo(t),[m.error.v,t]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array"||a.data==null||$t(a.data.v))return!1;t=a.data.v}else t=a;return!(["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)>-1)&&t.toString().toLowerCase()!="true"&&t.toString().toLowerCase()!="false"&&!M(t)}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")return 64;if(D(a)=="object"&&a.startCell!=null){if(D(a.data)=="array")return 16;if(a.data==null||$t(a.data.v))return 1;t=a.data.v}else t=a;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)>-1?16:t.toString().toLowerCase()=="true"||t.toString().toLowerCase()=="false"?4:M(t)?1:2}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t,a=arguments[0];if(D(a)=="array")if(D(a[0])=="array"){if(!T.isDyadicArr(a))return m.error.v;t=a[0][0]}else t=a[0];else if(D(a)=="object"&&a.startCell!=null)if(D(a.data)=="array"){if((t=a.data[0][0])==null||$t(t.v))return 0;t=t.v}else{if(a.data==null||$t(a.data.v))return 0;t=a.data.v}else t=a;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)>-1?t:t.toString().toLowerCase()=="true"||t.toString().toLowerCase()=="false"?t.toString().toLowerCase()=="true"?1:0:M(t)?parseFloat(t):0}catch(o){var l=o;return l=m.errorInfo(l),[m.error.v,l]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?za("yyyy-mm-dd",t=parseFloat(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:Q(t).isValid()?_a(t)[2]:cn(t).value()==null?t:cn(t).value()}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0],"text");return j(t)?t:za("@",t)}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?za("$ 0.00",t=parseFloat(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);return j(t)?t:M(t)?za("0%",t=parseFloat(t)):m.error.v}catch(l){var a=l;return a=m.errorInfo(a),[m.error.v,a]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);return s.length===0?m.error.v:s.length>1?m.error.nm:h[s[0]]}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=h[s[0]];for(e=1;e<s.length;e++)p<h[s[e]]&&(p=h[s[e]]);return p}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=findResultIndex(a,d),h=[];if(D(l)==="string"){var f=findField(a,l);h=rest(a[f])}else h=rest(a[l]);var p=h[s[0]];for(e=1;e<s.length;e++)p>h[s[e]]&&(p=h[s[e]]);return p}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=0;for(e=0;e<s.length;e++)p+=h[s[e]];return s.length===0?m.error.d:p/s.length}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];p=T.compact(p);var g=1;for(e=0;e<p.length;e++)g*=p[e];return g}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];return p=T.compact(p),window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];return p=T.compact(p),window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];p=T.compact(p);var g=0;for(e=0;e<p.length;e++)g+=p[e];return g}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];return p=T.compact(p),window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)!="object"||t.startCell==null||t.data==null)return m.error.v;a=T.getCellDataDyadicArr(t,"text");var l=T.getFirstValue(arguments[1],"text");if(j(l))return l;if($t(l))return m.error.v;var o=arguments[2],d=[];if(D(o)!="object"||o.startCell==null||o.data==null||(d=T.getCellDataDyadicArr(o,"text"),!M(l)&&D(l)!=="string"))return m.error.v;var s=T.findResultIndex(a,d),h=[];if(D(l)==="string"){var f=T.findField(a,l);h=T.rest(a[f])}else h=T.rest(a[l]);var p=[];for(e=0;e<s.length;e++)p[e]=h[s[e]];return p=T.compact(p),window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,p)}catch(v){var g=v;return g=m.errorInfo(g),[m.error.v,g]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=arguments[1],s=arguments[2],h=arguments[3],f=arguments[4],p=arguments[5],g=arguments[6],v=arguments[7],y=an(),b=je(u.calculateSheetIndex),k=y[b].data,w=m.readCellDataToOneArray(o),_=dr.getCellRealSize(k,t,a),C=_[0],A=_[1],I={};s==null&&(s=1),I.lineWidth=s,I.offsetY=s+1,I.height=A-(s+1),I.width=C;var S=function(N,z){z&&(typeof z=="number"&&(z>19&&(z%=20),z=l[z]),I[N]=z)};if(d==null&&(d="#2ec7c9"),S("lineColor",d),I.fillColor=0,h)if(typeof h=="string"){h=h.toLowerCase();var E=null;h=="min"?E=window.luckysheet_function.MIN.f({data:w}):h=="max"?E=window.luckysheet_function.MAX.f({data:w}):h=="avg"||h=="mean"?E=window.luckysheet_function.AVERAGE.f({data:w}):h=="median"&&(E=window.luckysheet_function.MEDIAN.f({data:w})),E&&(I.normalRangeMin=E,I.normalRangeMax=E)}else I.normalRangeMin=h,I.normalRangeMax=h;f==null&&(f="#000"),S("normalRangeColor",f),S("maxSpotColor",p),S("minSpotColor",g),v==null&&(v="1.5"),I.spotRadius=v;var R=Hn.init(w,I);return R}catch(N){var F=N;return F=m.errorInfo(F),[m.error.v,F]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=arguments[1],s=arguments[2],h=arguments[3],f=arguments[4],p=arguments[5],g=m.readCellDataToOneArray(o),v=an(),y=je(u.calculateSheetIndex),b=v[y].data,k=dr.getCellRealSize(b,t,a),w=k[0],_=k[1],C={};h==null&&(h=1),C.lineWidth=h,C.offsetY=h+1,C.height=_-(h+1),C.width=w;var A=function(R,F){F&&(typeof F=="number"&&(F>19&&(F%=20),F=l[F]),C[R]=F)};if(d==null&&(d="#2ec7c9"),A("lineColor",d),A("fillColor",s),h==null&&(h="1"),C.lineWidth=h,f)if(typeof f=="string"){f=f.toLowerCase();var I=null;f=="min"?I=window.luckysheet_function.MIN.f({data:g}):f=="max"?I=window.luckysheet_function.MAX.f({data:g}):f=="avg"||f=="mean"?I=window.luckysheet_function.AVERAGE.f({data:g}):f=="median"&&(I=window.luckysheet_function.MEDIAN.f({data:g})),I&&(C.normalRangeMin=I,C.normalRangeMax=I)}else C.normalRangeMin=f,C.normalRangeMax=f;p==null&&(p="#000"),A("normalRangeColor",p);var S=Hn.init(g,C);return S}catch(R){var E=R;return E=m.errorInfo(E),[m.error.v,E]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=m.readCellDataToOneArray(o),s=an(),h=je(u.calculateSheetIndex),f=s[h].data,p=dr.getCellRealSize(f,t,a),g=p[0],v=p[1],y={};y.height=v,y.width=g;var b=function(E,R){R&&(typeof R=="number"&&(R>19&&(R%=20),R=l[R]),y[E]=R)},k=arguments[1],w=arguments[2],_=arguments[3],C=arguments[4];y.type="column",k==null&&(k="1"),y.barSpacing=k,w==null&&(w="#fc5c5c"),b("barColor",w),_==null&&(_="#97b552"),b("negBarColor",_),y.chartRangeMax=C==null||C===!1||typeof C!="number"?void 0:C;var A=m.sparklinesColorMap(arguments);A&&(y.colorMap=A);var I=Hn.init(d,y);return I}catch(E){var S=E;return S=m.errorInfo(S),[m.error.v,S]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList,arguments[0]),o=[],d=[];if(l!=null&&l.data!=null&&(d=l.data),D(d)=="array")d=m.getPureValueByData(d);else{if(D(d)=="object")return[d=d.v];/\{.*?\}/.test(d)&&(d=d.replace(/\{/g,"[").replace(/\}/g,"]")),d=new Function("return "+d)()}var s=arguments[1];if(d.length,s==null||s)for(var h=0;h<d[0].length;h++){for(var f="",p=0;p<d.length;p++)f+=d[p][h]+":";f=f.substr(0,f.length-1),o.push(f)}else{for(p=0;p<d.length;p++){var g="";for(h=0;h<d[0].length;h++)g+=d[p][h]+":";g=g.substr(0,g.length-1),o.push(g)}d[0].length}var v=an(),y=je(u.calculateSheetIndex),b=v[y].data,k=dr.getCellRealSize(b,t,a),w=k[0],_=k[1],C={};C.height=_,C.width=w;var A=arguments[2],I=arguments[3];C.type="column",A==null&&(A="1"),C.barSpacing=A,C.chartRangeMax=I==null||I===!1||typeof I!="number"?void 0:I;var S=m.sparklinesColorMap(arguments,4);S&&(C.colorMap=S);var E=Hn.init(o,C);return E}catch(F){var R=F;return R=m.errorInfo(R),[m.error.v,R]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=m.readCellDataToOneArray(o),s=an(),h=je(u.calculateSheetIndex),f=s[h].data,p=dr.getCellRealSize(f,t,a),g=p[0],v=p[1],y={};y.height=v,y.width=g;var b=function(E,R){R&&(typeof R=="number"&&(R>19&&(R%=20),R=l[R]),y[E]=R)},k=arguments[1],w=arguments[2],_=arguments[3],C=arguments[4];y.type="bar",k==null&&(k="1"),y.barSpacing=k,w==null&&(w="#fc5c5c"),b("barColor",w),_==null&&(_="#97b552"),b("negBarColor",_),y.chartRangeMax=C==null||C===!1||typeof C!="number"?void 0:C;var A=m.sparklinesColorMap(arguments);A&&(y.colorMap=A);var I=Hn.init(d,y);return I}catch(E){var S=E;return S=m.errorInfo(S),[m.error.v,S]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList,arguments[0]),o=[],d=[];if(l!=null&&l.data!=null&&(d=l.data),D(d)=="array")d=m.getPureValueByData(d);else{if(D(d)=="object")return[d=d.v];/\{.*?\}/.test(d)&&(d=d.replace(/\{/g,"[").replace(/\}/g,"]")),d=new Function("return "+d)()}var s=arguments[1];if(d.length,s==null||s)for(var h=0;h<d[0].length;h++){for(var f="",p=0;p<d.length;p++)f+=d[p][h]+":";f=f.substr(0,f.length-1),o.push(f)}else{for(p=0;p<d.length;p++){var g="";for(h=0;h<d[0].length;h++)g+=d[p][h]+":";g=g.substr(0,g.length-1),o.push(g)}d[0].length}var v=an(),y=je(u.calculateSheetIndex),b=v[y].data,k=dr.getCellRealSize(b,t,a),w=k[0],_=k[1],C={};C.height=_,C.width=w;var A=arguments[2],I=arguments[3];C.type="bar",A==null&&(A="1"),C.barSpacing=A,C.chartRangeMax=I==null||I===!1||typeof I!="number"?void 0:I;var S=m.sparklinesColorMap(arguments,4);S&&(C.colorMap=S);var E=Hn.init(o,C);return E}catch(F){var R=F;return R=m.errorInfo(R),[m.error.v,R]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=m.readCellDataToOneArray(o),s=an(),h=je(u.calculateSheetIndex),f=s[h].data,p=dr.getCellRealSize(f,t,a),g=p[0],v=p[1],y={};y.height=v,y.width=g;var b=function(I,S){S&&(typeof S=="number"&&(S>19&&(S%=20),S=l[S]),y[I]=S)},k=arguments[1],w=arguments[2],_=arguments[3];y.type="discrete",k==null&&(k=0),y.thresholdValue=k,w==null&&(w="#2ec7c9"),b("lineColor",w),_==null&&(_="#fc5c5c"),b("thresholdColor",_);var C=Hn.init(d,y);return C}catch(I){var A=I;return A=m.errorInfo(A),[m.error.v,A]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=m.readCellDataToOneArray(o),s=an(),h=je(u.calculateSheetIndex),f=s[h].data,p=dr.getCellRealSize(f,t,a),g=p[0],v=p[1],y={};y.height=v,y.width=g;var b=function(E,R){R&&(typeof R=="number"&&(R>19&&(R%=20),R=l[R]),y[E]=R)},k=arguments[1],w=arguments[2],_=arguments[3],C=arguments[4];y.type="tristate",k==null&&(k="1"),y.barSpacing=k,w==null&&(w="#fc5c5c"),b("barColor",w),_==null&&(_="#97b552"),b("negBarColor",_),C==null&&(C="#999"),b("zeroBarColor",C);var A=m.sparklinesColorMap(arguments);A&&(y.colorMap=A);var I=Hn.init(d,y);return I}catch(E){var S=E;return S=m.errorInfo(S),[m.error.v,S]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=m.readCellDataToOneArray(o),s=an(),h=je(u.calculateSheetIndex),f=s[h].data,p=dr.getCellRealSize(f,t,a),g=p[0],v=p[1],y={};y.height=v,y.width=g;var b=function(S,E){E&&(typeof E=="number"&&(E>19&&(E%=20),E=l[E]),y[S]=E)},k=arguments[1],w=arguments[2],_=arguments[3];y.type="pie",k==null&&(k=0),y.offset=k,w==null&&(w=0),b("borderWidth",w),_==null&&(_="#97b552"),b("borderColor",_);var C=m.sparklinesColorMap(arguments,4);C&&(y.colorMap=C);var A=Hn.init(d,y);return A}catch(S){var I=S;return I=m.errorInfo(I),[m.error.v,I]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList),o=arguments[0],d=m.readCellDataToOneArray(o),s=an(),h=je(u.calculateSheetIndex),f=s[h].data,p=dr.getCellRealSize(f,t,a),g=p[0],v=p[1],y={};y.height=v,y.width=g;var b=function(I,S){S&&(typeof S=="number"&&(S>19&&(S%=20),S=l[S]),y[I]=S)},k=arguments[1],w=arguments[2],_=arguments[3];y.type="box",k==null&&(k=1.5),y.outlierIQR=k,w==null?w=0:b("target",w),_==null&&(_=1.5),b("spotRadius",_);var C=Hn.init(d,y);return C}catch(I){var A=I;return A=m.errorInfo(A),[m.error.v,A]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=(window.luckysheetCurrentFunction,m.colorList,an()),o=je(u.calculateSheetIndex),d=l[o].data,s=dr.getCellRealSize(d,t,a),h=s[0],f=s[1],p={};p.height=f,p.width=h;var g=[];Bs(arguments);var v=m.getValueByFuncData(arguments[0]),y=m.getValueByFuncData(arguments[1]);for(g.push(v),g.push(y),e=2;e<arguments.length;e++)g.push(m.getValueByFuncData(arguments[e]));p.type="bullet";var b=Hn.init(g,p);return b}catch(w){var k=w;return k=m.errorInfo(k),[m.error.v,k]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[],l=1,o=1;if(D(t)=="array")if(D(t[0])=="array"){if(!T.isDyadicArr(t))return m.error.v;for(e=0;e<t.length;e++){for(var d=[],s=0;s<t[e].length;s++){var h=t[e][s];d.push(h)}a.push(d)}l=a.length,o=a[0].length}else{for(e=0;e<t.length;e++)h=t[e],a.push(h);l=a.length}else if(D(t)=="object"&&t.startCell!=null)if(t.data!=null)if(D(t.data)=="array"){for(e=0;e<t.data.length;e++){for(d=[],s=0;s<t.data[e].length;s++)t.data[e][s]!=null?($t(h=t.data[e][s].v)&&(h=0),d.push(h)):d.push(0);a.push(d)}l=a.length,o=a[0].length}else $t(h=t.data.v)&&(h=0),a.push(h);else a.push(0);else h=t,a.push(h);var f=1;if(arguments.length>=2){if(j(f=T.getFirstValue(arguments[1])))return f;if(!M(f))return m.error.v;f=parseInt(f)}var p=1;if(arguments.length>=3){if(j(p=T.getFirstValue(arguments[2])))return p;if(!M(p))return m.error.v;p=Math.floor(parseFloat(p))}var g=!1;if(arguments.length==4&&j(g=T.getCellBoolen(arguments[3])))return g;if(g){if(f<1||f>l)return m.error.v}else if(f<1||f>o)return m.error.v;if(p!=1&&p!=-1)return m.error.v;var v=function(k,w){return D(k)=="array"&&(k=k[f-1]),D(w)=="array"&&(w=w[f-1]),isNaN(k)||isNaN(w)?isNaN(k)?isNaN(w)?k>w?1:k<w?-1:void 0:1:-1:k-w},y=function(k,w){return D(k)=="array"&&(k=k[f-1]),D(w)=="array"&&(w=w[f-1]),isNaN(k)||isNaN(w)?isNaN(k)?isNaN(w)?k>w?-1:k<w?1:void 0:-1:1:w-k};return g?(a=a[0].map(function(k,w){return a.map(function(_){return _[w]})}),p==1&&a.sort(v),p==-1&&a.sort(y),a=a[0].map(function(k,w){return a.map(function(_){return _[w]})})):(p==1&&a.sort(v),p==-1&&a.sort(y)),a}catch(k){var b=k;return b=m.errorInfo(b),[m.error.v,b]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else D(t)=="object"&&t.startCell!=null?a=T.getCellDataDyadicArr(t,"number"):((p=[]).push(parseFloat(t)),a.push(p));a.length,a[0].length;var l=arguments[1],o=[],d="row";if(D(l)=="array")if(D(l[0])=="array"){if(!T.isDyadicArr(l)||l.length>1&&l[0].length>1)return m.error.v;if(l.length>1){if(l.length!=a.length)return m.error.v;for(d="row",e=0;e<l.length;e++){if(D(s=l[e][0])!="boolean")if(D(s)!="string"||s.toLowerCase()!="true"&&s.toLowerCase()!="false"){if(!M(s))return m.error.v;s=(s=parseFloat(s))!=0}else s.toLowerCase()=="true"?s=!0:s.toLowerCase()=="false"&&(s=!1);o.push(s)}}if(l[0].length>1){if(l[0].length!=a[0].length)return m.error.v;for(d="col",e=0;e<l[0].length;e++){if(D(s=l[0][e])!="boolean")if(D(s)!="string"||s.toLowerCase()!="true"&&s.toLowerCase()!="false"){if(!M(s))return m.error.v;s=(s=parseFloat(s))!=0}else s.toLowerCase()=="true"?s=!0:s.toLowerCase()=="false"&&(s=!1);o.push(s)}}}else{if(l.length!=a[0].length)return m.error.v;for(d="col",e=0;e<l.length;e++){if(D(s=l[e])!="boolean")if(D(s)!="string"||s.toLowerCase()!="true"&&s.toLowerCase()!="false"){if(!M(s))return m.error.v;s=(s=parseFloat(s))!=0}else s.toLowerCase()=="true"?s=!0:s.toLowerCase()=="false"&&(s=!1);o.push(s)}}else{if(D(l)!="object"||l.data==null||D(l.data)!="array"||l.data.length>1&&l.data[0].length>1)return m.error.v;if(l.data.length>1){if(l.data.length!=a.length)return m.error.v;for(d="row",e=0;e<l.data.length;e++){if($t(s=l.data[e][0].v)&&(s=0),D(s)!="boolean")if(D(s)!="string"||s.toLowerCase()!="true"&&s.toLowerCase()!="false"){if(!M(s))return m.error.v;s=(s=parseFloat(s))!=0}else s.toLowerCase()=="true"?s=!0:s.toLowerCase()=="false"&&(s=!1);o.push(s)}}if(l.data[0].length>1){if(l.data[0].length!=a[0].length)return m.error.v;for(d="col",e=0;e<l.data[0].length;e++){var s;if($t(s=l.data[0][e].v)&&(s=0),D(s)!="boolean")if(D(s)!="string"||s.toLowerCase()!="true"&&s.toLowerCase()!="false"){if(!M(s))return m.error.v;s=(s=parseFloat(s))!=0}else s.toLowerCase()=="true"?s=!0:s.toLowerCase()=="false"&&(s=!1);o.push(s)}}}var h="";if(arguments.length==3&&j(h=T.getFirstValue(arguments[2],"text")))return h;var f=[];if(d=="row")for(e=0;e<a.length;e++)o[e]&&f.push(a[e]);else for(e=0;e<a.length;e++){for(var p=[],g=0;g<a[0].length;g++)o[g]&&p.push(a[e][g]);p.length>0&&f.push(p)}return f.length==0?h:f}catch(y){var v=y;return v=m.errorInfo(v),[m.error.v,v]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=arguments[0],a=[];if(D(t)=="array"){if(D(t[0])=="array"&&!T.isDyadicArr(t))return m.error.v;a=T.getDataDyadicArr(t)}else if(D(t)=="object"&&t.startCell!=null)a=T.getCellDataDyadicArr(t,"number");else{var l=[];l.push(parseFloat(t)),a.push(l)}var o=!1;if(arguments.length>=2&&j(o=T.getCellBoolen(arguments[1])))return o;var d=!1;if(arguments.length==3&&j(d=T.getCellBoolen(arguments[2])))return d;if(o){a=a[0].map(function(b,k){return a.map(function(w){return w[k]})});var s={},h=[],f=[];for(e=0;e<a.length;e++){for(var p="",g=0;g<a[e].length;g++)p+=a[e][g].toString()+"|||";h.push(p),p in s||(s[p]=0,f.push(a[e]))}if(d){var v=[];for(e=0;e<h.length;e++)h.indexOf(h[e])==h.lastIndexOf(h[e])&&v.push(a[e]);return v=v[0].map(function(b,k){return v.map(function(w){return w[k]})})}return f=f[0].map(function(b,k){return f.map(function(w){return w[k]})})}for(s={},h=[],f=[],e=0;e<a.length;e++){for(p="",g=0;g<a[e].length;g++)p+=a[e][g].toString()+"|||";h.push(p),p in s||(s[p]=0,f.push(a[e]))}if(d){for(v=[],e=0;e<h.length;e++)h.indexOf(h[e])==h.lastIndexOf(h[e])&&v.push(a[e]);return v}return f}catch(b){var y=b;return y=m.errorInfo(y),[m.error.v,y]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=1;if(arguments.length>=1){if(j(t=T.getFirstValue(arguments[0])))return t;if(!M(t))return m.error.v;t=parseInt(t)}var a=1;if(arguments.length==2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}if(t<=0||a<=0)return m.error.v;var l=[];for(e=0;e<t;e++){for(var o=[],d=0;d<a;d++)o.push(Math.random().toFixed(9));l.push(o)}return l}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=T.getFirstValue(arguments[0]);if(j(t))return t;if(!M(t))return m.error.v;t=parseInt(t);var a=1;if(arguments.length>=2){if(j(a=T.getFirstValue(arguments[1])))return a;if(!M(a))return m.error.v;a=parseInt(a)}var l=1;if(arguments.length>=3){if(j(l=T.getFirstValue(arguments[2])))return l;if(!M(l))return m.error.v;l=parseFloat(l)}var o=1;if(arguments.length==4){if(j(o=T.getFirstValue(arguments[3])))return o;if(!M(o))return m.error.v;o=parseFloat(o)}if(t<=0||a<=0)return m.error.v;var d=[];for(e=0;e<t;e++){for(var s=[],h=0;h<a;h++){var f=l+o*(h+a*e);s.push(f)}d.push(s)}return d}catch(g){var p=g;return p=m.errorInfo(p),[m.error.v,p]}},EVALUATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return m.error.na;for(var e=0;e<arguments.length;e++){var n=m.errorParamCheck(this.p,arguments[e],e);if(!n[0])return m.error.v}try{var t=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,l=window.luckysheetCurrentIndex,o=T.getFirstValue(arguments[0]).toString();if(j(o))return o;o.trim().indexOf("=")!=0&&(o="="+o);var d=m.execstringformula(o,t,a,l);return d[1]}catch(h){var s=h;return s=m.errorInfo(s),[m.error.v,s]}}};function jx(e){var n=e.parent().find("luckysheet-print-viewBtn-active").attr("type");if(e.attr("type")!=n){var t=e.attr("type");t!=null&&(function(a,l){var o=ir.getSheetByIndex();o.config==null&&(o.config={}),o.config.sheetViewZoom==null&&(o.config.sheetViewZoom={});var d=1,s="zoomScaleNormal";a=="viewNormal"?s="viewNormalZoomScale":a=="viewLayout"?s="viewLayoutZoomScale":a=="viewPage"&&(s="viewPageZoomScale",d=.6);var h=o.config.sheetViewZoom[s];h==null&&(h=d),o.config.curentsheetView=a,u.clearjfundo&&u.jfredo.push({type:"viewChange",curType:a,preType:l,sheetIndex:u.currentSheetIndex}),nt.saveParam("cg",u.currentSheetIndex,a,{k:"curentsheetView"}),u.currentSheetView=a,Cu(h)}(t,n),e.parent().find(".luckysheet-print-viewBtn").removeClass("luckysheet-print-viewBtn-active"),e.addClass("luckysheet-print-viewBtn-active"))}}var Gx=Ii(Fe(function(e,n){(function(t){var a=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},l={weekdays:{shorthand:["","","","","","",""],longhand:["","","","","","",""]},months:{shorthand:["","","","","","","","","","","",""],longhand:["","","","","","","","","","","",""]},rangeSeparator:"  ",weekAbbreviation:"",scrollTitle:"",toggleTitle:" 12/24 "};a.l10ns.zh=l;var o=a.l10ns;t.Mandarin=l,t.default=o,Object.defineProperty(t,"__esModule",{value:!0})})(n)})),xl={};function wy(){var e;Lx(),function(){var n=null,t=st(),a=t.filter,l=t.button;$("#luckysheetfilter").click(Bh);var o=null,d=null;$(".luckysheet-cols-menu .luckysheet-cols-submenu").hover(function(){var s=$(this),h=s.attr("id"),f=$("#"+h+"_sub"),p=s.parent(),g=$(window).width(),v=$(window).height(),y=p.width(),b=f.height()+25,k=f.width()+5,w=s.offset(),_=w.top,C=w.left+y;C+k>g&&(C=w.left-k),_+b>v&&(_=v-b),f.css({top:_,left:C}).show(),d=s},function(){var s=$(this).attr("id"),h=$("#"+s+"_sub");o=setTimeout(function(){h.hide()},200)}),$(".luckysheet-rightgclick-menu-sub").hover(function(){d.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(o)},function(){d.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide()}),$("#luckysheet-filter-menu").mouseover(function(){clearTimeout(n),n=setTimeout(function(){$("#luckysheet-filter-submenu").hide()},500)}),$("#luckysheet-filter-submenu").mouseover(function(){clearTimeout(n)}).find(".luckysheet-cols-menuitem").click(function(s){$("#luckysheet-filter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide();var h=$(this).data("type"),f=$(this).attr("data-value");h=="2"?($("#luckysheet-filter-selected span").data("type","2"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show(),$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number")):h=="0"?$("#luckysheet-filter-selected span").data("type","0"):($("#luckysheet-filter-selected span").data("type","1"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show(),f=="dateequal"||f=="datelessthan"||f=="datemorethan"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","date"):f=="morethan"||f=="moreequalthan"||f=="lessthan"||f=="lessequalthan"||f=="equal"||f=="noequal"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number"):$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","text")),$("#luckysheet-filter-byvalue").next().slideUp(),$("#luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-bycondition, #luckysheet-filter-byvalue").click(function(){var s=$(this);s.next().slideToggle(200),setTimeout(function(){s.attr("id")=="luckysheet-filter-bycondition"&&$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-selected span").text()!=a.filiterInputNone&&$("#luckysheet-filter-byvalue").next().slideUp(200),s.is($("#luckysheet-filter-bycondition"))&&$("#luckysheet-filter-bycondition").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-filter-selected").click(function(){var s=$(this).offset(),h=$("#luckysheet-filter-submenu");h.hide();var f=$(window).height(),p=$(window).width(),g=h.width(),v=(h.height(),s.top),y=s.left,b=f-s.top-20;s.left+g>p&&(y=s.left-g),s.top>f/2&&((v=f-s.top)<0&&(v=0),b=s.top-20),h.css({top:v,left:y,height:b}).show(),clearTimeout(n)}),$("#luckysheet-cell-main").on("click",".luckysheet-filter-options",function(s){if(dn(u.currentSheetIndex,"filter")){var h=$(s.currentTarget),f=h.offset(),p=$("#luckysheet-filter-menu"),g=$(window).height(),v=($(window).width(),h.data("str")),y=h.data("edr"),b=h.data("cindex"),k=h.data("stc"),w=h.data("edc"),_=h.data("rowhidden")==""?{}:JSON.parse(h.data("rowhidden").replace(/\'/g,'"'));$("body .luckysheet-cols-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-filter-byvalue-input").val(""),$("#luckysheet-filter-bycondition").next().hide(),$("#luckysheet-filter-byvalue").next().show(),p.data("str",v),p.data("edr",y),p.data("cindex",b),p.data("stc",k),p.data("edc",w),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(a.filiterInputNone);var C=h.data("byconditiontype");if($("#luckysheet-filter-selected span").data("value",h.data("byconditionvalue")).data("type",C).text(h.data("byconditiontext")),C=="2"){var A=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show().find("input");A.eq(0).val(h.data("byconditionvalue1")),A.eq(1).val(h.data("byconditionvalue2"))}else C=="1"&&$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show().find("input").val(h.data("byconditionvalue1"));$("#luckysheet-filter-orderby-asc").off("click").on("click",function(){$p(v,k,y,w,b,!0)}),$("#luckysheet-filter-orderby-desc").off("click").on("click",function(){$p(v,k,y,w,b,!1)}),$("#luckysheet-filter-byvalue-select").empty().html('<div style="width:100%;text-align:center;position:relative;top:45%;font-size:14px;"><div class="luckysheetLoaderGif"></div><span>'+a.filiterMoreDataTip+"</span></div>");var I={};return $("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").not(this).each(function(){var S=$(this).data("rowhidden");if(S=="")return!0;for(var E in S=JSON.parse(S.replace(/\'/g,'"')))I[E]=0}),setTimeout(function(){for(var S={},E={},R={},F={},N=v+1;N<=y;N++)if(!(N in I)&&u.flowdata[N]!=null){var z=u.flowdata[N][b];if(z==null||$t(z.v)||z.ct==null||z.ct.t!="d"){var P=void 0,q=void 0;z==null||$t(z.v)?(P=null,q=null):(P=z.v,q=z.m),P in R||(R[P]={}),q in R[P]||(R[P][q]=0),R[P][q]++,N in _&&(F[P+"#$$$#"+q]=0)}else{var V=za("YYYY-MM-DD",z.v),x=V.split("-")[0],ee=V.split("-")[1],ne=V.split("-")[2];x in S||(S[x]={}),ee in S[x]||(S[x][ee]={}),ne in S[x][ee]||(S[x][ee][ne]=0),S[x][ee][ne]++,N in _&&(E[x]=0,E[ee]=0,E[ne]=0)}}var ae=[];if(JSON.stringify(S).length>2)for(var de in S){var ve=0,U="";for(var B in S[de]){var le=0,Te="";for(var ue in S[de][B]){var be=S[de][B][ue];le+=be;var ye=void 0;ye=Number(B)<10?"0"+Number(B):B;var ce=void 0;ce=Number(ue)<10?"0"+Number(ue):ue,Te+=de in E&&B in E&&ue in E?'<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+de+"-"+ye+"-"+ce+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+ue+'</label><span class="count luckysheet-mousedown-cancel">( '+be+" )</span></div>":'<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+de+"-"+ye+"-"+ce+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+ue+'</label><span class="count luckysheet-mousedown-cancel">( '+be+" )</span></div>"}ve+=le;var Re=void 0;Re=Number(B)<10?"0"+Number(B):B,U+=de in E&&B in E?'<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+de+"-"+Re+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+B+a.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+le+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+Te+"</div></div>":'<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+de+"-"+Re+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+B+a.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+le+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+Te+"</div></div>"}var pe=void 0;pe=de in E?'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+de+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+de+a.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+ve+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+U+"</div></div>":'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+de+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+de+a.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+ve+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+U+"</div></div>",ae.unshift(pe)}if(JSON.stringify(R).length>2){var me=Object.keys(R);me=Gp(me,!0);for(var re=0;re<me.length;re++){var _e=me[re];for(var Ze in R[_e]){var We=void 0;We=_e+"#$$$#"+Ze=="null#$$$#null"?a.valueBlank:Ze;var Xe=void 0;Xe=_e+"#$$$#"+Ze in F?'<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+_e+"#$$$#"+Ze+'" title="'+We+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+We+'</label><span class="luckysheet-mousedown-cancel count">( '+R[_e][Ze]+" )</span></div>":'<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+_e+"#$$$#"+Ze+'" title="'+We+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+We+'</label><span class="luckysheet-mousedown-cancel count">( '+R[_e][Ze]+" )</span></div>",ae.push(Xe)}}}$("#luckysheet-filter-byvalue-select").html("<div class='ListBox luckysheet-mousedown-cancel' style='min-height: 100px; max-height: "+(g-f.top-350)+"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='luckysheet-mousedown-cancel'>"+ae.join("")+"</table></div>")},1),Au(p,f.left,f.top+20),s.stopPropagation(),!1}}),$("#luckysheet-filter-orderby-color").hover(function(){for(var s=$("#luckysheet-filter-menu"),h=s.data("str"),f=s.data("edr"),p=s.data("cindex"),g=(s.data("stc"),s.data("edc"),{}),v={},y=Un.getComputeMap(),b=kr.getComputeMap(),k=h+1;k<=f;k++){var w=u.flowdata[k][p],_=dr.checkstatus(u.flowdata,k,p,"bg");_==null&&(_="#ffffff");var C=Un.checksAF(k,p,y);C!=null&&(_=C[1]);var A=kr.checksCF(k,p,b);A!=null&&A.cellColor!=null&&(_=A.cellColor),_.indexOf("rgb")>-1&&(_=Tu(_)),_.length==4&&(_=_.substr(0,1)+_.substr(1,1).repeat(2)+_.substr(2,1).repeat(2)+_.substr(3,1).repeat(2));var I=dr.checkstatus(u.flowdata,k,p,"fc");C!=null&&(I=C[0]),A!=null&&A.textColor!=null&&(I=A.textColor),I.indexOf("rgb")>-1&&(I=Tu(I)),I.length==4&&(I=I.substr(0,1)+I.substr(1,1).repeat(2)+I.substr(2,1).repeat(2)+I.substr(3,1).repeat(2)),u.config!=null&&u.config.rowhidden!=null&&k in u.config.rowhidden?(g[_]=1,w==null||$t(w.v)||(v[I]=1)):(g[_]=0,w==null||$t(w.v)||(v[I]=0))}var S="";if(JSON.stringify(g).length>2&&Object.keys(g).length>1){var E="";for(var R in g)g[R]==0?E+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+R+'" title="'+R+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':E+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+R+'" title="'+R+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';S='<div id="filterBgColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+a.filiterByColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+E+"</div></div>"}var F,N="";if(JSON.stringify(v).length>2&&Object.keys(v).length>1){var z="";for(var P in v)v[P]==0?z+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+P+'" title="'+P+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':z+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+P+'" title="'+P+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';N='<div id="filterFcColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+a.filiterByTextColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+z+"</div></div>"}F=S==""&&N==""?'<div class="luckysheet-mousedown-cancel" style="padding: 10px 30px;text-align: center;">'+a.filterContainerOneColorTip+"</div>":S+N+'<div class="luckysheet-mousedown-cancel"><button id="luckysheet-filter-orderby-color-confirm" class="btn btn-primary luckysheet-mousedown-cancel" style="margin: 5px 20px;width: 70px;">'+l.confirm+"</button></div>",$("#luckysheet-filter-orderby-color-submenu").remove(),$("body").append('<div id="luckysheet-filter-orderby-color-submenu" class="luckysheet-cols-menu luckysheet-mousedown-cancel">'+F+"</div>");var q=$("#luckysheet-filter-orderby-color-submenu").end(),V=$(this).parent(),x=$(window).width(),ee=$(window).height(),ne=V.width(),ae=q.height()+25,de=q.width()+5,ve=$(this).offset(),U=ve.top,B=ve.left+ne;B+de>x&&(B=ve.left-de),U+ae>ee&&(U=ee-ae),$("#luckysheet-filter-orderby-color-submenu").css({top:U,left:B}).show()},function(){o=setTimeout(function(){$("#luckysheet-filter-orderby-color-submenu").hide()},200)}),$(document).on("mouseover mouseleave","#luckysheet-filter-orderby-color-submenu",function(s){s.type==="mouseover"?clearTimeout(o):$(this).hide()}),$(document).on("click","#luckysheet-filter-orderby-color-submenu .item label",function(){$(this).siblings("input[type='checkbox']").click()}),$(document).off("click.orderbyColorConfirm").on("click.orderbyColorConfirm","#luckysheet-filter-orderby-color-submenu #luckysheet-filter-orderby-color-confirm",function(){var s,h,f={},p={};$("#luckysheet-filter-orderby-color-submenu .item").each(function(de,ve){if($(ve).find("input[type='checkbox']").is(":checked")){var U=$(this).find("label").attr("title"),B=$(this).closest(".box").attr("id");B=="filterBgColor"?f[U]=0:B=="filterFcColor"&&(p[U]=0)}}),s=$("#luckysheet-filter-orderby-color-submenu #filterBgColor").length>0,h=$("#luckysheet-filter-orderby-color-submenu #filterFcColor").length>0;var g=$("#luckysheet-filter-menu"),v=g.data("str"),y=g.data("edr"),b=g.data("cindex"),k=g.data("stc"),w=g.data("edc"),_={};$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").eq(b-k).get(0)).each(function(){var de=$(this).data("rowhidden");if(de=="")return!0;for(var ve in de=JSON.parse(de))_[ve]=0});for(var C={},A={},I=Un.getComputeMap(),S=kr.getComputeMap(),E=v+1;E<=y;E++)if(!(E in _)&&u.flowdata[E]!=null){var R=u.flowdata[E][b],F=dr.checkstatus(u.flowdata,E,b,"bg"),N=Un.checksAF(E,b,I);N!=null&&(F=N[1]);var z=kr.checksCF(E,b,S);z!=null&&z.cellColor!=null&&(F=z.cellColor),(F=F??"#ffffff").indexOf("rgb")>-1&&(F=Tu(F)),F.length==4&&(F=F.substr(0,1)+F.substr(1,1).repeat(2)+F.substr(2,1).repeat(2)+F.substr(3,1).repeat(2));var P=dr.checkstatus(u.flowdata,E,b,"fc");N!=null&&(P=N[0]),z!=null&&z.textColor!=null&&(P=z.textColor),P.indexOf("rgb")>-1&&(P=Tu(P)),P.length==4&&(P=P.substr(0,1)+P.substr(1,1).repeat(2)+P.substr(2,1).repeat(2)+P.substr(3,1).repeat(2)),s&&h?F in f||P in p&&R!=null&&!$t(R.v)||(C[E]=0):s?F in f||(C[E]=0):h&&(P in p&&R!=null&&!$t(R.v)||(C[E]=0))}var q=$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").eq(b-k),V=Object.keys(C).length>0,x=$.extend(!0,_,C),ee=fu.parseJsonParm(q.data("rowhidden"));pu(q,V,C,A,!0,v,y,b,k,w);var ne=$.extend(!0,{},u.config);if(ne.rowhidden=x,u.clearjfundo){var ae={type:"datachangeAll_filter"};ae.sheetIndex=u.currentSheetIndex,ae.config=$.extend(!0,{},u.config),ae.curconfig=ne,ae.optionstate=V,ae.optionsindex=b-k,ae.rowhidden=$.extend(!0,{},C),ae.rowhidenPre=$.extend(!0,{},ee),A!=null&&(ae.caljs=A),u.jfundo.length=0,u.jfredo.push(ae)}u.config=ne,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,ne.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu, #luckysheet-filter-orderby-color-submenu").hide(),bl()}),$(document).off("click.filterCheckbox1").on("click.filterCheckbox1","#luckysheet-filter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox2").on("click.filterCheckbox2","#luckysheet-filter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox3").on("click.filterCheckbox3","#luckysheet-filter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));var s=!0;$(this).parents(".yearBox").find(".day").each(function(h,f){$(f).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterCheckbox4").on("click.filterCheckbox4","#luckysheet-filter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));var s=!0;$(this).parents(".monthBox").find(".day").each(function(f,p){$(p).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));var h=!0;$(this).parents(".yearBox").find(".day").each(function(f,p){$(p).attr("data-check")=="true"||(h=!1)}),h?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterYearDropdown").on("click.filterYearDropdown","#luckysheet-filter-byvalue-select .yearBox .fa-caret-right",function(s){var h=$(this).parents(".luckysheet-mousedown-cancel");h.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),h.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle(),s.stopPropagation()}),$("#luckysheet-filter-byvalue-btn-all").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-filter-byvalue-btn-clear").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-filter-byvalue-btn-contra").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(s,h){$(h).is(":checked")?($(h).removeAttr("checked"),$(h).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(h).prop("checked",!0),$(h).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-filter-byvalue-select .ListBox .monthBox").each(function(s,h){var f=!0;$(h).find(".day input[type='checkbox']").each(function(p,g){$(g).is(":checked")||(f=!1)}),f?($(h).find(".month input[type='checkbox']").prop("checked",!0),$(h).attr("data-check","true")):($(h).find(".month input[type='checkbox']").removeAttr("checked"),$(h).attr("data-check","false"))}),$("#luckysheet-filter-byvalue-select .ListBox .yearBox").each(function(s,h){var f=!0;$(h).find(".day input[type='checkbox']").each(function(p,g){$(g).is(":checked")||(f=!1)}),f?($(h).find(".year input[type='checkbox']").prop("checked",!0),$(h).attr("data-check","true")):($(h).find(".year input[type='checkbox']").removeAttr("checked"),$(h).attr("data-check","false"))})}),$("#luckysheet-filter-initial").click(function(){if(dn(u.currentSheetIndex,"filter")){$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(a.conditionNone);var s={type:"datachangeAll_filter_clear"};s.sheetIndex=u.currentSheetIndex,s.config=$.extend(!0,{},u.config),u.config.rowhidden={},s.curconfig=$.extend(!0,{},u.config),s.filter_save=$.extend(!0,{},u.luckysheet_filter_save);var h=[];$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").each(function(){var f=$(this),p=f.hasClass("luckysheet-filter-options-active"),g=fu.parseJsonParm(f.data("rowhidden")),v=fu.parseJsonParm(f.data("caljs"));h.push({optionstate:p,rowhidden:g,caljs:v,str:f.data("str"),edr:f.data("edr"),cindex:f.data("cindex"),stc:f.data("stc"),edc:f.data("edc")})}),s.optiongroups=h,u.jfundo.length=0,u.jfredo.push(s),$("#luckysheet-filter-selected-sheet"+u.currentSheetIndex+", #luckysheet-filter-options-sheet"+u.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),u.luckysheetfile[je(u.currentSheetIndex)].filter=null,u.luckysheetfile[je(u.currentSheetIndex)].filter_select=null,nt.saveParam("fsc",u.currentSheetIndex,null),u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,{},{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length)}}),$("#luckysheet-filter-byvalue-input").on("input propertychange",function(){var s=$(this).val().toString();$("#luckysheet-filter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),s!=""&&$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(h,f){if($(f).closest(".day").length>0){var p=$(f).siblings("label").text().toString(),g=$(f).closest(".monthBox").find(".month label").text().toString();($(f).closest(".yearBox").find(".year label").text().toString()+"-"+g+"-"+p).indexOf(s)==-1&&($(f).closest(".day").hide(),$(f).closest(".dayList").find(".day:visible").length==0&&$(f).closest(".monthBox").find(".month").hide(),$(f).closest(".monthList").find(".day:visible").length==0&&$(f).closest(".yearBox").find(".year").hide())}$(f).closest(".textBox").length>0&&$(f).siblings("label").text().toString().indexOf(s)==-1&&$(f).parents(".textBox").hide()})}),$("#luckysheet-filter-cancel").click(function(){$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-confirm").click(function(){var s=$("#luckysheet-filter-menu"),h=s.data("str"),f=s.data("edr"),p=s.data("cindex"),g=s.data("stc"),v=s.data("edc"),y={};$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").eq(p-g).get(0)).each(function(){var wt=$(this).data("rowhidden");if(wt=="")return!0;for(var ct in wt=JSON.parse(wt.replace(/\'/g,'"')))y[ct]=0});var b={},k={},w={};if($("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null"){var _=$("#luckysheet-filter-selected span"),C=_.data("type"),A=_.data("value");if(w.value=A,w.text=_.text(),C=="0")w.type="0";else if(C=="2"){var I=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2 input");w.type="2",w.value1=I.eq(0).val(),w.value2=I.eq(1).val()}else w.type="1",w.value1=$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).find("input").val();for(var S=h+1;S<=f;S++)if(!(S in y)&&u.flowdata[S]!=null){var E=u.flowdata[S][p];if(A=="cellnull")E==null||$t(E.v)||(k[S]=0);else if(A=="cellnonull")(E==null||$t(E.v))&&(k[S]=0);else if(A=="textinclude"){var R=w.value1;(E==null||$t(E.v)||E.m.indexOf(R)==-1)&&(k[S]=0)}else if(A=="textnotinclude"){var F=w.value1;E==null||$t(E.v)||E.m.indexOf(F)>-1&&(k[S]=0)}else if(A=="textstart"){var N=w.value1,z=N.length;(E==null||$t(E.v)||E.m.substr(0,z)!=N)&&(k[S]=0)}else if(A=="textend"){var P=w.value1,q=P.length;(E==null||$t(E.v)||q>E.m.length||E.m.substr(E.m.length-q,q)!=P)&&(k[S]=0)}else if(A=="textequal"){var V=w.value1;(E==null||$t(E.v)||E.m!=V)&&(k[S]=0)}else if(A=="dateequal"){var x=_a(w.value1)[2];E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="d"?parseInt(E.v)!=x&&(k[S]=0):k[S]=0}else if(A=="datelessthan"){var ee=_a(w.value1)[2];E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="d"?parseInt(E.v)>=ee&&(k[S]=0):k[S]=0}else if(A=="datemorethan"){var ne=_a(w.value1)[2];E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="d"?parseInt(E.v)<=ne&&(k[S]=0):k[S]=0}else if(A=="morethan"){var ae=parseFloat(w.value1);E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v<=ae&&(k[S]=0):k[S]=0}else if(A=="moreequalthan"){var de=parseFloat(w.value1);E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v<de&&(k[S]=0):k[S]=0}else if(A=="lessthan"){var ve=parseFloat(w.value1);E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v>=ve&&(k[S]=0):k[S]=0}else if(A=="lessequalthan"){var U=parseFloat(w.value1);E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v>U&&(k[S]=0):k[S]=0}else if(A=="equal"){var B=parseFloat(w.value1);E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v!=B&&(k[S]=0):k[S]=0}else if(A=="noequal"){var le=parseFloat(w.value1);E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v==le&&(k[S]=0):k[S]=0}else if(A=="include"){var Te=parseFloat(w.value1),ue=parseFloat(w.value2),be=void 0,ye=void 0;Te<ue?(be=Te,ye=ue):(ye=Te,be=ue),E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?(E.v<be||E.v>ye)&&(k[S]=0):k[S]=0}else if(A=="noinclude"){var ce=parseFloat(w.value1),Re=parseFloat(w.value2),pe=void 0,me=void 0;ce<Re?(pe=ce,me=Re):(me=ce,pe=Re),E==null||$t(E.v)?k[S]=0:E.ct!=null&&E.ct.t=="n"?E.v>=pe&&E.v<=me&&(k[S]=0):k[S]=0}}}else{$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(wt,ct){if($(ct).is(":visible")&&$(ct).is(":checked"))return!0;if($(ct).closest(".day").length>0){var bt=$(ct).siblings("label").text();Number(bt)<10&&(bt="0"+Number(bt));var De=$(ct).closest(".monthBox").find(".month label").text().replace(a.filiterMonthText,"");Number(De)<10&&(De="0"+Number(De));var He=$(ct).closest(".yearBox").find(".year label").text().replace(a.filiterYearText,""),Dt=a.filterDateFormatTip+"#$$$#"+He+"-"+De+"-"+bt;b[Dt]="1"}if($(ct).closest(".textBox").length>0){var et=$(ct).closest(".textBox").data("filter");b[et]="1"}});for(var re=h+1;re<=f;re++)if(!(re in y)&&u.flowdata[re]!=null){var _e=u.flowdata[re][p],Ze=void 0;if(_e==null||$t(_e.v))Ze="null#$$$#null";else if(_e.ct!=null&&_e.ct.t=="d"){var We=za("YYYY-MM-DD",_e.v);Ze=a.filterDateFormatTip+"#$$$#"+We}else Ze=_e.v+"#$$$#"+_e.m;Ze in b&&(k[re]=0)}}var Xe=$("#luckysheet-filter-options-sheet"+u.currentSheetIndex+" .luckysheet-filter-options").eq(p-g),Ue=$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-filter-byvalue-input").val().length>0||$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null",mt=$.extend(!0,y,k),St=fu.parseJsonParm(Xe.data("rowhidden"));pu(Xe,Ue,k,w,!0,h,f,p,g,v);var at=$.extend(!0,{},u.config);if(at.rowhidden=mt,u.clearjfundo){var dt={type:"datachangeAll_filter"};dt.sheetIndex=u.currentSheetIndex,dt.config=$.extend(!0,{},u.config),dt.curconfig=at,dt.optionstate=Ue,dt.optionsindex=p-g,dt.rowhidden=$.extend(!0,{},k),dt.rowhidenPre=$.extend(!0,{},St),w!=null&&(dt.caljs=w),u.jfundo.length=0,u.jfredo.push(dt)}u.config=at,u.luckysheetfile[je(u.currentSheetIndex)].config=u.config,nt.saveParam("cg",u.currentSheetIndex,at.rowhidden,{k:"rowhidden"}),ln(u.flowdata.length,u.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),bl()})}(),function(){var n=st().drag;$("#luckysheet-copy-json-head").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){if(p.length==1){for(var v={},y=0;y<p[0].length;y++)v[Hr(0,y,p)]="";g.push(v)}else for(var b=1;b<p.length;b++){for(var k={},w=0;w<p[0].length;w++)Hr(0,w,p)==null?k[""]=Hr(b,w,p):k[Hr(0,w,p)]=Hr(b,w,p);g.push(k)}Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-copy-json-nohead").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=u.luckysheet_select_save[0].column[0],y=0;y<p.length;y++){for(var b={},k=0;k<p[0].length;k++)b[ya(k+v)]=Hr(y,k,p);g.push(b)}Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-copy-array1").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=0;v<p.length;v++)for(var y=0;y<p[0].length;y++)g.push(Hr(v,y,p));Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-copy-array2").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=0;v<p.length;v++){for(var y=[],b=0;b<p[0].length;b++)y.push(Hr(v,b,p));g.push(y)}Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-copy-arraymore-confirm").click(function(a){if(a.target.nodeName!=="INPUT")if($("body .luckysheet-cols-menu").hide(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=0;v<p.length;v++)for(var y=0;y<p[0].length;y++)g.push(p[v][y]);var b=$("#luckysheet-copy-arraymore-row").val(),k=$("#luckysheet-copy-arraymore-col").val();if(b==""&&k=="")return Ba.copybyformat(a,JSON.stringify(g)),void $("body .luckysheet-cols-menu").hide();if((b==""||(b=parseInt(b))==null)&&(b=1),(k==""||(k=parseInt(k))==null)&&(k=1),b.toString()!="NaN"&&k.toString()!="NaN")if(b<1||k<1)Rt()?alert(n.notLessOne):Ee.info(n.notLessOne,"");else{for(var w=g.length,_=0,C=[],A=0;A<b;A++){for(var I=[],S=0;S<k;S++)if(I.push(g[_++]),_>=w)return Ba.copybyformat(a,JSON.stringify(C)),void $("body .luckysheet-cols-menu").hide();C.push(I)}Ba.copybyformat(a,JSON.stringify(C))}else Rt()?alert(n.inputCorrect):Ee.info(n.inputCorrect,"")}}}),$("#luckysheet-copy-diagonal").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=p[0].length,y=0;y<p.length&&!(y>=v);y++)g.push(p[y][y]);Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-copy-antidiagonal").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=p[0].length,y=0;y<p.length&&!(y>=v);y++)g.push(p[y][v-y-1]);Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-copy-diagonaloffset").click(function(a){if(a.target.nodeName!=="INPUT")if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){var v=p[0].length,y=parseInt($("#luckysheet-copy-diagonaloffset-value").val());if(y.toString()!="NaN")if(y<0)Rt()?alert(n.offsetColumnLessZero):Ee.info(n.offsetColumnLessZero,"");else{y==null&&(y=1);for(var b=0;b<p.length&&!(b+y>=v);b++)g.push(p[b][b+y]);Ba.copybyformat(a,JSON.stringify(g))}else Rt()?alert(n.inputCorrect):Ee.info(n.inputCorrect,"")}}}),$("#luckysheet-copy-boolvalue").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{if(u.config.merge!=null){for(var l=!1,o=0;o<u.luckysheet_select_save.length;o++){var d=u.luckysheet_select_save[o].row[0],s=u.luckysheet_select_save[o].row[1],h=u.luckysheet_select_save[o].column[0],f=u.luckysheet_select_save[o].column[1];if(l=mn(u.config,d,s,h,f))break}if(l)return void(Rt()?alert(n.noPartMerge):Ee.info(n.noPartMerge,""))}var p=nn(u.luckysheet_select_save[0]),g=[];if(p.length!=0){for(var v=0;v<p.length;v++){for(var y=[],b=0;b<p[0].length;b++){var k=!1,w=void 0;k=(w=D(p[v][b])=="object"?p[v][b].v:p[v][b])!=null&&w!=""&&((w=parseInt(w))==null||w>0),y.push(k)}g.push(y)}Ba.copybyformat(a,JSON.stringify(g))}}}),$("#luckysheet-matrix-turn-up").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=l.length-1;d>=0;d--){for(var s=[],h=0;h<l[0].length;h++){var f="";l[d]!=null&&l[d][h]!=null&&(f=l[d][h]),s.push(f)}o.push(s)}vr.controlHandler(o)}}}),$("#luckysheet-matrix-turn-left").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=0;d<l.length;d++){for(var s=[],h=l[0].length-1;h>=0;h--){var f="";l[d]!=null&&l[d][h]!=null&&(f=l[d][h]),s.push(f)}o.push(s)}vr.controlHandler(o)}}}),$("#luckysheet-matrix-turn-cw").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=0;d<l[0].length;d++){for(var s=[],h=l.length-1;h>=0;h--){var f="";l[h]!=null&&l[h][d]!=null&&(f=l[h][d]),s.push(f)}o.push(s)}vr.controlHandlerD(o)}}}),$("#luckysheet-matrix-turn-anticw").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=l[0].length-1;d>=0;d--){for(var s=[],h=0;h<l.length;h++){var f="";l[h]!=null&&l[h][d]!=null&&(f=l[h][d]),s.push(f)}o.push(s)}vr.controlHandlerD(o)}}}),$("#luckysheet-matrix-turn-trans").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=0;d<l[0].length;d++){for(var s=[],h=0;h<l.length;h++){var f="";l[h]!=null&&l[h][d]!=null&&(f=l[h][d]),s.push(f)}o.push(s)}vr.controlHandlerD(o)}}});var t=function(a,l){if(a==0)return 0;var o,d;for(d=(l-1)*(o=a)/l+a/(Math.pow(o,l-1)*l);Math.abs(d-o)>1e-6;)d=(l-1)*(o=d)/l+a/(Math.pow(o,l-1)*l);return d};$("#luckysheet-matrix-cal-confirm").click(function(a){if(a.target.nodeName!=="INPUT"&&a.target.nodeName!=="SELECT")if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){var o=$("#luckysheet-matrix-cal-type").val(),d=parseInt($("#luckysheet-matrix-cal-value").val());if(d.toString()!="NaN"){d==null&&(d=2);for(var s=[],h=0;h<l.length;h++){for(var f=[],p=0;p<l[0].length;p++){var g="";l[h]!=null&&l[h][p]!=null&&(g=l[h][p],parseInt(g)!=null&&l[h][p].ct!=null&&l[h][p].ct.t=="n"&&(o=="minus"?g.v=g.v-d:o=="multiply"?g.v=g.v*d:o=="divided"?g.v=Bl(g.v/d,4):o=="power"?g.v=Math.pow(g.v,d):o=="root"?d==2?g.v=Bl(Math.sqrt(g.v),4):d==3&&Math.cbrt?g.v=Bl(Math.cbrt(g.v),4):g.v=Bl(t(g.v,d),4):g.v=o=="log"?Bl(1e4*Math.log(g.v)/Math.log(Math.abs(d)),4):g.v+d,g.v==null?g.m="":g.m=g.v.toString())),f.push(g)}s.push(f)}vr.controlHandler(s)}else Rt()?alert(n.inputCorrect):Ee.info(n.inputCorrect,"")}}}),$("#luckysheet-matrix-delezero-row").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=l[0].length,s=0;s<l.length;s++){for(var h=[],f=!0,p=!0,g=0;g<d;g++){var v="";if(l[s]!=null&&l[s][g]!=null){if(((v=l[s][g]).v=="0"||v.v==0)&&f)continue;f=!1}h.push(v)}var y=[];if(h.length==d)y=h;else{for(var b=h.length-1;b>=0;b--){var k="";if(h[b]!=null){if(((k=h[b]).v=="0"||k.v==0)&&p)continue;p=!1}y.unshift(k)}for(var w=d-y.length,_=0;_<w;_++)y.push("")}o.push(y)}vr.controlHandler(o)}}}),$("#luckysheet-matrix-delezero-column").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=l.length,s=l[0].length,h=0;h<s;h++){for(var f=[],p=!0,g=!0,v=0;v<d;v++){var y="";if(l[v]!=null&&l[v][h]!=null){if(((y=l[v][h]).v=="0"||y.v==0)&&p)continue;p=!1}f.push(y)}var b=[];if(f.length==d)b=f;else{for(var k=f.length-1;k>=0;k--){var w="";if(f[k]!=null){if(((w=f[k]).v=="0"||w.v==0)&&g)continue;g=!1}b.unshift(w)}for(var _=d-b.length,C=0;C<_;C++)b.push("")}o.push(b)}for(var A=[],I=0;I<o[0].length;I++){for(var S=[],E=0;E<o.length;E++){var R="";o[E]!=null&&o[E][I]!=null&&(R=o[E][I]),S.push(R)}A.push(S)}vr.controlHandler(A)}}}),$("#luckysheet-matrix-delerpt-row").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=l[0].length,s=0;s<l.length;s++){for(var h=[],f={},p=0;p<d;p++){var g=null;l[s]!=null&&l[s][p]!=null&&((g=l[s][p]).v in f||(f[g.v]=[]),f[g.v].push(g))}for(var v=0;v<d;v++){var y=null;l[s]!=null&&l[s][v]!=null&&f[(y=l[s][v]).v].length==1&&h.push(y)}for(var b=d-h.length,k=0;k<b;k++)h.push(null);o.push(h)}vr.controlHandler(o)}}}),$("#luckysheet-matrix-delerpt-column").click(function(a){if($("body .luckysheet-cols-menu").hide(),la(),u.luckysheet_select_save.length>1)Rt()?alert(n.noMulti):Ee.info(n.noMulti,"");else{var l=nn(u.luckysheet_select_save[0]);if(l.length!=0){for(var o=[],d=l.length,s=l[0].length,h=0;h<s;h++){for(var f=[],p={},g=0;g<d;g++){var v=null;l[g]!=null&&l[g][h]!=null&&((v=l[g][h]).v in p||(p[v.v]=[]),p[v.v].push(v))}for(var y=0;y<d;y++){var b=null;l[y]!=null&&l[y][h]!=null&&p[(b=l[y][h]).v].length==1&&f.push(b)}a1=f;for(var k=d-a1.length,w=0;w<k;w++)a1.push(null);o.push(a1)}for(var _=[],C=0;C<o[0].length;C++){for(var A=[],I=0;I<o.length;I++){var S=null;o[I]!=null&&o[I][C]!=null&&(S=o[I][C]),A.push(S)}_.push(A)}vr.controlHandler(_)}}})}(),Px(),e=st().formula,$("#luckysheet-functionbox-cell").focus(function(){if(!Rt()&&u.luckysheet_select_save.length>0){var n=u.luckysheet_select_save[u.luckysheet_select_save.length-1];ri(n.row_focus,n.column_focus,u.flowdata,null,!0),m.rangeResizeTo=$("#luckysheet-functionbox-cell")}}).keydown(function(n){if(!Rt()){n.ctrlKey,n.altKey,n.shiftKey;var t=n.keyCode,a=$("#luckysheet-input-box");if(t==Yi&&parseInt(a.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&m.searchFunctionCell!=null?m.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),u.luckysheet_select_save=[{row:[u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[0]],column:[u.luckysheetCellUpdate[1],u.luckysheetCellUpdate[1]],row_focus:u.luckysheetCellUpdate[0],column_focus:u.luckysheetCellUpdate[1]}],Vn("down",1,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus()),n.preventDefault();else if(t==ed&&parseInt(a.css("top"))>0)m.dontupdate(),Vn("down",0,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus(),n.preventDefault();else if(t==lh&&parseInt(a.css("top"))>0)m.setfreezonFuc(n),n.preventDefault();else if(t==Yo&&parseInt(a.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){var l=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev();l.length==0&&(l=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),l.addClass("luckysheet-formula-search-item-active"),n.preventDefault()}}else if(t==Zo&&parseInt(a.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){var o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next();o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),o.addClass("luckysheet-formula-search-item-active"),n.preventDefault()}}else t==Wo&&parseInt(a.css("top"))>0||t==Xo&&parseInt(a.css("top"))>0?m.rangeHightlightselected($("#luckysheet-functionbox-cell")):(!(t>=112&&t<=123||t<=46||t==144||t==108||n.ctrlKey||n.altKey||n.shiftKey&&(t==37||t==38||t==39||t==40))||t==8||t==32||t==46||n.ctrlKey&&t==86)&&m.functionInputHanddler($("#luckysheet-rich-text-editor"),$("#luckysheet-functionbox-cell"),t)}}).click(function(){Rt()||m.rangeHightlightselected($("#luckysheet-functionbox-cell"))}),$("#luckysheet-wa-functionbox-cancel").click(function(){$(this).hasClass("luckysheet-wa-calculate-active")&&($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),m.dontupdate(),Vn("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-confirm").click(function(){$(this).hasClass("luckysheet-wa-calculate-active")&&($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),m.updatecell(u.luckysheetCellUpdate[0],u.luckysheetCellUpdate[1]),Vn("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-fx").click(function(){if(u.luckysheet_select_save.length!=0){var n=u.luckysheet_select_save[u.luckysheet_select_save.length-1],t=n.row_focus,a=n.column_focus;ri(t,a,u.flowdata);var l=u.flowdata[t][a];if(l!=null&&l.f!=null){var o=m.getfunctionParam(l.f);o.fn!=null?is.formulaParmDialog(o.fn,o.param):is.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),is.formulaListDialog();is.init()}else Rt()?alert(e.tipSelectCell):Ee.info(e.tipSelectCell,"")}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-copy",function(n){m.rangeMove=!0,u.luckysheet_scroll_status=!0,m.rangeMoveObj=$(this).parent(),m.rangeMoveIndex=$(this).parent().attr("rangeindex");var t=pa(n.pageX,n.pageY),a=t[0]+$("#luckysheet-cell-main").scrollLeft(),l=t[1]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-formula-functionrange-highlight-"+m.rangeMoveIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13);var o=$(this).data("type");o=="top"?l+=3:o=="right"?a-=3:o=="bottom"?l-=3:o=="left"&&(a+=3);var d=Wa(l)[2],s=ja(a)[2];m.rangeMovexy=[d,s],$("#luckysheet-sheettable").css("cursor","move"),n.stopPropagation()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-highlight",function(n){m.rangeResize=$(this).data("type"),m.rangeResizeIndex=$(this).parent().attr("rangeindex");var t=pa(n.pageX,n.pageY),a=$("#luckysheet-cell-main").scrollLeft(),l=$("#luckysheet-cell-main").scrollTop(),o=t[0]+a,d=t[1]+l;m.rangeResizeObj=$(this).parent(),$("#luckysheet-formula-functionrange-highlight-"+m.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13),m.rangeResize=="lt"?(o+=3,d+=3):m.rangeResize=="lb"?(o+=3,d-=3):m.rangeResize=="rt"?(o-=3,d+=3):m.rangeResize=="rb"&&(o-=3,d-=3);var s=Wa(d),h=s[1],f=s[0],p=ja(o),g=p[1],v=p[0],y=m.rangeResizeObj.position();m.rangeResizexy=[v,f,m.rangeResizeObj.width(),m.rangeResizeObj.height(),y.left+a,y.top+l,g,h],m.rangeResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,m.rangeResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,u.luckysheet_scroll_status=!0,n.stopPropagation()}),Ox(),zx(),function(){var n=st();$("#luckysheetorderbyasc, #luckysheetorderbyasc_t").mousedown(function(a){bl(a),Yp(u.orderbyindex,!0),Ra()}),$("#luckysheetorderbydesc, #luckysheetorderbydesc_t").click(function(a){bl(a),Yp(u.orderbyindex,!1),Ra()});var t=!0;$("#luckysheetorderby").click(function(){if(dn(u.currentSheetIndex,"sort")){$("body .luckysheet-cols-menu").hide();var a=n.sort;if(u.luckysheet_select_save.length>1)Rt()?alert(a.noRangeError):Ee.info(a.noRangeError,"");else{var l=u.luckysheet_select_save[0],o=l.row[0],d=l.row[1],s=l.column[0],h=l.column[1];if(t){t=!1;var f='<div style="overflow: hidden;" class="luckysheet-sort-modal"><div><label><input type="checkbox" id="luckysheet-sort-haveheader"/><span>'.concat(a.hasTitle,'</span></label></div><div style="overflow-y:auto;" id="luckysheet-sort-dialog-tablec"><table data-itemcount="0" cellspacing="0"> <tr><td>').concat(a.hasTitle,' <select name="sort_0"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_0"><span>').concat(a.asc,'A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_0"><span>').concat(a.desc,'Z-A</span></label></div></td></tr></table></div><div style="background: #e5e5e5;border-top: 1px solid #f5f5f5; height: 1px; width: 100%;margin:2px 0px;margin-bottom:10px;"></div> <div> <span style="font-weight: bold; text-decoration: underline;text-align:center;color: blue;cursor: pointer;" class="luckysheet-sort-dialog-additem">+ ').concat(a.addOthers,"</span> </div> </div>");$("body").append(br(Ga,{id:"luckysheet-sort-dialog",addclass:"",title:n.sort.sortTitle,content:f,botton:'<button id="luckysheet-sort-modal-confirm" class="btn btn-primary">'.concat(a.confirm,'</button><button class="btn btn-default luckysheet-model-close-btn">').concat(a.close,"</button>")})),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-additem").click(function(){for(var A=u.luckysheet_select_save[0],I=A.row[0],S=(A.row[1],A.column[0]),E=A.column[1],R="",F=$("#luckysheet-sort-dialog table").data("itemcount")+1,N=$("#luckysheet-sort-haveheader").is(":checked"),z=S;z<=E;z++)if(N){var P=Hr(I,z,u.flowdata,"m");P==null&&(P=a.columnOperation+(z-S+1)),R+='<option value="'+z+'">'+P+"</option>"}else R+='<option value="'+z+'">'+ya(z)+"</option>";$("#luckysheet-sort-dialog table").append(`
                    <tr class="luckysheet-sort-dialog-tr">
                        <td><span class="luckysheet-sort-item-close" onclick="$(this).parent().parent().remove();"><i class="fa fa-times"
                                    aria-hidden="true"></i></span>`.concat(a.secondaryTitle,` <select
                                name="sort_`).concat(F,'">').concat(R,`</select> </td>
                        <td>
                            <div><label><input value="asc" type="radio" checked="checked"
                                        name="sort_`).concat(F,'"><span>').concat(a.asc,`A-Z</span></label></div>
                            <div><label><input value="desc" type="radio" name="sort_`).concat(F,'"><span>').concat(a.desc,`Z-A</span></label>
                            </div>
                        </td>
                    </tr>
                `)),$("#luckysheet-sort-dialog table").data("itemcount",F)}),$("#luckysheet-sort-haveheader").change(function(){for(var A=u.luckysheet_select_save[0],I=A.row[0],S=(A.row[1],A.column[0]),E=A.column[1],R=$(this).is(":checked"),F="",N=S;N<=E;N++)if(R){var z=Hr(I,N,u.flowdata,"m");z==null&&(z=a.columnOperation+(N-S+1)),F+='<option value="'+N+'">'+z+"</option>"}else F+='<option value="'+N+'">'+ya(N)+"</option>";$("#luckysheet-sort-dialog tr select").each(function(){$(this).html(F)})}),$("#luckysheet-sort-modal-confirm").click(function(){if(u.luckysheet_select_save.length>1)Rt()?alert(a.noRangeError):Ee.info(a.noRangeError,"");else{for(var A,I=vr.deepCopyFlowData(u.flowdata),S=u.luckysheet_select_save[0],E=S.row[0],R=S.row[1],F=S.column[0],N=S.column[1],z=$("#luckysheet-sort-haveheader").is(":checked"),P=!1,q=[],V=A=z?E+1:E;V<=R;V++){for(var x=[],ee=F;ee<=N;ee++){if(I[V][ee]!=null&&I[V][ee].mc!=null){P=!0;break}x.push(I[V][ee])}q.push(x)}if(P)Rt()?alert(a.mergeError):Ee.info(a.mergeError,"");else{$($("#luckysheet-sort-dialog table tr").toArray().reverse()).each(function(){var U=$(this).find("select").val(),B=$(this).find("input:radio:checked").val();U-=F,B=B=="asc",q=zs([].concat(q),U,B)});for(var ne=A;ne<=R;ne++)for(var ae=F;ae<=N;ae++)I[ne][ae]=q[ne-A][ae-F];var de={};if(u.config.rowlen!=null){var ve=$.extend(!0,{},u.config);de={cfg:ve=Yl(I,A,R,ve),RowlChange:!0}}wa(I,[{row:[A,R],column:[F,N]}],de),$("#luckysheet-sort-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}}})}for(var p="",g=s;g<=h;g++)p+='<option value="'+g+'">'+ya(g)+"</option>";$("#luckysheet-sort-dialog select").html(p),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-tr").remove(),$("#luckysheet-sort-haveheader").prop("checked",!1),$("#luckysheet-sort-dialog input:radio:first").prop("checked","checked"),$("#luckysheet-sort-dialog .luckysheet-modal-dialog-title-text").html(a.sortRangeTitle+"<span>"+ya(s)+(o+1)+"</span>"+a.sortRangeTitleTo+"<span>"+ya(h)+(d+1)+"</span>");var v=$("#luckysheet-sort-dialog"),y=v.outerHeight(),b=v.outerWidth(),k=$(window).width(),w=$(window).height(),_=$(document).scrollLeft(),C=$(document).scrollTop();$("#luckysheet-sort-dialog-tablec").css("max-height",(w-y)/2),$("#luckysheet-sort-dialog").css({left:(k+_-b)/2,top:(w+C-y)/2}).show(),$("#luckysheet-modal-dialog-mask").show(),o<d&&setTimeout(function(){for(var A=u.flowdata[o],I=u.flowdata[o+1],S=!1,E=s;E<=h;E++)ko(A[E])!=ko(I[E])&&(S=!0);S&&$("#luckysheet-sort-haveheader").prop("checked",!0).change()},10)}}})}(),$("#luckysheet-zoom-minus").click(function(){var n;n=u.zoomRatio==null?u.zoomRatio=1:Math.ceil(10*u.zoomRatio)/10,(n-=.1)==u.zoomRatio&&(n-=.1),n<=.1&&(n=.1),Cu(n),Co(n)}),$("#luckysheet-zoom-plus").click(function(){var n;n=u.zoomRatio==null?u.zoomRatio=1:Math.floor(10*u.zoomRatio)/10,(n+=.1)==u.zoomRatio&&(n+=.1),n>=4&&(n=4),Cu(n),Co(n)}),$("#luckysheet-zoom-slider").mousedown(function(n){var t=$(this).offset().left,a=Eg(n.pageX-t);Cu(a),Co(a)}),$("#luckysheet-zoom-cursor").mousedown(function(n){var t=n.pageX,a=parseFloat($("#luckysheet-zoom-cursor").css("left"));$("#luckysheet-zoom-cursor").css("transition","none"),$(document).off("mousemove.zoomCursor").on("mousemove.zoomCursor",function(l){var o=l.pageX,d=a+(o-t),s=Eg(d);s>4&&(s=4,d=100),s<.1&&(s=.1,d=0),Cu(s);var h=Math.round(100*s)+"%";$("#luckysheet-zoom-ratioText").html(h),$("#luckysheet-zoom-cursor").css("left",d-4)}),$(document).off("mouseup.zoomCursor").on("mouseup.zoomCursor",function(l){$(document).off(".zoomCursor"),$("#luckysheet-zoom-cursor").css("transition","all 0.3s")}),n.stopPropagation()}).click(function(n){n.stopPropagation()}),$("#luckysheet-zoom-ratioText").click(function(){Cu(1),Co(1)}),Co(u.zoomRatio),function(){var n=Nt.container;$("#"+n).find(".luckysheet-print-viewBtn").click(function(){jx($(this))})}(),Qg(u,"jfredo",function(n,t,a,l){t!=="length"&&Ya.createHookFunction("updated",a)}),Qg(u,"asyncLoad",function(n,t,a,l){t==="length"&&a===0&&Ya.createHookFunction("workbookCreateAfter",hm())})}(xl=Yg(Gb,xl)).create=function(e){var n;for(var t in Ya.destroy(),u.toJsonOptions={},e)t!=="data"&&(u.toJsonOptions[t]=e[t]);var a=Yg(n0,e),l=a.loadUrl,o=a.menu,d=a.title,s=a.container;u.container=s,u.luckysheetfile=a.data,u.defaultcolumnNum=a.column,u.defaultrowNum=a.row,u.fullscreenmode=a.fullscreenmode,u.lang=a.lang,u.allowEdit=a.allowEdit,u.limitSheetNameLength=a.limitSheetNameLength,u.defaultSheetNameMaxLength=a.defaultSheetNameMaxLength,u.fontList=a.fontList,nt.gridKey=a.gridKey,nt.loadUrl=a.loadUrl,nt.updateUrl=a.updateUrl,nt.updateImageUrl=a.updateImageUrl,nt.title=a.title,nt.loadSheetUrl=a.loadSheetUrl,nt.allowUpdate=a.allowUpdate,Nt.autoFormatw=a.autoFormatw,Nt.accuracy=a.accuracy,Nt.total=a.data[0].total,Nt.allowCopy=a.allowCopy,Nt.showtoolbar=a.showtoolbar,Nt.showtoolbarConfig=a.showtoolbarConfig,Nt.showinfobar=a.showinfobar,Nt.showsheetbar=a.showsheetbar,Nt.showsheetbarConfig=a.showsheetbarConfig,Nt.showstatisticBar=a.showstatisticBar,Nt.showstatisticBarConfig=a.showstatisticBarConfig,Nt.sheetFormulaBar=a.sheetFormulaBar,Nt.cellRightClickConfig=a.cellRightClickConfig,Nt.sheetRightClickConfig=a.sheetRightClickConfig,Nt.pointEdit=a.pointEdit,Nt.pointEditUpdate=a.pointEditUpdate,Nt.pointEditZoom=a.pointEditZoom,Nt.userInfo=a.userInfo,Nt.userMenuItem=a.userMenuItem,Nt.myFolderUrl=a.myFolderUrl,Nt.functionButton=a.functionButton,Nt.showConfigWindowResize=a.showConfigWindowResize,Nt.enableAddRow=a.enableAddRow,Nt.enableAddBackTop=a.enableAddBackTop,Nt.enablePage=a.enablePage,Nt.pageInfo=a.pageInfo,Nt.editMode=a.editMode,Nt.beforeCreateDom=a.beforeCreateDom,Nt.workbookCreateBefore=a.workbookCreateBefore,Nt.workbookCreateAfter=a.workbookCreateAfter,Nt.fireMousedown=a.fireMousedown,Nt.forceCalculation=a.forceCalculation,Nt.plugins=a.plugins,Nt.rowHeaderWidth=a.rowHeaderWidth,Nt.columnHeaderHeight=a.columnHeaderHeight,Nt.defaultColWidth=a.defaultColWidth,Nt.defaultRowHeight=a.defaultRowHeight,Nt.title=a.title,Nt.container=a.container,Nt.hook=a.hook,Nt.pager=a.pager,Nt.initShowsheetbarConfig=!1,u.lang==="zh"&&qg.localize(Gx.zh),(n=u.asyncLoad).push.apply(n,Ei(Nt.plugins)),function(f,p){f.length&&f.forEach(function(g){Ux[g](p,!0)})}(a.plugins,a.data),function(){for(var f=st().functionlist,p=0;p<f.length;p++){var g=f[p];g.f=Hx[g.n]}u.functionlist=f;for(var v={},y=0;y<f.length;y++){var b=f[y];v[b.n]=b}window.luckysheet_function=v,u.luckysheet_function=v}();var h=a.devicePixelRatio;h==null&&(h=1),u.devicePixelRatio=Math.ceil(h),$("#"+s).append(Qc()),l==""?(ir.initialjfFile(o,d),wy()):$.post(l,{gridKey:nt.gridKey},function(f){var p=new Function("return "+f)();u.luckysheetfile=p,ir.initialjfFile(o,d),wy(),nt.allowUpdate&&nt.openWebSocket()})},xl.getluckysheetfile=an,xl.getluckysheet_select_save=function(){return u.luckysheet_select_save},xl.setluckysheet_select_save=function(e){u.luckysheet_select_save=e},xl.getconfig=function(){return u.config},xl.getGridData=ir.getGridData,xl.buildGridData=ir.buildGridData,xl.luckysheetrefreshgrid=Kr,xl.jfrefreshgrid=wa,xl.getcellvalue=Hr,xl.setcellvalue=Ln,xl.getdatabyselection=nn,xl.sheetmanage=ir,xl.flowdata=function(){return u.flowdata},xl.selectHightlightShow=Ra,xl.destroy=Ya.destroy;var Wx=!we(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete K[e]});function Yx(){return this.style}function Xx(){return _y()}function Zx(){return this.target}function _y(){if(document.all)return window.event;for(var e=_y.caller;e!=null;){var n=e.arguments[0];if(n&&n.constructor.toString().indexOf("Event")!=-1)return n;e=e.caller}return null}return H&&Ce({target:"Object",proto:!0,forced:Wx},{__defineGetter__:function(e,n){Be.f(Dl(this),e,{get:tc(n),enumerable:!0,configurable:!0})}}),window.addEventListener&&navigator.userAgent.indexOf("Firefox")>0&&(HTMLElement.prototype.__defineGetter__("runtimeStyle",Yx),window.constructor.prototype.__defineGetter__("event",Xx),Event.prototype.__defineGetter__("srcElement",Zx)),xl});const pw=zn=>(cw("data-v-d038305b"),zn=zn(),dw(),zn),gw=pw(()=>Wm("div",null,[Wm("div",{id:"luckysheet"})],-1)),vw=lw({__name:"HomeView",setup(zn){const Ii=iw(null);function Fe(){var K,we;const Ct=(we=(K=Ii.value)==null?void 0:K.files)==null?void 0:we[0];Ct&&fw.transformExcelToLucky(Ct,function(H){console.log(H);const L=H.sheets;window.luckysheet.destroy(),window.luckysheet.create({plugins:["chart"],container:"luckysheet",showinfobar:!1,data:L,lang:"zh",title:H.info.name,userInfo:H.info.name.creator})})}return setInterval(()=>{},1e3),ow(()=>{window.luckysheet.create({plugins:["chart"],container:"luckysheet",title:"ge test",lang:"zh"})}),(Ct,K)=>(uw(),sw("div",null,[Wm("input",{ref_key:"inputRef",ref:Ii,type:"file",onChange:Fe},null,544),gw]))}}),yw=(zn,Ii)=>{const Fe=zn.__vccOpts||zn;for(const[Ct,K]of Ii)Fe[Ct]=K;return Fe},kw=yw(vw,[["__scopeId","data-v-d038305b"]]);export{kw as default};
